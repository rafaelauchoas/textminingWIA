Artiﬁcial Intelligence 320 2023 103919 Contents lists available ScienceDirect Artiﬁcial Intelligence journal homepage wwwelseviercomlocateartint Reasoning causality games Lewis Hammond Alessandro Abate Michael Wooldridge University Oxford United Kingdom b DeepMind United Kingdom James Fox Tom Everitt b Ryan Carey r t c l e n f o b s t r c t Article history Received 17 March 2022 Received revised form 1 April 2023 Accepted 2 April 2023 Available online 5 April 2023 Keywords Causality Game theory Graphical models Contents Causal reasoning gametheoretic reasoning fundamental topics artiﬁcial intel ligence disciplines paper concerned intersection Despite importance formal framework supports forms reasoning lacking We offer solution form structural causal games seen extending Pearls causal hierarchy gametheoretic domain extending Koller Milchs multiagent inﬂuence diagrams causal domain We consider key questions How causal dependencies games variables strategies modelled uniform principled manner ii How causal queries computed causal games assumptions require iii How causal games compare existing formalisms To address question introduce mechanised games encode dependencies tween agents decision rules distributions governing game In response question ii present deﬁnitions predictions interventions counterfactuals discuss assumptions required Regarding question iii correspon dences causal games formalisms explain causal games answer queries causal gametheoretic models support Finally highlight possible applications causal games aided extensive open source Python library 2023 The Authors Published Elsevier BV This open access article CC BY license httpcreativecommons org licenses 4 0 1 2 Introduction Contributions 11 Related work 12 Background Causal models 21 Gametheoretic models 22 3 3 4 5 5 7 3 Mechanised MAIDs relevance 10 Corresponding authors Email addresses lewishammondcsoxacuk L Hammond jamesfoxcsoxacuk J Fox httpsdoiorg101016jartint2023103919 00043702 2023 The Authors Published Elsevier BV This open access article CC BY license http creativecommons org licenses 4 0 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 7 6 4 5 31 Mechanised MAIDs 10 32 Relevance 13 Causality games 14 Predictions 15 41 Interventions 16 42 43 Counterfactuals 17 Solution concepts subgames 21 Nash equilibria 21 51 Subgames 22 52 Equilibrium reﬁnements 23 53 Connections EFGs 25 Transformations 25 61 Equivalences 26 62 Causality EFGs 27 63 Applications 28 Case study insurance pricing 28 71 Blame intent incentives fairness 30 72 Discussion 31 Advantages disadvantages causal games 31 81 Future work 32 82 Declaration competing 32 Data availability 33 Acknowledgements 33 Proofs 33 Appendix A Transformations game representations 33 Theoretical results 34 Further examples 42 Counterfactuals closest possible world principle 42 Nonexistence results 43 Reasoning existing concepts causal games 46 Codebase 48 Creating MAIDs 48 Computing equilibria 51 References 51 B1 B2 B3 Appendix B Appendix C A1 A2 C1 C2 8 Notation Symbol Object AncV cRG ChV DescV domV EV E E FaV G I J M Mζk MV mG mM N PaV Pr P Prπ P σ Q R RmM r D Ancestors V Condensed RRelevance Graph Children V Descendants V Do Operator Domain V Exogenous Variable V Edges ExtensiveForm Game Family V Graph Intervention Intervention Set Model Perturbed Model Mechanism Variable V Mechanised Graph Mechanised Model Agents Parents V Probability Distribution Probability Distribution Combining Pr π P σ Queries Rationality Relations RRational Outcomes M Rationality Relation D Page 5 42 5 5 6 5 7 5 8 5 5 6 25 5 24 10 11 11 8 5 5 8 9 9 13 11 12 11 2 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Symbol rRG V v V v δ cid5 cid6V θ μi π π π cid7D σ G Object RRelevance Graph Variable Value V Variables Values V Kronecker Delta Function Probability Simplex Parameter Variable V Parameters Mixed Policy Agent Behavioural Policy Agent Pure Behavioural Policy Agent Behavioural Policy Proﬁle Decision Rule Variable D Behavioural Strategy Proﬁle dSeparated G Independent Topological Ordering Page 13 5 5 5 5 6 5 10 5 22 9 22 9 10 8 6 6 42 1 Introduction Causal reasoning gametheoretic reasoning core capabilities intelligent systems fun damental research topics artiﬁcial intelligence AI Causal reasoning concerned identifying causal relationships estimating effects interventions Gametheoretic reasoning concerned strategic behaviour rational decisionmakers interact taking account incentives Whilst formal treatments causality 73758291 gametheoretic foundations multiagent systems 718899 individually led recent applications AI present concern techniques combine causal strategic reasoning Models support kinds reasoning offer wide range possible applications including analysing incentives 2257 fairness 495567102 blame intention 2839 As systems multiagent systems increasingly ubiquitous sophisticated problem formally reason notions increas ingly acute A framework supports causal analysis systems containing multiple selfinterested agents appear great importance 222876 Causal questions challenging answer multiagent settings consider causal dependencies present environment dependencies agents strategies Similarly reasoning strate gically effects action agents different circumstances naturally leads consider interventions counterfactual possibilities analysing games These causal cepts typically left implicit gametheoretic models The central purpose paper introduce unifying framework modelling games supports causal gametheoretic reasoning This framework structural causal games interpreted different ways In sense lifts Koller Milchs henceforth KM multiagent inﬂuence diagrams MAIDs 51 probabilistic models level Pearls causal hierarchy 73 causal models support interventions counterfactuals corresponding levels hierarchy respectively Building KMs graphical representation means employ existing gametheoretic concepts strategic relevance 51 suﬃcient recall 64 elicited purely structure game Alternatively causal games interpreted generalising models causal hierarchy gametheoretic domain introducing decision variables lack distribution chosen corresponding agent set realvalued utility variables representing payoff agent Causal games support gametheoretic causal queries combinations It hope framework serves foundation work intersection causality game theory 11 Contributions In answering key questions introduced following contributions How causal dependencies games variables strategies modelled uniform principled manner We introduce mechanised MAIDs Section 3 allow cleanly model dependencies decision rules parameters game We generalise KMs notion strategic relevance Rrelevance enable modelling different decision making principles Furthermore derive sound complete graphical criteria detecting relevant variables agents playing best responses 3 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 ii How causal queries computed models assumptions require We generalise Pearls causal hierarchy models gametheoretic domain introducing structural causal games Section 4 We models answer conditional interventional counterfactual queries By quantifying equilibria game leading ﬁrst order queries case Nash equilibrium setting variable X value x increase agent expected payoff taking account causal effects rational agents adapt strategies changes environment queries strictly generalise causal models In essence assumptions required model given problem causal game non gametheoretic counterparts To mechanise causal game require assumptions decisionmaking principles agents use play game iii How models propose compare existing formalisms We introduce subgames classic equilibrium reﬁnements subgame perfectness trembling hand perfectness MAIDs Section 5 provide detailed comparison MAIDs EFGs including equivalence results Section 6 We subgames MAID corresponding EFG ruling noncredible threats making computation equilibria eﬃcient Finally discuss range applications causal games subsume prior work Section 7 disadvantages respect work Section 8 A previous conference paper contained preliminary results subgames equilibrium reﬁnements MAIDs connections EFGs 42 contain discussion causality main focus paper Similarly previous tool paper introduced earlier version codebase 27 implements concepts paper contain theoretical work emphasis present paper We conclude section review related work Before primary exposition results provide relevant background material causal models EFGs MAIDs Section 2 Proofs examples details codebase relegated Appendices A B C respectively 12 Related work Causal games build Pearls hierarchy causal models 73 work inﬂuence diagrams IDs kind graphical model capture singleagent decisionmaking scenarios 45 Later works explicitly considered causal IDs CIDs 1822 Indeed Heckerman Shachters proposal unify causal modelling decision analysis CIDs 43 viewed precursor proposal unify causal modelling game theory causal games None theories place emphasis games strategic interactions multiple agents setting In contrast multiagent IDs MAIDs generalise IDs 5164 originally developed KM way eﬃciently represent solve games One useful feature MAIDs causal games inherit graphical structure encodes information relevant making optimal decision Thus order ﬁnd equilibrium possible remove edges ignorable information prior solving game 64 Many graphical models games inspired MAIDs introduced 48 including networks inﬂuence diagrams NIDs 30 interactive dynamic inﬂuence diagrams IDIDs 2077 temporal action graph games 47 Like MAIDs works motivated computational concerns incorporate rigorous causal reasoning Modelling causal relationships gametheoretic scenarios leads cyclic dependencies agents best response depends vice versa This result multiple solutions feature captured generalised cyclic causal models 838 chain graphs 59 probabilistic relational models 3362 credal networks 14 In mechanised structural causal games solutions correspond different equilibria induced serial relations representing potentially nondeterministic decisionmaking processes agents game agent selects decision rule arg max operation example This essential modelling equilibria games agents indifferent decision rules The result relational causal model cycles formalism ﬁrst explored concurrently work 1 reference gametheoretic scenarios focus Perhaps similar work paper settable systems1 partly inspired generalised structural causal models capture optimisation equilibria learning 9596 In order deal cycles settable systems duplicate intervenable variables response setting variable indicate structural 1 We note GonzalezSoto et al deﬁne kind causal game 35 theirs essentially Bayesian game outcomes computed unknown causal model This simpler restricted setup settable systems causal games 4 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 function occurs In models emphasis causal analysis optimisation procedures relatively low level abstraction meaning algorithms agents select actions procedures select equilibrium explicitly instantiated In contrast causal games represent causal dependencies arising fact agents select decision rules rationally nondeterministically leading ask ﬁrstorder causal queries Settable systems concentrate problems capture data attributes machine learning process focus problems identifying subgames equilibrium reﬁnements Despite differences settable systems nonetheless useful comparator causal games The concurrency semantics community produced work intersection games causal ity Much inﬂuential recent work foundations denotational semantics uses distributed games based event structures partially ordered model discrete events 69 deterministic 81 probabilis tic 98 concurrent games Other related approaches concurrent games use simpler mathematical formalisms 11101 Though containing primitive concepts works motivated primarily problem deriving formal lowlevel semantics programs probabilistic systems interested highlevel models strategic interactions applied wide range scenarios disciplines Indeed closely related causal models context analysing AI systems deﬁne notions blame intent singleagent multiagent settings 2839 harm 80 incentives control respond certain variables 2257 495567102 social inﬂuence 46 reasoning patterns manipulation signalling 76 We Sections 4 7 causal games subsume models works allow richer concepts Aside analysing AI systems relevant domain application economic analysis mechanism design For example Toulis Parkes use behavioural causal model determine longterm effects policy interventions multiagent economies 92 emphasis dynamical systems behavioural analysis regulators UKs Financial Conduct Authority include informal causal chain costbeneﬁt analyses proposing policy analyses 25 We provide formal case study second example Section 7 2 Background We assume basic familiarity probabilistic graphical models game theory completeness brieﬂy review Pearls causal hierarchy 73 gametheoretic models extensive form games EFGs 5494 multi agent inﬂuence diagrams MAIDs 51 Readers familiar models safely skip sections Throughout paper use capital letters V random variables lowercase letters v instantiations bold letters V v respectively sets variables instantiations We let domV denote domain V default assume domV ﬁnite abuse notation somewhat writing domV V V domV PaV denotes parents variable V graphical representation paV instantiation PaV We deﬁne ChV AncV DescV FaV PaV V children ancestors descendants family V respectively note AncV DescV contain V convention As paV instantiations written lowercase We use cid5domV denote set probability distributions values V write cid5dom A domB bdomB cid5dom A express set conditional probability distributions CPDs A given values B Unless indicated use superscripts indicate agent N 1 n subscripts index elements set example decision variables belonging agent denoted D D 1 D m 21 Causal models Pearls causal hierarchy consists kinds model associational interventional counterfactual 73 Each step hierarchy demands stricter assumptions The lowest level association pertains correlations variables allow predictions For suﬃcient use observational data construct joint probability distribution variables represented graphically Bayesian network BN On second level wish reason effects interventions deliberate alterations variables outside This requires edges BN reﬂect causal associational relationships giving rise causal Bayesian network CBN The ﬁnal level hierarchy concerned counterfactual questions asking happened different given certain observation corresponds conditioning associational queries intervening Answering questions requires knowledge underlying deterministic relationships variables typically characterised structural causal model SCM 211 Association Deﬁnition 1 73 A Bayesian network BN set random variables V joint distribution PrV structure M G θ G V E directed acyclic graph DAG vertices V edges E Markov compatible Pr meaning Prv θ θV We drop parameters θ θV V V CPDs notation unambiguous V V Prv paV cid2 5 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 A C B D E A EC A C B D EB ED b Fig 1 A CBN Markov compatible joint distribution Pra b c d Pra c d Prb d Prd c Prc b An SCM representing Each variable V associated exogenous parent EV E We use dseparation graphical criterion identify set conditional independencies Markov com patible joint distribution DAG G satisfy 74 Deﬁnition 2 73 A path p DAG G V E sequence unrepeated adjacent variables V A path p said blocked set variables Y V p contains A chain X W Z X W Z fork X W Z W Y A collider X W Z W AncY Y For disjoint sets X Y Z set Y dseparates X Z denoted X G Z Y path G variable X variable Z blocked variable Y Otherwise X said dconnected Z given Y denoted X cid10G Z Y For example graph G shown Fig 1a A cid10G B C active path A D B A G B D conditioning D blocks connection aforementioned path path A C D B If X G Z Y G X Z probabilistically independent conditional Y sense Prx y z Prx y written X Z Y distribution Pr Markov compatible G Pr y z 0 Conversely X cid10G Z Y X Z dependent conditional Y distribution Markov compatible G 93 A second wellestablished graphical criterion useful auxiliary result Section 3 Deﬁnition 3 86 Given DAG G variable V requisite probability node Prx y exist parameterisa tions θ cid10 θ cid11 differing θV Prx y θ cid10 Prx y θ cid11 G BNs M Mcid11 Lemma 1 31 Given BN M variable V requisite probability node query PrX Y MV cid10mG X Y 212 Intervention Associational models BNs general insuﬃcient answer questions interventions joint distribution changes response causal model level model causal Bayesian network CBN required The graph underlying CBN differs BN causal interpretation directed edges represent fact intervening variable affect causally upstream The simplest form intervention hard intervention doY y sets values variables Y y We denote resulting joint distribution Pr yV equivalently PrV y 732 Deﬁnition 4 73 A causal Bayesian network CBN BN M G θ G Markov compatible Pr y Y V y domY cid3 Pr yv paV 1 Prv paV V Y paV consistent y V Y v consistent y By Law Total Probability Pr yv paV 0 v inconsistent y When paV inconsistent y conditioning zeroprobability event means Pr yv paV undeﬁned More generally soft intervention speciﬁed partial distribution I variables Y replaces CPD PrY PaY new CPD IY Pa Y Y Y Y Y differ PaY 3 Any intervention I set variables Y leads new joint distribution Pa θ 2 This known atomic 13 structural 21 surgical 73 independent 52 intervention 3 A soft intervention known parametric 21 dependent 52 intervention referred conditional stochastic deterministic stochastic respectively 13 Hard interventions special case IY Pa Y δY y y domY δ Kronecker delta function 6 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 A C B d A C BIcid11 D b Fig 2 The graph Gd representing CBN Fig 1a hard intervention doD d b A similar graph GI IB Pa Pa PaB C B B soft intervention PrI v cid4 Y Y I y pa Y cid4 V V Y Prv paV We represent intervention I Y graphically outlining variable Y Y replacing variable Y cid10 PaY More generally use PrV I Y I removing adding edges parent variables necessary Pa PrI V interchangeably denote new graph model GI MI respectively When I hard intervention simply sever incoming edges Y setting values y write V y G y M y respectively Examples hard soft interventions shown Figs 2a 2b respectively Y 213 Counterfactuals In counterfactual queries evidence actual state world informs hypothetical scenario variables modiﬁed For instance interested probability x scenario y given fact observed z written Prx y z To answer questions general appeal level causal hierarchy structural causal model SCM In SCMs variables partitioned exogenous endogenous sets E V respectively endogenous variable V V deterministically related parents structural function f V domV V domE domV speciﬁes mechanism governing values variable stochasticity relegated distribution PrE θ exogenous variables In paper simplifying assumption SCMs Markovian meaning variable V exactly exogenous parent EV exogenous variables independent We depart convention scribing SCMs particular form CBN turn particular form BN deterministic distributions PrV PaV δ endogenous variable V This equivalent formulation prove useful avoiding unnecessary repetition notation introducing causal models games Section 4 cid6 V f V PaV cid5 Deﬁnition 5 73 A Markovian structural causal model SCM CBN M G θ G E V E DAG exogenous variables E EV V V endogenous variables V PaV E EV The parameters θ assign determin EE PrE θE istic distributions Prv paV exogenous variables θV endogenous variable stochastic distribution PrE θ cid2 Using model evaluate general counterfactual query PrxI z following steps 73 1 Update Pre Pre z conditioning observation z abduction 2 Apply intervention IY Pa 3 Return marginal distribution Prx modiﬁed model prediction Y variables Y action By convention exogenous variables viewed realm observation intervention Further assume IY Pa Y deterministic function parents Soft stochastic interventions modelled adding new exogenous variable E Pa cid7 Note marginalising exogenous variables SCM form standard CBN joint distribution e Prv e This CBN Markov compatible SCMs graph G restricted variables V Moreover Prv CBN BN Thus model causal hierarchy seen generate lower levels query answered lower level model answered higher level model Y Y 22 Gametheoretic models We review important formalisms representing sequential strategic decisionmaking scenarios extensive form games EFGs multiagent inﬂuence diagram MAIDs Both models illustrated following example signalling game 90 Example 1 Job market A worker hardworking lazy hoping hired ﬁrm They option pursuing university education know suffer years studying especially lazy 7 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 4 3 1 1 3 2 2 0 j j g V 1 1 g V 2 1 V 2 2 j h p j I 2 1 V 0 I 2 2 h 1 p V 2 4 V 2 3 g V 1 2 g j j j j 5 3 0 1 5 2 0 0 T U 1 U 2 D 1 D 2 b Fig 3 An EFG representing Example 1 b A MAID representing game For interpretation colours ﬁgures reader referred web version article The ﬁrm prefers hardworkers automated hiring observe workers education temperament 221 Extensive form games The material EFGs required Section 6 safely skipped referred later depending readers preferences Deﬁnition 6 54 An extensive form game EFG structure E N T P A λ I U N 1 n set agents T V E game tree nodes V partitioned sets V 0 V 1 V n L R V root T L leaves T V 0 chance nodes V decision nodes controlled agent N The nodes connected edges E children chance node V 0 j P P 1 P V 0 set probability distributions P jChV 0 A set actions Ai j λ E A labelling function mapping edge V I I 1 In contains collection information sets I 2V k V I deﬁned V j V k l j Each information set I j nodes A denotes set actions available V j V l action Ai j partition decision nodes controlled agent I j available actions Ai A V A V j k l U L Rn utility function mapping leaf node vector determines ﬁnal payoff agent Fig 3a shows Example 1s signalling game extensive form Nature chance node V 0 ﬂips biased coin root tree decide worker hardworking h probability p lazy h probability 1 p The workers decision g avoid g university represented nodes V 1 V 1 automated hiring V 2 option offer job reject worker j j systems decisions given V 2 3 V 2 The nonsingleton information sets marked dotted black lines represent fact hiring receive workers temperament input 2 V 2 1 V 1 1 V 2 2 4 The payoffs worker ﬁrm given ﬁrst second elements leaves tree respectively The worker receives payoff 5 given job offer incur cost 1 going university hardworking cost 2 going university lazy The ﬁrm receives payoff 3 hire hard worker If offer job lazy worker incur cost 2 reject hard worker incur opportunity cost 1 j Ai j actions available agent information sets I Deﬁnition 7 Given EFG E N T P A λ I U behavioural strategy σ agent set probability distributions j σ 0 1 fully stochastic σ j A strategy proﬁle σ σ 1 σ n tuple strategies σ σ 1 σ i1 σ i1 σ n denotes partial strategy proﬁle agents σ σ σ j A strategy pure σ j 0 Ai 8 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Combining strategy proﬁle σ distributions P deﬁnes probability distribution P σ paths ρ E For path ρ beginning R terminating leaf node ρL L agent receives utility U ρLi ith entry corresponding payoff vector Agent expected utility strategy proﬁle σ given Eσ U ρLi cid8 cid9 Deﬁnition 8 A subgame EFG E N T P A λ I U game E restricted subtree T V k V information set I V k V l E cid11 V l V j E exists V k I I j V V cid11 cid11 cid11 j cid11 E cid11 T cid11 V cid11 V k V l E In words subtree original game tree forms subgame closed information sets descen dants Any EFG trivially subgame subgame strictly smaller subtree called proper In paper denote subgames EFGs enclosing dashed boxes For instance EFG Fig 3a proper subgames EFG given later Fig 8c 222 Multiagent inﬂuence diagrams Inﬂuence diagrams IDs generalise BNs decisiontheoretic setting adding decision utility variables 4565 multiagent inﬂuence diagrams MAIDs generalise IDs introducing multiple agents 5164 MAIDs viewed BN graph parameters decision variables technically lie levels Pearls causal hierarchy decisions effectively modelled causal interventions 43 paths nondecision variables need encode causal relationships 22 Deﬁnition 9 51 A multiagent inﬂuence diagram MAID structure M G θ G N V E speciﬁes set agents N 1 n DAG V E V partitioned chance variables X decision variables D iN D utility variables U iN U The parameters θ θV V V D deﬁne CPDs PrV PaV θV nondecision variable parameterisation decision variable CPDs resulting joint distribution V induces BN cid10 cid10 Fig 3b shows MAID representing Example 1 Chance variables workers temperament hard working lazy T denoted white circles Decision utility variables represented squares diamonds respectively The workers decision D1 utility U 1 variables displayed red ﬁrms D2 U 2 blue Instead information sets fact agent unaware value certain variable making decision represented missing edge absence edge T D2 The parameters θ deﬁne conditional distributions variables T U 1 U 2 accordance values shown Fig 3a cid11 set decision rules πD D D Deﬁnition 10 Given MAID M G θ decision rule πD D D CPD πD D PaD partial policy proﬁle cid11 cid11 D write πD cid11 set decision rules D D D πD A behavioural policy π refers π D behavioural policy proﬁle π π 1 π n tuple policies π π 1 π i1 π i1 π n A decision rule pure πD d paD 0 1 fully stochastic πD d paD 0 d domD decision context paD domPaD holds policy proﬁle holds decision rules policy proﬁle By combining π partial distribution Pr chance utility variables obtain joint distribution Prπ x d u Prv paV πD d paD cid4 cid4 V V D DD variables M inducing BN The expected utility agent given policy proﬁle π deﬁned U U Eπ U This allows Nash equilibrium NE 68 deﬁned expected sum utility variables BN identiﬁes outcomes game agent simultaneously playing bestresponse4 cid7 Deﬁnition 11 51 A policy proﬁle π Nash equilibrium NE MAID agent N π arg max ˆπ domcid2i cid7 U U E ˆπ π U KM deﬁne strategic relevance srelevance 51 concept infer choice decision rule affect optimality decision rule They srelevance determined graphical criterion sreachability In follows use capital letters variables cid7D cid3 different values πD θ A detailed introduction notation provided Section 31 4 In Section 51 build whats known NE MAIDs explaining difference mixed policies behavioural policies MAIDs clarifying NE guaranteed exist 9 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Deﬁnition 12 51 Let Dk Dl D decision nodes MAID M cid7Dl strategically relevant srelevant cid7Dk exist joint distributions V parameterised cid3 policy proﬁles π π cid11 respectively decision rule πDk cid7 U U E ˆπD π D U arg max ˆπD domcid7D πDk π differs π cid11 πDk arg max ˆπD domcid7D 05 Prπ cid11 paDk cid7Dl cid7 U U E ˆπD π cid11 D U decision rule πD agrees πDk paDk Proposition 1 51 cid7Dcid11 srelevant cid7D cid7Dcid11 cid10Gcid11 U DescD D PaD cid7D sreachable cid7Dcid11 Gcid11 cid11 G additional variable cid7Dcid11 edge cid7Dcid11 D Both srelevance sreachability consider decision rules matter particular assumption rationality agents corresponding notion subgame perfectness In Section 3 generalise idea consider parameterisation nondecision variables key reasoning causality games We gen eralise concepts assumptions agents rationality By considering directed necessarily acyclic graph variables cid2D cid7D DD edge cid7Dcid11 cid7D cid7Dcid11 srelevant cid7D called srelevance graph KM introduce weakening perfect recall assumption suﬃcient existence NE Deﬁnition 13 51 Agent MAID M perfect recall exists topological ordering D1 Dm D FaD j PaDk 1 j k m M said perfect recall agents M perfect recall Deﬁnition 14 64 Agent MAID M suﬃcient recall srelevance graph restricted agent decision rules acyclic The MAID M said suﬃcient recall agents suﬃcient recall6 Proposition 2 51 Any MAID suﬃcient recall NE behavioural policies 3 Mechanised MAIDs relevance Although MAIDs allow elegantly concisely represent dependencies variables game edges graph tell story Indeed gametheoretic models traditionally presented objects solved procedure produce solutions policy proﬁles left extrinsic game representation However fact agents act strategically means agents policies dependent parameters game agents policies ways crucial causal reasoning explicitly represented MAIDs In section introduce mechanised MAIDs allow model dependencies alongside existing dependencies MAID This representation fundamental causal reasoning games Section 4 introduction subgames MAIDs Section 52 In following subsections ﬁrst deﬁne mechanised MAIDs formally introducing concept relevance corresponding graphical criteria 31 Mechanised MAIDs In order explicitly capture implicit dependencies decision rules CPDs MAID M G θ mechanised MAID mM adds elements graphical representation decision rules parameters descrip tion depend 311 Mechanised graphs For ﬁrst addition extend G form mechanised graph mG For decision variable D new parent cid7D representing decision rule added nondecision variable V new parent cid6V representing parameters CPD We additional parents mechanism variables M determine mechanisms values variables game set7 variables V original MAID objectlevel variables To distinguish different types mechanism variable refer decisions cid2 MD decision rule variables nondecisions cid3 MV D parameter variables 5 This ﬁnal condition included order ensure πDk doesnt lead poor decisions decision contexts occur probability zero 6 Note suﬃcient recall deﬁned srelevance graph similar criterion created set rationality relations R resulting Rrelevance graph 7 This partially inspired ﬁeld mechanism design agents act reporting types t T mechanism f T O determines type proﬁle view d mapped outcome o O game view v 10 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 cid10 cid5 M cid7D cid7D cid6 DD In mechanised graph mG add new edges E cid11 mechanism variables decision rule variables This represents fact agents typically select decision rule πD value cid7D based parameterisation game values cid3 selection decision rules game π D For example worker ﬁrms hiring Example 1 want select decision rules πD1 πD2 function probability p worker hardworking temperament T h This imply edges cid6T cid7D1 cid6T cid7D2 maximal Pacid7D In general agent select decision rules based value mechanism variable E cid11 MV D typically variables relevant E cid11 maximal notion precise Section 32 A mechanised graph mG Example 1 shown Fig 4a decision rule parameter variables represented black white rounded squares respectively 312 Mechanised games For second addition M description decision rules parameters depend specify values new mechanism variables determined CPDs original objectlevel variables deﬁned function new mechanism variable parent Beginning note parameterisation mV D θ domcid3 game policy proﬁle mD π domcid2 resulting joint distribution V written Prπ v θ Prv m cid4 V V Prv paV mV Prv paV mV simply CPD Prv paV θV deﬁned parameters θV mV V nondecision variable decision rule πD d paD deﬁned πD mV V decision variable D As given parameters θ MAID M policy proﬁle π distribution V mM identical original MAID Finally specify values mechanism variables determined For parameter variables simply set distribution cid6V δcid6V θV let domain given cid5domV domPaV Intuitively viewed fact particular game induced graph corresponds instantiation parameter variables mechanised game values known agents8 In order provide values decision rule variables introduce set rationality relations R r D DD assumptions agents choose decision rules Concretely decision rule cid7D governed serial relation r D domPacid7D domcid7D 9 This accounts fact agent deterministically choose single decision In remainder paper abuse notation r D pacid7D setvalued rule πD response pacid7D function denote set decision rules πD r D pacid7D πD 10 Deﬁnition 15 Given MAID M G θ set rationality relations R mechanised MAID structure mM mG θ R mechanised graph mG N V M mE directed possibly cyclic graph V M edges mE E MV V V V E cid11 R r D DD set rationality relations r D domPacid7D domcid7D serial relation cid5 M cid7D cid7D E cid11 DD cid10 cid6 As example let suppose agent Example 1 plays best response respect In case values cid7D1 cid7D2 determined relations RBR rBR D1 rBR D2 πD rBR D pacid7D πD arg max ˆπD domcid7D cid11 U U E ˆπD π D U 1 D D note expectation despite fact notation includes objectlevel variables mV D πD Note games agent deﬁned terms mechanism variables pacid7D decision rule gives rise NE deﬁned Deﬁnition 11 In words values mechanism variables determine CPDs objectlevel variables turn deﬁne joint distribution objectlevel variables expected quantities game Many kinds gametheoretic equilibria naturally deﬁned terms rationality relations including subgame perfect equilibria trembling hand perfect equilibria introduced Section 5311 8 This simply amounts common prior assumption Though assumption relaxed introduces additional complexities address work 9 A serial relation r A B A exists b B b r 10 Whether refer r D pacid7D domcid7D r D pacid7D domcid7D typically unambiguous 11 It possible deﬁne R example agent randomises actions decision chooses action minimises expected utility Whilst hard view behaviour rational gametheoretic sense think R deﬁning degrees rationality game 11 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 cid6T cid6U 1 cid6U 2 T U 1 U 2 D 1 D 2 cid6T cid6U 1 cid6U 2 cid7D1 cid7D2 cid7D1 cid7D2 b Fig 4 A mechanised graph mG representing Example 1 Dotted edges represent present RBRminimal sminimal mechanised graph Dashed edges represent present sminimal mechanised graph b The RBRrelevance graph formed removing dotted edges srelevance graph removing dashed edge It visually useful restrict mechanised MAID mechanism variables seen Fig 4b We view mechanised graph simply composition original MAID graph mechanism variables addition edges MV V V V 313 Rational outcomes If rationality relations R MAID satisﬁed π π Rrational outcome game For example RBRrational outcomes MAID M representing Example 1 simply NEs M Note Rrationality merely convenience reasoning games performs necessary role fully characterising process decision rules generated As later nature chosen rationality relations allows deduce facts game purely graphical structure In essence results hinge links agents choose decision rules objectlevel variables depend Deﬁnition 16 Given mechanised MAID mM πD r D pacid7D Rrational response pacid7D The set Rrational policy proﬁles partial policy proﬁle π D mM Rrational outcomes game tend drop R terms unambiguous denoted RmM cid11 Rrational πD r D pacid7D D D cid11 In general Rrational outcomes mM deﬁne set distributions Prπ π RmM variables V Prπ v θ Prv m mD π mV D θ extended mechanised MAID Prv m Prv mδMm We view mechanised MAID set BNs induced Rrational outcomes12 The key point rationality relations form principled formal highly general way model inherent nondeterminism game order render model suitable causal reasoning Note Deﬁnition 16 related notion solution cyclic causal models 18 In formalisms solution corresponds joint probability distribution consistent cyclic relationships general model solutions This turn impact answers causal queries wish ask explain Section 4 Similarly view rational responses decision variable credal set 60 resultant model form credal network 14 imprecise probabilities arise fact rational outcome game Remark 1 Often agents boundedly rational 89 For example computational costs agents seek satisﬁce optimise expected utility leading cid12approximate variations equilibria concepts agent improve expected utility cid12 0 deviating 16 These bounded rationality conditions captured rationality relations 12 We continue highlight different variable types diagrams drawing variable chance variable clarity exposition 12 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 32 Relevance A natural question ask edges mechanised graph mG necessary In words elements Pacid7D necessary computing rational response r D pacid7D In mechanised game shown Fig 4a example dont need know θU 2 order compute set best responses πD1 given πD2 Whenever mechanism variable MV irrelevant cid7D sense remove edge MV cid7D independence explicit Removing irrelevant edges results subgraph mRG mG minimal respect R In extreme case decision rules chosen independently mechanism variables edges E cid11 mechanism variables pruned We subgraph mG independent mechanised graph13 mG Gametheoretic models break independent causal mechanism assumption states mechanisms causally probabilistically independent 75 Formally following deﬁnitions similar spirit proposed earlier work 516470 differ consider case nondeterministic rationality relations encode solutions game Deﬁnition 17 Given mechanised MAID mM rationality relations R MV Pacid7D Rrelevant cid7D exists pa pacid7D cid11 r D pacid7D cid10 r D pa cid7D differ MV pacid7D cid11 cid10 pa cid7D cid11 cid7D Deﬁnition 18 Given mechanised MAID mM rationality relations R mechanised graph mG Rminimal denoted mRG contains edge MV cid7D MV Rrelevant cid7D When mRG restricted mechanism variables M refer Rrelevance graph denoted rRG Deﬁnition 17 property game mechanising rationality relations Therefore immediate follow question given choice R identify Rrelevance prune edges order ﬁnd Rminimal graph MAID M G θ simply appealing underlying graph G form R For natural choices R case derive sound complete graphical criteria identifying Rrelevance For given R refer criteria Rreachability For example graphical criteria deﬁning RBR reachability Proposition 3 enable remove dotted edges cid6U 1 cid7D2 cid6U 2 cid7D1 Fig 4a Proposition 3 MV RBRrelevant cid7D MV cid10mG U DescD D PaD MV cid10mG PaD D D U DescD cid10 By applying Rreachability mG ﬁnd Rminimal mechanised graph mRG Rrelevance graph rRG This object repeated use viewed generalisation KMs concept relevance graph simpliciter include mechanism variables opposed decision variables use R14 To avoid confusion refer KMs relevance graph srelevance graph By generalising srelevance Deﬁnition 12 sreachability Proposition 1 mechanism variables Fig 4a example cid6T srelevant cid7D1 RBRrelevant Our generalisation idea srelevance different rationality relations parallels development equi librium reﬁnements MAIDs introduced Section 53 opposed singular concept introduced KM For instance shall Section 53 srelevance corresponds concept subgame perfectness Moreover use mechanised graph opposed simply restriction decision rule variables important rea soning gametheoretic notions equilibria subgames critical reasoning causality games agents adapt policies response interventions mechanism variable representing decision rules 321 Generalising soundness completeness results We conclude section noting possible generalise proof procedures Propositions 3 1 choices R The key step identify decision variable D suﬃcient sound minimal complete set queries QD Q values given m π θ completely determine r D Formally let Qm set probabilistic queries Prπ x y θ X Y V formed MAID given m π θ Note use queries express expected utilities things For decision variable D looking suﬃcient minimal subset queries QD Q truthvalued function g D πD r D mV D g D cid5 cid6 QD m domV 2 13 Dawid 18 diagram extended inﬂuence diagram investigate dependencies relationships mechanisms 14 Note directions edges relevance graphs paper 51 reversed compared 50 42 KM refer V relevant toreachable D phrase terms MV relevant toreachable cid7D 13 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Fig 5 In paper introduce CGs SCGs The causal hierarchy associational interventional counterfactual forms vertical axis number agents 0 1 n forms horizontal axis Note models diagram mechanised In setting asking MV Rrelevant cid7D reduces asking choice mV affect Prπ x y QD turn equivalent asking V requisite probability node Prπ x y 86 introduced Deﬁnition 3 Whether variable requisite probability node determined wellestablished graphical criterion 31 given Lemma 1 We use criterion establish graphical criteria Rreachability given judicious choice QD sound complete For example graphical criteria Propositions 1 sreachability 3 RBRreachability cor respond choices Qs D QBR D Prπ ui descD d paD Prπ ui descD d paD Prπ paD respectively With soundness completeness result hand identify Rrelevance graph follows rRG contains edge MV cid7D MV Rrelevant cid7D r D pacid7D vary value MV QD pacid7D πD vary value MV V requisite probability node Prπ x y QD MV cid10mG X Y Prπ x y QD Deﬁnition 18 Deﬁnition 17 2 Deﬁnition 3 Lemma 1 4 Causality games Many types queries gametheoretic scenarios For instance recalling Example 1 ask questions corresponding 1 Predictions Given worker went university wellbeing b Given worker decides university wellbeing 2 Interventions Given worker forced university wellbeing b Given worker goes university selected lottery wellbeing 3 Counterfactuals Given worker didnt university wellbeing b Given worker decides university wellbeing decided university Although queries ostensibly similar belong different levels causal hierarchy Predictions answered mechanised MAIDs associational models reside level However order reason interventions counterfactuals games require models levels respectively To end introduce causal games CGs structural causal games SCGs These viewed generalising MAIDs causal setting CBNs SCMs gametheoretic setting The connections models acronyms displayed Fig 5 Importantly models row special case row models column generalise column left As deﬁned respect MAIDs mechanised games Deﬁnition 15 equilibrium reﬁnements introduce Section 5 welldeﬁned CGs SCGs Note asking queries objectlevel variables queries 1a 2a 3a policy proﬁle π chosen mechanised games allow ask queries mechanism variables queries 1b 2b 3b ﬁxing policy While distinction postpolicy prepolicy queries signiﬁcant case predictions shall Section 42 difference corresponds agents adjust policies response intervention This distinction critical gametheoretic settings apply standard causal models contain strategic decisionmaking agents Similarly standard gametheoretic models explicitly represent dis tinction dependencies agents decisions aspects game explicitly captured 14 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Table 1 Examples queries ask causal models games corre sponding listed section Recall domD1 g g indicating worker goes university πD1 ˆπD1 πD1 denote possible values decision rule variable cid7D1 For example πD1 query 1b decision rule worker decides university πD1 D 1 T δD 1 g As introduced Section 2 Prx y denotes probability x given hard intervention Y y Prx y z represents counterfactual probability x y true given fact z true Postpolicy b Prepolicy 1 Prediction Prπ u1 g Pru1 πD1 2 Intervention Prπ u1 g Pru1 ˆπD1 3 Counterfactual Prπ u1 g Pru1 πD1 g πD1 Computationally prepolicy interventions correspond altering original game calculating outcomes post policy interventions correspond calculating outcomes original game altering In sense queries natural analogue existing work work unify types query formalism In remainder section types causal queries represented examples written formally Table 1 answered causal games Doing requires identify level causal hierarchy query belongs assess query prepolicy postpolicy It simple combine pre postpolicy queries mechanised games clarity brevity 41 Predictions Each policy proﬁle π MAID M induces BN joint distribution Prπ V θ We easily compute probability x given observation z written Prπ x z given policy proﬁle π Note distribution Prπ V θ MAID equivalently written mechanised MAID PrV m m π θ However gametheoretic settings typically assume rational outcome game chosen unique π Moreover reason favour rational outcome implying ought evaluate queries respect set policy proﬁles In deﬁnition consider distribution Prπ x z induced rational outcome consistent observation z Note remarked Section 31 rational outcomes Deﬁnition 19 Given mechanised MAID mM rationality relations R answer conditional query prob π RmMz RmM z π RmM ability x given observation z given set Pr Prπ z 0 set conditional rational outcomes In general Z V M include mechanism variables compute Prπ x z M Prx z m cid11 mM M cid11 M Z mD π cid13 Prπ x z Rx z cid12 More generally view queries games ﬁrstorder queries deﬁned formulae π free variable ϕπ Prπ x z The answers queries welldeﬁned free variable bound considering set answers Deﬁnition 19 For example bind π quantifying cid5 π RmM z q 0 1 ﬁrstorder logics reasoning ϕπ q verifying multiagent systems 1256100 returning bounds maxπ RmMz ϕπ credal networks 14 Above quantify RmM z possible quantify desired set policies posit prior distribution Prcid2 policies These queries strictly generalise BNs models settable systems 9596 effectively consider single instantiation cid2 cid6 By way illustration let return Example 1 query 1a earlier section We interpret question asking expected utility worker given observation went university written Eπ U 1 g policy π For worked examples section assume p PrT h 1 2 automated hiring worker playing best responses R RBR The rational outcomes induced choice NEs game 1 The worker chooses g The hiring chooses j worker chose g choose j 2 The worker chooses g T h chooses g probability 1 2 The hiring chooses j worker chose g choose j probability 4 5 3 The worker chooses g The hiring chooses j worker chose g choose j probability q 0 1 probability q 0 3 5 15 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Ru1 g yields Eπ U 1 gπ RmMg 7 The expected utilities worker rational outcomes 5 4 7 2 respectively In query 1a conditional rational outcomes RmM g NEs consistent observing D1 g To answer query compute Pr 2 4 As noted Deﬁnition 19 employed observations mechanism variables For example query 1b condition observation workers strategy given δD1g refer πD1 worker decides university Based use mechanised MAID compute Note set distinct answer query 1a Pr observations mechanism objectlevel variables provide different information RmM πD1 cid10 RmM g In particular observations mechanism variables serve primarily rule certain rational outcomes conditioning decision rules conditioning parameter variables tells deterministic distributions parents Ru1 πD1 EU 1 πD1 π RmM πD1 7 2 One advantage computing predictions MAIDs opposed EFGs instance exploit conditional independencies graph For example interested likely worker hardworking given went university hired T G D2 D1 implies Prπ h g j Prπ h g policy proﬁle π When answering queries objectlevel variables mechanised MAIDs implicitly condition values mechanism variables represent fact game policy consideration ﬁxed For example query Prπ h g j M given Prh g j m mM mD π Hence T cid10mG D2 D1 T mG D2 D1 M expected 42 Interventions Interventional queries concern effect causal inﬂuences outside This especially interesting case games interventions affect environment selfinterested agents adapt policies response In order answer queries edges MAID reﬂect causal structure world This gives rise following deﬁnition viewed simply CBN parameters decision variables Note causal games form MAID support associational queries introduced preceding section CBNs compute interventional associational queries Deﬁnition 20 A causal game CG M G θ MAID parameterisation decision variable CPDs π induced model joint distribution Prπ V CBN Unlike CBNs CGs let ask effect intervention policy proﬁle selected refer pre postpolicy queries respectively Asking effect intervention particular policy proﬁle π selected query 2a simply performing interventional query CBN joint distribution Prπ Asking effect intervention policy proﬁle selected query 2b means agents aware intervention selecting decision rules react effects In words intervention viewed producing slightly different game agents knowingly play Our key observation prepolicy interventions modelled interventions mechanism variables mechanised CG ensures effects propagated processes agents select decision rules This additional mechanism variables outgoing edges mechanised CG represent causal potentially nondeterministic processes parameterisations objectlevel variables selected Postpolicy interventions turn modelled standard interventions objectlevel variables We write mMI intervention I contain prepolicy postpolicy interventions This uniﬁcation pre postpolicy interventions key beneﬁts mechanised models Indeed post policy interventions prepolicy interventions parameter variables deﬁned exactly CBNs pre policy intervention decision rule variable cid7D corresponds replacing r D domPacid7D domcid7D new cid10 Pacid7D As conditional queries deﬁnition mirrors r D introduced cyclic causal models 8 cyclic dependencies governed relations instead functions 1 quantify set rational outcomes consistent given intervention domcid7D Pa cid7D domPa cid7D Deﬁnition 21 Given mechanised CG mM rationality relations R answer interventional query π RmMI RmMI probability x given intervention I variables Y given set Pr set interventional rational outcomes mechanised MAID mMI rationality relations R r cid7D Y r D cid7D Y parameters determined Prcid3I Note I fully postpolicy rational outcomes remain RmMI RmM Y V cid13 Prπ xI RxI D cid12 To illustrate ideas let return Example 1 queries 2a 2b Query 2a concerns postpolicy intervention worker forced university unbeknownst ﬁrms hiring words hiring observe fact computing decision rule To compute workers expected utility calculate g perform hard intervention doD1 g mechanised game shown Fig 6a As set rational Pr Ru1 16 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 cid6T cid6U 1 cid6U 2 cid6T cid6U 1 cid6U 2 T U 1 U 2 T U 1 U 2 g D 2 D 1 D 2 cid7D1 cid7D2 ˆπ 1 cid7D2 b Fig 6 A mechanised game showing hard postpolicy intervention doD1 g incoming edges D1 severed b A mechanised game showing hard prepolicy intervention docid7D1 ˆπ 1 incoming edges cid7D1 severed Ru1 g cid12 cid13 Prπ u1 g 2 2 7 3 cid13 π RmM π RmM results outcomes change postpolicy intervention Pr cid12 Note unlike query 1a fact D1 g tells value T Eπ U 1 g causally upstream intervention D1 Therefore wellbeing worker decrease sent university lazy To answer query 2b concerning prepolicy intervention compute Pru1 ˆπD1 g h ˆπD1 g h 1 represents aforementioned lottery selects students attend university randomly probability 1 2 This time ﬁrm modiﬁes hiring observing intervention denoted I shown Fig 6b hiring computes decision rule new set rational outcomes given RmMI ˆπD1 πD2 πD2 r D2 pacid7D2 In words set cid7D1 ˆπD1 hard intervention allow hiring best respond decision rule r D2 Note RmMI cid10 RmM ˆπD1 NE game contains decision rule ˆπD1 The lottery removes signalling effect going university resulting optimal policy hiring offering job worker expected utility 17 4 π RmMI Eπ U 1 ˆπD1 ˆπD1 cid12 cid13 2 Remark 2 In previous work soft interventions objectlevel variables V modelled hard interventions mechanism variable MV 18 While viewed essentially equivalent singleagent case15 possible dependencies mechanism variables mechanised games mean types intervention markedly different effects multiagent setting The difference pre postpolicy interventions results difference information available agents decisions chronology play game case structure EFGs 43 Counterfactuals The ﬁnal type question investigate arises combine predictions interventions query 3a Given worker didnt university wellbeing Such questions counterfactual combine observations actual world worker didnt university questions pertaining counterfactual world university Answering queries games signiﬁcantly nuanced complex preceding subsections To ﬁrst consign stochasticity set exogenous variables variable causal game Just SCM variable V associated exogenous variable EV governed deterministic CPD Prπ V PaV EV PaV Deﬁnition 22 A Markovian structural causal game SCG M G θ causal game exogenous endogenous variables E V deterministic parameterisation decision variable CPDs π induced model joint distribution Pr π V E SCM 15 To precise true agent suﬃcient recall Deﬁnition 14 17 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 ET EU 1 EU 2 cid6ET cid6EU 1 cid6E U 2 T U 1 U 2 cid6T cid6U 1 cid6U 2 D 1 D 2 cid7D1 cid7D2 ED1 ED2 cid6ED1 cid6E D2 b Fig 7 A Markovian SCG representing Example 1 Note included exogenous variables U 1 U 2 stochastic strictly necessary b The RBRrelevance graph game An SCG seen SCM parameters decision variables Given policy π recover SCM explain Meanwhile mechanised SCGs viewed special case relational causal model cycles 1 When mechanise SCGs introduce mechanism variables exogenous variables seen Fig 7b view objectlevel exogenous children realm observation intervention SCMs As mechanism variables exogenous variables largely ignored As SCMs interventional distributions IV Pa V deterministic soft interventions deﬁned introducing new exogenous V 13 With caveats place prepolicy postpolicy predictions interventions V Pa variable E deﬁned model described 41 42 respectively While computing predictions interventions SCGs relatively straightforward main diﬃ culties arise computing counterfactuals The ﬁrst choice represent stochastic decision rules structural functions exogenous variables second problem updating beliefs policy proﬁle played counterfactual world given evidence policy proﬁle played actual world We resolve diﬃculties turn 431 Decision rules structural functions We assume agents play kind game regardless level causal hierarchy model In games behavioural play equates selecting decision rules stochastically sample decision condi tional value nonexogenous parents In structural causal games represent decision rules structural functions exogenous variables One proposal view agent choosing struc tural decision rule πD D PaD distribution PrED shared mechanism parent cid7D D ED This leads different type signature decision rules leads formalism prepolicy terventions upstream stochastic variables ruled SCMs We propose equivalent formulation agent controls decision variables exogenous parents Unfortunately assumptions rationality agents tell CPDs assigned decision variables insuﬃcient telling precise deterministic mechanisms agents use implement CPDs function stochastic exogenous variable In fact chose explicitly restrict form mech anism stipulating belongs parametric class typically inﬁnitely deterministic functions induce particular distribution decision variable 6 Without specifying functions general possible answer counterfactual queries games precise form functions impact answers queries 18 In essence choice represent decision rule πD cid5domD domPaD ED stochastic exoge nous variable ED deterministic mechanism πD cid5domD domPaD choice decision rule assume remains ﬁxed counterfactual worlds ED vary πD Assuming preexisting knowledge representation propose stay true spirit behavioural policies viewing agents randomisation independent Decision rules sense learning agents random choice decision rule πD uninformative settings agent different decision rule π cid11 D Decision contexts sense agents decision rule πD naturally interpreted independently sampling action d seeing assignment paD nonexogenous parents PaD PaD ED 18 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 We formalise assumption representing exogenous variable ED set containing variable E πD cid5domD domPaD paD domD ED random ﬁeld inde pendently distributed elements Given stochastic decision rule πD D PaD deﬁne canonical structural representation setting domPaD domE πD paD D πD paD D PrE πD paD D πD D d paD eD δDe d πD d paD πD paD D 3 note πD effectively parameterised πD πD D PaD ED πD The joint distribution ED 7 Proposition 4 follows immediately16 means simply product probability distributions E continue interpret decision rules policy proﬁles rationality relations MAIDs CGs agent plays πD r D pacid7D cid5domD domPaD πD parameterises πD Moreover additional structure allows generalise deﬁnition counterfactuals SCMs counterfactuals games πD paD D Proposition 4 For distributions ED D governed equations 3 onetoone correspondence set stochastic decision rules cid5domD domPaD set deterministic decision rules dom cid7D cid5domD domPaD cid14 Moreover given corresponding decision rules πD πD πD d paD eD PreD deD πD d paD domED 432 Counterfactual rational outcomes The second diﬃculty answering counterfactual queries games arises possible existence multiple rational outcomes If evidence equilibrium π played actual world extent inform equilibrium π cid11 played counterfactual world values mechanism variables changed To answer question begin introducing approach answering counterfactual queries SCGs mirrors Pearls approach SCMs described Section 21 That condition intervene compute resulting distribution generalise observations interventions objectlevel mechanism variables In particular compute set Pr RxI z follows 1 For actual rational outcome π RmM z update Pre Prπ e z abduction 2 Apply intervention I variables Y recomputing rational responses form π cid11 adding new exogenous variables E form E cid11 E E 3 Return marginal distribution nal outcome π cid11 prediction required action cid14 cid11 Pre x e cid11 Prπ cid11 domE cid11 cid11 modiﬁed model new counterfactual ratio In ﬁrst step update beliefs exogenous decision rule variables actual world π second apply intervention I form counterfactual world recompute rational outcomes based change return new set distributions consistent beliefs ﬁrst step results intervention second step By reading steps carefully notices diﬃculty SCGs arise SCM condition z ﬁrst step obtain set policies RmM z rational actual world Then step compute new rational responses π cid11 RmM z features counterfactual world ﬁnal step This raises question extent knowledge rational policies RmM z compute π cid11 π cid11 Let ﬁrst note I postpolicy intervention impact rational outcomes counter factual world simply actual world given RmM z diﬃculty The issue arises prepolicy counterfactuals query 3b Given worker decides university wellbeing decided university intervention query 3b workers decision rule means set rational outcomes counterfactual world different actual world Because policy proﬁle π decision rules πD formalise question asking decision rule variables cid2I cid2 invariant intervention I Written terms threestep process π I π cid11I invariant decision rule variable cid7 cid2I counterfactual decision rule π cid11 D equal actual decision rule πD Those invariant values recomputed new counterfactual model For instance argued I postpolicy cid2I cid2 That values decision rule variables need recomputed How choose cid2I I fully postpolicy There multiple principles invoked order choice The simplest let simplicity principle recompute values decision rule variables cid2I In words intervention 16 Though note constructions result properties merely present particularly simple example 19 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 means bets intervention actual rational outcomes RmM z bearing counterfactual rational outcomes Under principle computing prepolicy counterfactuals reminiscent approach taken existing work cyclic causal models 8 sets solutions induced halves twin graph The problem principle require ignore information gathered observation z For example Z z implies cid7D πD actual world I causally downstream cid7D effect value cid7D means know cid7D πD counterfactual world cid7D cid2I To solve problem instead invoke closest possible world principle retain information possible knowledge rational policies RmM z While values decision rules need recomputed keeping cid2I large possible avoid need resolving entire game provide accurate answer counterfactual queries The process computing cid2I principle slightly complicated involves propagating effects intervention models contain cycles nondeterminism In remainder paper employ simplicity principle keeping prior work17 An algorithm computing cid2I according closest possible world principle provided Appendix B1 reference 433 Deﬁning counterfactuals games Given set invariant decision rule variables cid2I answer produced threestep process given written follows Deﬁnition 23 Given mechanised SCG mM rationality relations R answer counterfactual query probability x given observation z intervention I variables Y given set RxI z Pr cid12cid14 cid11 Prπ cid11 domE xI e e Pre Prπ e z cid13 cid11 π π cid11RmMI z E E cid11 E newly added exogenous variables result soft intervention RmMI z cid12 π π cid11 RmM z RmMI π I π cid11 cid13 I set actualcounterfactual rational outcomes cid2I set invariant decision rule variables Note I fully postpolicy rational outcomes remain cid2I cid2 RmMI z π π π cid13 RmM z Y V cid12 In deﬁnition Pr RxI z actual policy π counterfactual policy π cid2 compute product quantities Prπ e z updated distribution exogenous variables π corresponds ﬁrst step If cid11 E capture stochasticity I leads term I soft intervention add variables E term Prπ cid11 Finally Pre The set RmMI z deﬁnes pairs policies step marginalise exogenous variables E consider Namely actual rational outcomes π RmM z counterfactual rational outcomes π cid11 RmMI decision rules invariant I denoted cid2I remain π I π cid11I compute value xI π cid11 cid11 18 We condition e e xI e e E We brieﬂy demonstrate step process returning queries 3a 3b To answer 3a compute Prπ u1 g First note involves postpolicy intervention need consider actual rational g outcomes cid2I cid2 Thus π RmM g begin updating Pre Prπ e g In case update amounts changing Prπ eT eD1 eD2 Prπ eT eD1 eD2 g note independently update πD paD π endogenous decision context paD Following apply intervention doD1 g The E D π RmMg ﬁnal answer query simple case given Pr We cid13 g Prπ u1 g g Ru1 g g cid12 cid12 cid13 π RmMg 7 2 Query 3b involves hard prepolicy intervention I sets cid7D1 π D1 As cid2I answers query In particular game cid13 π cid11 π cid11 π RmMI given interventional outcomes RmMI πD1 RmMI RmM π D1 answer answer query 1b cid12 Eπ U 1 g Remark 3 The reasons choosing CG SCG model given problem analogous respective reasons choosing CBN SCM Using reason counterfactuals pathspeciﬁc effects questions identiﬁability 5 The simpler formalism requires knowledge precise functions holding variables making CGs attractive choice require features listed 17 In practice queries 3a 3b happens case principles lead answer 18 Note distribution fresh exogenous variables depend policy actual counterfactual 20 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 B U 1 U 2 B U 2 D 1 D 2 D 2 cid6B cid6U 1 cid6U 2 cid6B cid6U 2 cid7D1 cid7D2 cid7D2 b V 1 1 q q V 2 1 p1 V 2 2 p1 p2 p2 2 5 4 4 1 5 2 6 c Fig 8 A MAID M G θ representing Example 2 srelevance graph b The smallest proper ssubdiagram Gcid11 c A reduced EFG proper subgames corresponds possible ssubgames Gcid11 D 1 q D 1 q respectively G srelevance graph 5 Solution concepts subgames In Section 3 explained set rationality relations capture process agents choose decision rules mechanisms agents need consider In section build ideas subsections Firstly distinction mixed behavioural policies relation NEs MAIDs Secondly introduce concept subgames MAIDs analogously EFG counterparts allow analyse solve parts game independently Finally introduce equilibrium reﬁnements MAIDs discussed relation EFG counterparts Section 62 With contributions aim place causal games equal footing EFGs tool gametheoretic analysis Note SCGs reﬁnements MAIDs results section apply models Concepts section explained help following example shown Fig 8a Example 2 Warehouse robots Two robots working warehouse Robot responsible fulﬁlling orders decide quickly slowly It break moves slowly break moves quickly Robot responsible keeping warehouse tidy decide patrol observe robot If patrols robot repair broken items obstruct robot prevent completing order Robot rewarded fulﬁlling orders quicker better penalised breaking things Robot rewarded warehouse ending state repair incurs small energy cost patrolling To parameterise game let suppose robot breaks moves quickly D1 q probability 2 patrols D2 p 3 break robot obstructs robot probability 1 1 probability zero Finally deﬁne utility functions robot receives reward 5 2 completing order quickly slowly respectively incurs penalty 3 breakages Robot receives reward 6 state repair incurs penalty 1 patrolling Given parameterisation easily calculate expected payoff agent possible action combinations For reference Fig 8c EFG bifurcates robots decisions chance variable B marginalised create reduced EFG detailed Appendix 61 51 Nash equilibria A solution concept aims identify subset possible outcomes game occur agents act rationally In noncooperative games fundamental solution concept Nash equilibrium NE 68 policy proﬁle agent beneﬁt unilaterally deviating In Example 2 instance policy proﬁle π NE robot chooses D1 q robot chooses D2 p value D1 NE Previous work introduced concept MAIDs recalled Deﬁnition 11 51 fully characterise NE guaranteed exist MAID This existence depends class policies agents permitted choose So far paper viewed agents employing behavioural policies agent selects decision rules decisions independently In contrast mixed policy allows agent coordinate choice decision rules different decisions distribution pure policies In follows use dot denote determinism pure policies μ denote mixed policies 21 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Deﬁnition 24 Let dom cid7D set possible pure decision rules D recall write domV V V domV A mixed policy agent μi cid5dom cid2D behavioural policy π domcid2D pure policy π dom cid2D Proposition 5 A behavioural policy NE guaranteed exist MAID Nashs theorem establishes ﬁnite game guaranteed NE long agents allowed choose mixed policies 68 However general guarantee agents permitted use behavioural policies example Appendix B2 Despite negative result behavioural policies regarded natural representation agents randomising decision point instead beginning game 72 Moreover behavioural policies respect conditional independencies MAIDs graph As inter esting question NE behavioural policies guaranteed exist As ﬁrst step relatively straightforward prove analogue Kuhns theorem agents game perfect recall agents forget past moves information knew previously introduced Deﬁnition 13 NE behavioural policies guaranteed exist 54 Lemma 2 Let π cid5domD partial behavioural mixed policy proﬁle agents N MAID M If agent perfect recall M mixed policy μi exists behavioural policy π Prμi π v Prπ π v domPaD Proposition 6 In MAID M perfect recall exists behavioural policy proﬁle π NE Going MAIDs reveal conditional independencies variables weaker criterion suﬃcient recall suﬃcient existence NE behavioural policies KM implicitly prove result included Proposi tion 2 proving Algorithm ﬁnding NE converges certain conditions correspond suﬃcient recall 51 Appendix B2 provides example MAID agents suﬃcient imperfect recall In example exists mixed policy proﬁle behavioural policy resulting distribution outcomes There NE behavioural policies On hand MAID suﬃcient recall NE behavioural policies example given Appendix B2 Proposition 7 If agent MAID M perfect recall suﬃcient recall However agent suﬃcient recall perfect recall 52 Subgames Subgames EFGs represent parts game solved independently rest introduce analogous notion Rsubgames MAIDs These subgames uses allow introduce equilibrium reﬁnements Section 53 reduce cost computing equilibria 42 allow analyse agents decisionmaking isolation parts game useful forms analysis discussed Section 7 In Appendix C2 demonstrate second facts empirically showing subgames MAIDs compute NEs eﬃciently EFGs However key differences subgames EFGs MAIDs Firstly MAIDs explicitly represent conditional independencies variables ﬁnd subgames MAID corre sponding EFG Secondly ability solve game independently varies solution concept Rsubgames vary R Given set graphical criteria Rreachability Section 32 identify structure Rsubgames refer Rsubdiagram underlying graph Deﬁnition 25 Given mechanised MAID mM mG θ R set sound complete graphical criteria R cid11 N possessing relevance Rreachability refer subgraph V decision variables subgraph Rsubdiagram Gcid11 N cid11 E cid11 G set agents N cid11 E cid11 cid11 V cid11 cid11 V V cid11 contains variable Z M Z Rreachable cid7D D V variable lies directed path X cid2cid2cid3 Y G contains X Y V cid11 As drop R notation unimportant unambiguous The ﬁrst condition V ensures decision variable D subdiagram variable mechanism impact rational response D included graph This means rational responses decision rules game independent happens The second condition says additional cid11 22 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 T U 1 U 2 U 1 U 2 U 1 U 2 U 2 D 1 D 2 D 1 D 2 D 2 D 2 cid6T cid6U 1 cid6U 2 cid6U 1 cid6U 2 cid6U 1 cid6U 2 cid6U 2 cid7D1 cid7D2 cid7D1 cid7D2 b cid7D2 c cid7D2 d Fig 9 A MAID M G θ modiﬁed version Example 1 ﬁrms proﬁts function workers decision temperament resulting srelevance graph The graph G improper ssubdiagram game improper ssubgame Figures b c d illustrate remaining proper ssubdiagrams G srelevance graphs variables included subdiagram long mediators included This ensures CPDs variables subgame remain consistent allows deﬁne correspondence subgames MAIDs subgames EFGs Section 62 To ﬁnd subgames subdiagram update parameterisation remaining variables consistent original game structure graph Deﬁnition 26 Given mechanised MAID mM mG θ R Rsubgame M new MAID Mcid11 Gcid11 θ cid11 cid11 θ cid11 Prv Gcid11 cid11 z θ z instantiation variables Z V V 19 An Rsubgame feasible exists policy proﬁle π Prπ z 0 Rsubdiagram G θ cid11 deﬁned Pr cid11v cid2 Rsubgames R Rreachability In particular sreachability produces ssubgames ways natural form subgame MAIDs connection subgames EFGs shown formally Section 62 In remainder paper speciﬁed focus attention case Note MAID Rsubgame Rsubgame strictly smaller set variables called proper Rsubgame For example MAID Example 1 shown Fig 3b proper RBRsubgames cid7D1 cid7D2 RBRreachable 521 Identifying subgames MAIDs Before continuing note conditional dependencies captured MAIDs allow richer stronger notion subgames EFGs Not different notions Rsubgame introduced different rationality relations possible identify subgames rule noncredible threats MAID corresponding EFG This seen considering minor variation Example 1 Suppose ﬁrm new vacancy important worker hardworking lazy studied university In words U 2 function D1 D2 T The game graph srelevance graph example shown Fig 9a Note structure EFG shown Fig 3a change payoffs ﬁrm As proper subgames EFG hiring making decision D2 observe value T proper subtree closed descendants information sets In contrast recognise proper ssubdiagrams shown Figs 9b 9c 9d equivalent MAID Each ssubdiagrams ssubgames associated owing values T ssubdiagram Fig 9b values D1 ssubdiagrams Figs 9c 9d 53 Equilibrium reﬁnements When NE exists useful specify additional criteria rule plausible outcomes This cor responds making additional assumptions rationality agents encoded stricter rationality relations Below provide deﬁnitions important equilibrium reﬁnements subgame perfect equilibria 85 trembling hand perfect equilibria 84 MAIDs Later Section 62 provide proofs equivalences deﬁnitions EFGs 19 In fact easily appreciated setting z variables child V cid2 matter 23 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 531 Subgame perfect equilibrium The concept subgame perfect equilibrium SPE introduced EFGs order eliminate NEs containing non credible threats choices agent sequential game best carry given opportunity 8485 In MAIDs rule noncredible threats ensuring agent plays best response feasible ssubgame In games suﬃcient recall SPE behavioural policies constructed performing backwards induction ssubgames ﬁnding NE technique Appendix C2 allows NE computed eﬃciently corresponding EFG However agent game insuﬃcient recall SPE exist allowing mixed policies Appendix B2 example Deﬁnition 27 A policy proﬁle π MAID M subgame perfect equilibrium SPE π NE feasible ssubgame M restricted subgame20 Proposition 8 Any MAID M suﬃcient recall SPE behavioural policies Recall π NE Example 2 introduced Section 51 robot chooses D1 q robot chooses D2 p value D1 We immediately feasible ssubgame D1 q ssubdiagram smallest ssubgame shown Fig 8b choosing D2 p noncredible threat resulting expected utility 5 instead 6 robot Instead example SPE policy proﬁle π SPE robot chooses D1 q robot chooses D2 p D1 q Under policy proﬁle robot achieves optimal expected utility feasible ssubgames given robot following policy robot receives expected utility 2 regardless quickly Before continuing note rationality relations allow capture arbitrary sets policy proﬁles rational outcomes including equilibrium reﬁnements section For example agent decision rational outcomes RBRmM simply NEs M easily seen inspection Equation 1 Deﬁnition 11 Similarly MAID M let denote MD set feasible ssubgames containing D deﬁne πD rSP D pacid7D πD arg max ˆπD domcid7D E ˆπD π cid11 D U Mcid11 MD cid11 U U V cid11 expressing agent plays best response decision rule ssubgame containing decision In words π RSPmM π cid11 RBRmMcid11 ssubgame Mcid11 π restricted decision variables Mcid11 If M suﬃcient recall RSPmM SPEs game stated formally While representations slightly cumbersome encoding equilibria rationality relations facilitates use Rrelevance Rreachability This offers principled way identify independencies useful causal gametheoretic reasoning M π cid11 Proposition 9 Suppose MAID M suﬃcient recall Then set SPEs M equal set rational outcomes RSPmM 532 Trembling hand perfect equilibrium In SPE agents decisions assumption SPE played proper subgames As result optimality strategies robust events agents mistakes tremble small probability To solve problem stipulate agent play best response leading NE perturbed game 84 Let ζk perturbation vector containing D D d domD decision context paD value cid12paD 1 Then given game M perturbed game Mζk 0 1 deﬁned decision rule πD forced πD d paD cid12paD ddomD cid12paD cid7 d d d Deﬁnition 28 A policy proﬁle π trembling hand perfect equilibrium THPE MAID M sequence kN limk cid22ζkcid22 0 perturbed MAID Mζk NE π k perturbation vectors ζk limk π k π For example policy proﬁle π SPE THPE To suppose robot trembles probability cid12 0 D1 q cid12cid11 0 D1 q Then robot ones expected utility playing q 2 2cid12 playing q 2 cid12cid11 Therefore NE perturbed game robot play q probability One THPE given policy proﬁle π THPE robot chooses D1 q robot chooses D2 p D1 q Note twoagent game THPEs rule weakly dominated policies In example robot ones policy choosing D1 q weakly dominated policy choosing D1 q weakly dominated policy 20 Note notion subgame perfectness generalised choices rationality relations 24 L Hammond J Fox T Everitt et al 6 Connections EFGs Artiﬁcial Intelligence 320 2023 103919 EFGs widely studied model dynamic strategic decisionmaking Despite intuitive appeal treebased models concise reveal underlying structure game DAGbased models use paper With said natural question gametheoretic deﬁnitions MAIDs Section 5 successfully capture familiar concepts EFG counterparts lose working MAIDs SCGs instead In section concerns unwarranted gametheoretic concepts preserved convert representations We begin brieﬂy describing algorithms maid2efg efg2maid imple ment conversions Using procedures provide equivalence results deﬁnitions Section 5 Following brieﬂy discuss treebased models causal reasoning certain cases 61 Transformations We brieﬂy summarise procedures converting MAIDs EFGs A formal treatment Appendix A1 611 From MAID EFG There ways convert MAID M G θ EFG E differ computational costs 5174 The basic idea employed KM use topological ordering variables G construct E s game tree splitting variables order This splitting required fact variable G deﬁnes happens given context setting parent variables node E deﬁnes happens context path taken reach node As end exponentially nodes E variables G By querying CPDs variable branches chance nodes labelled probabilities based path taken root tree node similarly utilities assigned leaf branches decision nodes labelled possible actions available Given nodes corresponding decision variable D G assign information set values taken ancestors paths root tree node agree variables PaD Note topological ordering regard output maid2efg set EFGs possible ordering Remark 4 This procedure eﬃcient marginalising variables U FaD reduced EFG Example 2 shown Fig 8c 22 leaves opposed 23 leaves resulted retained variables original MAID Fig 8a Importantly information reduced EFG suﬃcient computing equilibria offer signiﬁcant eﬃciency gains cost solving EFG depends size exponential length In codebase 27 implement eﬃcient transformation originally described KM conjunction Gambit popular tool solving EFGs 63 612 From EFG MAID By encoding CPDs variable MAID trees opposed tables MAIDs represent game exponentially space EFG 51 In general MAIDs represent given EFG For instance converting EFG representation Fig 3a Example 1 MAID naïvely create decision variable information set Alternatively recognise example V 1 1 V 1 2 correspond realworld variable workers choice university combine shown Fig 3b information sets second agent combined Whether nodes represent variable EFG matter domain knowledge external EFG knowledge typically exists creating model game lost viewing interaction EFG By formalising notion question nodes belong intervention set provide procedure efg2maid described fully Appendix A11 maps EFG unique canonical MAID Deﬁnition 29 An intervention set J EFG E set chance nodes information sets belonging agent leaves Every node V J V I J No path root E leaves passes J J number children Moreover valid partition information sets chance variables intervention sets require path node V J V I J J passes intervention sets reaching J In efg2maid assume intervention sets given absence knowledge simply choose intervention set singleton The resulting MAID remain equivalent EFG sense described 25 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 following subsection compact The basic idea conversion ﬁrst view game tree MAID add missing edges node ancestors whilst merging nodes intervention set single variables Incoming edges variable V value observed decision D removed PaD duplicate edges produced merging nodes Each leaf intervention set split utility variable agent The distributions variable V formed context paV summing relevant probabilities sets merged edges 62 Equivalences Using transformations derive equivalence results EFGs MAIDs demonstrate fundamen tal gametheoretic notions subgames equilibrium reﬁnements Section 5 preserved converting representations We begin deﬁning mean game representations equivalent lying idea behavioural policy strategy spaces game corresponding behavioural policy strategy proﬁle lead expected utility agent games An imme diate consequence NEs preserved Deﬁnition 30 We MAID M equivalent EFG E vice versa bijection agent f cid14i domcid2i strategies E partition policies M quotient set domcid2i equivalence relation π ˆπ π ˆπ differ infeasible decision contexts U U Eπ U f σ iN f iσ We refer π f σ agent Eσ f natural mapping E M U ρLi cid7 cid8 cid9 Lemma 3 Let f natural mapping E M Then σ NE E π f σ NE M The reason use equivalence relation space policies efg2maid introduce additional infeasible decision contexts paD Prπ paD 0 π corresponding paths EFG exist An agents choice decision contexts bearing outcome game meaning safely abstract away Any natural mapping suﬃcient preserving essential gametheoretic features representation unique We begin supporting lemma justiﬁes correctness procedures maid2efg efg2maid forms basis results Lemma 4 If E maid2efgM M efg2maidE E M equivalent This lemma follows directly construction natural mapping f procedures maid2efg efg2maid respectively The intuition information sets EFG correspond feasible decision contexts MAID behavioural strategy proﬁle σ EFG corresponds behavioural policy proﬁle π MAID vice versa The following result direct corollary Lemma 3 Lemma 4 Corollary 1 If E maid2efgM M efg2maidE natural mapping f E M σ NE E π f σ NE M For subgame E cid11 EFG shown variables outside E cid11 srelevant corresponding This means subgames EFGs equivalent counterparts equivalent MAID established add payoff agents order equate change value constant agent ssubgame Mcid11 following proposition A minor caveat utility variables occur Mcid11 value setting variables outside Gcid11 expected utilities E cid11 policy proﬁle effect decisions For subgame Mcid11 deﬁnes Mcid11 Proposition 10 If E maid2efgM M efg2maidE natural mapping f E M subgame E cid11 M equivalent modulo constant difference utilities agent policy Mcid11 natural mapping f restricted strategies E cid11 E ssubgame Mcid11 E cid11 This restriction f strategies E cid11 precise considering feasible decision contexts correspond information sets contained E cid11 By ﬁrst applying Proposition 10 Lemma 3 resulting subgames SPE M carried E We note s subgames MAID equivalent EFG criterion subgame perfectness slightly stronger MAID In words SPEs EFG SPEs equivalent MAID This additional strength useful ruling noncredible threats fall particular subgame EFG 26 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Corollary 2 If E maid2efgM M efg2maidE natural mapping f E M π f σ SPE M σ SPE E Finally derive equivalence THPEs EFGs MAIDs In order suﬃces prove equivalence perturbed versions corresponding games Eζk Mζk easily construction maid2efg efg2maid applying Lemma 4 Lemma 3 perturbed games Proposition 11 If E maid2efgM M efg2maidE natural mapping f E M σ THPE E π f σ THPE M This series equivalence results serves justify MAIDs appropriate choice game representation Not provide computational advantages EFGs preserve fundamental gametheoretic concepts commonly employed EFGs 63 Causality EFGs One alternative causal games deﬁne causal concepts directly EFGs In section explain limited set causal queries extending methods designed probability trees 32 explain shortcomings approach relative models focus paper 631 Interventions Intuitively interventions EFGs correspond replacing probability distributions governing nodes game tree More formally consider EFG E intervention sets intervention set singleton recover case EFG variable treated separately As CGs apply pre poststrategy interventions operations form We intervention I intervention set J replacing P j σ j V j V j J AncV j V j J Hard interventions arbitrary probability distribution P represent special case distribution given δV jv j v j corresponds outgoing edge node V j J Prestrategy interventions result performing intervention game tree agents choose strategies essence forming new game EI poststrategy interventions result intervening probability tree results agents chosen strategies words forming new distribution P σ I paths tree j V j V j J AncV j σ j While graph EFG typically viewed encoding informational constraints decisions agents opposed temporal causal structure given causal interpretation way MAID BN restricting EFG consistent set possible hard interventional distributions This restriction produces level model interventional queries described paragraph semantically meaningful Due total ordering imposed EFGs variables game restricted subset interventions available distributions I condition ancestors node question Similarly queries probabilistic causal EFGs welldeﬁned fact general variables assigned value path ρ root leaf 632 Counterfactuals Answering counterfactual queries slightly complicated We brieﬂy existing procedure probability trees refer interested reader work details 32 Suppose wish calculate P σ xI z value X V Y Z taken Y distributed according I given fact z true The Z z 1 equivalent ﬁrst performing hard intervention ﬁrst step condition z setting P Z z 1 σ doZ z renormalising probability distributions branches upstream intervention The second step perform soft intervention I Y renormalising Thirdly ﬁnally restore probability distributions branches downstream second intervention original settings given P σ The resulting probability tree describes poststrategy counterfactual distribution P σ xI z By modifying procedure normalisation upstream Z restoring distributions downstream Y takes place according actual strategy proﬁle σ allowing agents play new counterfactual strategy proﬁle σ cid11 produce prestrategy counterfactual distribution conditioning performed downstream differences σ σ cid11 resulting distribution general correct Counterfactual queries EFGs invariant choice tree representation distributions P σ strategy proﬁle σ This diﬃculty arises standard EFGs reside level causal hierarchy overcome CBNs CGs relegating stochasticity set exogenous chance nodes appear game tree allowing agents select deterministic strategies endogenous decision nodes function exogenous noise This resolves diﬃculties prepolicy counterfactuals EFGs updates conditioning z upstream differences σ σ cid11 Existing work probability 27 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 trees 32 hand treats stochasticity endogenous possible learn counterfactual world variables upstream intervention I The ordering variables tree implicitly represents substantive modelling assumption resolves subtle complexities surrounding counterfactuals models intrinsic stochasticity 1773 7 Applications Having described analysed theoretical features causal games consider potential domains applica tion In ﬁrst subsection provide case study based UK home insurance market In second discuss existing concepts analysis artiﬁcial agents embedded developed framework We provide worked examples embeddings Appendix B3 More substantive results yond scope paper fundamental aim lay theoretical foundations causal games explore speciﬁc applications 71 Case study insurance pricing While primary motivation use causal games analyse AI systems natural domain application economics causal gametheoretic modelling common For example regulator UK proposes policy intervention required conduct costbeneﬁt analysis justify This entails making comparison consequences intervention consequences intervention andor alternative interventions Some regulators Financial Conduct Authority FCA include causal chain analyses heuristic diagrams formal causal models In case study demonstrate usefulness causal games economic analysis example based UK home insurance market worth 631 billion 2021 34 focus recent FCA report 25 711 The model In setting customers inert change insurance provider year year ﬁrms charge low price attract customers ﬁrst year increase prices renewal inert customers end paying savvy customers spend time negotiating switching provider year This allows ﬁrms increase proﬁts customers expense increased prices inert switching costs savvy These practices especially troubling vulnerable customers older educated individuals likely exploited 61 While focus aforementioned FCA report conceivable use sophisticated AI algorithms set insurance prices based customer details potentially lead greater degree exploitation A simpliﬁed model setting follows Example 3 Insurance market A customer duopolistic insurance market choose insurance provider aims minimise costs They contract providers decide renew switch The customer savvy case modelled having low switching cost inert case modelled having high switching cost The ﬁrms use internal pricing algorithms offer quotes simultaneously knowledge ﬁrm customer existing contract knowledge customers type savvy inert order maximise proﬁts We represent setting causal game M agents Fig 10a parameterise model real world data pricing strategies consumer tendencies UK home insurance market period 201318 252661 The ﬁrms agents use pricing algorithms decide prices d1 d2 N insurance premiums based ﬁrm customer agent currently contract c 1 221 The customer uses information type T savvy s inert s choose ﬁrm d3 1 2 purchase insurance exit market Firm utility proﬁt assumed given policy price di minus marginal cost providing policy selected customer zero The customers utility deﬁned valuation policy minus price pay switching costs extra term customer inert model searching switching cost prohibitively high The customers utility zero exit market The chance variables C customers current ﬁrm T customers type parameterised following values Table 10b 712 The proposed intervention In aforementioned report FCA proposes ban insurance companies setting different prices new existing customers 25 Because ﬁrms aware intervention deploying pricing algorithms 21 In practice ﬁrms prices bounded marginal cost supplying policy point customer exits market prices high 28 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 C T D 1 U 1 D 3 U 3 U 2 D 2 Average Quantity Marginal cost supplying policya Customer valuation policy Switching cost customer Savvy customersb Customers currently ﬁrst ﬁrm Amount 206 296 38 72 p aThis quantity estimated average received policy ﬁrms 231 minus average proﬁt policy 25 25 In practice small fees affect ﬁrms rev enue bTaken selfreport actively searching new policies 25 b Fig 10 A causal game representing Example 3 b Data UK home insurance market period 201318 252661 parameterise game represent prepolicy intervention cid7D1 cid7D2 More concretely corresponds changing rationality relations r D1 r D2 restricting codomains domcid71 domcid72 πD1 D1 C πD1 D1 πD2 D2 C πD2 D2 effectively removing edges C D1 C D2 shown dashed Fig 10a In follows denote intervention I The FCA offers number hypotheses likely effects intervention The percentage customers switching reduce ii Switching customers end paying higher prices renewing customers end paying lower prices iii Overall customers end better average Representing intervention causal game M allows express hypotheses formally measuring quantifying causal effects I general formal causal model For purpose analysis set p 06 assume agents play pure THPE truly realistic illustrates realworld applications causal games capture boundedly rational agents In follows denote rationality relations describing assumption R Before addressing hypotheses simple exercise π RM ﬁrms end setting minimal prices equal marginal cost new customers higher prices renewing customers point driving away sales switching costs customers In words πD D C 3 δD 206 πD D C δD 244 1 2 For customers seek lowest price taking account switching costs indifferent price alternative ﬁrm price current ﬁrm plus switching cost After intervention I customers policy stays πD1 D1 C δD1 288 πD2 D2 C δD2 250 pricing algorithms respectively π RMI The rational outcomes original game correspond savvy customers ﬁrms switch ﬁrm Depending customers ﬁrm ﬁrst ﬁrm second ﬁrm ﬁrms switch 0 432 288 72 customers switching respectively After intervention I customers second ﬁrm incentive switch percentage customers switching 0 432 If assume uniform prior rational outcomes instance causal effect I percentage customers switching insurance provider given 1 RMI cid11 switchπ 1 RM cid11 π RM switchπ 216 36 144 π RMI cid7 switchπ conﬁrmed Prπ D3 C 3 probability customer switches provider Thus hypothesis For ﬁrst hypothesis ii wish measure causal effect I quantity Eπ D C D3 3 1 2 settings Prπ C D3 3 0 For π RM quantity equal 206 occur 1 2 For π RMI quantity equal 250 occurs 2 customer switches ﬁrm This conﬁrms ﬁrst half hypothesis For second similar analysis shows renewing customers pay 244 intervention 250 288 intervention contrary hypothesis We discuss reasons following paragraph proposal employed achieve desired result Hypothesis iii concerns simply causal effect I Eπ U 3 The customers expected utility rational outcomes interventional rational outcomes respectively write simply Eπ U 3 I Eπ U 3 2312 52 2888 29 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 As case second half hypothesis ii disconﬁrms hypothesis model The reason results relatively high switching costs customers 38 relatively high percentage inert customers 28 mean ﬁrms pricing algorithms better sticking higher prices exploit customers switch lower prices order attract customers away ﬁrms To achieve desired effects instead consider intervention proposed FCA reduce switching costs customers example allowing stop insurance policy autorenewing easily 25 If consider second intervention Icid11 makes change I modiﬁes cid6U 3 set switching costs customers 0 example Eπ U 3 Icid11 Eπ U 3 72 52 20 πD D C δD 224 1 2 π RMIcid11 Returning hypothesis ii implies customers pay 224 renewing opposed 244 completing set desired outcomes 713 Extensions As shown analysis investigate qualitative hypotheses forwards FCA provides quantitative results Nevertheless emphasise model present highly simpliﬁed considers simple intervention More complex models queries scope present paper represent natural avenue applied work Before continuing brieﬂy remark possible extensions First extend model realistic This include increasing number ﬁrms different marginal costs different ﬁrms different customer valuations insurance policies different ﬁrms small costs ﬁrms customers switching including intermediary ﬁrms explicit modelling ﬁrms pricing algorithms making savviness binary variable modelling market time instead oneshot game With added complexities model come greater opportunities exploit richness causal games In particular simple model lack intricate causal dependencies agents actions means applying prepolicy intervention essentially reduces resolving slightly different game dashed edges Fig 10a removed In larger games easier important avoid cost general avoided models EFGs explicitly represent causal structure game We use model advanced analyses answering counterfactuals identifying subgames computing mixtures pre postpolicy queries 72 Blame intent incentives fairness Many important concepts reasoning safe ethical use AI systems implicitly causal nature Moreover recent years substantial progress formalising concepts causal models 2239556680 Because causal games ﬁrst causal framework explicitly capture multiagent gametheoretic reasoning open possibility work directions In follows explain causal games applied existing concepts order arrive richer general results Concrete examples concepts modelled causal games provided Appendix B3 721 Blame intent SCMs fruitfully employed order formally deﬁne notion actual causation means event c fact cause event e 3740 Such ideas philosophical argued crucial building AI systems automatically generate explanations workings agents 4166 In recent years underlying theory formalise concepts blameworthiness intention 2839 As works highlighted issues blame intent particularly acute multiagent settings While concepts accommodated structural causal games Appendix B3 allow richer formalism blame intent multiagent settings More speciﬁcally generalisations Firstly use sets utility variables deﬁne multiple utility functions agent mean costs blame intent viewed perspective multiple agents Secondly consider blame intent respect strategies single actions corresponds considering soft postpolicy interventions opposed hard postpolicy interventions Thirdly wish consider prepolicy interventions mechanised games For example prepolicy change agents decision means rational response second agent causes bad outcome think ﬁrst agent somewhat blame turn events concepts nuanced cyclic dependencies decision rule variables Finally extensions viewed terms coalitions agents strategies begun explored prior work 28 722 Incentives In order build intelligent agents behave undesirable ways useful able reason incentives 192257 reasoning patterns 376 For example given possibly multiagent decisionmaking scenario 30 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 interested asking agent incentive base policy protected attribute inﬂuence variable prefer left Similarly notions fairness naturally expressed terms different outcome result counterfactual situation Recent work sought formalise incentives modelling scenarios singleagent causal games causal inﬂuence diagrams This work developed number sound complete graphical criteria identifying Value Information VoI 44 Value Control VoC 87 Sound complete graphical criteria introduced novel concepts response incentives indicate decisionmaker beneﬁt responding variable instrumental control incentives establish agent beneﬁt manipulating variable 22 Existing work limited singleagent singledecision setting hope causal games provide basis generalising work multiagent multidecision setting use mechanised games lead additional insights For instance incentive concept C wish ask questions Rrational outcome agent N C incentive respect particular variable X game Given fact proposals safe AI systems multiagent 23 generalisation multiagent setting marks important step analysing agent incentives We provide example proposal cooperative inverse reinforcement learning 36 modelled causal game Appendix B3 723 Fairness Another important useful application incentives reasoning fairness number popular inﬂuen tial deﬁnitions based explicitly causal frameworks 4495567102 Indeed shown optimal policies π singledecision SCIM counterfactually unfair 55 respect protected attribute A meaning change protected attribute change decision RI A 22 The question fairness arguably important interesting multiagent setting ask process fair fair forced trade fairness respect different agents Interestingly despite large number existing works investigating fairness games seminal papers Rabin 79 Fehr Schmidt 24 recent insights gained causal deﬁnitions fairness best knowledge application deﬁnitions multiagent setting One possible partial explanation researchers lacking precisely kind models introduce 8 Discussion In paper introduced framework argue provides unifying formalism reasoning causality games As mentioned Section 1 combinations causal gametheoretic reasoning long considered research communities conclude brief summary relative advantages disadvantages causal games compared models offering ﬁnal thoughts future directions 81 Advantages disadvantages causal games The primary beneﬁt causal games compared prior work previous framework captured gametheoretic causal features general principled way Alongside discussion related work Section 12 expand brieﬂy claim considering causal gametheoretic models turn 811 Causal models Standard causal models account presence rational selfinterested agents Doing requires simple relabelling variables decisions utilities presence strategic decisionmaking agents violates standard assumption independent causal mechanisms 75 represented edges mech anism variables mechanised games Alternative causal models include agents CIDs 182245 typically consider single agent To best knowledge exception rule settable systems 9596 models capture multiplicity equilibria arise gametheoretic analyses naturally support analysis seek paper The focus works instead capturing lowerlevel algorithmic details appropriate reasoning data attributes optimisation machine learning process Our use nondeterministic mechanisms arising agents indifferent alternatives serves generalise existing work cyclic causal models 838 relational setting 13362 However cyclic dependencies causal games speciﬁc form fact represent gametheoretic equilibria means causal games necessarily appropriate model analysing arbitrary dynamical systems sets simultaneous equations studied works The fact build MAIDs means causal games inherit existing gametheoretic concepts introduced models NEs consistent standard probabilistic graphical models MAIDs based This allows derive notions subgames equilibrium reﬁnements 31 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 critical gametheoretic reasoning supported causal models Such concepts historically underexplored context graphical games compared EFGs strategicform games 812 Gametheoretic models The natural gametheoretic model compare causal games EFGs treebased models opposed DAGbased For purposes important beneﬁt DAGbased models readily natively support wide range causal queries This bolstered use Rrelevance graphs form explicit representation causal dependencies agents decision rules representation dependencies EFGs22 Mechanised games deﬁne wide range pre postpolicy queries games In contrast explained Section 63 causal queries natively answered EFGs DAGbased models compactly explicitly represent dependencies variables understood EFG inspecting parameterisation game Moreover DAGbased representation game need bigger corresponding EFG exponentially smaller On hand game highly asymmetric play paths play proceeds path game stops immediately path continues moves structure immediately observable causal game effectively valuations variables irrelevant inconsistency shorter game path In addition transparency MAIDs allow exploit conditional independencies variables dseparation Using Rreachability construct Rrelevance graph game ﬁnd subgames MAID equivalent EFG This signiﬁcantly reduce computational complexity solving game shown example Appendix C2 offers analytical beneﬁts provides way deﬁne stronger subgame perfectness condition On hand case contextspeciﬁc independencies A depends B B depends A wellknown DAGbased models natural choice treebased models 1023 Finally signiﬁcantly extended number standard gametheoretic concepts MAIDs causal games proved equivalence EFG counterparts EFGs remain wellinvestigated representation Thus interested exotic equilibrium reﬁnements example EFGs likely suitable model It hope research MAIDs causal games reduce difference 82 Future work Our priority use causal games analyse incentives multiagent systems important applications ensuring build AI systems safe fair As mentioned Appendix 72 existing work characterised incentives CIDs Therefore natural step extend deﬁnitions multi agent multidecision scenarios means trivial For example single agentsettings VoI nonnegative multiagent settings need case agents aware information gain 78 Further wish rule certain incentives based occur policy proﬁles satisfying particular equilibrium reﬁnement generally falling set rational outcomes Other speciﬁc applications causal games prove fruitful example designing mechanisms auc tions multiagent systems analysing possible interventions mechanisms generalising counterfactual fairness multiagent settings providing artiﬁcial agents means easily provide explanations reason qualitative concepts blame intent reasoning patterns deﬁned causal models games deriving new deﬁnitions similar concepts We hope extend framework presented model variations easily capture dynamic settings ﬁnegrained subjective beliefs optimisation deﬁ nitions capturing classic equilibrium reﬁnements perfect Bayesian equilibrium 29 sequential equilibrium 53 methods causal discovery games Given propose paper accompanying codebase robust foundation reasoning causality games believe work presents interesting avenues research We hope advantages causal games confer based generality explainability succinctness mention compatibility existing mainstream models attractive choice researchers practitioners alike interested intersection causality game theory Declaration competing The authors declare following ﬁnancial interestspersonal relationships considered potential com peting interests Coauthor previously served associate editor Artiﬁcial Intelligence journal 20092012 MW 22 This implies advantage structure dependencies order answer prestrategy queries eﬃciently 23 Though possible support said independencies DAGs treebased representations CPDs graphically capture different independencies different branches 32 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Data availability All data included paper Acknowledgements This paper signiﬁcantly expanded version previous publication 42 We thank Zac Kenton Jon Richens Ilya Sh pitser Colin Rowat Chris van Merwijk Patrick Forré David Reber Joe Halpern Paul Harrenstein Will Lee Vincent Conitzer anonymous reviewers helpful comments discussions completing work Hammond supported EPSRC Doctoral Training Partnership studentship Reference 2218880 Fox supported EPSRC Centre Doctoral Training Autonomous Intelligent Machines Systems Reference EPS0240501 Wooldridge supported UKRI Turing AI World Leading Researcher Fellowship Reference EPW0029491 Appendix A Proofs A1 Transformations game representations MAID EFG In section provide encoding transforming MAID M G θ EFG E N T P A λ I U One decide wants record structure original MAID wants optimise encoding splitting Gs variables If wants able preserve structure M set splitting variables resulting tree S X D24 If instead wishes minimise complexity computing equilibria needs split MAIDs decision variables parents S FaD 74 This EFGs tree size exponential S The following procedure refer maid2efg based KM 51 Given MAID M G θ deﬁne equivalent EFG E N T P A λ I U fol lows Choose topological ordering S1 Sn variables S Sk descendent S j S j Sk25 Further deﬁne S k S cid11 S S cid11 Sk The set agents N E M The tree T symmetric tree path containing splits variables S order deﬁned For variables S S S chance variable S X add E s set chance nodes V 0 Else S decision variable S D add S agent set nodes E V Label node V T instantiation μV corresponding values taken EFG node branch followed node path trees root node R V For node V T corresponding variable S V S chance variable M determine cid11 ChV child corresponds value sv domS V cid11 Pr This equation probability distribution P V ChV 0 1 children V querying variables CPD instantiation label V In words P V V simpliﬁed BN CPD variable S V depends values parents paS V Therefore cid6 sv μV cid5 cid5 cid6 sv μV Pr cid5 sv μV PaS V cid6 cid11 Pr P V V μV PaS V child EFG restriction μV values PaS V If P V V cid11 0 child V cid11 remove The set available actions Ai variable D S V MAID Ai j j j agent node V domD j EFG given domain corresponding decision Deﬁne λ V V A decision node V V 1 V n V cid11 ChV λV V cid11 μV cid11S V label outcome decision cid11PaS V Deﬁne equivalence relation V 1 V n V V cid11 Then set information sets I agent N simply quotient set V set cid11 V correspond decision j agent instantiation labels restricted μV equivalence classes partitioning V In words nodes V V variable S M information set I parents M S V S V cid11 S μV PaS V cid11 24 We assume descU 25 This topological ordering general nonunique 33 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 The payoff U L Rn leaf L L EFGs tree U L u1 ui expected utility agent M given instantiation μL variables S cid7 U U EU μL A11 EFG MAID We construction efg2maid Unlike case maid2efg EFG converted unique canonical equivalent MAID Given EFG E N T P A λ I U including intervention sets deﬁne equivalent MAID M G θ follows The set agents N remains M E Initialise MAIDs graph V E T edges directed parents children For E s chance nodes V V 0 label outgoing edge V value v Every node outgoing edge labelled λ decision corresponding edge Thus let domV M contain labels outgoing edges V For variable V V let ρV unique path formed sequence labels root R E corresponding EFG node V let ρV V j E let ρI For information set I cid10 cid11 denote label outgoing edge node V j set paths R nodes I j set variables AncI path ρV j Next deﬁne function outgoing label cid11 iN I 2V maps information set I μ path ρI nodes values μI nodes values μI j Note Deﬁnition 29 information sets I I cid11 j cid11 We consider E s chance decision leaf nodes turn intervention set For outgoing edge label v j chance node V V 0 add label v j ρV j p p P jv j For information set I labels ρD restricted μI j variable V I j _ ρV μI j _ placeholder parameterised decision rule j add label v ρV μI j denotes For leaf variable L L payoff vector U L u1 split L n utility variables U 1 U n dupli cating incoming edges labels ui ρL 1 respectively Given labellings proceed merging variables according intervention sets Merge information set I j single variable D j D collecting labels v ρV μI j _ V I j retaining incoming outgoing edges Begin adding directed edge V cid11 AncV V variable V Then variable D j corre sponding information set I j remove incoming edges variables μI j Merge group variables collecting incoming outgoing labelled edges belong inter vention set Merge utility variables U j U k belonging agent sets incoming edges collect labels We let V X D U X V 0 D union variable sets D deﬁned U collection utility variables deﬁned E set edges graph deﬁned We conclude deﬁning CPDs PrV PaV V X U For certain instantiations paV CPD V undeﬁned paV represent path original game tree T mentioned Section 62 For nondecision variables dealt simply adding null value variable X value 0 variable U Recall labels form v ρV p let lV denote set V s labels For variable V V D deﬁne Prv paV For paV v domV Prv paV 0 set Pr paV 1 V X Pr0 paV 1 vpaV p lV p V V D Prv paV forms partial distribution nondecision variables M V U By construction For decision variables changes parameterisations πD D PaD effect variables occur settings paD exists strategy σ path ρ E capturing values paD Prσ ρ 0 In words values πD d paD corresponding parametrisation d ρD μI cid7 cid2 j _ A2 Theoretical results A21 Section 3 Proposition 3 MV RBRrelevant cid7D MV cid10mG U DescD D PaD MV cid10mG PaD D D U DescD cid10 34 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Proof First recall Deﬁnition 17 MV Pacid7D RBRrelevant cid7D exists pacid7D D pacid7D cid10 rBR rBR differ MV Moreover recall D D πD rBR pacid7D pa D pa cid11 cid7D cid11 cid7D cid11 cid10 pa cid7D D pacid7D πD arg max ˆπD domcid7D E ˆπD π D U cid11 U U Given setting mD mechanism variables apart cid7D U U ˆπD domcid7D Pr ˆπD π D u cid11 cid11 Pr ˆπD π D u d paD ddomD cid11 paD domPaD cid11 ddomD cid11 paD domPaD cid11 ddomD paD domPaD Prπ D u d paD ˆπD d paD Prπ D paD Prπ u d paD ˆπD d paD Prπ paD The ﬁrst equality simply rewrites marginal distribution sum joint distribution second factorises joint distribution results observations distribution PaD depend CPD πD D PaD distribution U given d paD Next note deﬁnition rBR quantify ˆπD arg max operation choice ˆπD given π D impact expected value utility variables U U DescD Therefore decision rule rBR D pacid7D satisﬁes cid15 cid11 cid11 cid11 arg max ˆπD domcid7D U U DescD ddomD paD domPaD Prπ u d paD ˆπD d paD Prπ paD u A1 cid16 cid11 cid7D Therefore expression A1 independent value mV MV RBRrelevant cid7D As explained Prπ ui Section 32 equivalent asking V requisite probability node distribution QBR D descD d paD Prπ paD The graphical criterion checking requisite probability node given Lemma 1 results criteria refer RBRreachability MV cid10mG U DescD D PaD MV cid10mG PaD D D U DescD cid10 differ value MV Pacid7D let pacid7D We begin proving soundness MV RBRreachable cid7D MV RBRrelevant cid7D Let cid10 pa respective settings Pacid7D Additionally let cid11 π cid11 θ cid11 If MV RBRreachable cid7D MV mG U DescD θ Prπ cid11 θ cid11 Thus u d paD paD meaning MV cid11 m cid10 m write m π θ m D PaD MV mG PaD implying Prπ u d paD value expression A1 independent value MV rBR RBRrelevant cid7D required θ cid11 Prπ paD cid11 cid7D D pacid7D rBR We turn completeness MV RBRreachable cid7D mechanised graph mG D D U DescD cid10 mechanised MAID mM mG θ RBR MV RBRrelevant cid7D Our goal ﬁnd parameterisation mechanised graph mG parameterisation cid7D s parents pacid7D changed pa differ MV r D pacid7D cid10 r D pa θ Prπ cid11 D pa cid11 cid7D If MV cid10mG U DescD D PaD simply follow KMs proof completeness sreachability construct parameterisation mechanised graph MV srelevant RBRrelevant cid7D mechanised MAID If instead MV cid10mG PaD proceed follows Below restrict attention decision nodes satisfy U DescD cid10 D D This U DescD agent indifferent decision rules D trivially rBR case MV RBRrelevant cid7D D pacid7D rBR pacid7D Let assume MV cid10mG Z Z PaD Then MV parents mG paths MV Z contain colliders blocked directed path MV cid2cid2cid3 Z mG Let denote variables directed path X0 cid2cid2cid3 Xn1 X0 MV Xn1 Z Next following remarks know U DescD cid10 directed path D cid2cid2cid3 U U U We denote variables path Y 0 cid2cid2cid3 Ym1 Y 0 D Ym1 U Thus mG directed path X0 cid2cid2cid3 Xn1 Y 0 cid2cid2cid3 Ym1 segments X1 cid2cid2cid3 Xn Y 1 cid2cid2cid3 Ym We parameterisations mG identical settings pacid7D differ MV We begin parameterisations common First let nonutility variables binary assumption easily relaxed end Next set CPDs nodes paths X2 cid2cid2cid3 Xn1 Y 1 cid2cid2cid3 Ym copy value parent path That 2 n xi xi1 probability 1 1 m yi yi1 probability 1 Note value X1 V determined according cid11 cid10 pa cid7D pa D pa cid11 cid7D cid11 cid7D cid11 cid7D 35 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 value MV Finally set distributions utility functions U copies value Ym U takes value 0 regardless value PaU cid11 cid11 For pa cid7D D pacid7D note decision rule πD rBR let mV set distribution V δV 1 implying Xn1 Z takes value 1 Given decision For pacid7D D pacid7D πD identical πD apart fact rule πD rBR πD D 0 Z 0 pa PaD Z When D 0 construction Ym1 U 0 Z 0 probability zero given mV outcome occurs πD remains rational response pacid7D cid11 cid11 D 1 pa D setting variables Pa cid11 V set distribution V Prπ V 0 paV 0 paV In case πD let m rational response context Z 0 occurs nonzero probability U 0 cid11 construction fact πD D 0 Z 0 pa D 1 Agent expected utility instead strictly improved cid11 cid11 selecting decision rule δD1 Thus πD rBR MV RBRrelevant D pa D pa cid7D cid7D cid7D required To extend proof case variables arbitrary opposed binary domains simply label value domain variable 1 0 making sure utility variables value labelled 1 strictly greater value labelled 0 cid2 D pacid7D cid10 rBR rBR cid11 D cid11 U A22 Section 4 Proposition 4 For distributions ED D governed equations 3 onetoone correspondence set stochastic decision rules cid5domD domPaD set deterministic decision rules dom cid7D cid5domD domPaD cid14 Moreover given corresponding decision rules πD πD πD d paD eD PreD deD πD d paD domED D f πD f π cid11 Proof Recall Section 43 deﬁne PaD PaD ED Let ﬁrst examine correspondence stochastic nonstochastic decision rules Let f cid5domD domPaD dom cid7D function πD cid5domD domPaD deﬁne f πD πD πD d paD eD δde Given deﬁnition ED πD cid10 π cid11 paD Clearly πD cid10 π cid11 D exists paD d domE d πD d paD cid10 π cid11 D f ED πD cid5domD domPaD f πD πD f πD paD D f πD cid10 f π cid11 E bijection giving onetoone correspondence injection Moreover πD form identiﬁed set surjection π cid11 πD paD D E D D D paD domE π cid11 D D d paD PrE πD paD D D paD πD paD D πD paD D domPaD d D paD PrE E π cid11 D paD Now πD cid5domD domPaD πD f πD Let E ED joint product probability distributions 7 cid17 πD paD D ED E πD paD D Then deﬁnition πD d paD eD PreD deD δde πD paD D PreD deD cid11 δde πD paD D Pre πD paD D Pre πD paD D πD paD D cid17 πD paD e D πD paD D domE cid11 domE πD paD D δde πD paD D πD e πD paD D paD 1 domED cid17 domED πD paD e D domE πD paD D πD d paD cid2 A23 Section 5 Proposition 5 A behavioural policy NE guaranteed exist MAID Proof See Appendix B2 example MAID behavioural policy NE cid2 Lemma 2 Let π cid5domD partial behavioural mixed policy proﬁle agents N MAID M If agent perfect recall M mixed policy μi exists behavioural policy π Prμi π v Prπ π v domPaD 36 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Proof For purposes proof let abuse notation viewing pure decision rule πD function πD paD d case πD d paD 1 Further pure policy π DD cid7D let write π ipaD di case πD paD d D D Then given ﬁxed MAID M partial behavioural mixed policy proﬁle π partial distribution Prπ V V D Prπ v paV It suﬃces μi cid5DD dom cid7D exists π DD cid7D cid11 di v d cid4 cid2 μidi paD μi π πD d paD π idi paD π DDi cid7D π pa Di di DD abuse notation somewhat μi π denote policies resulting partial distributions variables M In follows suppress qualiﬁcation π DD cid7D implicit considering π Suppose D m let assume loss generality indices 1 m decision rules reﬂect unique virtue fact agent perfect recall topological ordering variables D M D1 Dm In remainder proof write D j denote set variables D1 D j D Then D j D FaD j PaD j We deﬁne decision rule π D j follows π D j d j paD j 1 domD j cid7 1 Z j π D j π D j pa Di j di j μi π D j Z j 0 Z j 1 cid7 π D j π D j pa di j Di j μi π D j j 1 Note behavioural decision rule wellformed Concretely π D j 1 d j paD j normalise π D j d j paD j π D j cid7 d j d j paD j 0 μi π D j 0 Z j 0 cid21 cid11 cid11 cid22 μi π D j cid11 μi π D j d j π D j π D j pa di j Di j π D j π D j pa di j Di j Using deﬁnition conclude proof proceeding cases First suppose Z j 0 j 2 Then cid11 μi π D j 0 πD j1 d j1 paD j1 0 π idi paD 0 π D j π D j pa di j Di j Di di μi π 0 π idi paD But ﬁrst antecedent implies μidi paD μidi paD required Now suppose j Z j 0 Then telescoping terms following π pa π cid7 πD j d j paD j mcid4 j1 mcid4 j1 π idi paD 1 Z j cid11 μi π D j π D j π D j cid11 pa Di j di j μi π Dm di m pa π π Dm Dm Dim μidi paD cid2 Proposition 6 In MAID M perfect recall exists behavioural policy proﬁle π NE Proof First note immediate consequence Lemma 2 given partial policy π behavioural mixed MAID M perfect recall mixed policy μi equivalent behavioural policy π 37 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 cid11 U U k Eμi π U cid11 U U k Eπ π U agents k N Next straightforward application Nashs theorem 68 know MAID guaranteed NE μ mixed policies Given μ μ1 μn apply Lemma 2 n times result behavioural policy π π 1 π n U U k Eπ U agents k N Finally let assume contradiction agent N deviate π order increase expected utility Let deviation denoted ˆπ Then construct mixed policy ˆμi cid5DD dom cid7D results joint distribution ˆπ following manner We deﬁne ˆμi π U U k EμU set cid7 cid7 cid2 m j1 ˆμi π D j ˆμi π D j cid4 pa cid11 D j domPaD j cid5 ˆπ j π D j pa cid11 D j pa cid6 cid11 D j Again note results wellformed mixed policy Concretely ˆμi π 0 π ˆπ j cid5 π D j pa cid11 D j cid11 pa D j cid6 0 cid11 π ˆμi π cid11 cid11 mcid4 ˆμi π D j j1 π Dm π D1 mcid4 cid11 j1 mcid4 π D j cid11 π D j cid21 j1 mcid4 ˆμi π D j cid21 cid4 cid11 pa D j domPaD j cid21 cid4 cid22 cid6 cid5 ˆπ j π D j pa cid11 D j pa cid11 D j cid21 cid11 cid11 domD j π D j π D j pa cid11 D j d cid11 j j1 mcid4 cid21 pa cid11 D j domPaD j cid4 cid11 j d cid22 1 j1 pa cid11 D j domPaD j cid5 ˆπ j π D j pa cid11 D j pa cid11 D j cid22cid22cid22 cid6 1 In order policy proﬁles ˆμi π ˆπ π result joint distribution variables expected payoffs agent suﬃces following holds j 1 m ˆμi jd j paD j cid11 ˆμi π D j π D j paD j π D j cid11 d j cid21 cid4 d j π D j paD j π D j cid11 pa cid11 D j domPaD j cid21 ˆπ jd j paD j π D j π D j paD j d j pa cid4 cid5 ˆπ j π D j cid11 pa D j cid11 pa D j cid22 cid6 cid4 cid11 domPaD j D j cid21 paD j cid11 cid5 ˆπ j π D j cid11 pa D j cid11 pa D j cid22 cid6 cid5 ˆπ j π D j pa cid11 D j pa cid11 D j cid22 cid6 ˆπ jd j paD j ˆπ jd j paD j ˆπ jd j paD j pa cid11 D j domPaD j cid4 paD j π D j π D j paD j d j pa cid11 D j domPaD j paD j 1 38 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Thus ˆπ beneﬁcial deviation π ˆμi beneﬁcial deviation π Further appealing Lemma 2 cid11 U U E ˆμi π U cid11 U U E ˆμi μi U ˆμi beneﬁcial deviation μi In case μ NE giving contradiction cid2 Proposition 7 If agent MAID M perfect recall suﬃcient recall However agent suﬃcient recall perfect recall Proof For ﬁrst direction recognise agent perfect recall M means exists unique topological ordering variables D M D1 Dm Furthermore j k FaD j PaDk This implies cid7D j mG U DescDk Dk PaDk cid7Dk srelevance graph rsG This implies cid7D j sreachable cid7Dk Therefore edge cid7D j rsG restricted agent decision rule variables acyclic exist edges cid7D j cid7Dk j k required For second direction provide example Appendix B2 MAID agent suﬃcient imperfect recall cid2 Proposition 8 Any MAID M suﬃcient recall SPE behavioural policies Proof Let G1 Gm ordering MAID Ms ssubdiagrams G j Gk implies Gk s subdiagram G j If agents suﬃcient recall G1 contains decision variable agent ssubdiagram G j 1 j m G j1 contains additional decision variable agent The newly added decision nodes subsequent ssubdiagram ordering correspond exactly topological ordering strong connected components Ms srelevance graph This means employ method similar proof Theorem 62 KM 51 use backwards induction procedure optimise decision rules subgame order resulting policy proﬁle guaranteed NE feasible ssubgame M SPE cid2 Proposition 9 Suppose MAID M suﬃcient recall Then set SPEs M equal set rational outcomes RSPmM Proof As previous proof let G1 Gm ordering Ms ssubdiagrams G j Gk implies Gk ssubdiagram G j If agents suﬃcient recall G1 contains decision variable agent ssubdiagram G j 1 j m G j1 contains additional decision variable agent The fact G1 contains decision variable agent means π 1 NE feasible ssubgame M1 G1 case πD arg max ˆπD domcid7D cid11 U U V 1 E ˆπD π 1D U M1 case πD rSP agent decision variable simply NEs game D pacid7D This akin result RBRrational outcomes game Similarly reason analogously backwards induction procedure ssubgames described proof Proposition 8 assume π j forms NE feasible ssubgame M j ﬁxing π j feasible ssubgame M j1 induce new MAID agent decision variable A partial policy proﬁle π cid11 j1 NE game cid11 E ˆπD π cid11 jD U πD arg max ˆπD domcid7D cid10 U U V j1 1k j Dk Moreover inductive hypothesis resulting policy proﬁle π j1 π cid11 D D j1 j1 π j forms NE fact SPE feasible M j1 πD rSP D pacid7D At conclusion line argument policy proﬁle π π m NE feasible ssubgame M restricted subgame case πD rSP D pacid7D case π RSPmM cid2 39 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 A24 Section 6 Lemma 3 Let f natural mapping E M Then σ NE E π f σ NE M cid7 Proof This result follows straightforwardly Deﬁnition 30 Suppose σ NE Then f natural mapping π f σ agent If ˆπ proﬁtable deviation player M exist f ˆσ cid24 π ˆσ proﬁtable deviation player E Ie U U Eπ U Eσ U ρLi cid9 cid8 cid11 cid11 Eπ U Eπ ˆπ U Eσ ˆσ cid8 cid9 U ρLi cid8 cid9 U ρLi Eσ U U U U contradicts assumption σ NE The argument applies opposite direction conclud ing proof cid2 Lemma 4 If E maid2efgM M efg2maidE E M equivalent Proof In follows trivial assumption nonleaf node V E child simply remove nodes V chance node children reached positive probability delete subtrees rooted children The proof follows directly construction procedures maid2efg efg2maid respectively To ﬁrst suppose MAID M E EFG resulting maid2efgM A decision rule πD deﬁnes probability distribution domD conditional decision context paD Following maid2efg procedure j S V D feasible decision context instantiation set variables corresponds information set I cid11 d In particular paD V I infeasible probability reaching I cid11 ChV λV V j zero removed E assumption j d domD exists precisely node V For policy proﬁle π let deﬁne σ σ j d πD d paD feasible decision context paD Note j D πD D paD cid5domD given paD construction results onetoone correspondence σ π π cid11 differ infeasible decision contexts strategy σ constructed This construction results bijection f cid14 domcid2 By reasoning analogously chance utility variables observing difference chosen actions infeasible decision contexts bearing expected utility agent M occur probability zero follows expected utility agent Eσ natural mapping M E equivalent U U Eπ U σ π f σ f π π cid11 U ρLi cid7 cid8 cid9 For second proof note ﬁrst deterministic nature efg2maid procedure guarantees unique ness resulting MAID suppose M efg2maidE In construction incoming edges decision variable D D precisely originate variables values agent deter corresponding information sets I j assigns probability distribution set available decisions Ai j determined function paD paD corresponds particular information set I j node V j D created j Hence strategy σ Thus given strategy proﬁle σ E ﬁx corresponding policy proﬁles π M πD d paD σ j d paD feasible let πD d paD vary As bijection f cid14 domcid2 The form correspondence ignoring infeasible settings parents analogously seen hold distributions P E CPDs X U Thus π f σ agent N f natural mapping required cid2 U U Eπ U Eσ U ρLi cid7 cid8 cid9 Deﬁnition 31 A strategy proﬁle σ Nash equilibrium NE cid9 σ arg max ˆσ cid14i E ˆσ σ U ρLi cid8 EFG agent N Corollary 1 If E maid2efgM M efg2maidE natural mapping f E M σ NE E π f σ NE M Proof By Lemma 4 E M equivalent Thus let f cid14 domcid2 natural mapping E M deﬁned Deﬁnition 30 By applying Lemma 3 σ NE E π f σ NE M cid2 Proposition 10 If E maid2efgM M efg2maidE natural mapping f E M subgame E cid11 M equivalent modulo constant difference utilities agent policy Mcid11 natural mapping f restricted strategies E cid11 E ssubgame Mcid11 E cid11 40 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Proof We begin proving existence Recall subgame E cid11 sets descendants Let V contained E cid11 We ﬁrst V mechanism node M Z sreachable cid7D D V directed path X cid2cid2cid3 Y G EFG E subtree closed information cid11 V set variables M corresponding intervention sets overlapping contains variable Z M contains variable lies forms ssubdiagram V cid11 X Y V Beginning ﬁrst condition suﬃces exists variable Z Z V V M Z sreachable decision rule cid7D variable D D V Recall means MZ cid10mG U DescD FaD mG mechanised graph edges mechanism variables Any path supporting dependency following forms N V cid11 cid11 cid11 cid11 cid11 cid11 cid11 MZ Z U DescD In case Z V E corresponding Z lie outside E cid11 observed decision node E cid11 Z FaD Hence conditioning FaD block path meaning dependency construction efg2maid maid2efg node closed information sets value Z corresponding D information link Z D M cid2 Further E cid11 MZ Z U DescD In case let W ﬁrst variable path left right fork variable W Such variable exist assume utility variables children As notice construction efg2maid maid2efg Z V directed path W cid2cid2cid3 Z M W lie outside E cid11 closed information sets means W observed D conditioning FaD blocks path meaning dependency But fact E cid11 lie outside E cid11 cid2 directed path X cid2cid2cid3 Z cid2cid2cid3 Y M Then We consider second condition Suppose X Y V E maid2efgM M efg2maidE topological ordering variables M X Z Y nodes E cid11 closed descendants node corresponding Z E cid11 cid11 deﬁnition V This means intervention set containing Z overlaps E cid11 corresponding X Y E cid11 Z V cid11 For second existence proof setting z Z combined V cid2 cid11 leads ssubgame Mcid11 root R E root R path R R argument decision variables D decision context D D feasible E cid11 cid11 let Mcid11 cid11 M equivalent E cid11 First note node passed path ρRcid11 correspond variable Z Let z setting Z consistent z Observe resulting ssubgame obtained combining V deﬁnition precisely corresponding information sets E cid11 correspond information set E cid11 cid2 V cid2 cid2 cid2 Thus natural mapping f E M restricted E cid11 quotient set behavioural policy proﬁles Mcid11 leads bijection strategies E cid11 policies equiv alence class differ decision contexts infeasible arguments proof Lemma 4 Furthermore equivalent strategy π f σ follows directly construction maid2efg efg2maid Ecid11 cid11 denote expected utility agent σ π U ρLi σ Mcid11 restricted E cid11 respectively cid9 cid11i cid11 σ cid11σ ρU ρLi Mcid11 U ρL U cid11U V cid11 Ecid11 π cid11 U cid7 E P cid8 cid9 cid8 ρ cid11 P σ ρ ρRcid11 U ρLi ρ cid11 cid11 u Prπ u z θ U U cid11 udomU u cid11 cid11 U U Z cid11 u U cid11U V cid11 cid11 U U Z U cid11U V cid11 u ucid11domU cid11 cid11 u ucid11domU cid11 cid11 Prπ u cid11 z θ cid11 Prπ u cid11 θ cid11 cid11 u cid11 U U Z U cid11U V cid11 E cid11 π cid11 U cid11 P σ ρ ρRcid11 distribution paths ρ E conditional ρ containing ρRcid11 sub agent N path Note utility variables U U occur V add value u according z payoff agent order equate expected utilities agent games Given z difference utilities agent constant policy Mcid11 effect optimality policies Mcid11 required cid2 Modulo small difference f forms natural mapping E cid11 Mcid11 cid11 Deﬁnition 32 A strategy proﬁle σ EFG E subgame perfect equilibrium SPE σ NE subgame E restricted subgame 41 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Corollary 2 If E maid2efgM M efg2maidE natural mapping f E M π f σ SPE M σ SPE E Proof The corollary seen follow immediately combining deﬁnitions SPEs EFGs MAIDs Proposition 10 Lemma 3 Concretely E maid2efgM M efg2maidE π f σ SPE M natural mapping f E M satisfying Proposition 10 π NE ssubgame M subgame E equivalent ssubgame M f modulo constant difference utilities agent policy Mcid11 NE σ NE subgame E Lemma 3 cid2 affect given policy proﬁle Mcid11 Deﬁnition 33 A perturbation vector ηk contains perturbations cid12i j perturbed game Eηk strategy forced σ perfect equilibrium THPE EFG E sequence perturbation vectors ηk perturbed EFG Eηk NE σk limk σk σ 0 1 j cid12i j 1 information set I j A strategy proﬁle σ trembling hand kN limk cid22ηkcid22 0 cid12i j Ai j cid7 Proposition 11 If E maid2efgM M efg2maidE natural mapping f E M σ THPE E π f σ THPE M Proof Given Lemma 4 Lemma 3 suﬃces perturbed MAID resulting efg2maidEηk equivalent Eηk similarly perturbed EFG resulting maid2efgMζk equivalent Mζk For ﬁrst given ηk deﬁne entries ζk decision d decision context paD cid3 cid12paD d cid12i j mini ja cid12i j d paD feasible j efg2maid construction Clearly π f σ f paD corresponds information set I πD d paD cid12paD natural mapping E M σ Based easily seen natural mapping perturbed games Eηk Mζk equivalent f For second given ζk construct ηk cid12i j d paD feasible A similar argument shows natural mapping f M E induces natural mapping perturbed games Mζk Eηk required cid2 j cid12i j cid12paD d d Appendix B Further examples B1 Counterfactuals closest possible world principle When computing counterfactuals SCGs closest possible world principle basic desideratum sider counterfactual rational outcomes π cid11 RmMI consistent decision rules actual rational outcome π RmM z decision rules affected I In words wish set invariant decision rules cid2I large possible propagating changes I As ﬁrst attempt set cid2I cid2 Y DescY It easily seen choice ﬂawed cid7D apply intervention docid7D ˆπD r D r Dcid11 ˆπD set rational responses decision rule cid7cid11 cid7D Desccid7D Consider Rrelevance graph variables cid7D cid7Dcid11 Pacid7cid11 πD Then perfectly possible r Dcid11 πD change case sense cid7cid11 D affected I cid7cid11 Instead compute cid2I propagating effects I maximal strongly connected components MSCCs Rrelevance graph restricted decision rule variables26 Let cRG denote condensation Rrelevance graph rRG restricted decision rule variables called component graph KM 51 topological ordering C1 Cm vertices cRG C j cid2 MSCC rRG restricted decision rule variables let write cid12 c j πD r D pacid7D cid7D C j rC j paC j cid10 cid13 D D D denote rational responses c j πD cid7D C j Then compute cid2I Algorithm 1 Algorithm 1 functions incrementally expanding set cid2I ﬁrst initialised cid2 Y DescY computing rational responses MSCC actual counterfactual rational outcomes adding 26 Recall strongly connected component SCC subgraph containing directed path pair nodes maximal SCC SCC strict subset SCC 42 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Algorithm 1 Input mM z I Output cid2I 1 Prθ Prθ I 2 cid2I cid2 Y DescY 3 form cRG rRG topological ordering C1 Cm 4 j 1 m 5 6 7 8 9 10 11 12 return cid2I actual RmM z counterfactual cid3 j PaC j cid2 j PaC j C j cid2I continue π actual rC j θ j π j cid2 cid2 π actual cid10 cid10 cid10 cid12 π cid11counterfactual rC j θ j π cid11 cid13 π cid11 RmMI π I π cid11I j cid2I cid2I C j A B U 1 D 2 U 2 B 1 A I 1 2 B 2 b b b b D 2 1 D 2 2 I 2 D 2 3 D 2 4 cid7 A cid7B d d d d d d d d cid6U 1 cid6U 2 cid7D2 b 1 1 1 1 2 2 2 2 2 2 2 2 1 1 1 1 c Fig 11 A MAID representing NE nonexistence example b srelevance graph c An equivalent EFG representing game variables component cid2I set responses remains It seen generalising interventions models containing cycles nondeterminism maintaining maximally justiﬁable similarity observed outcome In words maintain updated beliefs observation z values decision rule variable cid7D set values πD takes rational outcome π remains intervention I performed cid7D cid2I We use set cid2I Deﬁnition 23 deﬁne counterfactual queries games principle B2 Nonexistence results B21 No Nash equilibrium behavioural policies Proposition 2 Section 51 says MAID suﬃcient recall exist NE behavioural policies The example presented adapted 97 demonstrates agent MAID suﬃcient recall NE mixed policies hold true behavioural policies The example shown MAID M EFG E Fig 11 agent 1 binary decision variables A B agent 2 binary decision variable D utilities assigned according leaves E For sake simplicity identify pure policy decisions chosen dom cid21 ab ab ab ab dom cid22 d d Note agent 1 insuﬃcient recall srelevance graph restricted contain cid7 A cid7B acyclic In order M NE behavioural policies ﬁrst exists NE agent 1 uses pure policy Suppose contradiction exists policy proﬁle π π 1 π 2 π 1 pure π NE First π 1 ab ab choice π 2 agent 1 receives expected utility 2 improve expected utility playing ab ab Second π 1 ab agent 2s best response π 2 d π 1 ab agent 2s best response π 2 d However agent 1s best response π 2 d π 1 ab agent 1s best response π 2 d π 1 ab Therefore exists choice pure policy π 1 π 2 cid22 agents simultaneously playing best response Hence NE pure policies exists M 43 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 U 3 X A B D 4 A B D 3 U 1 D 2 U 2 U 4 U 1 U 2 D 2 b D 3 U 3 c cid6U 3 cid6X cid7 A cid7B cid7D4 X A B D 4 cid7D3 cid6U 1 cid7D2 cid6U 2 cid6U 4 U 1 D 2 U 2 U 4 d e Fig 12 A MAID M representing SPE nonexistence example b c e proper ssubdiagrams MAID G1 G2 G3 respectively d The srelevance graph M We consider case agent 1 behavioural policy π 1 B stochastic Suppose contradiction exists policy proﬁle π π 1 π 2 NE behavioural policies We let agent 1s decision rules parameterised p q 0 1 π 1 B b q First consider case agent 2 plays d d probability 1 agent 1s best response play pure policy π 1 ab π 1 ab probability 1 respectively Since know NE pure policies exists agent 2 instead select stochastic decision D2 agent 2 indifferent d d We obtain constraints p q On rule π 2 hand agent 1s behavioural policy π 1 result π 1a b π 1a b Aa p π 1 A andor π 1 1 p1 q pq p q 1 On hand agent 1 receives utility 2 policy π 1 selects b b choice π 2 Therefore π 1a b π 1a b π 1a b π 1a b substituting result p q 1 1 pq p1 q pq 1 p1 q 2p 12 0 This contradiction implies M NE behavioural policies However expected Nashs theorem 68 exist NE M mixed policies agents randomise pure policies To ﬁnd mixed policy NE know principle indifference expected utility agents pure policies support mixed policy This means immediately rule pure policies ab ab played positive probability Assuming agent 1 plays mixed policy μ1 r deﬁne ab probability r ab probability 1 r Eμ1 2 Furthermore s deﬁne d probability s d probability 1 s assuming agent 2 plays mixed policy μ2 2 Thus policy proﬁle μ μ1 Eabμ2 s NE M mixed policies U 1 Eabμ2 s U 2 implies r 1 U 1 implies s 1 U 2 Eμ1 r d μ2 r d 1 2 1 2 B22 No subgame perfect equilibrium We extend MAID previous example Fig 11a construct MAID SPE Proposition 8 Section 53 says MAID suﬃcient recall exist SPE behavioural policies The example presented demonstrates agent MAID suﬃcient recall exist SPE allow mixed policies Fig 12a shows graph G MAID M example Fig 12d shows srelevance graph observe agent 1 insuﬃcient recall The proper ssubdiagrams G1 G2 G3 G shown Figs 12b 12c 12e respectively To parameterise M nonutility variables given Boolean domain interpret integers 1 0 U 1 U 2 inherit parameterisation previous example shown reference EFG Fig 11c We let U 3 D3 let U 4 1 D4 B U 4 0 Finally set CPD X X A D3 1 X 1 A D3 0 From previous example know ssubgame deﬁned G1 behavioural NEs 2 μ2 plays pure strategies ab ab probability 1 mixed NE given μ1 μ1 μ1 μ2 1 2 1 2 1 2 1 2 44 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 cid7 A cid7B A X B U 1 cid6X cid6U 1 A1 a1 B 1 x 1 2 a1 I 1 1 B 2 X x 1 2 I 1 2 a2 B 3 A2 a2 B 4 b1 b1 b2 b2 b1 b1 b2 b2 O 1 O 2 O 3 O 4 O 5 O 6 O 7 O 8 b Fig 13 An sminimal mechanised MAID representing equivalent behavioural mixed policies nonexistence example b An equivalent EFG representing game plays pure strategy d2 probability 1 μ2 μ2 1 2 2 Thus mixed SPE μ μ1 μ2 μ3 μ4 M μ1 μ1 1 2 With μ1 μ2 ﬁxed choice μ4 leads NE feasible subgame deﬁned G3 First note effectively subgames M3 Mcid11 3 deﬁned setting D3 d3 D3 d3 respectively clearly feasible In M3 policy μ4 forms NE μ1 μ2 assigns probability mass pure policy plays d4 X 1 However Mcid11 3 best response agent 4 play d4 X 1 As policy proﬁle forms NE ssubgame M SPE M The reason result use mixed policy agent 1 means variables A B correlated This modelled graphically introduction shared parent C A B Given correlation cid7D3 srelevant cid7D4 new path cid7D3 D3 X A C B U 4 independent mechanised graph active given FaD4 X D4 B23 No equivalent mixed behavioural policies Finally provide example demonstrate suﬃcient recall suﬃcient condition mixed policy equivalent behavioural policy results probability distribution game outcomes It serves proof second Proposition 7 Fig 13a shows mechanised MAID example M single agent suﬃcient imperfect recall We assume variables binary Prx 1 2 To aid reasoning Fig 13b shows corresponding EFG M The outcomes game equivalent setting variables M denoted O 1 O 8 O 3 represents x b u1 3 We use notation previous example denote pure policy For example π 1 a1a2b1b2 pure policy agent selects value X b b Because decision contexts A B respectively corresponding information sets EFG 24 pure policies A mixed policy distribution pure policies We behavioural policy equivalent mixed policy μi 1 2 a1a2b1b2 1 2 a1a2b1b2 Let use begin parameterising general behavioural policy π Aa x p π Aa x q πB b r πB b s p q r s 0 1 Suppose contradiction behavioural policy equivalent μi exists This behavioural policy induce probability distribution outcomes game O 1 O 8 μi following equalities hold 45 L Hammond J Fox T Everitt et al O 1 1 2 O 2 1 2 O 3 1 2 O 4 1 2 p r 1 4 p 1 r 1 4 1 p s 0 1 p 1 s 0 Artiﬁcial Intelligence 320 2023 103919 O 5 1 2 O 5 1 2 O 7 1 2 O 8 1 2 q r 0 q 1 r 1 4 1 q s 0 1 q 1 s 1 4 From O 5 q 0 r 0 q 0 ruled O 6 Taking r 0 implies q 1 s 0 O 7 If s 0 p 1 O 4 means r 1 forced set r 0 This contradiction implies behavioural policy equivalent μi M 2 O 6 2 O 1 O 2 B3 Reasoning existing concepts causal games B31 Blame The following deﬁnition adapted 39 formalises extent agent blameworthy causing event Deﬁnition 34 39 Let M SCG π policy proﬁle D D decision variable d d combination terms V v The degree blameworthiness d ϕ relative d cid11 cid11 domD ϕ Boolean cid11 ϕ deﬁned denoted db S d d db S d d cid11 ϕ δddcid11ϕ S max cid11 cid 0 cid6 cid5 cid S δddcid11ϕ max cid11 decision d cid7 U U Eπ U cid6 cid5 0 Prπ ϕd Prπ ϕdcid11 cid7 cid S maxddomD cid given measure costsensitivity U U Eπ U d captures cost agent performing d captures likely ϕ result decision d The overall degree blameworthiness d ϕ db S d ϕ maxdcid11domD db S d d cid11 ϕ The factor δddcid11ϕ captures extent agents decision causes likelihood ϕ increase The max cid11 ϕ captures operation ensures blame possible likelihood decreases The second factor db S d d costs actions idea agent liable blamed ϕ taking alternative action particularly costly The extent costs taken account determined S note limS db S d d cid11 ϕ δddcid11ϕ In Example 2 instance wish compute db S q q B b degree blame assign robot moving quickly opposed moving quickly respect breaking item Let assume policy proﬁle question π THPE described Section 53 robot moves quickly robot patrols observes robot moving quickly Then following db S q q B b δqqBb S max cid5 c1q c1q 0 cid6 max cid5 cid6 0 Prπ bq Prπ bq S cid5 S max 0 Eπ U 1 q Eπ U 1 q cid6 S max0 1 3 0 S max0 2 2 S 1 3 Before continuing note deﬁnitions deﬁnitions intent originally formalised SCMs single action variable A single utility function U domV R resulting small differences Firstly SCM variable default value actions viewed interventions said variables SCGs values endogenous variables typically undeﬁned actions chosen This SCMs model sequences events causal connections broad sense SCGs represent gametheoretic model analysed These framings easily reconciled posits default value decision variable SCG Relatedly use utility variables SCGs strictly generalises U ﬁnegrained structure Finally previous work views SCMs representing subjective epistemic state possessed 46 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 intervening agent27 In contrast SCGs represent objective view sequential strategic interaction assumed common knowledge agents game This perspective appropriate assessing blame intention point view arbiter designer party B32 Intent In work authors formalise question agent intends bring event adapt use SCGs Deﬁnition 35 39 Let M SCG π policy proﬁle D D decision variable d domD altd domD set alternative decisions consideration An agent intends bring Y y performing d There exists Z Y inequality cid7 U U Eπ U d maxdcid11altd cid7 U U Eπ U dcid11zd Z minimal respect Prπ yd 0 recall Prπ yd denotes Prπ Y d y For y cid11 domY Prπ y cid11 d 0 cid7 U U Eπ U ycid11 cid7 U U Eπ U y Here zd nested counterfactual denote value Z intervention doD d evaluated respect marginalised setting e exogenous variables The notion intent addresses problem differentiating desirable intended effects undesirable unin tended effects The ﬁrst condition says variables Z set values d cid11 altd good Z minimal set variables agent decision d intending affect way The second condition says possible bring y d assumed agent knows Finally condition says y optimal value Y possible intervention doD d agent For instance robot intend obstruct robot meaning receives utility U 1 0 patrolling This ﬁrst property Deﬁnition 35 fails hold Taking altp p minimal set variables Z c2p max pcid11altp cid11 U U 1 Eπ U pcid11z p U 2 cid24 U 1 In words given robot moving quickly U 2 minimal set outcomes robot trying affect performing p If values U 2 restricted occur D2 p incentive robot patrol B33 Incentives In follows structural causal inﬂuence models SCIMs refer SCGs agent Deﬁnition 36 22 A policy π singledecision SCIM M responds variable X exists x dom X e domE Prπ D x e cid10 Prπ D e X response incentive RI optimal policies π respond X graph G admits RI X SCIM G RI X Deﬁnition 37 22 In singledecision SCIM M instrumental control incentive ICI variable X decision context paD optimal policies π exists d domD cid11 cid11 Eπ U xd paD cid10 Eπ U paD U U U U A graph G admits ICI X SCIM G ICI X paD These deﬁnitions help understand algorithmic frameworks lead agents having undesirable incentives build safer AI systems One proposal building safe AI systems cooperative inverse reinforcement learning CIRL 36 seeks formalise alignment problem 983 assistance game human H robot R attempt cooperatively perform task unknown environment robot uncertain humans true reward function parameterised value P H infer observing humans 27 The philosophical motivation arguably makes sense judge agents intent relative agents beliefs In work common prior assumption assume agents aware structure game relaxations assumption ought support subjective deﬁnitions intent 47 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 S1 R1 A R 1 A H 1 S2 R2 P H S3 R3 A R 2 A H 2 Fig 14 A MAID representing assistance game 23 played agents H human R robot want maximise rewards indicated shared utility variables actions This setup formalised decentralised partially observable Markov decision process DecPOMDP shown MAID Fig 14 ﬁnite horizon game timesteps At timestep t human robot perform action A H t A R shared state St transition new state St1 receive t reward Rt1 observable human 1 A R If assume example given Fig 14 actions A H 2 taken MAID reduces singledecision ID decision variable A R 2 apply sound graphical criteria derived previous work detect RIs ICIs CIRL 22 A variable X graph admits RI respect decision variable D directed path X cid2cid2cid3 D graph results information links D variables Y satisfying Y cid10G U DescD D PaD removed28 As A H 2 exists new graph robot R RI act according P H hope A variable X admits ICI respect decision variable D exists directed path D cid2cid2cid3 X cid2cid2cid3 U utility S3 R3 robot ICI inﬂuence S3 variable U Hence path A R 2 expect 2 satisfy criterion path P H A H 1 A H A R 2 Appendix C Codebase In section brieﬂy PyCID 27 open source Python library implements MAIDs causal variants PyCID range classes methods functions handling IDs level level causal hierarchy For work paper MAID class primary note PyCID signiﬁcant functionality including functions computing incentives singleagent causal IDs 22 reasoning patterns MAIDs 76 This makes codebase wellsuited testbed future research applications We begin showing instantiate MAIDs Examples 1 2 PyCID We provide empirical results demonstrating MAIDs compute NEs faster equivalent EFGs We refer reader existing tool paper 27 online codebase details including tutorials C1 Creating MAIDs Listings 1 2 instantiate MAID Examples 1 2 instances PyCIDs MAID class inherits pgmpys BayesianModel class 2 A MAID initialised list edges ﬁrst argument dictionaries specify agents decision utility variables The method draw plots graphs MAIDs shown Fig 15a 15b chance variables grey circles decision variables rectangles utility variables diamonds colouring denote different agents agent assigned unique colour Recall MAIDs syntactically CGs Therefore deﬁned MAID objects PyCID In case MAIDs level model class methods permitted involve causal interventions A MAID parameterised assigning domains decision variables CPDs chance utility variable CPDs PyCID StochasticFunctionCPD objects multiple ways deﬁne Listing 1 shows instantiate MAID Example 1 The CPD T follows Bernoulli distribution success probability 1 2 D1 D2 decision variables worker ﬁrms hiring respectively binary domains U 1 U 2 deﬁned described Section 221 28 The observations available D satisfying criterion known nonrequisite observations 58 Note similarity sreachability deﬁned Proposition 1 48 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 agent_decisions 1 D1 2 D2 T D1 T U1 T U2 D1 D2 D1 U1 D2 U1 D2 U2 1 import pycid 2 3 job_market pycidMAID 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 job_marketdraw 24 25 prob 12 26 27 job_marketadd_cpds 28 29 30 31 32 33 agent_utilities 1 U1 2 U2 T pycidbernoulliprob T 1 corresponds T h hardworking D1 01 D1 1 corresponds D1 g going university D2 01 D2 1 corresponds D2 j offering job U1 lambda d1 d2 t 5d2 td1 2d11t U2 lambda d2 t 3td2 21td2 1d2t Listing 1 An instantiation Example 1 PyCID agent_decisions 1 D1 2 D2 D1 D2 D1 U1 D1 B B U2 B U1 D2 U2 D2 U1 1 warehouse_robots pycidMAID 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 warehouse_robotsdraw 22 23 warehouse_robotsadd_cpds 24 25 26 27 28 29 agent_utilities 1 U1 2 U2 B lambda d1 0 1 d10 23 1 None B 1 corresponds B b breaking D1 01 D1 1 corresponds D1 q moving quickly D2 01 D2 1 corresponds D2 p patrolling U1 lambda d1 d2 b 1 05d21d12 d15 3b U2 lambda d2 b 61 1d2b d2 Listing 2 An instantiation Example 2 PyCID 49 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 Fig 15 MAIDs Example 1 b Example 2 drawn PyCID d1 D 2 1 d2 d2 D 3 1 D 3 2 D 1 I 2 I 3 d1 D 2 2 d2 d2 D 3 3 D 3 4 d3 d3 d3 d3 d3 d3 d3 d3 1 1 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 1 0 1 1 MAID EFG 104 103 102 101 100 1 10 2 10 s n e k T e m T 1 3 5 7 9 Number Agents c D 1 U 1 D 2 D 3 U 2 U 3 b Fig 16 The MAID b EFG 3agent version matchingpennieslike game described c A plot time taken ﬁnd NE MAID EFG representations game varying numbers agents Listing 2 shows instantiate MAID Example 2 D1 D2 decision variables robots binary domains U 1 U 2 deﬁned described Section 5 B chance variable deﬁned function parent D1 takes value b probability 1 D1 q probability 2 3 D1 q 50 L Hammond J Fox T Everitt et al C2 Computing equilibria Artiﬁcial Intelligence 320 2023 103919 PyCID ﬁnds pure NEs SPEs MAID natively ﬁnds behavioural NEs SPEs agent games converting MAID normal form game interfacing Nashpy29 We refer interested reader online codebase uptodate syntax showing compute NEs All SPEs MAID adapting Algorithm 62 51 iterate backwards topological ordering MAIDs ssubdiagrams ﬁnding NEs ssubgame turn More speciﬁcally method follows procedure outlined proof Proposition 8 In contrast KMs algorithm implementation ﬁnds pure SPEs opposed Finally demonstrate computational usefulness subgames SPEs MAIDs Consider class games agents simultaneously choosing place coin heads tails face The ﬁrst agent gets utility 1 agents game choose heads utility equals zero All agents added game pairs receive utility according standard game matching pennies partner 1 1 utility matching heads tails 1 1 mismatching respectively Matching pennies pure NEs mixed NE agents randomise equally choosing heads tails A MAID 3agent variant game shown Fig 16b By construction game belonging class agent pure NE agent pair incentive deviate Moreover EFG representation game shown 3agent case Fig 16a proper subgames30 Since complexity ﬁnding approximate mixed NE PPADcomplete 15 ﬁnding NE game hard EFG solver soon intractable number agent pairs playing matching pennies increases In MAID representation matchingpenniesplaying pair agents identiﬁed proper ssubgame This means unique behavioural SPE agents randomising equally choosing heads tails subgames fewer agents returning game ﬁnally best response agent play heads Fig 16c compares time taken ﬁnd NE MAID EFG representations games game class agents nineagent game difference orders magnitude31 There games MAID corresponding EFG proper subgames In games time taken compute NE comparable Nevertheless games subgames MAID EFG explained Section 62 subgame EFG guaranteed subgame corresponding MAID proven Corollary 2 Thus subgames allow eﬃcient computation equilibria MAIDs causal games compared EFGs References 1 R Ahsan D Arbour E Zheleva Relational causal models cycles representation reasoning First Conference Causal Learning Reasoning Proceedings Machine Learning Research vol 177 2022 pp 118 2 A Ankan A Panda Pgmpy probabilistic graphical models Python Proceedings 14th Python Science Conference 2015 pp 611 3 D Antos A Pfeffer Identifying reasoning patterns games Proceedings TwentyFourth Conference Uncertainty Artiﬁcial Intelligence 4 C Ashurst R Carey S Chiappa T Everitt Why fair labels yield unfair predictions graphical conditions introduced unfairness Proceedings ThirtySixth AAAI Conference Artiﬁcial Intelligence 2022 pp 94949503 5 C Avin I Shpitser J Pearl Identiﬁability pathspeciﬁc effects Proceedings 19th International Joint Conference Artiﬁcial Intelligence 6 A Balke J Pearl Probabilistic evaluation counterfactual queries Proceedings Twelfth AAAI National Conference Artiﬁcial Intelligence 2008 pp 918 2005 pp 357363 1994 pp 230237 7 H Bauer Probability Theory vol 23 Translated Robert B Burckel De Gruyter 1996 8 S Bongers P Forré J Peters JM Mooij Foundations structural causal models cycles latent variables Ann Stat 49 5 2021 28852915 9 N Bostrom Superintelligence Paths Dangers Strategies Oxford University Press 2014 10 C Boutilier N Friedman M Goldszmidt D Koller Contextspeciﬁc independence Bayesian networks Proceedings Twelfth International Conference Uncertainty Artiﬁcial Intelligence 1996 pp 115123 11 J Bradﬁeld J Gutierrez M Wooldridge Partialorder Boolean games informational independence logicbased model strategic interaction Synthese 1933 2015 781811 2010 677693 12 K Chatterjee TA Henzinger N Piterman Strategy logic Special Issue 18th International Conference Concurrency Theory Inf Comput 208 6 13 J Correa E Bareinboim A calculus stochastic interventions causal effect identiﬁcation surrogate experiments Proceedings Thirty Fourth AAAI Conference Artiﬁcial Intelligence 2020 pp 1009310100 14 FG Cozman Credal networks Artif Intell 120 2 2000 199233 15 C Daskalakis PW Goldberg CH Papadimitriou The complexity computing Nash equilibrium SIAM J Comput 39 1 2009 195259 16 C Daskalakis A Mehta C Papadimitriou A Note Approximate Nash Equilibria International Workshop Internet Network Economics 17 AP Dawid Causal inference counterfactuals J Am Stat Assoc 95 450 2000 407424 18 AP Dawid Inﬂuence diagrams causal modelling inference Int Stat Rev 70 2 2002 161189 19 G Déletang J GrauMoya M Martic T Genewein T McGrath V Mikulik M Kunesch S Legg PA Ortega Causal analysis agent behavior AI Springer 2006 pp 297306 safety arXiv2103 03938 2021 29 Available httpsgithubcomdrvinceknightnashpy 30 Technically possible corresponding EFGs permutations D1 D 2 D 3 proper subgames 31 These calculations performed PyCID 27 Gambit 63 NVIDIA Tesla K80 GPU time taken mean seven runs 51 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 20 P Doshi Y Zeng Q Chen Graphical models interactive POMDPs representations solutions Auton Agents MultiAgent Syst 18 3 2008 376416 21 F Eberhardt R Scheines Interventions causal inference Philos Sci 74 5 2007 981995 22 T Everitt R Carey ED Langlois PA Ortega S Legg Agent incentives causal perspective Proceedings ThirtyFifth AAAI Conference Artiﬁcial Intelligence 2021 pp 1148711495 23 T Everitt R Kumar V Krakovna S Legg Modeling AGI Safety Frameworks Causal Inﬂuence Diagrams IJCAI AI Safety Workshop 2019 24 E Fehr KM Schmidt A theory fairness competition cooperation Q J Econ 114 3 1999 817868 25 Financial Conduct Authority General Insurance Pricing Practices Market Study Consultation Handbook Changes 2020 CP2019 26 Financial Conduct Authority General Insurance Pricing Practices Interim Report 2019 MS1812 27 J Fox T Everitt R Carey E Langlois A Abate M Wooldridge PyCID Python library causal inﬂuence diagrams Proceedings 20th Python Science Conference 2021 pp 4351 28 M Friedenberg JY Halpern Blameworthiness multiagent settings Proceedings ThirtyThird AAAI Conference Artiﬁcial Intelligence 2019 pp 525532 2008 109147 2020 Learning The MIT Press 2007 29 D Fudenberg J Tirole Perfect Bayesian equilibrium sequential equilibrium J Econ Theory 53 2 1991 236260 30 Y Gal A Pfeffer Networks inﬂuence diagrams formalism representing agents beliefs decisionmaking processes J Artif Intell Res 33 31 D Geiger T Verma J Pearl Identifying independence Bayesian networks Networks 20 5 1990 507534 32 T Genewein T McGrath G Déletang V Mikulik M Martic S Legg PA Ortega Algorithms causal reasoning probability trees arXiv2010 12237 33 L Getoor N Friedman D Koller A Pfeffer B Taskar Probabilistic relational models L Getoor B Taskar Eds Introduction Statistical Relational 34 GlobalData United Kingdom UK Household Insurance Market Size Trends Competitor Dynamics Opportunities Report Code GDFS0406IA 2022 35 M GonzalezSoto LE Sucar HJ Escalante Causal games causal Nash equilibrium arXiv1910 06729 2019 36 D HadﬁeldMenell A Dragan P Abbeel S Russell Cooperative inverse reinforcement learning Proceedings 30th International Conference Neural Information Processing Systems 2016 pp 39163924 37 JY Halpern A modiﬁcation HalpernPearl deﬁnition causality Proceedings 24th International Conference Artiﬁcial Intelligence 2015 pp 30223033 38 JY Halpern Axiomatizing causal reasoning Proceedings Fourteenth Conference Uncertainty Artiﬁcial Intelligence 1998 pp 202210 39 JY Halpern M KleimanWeiner Towards formal deﬁnitions blameworthiness intention moral responsibility Proceedings Thirty Second AAAI Conference Artiﬁcial Intelligence 2018 pp 18531860 40 JY Halpern J Pearl Causes explanations structuralmodel approach Part I Causes Br J Philos Sci 56 4 2005 843887 41 JY Halpern J Pearl Causes explanations structuralmodel approach Part II Explanations Br J Philos Sci 56 4 2005 889911 42 L Hammond J Fox T Everitt A Abate M Wooldridge Equilibrium reﬁnements multiagent inﬂuence diagrams theory practice Proceed ings 20th International Conference Autonomous Agents Multiagent Systems 2021 pp 574582 43 D Heckerman R Shachter A decisionbased view causality Proceedings Tenth Conference Uncertainty Artiﬁcial Intelligence 1994 pp 302310 44 R Howard Information value theory IEEE Trans Syst Sci Cybern 2 1 1966 2226 45 RA Howard JE Matheson Inﬂuence diagrams Decis Anal 2 3 2005 127143 46 N Jaques A Lazaridou E Hughes C Gülc ehre PA Ortega D Strouse JZ Leibo N Freitas Social inﬂuence intrinsic motivation multiagent deep reinforcement learning Proceedings 36th International Conference Machine Learning 2019 pp 30403049 47 AX Jiang K LeytonBrown A Pfeffer Temporal actiongraph games new representation dynamic games Proceedings TwentyFifth Conference Uncertainty Artiﬁcial Intelligence 2009 pp 268276 48 M Kearns Graphical games N Nisan T Roughgarden E Tardos VV Vazirani Eds Algorithmic Game Theory Cambridge University Press 2007 49 N Kilbertus M RojasCarulla G Parascandolo M Hardt D Janzing B Schölkopf Avoiding discrimination causal reasoning Proceedings 31st International Conference Neural Information Processing Systems 2017 pp 656666 50 D Koller B Milch Multiagent inﬂuence diagrams representing solving games Proceedings 17th International Joint Conference pp 159180 Chap 7 51 D Koller B Milch Multiagent inﬂuence diagrams representing solving games Games Econ Behav 45 1 2003 181221 52 KB Korb LR Hope AE Nicholson K Axnick Varieties causal intervention C Zhang WH Guesgen WK Yeap Eds PRICAI 2004 Trends 53 DM Kreps R Wilson Sequential equilibria Econometrica 50 4 1982 863 54 HW Kuhn Extensive games problem information Contributions Theory Games AM28 vol 2 Princeton University Press Artiﬁcial Intelligence 2001 pp 10271034 Artiﬁcial Intelligence 2004 pp 322331 1953 pp 193216 Systems 2017 pp 40694079 55 M Kusner J Loftus C Russell R Silva Counterfactual fairness Proceedings 31st International Conference Neural Information Processing 56 M Kwiatkowska G Norman D Parker G Santos Multiplayer equilibria veriﬁcation concurrent stochastic games Proceedings 17th International Conference Quantitative Evaluation SysTems 2020 57 ED Langlois T Everitt How RL agents behave actions modiﬁed Proceedings ThirtyFifth AAAI Conference Artiﬁcial Intelligence 2021 pp 1158611594 58 SL Lauritzen D Nilsson Representing solving decision problems limited information Manag Sci 47 9 2001 12351251 59 SL Lauritzen TS Richardson Chain graph models causal interpretations J R Stat Soc Ser B Stat Methodol 64 3 2002 321348 60 I Levi The Enterprise Knowledge An Essay Knowledge Credal Probability Chance MIT Press 1980 61 London Economics YouGov Kudos Research General Insurance Pricing Practices 2019 62 M Maier K Marazopoulou D Jensen Reasoning independence probabilistic models relational data arXiv1302 4381 2013 63 RD McKelvey AM McLennan TL Turocy Gambit Software Tools Game Theory Version 02006 0120 2016 64 B Milch D Koller Ignorable Information Multiagent Scenarios Tech rep MITCSAILTR2008029 Computer Science Artiﬁcial Intelligence Laboratory MIT 2008 65 AC Miller III MW Merkhofer RA Howard JE Matheson TR Rice Development Automated Aids Decision Analysis Tech rep 1976 66 T Miller Contrastive explanation structuralmodel approach Knowl Eng Rev 36 2021 67 R Nabi I Shpitser Fair inference outcomes Proceedings ThirtySecond AAAI Conference Artiﬁcial Intelligence 2018 pp 19311940 68 JF Nash Equilibrium points nperson games Proc Natl Acad Sci 36 1 1950 4849 69 M Nielsen G Plotkin G Winskel Petri Nets Event Structures Domains Semantics Concurrent Computation Springer 1979 pp 266284 70 TD Nielsen FV Jensen Welldeﬁned decision scenarios Proceedings Fifteenth Conference Uncertainty Artiﬁcial Intelligence 1999 pp 502511 52 L Hammond J Fox T Everitt et al Artiﬁcial Intelligence 320 2023 103919 71 N Nisan T Roughgarden E Tardos VV Vazirani Eds Algorithmic Game Theory Cambridge University Press 2007 72 MJ Osborne A Rubinstein A Course Game Theory MIT Press 1994 73 J Pearl Causality Cambridge University Press 2009 74 J Pearl Probabilistic Reasoning Intelligent Systems Networks Plausible Inference Morgan Kaufmann Publishers Inc 1988 75 J Peters D Janzing B Schölkopf Elements Causal Inference Foundations Learning Algorithms The MIT Press 2017 76 A Pfeffer Y Gal On reasoning patterns agents games Proceedings 22nd National Conference Artiﬁcial Intelligence 2007 pp 102109 Multiagent Systems 2007 pp 13 77 K Polich P Gmytrasiewicz Interactive dynamic inﬂuence diagrams Proceedings 6th International Joint Conference Autonomous Agents 78 JP Ponssard On concept value information competitive situations Manag Sci 22 7 1976 739747 79 M Rabin Incorporating fairness game theory economics Am Econ Rev 83 5 1993 12811302 80 JG Richens R Beard DH Thompson Counterfactual harm arXiv2204 12993 2022 81 S Rideau G Winskel Concurrent strategies 2011 IEEE 26th Annual Symposium Logic Computer Science 2011 82 DB Rubin Causal inference potential outcomes J Am Stat Assoc 100 469 2005 322331 83 S Russell Human Compatible Penguin LCC US 2019 84 R Selten Reexamination perfectness concept equilibrium points extensive games Int J Game Theory 4 1 1975 2555 85 R Selten Spieltheoretische Behandlung Eines Oligopolmodells Mit Nachfrageträgheit Teil I Bestimmung Des Dynamischen Preisgleichgewichts J Inst Theor Econ H 2 1965 301324 86 RD Shachter Bayesball rational pastime determining irrelevance requisite information belief networks inﬂuence diagrams Proceedings Fourteenth Conference Uncertainty Artiﬁcial Intelligence 1998 pp 480487 87 RD Shachter Evaluating inﬂuence diagrams Oper Res 34 6 1986 871882 88 Y Shoham K LeytonBrown Multiagent Systems Algorithmic GameTheoretic Logical Foundations Cambridge University Press 2008 89 HA Simon Models Man Social Rational Mathematical Essays Rational Human Behavior Social Setting John Wiley Sons 1957 90 M Spence Job market signaling Q J Econ 87 3 1973 355 91 P Spirtes C Glymour R Scheines Causation Prediction Search Springer 1993 92 P Toulis DC Parkes Longterm causal effects behavioral game theory Adv Neural Inf Process Syst 29 2016 26042612 93 T Verma J Pearl Causal networks semantics expressiveness Proceedings Fourth Annual Conference Uncertainty Artiﬁcial Intelligence 1990 pp 6978 94 J von Neumann Zur Theorie der Gesellschaftsspiele Math Ann 100 1 1928 295320 95 H White K Chalak Settable systems extension pearls causal model optimization equilibrium learning J Mach Learn Res 10 2009 17591799 96 H White H Xu K Chalak Causal discourse game incomplete information J Econom 182 1 2014 4558 97 PC Wichardt Existence Nash equilibria ﬁnite extensive form games imperfect recall counterexample Games Econ Behav 63 1 2008 366369 98 G Winskel Distributed probabilistic quantum strategies Electron Notes Theor Comput Sci 298 2013 403425 99 M Wooldridge An Introduction Multiagent Systems John Wiley Sons 2009 100 M Wooldridge J Gutierrez P Harrenstein E Marchioni G Perelli A Toumi Rational veriﬁcation model checking equilibrium checking Proceedings Thirtieth AAAI Conference Artiﬁcial Intelligence 2016 pp 41844190 101 V Zahoransky J Gutierrez P Harrenstein M Wooldridge Partial order games Games 13 1 2021 2 102 J Zhang E Bareinboim Fairness decisionmaking causal explanation formula Proceedings ThirtySecond AAAI Conference Artiﬁcial Intelligence 2018 pp 20372045 53