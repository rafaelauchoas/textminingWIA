Artiﬁcial Intelligence 174 2010 889909 Contents lists available ScienceDirect Artiﬁcial Intelligence wwwelseviercomlocateartint Causal analysis Chain Event Graphs Peter Thwaites Jim Q Smith Eva Riccomagno b Department Statistics University Warwick Coventry CV4 7AL United Kingdom b Department Mathematics Università degli Studi di Genova Via Dodecaneso 35 16146 Genova Italy r t c l e n f o b s t r c t As Chain Event Graph CEG topology represents sets conditional independence statements especially useful problems lie naturally discrete asymmetric nonproduct space domain contextspeciﬁc information present In paper powerful represen tational tool wide variety causal hypotheses domains Furthermore demonstrate Causal Bayesian Networks CBNs identiﬁability effects causal manipulations observations incomplete veriﬁed simply reference topology CEG We close paper proof Back Door Theorem CEGs analogous Pearls Back Door Theorem CBNs 2010 Elsevier BV All rights reserved Article history Received 16 January 2009 Received revised form 13 May 2010 Accepted 13 May 2010 Available online 20 May 2010 Keywords Back Door Theorem Bayesian Network Causal manipulation Chain Event Graph Conditional independence Event tree Graphical model 1 Introduction Much recent work ﬁeld causality focused cause relates control analysis controlled models Here advocates approach assume existence background idle subjected sort intervention manipulation The Bayesian Network BN commonly graphical tool representing complex dependency relation ships Interpreting directionality edges BN causal leads Causal Bayesian Network CBN uses nonparametric representation based structural equation models 12192130 CBNs provide framework expressing assertions happen study externally manipulated variables assigned certain values BNs CBNs ideal problems admit natural product space structure However processes asymmetric sense measurement variables different collections possible comes given different vectors values sets ancestral variables For variety examples 41101621723 Contextspeciﬁc variants BNs exist 2262318 usually treestructured conditional probability tables annexed vertices BN allow analysis contextspeciﬁc independence properties Although graphs allow analyst greater ﬂexibility unmodiﬁed BNs ineﬃcient representations processes treatment regimes unfolding depends state particular point values speciﬁc covariates point Similarly ideal representations problems outcomes certain variables logically occur given vectors values ancestral variables Corresponding author Email address PeterThwaiteswarwickacuk P Thwaites 00043702 matter 2010 Elsevier BV All rights reserved doi101016jartint201005004 890 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 There major advances CBN theory decade 6142073534 21 good review The basic Do intervention Pearl 19 extended functional manipulations Do X gZ stochastic manipulations assign new probability distribution state space manipulated variable Nonetheless primitive level manipulation BN corresponds setting certain measurement variables speciﬁc values possibly following rule policy However effects cause reasonably represented random variable times speciﬁcation cause value random variable artiﬁcial Causes naturally represented conditioning events conditioning elegantly expressed BN An analogous case Dawid 5 argues causes decisions decision rules Although topologically complex event trees elicitation provides ﬁrst stage development model explicitly acknowledge structural asymmetries contextspeciﬁc sample space information embedded topology tree Their semantics closer verbal descriptions world especially descriptions revolve things happen world appears Event trees readily interrogated conditional independence structure model Trees advocates study causality 273025 In related ﬁeld decision analysis French Insua 11 argue advantages inﬂuence diagrams decision trees illusory point asymmetric problems particular choice action decision node makes available different choices action subsequent decision nodes available alternative choice rule exception Using trees choose level include representation dependent intend We incorporate context speciﬁc information informative causal hypotheses example 8 This particularly useful models biological regulatory mechanisms typically contain noisy gates 28 In 28 introduced alternative graphical model Chain Event Graph CEG constructed event tree set exchangeability assumptions It seen generalisation probability graph 327 typically fewer nodes original tree The CEG retains characteristics event tree allow representation asymmetric problems ﬂexible useful nodes represent intrinsic events problem edges dependencies They express topologically conditional independence structure associated problem bolted contextspeciﬁc BNs sample space information generated asymmetry problem So noncausal context CEGs provide expressive somewhat complicated topological framework expressing collections conditional independence statements discrete BN We present extension CEG models provides framework causal reasoning We believe extension transparent compelling extension BNs CBNs In Section 2 brief deﬁnition CEG description read conditional independence properties This section contains example asymmetric problem depicted graph Section 3 introduces manipulation graphs theory developed Section 4 address identiﬁcation effects manipulations Section 5 introduces Back Door Theorem CEGs generalisation Pearls Back Door Theorem BNs 21 2 Chain Event Graphs 21 Deﬁnition We provide brief deﬁnition description CEG A comprehensive deﬁnition 28 The CEG function event tree 27 begin section brief description graph An event tree T directed rooted tree vertex set V T edge set ET The nonleaf vertices called situations set situations ST The roottoleaf paths λ T form atoms event space called path σ algebra T label different possible unfoldings described process Events measurable respect space unions atoms Each situation v serves index random variable Xv values stage possible velopments unfolding process The state space Xv Xv identiﬁed set directed edges cid3 V T edges For Xv v ST ev v let cid3 ET emanating v T set endnodes v Πv cid3 cid3 cid2 π cid4 cid4 v cid5 cid4 cid4 v v cid3 v P Xv v cid6 cid3 Xv cid3 called primitive probabilities tree π v ΠT cid2 cid6 Πv vST A speciﬁcation probability model given T ΠT We extend Shafers deﬁnition event tree introduction properties coloured edges stages positions P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 891 Deﬁnition 1 The stages colouring positions event tree deﬁned follows 1 Two situations v 1 v 2 stage u Xv 1 Xv 2 distribution bijection ψ sample spaces We label set stages tree T LT 2 For v 1 v 2 u stage u edges ev 1 v 1cid3 ev 2 v 2cid3 colour ev 1 v 1cid3 maps ev 2 v 2cid3 bijection ψ π v 2cid3 v 2 π v 1cid3 v 1 3 Two situations v 1 v 2 position w subpath emanating v 1 ordered sequence colours subpath emanating v 2 We label set positions tree T K T So situations stage immediate future evolution situations governed probability law Two situations position entire future evolution situations governed probability law Deﬁnition 2 The Chain Event Graph C function tree T coloured mixed graph vertex set V C directed edge set EdC undirected edge set E uC deﬁned 1 V C K T w 2 For w w cid3 V C w exists directed edge ew w cid3 EdC iff situations v v cid3 ST v w K T v cid3 w cid3 K T edge v v cid3 ET b For w V C w exists directed edge ew w EdC iff situation v ST leafnode cid3 v T v w K T edge v v ET cid3 3 For w 1 w 2 V C exists undirected edge ew 1 w 2 E uC iff situations v 1 v 2 ST v 1 w 1 K T v 2 w 2 K T v 1 v 2 members stage u u LT We w 1 w 2 stage u label set stages C LC cid3 cid3 K T edge v v ET edge ew w 4 If v w K T v cid3 EdC cid3 w colour edge ev v cid3 There onetoone correspondence roottoleaf paths T roottosink paths C Each atom T path λw 0 w C paths form atoms σ algebra CEG Events C unions w 0 w paths We write w w w 0 w path We w cid3 EdC A collection W positions w V C called ﬁne cut C exists edge ew w parent w w 0 w paths C pass exactly w W position w precedes position w cid3 cid3 cid3 When set stages LT event tree identical set positions K T resultant CEG C simple Simple CEGs undirected edges colouring redundant treated directed acyclic graphs An example simple CEG 33 Each stage u CEG C serves index random variable Xu values stage possible developments unfolding process The state space Xu Xu identiﬁed set directed edges ew w cid3 EdC emanating w u For Xu let cid6 cid2 cid2 cid3 Πu cid3 e π cid3 cid5 cid4 cid4 w cid5 cid4 cid4 w u w w ΠC cid6 Πu uLC A speciﬁcation probability model given C ΠC 22 Conditional independence The conditional independence properties model read rapidly topology CEGrepresentation model For stage u LC let event union w 0 w paths passing w u labelled Λu let Z u variable state space Zu identiﬁed set w 0 w u subpaths Then shown 28 Xu cid10 Z u Λu read Xu independent variable deﬁned upstream u given event Λu So know unit reached stage u need know unit reached u w 0 w u subpath order predict process going unfold immediate future edge leaving w u unit going proceed In BN analogous result need vector values taken variables parents order predict value taken variable For position w V C let event union w 0 w w paths labelled Λw let Y w variable state space Yw identiﬁed set w w subpaths let Z w variable state space Zw identiﬁed set w 0 w subpaths Then 28 892 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 Y w cid10 Z w Λw read variables deﬁned downstream w independent variables deﬁned upstream given event Λw So know unit reached position w need know unit reached w order predict process going behave complete future unfolding subpath emanating w unit going pass In BN analogous result order predict vector values taken set variables X need know vector values set paX X If model depicted BN CEG model combine position stagebased expressions exactly set conditional independence statements deduce BN 28 However noted Section 1 applications processes highly asymmetric model elicitation produces asymmetric event trees event spaces admitting natural product space structure In cases CEG depiction problem embeds contextspeciﬁc conditional independence properties topology graph case BNs allows analyst deduce contextspeciﬁc properties apparent elicitation process undertaken The examples illustrate points We believe Markov property prove complete respect class independence properties presented 3128 topic future paper 23 An example This section contains example model type asymmetric structure described For simplicity problem variables example binary form indicators happens doesnt Example 21 The police hold suspect S believe threw brick shop window stole quantity money They wish bring S court reasons proceeding lack availability judge policeforce policy money needing stolen prepared pay forensic testing suspects court Whether proceed thought outcomes indicator X1 It uncertain suspect present scene money stolen indicator X2 individual threw brick stole money indicator X3 forensic service ﬁnd glass matching window glass clothing S indicator X4 witness W identify S indicator X5 S convicted released effect indicator X6 We construct event tree CEG temporal order edges representing outcomes X2 X3 preceded associated X1 However suppose constructing tree eliciting information members police force X1 ﬁrst indicator In method similar construction decision trees decision analysis 29 Unless S identiﬁed witness W S convicted The glass match believed depend S threw brick quality witness identiﬁcation believed depend S scene crime This suﬃcient information construct CEG problem Our CEG given Fig 1 simplicity subset edges EdC coloured As reasons lead police proceeding related beliefs Ss presence crime scene probabilities associated edges labelled present present stole money steal money unaffected succeed edges labelled proceed proceed Hence positions w 1 w 2 Fig 1 stage connected undirected edge positions w 3 w 4 The position w 3 represents history proceed present S thrown brick present scene edges labelled present succeeded edges labelled stole money edges labelled present If police proceed forensic evidence collected S taken court W asked testify Hence edges labelled glass match match identiﬁes S w 0 w paths starting edge proceed The success forensic test dependent S threw brick tells positions w 6 w 7 stage connected undirected edge The quality identiﬁcation dependent S crime scene tells positions w 8 w 9 stage positions w 10 w 11 stage If W identify S position w 13 probability conviction zero edge ew 13 w If W identify S probability conviction depends forensic test successful position w 12 position w 14 This explicit police told apparent fact police pay forensic test going use case The detailing possible developments case amounts description conditional independence structure problem clearly information provided contextspeciﬁc Fig 1 illustrates fact explicitly topology CEG express resulting asymmetric dependency structure We course represent problem BN adding dummy outcomes sets possible outcomes variables X3 X4 X5 imposing product space structure problem The BN supplemented contextspeciﬁc conditional independence information methods 223 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 893 Fig 1 CEG Example 21 Fig 2 Three possible BNs Example 21 The problem approach BN illdeﬁned If add possible outcome pairs outcomes present X3 X4 X5 signifying conditions Xi taking current values met add edges representing outcomes subpaths leaving w 2 w 4 terminating w 13 use resultant CEG establish following conditional independence properties involving variable X5 X5 cid10 X3 X4 X1 X2 X5 cid10 X1 X3 X2 X4 X5 cid10 X1 X2 X3 X4 1 2 3 Coupling turn properties relating X1 X2 X3 X4 X6 draw different BNs shown Fig 2 single BN problem depicts properties We choose BNs Fig 2 supplement contextspeciﬁc information ideal Now noted CEG drawn different order CEGrepresentation problem unique But difference conditional independence structure problem encoded topology CEG easily read graph constructed order problem variables appear descendants Furthermore CEG constructed order supplementing model additional assumptions discussed causal interpretation We able extend 894 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 CEGs semantics represent causal hypotheses way analogous semantics BN extended CBN 3 Manipulating Chain Event Graph 31 Principles In section deﬁne mean manipulation CEG Section 32 manipulations relate interventions BNs A CEG provides ﬂexible framework expressing happen model manipulated subject control Such manipulation results modiﬁcation usually simpliﬁcation topology idle CEG produce manipulated CEG For manipulations modiﬁcation consists simply pruning removing speciﬁed edges positions reassignment probabilities small subset directed edges CEG Discussions causal manipulation 13212730 Here follow Pearl 21 Do operator describes interventions directed acyclic graphs DAGs The joint density function set random variables X1 Xn sample spaces X1 Xn factorises according DAG px1 xn ncid7 i1 pxi pai pxi pai probability Xi taking value xi given parents X1 Xn values x1 xn A random variable forced assume speciﬁc value probability X j ˆx j j 1 n ˆx j X j A new density p cid11 ˆx j notation 15 deﬁned X1 Xn X j formula px1 x j1 x j1 xn cid11 ˆx j px1 xn px j pa j 31 This formula expresses effect manipulation Do X j ˆx j The distribution variable X j replaced new assigns weight value x j The expression readily modiﬁed stochastic intervention replacing distribution X j crude new distribution The manipulation CEGs deﬁned analogous manner replacing distributions random variables sitting positions new distributions Deﬁnition 3 Let T ΠT tree corresponding CEG C ΠC Let D ST subset situations tree ˆΠD ˆπ v cid3 Xv new distribution v D Then deﬁne manipulation tree cid5 cid3 v D v D cid3 v v D v cid3 v cid3 v Xv v π v ˆπ v ˆP cid8 cid3 cid3 Xv v ST The manipulated tree ˆT ˆΠ ˆT tree deﬁned manipulated CEG ˆC ˆΠ ˆC v CEG manipulated tree Deﬁnition 4 A manipulation tree called positioned partition positions manipulation equal coarsening partition manipulation It called staged partition stages manipulation equal coarsening partition manipulation A positioned manipulation tree treats sample units identically future development distributions identical A staged manipulation treats sample units identically development idle In experience usually suﬃcient restrict study positioned manipulations We note simple Do functional stochastic interventions BN considered Pearl 1920 positioned staged Useful manipulations tend local sense small number components ma nipulated This idea formalised Deﬁnition 3 subset edges tree CEG probabilities reassigned Where manipulation CEG corresponds simple Do functional intervention edge roottosink path probability altered 0 1 This intervention considered manipu lation set positions W positions terminate edges assigned probability Such manipulation example assignment patients particular values set covariates detailed current positions particular treatment regime set subsequent positions W For interventions type conditional independence properties characterised stagestructure stream downstream manipulation idle When manipulation set positions W roottosink paths pass positions parents positions W stagestructure downstream W manipulated graph retained idle CEG stagestructure upstream W altered The P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 895 Fig 3 Manipulated CEG ˆC manipulation w 1 conditional independence properties associated edges emanating positions parents positions W lost This useful consequence staged manipulations CEG simply replace T ΠT C ΠC cid3 w w u u D Deﬁnition 3 D ST D LC ˆπ ew w ˆΠD ˆπ v cid3 w new distribution random variable Xu w u cid3 Xv ˆΠD ˆπ ew w cid3 v v D v Our focus paper manipulations analogues BNs We start description simple interventions characterised forcing manipulation set W Example 31 single position w position parent position W child W We label set parents positions W paW Example 31 In Example 21 consider manipulation forced w 1 manipulation set W w 1 paW w 0 corresponds ensuring suspect goes court This assigns probability 1 edge ew 0 w 1 vertices edges lying w 0 w 1 w path deleted The probabilities edges manipulated CEG ˆC identical corresponding edgeprobabilities C probability edge ew 0 w 1 Our manipulated CEG ˆC given Fig 3 As probabilities manipulation remain unchanged stages marked We assume Fig 3 shows CEG valid manipulation However assumption substantive If judge available suﬃcient money stolen police believing S guilty decision proceed In case manipulated CEG certainly valid However suppose police obtain CCTV footage showing S present Then police decision proceed ensuring judge available ignoring policeforce policy necessary This interpreted manipulation w 1 case edgeprobabilities downstream manipulation change presence S CCTV footage increase probability witness identifying S example This manipulation alter topology manipulated CEG witness failing identify S longer result automatically acquittal The alternative manipulation forced w 13 interpreted contingent manipulation police proceed witness forced identify suspect A CEG intervention given Fig 4 896 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 Fig 4 Manipulated CEG ˆC manipulation w 13 As manipulation deﬁnition uses phrase police proceed reason altering probabilities ew 2 w 13 ew 4 w 13 edges stage structure Fig 4 Note manipulation enacted outside manipulator suspects brother The manipulation forcing w 12 w 14 considered Section 5 Example 32 A university residence blocks apartments rooms It allocates second year students English X1 0 Chinese X1 1 rooms apartment The second room allocated ﬁrst year student English X2 0 Chinese X2 1 random A survey recorded probability high satisfaction rating students placed student ethnicity higher students placed student different ethnicity Recording student satisfaction binary indicator Y draw CEG problem Fig 5 As Fig 1 simplicity subset edges coloured The undirected edge w 1 w 2 indicates positions stage X2 cid10 X1 reﬂecting random allocation ﬁrst year students apartments Because w 1 w 2 combined single position read Y cid10 X1 We read positions w 3 w 4 Y cid10 X1 X2 X1 X2 Y cid10 X1 X2 X1 cid13 X2 These expressions combined single statement Y cid10 X1 X2 X1 X2 Since X1 cid10 X2 Y depends X1 X2 obvious BNrepresentation problem Fig 6a The BN need supplemented extra contextspeciﬁc information required information second year students allocated ﬁrst years If consider intervention university places ﬁrst year students second years ethnicity represented CEG Fig 5 manipulation position w 3 Note manipulation cause removal undirected edge w 1 w 2 X1 cid10 X2 X1 X2 Using BN Fig 6a functional manipulation Do X2 x1 alternatively redeﬁne variable X2 outcome space 0 1 corresponding ﬁrst year student ethnicity second year student ﬁrst year student different ethnicity second year student This BN Fig 6b manipulation correspond forcing X2 value 0 deletion arc X1 X2 However BN Fig 6a BN P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 897 Fig 5 CEG Example 32 Fig 6 Possible BNs Example 32 supplemented extra information fact ﬁrst year students allocated random order fully idle The topology CEG fully represents idle allows express manipulation analyse effects 32 Interventions CEGs BNs Consider BN Fig 6a CEG Fig 5 The BN extended CBN assumption arrows edges represent causal directions mechanisms 21 So example force X2 value 1 analyse effect variable Y In CEG assumption edges X1 edges immediately precede X2 edges Fig 5 X1 cause X2 But embedding additional causal hypotheses CEGs given causal interpretation similar manner Under interpretation CEG represents controlled model variables manipulable For CEG causal particular manipulation require edges manipulated lie upstream descendants variables labelling edges We require CEG manipulated assumption distribution variables downstream manipulation remains idle valid In Example 31 brieﬂy considered case assumption valid Effectively CEG deemed valid manipulation assumptions required Deﬁnition 3 valid It possible CEG causal interpretation problem variables appear descendants It necessary variables manipulated satisfy condition If assumptions required Deﬁnition 3 valid particular CEG C manipulation CEG general form imposition new probability distributions edges leaving positions V C So example Fig 5 manipulation Do X1 0 assigns probability 1 edge ew 0 w 1 probability 0 edge ew 0 w 2 leaves edgeprobabilities unchanged In practice prune edge ew 0 w 2 edges emanating w 2 cluttered diagram Clearly assumptions required Deﬁnition 3 valid possible CEG orderings problem We CEGs accurately idle state problem given causal interpretation particular manipulation Indeed choice ordering governed wish use CEG 898 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 This holds graphical representations decision analysis example decision tree given causal order provide accurate description problem unfolds perform optimal decision analysis need extensive form decision tree All standard interventions BNs 2134 possible CEGs correspond manipulations collections positions For example simple Do intervention manipulation collections stages models reasonable talk manipulating variable X intervention Do X x0 assigns probability 1 edges labelled x0 probability 0 edges labelled x j j cid13 0 leaves edgeprobabilities unchanged In practice prune edges zero probability lying zeroprobability paths Positions CEG store vectors values preceding variables set positions emanating edges share labels partitioned values taken subset preceding variables A functional manipulation Do X gZ represented assigning probabilities emanating edges positions dependent element partition position falls A stochastic Do represented simply assigning new probability distribution edges leaving position set members emanating edges share labels Deﬁnition 3 allows look basic manipulations So example extended manipulated variable X longer corresponds original measurement variables problem The stochastic Do adapted positions corresponding X distribution imposed outgoing edges identical idle This leads case roottosink paths CEG edges manipulated corresponding example treatment regimes patients certain combinations symptoms treated We consider interventions roottosink paths subject manipulation Or modify deﬁnition CEG manipulation consider interventions produce possible outcomes position possible idle This involve imposing new distribution existing edges adding extra edges production extra paths present original CEG If enact intervention Build dam valley mouth event The village halfway valley gets ﬂooded year zero probability idle probability greater zero 31 We described manipulations BNs counterparts CEGs In Section 4 return general class manipulations possible CEGs The interventions described thought special cases generic types 4 Identifying effects manipulations Much causal BN literature 62120 studies effects manipulation prespeciﬁed random variable Y identiﬁed observing subset BNs variables observed manifest idle Necessary suﬃcient conditions causal identiﬁability expressed functions topology idle BN proved scenarios 2235734 These results allow use probabilities idle order estimate effects manipulated example effects proposed new treatment regime The topology CEG purpose Pearl 21 states causal effect X Y identiﬁable graph G quantity p y cid11 ˆx computed uniquely positive probability observed variables We generalise CEG state causal effect variable Y identiﬁable CEG C probability event Y y manipulated CEG ˆC expressed solely terms observable probabilities idle We use topology CEG ﬁnd functions data subsets possible measurements observed idle allow estimate effect given manipulation causal CEG As 21 prove suﬃcient conditions identiﬁability generalise Pearls Back Door Theorem CEG models We ﬁrst provide notation couple deﬁnitions We use λ indicate roottosink w 0 w path CEG Each λ atom path σ algebra CEG set atoms denoted Ω A subpath roottosink path denoted μ μw 1 w 2 w 1 w 2 indicate start end positions subpath A union atoms constitutes event denoted Λ M indicate union subpaths example Mw 1 w 2 union subpaths w 1 w 2 Let Λw denote event union paths passing position w Λe union paths passing edge e Λμw 1 w 2 event union paths utilising subpath μw 1 w 2 We use π w π Λw denote probability passing position w Note prob ability reaching w w 0 The probability reaching w 2 w 1 denoted π Λw 2 Λw 1 simply π w 2 w 1 Similarly πμw 2 w 1 π Λμw 1 w 2 Λw 1 probability utilising subpath μw 1 w 2 given unit reached w 1 thought probability subpath μw 1 w 2 Let πew 2 w 1 denote probability passing position w 1 adjacent position w 2 edge ew 1 w 2 Finally let Y Ω R random variable measurable respect path σ algebra CEG let Λ y partition Ω generated Y Λ y union λ Ω Y y Deﬁnition 5 For CEG C ΠC manipulation CEG yielding manipulated CEG ˆC ˆΠ ˆC manipulation forced position w P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 899 ˆπ Λw 1 1 2 ˆΠ ˆC primitive probabilities associated edges downstream w idle A manipulation forces position w ensures speciﬁed point process units probability following set possible future developments This arranging unit vector values subset preceding variables characterised Λw An example company preparing employees possible promotion ensuring attended certain training courses passed certain professional examinations In Example 31 manipulations manipulations forced position We consider effect random variable ˆY deﬁned path σ algebra ˆC ˆY generates partition root tosink paths ˆC outcome corresponding union w 0 w paths There exists variable Y deﬁned C path C belongs event Y y passes w equivalent path ˆC belongs event ˆY y Without ambiguity denote union w 0 w paths ˆC belonging event ˆY y Λ y Now w 0 w path ˆC conjunction w 0 w subpath w w subpath We denote subpaths μw 0 w μw w let union w 0 w subpaths Mw 0 w The random variable ˆY measures effect manipulation forced w So heuristically ˆY needs realised w associated events downstream w Formally require partition Λ y ˆC consists events Mw 0 w conjoined union subpaths μw w outcome ˆY y union M yw w Suppose brieﬂy considering problem admits natural product space structure depicted BN We construct CEG problem edges labelled outcomes problem variables choose construct CEG variables encountered different orders different roottosink paths In case label subset edges example outcome y0 The event Y y0 union w 0 w paths C passing edges In manipulated CEG ˆC edges disappear However left labelled y0 event ˆY y0 union w 0 w paths ˆC passing edges Lemma 1 Providing probability passing position w idle greater zero levels y manipulation forced w ˆπ ˆY y π Y y w Proof The proof lemma presented Appendix A cid2 One consequence lemma manipulation forced w possible observe indicators events Λ y Λw unmanipulated identify effect Y manipulation expression However possible observe indicators models described CBN Suppose instead observe indicators set coarser events We able observe indicators events Λ y ΛW W set positions suﬃcient identiﬁability Deﬁnition 6 A set positions W V C called C regular simply regular positions W lie directed path C ii positions W share parent V C For regular set positions W collection edges lying w 0 W subpaths partitioned deﬁning reﬁning passive edges follows 1 deﬁning edges W edges lying w 0 W subpaths emanate positions outgoing edges lie w 0 W subpaths 2 reﬁning edges W edges lying w 0 W subpaths emanate positions outgoing edges lie w 0 W subpaths outgoing edges lie w 0 w subpath individual w W 3 passive edges W edges lying w 0 W subpaths deﬁning reﬁning edges Deﬁnition 7 For CEG C ΠC manipulation CEG yielding manipulated CEG ˆC ˆΠ ˆC manipulation forced C regular set W cid9 ˆπ Λw 1 wW 1 2 ˆΠ ˆC primitive probabilities associated edges downstream w W idle 900 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 As noted Section 31 simple Do X x functional Do X gZ interventions BNs represented CEG manipulations regular set positions We construct effect random variable associated manipulation forced C regular set W So consider random variable ˆY deﬁned path σ algebra ˆC Each outcome y ˆY corresponds union w 0 w paths ˆC Λ y wish ˆY downstream W As exists corresponding variable Y deﬁned C For position w W outcome y specify event Mw 0 w M yw w provided set ˆY y Λ y union w W events μ yw w We deﬁne event Mw 0 w M yw w We wish able state conditions effect manipulation forced C regular set positions W determinable directly probabilities idle We idea amenable manipulation Deﬁnition 8 A regular set positions W simple 1 deﬁning edges W emanate positions outgoing edge lying w 0 W subpath 2 reﬁning edges W emanate positions outgoing edge lying w 0 w subpath w W 3 w W reﬁning edges w 0 w subpaths independent deﬁning passive edges subpaths sense w 1 W w 2 W w 1 μw 0 w 1 subpath exist μw 0 w 2 subpath differs colour μw 0 w 1 subpath reﬁning edges b w W colouring reﬁning edges μw 0 w subpath An immediate consequence Deﬁnition 8 w W write cid3 cid5 Λw π π R wπ cid3 cid5 ΛW π R result given Appendix A w product probabilities reﬁning edges W lying w 0 w subpaths A derivation Note direct analogy results causal identiﬁability BNs conditions deﬁnition checked reference topology CEG Condition 3b needs slight modiﬁcation chosen construct CEG different paths pass problem variables different orders Suppose brieﬂy particular problem regular admit natural product space structure edges CEG labelled outcomes problem variables It possible deﬁne passive reﬁning deﬁning variables The values labelling deﬁning edges W correspond state vector deﬁning variables D vector reﬁning variables R deﬁnes values labelling reﬁning edges whilst vector P deﬁnes values labelling passive edges In situation express condition 3 R cid10 P D Deﬁnition 9 A manipulation called amenable forcing set W 1 set W simple C Π 2 set W simple ˆC ˆΠ ˆπ ΛW 1 3 ΠC ˆΠ ˆC differ deﬁning edges W Lemma 2 Consider amenable manipulation forcing simple set W The distribution ˆY deﬁned identiﬁed probabilities unmanipulated events Y y W probabilities given equation ˆπ ˆY y π Y y W π W π W cid9 wW π Λw provided π Λw 0 w W Proof The proof lemma presented Appendix A cid2 Example 41 Consider binary BN corresponding CEG Fig 7 The manipulation set W w 7 w 9 equivalent Pearl manipulation Do X x0 amenable satisﬁes Lemma 2 For CEG Fig 7 cid5 Λw 7 π c0 cid10 π cid3 π dπ x0 d π c0π x0 d P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 901 Fig 7 BN CEG Example 41 similarly π Λw 9 W simple deﬁning edges labelled x0 reﬁning edges labelled c0 c1 passive edges labelled d0 d1 π ΛW π x0 π R w7 The CEG ˆC manipulation differs C w 3 w 4 w 5 w 6 stage edges terminating w 7 w 9 probability 1 edges terminating emanating w 8 w 10 pruned Hence π c0 cid3 cid5 Λw 7 ˆπ π c0 cid10 d π d 1 π c0 1 ˆΠ differs edges labelled x0 deﬁning edges similarly ˆπ Λw 9 So W simple ˆC manipulation amenable Letting Λ y event Y y0 cid10 cid10 ˆπ Λ y ˆπ ˆY y0 π c c d From Fig 7 cid4 cid5 cid4 ΛW π Λ y cid3 π Y y0 x0 π d 1 π y0 c x0 cid10 c π cπ y0 c x0 cid9 cid9 c π c cid9 cid9 d π dπ x0 dπ y0 c x0 d π dπ x0 d c π c cid10 c π cπ y0 c x0 ˆπ Y y0 Suppose idle CEG Example 41 represented BN particular deﬁning reﬁning passive variables deﬁned In CBN effect manipulation variable X later variable Y identiﬁed observing distribution unmanipulated pair X Y vector unobserved hidden variables H partitioned H H1 H2 H2 cid10 H1 X Y H2 cid10 H1 X Returning CEG learnt Section 22 position w write Y w cid10 Z w Λw variable deﬁned downstream w independent variables deﬁned upstream w conditioned event Λw Now w W simple set Λw explicitly characterised simply terms labelling deﬁning reﬁning edges w 0 w subpaths So situation Λw expressed terms states vectors D R 902 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 write collection conditional independence properties Y w cid10 Z w ΛwwW Y cid10 P R D Since know R cid10 P D deduce Y R cid10 P D Equating H1 P X D H2 R conditions CBN CEG So Lemma 2 exact analogue known result causal BNs general class CEGs Moreover conditions required Lemma 2 depend appropriate factorisation probabilities associated manipulated set W Using Lauritzens 15 terminology sets variables X Y H1 H2 expression 31 cid11 π y cid11 x cid10 h1h2 cid12 π x h1 h2 y π x pax Note X H1 cid10 H2 X cid10 H2 H1 equate PA X H1 write π y cid11 x cid10 cid13 π x h1 cid141π x h1π h2 y h1 x h1h2 cid10 π h1π h2 y x π y x h1h2 Y H2 cid10 H1 X Under conditions manipulating X x effect Y conditioning X x Note Example 41 clearly C cid10 D X Y C cid10 D X reﬁning variable C deﬁning variable X D passive variable 5 A Back Door Theorem Chain Event Graphs A key component causal analysis BNs Pearls Back Door Theorem 1921 owes derivation realisation manipulations impossible unethical prohibitively expensive practice possible enact effects impossible observe The Back Door Theorem gives suﬃcient conditions identifying effect variable Y manipulation variable X able observe values taken subset Z remaining variables If set Z chosen carefully calculate estimate effect partially observed idle In section produce analogous theorem applies graphical suﬃcient criterion CEG determine identify effect manipulation random variable Y observation random variable Z happening manipulation partial ordering induced paths unmanipulated The event based topology CEG allows consider wider class idle models wider class manipulations generally possible standard BN Similarly random variable Z need correspond ﬁxed subset measurement variables problem giving ﬂexibility search appropriate probability expression Before proceeding theorem provide notation couple deﬁnitions Deﬁnition 10 For C regular set positions W graph C W vertex set V C W directed edge set EdC W undirected edge set E uC W deﬁned 1 V C W consists union w new rootnode set precisely positions V C lie 0 w w subpath C w W 2 The rootnode w set precisely edges EdC lie w w subpath C w W 0 connected edge w W EdC W consists union set ew 0 wwW 3 Edgecolourings edgeprobabilities w w subpaths C W w W retained C 0 w w W given probability π Λw 4 The edge ew π ΛW 5 If positions V C W connected undirected edge C connected C W E uC W set undirected edges C W It straightforward C W CEG We let Z random variable observed C events Z z partition set w 0 w paths C consider W 1 ﬁne cut C event Z z precisely set w 0 w paths C passing speciﬁed subset positions cut We ambiguity identify event Z z set positions W 1 z Let set positions intend manipulate W 2 Then Z occur manipulation require position w 2 W 2 lies path C position w 1 W 1 z level z w Note ﬁne cut W 1 going role Z Back Door Theorem We require manipulation change primitive probabilities idle lying subpath w 0 positions W 1 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 903 To ensure need stipulate w 1 W 1 exist w 0 w 1 w 2 w path w 2 W 2 If existed w 1 W 1 w 2 ˆπ Λw 1 equal zero equal π Λw 1 Having imposed condition ensure probability Z z ˆC C Deﬁnition 11 A set C regular positions W 2 V C called simple conditioned Z cid15 z W 2 z W 2 1 W 2 2 There directed path C position w 1 z positions W 2 lie w 0 w 1 z z simple C W 1 z W 1 w path w 1 z z position w 2 W 2 W 2 W 1 z z set precisely Note union item 1 disjoint union Consider amenable manipulation set W let W simple conditioned Z Then Z called Back Door variable manipulation Let effect variable ˆY image Y manipulated CEG Theorem 1 If set W simple conditioned Z Back Door variable distribution Y amenable manipulation W identiﬁed probabilities idle events Y y W Z z probabilities given ˆπ ˆY y cid10 z π Y y W Z z π W Z z π Z z Proof The proof theorem presented Appendix A cid2 Example 51 In Example 31 considered manipulation CEG Fig 1 position w 13 police proceeded witness forced identify S Consider manipulation witness forced identify S This manipulation forced W w 12 w 14 The manipulated CEG given Fig 8 Whereas previous manipulation enacted outside manipulator suspects brother intervention likely enacted police force probably acting unethical manner They wish good idea effects indicator X6 manipulation consequence improper nature intervention means obtaining reliable estimates certain necessary joint distributions problem variables In particular probably treat X4 indicating forensic service ﬁnd glass match unobservable variable Can produce manipulated probability expression depend X4 Consider BNs Fig 2 use Pearls Back Door Theorem 1921 For BN 1 use Back Door blocking set consisting X1 X2 andor X3 BNs 2 3 blocking set include X4 So BN 1 use If BN supplemented relevant contextspeciﬁc information able produce identiﬁable expression But noted Section 23 BNs Fig 2 welldeﬁned encodes set conditional independence properties problem problem unambiguous representation CEG CEG need supplemented extra information Moreover use Theorem 1 deduce effect X6 manipulation produce expression dependent X4 Notice probabilities ˆC differ deﬁning edges W C regular set edges labelled proceed identiﬁes S At ﬁrst sight manipulation satisfy conditions Theorem 1 manipu lated edge proceed necessarily upstream possible Back Door blocking set propose But w 0 W paths pass w 1 ˆπ conviction ˆπ conviction Λw 1 This simply manipulated probability conviction CEG C w1 Deﬁnition 10 We simply consider CEG C w1 apply Theorem 1 W C w1 regular deﬁning reﬁning passive edges W C w1 precisely deﬁning reﬁning passive edges W C lie downstream position w 1 checking conditions Theorem 1 original graph Fig 1 The ideas allow apply Theorem 1 situations ﬁrst sight apparently appropriate Note set W 1 need longer ﬁne cut C C w1 partition roottosink paths ˆC So consider set W 1 w 5 w 6 w 7 upstream set W W 2 w 12 w 14 Assign value z 1 paths passing w 5 stole money z 2 paths passing w 6 present steal money z 3 paths passing w 7 present Then W 1 W 3 w 5 W 1 z3 W 2 construction W 2 simple C W 1 z conditions Deﬁnition 11 satisﬁed W 2 simple conditioned Z C w1 We need produce separate graphs deﬁning edges W 2 labelled identiﬁes S C W 1 reﬁning edges labelled glass match match These edges obey conditions Deﬁnition 8 W 2 checking C Fig 1 For C W 1 w 6 W 1 If let W 2 W 1 w 7 W 2 z1 z2 z2 z1 z3 z z z 904 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 Fig 8 Manipulated CEG ˆC Example 51 simple C W 1 variable Y satisfy conditions Theorem 1 X6 outcome conviction equating Y y simple conditioned Z C w1 Our variable Z manipulation set W W 2 effect z Hence CEG C w1 ˆπ conviction 3cid10 z1 π conviction W z π W z π z 3cid10 z1 π conviction identiﬁes S zπ z set W corresponds event X5 takes outcome identiﬁes S Note primitive probabilities C w1 identical C probability edge ew 0 w 1 probability z C w1 probability z C divided π proceed Hence C manipulated probability expression ˆπ conviction 1 π proceed 3cid10 z1 π conviction identiﬁes S zπ z It diﬃcult check formula correctly expresses causal effect X6 manipulation Moreover positions w 5 w 6 w 7 characterised values X2 X3 expression require knowledge distribution X4 joint distributions including X4 As BNs conjecture possible devise simple automated methods determining exist variables Z satisfying conditions Theorem 1 procedures choosing candidate variables Z These methods fully developed If believe variable exist Example 51 shows choosing positions partition satisfy conditions Theorem 1 minimise straightforward We construct set W 1 z work involved The events Z z observable manifest necessary events actually observed Example 51 police observe suspect scene threw brick consider reliable estimates probabilities How assign z values positions depends information available example assign value z 2 w 6 w 7 let W 1 new partition satisﬁes conditions w 6 w 7 W 2 simple new C W 1 z2 z2 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 905 Fig 9 CEG Example 52 Theorem 1 We choice coarser ﬁner partitions choose depend structure information hold conditional distributions X6 If able choose coarser partition resulting expression ˆπ conviction simpler The updating edgeprobabilities CEG following manipulation rapidly automat ically algorithms analogous described coded updating edgeprobabilities following observation 33 32 Example 52 First year students university Example 32 university ﬁrst choice application Z 0 allocated shared apartment campus whilst ﬁrst year students Z 1 lodged town K town L indicator X3 Students lodged towns K L friendly landlord unfriendly landlord indicator U friendliness landlords known university When Z 0 believed CEG Fig 5 valid Y explicitly satisfaction expressed ﬁrst year student If Z 1 town student lodged chosen independently ethnicity X2 student friendliness landlord depend town ethnicity student satisfaction rating Y expressed ﬁrst year student depends friendliness landlord allocated town The problem represented CEG Fig 9 We wish consider proposed manipulation allocation policy year The university plans match campusbased students sharing apartment ethnicity allocate offcampus students lodgings town L Our ˆπ high overall predicted probability high satisfaction policy implemented The university intends estimate probability small data set collected earlier years The manipulation proposed different different contingencies irrelevant analysing CEG It considered manipulation W w 6 w 11 w 13 If consider partition W 1 w 1 w 2 z straightforward check variable Z manipulation set W effect variable Y satisfy conditions Theorem 1 ˆπ high 1cid10 z0 π high z W π z π high Z 0 X1 X2π Z 0 π Y 1 Z 1 town Lπ Z 1 So ˆπ high expressed function probabilities idle student resides campus campusbased student sharing ethnicity gives high satisfaction rating student lodging town L gives high satisfaction rating It follows probabilities associated ethnicity matched pairs campusbased students satisfaction ratings unmatched pairs campusbased students ethnicity non campusbased students friendliness landlords noncampusbased students irrelevant calculation need estimated 906 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 Note ˆπ high function event X1 X2 alternatively variable X1 X2 This original measurement variables problem appears naturally CEG Fig 9 outcomes correspond positions w 6 w 7 To summarise examining topology colouring idle CEG possible determine suﬃcient ditions effect causal manipulation identiﬁed partial set observations The CEG ideally suited causal analysis models highly asymmetric Also search appropriate random variable Z observation ensures identiﬁability restricted subvectors original nondescendant measurement vectors search functions measurements Searching functions ﬁnd cheapest way identifying quantity greater value simply searching subsets measurements This particularly useful measurements collected parameterisa tions chosen convention reﬂect natural description process unfolds If intervention identiﬁed CEG case imposing product space problem able express BN ﬁnd identiﬁable expression effects intervention BN However identiﬁcation probably require supplementary contextspeciﬁc information present DAG BN appears naturally CEGrepresentation problem 6 Discussion We demonstrated CEG provides ﬂexible graphical framework represent analyse wide variety causal hypotheses highly asymmetrical domains There course cost ﬂexibility CEGs general vertices edges BNs For symmetric problems favours BNbased procedures problems symmetric CEGs eﬃcient modelstorage space algorithms updating probabilities 33 An analysis comparative complexity CBNs CEGs focus future paper Of course Back Door Theorem presented paper topological criterion determining causal extensions example possible produce prove analogues Pearls Front Door Theorem 31 In 9 shown CEGs admit conjugate learning model selection Currently investigation extensions learning CEGs underlying experiments causally manipulated similar approach 14 admit conjugate analysis Despite complex topology causal CEGs general expressive CBNs provide useful complementary technology As BN limits expressiveness CEG issues cause identiﬁed addressed algebraically 24 Nonetheless popularity BN demonstrated appeal graphicalbased causal inference useful inference CEGs provide powerful additional graphical tool investigation causal structures easily fully expressible CBNs Acknowledgements This research supported EPSRC grant EPF0367521 We like thank referees perceptive helpful comments enabled markedly improve clarity paper Appendix A Proofs Lemma 3 Proof Lemma 1 In ˆC express event ˆY y Λ y Mw 0 w M yw w Λw ΛM yw w Hence cid3 cid5cid5 cid3 cid3 cid3 cid3 cid5 Λw ˆπ Λ M yw w cid5 cid4 cid5 cid4 Λw ˆπ ˆY y ˆπ Λ y ˆπ cid5 ˆπ Λw cid3 Λw Λ M yw w ˆπM y w w 1 πM y w w ˆπ Deﬁnition 51 2 By deﬁnition Y C π Y y w π cid3 ˆπ ˆY y cid5 Λ y Λw cid3 Λw cid13 π cid3 cid5 Λw cid3 πM y w w π cid5 Λ y Λw Λ y cid3 π cid5cid141π cid4 cid5 cid4 Λw π Y y w cid2 Derivation result π Λw π R passive deﬁning reﬁning edges write w π ΛW Consider single subpath μw 0 w w W This consists set cid3 cid3 Λ π cid5cid5 μw 0 w π P μπ D μ π R μ π P μ product probabilities passive edges μ P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 907 For simple W Deﬁnition 83b implies π R cid10 cid3 cid5 Λw π π R w μπ D π P μ μ constant μw 0 w Relabel π R w Therefore μμw 0w Deﬁnition 83a implies μ μw 0 w 1 corresponding μ μw 0 w 2 π P cid9 value w 2 W w 1 Therefore μ takes μ constant w W Relabel π cid3 W μμw0w π P μ π D μ π D cid3 cid5 ΛW π cid10 wW cid3 cid5 Λw π cid10 cid13 cid14 w π cid3 π R W wW cid11 cid10 cid12 π R w π cid3 W wW cid9 By Deﬁnition 62 construction possible combinations reﬁning edges partition set w 0 W subpaths π ΛW wW π R w cid3 1 Hence π cid3 W cid5 Λw π R π cid3 cid5 ΛW wπ Proof Lemma 2 As manipulation amenable w W cid3 cid5 Λw π π R wπ cid3 cid5 ΛW π R w product probabilities reﬁning edges w So cid3 cid3 cid5 Λw ˆπ ˆπ R w ˆπ cid5 ΛW π R w Deﬁnition 93 ΠC ˆΠ ˆC differ deﬁning edges W reﬁning edges w W ii Deﬁnition 92 So cid5cid141π cid5 Λw cid5 Λw ΛW cid13 π ˆπ cid3 cid3 cid3 In ˆC event ˆY y Λ y equal Λ y ΛW So cid15 wW Mw 0 w M yw w The corresponding event C Y y W ˆπ ˆY y ˆπ Λ y cid10 wW cid10 cid3 cid5 Λw ˆπ cid3 cid5 Λw ˆπ wW cid3 cid13 π ΛW cid5cid141 ˆπM y w w πM y w w Deﬁnition 72 cid10 cid3 cid5 Λw π πM y w w cid13 π π cid3 cid3 cid5cid141π ΛW cid4 cid5 cid4 ΛW Λ y wW cid3 cid5 Λ y ΛW π Y y W π W cid2 Lemma 3 If W 1 W 2 C regular sets positions W 2 simple CEG C W 1 π Λw 2 ΛW 1 ΛW 2 written product probabilities reﬁning edges W 2 C Proof Let w position C W 1 root By construction C W 1 subCEG C W 1 rooted w precisely topology edgecolouring edgeprobabilities subCEG C rooted w Suppose edges leaving w reﬁning edges W 2 C W 1 Then edges leaving w w w 2 W 2 subpaths w 2 subpath C W 1 C W 1 C Also W 2 simple C W 1 edge leaving w lies w individual w 2 W 2 So edge leaving w lies w 0 w 2 subpath C individual w 2 W 2 Hence edges leaving w reﬁning edges C The reﬁning edges W 2 C W 1 precisely reﬁning edges W 2 C lie downstream W 1 Let probabilities C W 1 denoted π Then W 2 simple C W 1 implies π Λw 2 ΛW 2 expressed product probabilities reﬁning edges W 2 C W 1 expressed product probabilities reﬁning edges W 2 C But 0 0 908 P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 cid3 cid3 Λ π w 2 cid3 cid5 cid4 cid4 Λ W 2 cid5cid5 cid3 cid3 cid13 π Λ cid11cid10 W 2 cid3 cid3 π Λ cid5cid5cid141 π cid3 Λ cid3 cid5cid5 cid3 Λ π w 1 cid5cid5 w 2 cid3 W 2 cid121 cid10 cid5cid5 cid3 cid5 cid4 cid4 Λ w 1 cid3 cid3 Λ π cid5cid5 cid3 cid3 Λ π w 1 w 2 cid3 cid5 cid4 cid4 Λ w 1 cid5cid5 w 1 cid11cid10 w 1 π Λw 1 π ΛW 1 cid3 cid3 Λ π W 2 cid3 cid5 cid4 cid4 Λ w 1 cid5cid5 w 1 cid121 cid10 w 1 π Λw 1 π ΛW 1 cid3 cid3 Λ π w 2 cid3 cid5 cid4 cid4 Λ w 1 cid5cid5 Deﬁnition 103 4 cid3 cid3 cid3 cid5 cid13 π cid3 π Λ cid3 Λ W 1 Λ cid5 cid4 cid3 cid4 Λ w 2 W 2 cid5 W 1 cid3 cid5cid5cid141π W 2 Λ cid3 Λ cid5cid5 cid5cid5 cid3 w 2 cid3 cid5 W 1 cid2 Λ Proof Theorem 1 Let W W 2 W 2 simple conditioned Z express W 2 C W 1 z Now cid3 cid3 π w 2 Λ ˆπ cid5cid5 cid3 cid5 cid4 cid4 Λ cid3 cid3 Λ W 1 z cid5 cid4 cid4 Λ w 2 π cid3 W 1 z cid3 cid3 Λ cid5cid5 cid5 cid3 cid3 cid5 cid4 cid4 Λ cid3 Λ cid3 W 1 Λ z cid5 cid4 cid3 cid4 Λ w 2 w 2 ˆπ W 2 cid5 W 1 z cid5cid5 π cid3 Λ cid3 cid3 Λ W 2 W 2 cid3 cid5cid5 ˆπ cid5cid5 cid3 cid5 cid4 cid4 Λ cid3 Λ W 1 z cid5 cid4 cid4 Λ W 2 cid3 W 1 z cid5cid5 cid3 cid3 Λ w 2 cid3 cid5 cid4 cid4 Λ π W 1 z cid5 cid3 Λ W 2 cid5cid5 cid15 z W 2 z W 2 z simple Lemma 3 π Λw 2 ΛW 1 z ΛW 2 written product probabilities reﬁning edges W 2 C Deﬁnition 93 ΠC ˆΠ ˆC differ deﬁning edges W 2 ii fact ˆπ ΛW 2 ΛW 1 z 1 Therefore cid3 cid3 cid3 cid5 cid4 cid4 Λ cid5cid5 cid3 cid3 cid13 π cid3 cid5 cid4 cid4 Λ cid3 cid5cid5cid141π cid3 ˆπ Λ Λ w 2 W 2 W 1 z Consider ˆC events Z z ΛW 1 Z z ˆY y ΛW 1 Analogously Lemma 2 express event z w 1 W 1 z exists ˆC construction z ΛW 2 Λ y ˆC paths pass W 2 W 1 z w 2 Λ cid5 cid4 cid4 Λ cid5cid5 cid3 W 1 z cid16 cid16 cid13 cid3 M w 0 w 1 w 2 cid5 cid3 M y w 2 w cid5cid14 w 1W 1 z w 2W 2 Mw 0 w 1 w 2 union μw 0 w 1 w 2 subpaths M yw 2 w union μw 2 w sub paths consistent ˆY y So cid10 cid10 cid3 cid3 ˆπ Λ w 1 cid5 cid3 cid5cid5 w 2 cid3 ˆπM y w cid5 cid4 cid4 w 2 ˆπ Z z ˆY y w 1W 1 z cid3 cid3 w 2W 2 cid5 ˆπ ˆY y Z z ˆπ cid13 ˆπ Λ cid3 Λ Λ y cid5cid5cid141 W 2 cid3 W 1 z Λ cid5cid5 cid10 cid3 cid4 cid4 Λ W 1 z cid10 cid11 cid10 cid3 cid3 cid13 ˆπ Λ w 1W 1 z cid5cid5cid141 w 2W 2 cid10 W 1 z cid3 cid3 Λ ˆπ w 1 cid5 Λ cid3 w 2 cid5cid5 cid3 ˆπM y w cid5 cid4 cid4 w 2 cid3 cid3 Λ ˆπ w 1 cid5 Λ cid3 w 2 cid12 cid5cid5 cid3 ˆπM y w cid5 cid4 cid4 w 2 cid3 cid3 Λ ˆπ w 2 cid3 cid5 cid4 cid4 Λ cid3 cid3 cid13 π Λ W 2 cid3 cid5 cid4 cid4 Λ W 1 z cid3 w 1W 1 z cid5cid5 ˆπM y cid5cid5cid141π W 1 z cid5 cid4 cid4 w 2 w cid3 cid3 Λ w 2 cid3 cid5 cid4 cid4 Λ cid5cid5 cid3 πM y W 1 z cid5 w w 2 w 2W 2 cid10 w 2W 2 cid10 w 2W 2 A1 A2 Deﬁnition 93 Deﬁnition 72 cid3 cid3 cid3 cid5 cid3 cid3 cid3 cid13 π Λ W 2 cid5 cid4 cid4 Λ cid5cid5cid141π W 1 z Λ W 2 Λ y cid4 cid4 Λ cid5cid5 W 1 z equivalence entities expressions A1 A2 removing hats proof aspect topology ˆC true C Also W 1 ﬁne cut w 0 w paths C pass w 1 W 1 Deﬁnition 112 w 1 W 1 lies w 0 W 2 path So Deﬁnition 61 edges leaving positions upstream W 1 deﬁning edges P Thwaites et al Artiﬁcial Intelligence 174 2010 889909 909 W 2 But manipulation amenable W 2 Deﬁnition 93 ΠC ˆΠ ˆC differ deﬁning edges W 2 So probabilities edges upstream W 1 ˆC C cid3 cid3 cid5cid5 cid3 cid3 w 1 π w 1 Λ cid3 ˆπ Z z ˆπ Λ cid5cid5 cid3 Λ w 1 W 1 cid3 π W 1 z cid5cid5 Λ cid5cid5 cid3 W 1 z π Z z ˆπ So ˆπ ˆY y References cid10 z cid10 ˆπ ˆY y Z z ˆπ Z z cid5cid5cid141π cid5 cid4 cid4 Λ W 2 cid13 π Λ cid3 cid3 cid3 W 1 z cid3 cid3 Λ W 2 cid5 Λ y cid3 cid4 cid4 Λ W 1 z cid5cid5 cid3 cid3 Λ π W 1 z cid5cid5 z cid10 cid11 z π Y y W Z z π W Z z cid12 π Z z cid2 1 T Bedford R Cooke Probabilistic Risk Analysis Foundations Methods Cambridge 2001 pp 99151 2 C Boutilier N Friedman M Goldszmidt D Koller Contextspeciﬁc independence Bayesian Networks Proceedings 12th Conference Uncertainty Artiﬁcial Intelligence Portland Oregon 1996 pp 115123 3 RE Bryant Graphical algorithms Boolean function manipulation IEEE Transactions Computers C 35 1986 677691 4 GA Churchill Accurate restoration DNA sequences C Gatsaris et al Eds Case Studies Bayesian Statistics vol 2 SpringerVerlag 1995 pp 90148 5 AP Dawid Causal inference counterfactuals Journal American Statistical Association 95 2000 407448 6 AP Dawid Inﬂuence diagrams causal modelling inference International Statistical Review 70 2002 161189 7 AP Dawid V Didelez Identifying consequences dynamic treatment strategies Research Report 262 University College London 2005 8 AP Dawid J Moertera VL Pascali D Van Boxel Probabilistic expert systems forensic inference genetic markers Scandinavian Journal Statistics 29 2002 577595 9 G Freeman JQ Smith Bayesian MAP model selection Chain Event Graphs Research Report 0906 CRiSM 2009 10 S French Ed Readings Decision Analysis Chapman HallCRC 1989 11 S French DR Insua Statistical Decision Theory Arnold 2000 12 D Glymour GF Cooper Computation Causation Discovery MIT Press 1999 13 D Hausman Causal Asymmetries Cambridge University Press 1998 14 D Heckerman A Bayesian approach Learning Causal Networks W Edwards et al Eds Advances Decision Analysis CUP 2007 pp 202220 15 SL Lauritzen Causal inference graphical models OE BarndorffNielsen et al Eds Complex Stochastic Systems Chapman Hall 2001 16 R Lyons Random walks percolation trees Annals Probability 18 1990 931958 17 AM Madrigal JQ Smith Causal identiﬁcation Design Networks LE Sucar et al Eds Advances Artiﬁcial Intelligence vol 2 Springer Verlag 2004 18 D McAllester M Collins F Periera Case factor diagrams structured probabilistic modeling Proceedings 20th Conference Uncertainty Artiﬁcial Intelligence 2004 pp 382391 19 J Pearl Causal diagrams empirical research Biometrika 82 1995 669710 20 J Pearl Statistics causal inference A review Sociedad Estadistica e Investigacion Operativa Test 12 2 2003 281345 21 J Pearl Causality Models Reasoning Inference 2nd edition Cambridge 2009 22 J Pearl JM Robins Probabilistic evaluation sequential plans causal models hidden variables Proceedings 11th Conference Uncertainty Artiﬁcial Intelligence 1995 pp 444445 23 D Poole NL Zhang Exploiting contextual independence probabilistic inference Journal Artiﬁcial Intelligence Research 18 2003 263313 24 EM Riccomagno JQ Smith The geometry causal probability trees algebraically constrained L Pronzato A Zhigljavsky Eds Optimal Design Related Areas Optimization Statistics Springer 2008 pp 131152 25 JM Robins A new approach causal inference mortality studies sustained exposure period application control healthy worker survivor effect Mathematical Modelling 7 1986 13931512 26 A Salmeron A Cano S Moral Importance sampling Bayesian Networks probability trees Computational Statistics Data Analysis 34 2000 387413 27 G Shafer The Art Causal Conjecture MIT Press 1996 28 JQ Smith PE Anderson Conditional independence Chain Event Graphs Artiﬁcial Intelligence 172 2008 4268 29 JQ Smith PA Thwaites Decision trees EL Melnick BS Everitt Eds Encyclopedia Quantitative Risk Analysis Assessment vol 2 Wiley 2008 pp 462470 30 P Spirtes C Glymour R Scheines Causation Prediction Search SpringerVerlag 1993 31 PA Thwaites Chain Event Graphs Theory application PhD thesis University Warwick 2008 32 PA Thwaites JQ Smith Nonsymmetric models Chain Event Graphs propagation Proceedings 11th International Conference Infor mation Processing Management Uncertainty KnowledgeBased Systems Paris 2006 pp 23392347 33 PA Thwaites JQ Smith RG Cowell Propagation Chain Event Graphs Proceedings 24th Conference Uncertainty Artiﬁcial Intelligence Helsinki 2008 pp 546553 34 J Tian Identifying dynamic sequential plans Proceedings 24th Conference Uncertainty Artiﬁcial Intelligence Helsinki 2008 pp 554 561 35 J Tian J Pearl A general identiﬁcation condition causal effects Proceedings 18th National Conference Artiﬁcial Intelligence AAAI Press 2002 pp 567573