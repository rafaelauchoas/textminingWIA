Artiﬁcial Intelligence 174 2010 951983 Contents lists available ScienceDirect Artiﬁcial Intelligence wwwelseviercomlocateartint Reasoning cardinal directions extended objects Weiming Liu Xiaotong Zhang b Sanjiang Li ab Mingsheng Ying ab Centre Quantum Computation Intelligent Systems Faculty Engineering Information Technology University Technology Sydney Australia b State Key Laboratory Intelligent Technology Systems Tsinghua National Laboratory Information Science Technology Department Computer Science Technology Tsinghua University Beijing 100084 China r t c l e n f o b s t r c t Article history Received 6 July 2009 Received revised form 18 May 2010 Accepted 18 May 2010 Keywords Qualitative spatial reasoning Cardinal direction calculus Connected regions Consistency checking Maximal canonical solution 1 Introduction Direction relations extended spatial objects important commonsense knowl edge Recently Goyal Egenhofer proposed relation model known cardinal direction calculus CDC representing direction relations connected plane gions The CDC expressive qualitative calculus directional infor mation attracted increasing areas artiﬁcial intelligence geographical information science image retrieval Given network CDC constraints consistency problem deciding network realizable connected regions real plane This paper provides cubic algorithm checking consistency complete networks basic CDC constraints proves reasoning CDC general NPcomplete problem For consistent complete network basic CDC constraints al gorithm returns canonical solution cubic time This cubic algorithm adapted check consistency complete networks basic cardinal constraints possibly disconnected regions 2010 Elsevier BV All rights reserved Representing reasoning spatial information particular importance areas artiﬁcial intelligence AI geographical information systems GISs robotics vision image retrieval natural language processing While numerical quantitative approach prevails robotics vision widely acknowledged AI GIS qualitative approach attractive 6 A predominant spatial information represented relations spatial objects In general spatial relations classiﬁed categories topological directional metric size distance shape The RCC8 constraint language 34 principal topological formalism AI extensively investigated researchers 37354374746242523 When restricted simple plane regions RCC8 equivalent 9Intersection Model 9IM 9 inﬂuential relation model GIS Unlike topological relations competitive models direction relations 10112 Most models approximate spatial object point centroid box This crude realworld applications describing directional information countries Portugal Spain Recently Goyal Egenhofer 1615 proposed relation model known cardinal direction calculus CDC representing direction relations connected plane regions In CDC reference object approximated box primary object This paper extended version Xiaotong Zhang Weiming Liu Sanjiang Li Mingsheng Ying Reasoning cardinal directions An eﬃcient algorithm AAAI 2008 pp 387392 Corresponding author Centre Quantum Computation Intelligent Systems Faculty Engineering Information Technology University Technology Sydney PO Box 123 Broadway NSW 2007 Australia Email address sanjiangliutseduau S Li 00043702 matter 2010 Elsevier BV All rights reserved doi101016jartint201005006 952 W Liu et al Artiﬁcial Intelligence 174 2010 951983 approximated This means exact geometry primary object representation direction This calculus 218 basic relations large compared RCC8 Allens Interval Algebra 1 Due expressiveness CDC attracted increasing areas AI 404131 GIS 17 database 39 image retrieval 19 One basic criterion evaluating spatial relation model proper balance representation expressivity reasoning complexity While reasoning complexity pointbased boxbased model direction relations investigated depth 26 2 works discussing complexity reasoning CDC One central reasoning problem CDC qualitative calculus consistency satisfaction prob lem Other reasoning problems deriving new knowledge given information updating given knowledge ﬁnding minimal representation easily transformed consistency problem 6 In particular given com plete network CDC constraints N v iδi j v jn j1 δi j CDC relation 1 n spatial variables v 1 vn consistency problem deciding N realizable set n connected regions real plane The consistency problem CDC open problem Before work know eﬃcient algorithms deciding set CDC constraints realizable Even worse know decidable problem Furthermore know construct realization satisﬁable set CDC constraints This paper devoted solving problems We ﬁrst consistent CDC network canonical solution Theorem 3 devise cubic algorithm checking complete network basic CDC constraints consistent When network consistent algorithm generates canonical solution We deciding consistency arbitrary network CDC constraints NPComplete problem This implies particular reasoning CDC decidable Some restricted versions consistency problem discussed literature Cicerone di Felice 3 discussed pairwise consistency problem decides pair basic CDC relations δ δcid3 consistent v 1δv 2 v 2δcid3 v 1 consistent Skiadopoulos Koubarakis 40 investigated weak composition problem 724 CDC closely related consistency problem basic CDC networks involving variables The CDC algebra deﬁned connected regions A variant CDC proposed 41 cardinal directions possibly disconnected regions deﬁned way This calculus termed CDCd paper contains 511 basic relations An O n5 algorithm1 proposed 41 checking consistency basic constraints CDCd consistency problem CDC open Recently Navarrete et al 31 tried adapt approach 41 cope connected regions approach turns incorrect Remark 3 Section 61 paper The remainder paper proceeds follows Section 2 recalls basic notions qualitative spatialtemporal reasoning introduces wellknown Interval Algebra IA 1 We introduce CDC algebra Section 3 connection CDC IA relations established natural way Section 4 introduces notion canonical solution consistent basic CDC network Section 5 ﬁrst proposes intuitive O n4 algorithm consistency checking complete basic networks improves O n3 In Section 6 ﬁrst local consistency insuﬃcient decide consistency basic CDC networks apply main algorithm pairwise consistency problem weak composition problem In Section 7 adapt main algorithm connected regions solve consistency checking variants CDC Section 8 discusses related work computational properties qualitative direction calculi Conclusions given section Codes main algorithm available httpsitesgooglecomsitelisanjiangcdc provide illustra tions 757 different consistent pairs CDC basic relations illustration weak composition S W W N E E Interested readers consult webpage detailed proofs minor results omitted present paper Table 1 summaries notations paper 2 Qualitative calculi Basic notions examples Since Allens Interval Algebra study qualitative calculi relation models central topic qualitative spatial temporal reasoning This section introduces basic notions important examples qualitative calculi 21 Basic notions Let D universe temporal spatial spatialtemporal entities We use small Greek symbols representing relations D For relation α D elements x y D write x y α xα y indicate x y instance α For relations α β D deﬁne complement α intersection union α β follows 1 We note algorithm applies possibly incomplete set basic constraints W Liu et al Artiﬁcial Intelligence 174 2010 951983 953 Table 1 Notations Notations Meanings α β γ δ θ v v j N b c I xa I y Ma χ χ ai n i1 ιxδ ι y δ ιxδ γ ρ x j ρ y j Nx N y Ii n mi Sa Ca ci j pi j p pk ar bi ci Ba i1 J n i1 Eq 12 relations p 952 spatial variable interval variable p 953 network constraints p 953 regions p 954 x yprojective intervals region Eq 4 minimal bounding rectangle mbr region Eq 5 tile variable p 955 tile χ p 955 set regions ai p 959 x yprojective interval relations δ Eq 10 deﬁned ιxδ ιxγ deﬁned ιxδi j δ ji m mi Eq 14 deﬁned ι y δi j δ ji m mi Eq 15 x yprojective IA networks N p 958 sets intervals p 962 rectangle p 962 frame Eq 18 cell set Eq 20 cell Ca Eq 19 pixels pi j 1 j j 1 Deﬁnition 8 regularization ai Eq 21 special digital region contained mi Eq 25 connected component bi mbr mi Lemma 5 Boolean matrix digital region Eq 30 cid2 α α β α β x y D D x y α cid2 cid3 cid2 x y D D x y α x y β cid3 x y D D x y α x y β cid3 We write RelD set binary relations D Clearly 6tuple RelD D D Boolean algebra D D relation universal relation D respectively A ﬁnite set B nonempty relations D jointly exhaustive pairwise disjoint JEPD entities D related relation B We write cid8Bcid9 subalgebra RelD generated B smallest subalgebra Boolean algebra RelD contains B Clearly relations B atoms Boolean algebra cid8Bcid9 We cid8Bcid9 qualitative calculus D relations B basic relations calculus A similar deﬁnition given Ligozat Renz 27 B required closed converse contain idD identity relation D For relations α β D converse α composition α β deﬁned usual cid2 α α β y x D D x y α cid4 cid2 x z α z y β x y D D z D cid5cid3 cid3 For relations α β cid8Bcid9 possible α α β cid8Bcid9 represented union relations B We qualitative calculus cid8Bcid9 closed composition closed converse resp composition relations converse relation resp cid8Bcid9 relation cid8Bcid9 An important reasoning problem qualitative calculus cid8Bcid9 consistency satisfaction problem Let A subset cid8Bcid9 A constraint A form xγ y γ A For set variables V v i1 set constraints N involving variables V N complete constraint network network short exists unique constraint v iγ v j N pair j A network N said A constraint N A In particular network basic network B We stress paper basic network constraints network basic constraints complete basic constraint speciﬁed pair variables j1 consistent satisﬁable instantiation ain A constraint network N v iγi j v jn i1 D i1 solution N The consistency problem A ai j γi j holds 1 cid2 j cid2 n In case ain decision problem consistency constraint networks A 22 The Interval Algebra The Interval Algebra IA 1 qualitative calculus deﬁned set closed bounded intervals real line The IA generated set Bint 13 JEPD relations intervals Table 2 The IA closed converse composition It relation algebra sense Tarski 44 The computational complexity reasoning IA extensively investigated researchers artiﬁcial intelligence 3321 954 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Table 2 Basic IA relations converses x x x y y y Relation meets overlaps starts ﬁnishes equals Symbol Converse p m o s d f eq pi mi oi si di ﬁ eq Meaning x x x x y x y x x y x y y x y y x x x x x y y y y y y y references In particular Allen 1 introduced important notion pathconsistency networks IA constraints ValdésPérez 45 proved pathconsistency suﬃces decide consistency basic IA networks The deﬁnitions basic IA relations given Table 2 concern ordering endpoints intervals This suggests different solutions basic IA network respect ordering In particular choose intervals integer endpoints Deﬁnition 1 canonical set intervals 28 Suppose l l i1 set intervals Let El set endpoints intervals l We l canonical set intervals iff El 0 M Z M largest number El A solution basic IA network called canonical interval solution canonical set intervals l n Clearly l l l n i1 canonical set intervals l let M largest number El Then M 2n 0 cid2 l cid2 M exists l following theorem shows consistent basic IA network unique canonical solution l integer 0 2n 1 Moreover l The l l Theorem 1 Suppose N v iλi j v jn j1 basic IA network If N consistent unique canonical interval solution Proof Suppose l l h El 0 1 n h hl hl solution N Such solution clearly unique cid2 i1 solution N Write α0 α1 αn ordering El l n n l i1 Deﬁne hx k x αk Because ordering endpoints intervals matters solution Z Therefore h canonical interval i1 solution N Moreover clear Eh 0 n n l 3 Cardinal direction calculus In section ﬁrst introduce cardinal direction calculus CDC 1640 establish connection Interval Algebra In particular associate basic IA networks Nx N y basic CDC network N N consistent Nx N y consistent 31 Direction relation matrix The CDC qualitative calculus deﬁned extended objects plane Deﬁnition 2 plane region A subset plane called region nonempty regular closed subset x topological interior topological closure subset x plane respectively x Connectedness important topological property plane regions Deﬁnition 3 connected region simple region A region said connected connected interior nonempty open sets u v plane u v topologically equivalent closed disk u v nonempty A connected region called simple By deﬁnition connected region connected interior Regions property called strongly connected Note boundary connected region disconnected In contrast simple regions connected interior connected boundary Examples plane regions illustrated Fig 1 For bounded set b real plane let x cid2 b inf b inf y x x y b cid2 y x y b cid3 cid3 x b sup b sup y cid2 cid3 x x y b cid3 cid2 y x y b 2 3 W Liu et al Artiﬁcial Intelligence 174 2010 951983 955 Fig 1 Examples plane regions simple region b c connected nonsimple regions d e connected regions Fig 2 A bounded connected region b 9tiles b dirb dirb cid3 cid6 cid7 0 0 0 1 1 0 1 1 0 dira b cid6 cid7 0 1 1 0 1 1 0 0 0 dira cid3 b cid6 cid7 0 1 1 0 0 1 0 0 0 Fig 3 Illustrations basic CDC relations We write I xb Let cid4 x b x cid5 b I yb cid4 y b y cid5 b Mb I xb I yb 4 5 We Mb minimum bounding rectangle mbr b I xb I yb x yprojection b respectively Clearly Mb smallest rectangle contains b sides parallel axes By extending edges Mb partition plane tiles denoted N W b Nb N Eb W b O b Eb S W b Sb S Eb Fig 2b Note tile bounded unbounded connected region intersection tiles dimension lower Write TileName N W N N E W O E S W S S E 6 set tile names In remainder paper use variable symbol χ address tile TileName For bounded region b use χ b address tile b Since partition concerns mbr b Proposition 1 For bounded connected regions b c Mb Mc χ b χ c χ TileName In particular χ b χ Mb χ TileName The notion direction relation matrix ﬁrst proposed Goyal Egenhofer 16 representing cardinal direction extended spatial objects 956 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Table 3 Examples valid direction relation matrices M1 M2 invalid direction relation matrix M3 bounded connected regions M1 cid6 cid7 1 1 0 0 1 0 0 0 0 M2 cid7 cid6 1 1 1 1 0 1 1 0 1 M3 cid7 cid6 1 0 1 0 1 1 0 0 1 Fig 4 Iconic representations valid invalid matrices Table 3 Deﬁnition 4 direction relation matrix Suppose b bounded connected regions Take b reference object primary object The direction b encoded 3 3 Boolean matrix cid9 cid8 dN W dN dW d O dS W dS dN E dE dS E dira b dχ 1 χ b cid14 cid10 χ N W N N E W O E S W S S E cid11 7 8 interior Fig 3 We 3 3 Boolean matrix M direction relation matrix valid matrix exist bounded connected regions b M dira b Remark 1 The original description direction relation matrix 1615 lacks formality consider limit cases Formal deﬁnitions model appear 40 3 These models differentiate limit cases Our deﬁnition direction relation matrix accord 40 In Section 62 argue model appropriate given 3 Remark 2 In work 1615 Goyal Egenhofer considered cardinal directions simple regions roughly speaking connected regions holes This convention adopted researchers 40331 In paper interpret spatial objects bounded connected regions holes This assumption arguably pragmatic Moreover Section 72 generalization simple regions connected regions affect consistency cardinal direction constraints In particular valid matrix M exist simple regions b M dira b Goyal Egenhofer identiﬁed altogether 218 valid matrices Proposition 2 See 15 A 3 3 Boolean matrix direction relation matrix nonzero 4connected nonzero entries joined vertical horizontal lines crossing zero entries Table 3 gives examples valid invalid matrices Each valid matrix M uniquely determines direction relation follows δM b b bounded connected regions dira b M cid2 cid3 9 In remainder paper distinction valid matrix M direction relation δM repre sents Write Bdir set cardinal directions represented valid matrices Because ordered pair bounded connected regions determines unique direction relation matrix Bdir JEPD set relations The cardinal direction cal culus CDC deﬁned qualitative calculus generated Bdir set bounded connected regions As usual relation Bdir basic CDC relation For basic CDC relation matrix provides intuitive repre sentation In particular easily transform valid matrix iconic representation basic relation 15 Fig 4 gives iconic representations matrices Table 3 Note grey region icon M3 connected region cf Deﬁnition 3 This explains M3 valid matrix A different notations introduced 40 CDC relations W Liu et al Artiﬁcial Intelligence 174 2010 951983 957 Deﬁnition 5 singletile multitile component A basic CDC relation called singletile matrix nonzero entry called multitile We singletile relation sχ χ TileName component multitile relation dχ χ TileName sχ cid2 dχ tile χ TileName The single tile relations written N W northwest N north N E northeast W west O E east S W southwest S south S E southeast respectively A multitile relation δ written δ1 δ2 δk k cid2 9 δi 1 cid2 cid2 k components δ Take valid relations Fig 4 examples We δM1 N W N O δM2 S W W N W N N E E S E In order relative position connected regions b CDC knowing direction b cid3 direction 15 Fig 3 shows example direction b b cid3 b This drastically different IA b different wellknown qualitative calculi basic relation b uniquely determined b We investigate pairwise consistency problem Section 62 b dirb dirb cid3 dira b cid14 dira cid3 The subsection establishes connection CDC IA 32 Projective IA networks The connection CDC IA established notion projective interval relations Deﬁnition 6 projective interval relation For basic CDC relation δ xprojective interval relation δ deﬁned ιxδ cid2cid10 cid11 b δ I xa I xb cid3 10 I xa I xb xprojective intervals b respectively Although ιxδ called projective interval relation immediately clear ιxδ relation IA The following proposition conﬁrms Proposition 3 Suppose δ basic CDC relation Then xprojective interval relation ιxδ following IA relations p m s d f eq pi mi o ﬁ oi si di 11 Proof See Appendix A cid2 Appendix A gives method computing projective interval relation basic CDC relation Take valid relations Table 3 examples ιxM1 o ﬁ ιxM2 di For pair basic CDC relations δ γ write ιxδ γ ιxδ ιxγ 12 ιxγ converse ιxγ IA The proposition examines kind IA relation ιxδ γ Proposition 4 For pair basic CDC constraints δ γ ιxδ γ IA relation B int B int o s d f eq ﬁ di si oi p m pi mi Proof See Appendix A cid2 13 For example δ singletile relation W γ multitile relation N E E S E ιxδ γ nonbasic IA relation p m The proposition follows immediately Proposition 5 For pair basic CDC relations δ γ b solution v 1δv 2 v 2γ v 1 I xa I xb ιxδ γ Proof From b δ b γ I xa I xb ιxδ I xb I xa ιxγ Therefore I xa I xb ιxδ ιxγ ιxδ γ cid2 This result easily extended CDC constraint networks Proposition 6 A basic CDC constraint network N v iδi j v jn consistent ιx j ιxδi j δ ji j1 consistent IA constraint network v iιx j v jn j1 958 W Liu et al Artiﬁcial Intelligence 174 2010 951983 illus j 12 13 23 δi j cid6 cid6 cid6 cid7 cid7 cid7 0 1 1 0 0 1 0 0 0 1 1 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 δ ji cid6 cid6 cid6 cid7 cid7 cid7 0 0 0 1 1 0 1 1 0 0 0 0 0 0 1 0 1 1 0 0 1 0 0 1 0 0 1 Fig 5 A basic CDC network projective IA basic networks ρ x j oi o p ρ y j oi oi d Proof Suppose ain know I xai I xa j instance ιx i1 solution N Then I xain j pair j cid2 i1 solution v iιx j v jn j1 This Proposition 5 Similar notions results apply ydirection The consistency IA network appearing Proposition 6 reduced consistency basic IA network Deﬁnition 7 projective IA networks Let N v iδi j v jn j1 basic CDC network For j deﬁne ρ x j ρ y j ιx j ι y j m mi m mi ιxδi j δ ji ι y ιx j j networks N respectively ι yδi j δ ji We Nx v iρ x j v jn j1 N y v iρ y j v jn j1 x yprojective IA 14 15 The following result shows IA networks v iιx j v jn j1 v iι y j v jn j1 consistent iff Nx N y consis tent Proposition 7 An IA network N v iιi j v jn cid12ιi j ιi j m mi j1 B int Eq 13 consistent iff cid12N v icid12ιi j v jn j1 satisﬁable Proof We ﬁrst observe cid12N reﬁnement N Therefore cid12N consistent N consistent On hand suppose I u i1 meet point exist cid14 j n j Ii meets I j We prove cid12N solution induction number K meet points u Details omitted cid2 i1 solution N We point u M u n u u u As corollary Propositions 6 7 know Theorem 2 A basic CDC network constraints N v iδi j v jn N y v iρ y j1 consistent j v jn j1 consistent projective IA networks Nx v iρ x j v jn j1 The theorem establishes necessary condition consistency basic CDC network Example 1 Fig 5 speciﬁes basic CDC network N v iδi j v j3 N y v iρ y j1 For pair cid14 j solution v iδi j v j v jδ ji v illustrated j v j3 j1 gives projective IA networks Nx v iρ x j v j3 j1 In section prove consistent CDC network N solution ain I yain i1 solutions projective IA networks Nx N y respectively i1 I xain i1 W Liu et al Artiﬁcial Intelligence 174 2010 951983 959 Fig 6 A pixel p 4neighbors pixels mark c digital region 4 Canonical solution Suppose N v iδi j v jn j1 consistent basic CDC network We N canonical solution sense similar IA networks Deﬁnition 8 pixel digital region digital solution A pixel rectangle pi j 1 j j 1 j integers A region digital composed pixels pi j i1 basic CDC network digital ai digital region cid14 iff pi j A solution ain Fig 6 illustrates pixel p digital region Deﬁnition 9 canonical solution Let N consistent basic CDC network let Nx N y x yprojective IA networks N cf Deﬁnition 7 respectively A solution ain i1 N said canonical digital solution I xain i1 canonical solutions Nx N y respectively i1 I yain In section consistent CDC network canonical solution To end ﬁrst introduce notions properties digital regions Deﬁnition 10 4neighbors 4connected connected component The 4neighbors pixel pi j pi1 j pi1 j pi j1 pi j1 Two pixels p q said 4connected digital region exists series k 1 pixels p p0 p1 pk1 pk q ps 4neighbor ps1 1 cid2 s cid2 k We digital region 4connected pixels contained 4connected For digital regions c c connected component c 4connected subset 4connected subset c cid3 c c c contains pixel c cid3 cid3 For example 4neighbors p Fig 6 pixels mark c The digital region composed pixels mark 4connected 4connected components The following proposition shows 4connectedness equivalent connectedness far digital regions cerned Proposition 8 A bounded digital region connected region iff 4connected Proof Recall require connected region connected interior This proved induction number pixels contained digital region Details omitted cid2 41 Regular solution Suppose ain i1 set n bounded connected regions We regularized changing CDC relations regions y Write x x y α0 α1 αnx Mai mbr ai Suppose 1 cid2 cid2 n ordering real numbers x x β0 β1 βn y 17 ordering real numbers y 1 cid2 cid2 n 1 cid2 cid2 n nx 1 n y 1 cardinalities x x 1 cid2 cid2 n respectively Extending edges rectangle Mai meeting boundary rectangle y y α0 αnx cells We cells compose solution β0 βn y N partition α0 αnx β0 βn y y 16 960 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Deﬁnition 11 frame cell set regularization Suppose ain i1 set bounded connected regions Denote Fig 7 Illustration regularization β0 βn y Sa α0 αnx ci j αi αi1 β j β j1 Ca ci j 0 cid2 nx 0 cid2 j n y ar ar c Ca c cid3 n i1 cid2 ar cid13cid2 cid14 cid3 0 cid2 nx 0 cid2 j n y 1 n 18 19 20 21 22 We Sa frame ci j cell Ca cell set ar regularization Fig 7 Proposition 9 For set connected regions ain Ca Car ar ar n i1 regularization i1 ai ar Mai Mar Sa Sar Proof Straightforward cid2 The regularization solution Proposition 10 Suppose ain i1 solution basic CDC network N Then ar ar i1 solution N n connected For pair j dirai j dirar j suﬃces χ ar j Ma j know Proposition 1 j Because Mar χ j ai ar χ j If ar χ j iff ar j χ j χ Therefore need χ j cid14 There exists cell cst χ j cst ar χ j On hand suppose ar Proof It clear ar tile χ χ ar know This possible iff cst nonempty Therefore know χ j iff ar χ j cid14 cid2 ar Deﬁnition 12 regular solution A solution ain n regularization ar ar i1 i1 basic CDC network N called regular The regularization solution regular ar r ar 1 cid2 r cid2 n This ar frame cell set Example 1 continued Fig 7 illustrates transform solution a1 a2 a3 Fig 7a constraint network spec iﬁed Fig 5 regular solution ar Fig 7d The frame cell set illustrated Fig 7b c respectively 1 ar 2 ar 3 The following proposition asserts canonical solutions Deﬁnition 9 regular solutions Proposition 11 Let N basic CDC network Suppose ain i1 canonical solution N Then regular solution N Proof Construct frame cell set Deﬁnition 11 By Deﬁnition 9 know I xain i1 canonical solutions Nx N y It easy αi β j j 0 cid2 cid2 nx 0 cid2 j cid2 n y Moreover cell ci j exactly pixel pi j 1 j j 1 Because ai digital region clear pst 1 cid2 cid2 n Therefore regular solution N cid2 nonempty iff pst ai This implies ai ar i1 I yain cst W Liu et al Artiﬁcial Intelligence 174 2010 951983 961 42 Meetfree solution Fig 8 Illustration meetfreeing i1 regular solution basic CDC network N v iδi j v jn m mi possible I xain j v jn Suppose ain solution v iιx Take basic CDC network N described Fig 5 example Fig 7d gives regular solution ar I xar introduce notion meetfree solution i1 canonical solution N To transform ar 3 j1 By Proposition 6 know I xain i1 solution Nx v iρ x i1 j1 i1 N Since I xar 3 2 i1 canonical solution N 3 3 meet x α2 ar j1 Because ρ x j v jn ιx j j Deﬁnition 13 meetfree solution A solution ain I yai meet I ya j i1 N meetfree j I xai meet I xa j i1 solution N ar ar Suppose ain Ma j x y x y x j x j 1 cid2 cid2 n We αk x x xmeet point cf Fig 8a Clearly k 0 x cid2 αk1 x x meet x direction x αk αk1 cid2 x j x j y j y j i1 regularization cf Fig 7a d Suppose Mai n j Recall α0 αnx ordering x Write α αk αk12 The line x α We delete meet point transforming ar regular solution Fig 8 illustrates process divides cell ckl 0 cid2 l n y equal parts written order c kl kl For 1 cid2 s cid2 n 0 cid2 l n y ckl ar kl ar c s cf Fig 8a The remaining s1 regular solution N n ar s Such modiﬁcation introduces new meet points Continuing process n times solution xmeet points The procedures applied ymeet points In way obtain meetfree solution s connected straightforward s ck1l cid14 ar s written s delete c The meetfree solution frame different cell set Proposition 12 Each consistent basic CDC network regular solution meetfree Proof See Appendix B cid2 The step transform regions appearing regular meetfree solution digital regions 43 Canonical solution Suppose asn s1 regular meetfree solution N As Section 41 write Mai x x Ca ci j 0 cid2 nx 0 cid2 j n y frame cell set respectively Since y y β0 βn y Sa α0 αnx regular ai composed subset cells Ca s1 digital solution We transform asn 0 nx 0 n y s n s1 s digital region contained Sa A pixel pi j contained s iff cell ci j Ca contained That s cid13 pi j ci j 0 cid2 nx 0 cid2 j n y 23 s Clearly connected digital region Fig 9 illustrates process The following lemma shows solution N 962 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Fig 9 Transform regular solution digital b Lemma 1 Suppose asn regular meetfree solution N s1 regular meetfree solution basic CDC network N Then s n s1 constructed Proof It clear Sa 0 nx 0 n y Ca pst 0 cid2 s nx 0 cid2 t n y pst contained Therefore I xa implies nonempty iff pst r s1 s2 iff I xai αs1 αs2 Hence j iff I xai meets I xa j Similar conclusion holds ydirection Since meetfree meets I xa regular It easy I xa meetfree For j tile χ Eq 23 know pixel pst contained tile χ cell cst contained χ j Therefore pixel pst contained dirai j dira j j Therefore assignment s j iff corresponding j iff cst contained ai χ j By deﬁnition χ s1 solution N cid2 n The following lemma proves canonical solution Lemma 2 Suppose asn canonical solutions projective IA networks Nx N y respectively s1 regular meetfree solution basic CDC network N Then I xa s n s n digital region deﬁned Eq 23 s1 I ya s s1 I xa Proof Take xdirection example Because i1 solution N know Proposition 5 n Since j instance ιxδi j ιxδ ji j j This meetfree I xa I xa implies l I xa j v jn j deﬁned Eq 14 By choice αi Eq 16 easily El set endpoints intervals l equals 0 nx Z By Deﬁnition 1 l canonical set intervals Therefore canonical solution Nx cid2 i1 solution basic IA network Nx v iρ x meet I xa j1 ρ x n As corollary Lemmas 1 2 know canonical solution N Theorem 3 Each consistent basic CDC network canonical solution In subsection construct canonical solution directly 44 Maximal canonical solution Suppose N v iδi j v jn j1 consistent basic CDC network By Theorem 2 know projective IA networks Nx N y consistent Lemma 3 Let N v iδi j v jn Nx N y respectively Let mi I J If ain 1 cid2 cid2 n j1 consistent basic CDC network Suppose I i1 canonical interval solutions i1 canonical solution N ai Mai mi i1 J Proof By Deﬁnition 9 know I xai I I yai J Therefore ai Mai I J mi cid2 For constraint δi j N assume dN j d O j dS j dN W j dW j dS W j dN E j dE j dS E j δi j 24 W Liu et al Artiﬁcial Intelligence 174 2010 951983 963 Fig 10 Illustration disconnected bi χ j 0 1 tile χ TileName Suppose ain i1 canonical solution N By Lemma 3 know d Ma j m j j As consequence Proposition 1 know χ j χ Ma j χ m j χ TileName χ m j ai j δi j This means ai contain pixels Moreover d contained χ m j In words d 0 pixels contained χ m j disallowed ai 0 χ j χ j Lemma 4 Let N mi Lemma 3 For deﬁne cid13cid2 cid4 pst mi jχ d χ j bi 0 pst cid14 χ m j cid5cid3 Suppose ain i1 canonical solution N Then ai bi Note write cid2 D pst mi j χ pst χ m j d cid3 0 χ j 25 26 D set pixels mi appear instantiation v canonical solution result violating constraint N It easy cid13 bi pst mi pst cid14 D 27 The following example shows bi connected region Example 2 Let N v 1W O Ev 2 v 2N O Sv 1 v 1 O v 3 v 3N N E E S E Sv 1 v 2 O v 3 v 3W N W N N E Ev 2 By computing canonical solutions Nx N y m1 0 3 1 2 m2 1 2 0 3 m3 0 4 0 4 By excluding impossible pixels mi obtain digital regions b1 b2 b3 shown Fig 10a Note b1 m1 b2 m2 connected However b3 connected components consists pixel p00 obtained excluding p00 b3 Write c3 component It clear Mc3 m3 Let c1 b1 c2 b2 The assignment c1 c2 c3 clearly satisﬁes constraints N In following N consistent digital region bi deﬁned Eq 25 unique connected component cf Deﬁnition 10 ci Mci Mbi mi We ﬁrst note connected subregion bi contained unique connected component bi This different components bi common interior points Lemma 5 Let N mi Lemma 3 let bi Eq 25 Suppose ain connected component bi contains ai Then Mci mi i1 canonical solution N Let ci Proof Because ai ci bi mi Mai mi know Mci mi cid2 The lemma shows N consistent bi connected component ci Mci Mbi mi Is component unique The answer yes This connected digital regions mbr share pixel common Lemma 6 Let b connected digital regions If b Ma cid14 Mb 964 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Fig 11 Canonical interval solutions maximal canonical solution b Proof Without loss generality suppose Ma 0 n1 0 n2 n1 n2 positive integers Suppose Ma Mb Since Ma 0 n1 0 n2 contains pixel p0s pixel pn11t integers 0 cid2 s t n2 Because connected digital region path π sequence 4connected pixels connects p0s pn11t cf Proposition 8 Clearly π separates Ma disjoint components contained b contained component Therefore Mb smaller rectangle smaller Ma Since Ma A contradiction cid2 b b We note property hold general connected regions Let m 0 1 0 1 The diagonal m separates m triangles a1 a2 Clearly a1 a2 common interior point mbr As corollary Lemma 6 Lemma 7 Let b digital region There exists connected component written c Mc Mb By Lemma 6 know Mc1 cid14 Proof Suppose c1 c2 different connected components b Clearly c Mc2 This means different components mbr In particular exists connected component mbr b cid2 c 1 2 If N consistent Lemma 5 know unique component bi exist In fact suppose ain i1 arbitrary canonical solution N Then connected component ci bi contains ai unique component bi Mci Mbi The following lemma shows cin i1 solution N Lemma 8 Let N mi Lemma 3 let bi Eq 25 Assume ci unique connected component bi Mci mi Then cin i1 canonical solution N i1 solution N need prove dirci c j δi j pair j By Proposition 1 Proof To prove cin Mc j m j know χ c j χ m j tile χ TileName To dirci c j δi j need prove c 0 χ TileName i1 arbitrary canonical solution N By Lemma 5 know ai ci If c χ m j 0 On hand χ m j Because ai j instance δi j implies d χ m j cid14 ci bi know bi χ m j common pixel pst By deﬁnition bi cf Eq 25 χ m j iff d Suppose ain χ j χ j ai ci know c know d cid14 0 χ j This shows cin i1 solution N Since ci connected digital region cin By Mci mi know I xci I I yci J I solutions Nx N y respectively This implies cin i1 J i1 digital solution N i1 Lemma 3 canonical i1 canonical solution N Deﬁnition 9 cid2 Actually maximal canonical solution N Theorem 4 Suppose N v iδi j v jn Eq 25 Mci mi Then cin j1 consistent basic CDC network Let ci unique connected component bi cf i1 maximal canonical solution N Proof This canonical solution ain i1 Lemma 5 know ai ci cid2 An example given Fig 11a illustrate procedures W Liu et al Artiﬁcial Intelligence 174 2010 951983 965 Fig 12 Flowchart main algorithm Example 1 continued For network speciﬁed Fig 5 3 3 x 2 x 1 x 2 x 1 x x 1 3 y 2 y 1 y 2 y 3 y y 28 29 The canonical interval solutions Nx N y illustrated Fig 11a Note d O 12 cf Eq 32 0 This excludes pixel p12 O m2 m2 m1 Fig 11a Note bi obtained example happens connected Fig 11b The maximal canonical solution N b1 b2 b3 So far shown N consistent maximal canonical solution cin i1 constructed follows Construct canonical solutions I i1 J Exclude impossible pixels mi I J obtain digital region bi mi cf Eq 25 Find unique connected component ci bi Mci mi i1 projective interval networks Nx N y What consistency N unknown The example suggests use procedures determine consistency N Example 2 continued Suppose constraint v 2N O Sv 1 replaced v 2O Sv 1 See Fig 10b illustration b1 b2 b3 case Note c3 c2 fail satisfy constraint v 3W N W N N E Ev 2 By Theorem 4 know revised network consistent 5 A consistency checking algorithm In section algorithm checking consistency basic CDC networks Suppose N v iδi j v jn j1 basic CDC network Recall assume N complete basic constraint δi j assigned pair variables v v j To examine consistency N ﬁrst compute projective IA networks Nx N y If inconsistent N inconsistent Assume Nx N y consistent We compute canonical interval solutions I i1 construct rectangle mi I J We continue compute digital region bi according Eq 25 determine bi component ci Mci mi If component exist N inconsistent Otherwise check cin i1 maximal canonical solution If answer N inconsistent i1 solution N If answer yes N consistent cin i1 J Fig 12 gives ﬂowchart algorithm 51 An O n4 consistency checking algorithm In section detailed description consistency checking algorithm analyze computational complexity 966 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Fig 13 A digital region Boolean matrix Ba b Step 1 Projective IA networks For pair basic CDC constraints xiδi j x j x jδ ji xi x yprojective IA relations ρ x j Eqs 14 15 computed constant time A method described Appendix A So projective IA networks Nx N y constructed O n2 time Appendix A Proposition 24 If Nx N y inconsistent checked cubic time pathconsistency algorithm 145 N inconsistent j ρ y Example 1 continued For basic CDC network speciﬁed Fig 5 Nx v 1oiv 2 v 2ov 1 v 1ov 3 v 3oiv 1 v 2pv 3 v 3piv 2 N y v 1oiv 2 v 2ov 1 v 1oiv 3 v 3ov 1 v 2dv 3 v 3div 2 It straightforward prove Nx N y pathconsistent Suppose Nx N y consistent Their canonical solutions I i1 J i1 constructed cubic time Step 2 Canonical interval solutions Algorithm 1 Algorithm 1 The canonical solution basic IA network Input A basic consistent IA network N v iρi j v j n Output The unique canonical solution N j1 V x x p q V n i1 Calculate Orderp q constraints N Table 2 sort V Order ascending k 0 p smallest element V rp k p greatest element V q element p V Orderq p k k 1 p q rp k rx Output rx n i1 Write I x x J y y gers 0 2n 1 Write nx maxx mi x x Clearly mi T y y By deﬁnition canonical interval solution know x inte i1 Let T 0 nx 0 n y frame deﬁne n i1 n y max y n y x y Example 1 continued For basic CDC network speciﬁed Fig 5 canonical solutions Nx N y Fig 11a I1 1 4 I2 0 2 I3 3 5 J 1 2 5 J 2 1 3 J 3 0 4 respectively Moreover frame T 0 5 0 5 m1 1 4 2 5 m2 0 2 1 3 m3 3 5 0 4 In remainder paper represent digital region T nx n y Boolean matrix Ba follows cid18 Bak l pkl 1 0 30 Example 3 Fig 13a illustrates digital region contained T 0 5 0 5 Fig 13b shows Boolean matrix Ba represents W Liu et al Artiﬁcial Intelligence 174 2010 951983 967 Table 4 Excluding impossible pixels m1 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1 1 0 0 0 0 0 0 0 0 BT O m2 0 0 0 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 BT W m3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 BT Sm2 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 Bm1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 BT S Em2 0 1 1 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 Bb1 Note address elements Ba lower left corner right corner In particular lower left corner Ba Fig 13a addressed 0 0element Ba0 0 This accord orderings endpoints canonical interval solutions Step 3 Excluding impossible pixels As Eq 25 write cid13cid2 bi cid4 pst mi jχ d 0 pst cid14 χ m j cid5cid3 χ j This means pixel pst mi contained digital region bi iff pst contained tile χ m j d To compute bi intuitive method checking pixel p mi p contained bi Proposition 13 For pixel p contained mi needs O n time determine p bi 31 χ j 0 0 Proof To determine p bi deﬁnition need check p contained χ m j Note needs constant time decide pixel contained tile Since O n different tiles χ m j needs O n time determine p contained bi cid2 j χ d χ j Note O n2 pixels contained mi As consequence needs O n3 time compute bi Therefore need O n4 time compute bi Algorithm 2 Algorithm 2 Excluding Impossible Pixels Input A basic CDC network N v δi j v j n Output A set nx n y Boolean matrices B n i1 1 cid2 cid2 n j1 canonical set rectangles mi n i1 frame T 0 nx 0 n y pixel p s s 1 t t 1 T p mi B s t 1 B s t 0 1 cid2 j cid2 n j cid14 χ TileName 0 δχ B s t 0 Output B n i1 j pixel p s s 1 t t 1 contained mi χ m j Example 1 continued For basic CDC network speciﬁed Fig 5 b1 digital region obtained excluding pixels p12 p22 p13 p23 m1 1 42 5 b2 exactly m2 0 21 3 b3 digital region obtained excluding pixels p32 p33 m3 3 5 0 4 Fig 11b Take b1 example Recall T 0 5 0 5 There different χ m j T χ m j degenerate 0 viz T O m2 0 2 1 3 T Sm2 0 2 0 1 T S Em2 2 5 0 1 T W m3 rectangle d 0 3 0 4 Fig 11a Table 4 illustrates process computing Bb1 The digital region b1 computed Eq 30 shown Fig 11 Note b1 connected χ 1 j In Section 52 step improved O n3 Step 4 Connected components We compute connected components bi Applying general BreadthFirst Search algorithm ﬁnd connected components bi determine mbrs mi O n2 time Algorithm 3 optimised 968 W Liu et al Artiﬁcial Intelligence 174 2010 951983 algorithm tries ﬁnd desired connected component For pixel p mi left right p contained bi algorithm ﬁnds connected component bi contains p If component mbr mi algorithm returns component ci stops goes pixel mi Algorithm 3 Calculating Connected Component Input The nx n y Boolean matrix B digital region b rectangle m x Output If b connected component mbr m return Boolean matrix C return false y y x x Br y cid2 r x 1 CurrentComponent Visiting r y MaxY y Visiting Min X r Max X r let s t element Visiting CurrentComponent CurrentComponent s t Visiting Visiting s t Bs t 0 Min X minMin X s Max X maxMax X s MaxY maxMaxY t cid3 t s cid3 1 cid3 t Bs Visiting Visiting s Max X x Min X x s t CurrentComponent cid3 1 MaxY y cid3 t 1 cid3 s 1 t s 1 t s t 1 s t 1 Cs t 1 Output C Output false Note bi component mbr mi Lemma 7 If component exists N inconsistent Otherwise let ci unique connected component bi Mci mi Clearly step needs O n3 time Example 1 continued For basic CDC network speciﬁed Fig 5 b1 b2 b3 happen connected Fig 11b This means ci bi 1 2 3 i1 solution N Note answer yes cin i1 maximal canonical For pair ci c j check dirci c j δi j Write Step 5 Checking possible solution The step checking cin solution N Theorem 4 δi j dN W j dW j dS W j dN j d O j dS j dN E j dE j dS E j We need check χ TileName following equation holds χ j d 0 c χ m j Because ci m j digital regions c χ m j Therefore need check χ TileName following equation holds χ m j nonempty iff exists pixel p contained ci χ j d 1 ci χ m j contains pixel 34 Recall ci connected component bi Mci Mbi mi When d 0 deﬁnition bi know pixel contained bi χ m j This means ci χ m j contains pixel The condition Eq 34 holds 1 Note rectangle mi computed Step 2 tile χ m j On hand suppose d computed m j constant time Whether mi χ m j contains pixel checked constant time This mi χ m j possibly degenerate rectangle If mi χ m j contains pixel degenerate rectangle ci χ m j contains pixel Suppose mi χ m j nondegenerate rectangle The proposition shows determine ci χ m j contains pixel O n time χ j χ j Proposition 14 Let mi ci constructed Step 2 Step 4 respectively Let χ tile Suppose d nondegenerate rectangle Then ci χ m j contains pixel checked O n time χ j 1 mi χ m j 32 33 W Liu et al Artiﬁcial Intelligence 174 2010 951983 969 We need check pixel p mi χ m j p ci Instead Proof Write mi χ m j x need check boundary pixels mi χ m j pixel rectangle called boundary pixel 4neighbor contained rectangle Formally boundary pixels mi χ m j form pkl k l H1 H2 y y x cid2 cid2 H1 H2 cid2 cid3 k l k k l x 1 x x cid2 k x y cid2 l y cid3 cid3cid3 cid2 l y 1 y We justify statement follows If mi χ m j mi Mci mi know exists boundary pixel contained ci Otherwise mi χ m j rectangle strictly contained mi Because Mci mi implies ci contains pixel p mi χ m j If ci contains boundary pixel mi χ m j ci connected digital region contains pixel mi χ m j Since H1 H2 contains O n pixels checking pixel contained ci needs constant time dirci c j δi j checked O n time cid2 Therefore determine O n time dirci c j δi j pair j As consequence cin solution N checked cubic time This means Step 5 carried cubic time i1 Example 1 continued For basic CDC network speciﬁed Fig 5 know b1 c1 b2 c2 Fig 11b To dirb1 b2 δ12 need check b1 χ m2 common pixels χ d 1 χ N N E E Since pixels p14 p24 p32 contained Nm2 N Em2 Em2 respectively We know b1 b2 instance δ12 χ 12 The example shows applying main algorithm consistent complete basic CDC network construct maximal canonical solution In Section 61 example Example 4 illustrates main algorithm deals inconsistent CDC networks Recall Step 3 needs O n4 time algorithm determines consistency complete basic CDC network O n4 time 52 A cubic improvement In subsection improve main algorithm cubic This achieved O n2 improvement computing bi Eq 31 Step 3 As consequence bi computed cubic time For recall bi deﬁned cf Eq 31 cid13cid2 cid4 pst mi jχ d χ j bi 0 pst cid14 χ m j cid5cid3 35 The Boolean matrix Bbi Eq 30 bi computed follows BT χ m j zero matrix T χ mi degenerate rectangle Proposition 15 For 0 cid2 k nx 0 cid2 l n y cid18 Bbik l Bmik l 1 Q ik l 0 1 0 cid25cid2 cid10 cid11 T χ m j B d χ j Q 0 j cid14 cid3 36 37 Proof We ﬁrst note pixel pkl T contained digital region T iff Bak l 1 Suppose Bmik l 1 Q ik l 0 The ﬁrst equation implies pkl pixel contained mi The equivalent saying BT χ m jk l 0 j cid14 χ d contained χ m j By deﬁnition bi implies pkl bi Hence Bbik l 1 0 This means j cid14 χ d 0 pkl Otherwise suppose Bmik l 0 Q ik l 0 We Bbik l 0 Note bi mi know Bbik l 0 Bmik l 0 Suppose Bmik l 1 Q ik l 0 By deﬁnition Q know BT χ m jk l 1 0 This implies pkl contained χ m j Note pkl contained mi j χ j cid14 d Bmik l 1 By deﬁnition bi know pkl contained bi Hence Bbik l 0 cid2 χ j χ j χ j By proposition know Bbi computed Bmi Q O n2 time We compute Q O n2 time We note Q Boolean matrix Some entries integers larger 1 To end introduce following operations matrices 970 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Table 5 A matrix N difference matrix diffN b accdiffN cumulative matrix diffN c 0 0 0 0 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 0 1 0 0 1 0 1 0 0 1 0 0 0 0 0 b 0 0 0 0 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 0 0 0 0 c Deﬁnition 14 cumulative matrix difference matrix For matrix N deﬁne cumulative matrix accNk l kcid25 t0 Nt l difference matrix cid18 diffNk l Nk l Nk l Nk 1 l k 0 38 39 The cumulative matrix accN computed column column We add ﬁrst column second add updated second column Table 5 example In way cumulative matrix accN computed linearly number elements N It easy verify N accdiffN diffaccN difference operation additive diffN1 N2 diffN1 diffN2 Therefore cid10 cid11 Q acc diffQ cid26 acc cid26cid25cid2 diff cid26cid25cid2 B cid10 cid10 diff B acc cid10 cid11 T χ m j d cid11cid11 T χ m j χ j 0 j cid14 d χ j 0 j cid14 cid3cid27cid27 cid3cid27 Note digital region T χ m j actually possibly degenerate rectangle The following proposition uses property number nonzero elements diffBT χ m j order O n Proposition 16 The number nonzero elements diffBT χ m j fewer 4n Proof If BT χ m j zero matrix diffBT χ m j zero matrix Otherwise nonzero elements BT χ m j compose rectangle cf Table 5 exist 0 cid2 x1 cid2 x2 nx 0 cid2 y1 cid2 y2 n y st cid10 cid11 T χ m j B k l cid18 x1 cid2 k cid2 x2 y1 cid2 l cid2 y2 1 0 It easy prove cid10 cid10 diff B cid11cid11 T χ m j k l 1 1 0 k x1 y1 cid2 l cid2 y2 k x2 1 y1 cid2 l cid2 y2 So x2 nx 1 y2 y1 1 1s 1s diffBT χ m j x2 nx 1 y2 y1 1 1s 1s elements zeros So 2 y2 y1 1 cid2 2 n y 4n nonzero elements diffBT χ m j cid2 As consequence know sum difference matrices computed O n2 time Proposition 17 The matrices Q Bbi computed O n2 time Proof By Proposition 16 know difference matrix BT χ m j 4n nonzero entries To compute Q need add matrices Note 9n different BT χ m j We add matrices W Liu et al Artiﬁcial Intelligence 174 2010 951983 971 Table 6 Excluding impossible pixels m1 An eﬃcient method 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 1 1 0 0 0 0 0 0 0 0 BT O m2 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 1 0 1 0 0 0 0 0 0 0 diffBT O m2 0 0 0 0 0 0 1 0 1 0 2 0 1 1 0 2 0 1 1 0 0 1 0 2 0 BΣ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 BT Sm2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 diffBT Sm2 0 0 0 0 0 1 1 1 0 0 2 2 1 0 0 2 2 1 0 0 2 2 2 1 1 Q 1 accBΣ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 BT S Em2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 diffBT S Em2 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 Bm1 0 0 0 0 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 1 1 1 0 0 BT W m3 0 0 0 0 1 0 0 1 0 1 0 0 1 0 1 0 0 1 0 1 0 0 1 0 diffBT W m3 0 1 1 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 Bb1 Each time need change values 4n entries This means Q computed O n2 time By Proposition 15 matrix Bbi computed O n2 time given know Bmi Q cid2 By Eq 30 know bi computed O n2 time cf Algorithm 4 In way improve Step 3 O n4 cubic time Algorithm 4 Excluding Impossible Pixels improved Input A basic CDC network N v δi j v j n Output A set nx n y Boolean matrices B n i1 1 cid2 cid2 n j1 set rectangles mi n i1 frame T 0 nx 0 n y let BΣ nx n y matrix initialized zero 1 cid2 j cid2 n j cid14 χ TileName δχ 0 mi χ m j contains pixel j suppose mi χ m j rectangle s1 s2 t1 t2 t1 cid2 k t2 BΣ s1 k BΣ s1 k 1 BΣ s2 k BΣ s2 k 1 Q accBΣ pixel p s s 1 t t 1 contained T p contained mi Q s t 0 B s t 1 Output B n B s t 0 i1 Example 1 continued In running example m1 1 42 5 different χ m j BT χ m j 0 viz T O m2 0 2 1 3 T Sm2 0 2 0 1 T S Em2 2 5 0 1 zero matrix d T W m3 0 3 0 4 Fig 11a Write BΣ sum diffBT χ m j Its cumulative matrix Q 1 accBΣ By Eq 36 know Bb1k l 1 iff Bm1k l 1 Q 1k l 0 Table 6 illustrates process computing Bb1 This compared Table 4 χ 1 j 53 Beyond complete basic networks CDC constraints In subsections shown consistency complete basic network CDC constraints determined cubic time Using backtracking method immediately know consistency satisfaction problem CDC NP problem Lemma 9 The consistency satisfaction problem CDC NP problem Proof Let C v ici j v jn constraint ci j cubic algorithm solve basic network CDC constraints cid2 j1 set CDC constraints To determine C consistent need branch nonbasic This problem NPhard 972 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Lemma 10 The consistency satisfaction problem CDC NPhard Proof We prove reducing known NPhard problem consistency satisfaction problem CDC Let A JEPD set IA relations p m pi mi o s d f eq ﬁ si di oi It proved reasoning A NPhard Actually NPhardness A guaranteed work Krokhin Jeavons Jonsson 21 We need A contained eighteen maximal tractable subclasses IA 21 Table III The veriﬁcation straightforward omitted Reasoning IA relations A easily reduced reasoning CDC For set IA constraints N v iλi j v jn j1 λi j A easy N satisﬁable iff set CDC constraints N v iϕi j v jn j1 consistent ϕi j disjunction basic CDC relations W E λi j p m pi mi disjunction basic CDC relations O W O O E W O E This shows reasoning CDC hard reasoning A Therefore reasoning CDC NPhard cid2 As corollary know Theorem 5 Reasoning CDC NPcomplete problem A similar conclusion obtained CDCd concerning possibly disconnected regions 41 authors use reduction 3SAT problem There direct connection NPhardness reasoning CDCd NPhardness reasoning CDC 6 Local consistency As mentioned Section 22 pathconsistency suﬃcient decide consistency basic IA network In qualitative spatial temporal reasoning wellknown usual deﬁnition pathconsistency based compo sition strong Several authors suggest notion weak composition deﬁne pathconsistency cf 3623 It proved revised pathconsistency suﬃcient decide consistency basic RCC8 networks cf 3237 23 For CDC situation complicated This unlike IA RCC8 CDC basic relations closed converse Fig 3 A adaption necessary Deﬁnition 15 kconsistency Let D nonempty domain let cid8Bcid9 qualitative calculus D A basic network N cid8Bcid9 said kconsistent iff subnetwork N involving kvariables consistent A basic network said pathconsistent 3consistent This deﬁnition kconsistency different classical introduced Freuder 1213 useful research qualitative spatial temporal reasoning typically uses ﬁnite JEPD set relations inﬁnite domain In section ﬁrst ﬁxed k 0 exists kconsistent basic CDC network inconsistent Then main algorithm solve special local consistency problems 61 Local consistency insuﬃcient Skiadopoulos Koubarakis 40 Example 9 showed pathconsistent inconsistent basic CDC network The following example shows 4consistent basic CDC network inconsistent Example 4 Let a1 a2 a3 a4 squares illustrated Fig 14 Consider basic CDC network N v iδi j v j5 j1 δi j dirai j 1 cid2 j cid2 4 δi5 O 1 cid2 cid2 4 δ51 N N E E δ52 δ53 W N W N N E E δ54 W N W N W Liu et al Artiﬁcial Intelligence 174 2010 951983 973 Fig 14 A solution subnetwork v 1 v 2 v 3 v 4 N Example 4 Fig 15 Solutions subnetworks N Example 4 involve variables Table 7 The projective IA networks Example 4 Fig 16 Illustrations mi bi b Example 4 j ρ x j ρ y j 1 2 1 3 1 4 1 5 2 3 2 4 2 5 3 4 3 5 4 5 o s p s p eq s s o eq p si d s o si d s f s Fig 17 A conﬁguration k squares Figs 14 15 provide solutions subnetwork N involves variables Therefore N 4consistent We apply main algorithm determine consistency N Step 1 computes projective IA networks Nx v iρ x j v jn Applying pathconsistency algorithm know Nx N y consistent Using algorithm Step 2 j1 N y v iρ y j1 Table 7 j v jn canonical solutions I i5 i1 J i5 i1 Nx N y respectively I1 0 2 J 1 0 1 I2 1 4 J 2 0 2 I3 2 6 J 3 0 2 I4 5 7 I5 0 7 J 4 0 1 J 5 0 3 The rectangles mi I J 1 cid2 cid2 5 illustrated Fig 16a By deﬁnition bi know pixels excluded 1 cid2 cid2 4 This means bi mi 1 cid2 cid2 4 For 0 Similarly pixels O m2 O m3 O m4 b5 pixels O m1 viz p00 p01 disallowed d O 51 excluded Fig 16b illustrates resulted digital regions Because Mb5 0 7 1 3 cid14 m5 network inconsistent according main algorithm In fact positive integer k exists kconsistent inconsistent basic CDC network involving k 1 variables Fig 17 illustrates network k instead squares This shows kconsistency insuﬃcient deciding consistency basic CDC networks Remark 3 Navarrete et al 31 proposed O n4 algorithm REGBCON checking consistency basic CDC network It proved 4consistent basic CDC network N pass algorithm REGBCON This 974 W Liu et al Artiﬁcial Intelligence 174 2010 951983 NTB examination given involves variables Example 4 shows REGBCON correct Moreover Hellys Topological Theorem 31 unjustiﬁed wrong Our main algorithm applied solve special local consistency problems pairwise consistency problem weak composition problem 62 The pairwise consistency problem Given know relation b b Mathematically speaking converse problem The relation b converse b vice versa Suppose B set JEPD relations D The qualitative calculus cid8Bcid9 necessarily closed converse This means α relation cid8Bcid9 despite α cid8Bcid9 As CDC shown Fig 3 basic CDC relation converses basic relations α β α converse β CDC v 1α v 2 v 2β v 1 consistent The pairwise consistency problem CDC problem deciding v 1δ12 v 2 v 2δ21 v 1 satisﬁable pair basic CDC relations δ12 δ21 This problem discussed Cicerone di Felice 3 12 ρ y We apply main algorithm solve pairwise consistency problem The ﬁrst step computes ρ x 12 Eqs 14 15 If ρ x 12 program stops returns inconsistent Otherwise Step 2 12 respectively Let mi I J 1 2 Write We construct canonical solutions I1 I2 J 1 J 2 ρ x Clearly 1 cid2 nx n y cid2 3 Let T 0 nx 0 n y n y max y I x x 2 Then T 0 3 0 3 Continuing described main algorithm determine v 1δ12 v 2 v 2δ21 v 1 consistent ﬁnd maximal canonical solution consistent Denote nx maxx 1 x 2 12 ρ y 1 y J y y 12 ρ y A specialized algorithm implemented2 We obtain total 757 consistent pairs basic CDC relations Among consistent pairs δ δcid3 δ correspond multiple δcid3 δ multiple converses In fact 218 basic CDC relations 119 unique converse 68 converses 6 converses 20 converses 4 thirty converses viz singletile relation O 198 converses Our result unexpectedly different 3 Cicerone di Felice obtained 2004 consistent pairs basic CDC relations A careful examination shows similar different model 3 When deﬁning direction relation matrix dira b dχ χ TileName b Deﬁnition 4 require dχ 1 iff χ b cid14 While 3 dχ 1 iff nonempty intersection χ b dχ 1 iff χ b cid14 We deﬁnitions interiorbased closurebased direction relation matrix respectively In following argue interiorbased deﬁnition coherent closurebased First mentioned dχ 1 iff common interior point tile χ b original deﬁnition Direction Relation Matrix 16 Goyal Egenhofer 17 deﬁned detailed direction relation matrix interpreted ratio area χ b b numerical matrix dir b dχ χ TileName obtain This natural extension interiorbased direction relation matrix From dir coarse direction relation matrix dira b dχ χ TileName setting dχ 1 iff dχ 0 b dχ χ TileName dχ Second qualitative calculus introduced interiorbased direction relation matrix desirable For example natural requirement identity relation contained unique basic CDC relation For interiorbased deﬁnition dira O connected region The following example shows case closurebased direction relation matrix cid3 Example 5 Take square 1 1 1 1 cid3 closurebased deﬁnition cid3 dira cid14 dira cid6 cid6 cid7 cid7 dira dira cid3 cid3 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 0 1 0 unit disk centered 0 0 Then Ma cid3 Ma The interiorbased deﬁnition consistent 4041 63 The weak composition problem The notion weak composition plays important role qualitative spatial temporal reasoning 172436 For basic CDC relations α β weak composition α w β α β deﬁned smallest relation CDC algebra contains composition α β Since CDC Boolean algebra α w β union basic CDC relations contains For basic CDC relation γ easy prove γ α w β γ α β cid14 40 2 See httpssitesgooglecomsitelisanjiangcdc illustrations consistent pairs W Liu et al Artiﬁcial Intelligence 174 2010 951983 Note γ α β nonempty iff following set basic CDC constraints C v 1α v 2 v 2β v 3 v 1γ v 3 975 41 consistent We note C complete network The constraint v 2 v 1 speciﬁed According previous subsection α multiple converses To apply main algorithm need extend C complete network cid2 cid3 C v 1α v 2 v 2αcid3 v 1 v 2β v 3 v 3β cid3 v 2 v 1γ v 3 v 3γ cid3 v 1 42 We main algorithm determine completed network consistent If answer yes αcid3 βcid3 γ cid3 γ contained weak composition α β Note need apply main algorithm αcid3 βcid3 γ cid3 α αcid3 β βcid3 γ γ cid3 consistent pairs For example weak composition S W W N E E contains 206 218 basic CDC relations3 The problem considered 1540 The main idea compute weak composition progressively Goyal 15 established weak composition singletile relations Upon Theorem 1 40 establishes rule computing weak composition singletile relation basic relation The correctness theorem conﬁrmed algorithm Furthermore Theorem 2 40 gives rule compute weak composition multitile relations Two examples rule correct Recently problem ﬁxed based case case analysis Skiadopoulos Koubarakis4 They veriﬁed results 7 Consistency checking variants CDC The CDC algebra introduced Deﬁnition 4 requires regions connected This calculus variants literature One introduced 41 deals cardinal direction relations possibly disconnected regions originally proposed 16 deals simple regions connected regions topologically equivalent closed disks In section consistency checking algorithm designed connected regions possibly holes adapted cope variants 71 Cardinal directions possibly disconnected regions For possibly disconnected regions b similar Deﬁnition 4 write dira b dχ χ TileName direction χ b cid14 0 A 3 3 Boolean matrix M valid exist relation matrix b dχ 1 regions b M dira b It easy zero 3 3 Boolean matrices valid Each matrices represents basic direction relation possibly disconnected regions We Boolean algebra generated JEPD relations cardinal direction calculus possibly disconnected regions denoted CDCd Consistency checking CDCd similar CDC Suppose N v iδi j v jn j1 complete network basic CDCd constraints Similar deﬁnitions regular solutions meetfree solutions canonical solutions deﬁned CDCd Moreover suppose solution N We transform canonical solution acid3 i1 N That n acid3 i1 canonical sets intervals We N maximal canonical solution Actually let bi region obtained deleting disallowed pixels Ma regular meetfree digital solution I xa i1 maximal canonical solution N cid3 Eq 25 We assert b bin i1 I ya cid3 cid3 cid3 Theorem 6 Suppose N v iδi j v jn maximal canonical solution N bi deﬁned Eq 25 j1 complete network basic CDCd constraints If N consistent bin i1 Proof The proof similar Lemma 8 cid2 This shows construct maximal canonical solution network basic CDCd constraints need compute connected components bi We adapt main algorithm determine consistency complete network N v iδi j v jn j1 basic CDCd constraints We ﬁrst note projective interval relation basic CDCd constraint computed similar way basic CDC constraint Remark 5 Appendix A As case connected regions Step 1 computes projective IA networks Nx N y If inconsistent N inconsistent Otherwise Step 2 constructs canonical interval solutions Step 3 computes bi If Mbi cid14 mi N inconsistent The procedures connected case need cubic time Since regions solution CDCd constraints allowed disconnected need compute connected components bi Therefore directly Step 5 need check dirbi b j δi j holds pair 3 See httpssitesgooglecomsitelisanjiangcdc illustration 4 Personal communication httppelopasuopgrspirospubshtml 976 W Liu et al Artiﬁcial Intelligence 174 2010 951983 χ j χ j To check b χ TileName Similar connected case need check b j Suppose δi j d 1 χ d χ m j nonempty suﬃcient pixel p contained bi χ m j Since bi disconnected checking boundary pixels insuﬃcient Note checking pixels mi χ m j needs O n2 time worst case pair j This undesirable cost O n4 time total χ m j nonempty We simpliﬁed For digital region b contained T write Bb Boolean matrix represents b Eq 30 For 0 cid2 k nx 0 cid2 l n y write Mbk l number pixels contained b rectangle 0 k 1 0 l 1 It easy Mb nx n y integer matrix cid25cid2 cid3 Mbk l Bbp q 0 cid2 p cid2 k 0 cid2 q cid2 l 43 0 cid2 k nx 0 cid2 l n y Given Boolean matrix Bb Mb computed O n2 time iteratively adding kth column k 1th iteratively adding pth row p 1th Mb gives way compute number pixels contained b 0 k 1 0 l 1 The following proposition concerns pixels contained b arbitrary rectangle x y y rectangle let b digital region b contained T 0 nx 0 n y Then Proposition 18 Let r x b r contains pixel iff cid4 Mb 1 y x cid4 Mb 1 1 y x cid5 cid4 Mb cid5 1 1 y x cid4 Mb 1 1 y x cid5 1 cid5 44 Mb1 l Mbk 1 0 Proof Because Mbk l denotes number pixels contained b 0 k 1 0 l 1 number pixels b contained rectangle x 1 y Mbx y 1 The conclusion follows directly cid2 1 Mbx 1 Mbx 1 Mbx 1 y 1 y 1 y y x The following proposition asserts given Mbi needs constant time decide b nonempty χ d χ j 1 χ m j Proposition 19 Let mi bi constructed Step 2 Step 3 respectively main algorithm possibly disconnected regions χ m j nonempty checked Let χ tile Suppose d constant time 1 Assume Mbi computed Then b χ j χ m j nonempty iff pixel contained bi χ m j Suppose T χ m j x x y Proof Note b y Since bi T bi χ m j bi cid10 cid11 T χ m j cid4 bi x x cid5 cid4 y cid5 y By Proposition 18 know bi χ m j contains pixel iff Eq 44 holds checked constant time cid2 Since 9n different rectangles T χ m j given Mbi dirbi b j δi j checked O n i1 solution N checked time Recall Mbi computed O n2 time This implies bin cubic time Therefore Step 5 algorithm ﬁnished O n3 time Remark 4 Skiadopoulos Koubarakis 41 proposed algorithm determining consistency basic constraints CDCd This algorithm applies possibly incomplete sets basic constraints Let N v iδi j v jn j1 network CDCd constraints δi j basic universal relation The algorithm 41 decide O n5 time N consistent In sense general cubic algorithm applied CDCd 72 Cardinal directions simple regions In deﬁnition direction relation matrix Deﬁnition 4 assume connected regions It possible nected regions holes In original work Goyal Egenhofer 1617 objects represented simple regions regions topologically equivalent closed disks Because direction relation matrix connected gions realized pair simple regions set cardinal direction relations simple regions connected regions We write CDCs qualitative calculus generated cardinal direction relations set simple regions W Liu et al Artiﬁcial Intelligence 174 2010 951983 977 Fig 18 A digital region contact points P 5 5 Q 5 6 h1 h2 holes h closure unbounded component exterior Table 8 Four types contact points h x denote pixel contained hole respectively h x h x x h x h In subsection difference simple regions connected regions affect consistency cardinal direction constraints In particular prove consistent network CDC constraints solution simple regions The idea transform connected regions possibly holes maximal canonical solution simple regions changing relations We ﬁrst note connected digital region ﬁnite holes hole closure bounded connected component exterior It easy holes digital region digital simple regions We point P contact point digital region exactly pixels P contained pixels diagonally adjacent cf Fig 18 The following lemmas study properties contact points maximal canonical solution Lemma 11 Let ain p pixel P contained hole h ai Then exists j cid14 p Ma j h i1 maximal canonical solution basic CDC network N Suppose P k l contact point ai Let Proof Omitted cid2 Because maximal canonical solution meetfree solution mbrs regions maximal canonical solution meet point cf Deﬁnition 13 The following lemma consequence observation Lemma 11 i1 maximal canonical solution basic CDC network N If P k l contact point ai Lemma 12 Suppose ain pixels P contained hole ai contained ai contained ai holes Proof Omitted cid2 By lemma types contact points See Table 8 For convenience denote type 4tuple symbols taken h x For pixels start left corner clockwise These types written haxa ahax xaha axah respectively A contact point removed deleting subpixel apixel follows hpixel according sequence type contact point Fig 19 Once contact points removed ai remaining holes easy cope We need following lemma prove main result subsection Lemma 13 For digital regions b cid10 cid3 Mb M b cid3 b dira b dira cid3 cid11 cid3 cid3 cid3 b satisﬁes following equation cid4 p p cid10 cid3 cid11 p cid14 cid5 45 978 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Fig 19 Remove type haxacontact point Fig 20 Transform connected digital region contact points simple region Proof Omitted cid2 Fig 21 Subdivision pixel 25 subpixels Theorem 7 Suppose N v iδi j v jn ai simple region j1 consistent network basic CDC constraints Then solution ain i1 Proof Suppose ain holes We assert exists simple region dirai j dira i1 maximal canonical solution N Then ai cid3 j dira j ai dira j cid3 j cid14 cid3 connected digital region cid3 Mai ai Ma cid3 Because connected contact points contains 21 subpixels p This implies We ﬁrst subdivide pixel 25 equal subpixels Fig 21 For contact point P k l ai loss generality assume P type haxa Removing 125 subpixel contains P ai obtain necessary regularization5 new region Fig 19 This procedure applied contact points ai time Write resulted region Since pixel p ai Mai contact points revised region It routine check contact points holes disjoint closure select pixel ph h highest yindex unbounded component exterior follows Let q left 4neighbor h We cut slot lowest pixel ph contained We delete middle column subpixels pixels ph q Fig 20 After necessary regularization obtain connected region fewer cid3 holes That holes cid3 Mai Moreover pixel p contained ai cid3 j dirai j p subpixels contained j cid14 This means cid3 i1 solution N consists simple regions cid2 n p nonempty By Lemma 13 know dira connect hole h exterior obtain connected region cid3 simple region It easy Applying operation holes disjoint hole cid3 cid3 know For hole h ai Ma ai Ma cid3 cid3 As consequence know satisfaction problem CDCs determined way CDC Theorem 8 The consistency network basic CDCs constraints determined cubic time 5 Here regularization means topological regularization set deﬁned W Liu et al Artiﬁcial Intelligence 174 2010 951983 979 8 Related work More dozen qualitative directionorientation calculi proposed literature We refer reader 638 information In section focus computational properties calculi The CDC extended objects extension projectionbased cardinal algebra point objects 10 The computational properties studied Ligozat 26 In particular identiﬁed maximal tractable subset cardinal algebra Several researchers use boxes rectangles approximate extended objects represent direction relation rectangles pair interval relation 182 This calculus known Rectangle Algebra RA twodimensional extension IA Balbiani et al identiﬁed tractable subclass RA larger product ORDHorn class 33 IA Recently Skiadopoulos et al 42 introduced family directional models extended objects These models approxi mate reference object mbr partition plane ﬁve instead tiles The authors gave methods computing converse composition directional relations The general consistency problem left open Unlike mentioned binary calculi Clementini Billen 4 introduced ternary projective relation calculus extended objects The model describes relative relation primary object reference objects partitioning plane zones respect reference objects Compared aforementioned direction calculi model extrinsic frame reference Rules permutation composition relations ternary calculus established 5 As point objects variety ternary orientation calculi established 1120308 Dylla Wall grün 8 examined calculi proved wellknown orientation calculi expressed general Oriented Point Relation Algebra OPRAm 30 In addition demonstrated mapping determine composition tables calculi OPRAm The compositionbased reasoning complete reasoning calculi 2029 Even worse know consistency problem NP problem calculus introduced 20 We regard major challenge theoretical research application qualitative orientation calculi 9 Conclusion This paper provided cubic algorithm checking consistency complete basic CDC networks earlier observed impossible 31 connected regions If basic CDC network consistent algorithm generates maximal canonical solution This general algorithm applied solve pairwise consistency problem weak composition problem Although devised solve cardinal directional constraints connected regions main algorithm adapted cope cardinal directional constraints possibly disconnected regions simple regions For complete network basic CDCd constraints algorithm determines cubic time consistent As cardinal direction constraints simple regions proved consistent basic CDC network solution simple regions This suggests CDC distinguish simply connectivity connectedness It worth mentioning cubic algorithm works complete basic CDC CDCd networks This unlike O n5 algorithm 41 applied solve possibly incomplete sets basic CDCd constraints It unknown exist eﬃcient algorithms checking consistency possibly incomplete sets basic CDC constraints Most potential applications qualitative spatial reasoning require multiple aspects space Combining spatial straints different calculi important problem research qualitative spatial reasoning Some work direction 142228 In particular 28 points reasoning basic RCC8 basic RA 2 constraints P reasoning basic RCC8 basic CDCd constraints NPComplete Note spatial variables RCC8 RA CDCd interpreted possibly disconnected regions It open similar results hold connected regions In particular know reasoning basic RCC8 basic CDC constraints decidable spatial variables interpreted connected regions Acknowledgements We thank anonymous referees helpful suggestions This work partially supported ARC Future Fellowship FT0990811 MSRA Young Professorship NSF China 60673105 60736011 National Basic Research Program China 2007CB311003 Appendix A Direction relation vectors projective interval relations v iρ y In section introduce method compute projective IA networks Nx v iρ x j v jn j1 We begin onedimensional counterpart CDC relations j1 basic CDC network N v iδi j v jn j v jn j1 N y 980 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Deﬁnition 16 direction relation vector Suppose I x L2 y real line parts L1 y vector dirI J d1 d2 d3 di 0 iff x y x J y L3 y Li In case d1 d2 d3 direction relation vector J partitions The direction I J encoded Boolean intervals Interval y x Clearly Boolean vector t t1 t2 t3 direction relation vector iff exist intervals I J t dirI J The following proposition gives characterization direction relation vectors Proposition 20 A Boolean vector t t1 t2 t3 direction relation vector t cid14 0 0 0 t cid14 1 0 1 Interestingly direction relation vector actually represents IA relation Proposition 21 For intervals I J t t1 t2 t3 direction relation vector I J iff I J instance αt t αt 1 0 0 p m 0 1 0 s d f eq 0 0 1 pi mi 1 1 0 o ﬁ 0 1 1 oi si 1 1 1 di Proof Take t 1 0 0 example For I x x hold This equivalent saying x cid2 y J y cid2 y x dirI J 1 0 0 iff x y x possible iff I J p m cid2 y x y y In follows IA relation vector IA relation IA relation represented direction relation vector We difference direction relation vector IA relation represents By proposition know vector IA relations viz p m s d f eq pi mi o ﬁ oi si di Note vector IA relation general nonbasic pair vector IA relations precise For example dirI J 0 1 0 sure I J s d f eq Assuming dir J I given easy IA relation I J deﬁnite basic IA relation The following proposition summaries correspondence pairs direction relation vectors IA relations Proposition 22 For pair direction relation vectors s t intervals I J s dirI J t dir J I iff I J instance basic IA relation cell speciﬁed s t Table 9 Proposition 22 shows basic IA relations meets converses represented pairs direction relation vectors Proposition 23 Suppose δ dχ χ TileName basic CDC relation Then xprojective interval relation ιxδ IA relation associated vector d1 d2 d3 I J ιxδ iff dirI J d1 d2 d3 d1 max cid2 dN W dW dS W cid3 d2 max cid2 dN d O dS cid3 cid2 d3 max dN E dE dS E cid3 Proof Omitted cid2 Table 9 Pairs vector IA relations st 1 0 0 0 1 0 0 0 1 1 1 0 0 1 1 1 1 1 1 0 0 pi mi 0 1 0 eq ﬁ si di 0 0 1 p m 1 1 0 f oi 0 1 1 s o 1 1 1 d W Liu et al Artiﬁcial Intelligence 174 2010 951983 981 As corollary Proposition 3 Suppose δ basic CDC relation Then xprojective interval relation ιxδ following IA relations p m s d f eq pi mi o ﬁ oi si di 46 Proof This Proposition 23 ιxδ vector IA relation Checking Proposition 21 know vector IA relation IA relation Eq 46 cid2 By Proposition 22 Proposition 23 Proposition 4 For pair basic CDC constraints δ γ ιxδ γ IA relation B int B int o s d f eq ﬁ di si oi p m pi mi 47 Proof Recall ιxδ γ ιxδ ιxγ intersection vector IA relations relation Eq 13 cid2 Because ιxδ ιxγ vector IA relations According Table 9 know For pair basic CDC constraints δ γ projective IA relation ιxδ γ computed constant time 1 Compute ιxδ ιxγ according Proposition 23 2 Check Table 9 determine ιxδ ιxγ The projective IA networks basic CDC network computed O n2 time Proposition 24 Suppose N v iδi j v jn v iρ y j1 computed O n2 time j v jn j1 basic CDC network Then projective IA networks Nx v iρ x j v jn j1 N y Proof This pair j ιx ρ y j N y computed O n2 time cid2 m mi know ρ x j ρ y ι y j j ι y m mi j computed constant time Since O n2 pairs clear Nx j computed constant time By ρ x ιx j j Remark 5 For CDCd Cardinal Direction Calculus possibly disconnected regions compute projective interval relations similar way In particular similar Proposition 23 xprojective interval relation ιxδ basic CDCd relation δ dχ χ TileName IA relation associated vector d1 d2 d3 d1 maxdN W dW dS W d3 maxdN E dE dS E d2 1 d1 d3 1 maxdN d O dS For example δ W N E ιxδ IA relation associated vector 1 1 1 di according Proposition 21 Except modiﬁcation procedures computing projective IA networks basic CDCd network exactly CDC This means projective IA networks computed O n2 time CDCd Appendix B Proof Proposition 12 Proposition 12 Each consistent basic CDC network regular solution meetfree Proof Let ain cst αs αs1 βt βt1 Eqs 1622 deﬁnitions αs βt ar cid31 i1 regular solution N Suppose Ca cst 0 cid2 s nx 0 cid2 t n y cell set cst cid14 We meetfreeing process described Section 42 remove meetpoints cst Because regular know ai ar cst Ca changing CDC relations Take xdirection example We prove induction mx number xmeet points Suppose i1 m 0 xmeet points hypothesis holds regular solutions m 1 xmeet points Assume ain We transformed regular solution fewer xmeet points Suppose αk largest xmeet point 0 k nx Write α αk αk12 The line x α divides cell kl For 1 cid2 cid2 n 0 cid2 l n y ckl ai ckl 0 cid2 l n y equal parts written order c kl c ck1l cid14 ai delete c remaining ai kl ai cf Fig 8a Write cid13 kt ckt ai kt ckt ck1t ai cst ai s cid14 k cid13cid2 c cid13cid2 c cid3 cid3 48 Clearly contained ai We claim i1 regular solution N fewer xmeet points n 982 W Liu et al Artiﬁcial Intelligence 174 2010 951983 Write C 0 cst Ca s cid14 k C union C 0 C C Suppose I xai x x kt ckt Ca C c Moreover We easily prove I xa I xa It clear intervals I xa know points fewer xmeet points c kt ckt Ca It clear Ca cell set composed cells Ca This shows α x j meet iff I xai I xa j meet Since αk α I xai x cid14 αk I xa regular I xai x αk xmeet We prove 4connectedness cell set cf Deﬁnition 10 prove Proposition 86 connected region Similar digital regions introduce notions 4neighbors connected region iff 4connected cf β0 βn y If I xai contained 0 αk αk1 αnx α αnx 4connected We ﬁrst observe exists 0 cid2 t n y ck1t ckt contained ai This 4connectedness ai cell set Ca Second Cacell c 4connected ck1t 4connected c clearly connected region Suppose αk1 αk1 I xai We ai Moreover I xai contained αk αnx ai In cases kt c kt Without loss generality suppose c c By 4connectedness ai Ca know ck1t 4connected cktcid3 ai Suppose ck1t c0 c1 cm cktcid3 series pairwise different Cacells ai ci1 4neighbor ci 0 m 1 We replace ci Cacells ci Ca We replace cm kt For 1 cid2 m ci1 left 4neighbor c ci ckt1 replace ci c c kt It straightforward prove revised series Cacells 4connected order replace ci c This shows kt order cm1 left 4neighbor cktcid3 c order ci1 left 4neighbor ci replace ci c kt c kt1 kt1 kt1 kt1 c ktcid3 C We prove dira cid10 cid11 c Ca c ai χ j connected region j dirai j pair cid14 j This equivalent proving cid10 j C cid11cid11 c χ c iff cid10 cid10 cid11 49 cid3 χ kt c ckt It holds 1 cid2 j cid2 n χ TileName For c Ca deﬁne c j It clear c ai iff c straightforward prove c χ j iff c This shows Ca st c exists c Ca st c ai χ j exists c j On hand suppose exists cid3 c cid3 ai χ j c cid3 c cid3 C0 c cid3 Ca st c χ kt t ckt ai χ j If c c kt ckt ck1t contained ai By construction t c j know deﬁnition j Ma j It easy ckt χ j Ma ck1t χ j This implies ckt ai χ j ck1t ai χ j Therefore Eq 49 holds j χ This shows regular solution N fewer xmeet points By induction hypothesis know transformed regular meetfree solution cid2 cid3 j Ma j α x c c C 0 deﬁne c 0 n y x j αk Ma j If c χ c j References 1 JF Allen Maintaining knowledge temporal intervals Communications ACM 26 11 1983 832843 2 P Balbiani JF Condotta L Fariñas del Cerro A new tractable subclass rectangle algebra Proceedings 16th International Joint Conference Artiﬁcial Intelligence IJCAI99 1999 pp 442447 3 S Cicerone P di Felice Cardinal directions spatial objects pairwiseconsistency problem Information Sciences 164 14 2004 165188 4 E Clementini R Billen Modeling computing ternary projective relations regions IEEE Transactions Knowledge Data Engineer ing 18 6 2006 799814 5 E Clementini S Skiadopoulos R Billen F Tarquini A reasoning ternary projective relations IEEE Transactions Knowledge Data Engineering 22 2 2010 161178 6 AG Cohn J Renz Qualitative spatial reasoning F van Harmelen V Lifschitz B Porter Eds Handbook Knowledge Representation Elsevier 2007 7 I Düntsch H Wang S McCloskey A relationalgebraic approach region connection calculus Theoretical Computer Science 255 12 2001 6383 8 F Dylla JO Wallgrün On generalizing orientation information OPRAm Proceedings 29th Annual German Conference AI KI06 2006 pp 274288 9 MJ Egenhofer Reasoning binary topological relations Proceedings 2nd International Symposium Advances Spatial Databases SSD91 SpringerVerlag London UK 1991 pp 143160 10 AU Frank Qualitative spatial reasoning cardinal directions Proceedings 7th Austrian Conference Artiﬁcial Intelligence ÖGAI91 1991 pp 157167 11 C Freksa Using orientation information qualitative spatial reasoning Theories Methods SpatioTemporal Reasoning Geographic Space Lecture Notes Computer Science vol 639 Springer 1992 pp 162178 12 EC Freuder Synthesizing constraint expressions Communications ACM 21 11 1978 958966 13 EC Freuder A suﬃcient condition backtrackfree search Journal ACM 29 1 1982 2432 14 A Gerevini J Renz Combining topological size information spatial reasoning Artiﬁcial Intelligence 137 1 2002 142 15 RK Goyal Similarity assessment cardinal directions extended spatial objects PhD thesis The University Maine 2000 6 Another possible way transform digital region Eq 23 W Liu et al Artiﬁcial Intelligence 174 2010 951983 983 16 RK Goyal MJ Egenhofer The directionrelation matrix A representation direction relations extended spatial objects UCGIS Annual Assembly Summer Retreat Bar Harbor ME 1997 17 RK Goyal MJ Egenhofer Similarity cardinal directions Proceedings 7th International Symposium Advances Spatial Temporal Databases SSTD 2001 2001 pp 3658 18 HW Guesgen Spatial reasoning based Allens temporal logic Technical report International Computer Science Institute 1989 19 PW Huang CH Lee Image database design based 9DSPA representation spatial relations IEEE Transactions Knowledge Data Engineer ing 16 12 2004 14861496 20 A Isli AG Cohn A new approach cyclic ordering 2D orientations ternary relation algebras Artiﬁcial Intelligence 122 12 2000 137187 21 A Krokhin P Jeavons P Jonsson Reasoning temporal relations The tractable subalgebras Allens interval algebra Journal ACM 50 5 2003 591640 22 S Li Combining topological directional information spatial reasoning Proceedings 20th International Joint Conference Artiﬁcial Intelligence IJCAI07 2007 pp 435440 23 S Li H Wang RCC8 binary constraint network consistently extended Artiﬁcial Intelligence 170 1 2006 118 24 S Li M Ying Region connection calculus models composition table Artiﬁcial Intelligence 145 12 2003 121146 25 S Li M Ying Generalized region connection calculus Artiﬁcial Intelligence 160 12 2004 134 26 G Ligozat Reasoning cardinal directions Journal Visual Languages Computing 9 1 1998 2344 27 G Ligozat J Renz What qualitative calculus A general framework Proceedings 8th Paciﬁc Rim Trends Artiﬁcial Intelligence PRICAI 04 2004 pp 5364 28 W Liu S Li J Renz Combining RCC8 qualitative direction calculi Algorithms complexity Proceedings 21th International Joint Conference Artiﬁcial Intelligence IJCAI09 AAAI 2009 29 D Lücke T Mossakowski D Wolter Qualitative reasoning convex relations Proceedings international conference Spatial Cognition VI Learning Reasoning Talking Space Springer 2008 p 440 30 R Moratz Representing relative direction binary relation oriented points Proceedings 17th European Conference Artiﬁcial Intelli gence ECAI06 2006 p 407 31 I Navarrete A Morales G Sciavicco Consistency checking basic cardinal constraints connected regions Proceedings 20th Interna tional Joint Conference Artiﬁcial Intelligence IJCAI07 2007 pp 495500 32 B Nebel Computational properties qualitative spatial reasoning First results Proceedings 19th Annual German Conference Artiﬁcial Intelligence KI95 1995 pp 233244 33 B Nebel HJ Bürckert Reasoning temporal relations A maximal tractable subclass Allens interval algebra Journal ACM 42 1 1995 4366 34 DA Randell Z Cui AG Cohn A spatial logic based regions connection Proceedings 3rd International Conference Knowledge Representation Reasoning KR92 1992 pp 165176 35 J Renz Maximal tractable fragments Region Connection Calculus A complete analysis Proceedings 16th International Joint Conference Artiﬁcial Intelligence IJCAI99 1999 pp 448454 36 J Renz G Ligozat Weak composition qualitative spatial temporal reasoning Proceedings 11th International Conference Principles Practice Constraint Programming CP 2005 Springer 2005 pp 534548 37 J Renz B Nebel On complexity qualitative spatial reasoning A maximal tractable fragment Region Connection Calculus Artiﬁcial Intelligence 108 1999 69123 38 J Renz B Nebel Qualitative spatial reasoning constraint calculi M Aiello I PrattHartmann J van Benthem Eds Handbook Spatial Logics Springer 2007 pp 161215 39 S Skiadopoulos C Giannoukos N Sarkas P Vassiliadis T Sellis M Koubarakis Computing managing cardinal direction relations IEEE Transactions Knowledge Data Engineering 17 12 2005 16101623 40 S Skiadopoulos M Koubarakis Composing cardinal direction relations Artiﬁcial Intelligence 152 2 2004 143171 41 S Skiadopoulos M Koubarakis On consistency cardinal direction constraints Artiﬁcial Intelligence 163 1 2005 91135 42 S Skiadopoulos N Sarkas T Sellis M Koubarakis A family directional relation models extended objects IEEE Transactions Knowledge Data Engineering 19 8 2007 1116 43 JG Stell Boolean connection algebras new approach regionconnection calculus Artiﬁcial Intelligence 122 1 2000 111136 44 A Tarski On calculus relations Journal Symbolic Logic 6 1941 7389 45 RE ValdésPérez The satisﬁability temporal constraint networks Proceedings 6th National Conference Artiﬁcial Intelligence AAAI87 1987 pp 256260 46 F Wolter M Zakharyaschev Spatial reasoning RCC8 Boolean region terms Proceedings 14th European Conference Artiﬁcial Intelligence ECAI 2000 2000 pp 244250 47 F Wolter M Zakharyaschev Spatiotemporal representation reasoning based RCC8 Proceedings 7th Conference Principles Knowledge Representation Reasoning KR 2000 2000 pp 314