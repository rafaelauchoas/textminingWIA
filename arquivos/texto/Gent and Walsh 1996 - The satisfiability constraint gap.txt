Artificial Intelligence 81 1996 5980 Artificial Intelligence The satisfiability constraint gap Ian l Gent Toby Walsh bcl Department AI Universiv Edinburgh 80 South Bridge Edinburgh UK h Mechanized Reasoning Group IRSZ Lx Pant6 di Povo Trento Italy c DISZ University Genoa Genoa Italy Received May 1994 revised March 1995 Abstract We experimental investigation satisfiability phase transition dif ferent classes randomly generated problems We conventional picture easy hardeasy problem difficulty inadequate In particular region variable problem difficulty problems typically underconstrained satisfiable Within region prob lems orders magnitude harder problems middle satisfiability phase transition These extraordinarily hard problems appear associated constraint gap That region search maximum constraint propagation min imum We position shape constraint gap change little problem size Unlike hard problems middle satisfiability phase transition hard problems variable region critically constrained satisfiability unsatisfiability Indeed hard problems variable region contain small unique minimal unsatisfiable subset reduce early stage search hard unsatisfiable subproblem small unique minimal unsatisfiable subset The difficulty solving problems identifying minimal unsatisfiable subset irrelevant clauses The existence constraint gap greatly hinders ability minimal unsatisfiable subsets However remains open problems remain hard intelligent backtracking procedures We conjecture results generalize SAT problem classes phase transitions NPhard problems Keywords Search phase transitions Satisfiability Constraint propagation Hard problems Current address Department Computer Science University Strathclyde Glasgow Gl IXH UK Email ipgcsstrathacuk Email tobyirstit 00043702961500 1996 Elsevier Science BV All rights reserved SSDIOOO437029500047X 60 1P Gent lY WalshArtijcial Intelligence 81 19 5980 1 Introduction Many randomly generated NPhard problems display phase transition pa rameter varied problems soluble 31 This phase transition associated problems insoluble typically hard solve In paper different classes satisfiability problems including random 3SAT phase transition associated problems typically hard regions vari able problem difficulty problems usually easy extraordinarily hard We identify cause behaviour disappear better algorithms heuristics We predict similar regions variable problem difficulty NPhard problems satisfiability The extraordinarily hard problems regions use analysing comparing performance algorithms NPhard problems 2 Satisfiability Propositional satisfiability SAT problem deciding assign ment truth values variables propositional formula makes formula true standard interpretation logical connectives We consider SAT problems conjunctive normal form CNF formula 2 CNF conjunction clauses clause disjunction literals literal negated unnegated variable A standard procedure determining satisfiability Davis Putnam Logemann Loveland 56 We DavisPutnam procedure See Fig 1 procedure DP 2 Z return satisfiable 2 contains clause return unsatisfiable Tautology 2 contains tautologous clause c return DP 2 c Unit propagation 2 contains unit clause 1 return DP 2 simplified assigning 2 True Pure literal deletion 2 contains literal I negation 1 return DP 2 simplified assigning 1 True Split DP 2 simplified assigning literal 1 True satisfiable returu satisfiable return DP 2 simplified assigning negation 1 True Fig 1 The DavisPutnam procedure 2 We follow recent nomenclature 8141 Davis Futnam 61 introduced unit pure rules Davis Logemann Loveland 5 introduced split rule use backtracking The authors modestly presented difference merely implementation example 1P Gent T WalshArtificial Intelligence 81 19 5980 61 An clause contains literals unit clause contains single literal tautologous clause contains literal negation To simplify set clauses assignment literal I True delete clause contains 1 delete negation 1 occurs remaining clauses Note DavisPutnam procedure nondeterministic literal split rule unspecified As previous studies 814 split literal clause We variant DavisPutnam procedure DP With good heuristics choosing literal split efficient implementation DavisPutnam procedure best complete procedure satisfiability 71 3 Constant probability model The constant probability model randomly generated problems subject considerable theoretical experimental attention In model given N variables L clauses clause generated contains 2N different literals probability p Our experiments use variant constant probability model proposed 111 experimental studies 8914 In problem class unit clause generated discarded clause generated place This inclusion unit clauses typically makes problems easier We shall CP model In experiments 89 choose p 2Np 3 mean clause length remains approximately constant N varies In 141 shown phase transition satisfiability unsatisfiability CP ratio clauses variables LN varied If 2Np kept constant phase transition occurs LN M 280 Ntoo 9 The satisfiability phase transition computational importance easyhardeasy pattern problem difficulty cross phase transition hardest instances occurring phase transition 141 When ratio clauses variables large problems usually overconstrained easily shown unsatisfiable When ratio small problems usually underconstrained satisfying assignment guessed quickly The hard instances tend occur phase transition problems overconstrained underconstrained In 81 showed whilst median problem difficulty simple easyhard easy pattern region variable exceptionally hard problem difficulty highpercentage satisfiability The worstcase problems region orders magnitude harder middle satisfiability phase transition These extraordinary problems easily dominate mean problem difficulty Similar behaviour observed Hogg Williams randomly generated 3colourability problems lo Fig 2a gives mean median number branches DP 1000 problems CP model N 100 LN 01 60 intervals 01 The number branches number leaf nodes search tree It pro vides good indication problem difficulty run time The dotted line indicates observed probability problems satisfiable There considerable differ 62 IF Gent 1 WalshArtificial Intelligence 81 1996 5980 06 02 0 4 5 6 LN 2 Pmbsat 08 i__ 06 _ 04 02 0 5 LN b hOOOO poblems Fig 2 CP problems tested DP N 100 Mean median branches ence mean median performance The worstcase mean 625 branches occurs LN 24 satisfiable region whilst worstcase median 9 branches occurs LN 39 middle satisfiability phase transi tion Despite testing 1000 problems point large noise mean especially region LN 2 4 despite use logarithmic scale In Fig 2b tested 100000 problems point Due large cost testing number problems restricted attention region LN 15 50 Although noise reduced considerably taking 100000 problems large difference mean median perfor mance The greatest difference region previously noisy median performance 1 2 branches There secondary peak mean prob lem difficulty 243 branches LN 30 The worstcase mean 350 branches occurs LN 36 close worstcase median 9 branches middle satisfiability phase transition The variable behaviour satisfiable region increases rapidly N eventually dominates mean 81 The worst mean performance large N occurs satisfiable region middle phase transition To explore phenomenon Fig 3 breakdown percentiles number branches 50 median 100 worst case experiment described 100000 problems tested point The 999 contour example gives difficulty problem took branches 01 problems case hundredth hardest problem point Interestingly worstcase contour noisy despite large number problems tested logarithmic scale plotted Furthermore different contours widely separated especially smaller values LN showing example tenth worst problem order magnitude harder hundredth worst problem As examine contours closer worst case peak smaller values LN In particular worst case 185902 branches LN 29 LN 39 point worst median performance worst case 10959 branches order magnitude smaller II Gent T WalshArtificial Intelligence 81 1996 5980 63 Pmbat Pmbsat 06 0 2 3 4 5 LN 0 I 2 3 4 5 6 percentile branches b constraint propagationssplits Fig 3 CP problems tested DP N 100 In 81 similar behaviour CP observed better splitting heuristics However variable difficult behaviour highpercentage satisfiable region apparent till larger N 4 Constraint gap In DavisPutnam procedure split rule rule gives rise exponential behaviour The rules simplify problem branch search In particular unit pure rules advantage constraints commit polynomial time particular truth assignments Since extremely bad worstcase performance satisfiable region presumably exponential behaviour conjecture unit pure rules importance split rule region In Fig 3 b plot mean ratio pure literal deletions splits unit propa gations splits sum pure literal deletions unit propagations splits CP N 100 The uppermost solid line shows ratio constraint prop agations splits Underneath plotted scale ratio number applications pure rule splits peaking left ratio number applications unit rule splits peaking right Since split rule merely formalized guessing ratio propagations splits indicates number variable assignments deduced guess search To avoid divi sion zero exclude trivial problems tend occur small LN solved splits Such problems solved polynomial time simple preprocessing step exhaustively applies unit pure rules As guide dotted line repeats probability satisfiability Fig 2a We effect unit pure propagations individually The number pures dominates behaviour small values LN unit propagations start dominate large values The ratio propagations splits shows large peak 735 LN 13 In region problems trivial solved exclusively pure literal deletion However increasing LN number pure 64 1P Gent 7 WalshArtificial Intelligence 81 1996 5980 RMW 29 0 1 2 3 4 5 6 LN L IN equivalent N lJ mean min max depth NlOO b scaling Probsat N 25 250 0 1 2 3 4 5 6 Fig 4 CP problems tested DP literal deletions drops rapidly applications unit propagation A local maximum 338 propagations split reached LN 52 region performance comparatively noisy The interesting region Fig 3b region pure literal deletions unit propagations dominate behaviour region total number propagations shows pronounced minimum The minimum mean ratio sum units pures splits 98 occurs LN 25 close position hardest worst case These graphs confirm unit pure rules effective satisfiable region There appears constraint gap region unit pure rules unable identify constraints truth assignments use split rule extensively This suggest depth search depth nesting split rule applications peak region In Fig 4a plot mean minimum mean maximum depth search The peak minimum depth 100 LN 25 peak maximum depth 116 LN 28 This coincides closely minimum ratio sum units pures splits position hardest worst case For unsatisfiable problems peak minimum search depth corresponds exponentially larger peak problem difficulty branches searched minimum depth tree We confirmed plotting logarithm problem difficulty unsatisfiable problems This approximately proportional mean minimum search depth 5 Scaling constraint gap The importance constraint gap depends relationship constraint gap phase transition satisfiability unsatisfiability For instance constraint gap occurs near satisfiability phase transition likely prove costly constraint gap occurs away 1P Gent T WalshArtijFcial Intelligence 81 1996 5980 65 region easy problems To help determine relationship constraint gap satisfiability phase transition draw analogy phase transitions physical systems One unusual theoretically interesting phase transitions occurs spin glasses Each N atoms spin glass magnetic spin values 1 1 The 2N possible configurations Macroscopic properties configuration energy entropy depend interactions spins nearest neighbours Due differences separation atoms interactions ferromagnetic promoting alignment spins whilst antiferromagnetic promoting opposite spins The net effect random force An analogy spin glasses randomly generated SAT problems Each N variables truth assignment values True False The 2N possible configurations Macroscopic property like satisfiability depend interaction variables neighbouring clause Due random polarities variables net effect variable random preference True False Kirkpatrick et al 131 analogy suggest fascinating scaling result random kSAT randomly generated problem class contains clauses fixed length k described Section 6 They propose fundamental function f values LY v Probsat fLN cuN 1 Here relation holds problem classes like CP contain clauses mixed lengths In Fig 4b plot probability satisfiability CP yaxis LN yNr xaxis For convenience multiplied xordinate loo added LY values xaxis equivalent value LN N 100 The dashed line gives point LN LY We set Y 29 experimentally observed position satisfiability phase transition A value u trial error Using LI 25 good fit curves N 255075100150200 250 These plots 03 apart terms LN measured N 100 This slightly good fit observed random 3SAT 131 random mixed SAT 9 problem class contains fixed distribution clause lengths defined Section 7 This CP model distribution clause lengths changes slightly problem size expected number tautologies allowed CP model random 3SAT random mixed SAT changes problem size The normalized ratios units splits pures splits like probability satisfiability macroscopic properties satisfiability vary N L 0 100 We investigated features search scale problem size changes Very surprisingly normalized ratio units splits scale simple fashion similar probability satisfiability That exists function g constants cyu v 66 1P Gent T WalshArtificial Intelligence 81 I 996 5980 Percentage maximum value Percentage maximum value lOO_ FJJ_ 33 I I I Tqw_ la_ 40_ 20_ 0 _ dm WZ 0 1 2 3 LN equivslent N 100 4 6 5 0 1 2 3 4 5 6 LN scaling unitssplits b scaling puressplits Fig 5 CP problems tested DP N 25 300 unitssplits max unitssplits g LN YN ratios units region LN N 255075100150 way Fig 4b Using Q 33 graph small It particularly The normalizing maximal values fixed N varying L In Fig 5a plot splits CP problems normalized 300 The xaxes scaled L 25 good fit Eq 2 seen clearly particularly large values LN important note value CY 33 larger values LN earlier observed bad worstcase behaviour constraint gap The maximum hc6 We number splits required expect increase N Sublinear growth number branches linear scaling ratio splits scale approximately scaling ratio suggests exponential fit model closely approximately 2 4 Behaviour searched ratio units required It seen satisfiable large peak low LN The scaling ratio pures splits simple units In Fig 5b ratios number pure literal deletions splits values N normalized relevant maximum value yaxis unscaled xaxis region problems proved applications pure rule This peak moves slightly contrast increasing splits occurs extremely constraint gap scaling number trivial pures splits sublinear For example LN 2 ratio pures splits increases 16 N 100 18 N 300 hardly It harder problem simply large number right increasing N By peak ratio pures peak peak value fast takes place dramatically number variables N increases However speed N increases Unlike unit propagations problems essentially small values LN suggesting definite conclusion approach size triples decline increasing It come likely ll Gent 7 WalshArtificial Intelligence 81 1996 5980 67 unit propagations However noted peak pure applications occur significantly lower values LN observed bad behaviour constraint gap As behaviour low LN dominated easy trivial problems possible eliminated suitable way observe similar scaling seen probability satisfiability unit propagations splits These results suggest constraint gap pronounced increasing N In particular decline number unit propagations N increases LN decreases LY gets sharper The behaviour pure rule clearcut broadly similar behaviour In 81 showed worstcase behaviour unsatisfiable problems unsatisfiable subproblems satisfiable problems 81 As pure literal deletions directly help solve satisfiable problems simplifying unsatisfiable problems expect pure literal deletion help suppress bad worstcase behaviour constraint gap utility pure literal rule decay These results constraint gap CP like phase transition satisfiability unsatisfiability occurs fixed value LN fixed ratio constraints variables The constraint gap open approximately LN 2 33 The position constraint gap fixed relative position satisfiability phase transition From shape g scaling maximal values value u appears constraint gap pronounced N increases 6 Random kSAT Following 141 studies satisfiability phase transition concentrated random kSAT problem class A problem random kSAT consists L clauses k literals chosen uniformly N possible variables literal positive negative probability 3 Unlike CP clauses random kSAT model length In 141 shown satisfiability phase transition random 3SAT LN M 43 median behaviour displays simple easyhardeasy pattern phase transition In 81 showed hard random 3SAT problems occur satisfiable region Crawford Auton anecdotally report large problems 4 Indeed problems satisfiable region orders magnitude harder hardest problems middle satisfiability phase transition point worst median performance These extraordinarily hard problem appear rarer random 3SAT CP Although hard problems sample 1000 CP required 100000 random 3SAT As CP hard random 3SAT problems occur region constraint gap minimum ratio constraint propagations splits Again CP constraint gap probability satisfiability scale Eqs 1 2 In Fig 6a b plot probability satisfiability normalized ratios units splits random 3SAT problems N 10 70 steps 10 Using 68 1R Gent 7 WalshArtijcial Intelligence 81 1996 5980 Probsat Percentaee maximum value 30 35 40 45 50 55 60 0 1 L N equivalent N 50 scaling Probsat 2 3 L N equivalent N 50 4 5 6 b scaling unitssplits Fig 6 Random 3SAT problems tested DP N 10 70 Y 415 u 15 following 13 cq 33 v 285 good fit Eqs 1 2 The peak ratio units splits vary approximately Nc6 Again mean minimum depth search peaks small value LN For example N 50 maximum value 111 LN 26 As CP obtain similar scaling result ratio pures splits However region pure literal deletions decays smaller value LN region unit propagations To conclude hard problems occur random 3SAT satisfi able region These hard problems appear associated constraint gap This constraint gap occurs fixed value LN pronounced N increase The position constraint gap fixed relative position satisfiability phase transition While satisfiability phase transition CP constraint gap Section 5 case 3SAT The probability phase transition occur approximately 42 constraint gap end approximately 33 This difference account aspects differences behaviour CP 3SAT 7 Random mixed SAT In 91 introduced generalization random kSAT model called random mixed SAT In satisfiability phase transition problems random mixed SAT harder comparably sized random kSAT problems In random mixed SAT model set clauses generated respect probability distribution 4 integers Each clause generated random kSAT k length clause chosen randomly according 4 For example 9 2 3 1 clauses length 2 3 appear probability whilst 42 f 4 3 clauses length 2 appear probability f length 4 probability 3 In 1R Gent I WalshArtificial Intelligence 81 1996 5980 69 l _ 08 _ 06 _ 04 i_ 02 0 Pmbat 1 08 oj __ 04 _ 02 0 0 1 2 3 4 5 6 LN 0 1 2 3 4 5 6 LN percentile branches b constraint propagationssplits Fig 7 Random 244SAT problems tested DP N 100 paper problem classes 23SAT 244SAT respectively The frequency occurrence integer reflects frequency occurrence clauses length problem Random kSAT special case random mixed SAT 4k 1 4j 0 j k For given 4 define density 4 d 4 def M c kl 4kl P The density gives mean fraction truth assignments consistent given clause generated q The expected number models random mixed SAT problem N variables L clauses 2N dg L The random mixed SAT model generate problems similar realworld problems random kSAT For example structured problems encode SAT problems mixed clause lengths scheduling problems encoded SAT large numbers binary clauses The random mixed SAT model produces problems said harder random kSAT In 9 showed satisfiability phase transition random mixed SAT given 4 occur random kSAT fixed ratio LN For random 244SAT phase transition occurs LN M 274 observed similar kind scaling seen Fig 4b constants LY 274 u 35 Although random 244SAT density random 3SAT problem difficulty satisfiability phase transition random 244SAT similar CP random 3SAT Fig 7a shows percentile branches DP random 244SAT problems N 100 10000 problems tested value LN 02 60 steps 02 Median problem difficulty shows simple easyhardeasy pattern whilst hardest problems region highpercentage satisfiability The worst case 104885 branches LN 28 LN 38 point worst median performance worst case 7534 branches orders magnitude smaller As CP extraordinarily 70 1R Gent 7 WalshArtQicial Intelligence 81 1996 5980 hard problems appear associated constraint gap In Fig 7b plot mean ratio constraint propagations splits random 244SAT N 100 The minimum mean ratio sum units pures splits 101 occurs LN 26 close position hardest worst case As CP depth search peaks region The peak minimum depth 98 LN 24 peak maximum depth 113 LN 28 It likely observe similar scaling constraint gap 244SAT observed CP 8 kcolourability Another way randomly generating SAT problems map random problems NPhard problem SAT For example kcolourability kCOL random graphs easily mapped SAT Given graph G kcolourability problem assign k labels vertex G adjacent vertices carry different labels For graph n vertices e edges encoding kCOL SAT uses II k variables We generate random graphs encode SAT choosing e edges n n 12 possible edges uniformly random We use n e denote graphs drawn class In Fig 8 plot breakdown percentiles number branches DP encodings 3colourability 1000 problems taken n e n 40 en 05 4 steps 01 The worst case 2905Oll branches en 16 en 24 point worst median performance worst case 4139 branches 3 orders magnitude smaller As random problem classes median problem difficulty shows simple easyhardeasy pattern kcolourability phase transition Very similar behaviour kcolourability observed Hogg Williams specialpurpose colouring algorithms 101 The constraint gap important feature 3COL problem classes satisfiability problems However pure literal deletions important previously Even en 04 number pure propagations split 38 n 40 compared peak 349 unit propagations split en 265 The number unit propagations split scale similarly n earlier cases CP 3SAT suggesting constraint gap important way understanding search In Fig 8b plot normalized values ratio unit propagations splits n 10 20 25 30 40 scaled Eq 2 values CY 24 CJ 3 The depth search peaks region extraordinarily hard problems 9 Critically constrained problems Crawford Auton 4 suggested hard problems satisfiability phase transition critically constrained That underconstrained guess models easily overconstrained 12 Gent T WalshArticial Intelligence 81 1996 5980 71 Parentage maximum value 2_4 0 1 2 3 4 en e In equivalent al n 25 percentile branches n 40 b constraint propagationssplits n 10 40 0 1 2 3 4 Fig 8 3COL problems yn e tested DP determine experiments experiments As unsatisfiability little search Such problems knife edge To test hypothesis ran series unsatisfiability satisfiability added deleted constraints hardest CP problems described Section 3 important aspects behaviour arise unsatisfiable problems We took behaviour unsatisfiable prob 100000 CP problems point mea delete 20 clauses random graph accounted point For comparison point delete 20 clauses random dotted line gives overall prob features First probability line Noise confirms problem satisfiable line gives unsatisfiable 81 examined Fig 9a dashed probability shown problems lems 100 hardest unsatisfiable sured This selection small number problems solid satisfiable ability satisfiability This graph interesting satisfiability critically 4 importantly straint gap typical unsatisfiable search cussion problems search arises precisely strained little ity constrained hard problems hardest unsatisfiable region problems unsatisfiable information problems Yet problems solve problems contain transition phase transition problems This phase hardest unsatisfiable problems significantly suggestion constrained Equally require values LN We defer detailed dis section large consistent critically satisfiable problems significantly precisely constrained ones critically problems help proving unsatisfiabil Satisfiable problems hard different particular search needed satisfiable critically satisfiable problems ones In unsatisfiable lead search hardest satisfiable problems values LN To test took 100 hardest 100000 point measured probability This suggests reductions subproblems constrained reasons early 12 IP Gent I WalshArtQicial Intelligence 81 1996 5980 Pmbsat Conditional Prob 1 _ _ _ _ ___ __ I 08 08_ Conditional Pmb L _ _ ______ __ _ 08_ 06_ 04_ 0Z 0 Pmbq 08 __ 06 04 02 0 delking X13clauses 4 b adding 2Rclauses5 Fig 9 CP 100 hardest unsatisfiablesatisfiable problems DP 100000 N 100 5 LN 2 unsatisfiable add 20 randomly generated CP clauses This shown Fig 9b dashed line For comparison solid line gives probability satisfiable problem point hardest 100 unsatis fiable add 20 randomly generated CP clauses For reference dotted line gives overall probability satisfiability It seen large LN satisfiable problems unusual effects noise worst satisfiable problems easier unsatisfiable typical problems This suggests hardest satisfiable problems critically constrained typical satisfiable problems The significant feature data largest discrepancy hardest satisfiable satisfiable problems LN 2 3 This consistent observation 8 hard satisfiable problems region arise incorrect choice branching point search leads hard unsatisfiable subproblem While unsatisfiable problems region hard critically constrained satisfiable problems rise hard unsatisfiable subproblems early stage search critically constrained Even problems significantly critically constrained satisfiable problems middle phase transition This helps explain hardest satisfiable problems solved quickly randomly different choices search showed 81 These graphs critically constrained problems occur suggested Crawford Auton middle satisfiability phase transition We add delete constraints problems region changing satisfiability By comparison hard unsatisfiable problems satisfiable region critically constrained delete constraints making satisfiable The hardest satisfiable problems hard In section argue whilst problems unsatisfiable middle satisfiability phase transition difficult critically satisfiable region difficult constrained uncritically constrained region critically constrained typical problems problem reduce early point search problems 1P Gent 1 WalshArtificial Intelligence 81 1996 5980 13 Pmquniquene5s Pmqsat 1 04 02 0 pro2babililyof uniqeLness b variables Fig 10 Minimal unsatisfiable subsets 100 hardest unsatisfiable CP problems N 100 5 LN 2 3 4 S LIN 10 Minimal unsatisfiable subsets In 81 showed hard problems satisfiable region hard unsatisfiable problems satisfiable problems rise hard unsatisfiable subproblems following incorrect split start search To explain difficulty problems satisfiable region focus unsatisfiable problems Since hard unsatisfiable problems satisfiable region critically constrained delete clauses making satisfiable This suggests hard unsatisfiable problems satisfiable region contain large number irrelevant clauses To test hypothesis computed minimal unsatisfiable subsets hardest unsatisfiable problems S minimal unsatisjiable subset T iff S c T S unsatisfiable exist R R c S R unsatisfiable To compute minimal unsatisfiable subset T deleted clause T turn adding deleting makes set clauses satisfiable Unfortunately computationally expensive compute minimal unsatisfiable subsets We determine computed minimal unsatisfiable subset unique S unique minimal unsatisfiable subset T iff S minimal unsatisfiable subset T sp E S T 4p satisfiable In Fig 10a value LN took 100 hardest unsatisfiable CP problems DP 100000 measured probability unique minimal unsatisfiable subset For reference dotted line gives probability satisfiability problems point In Fig 10b plot average number variables computed minimal unsatisfiable subset When unique minimal unsatisfiable subset method computation tend underestimate average number variables minimal unsatisfiable subsets ways computing small minimal unsatisfiable subset large Again reference dotted line gives probability satisfiability problems point A graph average number clauses minimal unsatisfiable subsets looks similar shape number variables minimal 14 IX Gent T WalshArtQicial Intelligence 81 1996 5980 unsatisfiable subsets The ratio clauses variables minimal unsatisfiable subsets increases slowly 115 LN 22 129 LN 46 The observed minimal unsatisfiable subsets typically dominated binary clauses especially small minimal unsatisfiable subsets observed small values LN As size minimal unsatisfiable subsets increase number nonbinary clauses increases accordingly average size clauses observed increased 205 LN 20 261 LN 46 These graphs hard unsatisfiable problems satisfiable region tend small unique minimal unsatisfiable subsets mention variables The difficulty solving problems irrelevancy DP waste time splitting irrelevant variables Because constraint gap constraint propagations follow split We unlikely simplify variables minimal unsatisfiable subset Only DP backtracked large number irrelevant variable assignments discover minimal unsatisfiable subset As minimal unsatisfiable subsets hard problems satisfiable region small mention variables short proofs This suggests computation performed DP logically speaking unnecessary It hard short proof heuristics constraint propagation identify minimal unsatisfiable subset large number irrelevant satisfiable clauses We likely long proofs containing large amounts unnecessary computation short proofs containing little unnecessary computation This explains 81 hard unsatisfiable problems satisfiable region short proofs proofs hard Note search strategy optimized short proofs example breadthfirst iterative deepening search ultimately help If length shortest proof minimal unsatisfiable subset 1 splits search space complete procedure like breadth search ON This polynomial I bounded Unfortunately minimal unsatisfiable subset small comparison L N increase size N hard identify The length shortest proof easily unbounded For example size minimal unsatisfiable subset E increase 0 fi OlogN These results help explain hard problems rarer satis liable region random 3SAT satisfiable regions CP random 244SAT CP random 244SAT problems contain large numbers binary clauses It difficult hide small unique minimal unsatisfiable subset large satisfiable CP random 244SAT problem By comparison clauses random 3SAT problem contain literals The minimal unsatisfiable subsets random 3SAT typically larger mention variables It difficult hide minimal unsatisfiable subset satisfiable random 3SAT problem In satisfiable region problem solving rare unsatisfiable problem identifying single minimal unsatisfiable subset Once usually easy solve However clues available identification On hand middle phase transition identification minimal 1R Gent T WalshArtQicial Intelligence 81 1996 5980 15 unsatisfiable subset important minimal unsatisfiable subsets comparatively large significantly easier problem Furthermore choice points search likely wasted splits contribute proof unsatisfiability seen large number variables minimal unsatisfiable subsets In satisfiable region bad choices double search time contribution deriving unsatisfiability unique minimal unsatisfiable subset To conclude hard unsatisfiable problems satisfiable region small unique minimal unsatisfiable subsets These minimal unsatisfiable subsets hidden larger random satisfiable problems It difficult minimal unsatisfiable subsets An analogy cryptography difficult identify short message hidden long stream white noise By comparison hard unsatisfiable problems middle satisfiability phase transition typically larger minimal unsatisfiable subsets unique 11 Binary constraints The minimal unsatisfiable subsets contain binary clauses reduce binary clauses variable assignment Since exists linear time al gorithm satisfiability binary clauses I problems containing minimal unsatisfiable subsets solved polynomial time We augmented DP following rule Binary unsatisfiable assign negation 1 True binary clauses 2 simplified literal 1 assigned True This rule nondeterministic choice literal affect number pure unit binary rules applied number splits branches We tested DP augmented binary rule lOOvariable CP problems The worst mean perfor mance 25 branches LN 34 order magnitude performance DP Note deduced run time reduced large overhead applying rule The binary rule able solve previously hard unsatisfiable problems variable region search For example tested 100 worst unsatisfiable lOOvariable problems 100000 CP problems tested LN 26 This point chosen bad performance worst cases middle constraint gap DP augmented Binary rule able solve 92 100 problems needing search That binary nearbinary clauses contained information prove unsatisfiability By contrast point worst median performance LN 39 43 100 worst problems solved search It seen terms reducing search augmenting DP Binary rule highly effective Nevertheless able eliminate extremely bad worstcase performance satisfiable region Of 8 76 IP Gent T WalshArtificial Intelligence 81 1996 5980 08 06 04 0 0 1 2 3 4 5 6 LN Fig 1 I CP problems tested DP intelligent backtracking N 300 worst 100 unsatisfiable problems solved trivially LN 26 required 6520 branches binary rule 2454 By contrast LN 39 worst 57 problems solved trivially needed 574 branches binary rule Furthermore binary rule able eliminate constraint gap The ratio applications binary rule splits broadly similar behaviour ratio units splits seen Fig 3b peaking comparatively large values LN The fact variable behaviour easy region problems eliminated Binary rule particularly significant This rule especially good candidate eliminate variable behaviour showed worst case problems associated minimal unsatisfiable subsets largely containing binary clauses Furthermore shown past 8 improved branching heuristics unable eliminate variable behaviour Thus better heuristics better constraint propagation able eliminate variable behaviour We implemented restricted version binary rule determines satisfiability binary clauses simplify literals Although restricted rule expensive appears little use reducing search CP N 100 2Np 3 closed 20 branches large LN 3 branches region constraint gap It little effect mean behaviour 12 Intelligent backtracking There ways try improve behaviour backtracking algorithms We improve quality branching choices increase work branch try decrease branching use information gained search improve quality backtracking Improved branching heuristics appear unable eliminate exceptionally hard problems 81 Also saw Section 11 improved constraint propagation branching points search appears unable eliminate constraint gap exceptionally hard I Gent T WalshArtQkial Intelligence 81 1996 5980 II problems This leaves open question intelligent backtracking rid difficult problems To test implementation DavisPutnam procedure written Mark Stickel uses form intelligent backtracking 3 When branch closes variable assignments contributed generation inconsistency recorded Backtracking jumps variable assignments irrelevant closing branch Such intelligent backtracking identify branching points irrelevant variables outside minimal unsatisfiable subset When succeeds dramatic reduction search achieved Intelligent backtracking greatly reduced number exceptionally hard problems small problem sizes However increasing problem size reappear At N 300 tested 10000 problems constant probability model 2Np 3 value LN 02 60 steps 02 additionally value 22 46 steps 005 investigate phase transition depth Fig 11 shows percentile contours results probability satisfiability The worst case observed saribe problem needed 1386500 branches LN 32 9014 problems soluble median behaviour 2 branches This orders magnitude worse worst median behaviour 12 branches LN 37 point worst case saw 16003 branches Further hard problems seen smaller values LN example unsatisfiable problem needed 48269 branches LN 27 9952 problems soluble It clear results rare exceptionally hard problems occur soluble easy region However worst cases occur slightly larger values LN clearly constraint gap The existence hard problems smaller values LN suggests constraint gap important To investigate extensive computational experiments required larger problem sample sizes Other forms intelligent backtracking possible dependency directed backtracking 151 Baker shown eliminate exceptionally hard problems underconstrained region 3COL lOOnode random graphs 21 However remains open question form intelligent backtracking eliminate hard problems problem sizes increase 13 Related work Phase transitions increasingly important study AI systems Huberman Hogg 121 predict largescale systems undergo sudden phase transitions affect computational performance They example simple model heuristic search changes linear exponential behaviour phase boundary Cheeseman et al 31 observed NPhard problems graph 3 This implementation lacks pure literal deletion rule This unlikely affect results qualitatively pure literal rule effective regions hard problems occur 78 1P Gent I WalshArtijiciai Intelligence 81 1996 5980 colouring Hamiltonian circuits control parameter phase transition underconstrained typically soluble problems overconstrained typically insoluble problems occurs critical values parameter hard problems occur critical value Williams Hogg 161 theoretical reasons solubility phase transition coincide peaks problem difficulty For random 3SAT CP Mitchell et al 141 demonstrated parameter LN ratio clauses variables median performance DP easy hardeasy pattern phase transition hardest median instance occurring phase transition Although noted mean influenced small number large values concentrated solely median felt appears informative statistic Our results suggest distribution values fact considerable importance understanding problem difficulty median provides somewhat incomplete picture Crawford Auton observed secondary peak mean problem difficulty tableau based procedure satisfiable region random 3SAT 4 However failed observe peak DP speculated probably artifact branching heuristics procedure In fact likely artifact statistics compiled number nodes search tree Obviously related depth search observed distinctive peak low LN CP Section 4 similar 3SAT Section 6 This account secondary peak report approximately 13 nodes N 50 It larger problems hundreds variables report occasional extremely hard behaviour In 8 able unusually hard problems occur low LN N 50 3SAT simplified variant DP requires large sample sizes seen For effect 3SAT studied larger problems larger sample sizes needed Hogg Williams observed extremely variable problem difficulty graph colouring backtracking algorithm based Berlaz heuristic heuristic repair algorithm lo They hardest colouring problems easy region graphs low connectivity The median search cost comparison shows usual easyhardeasy pattern colourability phase transition They propose hard problems associated transition polynomial exponential average search cost 14 Conclusions We performed detailed experimental investigation satisfiability phase transition different classes randomly generated problems including constant probability model random kSAT random mixed SAT encoding kCOL SAT With problem class median problem difficulty Davis Putnam procedure displays easyhardeasy pattern hardest problems associated satisfiability phase transition We shown I Gent 7I WalshArtificial Intelligence 81 1996 5980 19 behaviour inadequate features picture easyhardeasy conventional tion problem difficulties important problem classes region variable problem difficulty problems typically underconstrained lems orders magnitude These extraordinarily minimum constraint sistent problem variables distribu regions prob transition associated constraint gap splits The position shape phase size For example occur fixed ratios constraints satisfiable Within harder hard problems ratio constraint propagations problems appear middle phase gap satisfiability remarkably In particular transition We shown hardest problems typical unsatisfiable constrained variable subset The difficulty transition typical problems By comparison ent reasons The hardest unsatisfiable critically able problems unsatisfiable minimal unsatisfiable constraint unsatisfiable search space search hand hard satisfiable problems constrained early stage search leads unsatisfiable unsatisfiable unsatisfiable problems subset subset propagations time exponential solving critically constrained satisfiable unsatisfiable hard problems middle satisfiability phase region arise differ region actually hardest unsatisfi region contain small unique minimal variable variable problems problems Indeed problems irrelevant clauses All branching points identifying subset represent entirely wasted work As branching point doubles search affect variable minimal number irrelevant choices On variable region critically like hard small unique minimal subproblem behaves region contains typical satisfiable problems As result incorrect assignment large number binary clauses variable assignment hardest unsatisfiable problems away probability small minimal unsatisfiable unsatisfiable solving identifying The difficulty phase transition constraint gap greatly hinders ability Despite fact minimal reduce addition rule binary constraints shown The fact heuristically eliminate behaviour class It remains possible exceptionally backtracking Given DavisPutnam reduces eliminate procedure improved branching heuristics eliminate nonheuristically likely able problem backtracking eliminate hard problems constraint gap Our results form intelligent tentatively form intelligent based improvements suggest fundamental suggests minimal unsatisfiable subset The existence subsets subsets contain binary clauses propagate binary near variable behaviour We behaviour range problem classes experiments believe SAT problem classes NPhard problems The identification factors results generalize transitions gap help useful empirically understanding instances NPcomplete testing improving problem algorithms fine NPhardness phase like constraint like SAT hard theoretically 80 IP Gent 7 WalshArtcial Intelligence 81 1996 5980 Acknowledgements This author supported SERC Postdoctoral Fellowship second HCM Postdoctoral fellowship Part research conducted whilst second author INRIALorraine Nancy France We thank Alan Bundy Pierre Lescanne members Mathematical Reasoning Group Edinburgh supported SERC grant GRH 23610 Eureca group INRIALorraine constructive comments CPU cycles We thank Mark Stickel implementation kindly gave Finally thank Alan Bundy Paul Purdom referee journal comments improved paper References I I I B Aspvall MF Plass RE Tarjan A lineartime algorithm testing truth certain quantified Boolean formulas Inform Process Lett 8 1979 121123 2 I AB Baker Personal communication 1995 31 P Cheeseman B Kanefsky WM Taylor Where hard problems Proceedings NCAI91 Sydney Australia 1991 331337 4 JM Crawford LD Auton Experimental results crossover point satisfiability problems Proceedings AAAI93 Washington DC 1993 2127 15 1 M Davis G Logemann D Loveland A machine program theoremproving Commun ACM 5 1962 394397 16 1 M Davis H Putnam A computing procedure quantification theory J ACM 7 1960 201215 17 1 0 Dubois P Andre Y Boutkhad J Carher SAT versus UNSAT Presented Second DIMACS Challenge Workshop 1993 18 1 1P Gent T Walsh Easy problems hard ArtijI Intell 70 1994 335345 191 1P Gent T Walsh The SAT phase transition AG Cohn ed Proceedings ECAI94 Amsterdam Wiley New York 1994 105109 IO T Hogg C Williams The hardest constraint problems A double phase transition Artif Intell 69 1994 359377 1 11 1 JN Hooker C Fedjki Branchandcut solution inference problems propositional logic Ann Math Art fntell 1 1990 123139 1121 BA Huberman T Hogg Phase transitions artificial intelligence systems Artif Intell 33 1987 155171 I 13 1 S Kirkpatrick G Gyiirgyi N Tishby L Troyansky The statistical mechanics ksatisfaction JD Cowan G Tesauro J Alspector eds Advances Neural Information Processing Systems 6 Morgan Kaufmann San Mateo CA 1994 439446 14 1 D Mitchell B Selman HJ Levesque Hard easy distributions SAT problems Proceedings AAAI92 San Jose CA AAAl PressThe MIT Press 1992 459465 1 IS I RM Stallman GJ Sussman Forward reasoning dependencydirected backtracking computeraided circuit analysis Artif InteN 9 1977 135196 I I6 I CP Williams T Hogg Exploiting deep structure constraint problems Artif Intell 70 1994 73l 17