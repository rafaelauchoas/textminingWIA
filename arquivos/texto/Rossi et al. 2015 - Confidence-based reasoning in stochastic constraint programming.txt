Artiﬁcial Intelligence 228 2015 129152 Contents lists available ScienceDirect Artiﬁcial Intelligence wwwelseviercomlocateartint Conﬁdencebased reasoning stochastic constraint programming Roberto Rossi Business School University Edinburgh United Kingdom b Department Computer Science Taif University Taif Saudi Arabia c Department Management Cankaya University Ankara Turkey d Insight Centre Data Analytics University College Cork Ireland Brahim Hnich b S Armagan Tarim cd1 Steven Prestwich d1 r t c l e n f o b s t r c t Article history Received 7 November 2014 Received revised form 5 July 2015 Accepted 8 July 2015 Available online 15 July 2015 Keywords Conﬁdencebased reasoning Stochastic constraint programming Sampled SCSP α ϑsolution α ϑsolution set Conﬁdence interval analysis Global chance constraint 1 Introduction In work introduce novel approach based sampling ﬁnding assignments likely solutions stochastic constraint satisfaction problems constraint optimisation problems Our approach reduces size original problem analysed solving reduced problem given conﬁdence probability obtain assignments satisfy chance constraints original model prescribed error tolerance thresholds To achieve blend concepts stochastic constraint programming statistics We discuss exact approximate variants method The framework introduce immediately employed concert existing approaches solving stochastic constraint programs A thorough computational study number stochastic combinatorial optimisation problems demonstrates effectiveness approach 2015 Elsevier BV All rights reserved The stochastic constraint satisfactionoptimisation framework introduced 23 constitutes expressive declarative formalism modelling problems decision making uncertainty A stochastic constraint satisfaction problem SCSP alongside decision variables features random variables follow probability distribution model uncertainty Relationships subsets random decision variables expressed declarative manner stochastic constraints The fact given relationship subsets random decision variables satisﬁed according prescribed probability expressed means chance constraints Finally problems decision making uncertainly sequential nature modeller deﬁne stage structure sequence decision stages subset possible decisions taken subset possible random variables observed A solution SCSP represented general means policy tree records feasible optimal decisions associated possible set random variable realisations This work extended version 1 Corresponding author Business School University Edinburgh 29 Buccleuch place EH8 9JS Edinburgh UK Tel 44 0131 6515239 fax 44 0131 650 8077 Email addresses robertorossiedacuk R Rossi hnichbrahimgmailcom B Hnich armtaryahoocom SA Tarim sprestwichcsuccie S Prestwich 1 This publication emanated research supported research grant Science Foundation Ireland SFI Grant Number SFI12RC2289 httpdxdoiorg101016jartint201507004 00043702 2015 Elsevier BV All rights reserved 130 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 As shown 3 Theorem 1 solving SCSPs computationally hard task Even trivial instances dozen decision random variables require computational effort reach advanced hardwaresoftware combina tion This fact size policy tree grows exponentially number random variables model size support Furthermore major limitation existing complete SCSPs solution methods 3 4 fact assume support random variables ﬁnite solution expressed ﬁnite policy tree In practice case random variables range continu ous supports large number possibly inﬁnite values domain To date general purpose method exists solving largescale SCSPs SCSPs featuring random variables continuous discrete inﬁnite support sake brevity shall class SCSPs inﬁnite SCSPs The main contribution paper propose framework solving largescale inﬁnite SCSPs More speciﬁcally argue solving largescale inﬁnite SCSPs consider ultimate feasibleoptimal solution cases impossible represent decision maker aim solution suﬃ ciently trusts claim optimal feasible given conﬁdence level certain degree error tolerated In order obtain solution decision maker look possibly limited number samples drawn random variables model In words try estimate quality solution Our approach analogies established techniques statistics When survey conducted sample population electoral poll statistician typically associates certain conﬁdence level results obtained chosen sample population For instance claim 90 chance actual mean estimated given interval We argue approach adopted stochastic decision making If inﬁnite largescale mstage SCSP admit closed form solution complex rule chance obtaining exact solution suggest statistics introduce conﬁdence level α tolerated estimation error ϑ The decision maker instead looking exact solution aim estimate according chosen α ϑ actual satisfaction probability guaranteed assignment greater equal given target value chance constraints model By choosing given values α ϑ set solutions vary For reason introduce new notion solution parameterised parameters α ϑsolution Intuitively α tends 1 ϑ tends 0 set α ϑsolutions converge set actual solutions original stochastic constraint satisfaction problem rename 1 0solutions One note approach kind recently advocated 5 Chap 4 In work following contributions stochastic constraint programming literature discuss obtain compact instances inﬁnite largescale stochastic constraint programs sampling instances sampled SCSPs introduce concepts α ϑsolution α ϑsolution set compute priori mini mum sample size guarantees attainment classes solutions tools employed order ﬁnd approximate solutions inﬁnite largescale stochas tic constraint satisfactionoptimisation problems solved existing exact approaches stochastic constraint programming literature conduct thorough computational study wellknown stochastic combinatorial problems validate theoretical framework assess effectiveness eﬃciency scalability This work structured follows Section 2 introduce relevant formal background constraint programming stochastic constraint programming conﬁdence interval analysis Section 3 introduce sampled SCSPs Section 4 discuss properties solutions sampled SCSPs formally introduce α ϑsolutions Section 5 introduce α ϑsolution sets Section 6 extend discussion stochastic constraint optimisation problems Section 7 discuss connections established techniques statistics Section 8 present computational study Section 9 discuss related works ﬁnally Section 10 draw conclusions discuss future research directions 2 Formal background We introduce relevant background constraint programming stochastic constraint programming conﬁ dence interval analysis 21 Constraint programming A Constraint Satisfaction Problem CSP 6 consists set decision variables ﬁnite domain values set constraints specifying allowed combinations values variables A solution CSP assignment variables values respective domains constraints satisﬁed Constraint solvers typically explore partial assignments enforcing local consistency property A constraint c generalised arc consistent GAC variable assigned values domain exist compatible values domains R Rossi et al Artiﬁcial Intelligence 228 2015 129152 131 variables c In order enforce local consistency property constraint c search employ ﬁltering algorithms remove inconsistent values domains variables c These ﬁltering algorithms repeatedly called values pruned This process called constraint propagation 22 Stochastic constraint programming The following deﬁnitions based 47 An mstage stochastic constraint satisfaction problem SCSP 2 7tuple cid3V S D P C β Lcid4 V set decision variables S set random variables D function mapping element V respectively S domain respectively support potential values In classical SCSPs decision variable domains random variable supports assumed ﬁnite P function mapping element S probability distribution associated support To discussion focused loss generality assume probability distribution inﬂuenced decisions extensions SCP framework deal decisiondependent probabilities discussed 8 C set constraints nonempty subset decision variables subset random variables If constraint constrains decision variables deterministic constraint constrains decision random variables stochastic constraint β function mapping stochastic constraint h C βh threshold value interval 0 1 If threshold strictly 1 stochastic constraint chance constraint L cid3V 1 S1cid4 cid3V S icid4 cid3V m Smcid4 list decision stages V V S S V form partition V S form partition S To solve mstage SCSP assignment variables V 1 given random values S1 assignments V 2 given random values S2 assignments V m given random values Sm deterministic constraints satisﬁed stochastic constraints satisﬁed fraction possible scenarios speciﬁed function β Under assumption random variable supports ﬁnite solution mstage SCSP general represented means policy tree 3 The arcs policy tree represent values observed random variables nodes level represent decisions associated different stages We policy tree mstage SCSP solution satisfying policy tree Let S denote space policy trees solutions SCSP We interested ﬁnding policy tree s S maximises value given objective function f subset stochastic variables nonempty subset decision variables A stochastic constraint optimisation problem SCOP deﬁned general maxsS f s In order simplify presentation assume loss generality V xi S si singleton sets All results easily extended order consider V 1 S 1 4 Intuitively S comprises random variable possible aggregate variables single multivariate random variable 9 convolving If V comprises decision variable following discussion term decision variable interpreted set decision variables Let S s1 s2 sm set random variables V x1 x2 xm set decision variables cid2 Let p path root node policy tree leaf Let cid5 denote set distinct paths policy tree For p cid5 denote arcsp sequence arcs p nodesp denotes sequence nodes p We denote cid6 arcspp cid5 set scenarios policy tree The probability ω cid6 given i1 Prsi sisi1 si1 s1 s1 Prsi sisi1 si1 s1 s1 probability random Prω variable si takes value si given set realisations random variables si1 s1 observed Now consider constraint h C speciﬁed threshold level βh Consider policy tree T SCSP path p T Let hp deterministic constraint obtained substituting random variables h corresponding values si assigned random variables arcsp Let hp resulting tuple obtained substituting decision variables hp values xi assigned corresponding decision variables nodesp We h satisﬁed wrt given policy tree T iff m cid3 Prarcsp β h pcid5hphp Deﬁnition 1 Given mstage SCSP P policy tree T T satisfying policy tree P iff constraint P satisﬁed wrt T Example 1 Let consider twostage SCSP Fig 2 stage structure L cid3V 1 S1cid4 cid3V 2 S2cid4 V 1 x1 S1 s1 V 2 x2 S2 s2 Random variable s1 possible values 5 4 probability 05 random variable s2 possible values 3 4 probability 05 The domain x1 1 4 domain x2 3 6 There chance constraints2 C Prc1 s1x1 s2x2 30 075 Prc2 s2x1 12 05 In case decision variable x1 set unique value random variables observed decision variable x2 takes value depends observed value random variable s1 A possible solution 2 In follows convenience denote chance constraint notation Prcid3conscid4 β meaning constraint cid3conscid4 constraining decision random variables satisﬁed probability greater equal β 132 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 Fig 1 Policy tree SCSP Example 1 Constraints 1 Prs1x1 s2x2 30 075 2 Prs2x1 12 05 Decision variables x1 1 2 3 4 x2 3 4 5 6 Random variables s1 405 505 s1 305 405 Stage structure V 1 x1 V 2 x2 L cid3V 1 S1cid4 cid3V 2 S2cid4 S1 s1 S2 s2 Fig 2 The twostage SCSP Example 1 SCSP satisfying policy tree shown Fig 1 x1 3 x1 2 decision variable x2 random variable s1 takes value 5 x2 variable s1 takes value 4 4 x2 2 6 x1 2 value assigned 2 value assigned decision variable x2 random As Example 1 shows solution SCSP simply assignment decision variables values instead satisfying policy tree It worth noting asking individual constraints satisﬁed according probability thresholds different asking conjunction constraints satisﬁed according prescribed probability threshold Informally speaking Example 1 simply state c1 s1x1 s2x2 30 hold true probability β1 075 75 scenarios If c2 s2x1 12 holds true scenarios matter concern long c2 holds true 50 scenarios necessarily c1 holds true Essentially Example 1 state conjunction c3 s1x1 s2x2 30 s2x1 12 If want state conjunction need post speciﬁc chance constraint c3 satisfaction threshold β3 Assuming β3 05 instance require conjunction c3 hold true 50 scenarios Prc3 s1x1 s2x2 30 s2x1 12 05 Incidentally policy tree presented Fig 1 satisﬁes constraint A practical example clariﬁes discussion inventory control It customary inventory control problems enforce service level constraints PrIt 0 α t 1 N N represents length planning horizon It inventory level end period t The set constraints means probability stocking given period 1 α regardless happens periods A restrictive service level requirement Ncid4 Pr t1 It 0 α This restriction means probability stocking N periods 1 α R Rossi et al Artiﬁcial Intelligence 228 2015 129152 133 23 Conﬁdence interval analysis Conﬁdence interval analysis established technique statistics Informally conﬁdence intervals useful tool computing given set experimental results range values certain conﬁdence level conﬁdence probability cover actual value parameter estimated Consider discrete random variable follows Bernoulli distribution Accordingly variable produce outcomes yes probability q 1 q respectively Let assume value q yes probability unknown Obviously observe outcome Bernoulli trial data collected reveal value q Nevertheless practice interested estimating q repeatedly observing behaviour random variable sequence Bernoulli trials This problem wellknown statistics exact approximate techniques available performing estimation 1011 The estimation produced methods available literature typically come point estimate consists interval values computed set representative samples quantity estimated This interval known conﬁdence interval consists range values certain conﬁdence probability α covers actual value parameter estimated A method commonly classiﬁed exact conﬁdence intervals Binomial distribution intro duced Clopper Pearson 10 This method uses Binomial cumulative distribution function CDF order build interval data observed The ClopperPearson interval symmetric twosided conﬁdence interval It expressed singlesided interval ClopperPearson singlesided intervals written plb 1 0 pub plb minq PrbinN q X 1 α pub maxq PrbinN q X 1 α X number successes yes events observed sample binN q binomial random variable N trials probability success q α conﬁdence probability Note assume plb 0 X 0 pub 1 X N Because close relationship Binomial distribution Beta distribution ClopperPearson interval presented alternative format uses percentiles beta distribution 12 plb 1 beta pub 1 beta 1α N X 1 X 11 α N X X 1 beta 1 denotes inverse Beta distribution This form eﬃciently evaluated existing algorithms An interesting property conﬁdence intervals related estimation success probability associated Bernoulli trial consists fact given conﬁdence probability possible derive mathematically performing worst case analysis minimum number samples observed order produce conﬁdence interval given size Therefore given conﬁdence probability α possible determine minimum number samples considered order achieve margin error ϑ estimation success probability Bernoulli trial This computation plays central role novel approach In fact intuitively estimating satisfaction probability chance constraint equivalent estimating success probability associated Bernoulli trial 3 Sampled SCSPs Consider SCSP P set S stochastic variables Assume stochastic variables deﬁned continuous supports discrete supports comprising large inﬁnite number values Solving original SCSP clearly poses hard combinatorial challenge fact policy tree comprises number scenarios exponential size stochastic variable domains Since policy tree comprise inﬁnite number scenarios computational problem undecidable general In section discuss sample compact SCSP comprises N scenarios original problem We shall new problem cid5PN sampled SCSP N scenarios Intuitively sampled SCSP reduced version original problem solution policy tree comprises bounded number paths sampled original policy tree In following sections discuss conditions solution sampled SCSP cid5PN according certain conﬁdence probability prescribed error tolerance thresholds likely solution original SCSP P We shall discuss employ Simple Random Sampling 13 obtain sampled SCSP original prob lem Of course advanced stratiﬁed sampling techniques order reduce variance improve effectiveness approach Nevertheless large number topics covered work leave discussion future work Consider complete realisation s1 sm stochastic variables S obtained sampling value support Dsi stochastic variables si S according probability distribution P si From deﬁnition 134 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 Fig 3 Reduced policy tree sampled SCSP Example 2 dashed arcs observed sample policy tree clear exists path associated realisation In words realisation corresponds scenarios comprised policy tree Generate N independent sets random variable realisations s1 1 s1 m s2 1 s2 m sN 1 sN m si realised value random variable j observed ith set realisations Recall T denotes j complete possibly inﬁnite policy tree P Let reduced policy tree cid5T P policy tree comprises arc labellings observed N complete realisations repetitions Let cid5cid5 denote reduced set distinct paths cid5T The probability associated path p cid5cid5 Prarcsp simply set equal frequency occurrence path N realisations Of course cid5T represents policy tree different SCSP started We new problem sampled SCSP cid5PN Now consider chance constraint h C speciﬁed threshold level βh policy tree cid5T sampled SCSP cid5PN path p T We h satisﬁed wrt given policy tree cid5T iff cid3 Prarcsp β h pcid5cid5hphp Example 2 Let consider twostage SCSP P discussed Example 1 We set N 3 derive sampled SCSP cid5PN By simple random sampling draw following complete realisations random variables P s1 1 4 s2 2 5 s1 2 5 s3 2 4 s2 1 4 s3 1 4 A possible solution sampled SCSP cid5PN satisfying policy tree shown Fig 3 x1 3 x1 6 4 x2 2 x1 2 value assigned decision variable x2 stochastic variable s1 takes value 5 x2 2 value assigned decision variable x2 stochastic variable s1 takes value 4 The policy tree paths sampled original tree p1 associated probability 23 observed occurrences scenario associated path 3 complete realisations sampled random variables p2 associated probability 13 observed single occurrence scenario associated path 3 complete realisations sampled random variables Paths observed sampled realisations associated probability equal zero considered 2 It noted policy tree cid5T sampled SCSP cid5P employed partial policy tree original SCSP P Nevertheless sampling lose completeness If stage P observe given random variable realised value comprised cid5T course impossible determine correct decisions subsequent stages By taking conservative point view means paths corresponding subtree satisﬁed In multistage SCSPs especially including random variables continuous support prevents direct use approach discussed work In fact random variable supports continuous inﬁnitesimal probability observing given set realisations In case essential adopt rolling horizon approach 14 order reduce original multistage SCSPs sequence multistage sampled SCSPs Under strategy aim ﬁx decisions stage sure compatible values exist decision variables appear subsequent stages cid5T Future decisions ﬁxed observing realised values random variables stage problem solved taking account new available information decision variables previously associated stage stage decisions The original problem reduced sequence multistage sampled SCSPs We apply technique handle twostage problem discussed Section 82 stochastic multiprocessor scheduling problem release time deadlines R Rossi et al Artiﬁcial Intelligence 228 2015 129152 135 4 α ϑ solutions We characterise probability solution sampled SCSPs cid5PN N scenarios computed existing approaches discussed 34 solution original singlestage SCSP P These results applicable multistage problems provided rolling horizon approach adopted aim characterise probability stage decisions sampled SCSPs cid5PN N scenarios consistent respect original SCSP P We ﬁrstly discuss compute N given policy tree T satisﬁes chance constraint h sampled SCSPs cid5PN satisﬁes chance constraint original SCSP P probability α Since policy tree T cid5PN deﬁnition comprises subset cid5cid5 paths constitute policy tree original SCSP P policy tree order satisfy h original SCSP P clearly provide suﬃcient satisfaction probability regardless scenarios ignored sampling process Consider conﬁdence probability α margin error ϑ The number scenarios N sampled SCSP depends ϑ α β recall target satisfaction probability chance constraint h Deﬁnition 2 N computed minimum value β β p β lb ϑ maxp β ub β lb p p roundβ N successes N trials round approximates value nearest integer3 β ub singlesided ClopperPearson conﬁdence interval bounds conﬁdence probability α Deﬁnition 3 Any policy tree T proved satisfy h P probability α satisﬁes h P probability α satisﬁes h cid5PN Conversely policy tree T proved satisfy h P probability α satisfy h P probability α satisfy h cid5PN Proposition 1 A policy tree T proved satisfy h P probability α actual satisfaction probability δ β provided T T wrt h δ p proved satisfy h P probability α ub Conversely actual satisfaction probability δ β provided T wrt h δ p β lb β β ub Since p β ub maxq PrbinN q roundβ N 1 α clear PrbinN δ roundβ N 1 α Proof Let δ p This means cid3 Pr pcid5cid5hphp Prarcsp β 1 α recall cid5cid5 set paths sampled SCSP cid5PN This implies cid3 Pr pcid5cid5hphp Prarcsp β α Therefore test cid3 Prarcsp β pcid5cid5hphp policy tree T proved satisfy h P probability α β lb Conversely let δ p β lb Since p minq PrbinN q roundβ N 1 α clear PrbinN δ roundβ N 1 α This means cid3 Pr pcid5cid5hphp Prarcsp β 1 α 3 This justiﬁed fact ClopperPearson interval fact step function 10 p 405 Binomial discrete probability distribution 136 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 Fig 4 Probability density function convolution independently nonidentically distributed uniform random variables r1 r2 implies cid3 Pr pcid5cid5hphp Prarcsp β α Therefore test cid3 Prarcsp β pcid5cid5hphp policy tree T proved satisfy h P probability α cid2 Proposition 2 Any policy tree T provides satisfaction probability δ β ϑ wrt h P proved satisfy h P probability α Any policy tree T provides satisfaction probability δ β ϑ wrt h P proved satisfy h P probability α Proof This directly follows Deﬁnition 2 Proposition 1 cid2 Proposition 3 Any policy tree T proved satisfy satisfy h P probability α proved satisfy h P probability γ γ probability ranging 05 α satisﬁes h cid5PN satisfy h P probability γ γ probability ranging 05 α satisﬁes h cid5PN Proof Consider limiting cases The actual satisfaction probability δ provided T wrt h P exactly equal β Since sample mean estimate satisfaction probability N samples considered unbiased estimator δ overestimate β probability 05 similarly underestimate β probability 05 sets lower bound γ ii The actual satisfaction probability δ provided T wrt h P exactly equal β ϑ From proof Proposition 1 immediately follows case γ α δ β ϑ γ α sets upper bound γ cid2 Deﬁnition 4 An α ϑsolution SCSP P policy tree cid5T probability α provides chance constraint hi P satisfaction threshold βi satisfaction probability greater equal βi ϑ It apparent ϑ interpreted parameter user set order deﬁne region indifference β ϑ satisfaction probability In region assume assignments safely misclassiﬁed probability greater α satisfaction probabilities remain acceptable range Example 3 Consider singlestage SCSP P cid3V S D P C β Lcid4 V X1 X2 S r1 r2 D X1 D X2 0 1 Dr1 0 100 P r1 uniform0 100 Dr2 0 300 P r2 uniform0 300 C c C1 X1r1 X2r2 βc 05 L cid3V Scid4 C1 185 constant This problem comprises random variables deﬁned continuous sup port solved existing complete approaches SCSPs If set α 095 ϑ 005 Deﬁnition 2 compute number samples N 290 required guarantee solution sampled SCSP cid5P N samples α ϑsolution P Furthermore simple structure constraint c considered P allows perform analysis Con sider assignment X1 1 X2 1 A simple reasoning convolution independently nonidentically distributed uniform random variables 15 immediately suggests assignment inconsistent r1 r2 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 137 Fig 5 Feasible region SCSP Example 1 dashed line denotes true boundary constraint c The upper solid line demarcates set solutions providing satisfaction probability β ϑ lower solid line demarcate set solutions providing satisfaction probability β ϑ independently nonidentically distributed uniform random variables The distribution results convo lution shown Fig 4 This distribution shaped like trapezoid Clearly area ﬁgure equal 1 area rectangle triangles trapezoid equal 16 Consequently area internal rectangle equal 23 It easy cumulative distribution function value 15100 005 045 quantile inverse cumulative distribution 200 returns probability 05 Then 13 function results convolving r1 r2 exactly equal C1 185 Therefore satisfaction probability provided assignment X1 1 X2 1 equal βc ϑ 045 Fig 5 assignment correctly classiﬁed inconsistent probability α sample size set N 290 Let h1 hk k chance constraints SCSP P Let cid5P sampled SCSP N samples N number samples required guarantee conﬁdence level α error tolerance threshold ϑ constraint hi considered independently according Deﬁnition 2 Proposition 4 Let cid5T policy tree solution cid5P Then cid5T α ϑsolution P Proof Consider chance constraint hi Let βi respective satisfaction threshold By deﬁnition probability solution cid5T cid5P provides service level equal βi ϑ hi P equal 1 α Therefore cid5T α ϑsolution Now consider pair chance constraints cid3hi h jcid4 satisfaction thresholds βi β j respectively The probability pi j solution cid5T cid5P provides service level equal βi ϑ hi β j ϑ h j P equal 1 α2 fact misclassify constraints order accept solution Even single constraint correctly classiﬁed cid5T inconsistent wrt cid5P The case constraints misclassiﬁed independently represents worstcase reasoning If constraints perfectly positively correlated misclassiﬁed constraints misclassiﬁed pi j 1 α constraints perfectly negatively correlated misclassiﬁed constraint misclassiﬁed pi j 0 This reasoning gener alised k chance constraints probability 1 αk Noting 1 αk 1 α2 1 α 1 1 αk α probability 1 α solution misclassiﬁed model comprising single constraint represents upper bound probability solution cid5T cid5P provide satisfaction probability required tolerance threshold constraints generic model P By rephrasing probability solution cid5T provides satisfaction probability greater equal βi ϑ constraint hi greater equal α Hence Deﬁnition 4 cid5T α ϑsolution P cid2 5 α ϑ solution set Consider policy tree T chance constraint h indicator random variable cid14 cid13 1 pcid5cid5hphp Prarcsp β 0 τ representing test discussed Deﬁnition 3 If actual satisfaction probability δ provided policy tree T respect constraint h P exactly equal β ϑ τ takes value 1 probability 1 α To motivate following discussion introduce following example 138 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 Example 4 Consider Example 3 assume D X1 D X2 0 5 decision variables deﬁned continuous domains spanning 0 5 Assignments X1 41 X2 0 X1 0 X2 137 lie upper solid line shown Fig 5 Each assignments provides satisfaction probability exactly β ϑ respect constraint c original problem P From discussion Section 4 follows assignments recognised infeasible probability α N 290 However r1 r1 independent probability assignments recognised infeasible α2 We discuss address issue correctly classifying multiple policy trees according prescribed conﬁdence level α We introduce following deﬁnition Deﬁnition 5 An α ϑsolution set SCSP P set policy trees All policy trees set simultaneously provide probability α satisfaction probability greater equal βi ϑ chance constraint hi P satisfaction threshold βi Consider SCSP T policy trees T1 TT actual satisfaction probability δ respect h P equal β ϑ Let τ1 τT associated random variables according Proposition 4 takes value 1 probability equal 1 α Although fully characterised marginal probability distribution test τi involving single policy tree Ti characterised joint probability tests carried set T policy trees Proposition 5 The probability τ1 τT equal 0 1 T 1 α Proof A worstcase reasoning carried considering case events τi 1 τ j 1 mutually exclusive j 1 T cid11 j course true Prτi 1 Prτ j 1 1 α The probability τ1 τT equal 0 easily seen 1 T 1 α If events mutually exclusive probability greater equal 1 T 1 α case T independent tests 1 1 αT 1 T 1 α cid2 Of course possible know value T priori require solving SCSP However given chance constraint h T clearly equal cardinality Ah assignment space constrained h Ah computed cartesian product domains decision variables policy tree constrained h Since property discussed Proposition 5 applies chance constraint h C compute α ϑsolution set introduce following Bonferronis correction 16 free correlation distribution assumptions computing N Deﬁnition 6 N computed minimum value maxp β ub β β p β lb ϑ p ub singlesided ClopperPearson conﬁdence interval bounds conﬁdence probability cid5α β β lb p cid5α 1 1 αcid14 hC Ah roundβ N successes N trials Proposition 6 A set policy trees solutions cid5P sample size N computed discussed Deﬁnition 6 α ϑsolution set P Proof Bonferronis correction introduced Deﬁnition 6 ensures chance constraint h C probability τ1 τT equal 0 simultaneously α cid2 βc2 Example 5 Consider following SCSP P cid3V S D P C βc Lcid4 V X1 X2 S r1 r2 D X1 D X2 0 001 002 2499 25 Dr1 0 10 P r1 uniform0 10 Dr2 0 30 P r2 uniform0 30 Dr3 0 15 P r3 uniform0 15 Dr4 0 20 P r2 uniform0 20 C c1 C1 X1r1 X2r2 c2 C2 X1r3 X2r4 07 L cid3V Scid4 C1 245 C2 215 constants We set α 09 ϑ 005 We computed ana βc1 lytically true boundaries c1 c2 1517 denoted dashed line Figs 6 7 We computed conﬁdence bands dashed lines The upper conﬁdence band set solutions provide satisfaction probability exactly βi ϑ lower conﬁdence band set solutions provide satisfaction probability exactly βi ϑ We apply Deﬁnition 6 compute number samples N 2848 required obtain α ϑsolution set P shown Fig 6 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 139 Fig 6 An α ϑsolution set Example 5 computed N 2848 samples Fig 7 An approximate α ϑsolution set Example 6 computed N 348 samples 51 Approximating α ϑ solution sets Bonferronis correction known conservative In particular seen correction assumes events τi 1 τ j 1 mutually exclusive j 1 T cid11 j In words assuming assignment misclassi ﬁcations mutually exclusive In practice SCSP sets assignments misclassiﬁed depending random variables realisations For reason correction introduced Deﬁnition 6 generally conservative lead sample size larger strictly needed obtain α ϑsolution set This fact known statistics number adjusted corrections proposed account correlated errors 1819 In follows shall adopt conservative approximate correction strategy To best knowl edge similar correction discussed literature In computational study Section 8 demonstrate effectiveness technique Of course investigation conservative possibly exact correction strategies ideally borrowed established results statistics interesting direction future research Consider general case constraint h constrains m random variables S Lemma 1 Given realisations s1 1 s2 m kth set realisations τi deterministic test 1 s1 s2 m sN 1 sN m sk j realised value random variable j observed Proposition 7 τi function random variables s1 sm N Proof Immediately follows Lemma 1 fact s1 j sN j N iid random variables cid2 Proposition 8 The probability τ1 τT takes value 1 uniquely determined probability distributions s1 sm number samples N Proof Follows deﬁnition τ Lemma 1 Proposition 7 cid2 140 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 In practice means assignment misclassiﬁcations sampled SCSP events τi 1 τ j 1 depend alisations random variables s1 sm note m generally smaller T Since multivariate random variable τ1 τT deterministic function multivariate random variable s1 sm N Propo sition 7 previous section fully characterised marginal probability distribution test τi probability τ1 τT equal 0 approximately bounded 1 m1 α correct m mutually exclusive misclassiﬁcations induced random variables s1 sm assume remaining misclassiﬁcations depend Once introduce correction chance constraint h C Let mh number random variables constrained h compute approximate α ϑsolution set introduce following correction computing N Deﬁnition 7 N computed minimum value maxp β ub β β p β lb ϑ p ub singlesided ClopperPearson conﬁdence interval bounds conﬁdence probability cid5α β β lb p cid5α 1 1 αcid14 hC mh roundβ N successes N trials A set policy trees solutions cid5P sample size N computed discussed Deﬁnition 7 approximate α ϑsolution set P Example 6 Consider SCSP Example 5 We apply Deﬁnition 7 compute number samples N 348 required obtain approximate α ϑsolution set P shown Fig 7 note constraints constrains random variables To assess quality approximation generated 1000 different instances analytically inspected α ϑsolution set generated fully contained upper conﬁdence band Fig 7 result simulation study revealed α ϑsolution set fully contained upper conﬁdence band probability 0894 095 conﬁdence interval 0873 0912 misclassi ﬁcation rate line prescribed α Finally worth noting random boundary α ϑsolution set remains channel identiﬁed solid conﬁdence bands probability 1 21 α 6 Stochastic constraint optimisation problems The concepts introduced Sections 4 5 employed approximate optimal solutions sampled SCOPs In setting distinguish possible cases case objective function deterministic objective function stochastic If objective function deterministic possible exploit results Section 5 obtain conﬁdence interval costproﬁt optimal plan Without loss generality discuss case aim maximise deterministic objective function f decision variables V Consider SCOP P cid3V S D P C βc L f cid4 Choose α ϑ construct new SCOPs Plb cid3V S D P C β 1 c L f cid4 c C β 1 c βc ϑ Pub cid3V S D P C β 2 c L f cid4 c C β 2 βc ϑ c Proposition 9 An α ϑsolution set Plb underestimates true optimal proﬁt probability greater equal α α ϑsolution set Pub overestimates true optimal proﬁt probability greater equal α Proof The proof follows Deﬁnition 5 cid2 Proposition 9 exploited generate conﬁdence interval true optimal proﬁt binomial reasoning We solve M independently generated instances Plb store optimal proﬁt obtained instances array Klb sorted ascending order solve M independently generated instances Pub store optimal proﬁt 1M α inverse cumulative obtained instances array K ub sorted ascending order Let bin distribution binomial distribution M trials success probability α let klb 1 α2quantile 1M 1 α With conﬁdence α element position klb distribution ﬁnally let kub 1 1 α2quantile bin Klb lower bound element position kub 1 Kub upper bound true optimal cost4 Example 7 We transform SCSP Example 5 SCOPs Plb Pub maximise objective function f X1 X2 X1 2 X2 In words assume proﬁt unit X1 1 proﬁt unit X2 2 By 4 Elements K indexed follows 1 K Note statistics kthsmallest value statistical sample known kth order statistic 20 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 141 Table 1 Type I Type II errors statistics Reject H0 Fail reject H0 H0 true H0 false Type I error false positive Correct outcome true negative Correct outcome true positive Type II error false negative choosing M 20 obtain α conﬁdence interval 282 304 true optimal proﬁt 293 reduce ϑ 001 interval shrinks considerably 290 295 If objective function stochastic unique way proceed For instance based available samples derive standard conﬁdence intervals expected value stochastic expression based Students t distribution compare solutions partial assignments comparing upper lower limits intervals The decision maker course choose suitable conﬁdence level α associated estimation An example ﬁltering algorithm employed context discussed Appendix A This algorithm designed handle situation objective minimisemaximise expected value expression involving decision random variables Different algorithms designed objective involves different operator variance Our algorithm distinguishes case trying determine upper lower bound expected cost optimal solution It exploits sampling distribution Students t distribution expected total proﬁtcost ﬁlters values based upperlower conﬁdence limits obtained distribution For instance aim determine upper bound optimal proﬁt problem type Pub algorithm simply compare upper conﬁdence limits expected proﬁt assignments retain assignment highest upper conﬁdence limit We use propagator solve models discussed Section 8 Finally note alternative strategy instead compare upper conﬁdence limits intervals An assignment provide lowerhigher proﬁt proﬁt conﬁdence intervals overlap However complexity ﬁltering logic required case prefer leave discussion future work 7 Connections statistics To better understand concepts introduced worth discussing connection approach intro duced hypothesis testing statistical analysis Let assume null hypothesis H 0 statistical sense assignment feasible According classical hypothesis testing cases illustrated Table 1 We feasible assignment hand H 0 true incorrectly ﬁlter Type I error operating infeasible assignment H0 false fail reject Type II error In clinical trials quality control key control rate Type I errors It undesirable treatment healthy patient discard functioning expensive machine However cases controlling Type II errors essential For example aerospace engineers prefer scrap functioning electronic circuit use actually broken spacecraft situation Type I error raises budget Type II error risk entire mission In general minimising Type I Type II errors simple matter If tries reduce rate occurrence Type I errors direct consequence typically increase observed rate Type II errors viceversa So practice tries control Type I Type II errors rate type controlled high increases sample size In speciﬁc case clearly essential control rate Type II errors delicate Type I errors Making Type II error means retaining infeasible assignment want avoid possible Making Type I error means discarding feasible solution impact optimality optimisation problem lead solution space Since approach essentially heuristic clear issues poor solution quality solution space acceptable dealt increasing number samples 8 Computational experience The aim section provide numerical insights theoretical framework introduced particularly concept α ϑ solution set applications ﬁnd approximate solution SCSPs SCOPs In numerical study consider wellknown problems static stochastic knapsack Section 81 stochastic multiprocessor scheduling problem release time deadlines Section 82 static stochastic lotsizing problem Section 83 The ﬁrst problems singlestage second twostage In Section 84 generate approximate α ϑ solution sets Deﬁnition 7 ﬁrst problems numerically probability greater equal α approach discussed generates solution sets satisfy chance constraints model margin 142 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 Constraints 1 Prsk 2 Prsk 1x1 sk 1x1 sk N xN C k β N xN C k β Decision variables xi 0 D Random variables Poissonλk sk Stage structure V 1 x1 xN S1 s1 1 sk L cid3V 1 S1cid4 n sG N k 1 L k L 1 G 1 N 1 N k 1 G Fig 8 The static stochastic multiple knapsack SCSP error ϑ In Section 85 numerically illustrate upper lower proﬁtcost bounds obtained approach outlined Section 6 comply prescribed conﬁdence level α We behaviour optimality gap function chosen error threshold ϑ number M independently generated instances Plb Pub Finally Section 86 investigate computational eﬃciency scalability All experiments performed Choco 21 Intel Xeonr CPU 350 Ghz 16 GB RAM 81 Static stochastic knapsack The knapsack problem 22 wellknown combinatorial optimisation problem The decision maker given set objects associated weight proﬁt The aim select subset objects ﬁt given capacity bring maximum proﬁt There possible stochastic variants knapsack problem Stochastic versions knapsack problem classiﬁed static dynamic In static stochastic knapsack problem 23 object weights andor proﬁts random decision maker choose observing weightsproﬁts subset objects maximises given objective expected proﬁt meeting restriction chance constraint given capacity Conversely dynamic stochastic knapsack 24 decision maker selects object immediately observes weight andor proﬁt based information decide select objects In computational study consider SCSP presented Fig 8 static stochastic multiple knapsack SSMKP In problem set N types objects D objects type available Each object type associated random coeﬃcients sk appear context G chance constraints set coeﬃcients generally denoted stochastic technology matrix 25 loss generality coeﬃcients follow Poisson distribution mean λk 5 The ﬁrst L chance constraints type 1 seen capacity restrictions respect target capacity Ck satisﬁed probability β In context ﬁrst L chance constraints sk represents weight item chance constraint k The remaining GL chance constraints type 2 seen minimum production requirements respect target level Ck satisﬁed probability β In context remaining GL chance constraints sk represents production contribution item chance constraint k Our aim determine feasible region problem set assignments satisfy constraints 1 2 We consider optimisation version problem Fig 9 aim determine subset N objects problem maximises expected total proﬁt satisfying chance constraints For object introduce random proﬁt pi follows Poisson distribution mean πi choice distribution loss generality 82 Stochastic multiprocessor scheduling problem release time deadlines We consider multiprocessor scheduling problem MPSP 27 p 238 The problem consists ﬁnding feasible schedule process set K orders jobs m processors m P Processing order k begin release date rk completed latest date dk Order k requires certain capacity ck expressed terms number processors processed The processing time order k tk The problem described known scheduling fully deterministic easily compactly modelled cumulative constraint 28 Let height task k ck This constraint considers set tasks enforces point time total height set tasks overlap point exceed given limit m A task k 5 For discussion statistic stochastic knapsack problems Poisson resource requirements 26 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 143 Objective 1 max Ep1x1 p N xN Constraints 2 Prsk 1x1 sk N xN C k β Decision variables xi 0 D Random variables Poissonλk sk pi Poissonπi Stage structure V 1 x1 xN S1 s1 1 sk L cid3V 1 S1cid4 n sL N k 1 L 1 N 1 N k 1 L 1 N Fig 9 The static stochastic multiple knapsack SCOP Constraints 1 Pr cumulatives e t c m β Decision variables sk rk dk ek rk dk Stochastic variables tk Poissonλk Stage structure V 1 s1 s2 sK V 2 e1 e2 e K L cid3V 1 S1cid4 cid3V 2 S2cid4 S1 t1 t2 t K S2 k 1 K k 1 K k 1 K Fig 10 An SCSP stochastic multiprocessor scheduling problem release time deadlines overlaps point origin sk equal end ek strictly greater This constraint imposes task k constraint sktkek However reality parameters problem uncertain nature Jobs longer expected processors break unavailable release dates delayed In order better model problem number stochastic generalisations considered uncertain release date rk uncertain date dk uncertain processing capacity ck uncertain processing time tk uncertain number m available processors possible combination stemming cases We consider following stochastic constraint programming formulation stochastic multiprocessor schedul ing problem SMPSP processing time tk order k uncertain shown Fig 10 In model decision variables sk ek denote start time completion time job k respectively The processing time tk job k modelled Poisson distributed random variable mean λk In contrast problem presented Section 81 model twostage SCSP In ﬁrst stage decide start time job observe realisation processing time In second stage completion times decided Under stage structure constraint 1 enforces probability exceeding given deadline job number available processors m stays speciﬁed threshold β More speciﬁcally constraint global chance constraint embed ding wellknown global constraint cumulative constraint 28 This constraint ﬁltered general purpose method discussed 4 In computational study consider optimisation version problem aim minimise latest start time 83 Static stochastic lotsizing The problem consider computational study singleitem stochastic lotsizing problem introduced 29 A SCOP problem shown Fig 11 The decision maker faces ﬁnite horizon T periods random demand dt period loss generality consider Poisson distributed mean λt There ﬁxed cost placing order size 0 Q t C period t An order placed period t delivered immediately beginning period demand occurs Binary decision variable δt set zero order placed 3 There 144 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 Objective 1 min E cid14 N t1aδt h cid14 t j1Q t dt Constraints cid14 2 Pr t 3 δt 0 cid15 Q t 0 j1Q t dt 0 β Decision variables δt 0 1 Q t 0 C Random variables dt Poissonλt Stage structure V 1 Q 1 Q T δ1 δT S1 d1 dT L cid3V 1 S1cid4 t 1 T t 1 T t 1 T t 1 T t 1 T Fig 11 The stochastic lotsizing problem 29 SCOP static uncertainty strategy holding cost h charged items carried period Finally decision maker comply service level restriction 2 stating net inventory end period nonnegative probability β The aim meet service level restrictions minimising expected total cost 1 The authors 29 range control policies control In study adopt static uncertainty policy ﬁxes Q t δt beginning planning horizon demand observed Note strategies discussed 29 dynamic uncertainty staticdynamic uncertainty easily captured modifying stage structure SCOP In follows shall refer problem static stochastic lotsizing problem SSLSP 84 Feasibility In Section 5 introduced notion approximate α ϑ solution set We present computational analysis SCSPs presented Sections 81 82 demonstrating probability α approach generates solution sets satisfy chance constraints model margin error ϑ We considered thirty randomly generated small instances single stage problem Fig 8 N 2 L 2 G 3 D 250 β 07 Means λk random variables model integer numbers uniformly distributed 10 20 constraints 1 20 30 constraints 2 Right hand constants C k integer numbers uniformly distributed 1500 2000 constraints 1 2500 3000 constraints 2 We ﬁxed α 09 ϑ 02 according Deﬁnition 7 choice led sample size 31 We considered thirty randomly generated small instances stage problem Fig 10 K 2 β 06 rk dk represent job k release time deadline set 0 4 respectively Capacity requirements ck generated integer numbers uniformly distributed 1 2 Finally expected task durations λk generated uniformly distributed numbers 1 3 maximum number processors P set 3 We ﬁxed α 09 ϑ 035 choice led sample size 6 Instances small analysis generated complete set feasible assignments respective sampled SCSP α ϑsolution set twostage problem Fig 10 generally extremely large order tens thousands solutions Feasibility assignment respect original SCSP assessed Monte Carlo simulation number simulation runs set way guarantee margin error ϑ10 conﬁdence level 09 Monte Carlo simulation error order magnitude smaller approximation error associated α ϑ solution set obtained To numerically investigate computed effectively α ϑsolution sets instances repeatedly solved 1000 sampled SCSPs computed frequency event e feasible assignments sampled SCSP feasible respect original SCSP given tolerance threshold ϑ In Fig 12 problems instance report frequency event e associated conﬁdence intervals conﬁdence level 095 These frequencies line claim computed α ϑsolution sets given α 09 Note aim control TypeII errors infeasible assignment regarded feasible TypeI errors discarded feasible assignment reason sampled SCSP admitted solution regarded degenerate case feasible assignments sampled SCSP feasible respect original SCSP given tolerance threshold ϑ Finally worth observing frequencies observed Fig 12 strictly greater prescribed value α This fact assignments providing satisfaction probability exactly β ϑ correctly classiﬁed infeasible probability α However given discrete nature assignment space likely instances feature assignment Assignments providing satisfaction probability R Rossi et al Artiﬁcial Intelligence 228 2015 129152 145 Fig 12 Frequency event feasible assignments sampled SCSP feasible respect original SCSP given tolerance threshold ϑ 1000 sampled SCSPs frequency report associated conﬁdence interval conﬁdence level 095 strictly β ϑ correctly classiﬁed infeasible probability strictly greater α In addition model features multiple chance constraints Bonferronis correction free correlation distribution assumptions generate conservative strictly larger needed sample size 85 Optimality We considered ﬁfty randomly generated small instances problem Fig 9 SSMKP N 10 L 2 D 1 β 09 Means λk random variables model integer numbers uniformly distributed 10 20 constraints 1 Right hand constants C k integer numbers uniformly distributed 100 200 constraints 1 Means πi set 10 We considered ﬁfty randomly generated small instances problem Fig 11 SSLSP T 5 h 1 Poisson demand period t 1 T integer numbers uniformly 10 C 100 β 09 Means λt distributed 5 10 We ﬁxed α 09 ϑ 005 M 10 recall M number independently generated instances Plb Pub computing proﬁtcost upper lower bounds illustrated Section 6 This led sample size 209 SSMKP 370 SSLSP Deﬁnition 7 Due small size SSMKP instances managed obtain optimal solutions exhaustive enumeration generated possible assignment checked feasibility expected total proﬁt Monte Carlo simulation The number Monte Carlo runs set guarantee margin error ϑ10 conﬁdence level 09 way ensure approximation error negligible respect chosen ϑ SSLSP instances solved optimality deterministic equivalent mixed integer linear programming model 30 In analysis compare results obtained approach true optimal solutions In Fig 13 instance plotted upper lower bound obtained optimal proﬁt SSMKP cost SSLSP For clarity interval normalised proﬁtcost true optimal solution normalisation factor value graph denotes true optimal proﬁtcost The conﬁdence level achieved approach generally higher prescribed α In fact despite α set 09 instances analysed cost conﬁdence interval cover true optimal cost case SSMKP instance 21 This conservative nature approach discussed Section 84 We believe ﬂuctuations size optimality gaps observed Fig 13 SSMKP related fact problem features 01 integer variables Depending speciﬁc instance solved different sets samples lead assignments high value objects belonging true optimal solution problem selected This lead larger optimality gaps observed instances optimal solution sensitive random ﬂuctuations produced sampling process Finally included analysis randomly generated instances SMPSP formulated SCOP objective minimise latest start time In instances K 5 β 06 rk dk represent job k release time deadline set 0 20 respectively Capacity requirements ck generated integer numbers uni formly distributed 1 3 Expected task durations λk generated uniformly distributed numbers 1 5 maximum number processors P set 5 In Fig 14 analysed behaviour optimality gap α 09 M 10 ϑ varies The sample size ranges follows 209 ϑ 005 5838 ϑ 001 SSMKP 370 ϑ 005 6350 ϑ 001 SSLSP 14 ϑ 03 114 ϑ 01 SMPSP For value ϑ considered solved 50 different instances SSMKP SSLSP SMPSP computed average optimality gap pool instances The average optimality gap SSMKP SSLSP reported percentage true optimal solution For case SMPSP unfortunately able compute true optimal plan reported optimality gap absolute terms minimising latest start time expressed optimality gap expected number 146 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 Fig 13 Normalised proﬁtcost upper lower bounds ﬁfty SSMKP SSLSP instances value 1 denotes true optimal proﬁtcost Fig 14 Average optimality gap different values ϑ Fig 15 Average optimality gap different values M periods Note α ϑ linked number samples generated relation Deﬁnition 7 similar plots obtained varying α keeping ϑ ﬁxed In Fig 15 carried similar analysis keeping ϑ ﬁxed 005 SSMKP SSLSP 03 SSMKP varying M 86 Computational eﬃciency In section reﬂect computational complexity scalability approach 861 Computational complexity The computational complexity SCSPs discussed works 24 particular direct interested reader 3132 provide comprehensive overviews complexity stochastic programs Multistage stochastic programming discretely distributed decisiondependent random variables PSPACE hard 32 result follows PSPACEhardness problem decisionmaking uncertainty 33 SCSPs PSPACEcomplete general random variables deﬁned discrete supports 3 However pointed 32 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 147 Table 2 SSMKP Larger instances comprising N 20 objects Instance Optimality gap Runtime hours 1 2 3 4 5 6 7 8 9 10 Mean 049 066 057 071 053 051 050 055 044 070 057 165 098 120 065 177 218 222 077 263 080 149 Table 3 SMPSP Larger instances comprising K 10 jobs Instance Latest start time Runtime hours LB 13 14 11 13 17 17 18 13 13 17 UB 15 16 12 14 21 19 20 14 14 20 1 2 3 4 5 6 7 8 9 10 Mean 150 068 072 320 031 327 908 043 016 1111 305 complexity standard multistage stochastic programming problem distributions independent decisions taken earlier stages remains open authors 32 conjecture PSPACEhard The advantage sampled SCSPs generic SCSPs sampled SCSPs comprise ﬁnite number scenarios number determined Deﬁnition 7 establishes relationship α ϑ N A decision maker free ﬁx pair values derive remaining In principle ﬁx priori number samples N conﬁdence level α error threshold ϑ sacriﬁce precision eﬃciency This sampled SCSP ﬁxedparameter tractable general 4 authors proved maintaining GAC global chance constraint intractable maintaining GAC corresponding deterministic version constraint tractable reduce complexity PSPACE NPhard 862 Scalability To illustrate scalability approach respect stateoftheart approaches SCSPs employ SSMKP Note problem similar discussed 4 Section 83 In Section 94 work discussed class problems proﬁts weights objects deﬁned support comprises values scenariobased formulation end comprising 220 scenarios solver Choco run memory It shown complete approach discussed work solve instance comprising 10 objects hour average We ﬁxed α 09 ϑ 001 M 10 We solved instances SSMKP randomly generated discussed Section 85 comprising N 20 objects led sample size 6916 In Table 2 report optimality gap runtime instances runtime hours Finally ﬁxed α 09 ϑ 01 M 10 solved larger instances SMPSP formulated SCOP These instances comprise jobs K 10 rk dk set 0 30 respectively led sample size 142 In Table 3 report upper lower bound latest start time associated instances runtime hours It clear impossible directly use approach 4 model SSMKP instances random variables follow Poisson distribution inﬁnite values support Even discretises supports reducing values resulting SCSP feature millions scenarios However argue case SSMKP analysing problem analysed brute force In words generate 220 possible assignments decision variables analytically check feasibility Unfortunately clear possible twostage SMPSP analysed features larger search space 148 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 These results demonstrate discussion work provides viable means scaling approach 4 9 Related works Conﬁdencebased optimisation originally introduced 34 In work authors discuss application methodology context wellknown stochastic inventory control problem Our work extends discussion presented generic SCSPs SCOPs introducing general notion conﬁdencebased reasoning based novel concepts α ϑ solutions α ϑ solution sets In context stochastic modelling optimisation discussed tools employed ﬁnd approximate solutions possess given statistical properties 91 Related works stochastic programming In operations research particularly stochastic programming stateoftheart technique applies sampling combinatorial optimisation sample average approximation SAA method 23 This Monte Carlo simulationbased approach stochastic discrete optimisation problem This method replaces actual distribution random variables combinatorial problem empirical distribution obtained sampling The obtained sample average optimisation problem solved procedure repeated multiple times given termination criterion satisﬁed The authors 23 focus stochastic programs expected value objectives discuss convergence rate stopping rules In 35 authors extend analysis twostage stochastic programs integer recourse class problems 36 carry posthoc computationally intensive analysis quality solutions obtained SAA Extensions problems expected value constraints conditional valueatrisk constraints discussed 37 However works investigated case problem include chance constraints As 38 remarks formulations stochastic programming problems incorporate expectations penalised constraints objective function penalty terms These problems solved eﬃciently simply require continuous variables modelling penalties require additional binary variable However modelling approach address issue ﬁnding approximating feasible optimal solutions chance constrained problem 39 p 950 SAA methods problems comprising single chance constraint discussed 4042 In 40 authors sum marise convergence properties Section 21 posthoc solution validation strategies Section 22 They remark based convergence analysis compute priori sample size required SAA problem produces feasible solution true problem high probability typically estimates required sample size conservative The convergence analysis authors refer originally conducted 41 shows asymptotical convergence properties based inequalities Chernoffs 43 Hoeffdings 44 known conservative bounds Their analysis conducted assumption feasible region ﬁnite sample size determined aforementioned convergence properties grows linearly size feasible region 41 p 683 Extensions analysis 41 case multiple chance constraints illustrated 38 This work similar discussed analysis based inequalities sample size depends size feasible region More recently 45 investigated relations chance constrained penalty function problems discrete distributions This analysis extended number previous works analysed relation continuous distribution However authors explicitly remark goal penalty problems able generate optimal values solutions chance constrained problems Instead compare problems focus asymptotic equivalence optimal values corresponding convergence optimal solutions After surveying existing literature SAA ﬁrst important remark works ﬁnd concepts resemble α ϑ solution α ϑ solution set unique conﬁdencebased reason ing 34 This subtle conceptual difference overlooked The aim SAA ﬁnd assignment prescribed conﬁdence probability α solution original problem 42 Section 31 In words SAA decision maker ﬁx priori tolerated estimation error ϑ To ensure solution sampled problem feasible respect original problem suﬃciently high probability SAA threshold β associated chance constraints sampled problem increased factor ϑ explicitly interpreted error tolerance threshold statistical sense practice In 42 p 407 authors point ﬁxed α given threshold β clear best choices sample size ϑ believe problemdependent issue addressed numerically This statement demonstrates aforementioned fundamental difference By introducing concepts α ϑ solution α ϑ solution set suggest decision maker line established practices statistics interpret ϑ error tolerance threshold ﬁx priori conﬁdence level α sample size basis available ob servations ϑ basis estimation error tolerated ﬁnally parameter ﬁxed derived analysis presented In summary difference lies interpretation Conﬁdencebased reasoning aims ﬁnd solution conﬁdence α satisﬁes chance constraints original problem given error tolerance ϑ In addition important semantic difference mention analysis based R Rossi et al Artiﬁcial Intelligence 228 2015 129152 149 exact ClopperPearson conﬁdence interval conservative bounds Chernoffs Hoeffdings inequali ties Finally approximation strategy α ϑ solution sets leads sample size Deﬁnition 7 independent number assignments feasible region major difference methods surveyed far To contrast approach respect existing stateoftheart approaches consider stochastic vehicle routing problem time windows discussed 38 Section 4 It possible apply analysis instances discussed 38 Table 1 converting parameters SAA setting conﬁdence level α 099 error threshold ϑ 005 chance constraint thresholds β 095 For instances 10 customer orders sample size prescribed approach 429 model single chance constraint 490 model chance constraints For instances 50 customer orders sample size prescribed approach 608 model single chance constraint 669 model chance constraints Not sample sizes orders magnitude smaller ones suggested 38 range 200 thousand 32 million importantly depend number vessels size time windows fact according Deﬁnition 7 depend number random variables chance constraints model Of course authors 38 remark ﬁnding exact solution scenariobased model 32 million scenarios unrealistic For reason suggest adopt heuristic solution methods tabu search As demonstrated computational study approximate α ϑ solution sets represent viable alternative use heuristics instances featuring large sample sizes 92 Related works constraint programming A detailed discussion hybrid CPAIOR approaches decision making uncertainty 4647 We direct reader references details existing works research area We brieﬂy survey key relevant references Efforts try extend classical CSP framework incorporate uncertainty inﬂuenced works originated different ﬁelds chanceconstrained programming 48 stochastic programming 49 To best knowledge ﬁrst work tries create bridge Stochastic Programming Constraint Pro gramming Benoist et al 50 Search consistency strategies backtracking algorithm forward checking procedure 2 arcconsistency 51 algorithm proposed SCSPs A scenariobased approach building constraint programming models SCSPs proposed Tarim et al 3 In work fully featured language Stochastic OPL modelling SCSPs proposed In 52 authors introduce new algorithms solving multi objective stochastic problems proposed Global chance constraints introduced ﬁrst 53 bring reasoning power global constraints CP expressive power chance constraints SP A general purpose approach ﬁltering global chance constraints proposed 47 This approach able reuse existing propagators available respective deterministic global constraint corresponds given global chance constraint random variables replaced constant parameters In 54 authors discuss possible strategies perform costbased ﬁltering certain classes SCOPs These strategies exploit wellknown inequalities borrowed SP compute valid bounds given SCOP respects mild assumptions Unfortunately approaches op erate assumption number scenarios ﬁnite solution expressed ﬁnite number possible decisions Furthermore approaches scale Even problems having limited num ber stochastic variables large support immediately produce policy trees size makes impractical use complete method In 3 authors employed sampling order reduce number scenarios considered given stochastic constraint program produce solution reasonable time Nevertheless approach provide optimalityfeasibility guarantee solution produced Heuristic approaches 55 neural network employed order encode policy function suffer limitation lack modularity Stochastic sampling context Stochastic Boolean Satisﬁability discussed 56 forward sampling 50 sample aggregation 57 techniques employed solve SCSPs Nevertheless approaches introduce concept resembles α ϑ solution Probably work discussed 58 represents closest attempt provide sort guarantees stochastic constraint satisfaction problem Nevertheless work focused speciﬁc problem twostage stochastic matching problem propose generic approach solving SCSPs Finally closely related work 59 discusses samplebased approaches job shop scheduling probabilistic durations like previous case approach proposed focused speciﬁc problem solving generic SCSPs 10 Conclusions We proposed framework exploiting sampling order solve SCSPs include random variables continu ous large discrete support Our framework based number novel concepts sampled SCSPs α ϑsolutions α ϑsolution sets We employed statistical estimation determine given assignment consistent respect given set chance constraints As statistical estimation quality estimate determined conﬁdence interval analysis In contrast existing approaches based sampling provide likelihood guarantees quality solutions In fact explicitly state conﬁdence probability α bounds probability exceeding given error tolerance 150 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 threshold ϑ estimation By properly choosing estimation error ϑ conﬁdence probability α possible generate compact sampled SCSPs effectively solved existing solution methods We extended reasoning SCOPs demonstrated produce statistical upper lower bounds value optimal solution We demonstrated approach number SCSPs SCOPs static stochastic knapsack problem stochastic multiprocessor scheduling problem stochastic lotsizing problem Our computational study demonstrates effec tiveness approach We conclude brieﬂy discussing number suggestions future work Online stochastic optimisation A promising direction exploring synergies online stochastic optimisation 50 In particular suspect approach enhance results 576062 ensuring better control solution quality obtained step online process Sampling strategies A key open issue related fact simple random sampling 63 relatively naive strategy selecting samples The use reﬁned sampling strategies instance stratiﬁed sampling technique Latin Hypercube Sampling 64 course reduce number samples required produce α ϑ solution Nevertheless research required order clarify stratiﬁed sampling effectively employed context Conﬁdence intervals The ClopperPearson interval exact interval based directly binomial distribution approximation binomial distribution This interval conservative discrete nature binomial distribution pointed Neyman 65 For example true coverage rate 95 ClopperPearson interval 95 depending n q Thus interval wider needs achieve 95 conﬁdence In contrast worth noting approximate conﬁdence bounds narrower nominal conﬁdence width normal approximation interval known Wald conﬁdence interval Wilson Interval AgrestiCoull Interval fact achieve conﬁdence level lower nominal 11 Future research investigate application approximate intervals context samplebased constraint solving The performance approximate intervals thoroughly analysed existing body literature The advantage approximate intervals lead smaller sample sets compact sampled SCSPs Computational complexity Finally interesting computational complexity questions remains open complexity standard multistage stochastic constraint programs Acknowledgements The authors like thank Associate Editor anonymous reviewers commenting drafts providing insightful remarks Appendix A Filtering strategy constraint expressions involving expected values We discuss ﬁltering strategy handling constraint expressions involving expected values sampled SCSPs This ﬁltering strategy employed concert approach discussed Section 6 deal case objective function stochastic Consider constraint x Ecid3expcid4 E denotes expectation operator x real valued decision variable domain stored interval real valued upper lower bounds Techniques handling propagation search involving real valued decision variables discussed 66 A ﬁltering algorithm enforces bounds consistency constraint shown Algorithm 1 It noted approach discussed Section 6 distinguishes cases aim underestimates true optimal proﬁt SCOP Plb aim overestimates true optimal proﬁt SCOP Pub The type problem Plb Pub propagator belongs speciﬁed input parameter type inﬂuences propagation The algorithm constructs arrays U L U lists scenario upper bound expected value cid3expcid4 L lists scenario lower bound expected value cid3expcid4 Then exploits Students t distribution cid5 1 degrees freedom StudentTcid5 1 determine upper lower conﬁdence limits expected value cid3expcid4 prescribed 1 conﬁdence level α Note CDF α denotes inverse cumulative distribution function t mean X std X t denote mean standard deviation elements X respectively The algorithm operates exploiting structure cid5 policy tree takes implicitly account stage structure problem computing expected value given expression correctly evaluate expected values single multistage case Finally worth remarking constraint closely related Students t test constraint discussed 67 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 151 Algorithm 1 Filtering expected values sampled SCSPs type cid3expcid4 T x α input output Bound consistent x begin U L p cid5 U U Supcid3expcid4p L L Infcid3expcid4p t StudentTcid5 1 type Plb 1 1 1 α2 stdU Supx meanU CDF t 1 1 1 α2 stdL Infx meanL CDF t typePub 1 1 1 α2 stdU Supx meanU CDF t 1 1 1 α2 stdL Infx meanL CDF t cid5 cid5 cid5 cid5 References 2001 1741 1 R Rossi B Hnich SA Tarim S Prestwich Finding α ϑ solutions sampled SCSP T Walsh Ed Proceedings 22nd International Joint Conference Artiﬁcial Intelligence IJCAI 2011 July 1622 Barcelona Spain AAAI Press 2011 pp 21722177 2 T Walsh Stochastic constraint programming F van Harmelen Ed European Conference Artiﬁcial Intelligence Proceedings ECAI2002 IOS Press 2002 pp 111115 3 SA Tarim S Manandhar T Walsh Stochastic constraint programming scenariobased approach Constraints 11 2006 5380 4 B Hnich R Rossi SA Tarim S Prestwich Filtering algorithms global chance constraints Artif Intell 189 2012 6994 5 D Costantini Verso una rappresentazione probabilistica del mondo Maria Margherita Bulgarini Firenze 2014 6 F Rossi P van Beek T Walsh Handbook Constraint Programming Foundations Artiﬁcial Intelligence Elsevier Science Inc New York NY USA 2006 7 B Hnich R Rossi SA Tarim SD Prestwich Synthesizing ﬁltering algorithms global chanceconstraints IP Gent Ed 15th International Conference Principles Practice Constraint Programming Proceedings CP 2009 Lisbon Portugal September 2024 2009 Lect Notes Comput Sci vol 5732 Springer 2009 pp 439453 8 SD Prestwich SA Tarim R Rossi B Hnich Hybrid metaheuristics stochastic constraint programming Constraints 20 2015 5776 9 H Jeffreys Theory Probability Clarendon Press Oxford UK 1961 10 CJ Clopper ES Pearson The use conﬁdence ﬁducial limits illustrated case binomial Biometrika 26 1934 404413 11 A Agresti BA Coull Approximate better exact interval estimation binomial proportions Am Stat 52 1998 119126 12 M Evans N Hastings B Peacock Statistical Distributions Wiley New York 2000 13 ICG Upton Oxford Dictionary Statistics Oxford University Press Oxford UK 2002 14 S Sethi G Sorger A theory rolling horizon decision making Ann Oper Res 29 1991 387416 15 S SadooghiAlvandi A Nematollahi R Habibi On distribution sum independent uniform random variables Stat Pap 50 2009 171175 16 RG Miller Simultaneous Statistical Inference SpringerVerlag Berlin Heidelberg GmbH Co K 1981 17 F Killmann E von Collani A note convolution uniform related distributions use quality control Econ Qual Control 16 18 EL Lehmann JP Romano Generalizations familywise error rate Ann Stat 33 2005 11381154 19 CE Smith RA Cribbie Multiplicity control structural equation modeling incorporating parameter dependencies Struct Equ Model 20 2013 7985 20 HA David HN Nagaraja Order Statistics 3rd ed WileyInterscience 2003 21 F Laburthe OCRE project team Choco implementing CP kernel Technical report Bouygues eLab France 1994 22 S Martello P Toth Knapsack Problems Algorithms Computer Implementations John Wiley Sons Inc New York NY USA 1990 23 AJ Kleywegt A Shapiro T HomemDeMello The sample average approximation method stochastic discrete optimization SIAM J Optim 12 2001 479502 24 AJ Kleywegt JD Papastavrou The dynamic stochastic knapsack problem Oper Res 46 1998 1735 25 P Kall J Mayer Stochastic Linear Programming Models Theory Computation 2nd ed Internat Ser Oper Res Management Sci Springer 2011 26 S Agralı J Geunes A singleresource allocation problem Poisson resource requirements Optim Lett 3 2009 559571 27 MR Garey DS Johnson Computers Intractability A Guide Theory NPCompleteness WH Freeman 1979 28 A Aggoun N Beldiceanu Extending chip order solve complex scheduling placement problems Math Comput Model 17 1993 5773 29 JH Bookbinder JY Tan Strategies probabilistic lotsizing problem servicelevel constraints Manag Sci 34 1988 10961108 30 V Vargas An optimal solution stochastic version WagnerWhitin dynamic lotsize model Eur J Oper Res 198 2009 447451 31 HB Hunt MV Marathe RE Stearns Complexity approximability quantiﬁed stochastic constraint satisfaction problems Electron Notes Discrete Math 9 2001 217230 32 M Dyer L Stougie Computational complexity stochastic programming problems Math Program 106 2006 423432 33 CH Papadimitriou Games nature J Comput Syst Sci 31 1985 288301 34 R Rossi S Prestwich SA Tarim B Hnich Conﬁdencebased optimisation newsvendor problem binomial Poisson exponential demand Eur J Oper Res 239 2014 674684 35 S Ahmed A Shapiro E Shapiro The sample average approximation method stochastic programs integer recourse SIAM J Optim 12 2002 36 J Linderoth A Shapiro S Wright The empirical behavior sampling methods stochastic programming Ann Oper Res 142 2006 215241 37 W Wang S Ahmed Sample average approximation expected value constrained stochastic programs Oper Res Lett 36 2008 515519 38 M Branda Sample approximation technique mixedinteger stochastic programming problems chance constraints Oper Res Lett 40 479502 2012 207211 39 M Branda Stochastic programming problems generalized integrated chance constraints Optimization 61 2012 949968 2008 490517 152 R Rossi et al Artiﬁcial Intelligence 228 2015 129152 40 S Ahmed A Shapiro Solving chanceconstrained stochastic programs sampling integer programming ZL Chen S Raghavan Eds Tuto rials Operations Research INFORMS 2008 pp 261269 41 J Luedtke S Ahmed A sample approximation approach optimization probabilistic constraints SIAM J Optim 19 2008 674699 42 BK Pagnoncelli S Ahmed A Shapiro Sample average approximation method chance constrained programming theory applications J Optim Theory Appl 142 2009 399416 43 H Chernoff A measure asymptotic eﬃciency tests hypothesis based sum observations Ann Math Stat 23 1952 44 W Hoeffding Probability inequalities sums bounded random variables J Am Stat Assoc 58 1963 1330 45 M Branda On relations chance constrained penalty function problems discrete distributions Math Methods Oper Res 77 2013 265277 pp 729753 Chapter 21 46 KN Brown I Miguel Uncertainty change F Rossi P van Beek T Walsh Eds Handbook Constraint Programming Elsevier 2006 47 B Hnich R Rossi SA Tarim S Prestwich A survey CPAIOR hybrids decision making uncertainty P van Hentenryck M Milano Eds Hybrid Optimization Springer Optim Appl vol 45 Springer New York New York NY 2011 pp 227270 48 A Charnes WW Cooper Deterministic equivalents optimizing satisﬁcing chance constraints Oper Res 11 1963 1839 49 JR Birge F Louveaux Introduction Stochastic Programming Springer Verlag New York 1997 50 T Benoist E Bourreau Y Caseau B Rottembourg Towards stochastic constraint programming study online multichoice knapsack deadlines T Walsh Ed Principles Practice Constraint Programming Proceedings CP 2001 Lect Notes Comput Sci vol 2239 Springer 2001 pp 6176 51 T Balafoutis K Stergiou Algorithms stochastic CSPs F Benhamou Ed Principles Practice Constraint Programming Proceedings CP 2006 52 L Bordeaux H Samulowitz On stochastic constraint satisfaction framework SAC 07 Proceedings 2007 ACM Symposium Applied Lect Notes Comput Sci vol 4204 Springer 2006 pp 4458 Computing ACM New York NY USA 2007 pp 316320 53 R Rossi SA Tarim B Hnich SD Prestwich A global chanceconstraint stochastic inventory systems service level constraints Constraints 13 54 R Rossi SA Tarim B Hnich SD Prestwich Costbased domain ﬁltering stochastic constraint programming PJ Stuckey Ed 14th International Conference Principles Practice Constraint Programming Proceedings CP 2008 Sydney Australia September 1418 2008 Lect Notes Comput Sci vol 5202 Springer 2008 pp 235250 55 SD Prestwich SA Tarim R Rossi B Hnich Evolving parameterised policies stochastic constraint programming IP Gent Ed 15th International Conference Principles Practice Constraint Programming Proceedings CP 2009 Lisbon Portugal September 2024 2009 Lect Notes Comput Sci vol 5732 Springer 2009 pp 684691 56 ML Littman SM Majercik T Pitassi Stochastic boolean satisﬁability J Autom Reason 27 2001 251296 57 P van Hentenryck R Bent Y Vergados Online stochastic reservation systems JC Beck BM Smith Eds Third International Conference Integration AI OR Techniques Constraint Programming Combinatorial Optimization Problems Proceedings CPAIOR 2006 Cork Ireland May 31June 2 2006 Lect Notes Comput Sci vol 3990 Springer 2006 pp 212227 58 I Katriel C KenyonMathieu E Upfal Commitment uncertainty twostage stochastic matching problems L Arge C Cachin T Jurdzinski A Tarlecki Eds 34th International Colloquium Automata Languages Programming Proceedings ICALP 2007 Wroclaw Poland July 913 2007 Lect Notes Comput Sci vol 4596 Springer 2007 pp 171182 59 JC Beck N Wilson Proactive algorithms job shop scheduling probabilistic durations J Artif Intell Res 28 2007 183232 60 L Michel PV Hentenryck Iterative relaxations iterative ﬂattening cumulative scheduling S Zilberstein J Koehler S Koenig Eds Proceed ings Fourteenth International Conference Automated Planning Scheduling ICAPS 2004 Whistler British Columbia Canada June 37 2004 AAAI 2004 pp 200208 61 R Bent PV Hentenryck Regrets online stochastic optimization time constraints Proceedings Nineteenth National Conference Artiﬁcial Intelligence Sixteenth Conference Innovative Applications Artiﬁcial Intelligence July 2529 2004 San Jose California USA 2004 pp 501506 62 R Bent I Katriel PV Hentenryck Suboptimality approximations P van Beek Ed 11th International Conference Principles Practice Constraint Programming Proceedings CP 2005 Sitges Spain October 15 2005 Lect Notes Comput Sci vol 3709 Springer 2005 pp 122136 63 DS Yates DS Starnes DS Moore The Practice Statistics WH Freeman Co 2002 64 MD McKay RJ Beckman WJ Conover A comparison methods selecting values input variables analysis output code Technometrics 21 1979 239245 65 J Neyman On problem conﬁdence limits Ann Math Stat 6 1935 111116 66 F Benhamou L Granvilliers Continuous interval constraints F Rossi P van Beek T Walsh Eds Handbook Constraint Programming Elsevier 2006 p 569 67 R Rossi SD Prestwich SA Tarim Statistical constraints T Schaub G Friedrich B OSullivan Eds ECAI 2014 21st European Conference Artiﬁcial Intelligence Including Prestigious Applications Intelligent Systems PAIS 2014 Prague Czech Republic 1822 August 2014 Front Artif Intell Appl vol 263 IOS Press 2014 pp 777782