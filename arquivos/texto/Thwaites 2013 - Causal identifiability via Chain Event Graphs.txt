Artiﬁcial Intelligence 195 2013 291315 Contents lists available SciVerse ScienceDirect Artiﬁcial Intelligence wwwelseviercomlocateartint Causal identiﬁability Chain Event Graphs Peter Thwaites School Mathematics University Leeds LS2 9JT United Kingdom r t c l e n f o b s t r c t We present Chain Event Graph CEG complementary graphical model Causal Bayesian Network representation analysis causally manipulated asymmetric problems Our focus causal identiﬁability ﬁnding conditions effects manipulation estimated subset events observable unmanipulated CEG analogues Pearls Back Door Front Door theorems presented applicable class singular manipulations includes Pearls basic Do intervention class functional manipulations possible Bayesian Networks These theorems shown ﬂexible Bayesian Network counterparts types manipulation applied nature conditioning sets 2012 Elsevier BV All rights reserved Article history Received 15 April 2011 Received revised form 6 September 2012 Accepted 12 September 2012 Available online 13 September 2012 Keywords Back Door theorem Bayesian Network Causal identiﬁability Causal manipulation Chain Event Graph Conditional independence Front Door theorem 1 Introduction In paper consider cause effect analysis controlled models The standard apparatus approach Causal Bayesian Network CBN 8141524 The CBN version Bayesian Network BN directionality edges graph interpreted causal BN representing causal model BNs speciﬁcally designed work problems natural product space structure problems wish model structure asymmetric problem variables different sets possible outcomes given different outcomes parental variables possible outcomes given outcomes parents The future development speciﬁc point depends particular history problem point outcomes ancestral variables values particular set covariates point It types problem primarily concerned So instance consider infectious disease people blood type O Following ﬁrst treatment patients blood type die need second treatment patients blood types need second treatment recovery At stage process patients died fully recovered offered second treatment patients given possible second treatments choice dependent factors hospital policy consultant preference Similar examples occur areas example 13712 Contextspeciﬁc variants BNs developed tackling asymmetric problems 2131820 They representation analysis problems future development speciﬁc point depends particular history problem point use circumscribed problems possible outcomes variables given certain histories values covariates In cases problems anal ysed longer fully represented topology graph contextspeciﬁc BNs require supplementary information Email address PAThwaitesleedsacuk 00043702 matter 2012 Elsevier BV All rights reserved httpdxdoiorg101016jartint201209003 292 P Thwaites Artiﬁcial Intelligence 195 2013 291315 form trees treelike conditional probability tables attached vertices depict asymmetries prob lem The Chain Event Graph CEG introduced 2225 speciﬁcally designed representation analysis problems It function event tree 21 topology expresses collection independence properties sociated problem It particularly useful problems exhibit product space structure lot contextspeciﬁc information present All aspects model structure including contextspeciﬁc dependencies represented topology graph bolted There recent advances CBN theory example 569162728 little causal analysis asymmetric problems simpler In particular techniques Pearls Back Front Door theorems 1415 conditions expressed terms topology CBN structure problem longer expressed fully terms topology graph beneﬁt lost CBNs basic Do intervention Pearl 15 sets particular variable particular value use extended functional manipulations Do X gW set variables W stochastic manipulations assign new probability distribution outcomes manipulated variable The ease necessary conditions checked unmanipulated graph vanishes rapidly away basic interventions It argued 42126 causes naturally expressed events values random variable The CEG provides ideal graphical representation given argument It sensible representation analysis manipulations events By making additional assumptions concerning CEG model causal interpretation extend use causal analysis analogous manner CBNs extend use BNs Unlike analysis CBNs analysis functional stochastic manipulations CEGs complex analysis basic Do manipulation In CEG causal analysis building ideas researchers attempted use trees purpose 192124 Note CBN analysis standard methods reducing complexity manipulated probability expression example Pearls Back Front Door theorems rely use blocking sets consisting problem variables With CEGbased analysis blocking sets composed events allowing ﬂexibility construction instead conditioning set variables Z Z1 Z2 need condition events patient male patient female aged 40 A crude version Back Door theorem CEGs introduced 26 Here present general Back Door theorem alternative versions Front Door theorem No knowledge content 26 assumed paper The earlier paper touched brieﬂy topics covered use CEGs sophisticated manipulations offer comprehensive overview causal analysis CEGs look carefully causal identiﬁability ﬁnding conditions effects manipulation estimated subset events ob servable idle Pearls Back Front Door theorems suﬃcient conditions causal identiﬁability BNs arrival prompted search complete set conditions analyst gauge expression estimated subset observable variables 62728 This paper provides sets suﬃcient conditions causal identiﬁability CEGs We anticipate future work allow ﬁnd necessary suﬃcient conditions identiﬁability expressed terms subsets observable events opposed observable variables As CEG comparatively new structure minor modiﬁcations 22 26 In particular removed undirected edges previous deﬁnitions CEG DAG This led cluttered representation CEG easier read In Section 2 deﬁne CEG manipulated CEG Section 3 develops Back Door theorem idea singular manipulations A Front Door theorem introduced Section 4 Section 5 provides discussion possible directions future research 2 Deﬁnitions notation In section deﬁne CEG We provide notation paper We turn attention means manipulate CEG event present deﬁnition manipulated CEG The CEG function event tree 21 retaining features tree allow transparent repre sentation asymmetric problems They signiﬁcant extension trees express topology complete description conditional independence structure problem An event tree T directed tree vertex set V T edge set ET It single root vertex v 0 collection leaf vertices example Fig 1 7 leaf vertices The roottoleaf paths λ T form atoms event space Events measurable respect space unions atoms Let V 0T denote set nonleaf vertices T Then vertex v V 0T labels random variable Xv state space Xv identiﬁed set directed edges ev v cid4 cid3 cid4 cid3 cid3 ET emanating v For Xv let cid5 Xv cid3 called primitive probabilities tree Πv πev ΠT cid2 πe cid3 v e cid3 v v v cid3 v P Xv ev v cid5 Πv cid2 vV T P Thwaites Artiﬁcial Intelligence 195 2013 291315 293 There number modiﬁcations event tree enable portray conditional independence structure transparently The ﬁrst highlight vertices V T outgoing edges carry labels probabilities We concept stage colouring edges Deﬁnition 1 Stages colour For event tree T nonleaf vertex set V 0T edge set ET 1 The set V 0T partitioned equivalence classes called stages follows Vertices v 1 v 2 V 0T members equivalence class stage v 1 v 2 lie root toleaf path b bijection ψ Xv 1 Xv 2 ψ ev 1 v 1cid3 cid5 ev 2 v 2cid3 πev 1cid3 v 1 πev 2cid3 v 2 2 The set ET partitioned equivalence classes members colour follows Edges ev 1 v 1cid3 ev 2 v 2cid3 colour vertices v 1 v 2 stage πev 1cid3 v 1 πev 2cid3 v 2 The set stages tree T labelled LT individual stages labelled u Deﬁnition 2 Coloured tree An event tree T coloured tree edges coloured accordance Deﬁnition 1 The second modiﬁcation highlight vertices V T complete future development process essentially We concept position For v V 0T let T v denote unique subtree T root v contains edges ET vertices V T lie vtoleaf subpath T Deﬁnition 3 Positions For coloured tree T nonleaf vertex set V 0T edge set ET set V 0T parti tioned equivalence classes called positions follows Vertices v 1 v 2 V 0T members equivalence class position coloured subtrees T v 1 T v 2 topologically identical b bijection T v 1 T v 2 edges T v 2 coloured identically corresponding edges T v 1 The set positions labelled K T individual positions labelled w Note partition positions ﬁner partition stages vertices position necessarily stage Note vertices stage sets possible immediate outcomes vertex conditional probability distribution Vertices position sets entire future evolutions vertex probability distribution Example 1 puts meanings stage position simple practical context Once ideas stages positions modiﬁcation conditional independence structure problem expressed entirely topology graph Example 1 demonstrates treeto CEG conversion implemented Deﬁnition 4 Chain Event Graph The Chain Event Graph CT coloured graph vertex set V C edge set EC deﬁned 1 V C K T w w called sinkvertex CT cid3 V C w exists directed edge ew w 2 For w w cid3 K T edge ev v v w K T v cid3 w cid3 EC iff vertices v v cid3 ET cid3 V 0T b For w V C w exists directed edge ew w EC iff nonleaf vertex v V 0T leaf vertex v cid3 V T v w K T edge ev v cid3 ET So vertices CEG CT correspond positions underlying tree T We ambiguity vertices CEG positions Since positions partition vertices tree vertices position necessarily stage transfer concepts stage colour tree CEG If positions w 1 w 2 CEG correspond sets vertices tree members stage u w 1 w 2 stage u CEG We label set stages CT LC The colouring edges leaving vertex v member stage u T inherited edges leaving position w member stage u CT To aid reading CEGs paper given colour positions CEG members stage colouring edges emanating positions There onetoone correspondence roottoleaf paths λ T roottosink w 0 w paths λ CT form atoms event space CT Events measurable respect space unions atoms 294 P Thwaites Artiﬁcial Intelligence 195 2013 291315 Fig 1 Coloured tree Example 1 Stages v 0 v 1 v 2 v 3 v 5 v 4 Positions v 0 v 1 v 2 v 3 v 5 v 4 Each stage u LC labels random variable Xu state space Xu identiﬁed set directed edges ew w cid3 EC emanating position w u w 1 w 2 lie roottosink path CT Note Deﬁnition 1 1a implies positions w 1 w 2 V C members stage u LC For remainder paper abbreviate CT C assume C associated edge vertex sets EC V C Example 1 CEG construction We illustrate construction CEG fault diagnosis example illustrative convenience uses binary variables A machine warning lights indicate possible faults components If light machine checked judged faulty If lights operation proceeds normal Operational evidence indicates 1 warning lights come independently 2 machine judged faulty independent light 1 provided light 2 This information represented coloured tree Fig 1 For ease interpretation edges share probability coloured The edges leaving v 1 v 2 coloured indicate probabilities 2 blue 2 red depend light 1 The vertices v 1 v 2 stage The edges leaving v 3 v 5 coloured indicate probabilities faulty mauve faulty green depend light 1 provided light 2 The vertices v 3 v 5 stage As v 3 v 5 roots identically coloured subtrees v 3 v 5 position Deﬁnition 2 tells vertex set CEG consists positions coloured tree sinkvertex groups leafnodes tree So v 3 v 5 merged blue edges ev 1 v 3 ev 2 v 5 tree edges ew 1 w 4 ew 2 w 4 CEG Fig 2 It possible read positions stages CEG manner similar reading BNs The position w 4 read contextspeciﬁc conditional independence property judged faulty independent light 1 given light 2 Reading stages look immediate future So reading w 1 w 2 gives conditional independence property light 2 independent light 1 P Thwaites Artiﬁcial Intelligence 195 2013 291315 295 Fig 2 Chain Event Graph Example 1 Stages w 0 w 1 w 2 w 3 w 4 Fig 3 BN CEG Example 2 A BNrepresentation problem consist variables X1 denoting light 1 onoff X2 denoting light 2 onoff X3 denoting faultynot faulty edges X1 X2 X3 The additional knowledge lights 1 2 implies faulty X3 independent X1 provided light 2 represented topology graph appear supplementary information Example 2 Reading CEGs To CEGs relate BNs provide CEGversion Pearls Sprinkler example 15 Here ﬁve variables X1 X5 causal relationships illustrated BN Fig 3 X1 season X2 rain yes X3 water sprinkler X4 pavement wet wet dry X5 pavement slippery slippery slippery From BN read X3 cid9 X2 X1 knowing raining help estimating probability event sprinkler given know season X3 cid9 X2 X4 knowing raining 296 P Thwaites Artiﬁcial Intelligence 195 2013 291315 Fig 4 Second CEG Example 2 help estimating probability event sprinkler given know pavement wet dry We read X4 X5 cid9 X1 X2 X3 X5 cid9 X1 X2 X3 X4 The CEG example given Fig 3 illustrative convenience I shown seasons Spring Summer Here 13 positions w 0 w 1 w 12 read unique contextspeciﬁc independence property So example reading w 7 gives state pavement wetness slipperiness independent season given raining sprinkler Combining readings w 7 w 8 w 9 w 10 BN X4 X5 cid9 X1 X2 X3 Similarly reading w 11 gives slipperiness pavement independent season raining sprinkler given pavement wet Combining reading w 12 gives X5 cid9 X1 X2 X3 X4 There stages contain single position These w 3 w 4 w 5 w 6 When read look immediate future So reading w 3 w 4 gives sprinkler independent raining given Spring Combining reading w 5 w 6 gives X3 cid9 X2 X1 The example stands clearly symmetric CEG gives information BN Indeed given number nodes edges CEG considerably eﬃcient representation BN However Example 1 build contextspeciﬁc information model readily BN So suppose Summer gardener hand check weather turning sprinkler Then X3 independent X2 X1 takes value corresponding Summer independent X2 X1 takes value corresponding Spring In BNrepresentation need add edge X2 X3 supplement graph additional information In contrast information represented directly topology CEG shown Fig 4 w 5 w 6 longer stage The following notation remainder paper Analogously atoms tree atom λ cid3 position w precedes position w Fig 3 example w 5 w 12 w 0 w path C The set atoms denoted Ω We write w w w 0 w path exists set directed edges joining w w w 5 w 9 We w parent w exists edge ew w cid3 EC Events denoted Λ Λw event union w 0 w paths passing position w cid3 cid3 cid3 Λew w cid3 union paths passing edge ew w cid3 We deﬁne primitive probabilities CEG We use notation πew cid3 w denote cid3 having arrived position w These probabilities probability passing edge ew w relationship CEG sets conditional probability tables associated BN corresponding DAG example Fig 3 πew 11 w 7 probability pavement wet given raining sprinkler For u LC random variable Xu let Πu cid3 cid2 πe cid3 w w cid4 cid5 w u ΠC cid2 cid5 Πu uLC P Thwaites Artiﬁcial Intelligence 195 2013 291315 297 cid3 Λw Each w 0 w Note label probability event Λ π Λ πew path λ corresponds sequence outcomes set positions equivalently vector values set Xu variables So probability atom λ expressed product edgeprobabilities form cid3 corresponds value Xu Λw describes parental conﬁg π Λew w uration position w But product probabilities values variables conditioned values parents ΠC satisﬁes Directed Markov condition 1510 respect CEG C cid3 Λw Λew w cid3 w π Λew w subpath Λμw w π Λμw w A subpath roottosink path denoted μw w cid3cid3 w w cid3cid3 cid3cid3 event union paths utilising subpath μw w indicate start end positions cid3cid3 w cid3cid3 πμw cid3cid3 having arrived position w Before moving manipulated CEGs present useful lemma proof appears Appendix A cid3cid3 Λw probability passing subpath μw w Lemma 1 Limited Memory For CEG C positions w 1 w 2 w 3 V C w 1 w 2 w 3 cid3 cid4 Λw 3 Λw 1 Λw 2 π cid3 cid4 Λw 3 Λw 2 π Here w 1 precedes w 2 precedes w 3 sense described The lemma states probability passing position w 3 given previously passed w 1 w 2 equal probability passing position w 3 given information previously passed w 2 This result extended positions w 1 w 2 replaced edges position w 3 replaced union positions andor edges Essentially tells position w 3 edge collection positions edges given earlier position w 2 edge independent path taken earlier position edge This result proof Theorem 1 21 Manipulated CEGs Anything observe change topology graphical representation In 25 considered topology CEG altered observe event Λ Here investigate topology CEG altered manipulate event Λ As following deﬁnitions suggest process updating beliefs following manipulation similar happens following observation event How relate manipulation BN When talk manipulating BN enacting intervention BN general setting variable collection variables speciﬁed values In case stochastic manipulation altering probability distribution associated variable set variables In case described manipulation event event X x1 variable X value x1 In case equivalent action CEG reassignment subset edgeprobabilities CEG allow Deﬁnition 5 The type events consider paper intrinsic events called Ccompatible events 25 An intrinsic event Λ deﬁnes subgraph C atom Λ w 0 w path subgraph C w 0 w path subgraph atom Λ The set intrinsic events large CEG expressible BN contains proper subset sets form X j A j subsets A j sample spaces X j vertex variables BN It excludes events convoluted structure wish manipulate event convert intrinsic relaxing conditional independence structure represented CEG expanding merged vertices A manipulation intrinsic event Λ reassignment edgeprobabilities ˆπ Λ 1 ˆπ denotes probability following manipulation Clearly reassignment ways description speciﬁed manipulation Λ include details edgeprobabilities assigned Also Λ proper subset Ω manipulation Λ assign zeroprobabilities proper subset EC We normally prune manipulated CEG removing edges positions lie paths elements Λ Example 3 Consider Pearls Sprinkler example Example 2 CEG Fig 3 Suppose enact intervention Put sprinkler This setting variable X3 value associated sprinkler If let value 1 Pearl manipulation Do X3 1 The manipulated BN intervention Fig 5 In CEGrepresentation manipulating event Λ union paths passing edge labelled As controlling aspect assigning edgeprobability 1 edge edgeprobability 0 edge leaving edgeprobabilities unchanged As suggested prune edges positions lie paths elements Λ positions w 8 w 10 edges entering leaving positions The resultant manipulated CEG given Fig 5 This symmetric manipulation symmetric CEG eﬃcient representation CBN But consider functional manipulations If Summer sprinkler Spring raining sprinkler In BNrepresentation problem instead removing edge X1 X3 298 P Thwaites Artiﬁcial Intelligence 195 2013 291315 Fig 5 Manipulated BN CEG Example 3 Fig 6 Second manipulated CEG Example 3 Fig 5 additional edge X2 X3 sprinkler depends season raining The BN supplemented extra information given So advantages gained simplicity BN topology lost Using CEG representing manipulation straightforward representing simple Put sprinkler intervention The resultant CEG shown Fig 6 Here controlling aspect edge probabilities modiﬁed leaving positions w 3 w 4 w 5 w 6 The edges ew 3 w 8 ew 5 w 7 ew 6 w 9 given probability 1 edges ew 3 w 7 ew 5 w 8 ew 6 w 10 given probability 0 pruned As description manipulation specify happens Spring doesnt rain leave edgeprobabilities ew 4 w 9 ew 4 w 10 unchanged Deﬁnition 5 Manipulated CEG For CEG C intrinsic event Λ let subgraph C ˆCΛ CEG manipulated event Λ V ˆCΛ V C contains precisely positions lie w 0 w path λ Λ b E ˆCΛ EC contains precisely edges lie w 0 w path λ Λ P Thwaites Artiﬁcial Intelligence 195 2013 291315 299 c For w 1 w 2 V ˆCΛ ew 1 w 2 E ˆCΛ edge ew 1 w 2 primitive probability πew 2 w 1 replaced ˆπ Λ e w 2 w 1 Clearly probability distributions ˆCΛ assigned Deﬁnition 5c corre spond practical theoretical manipulation As CBNs causal assumptions So Sprinkler example know control season able control rains alter probability distributions outcomes seeding clouds deﬁnitely control sprinkler alter probability distributions path wet The allowable edgeprobabilities manipulated CEG governed causal assumptions In Example 3 speciﬁed aspect controlled sprinkler edgeprobabilities alter new values determined causal model The probability following manipulation atom λ equal probability corresponding w 0 w path manipulated CEG ˆCΛ This expressible product probabilities values stage variables conditioned values parents Π ˆCΛ satisﬁes Directed Markov condition respect ˆCΛ For completeness deﬁne conditioned CEG ﬁrst deﬁned 25 Deﬁnition 6 Conditioned CEG For CEG C intrinsic event Λ let CΛ CEG conditioned event Λ subgraph C V CΛ ECΛ deﬁned coloured analogously V ˆCΛ E ˆCΛ Deﬁnition 5 c For w 1 w 2 V CΛ ew 1 w 2 ECΛ edge ew 1 w 2 primitive probability πew 2 w 1 replaced π Λ e w 2 w 1 cid6 λΛ π λ Λew1 w 2 cid6 λΛ π λ Λw1 Probabilities C denoted π CΛ denoted π Λ ˆCΛ denoted ˆπ Λ If instead manipulating Λ Example 3 simply observed sprinkler conditioned CEG CΛ edges associated variables season rain retain original probabilities edges associated variables wet slippery new probabilities detailed Deﬁnition 6c Causal analysis CEGs ﬁrst discussed 26 emphasis earlier paper manipulations exact analogues BN interventions manipulations sets positions CEG small subset set intrinsic events This narrow focus manipulations considered generic manipulation Put sprinkler Example 3 thought manipulation set positions second manipulation example characterised way functional manipulation noted expressed BN sacriﬁcing simplicity DAGrepresentation 3 The Back Door theorem Since 1995 considerable effort ﬁnding conditions causal identiﬁability BNs 6161727 28 conditions effects manipulation estimated subset variables observed idle The initial spur activity publication Pearls Back Door theorem 14 provided suﬃcient conditions analysis The advantages Pearls formulation threefold factors needing considered analysis clearly identiﬁed probability observing effect following manipulation expressed terms idle unmanipulated conditions analysis valid checked unmanipulated BN In particular manipulation impossible unethical practice effects diﬃcult impossible observe analyst able estimate probabilities theoretically possible effects manipulation Pearls Back Door theorem states certain conditions sets variables X Y Z write probability expression cid7 p y cid12 x p y x z pz z p y cid12 x denotes probability observing effect response variable Y takes value y following manipulation variable X speciﬁed value x The manipulation described control setting variable X value x notation Lauritzen 11 By careful choice set Z able calculate estimate p y cid12 x conditioning set measurement variables As Back Door theorem BNs tool widely causal analysts CEGanalogue principal focus paper We noted CEG good means depicting asymmetric problems Example 1 allows transparent representation termed asymmetric manipulations Example 3 The Back Door theorem CEGs presented allows analyst fair ﬂexibility choice 300 P Thwaites Artiﬁcial Intelligence 195 2013 291315 CEGanalogue Z The topology CEG utilised ﬁnd functions data observed idle fulﬁl role need vectors values measurement variables problem Our Back Door theorem refers explicitly manipulation events Put sprinkler manipulation variables set variable sprinkler value corresponding reﬂects difference topology CEG BN A primitive version Back Door theorem given 26 restricted manipulations sets positions The conditions required theorem complex easily checkable topology CEG The Back Door theorem presented works far larger class manipulations conditions simpler checked topology CEG The use description Back Door obvious choice CEGanalogue retain emphasise aﬃnity Back Door theorem BNs So consider manipulation event Λx speciﬁed union roottosink paths Suppose wish ﬁnd probability observing event Λ y given manipulation Λx enacted wish produce expression π Λ y cid12 Λx This equal probability event Λ y CEG ˆCΛx sum probabilities w 0 w paths ˆCΛx consistent event Λ y π Λ y cid12 Λx ˆπ Λx Λ y Consider partition atomic events w 0 w paths C Λz Then cid8cid9 cid10 ˆπ Λx Λ y ˆπ Λx Λz Λ y cid7 ˆπ Λx Λz Λ y z events Λz form partition Ω cid7 z ˆπ Λx Λ y Λz ˆπ Λx Λz z Deﬁnition 7 Back Door partition The partition Λz forms Back Door partition Ω cid7 π Λ y cid12 Λx π Λ y Λx Λzπ Λz z Note expression holds A B ˆπ Λx Λ y Λz π Λ y Λx Λz ˆπ Λx Λz π Λz Λz Λz The sets variables Z BNbased Back Front Door theorems called blocking sets block certain paths X Y BN Z blocks effect Y problem variables ignored calculating manipulated probability expression p y cid12 x In CEGanalogue blocking set partition w 0 w paths CEG sets Λz This different BN version events Z z outcome space Z partition set possible vectors problem variable values As BN version choose Λz carefully calculate estimate π Λ y cid12 Λx partially observed idle 31 Singular manipulations The commonest form manipulation BN Pearls Do X x intervention variable X set speciﬁc value x There functional manipulations form If Z z1 X x orIf Z z1 X x1 Z cid13 z1 X x2 In cases variable X set speciﬁed value In CEG equivalent manipulating pass set edges carrying speciﬁed label instance Example 3 intervention Do X3 1 Put Sprinkler imposes probability 1 edges labelled Pearls Do interventions functional manipulations enacted CEG examples singular manipulations These manipulations w 0 w path passes collection positions manipulation imposes probability 1 edge emanating positions The class singular manipulations includes subtle interventions instance Example 3 intervention If raining sprinkler pavement wet If X2 1 X3 0 X4 1 singular manipulation Whereas involve complicated analysis BN CEG diﬃcult simple Do X3 1 Stochastic manipulations singular These interventions impose new probability distribution values variable X case CEG outcome spaces selection positions Seeding clouds Example 3 example type intervention P Thwaites Artiﬁcial Intelligence 195 2013 291315 301 Deﬁnition 8 Singular manipulation A manipulation CEG C event Λ called singular exist sets W V C EΛ EC elements W partition Ω w 0 w path C passes precisely w W ii w W exists precisely emanating edge ew w iii Λ union precisely w 0 w paths pass ew w iv edge probabilities ˆCΛ equal corresponding edge probabilities C ˆπ Λ cid3 element EΛ cid3 EΛ e w cid3 w 1 w W ew w cid3 EΛ So Example 3 Put Sprinkler manipulation singular W w 3 w 4 w 5 w 6 EΛ ew 3 w 7 ew 4 w 9 ew 5 w 7 ew 6 w 9 set edges labelled Λ set w 0 w paths deﬁned CEG Fig 5 edgeprobabilities Fig 3 edges labelled probability 1 Similarly intervention If raining sprinkler pavement wet W w 3 w 5 w 9 w 10 EΛ ew 3 w 8 ew 5 w 8 ew 9 w 11 ew 10 w 11 Λ set w 0 w paths deﬁned manipulated CEG produced Fig 3 pruning position w 7 edges entering leaving w 7 edges ew 9 w 12 ew 10 w 12 Edgeprobabilities Fig 3 edges EΛ probability 1 32 A Back Door theorem singular manipulations cid3 X As consider effect events Λ y conditioning sets Λz distinguish manipulation event Λ adding suﬃx Λx We relabel set W W X positions W X w X edges Deﬁnition 8ii ew X w As set positions W X partitions Ω consider random variable X deﬁned Ω takes values labelled emanating edges w X w X probabilities dependent history problem position w X Example 2 histories positions w 7 w 8 respectively rain rain probability pavement wet different histories The singular manipulation Λx assigns probability 1 values X w X dependent history problem position w X So Λx form cid4cid4 cid9 cid3 Λx Λ w X W X cid3 e w X w cid3 X We interested effect event probability altered manipulation We deﬁne exactly way deﬁned Λx So deﬁne effect variable Y set positions W Y w Y w X w X W X w Y W Y partitions Ω w 0 w path C passes positions W Y Then Λ y consists paths passing w Y W Y utilise prespeciﬁed edge emanating w Y So Λ y form cid9 Λ y Λ w Y W Y cid3 cid3 e w Y w cid3 Y cid4cid4 Pearls Back Door Theorem depends assumption CBN expresses causal model edges represent causal dependencies Given assumption conditions theorem expressed terms topology unmanipulated CBN Since Dawid 5 Lauritzen 11 produced versions Back Door theorem incorporate similar causal assumptions express conditions terms conditional independence statements Dawid Lauritzen express conditions reference augmented DAGs possible produce conditions form conditional independence statements unaugmented DAGs So assuming CBN valid expression causal model Pearls Back Door conditions hold following conditional independence properties read DAG BN Z cid9 X Q X Y cid9 Q X X Z Z Back Door blocking set Q X variable parents X Note ignoring possibility Z Q X We return case Section 34 As noted Section 21 direct analogy CBNs causal modelling CEGs requires acceptance assump tion CEG expresses causal model If case conditional independence statements produce Back Door conditions topology CEG The ﬁrst properties tells pz q1 pz q1 x x value X z vector values variables Z q1 speciﬁed vector values variables Q X 302 P Thwaites Artiﬁcial Intelligence 195 2013 291315 The events X x Z z Q X q1 direct analogues singular manipulations CEGs X x corresponds event Λx union paths passing edge manipulation assign probability 1 Z z corresponds Λz element Back Door partition noting positions store history process point particular values taken parent variables position Q X q1 corresponds Λw X1 w X1 speciﬁc w X W X So pz q1 π Λz Λw X1 probability observing event Λz occurred given event Λw X1 occurred The term pz q1 x translated similarly expression pz q1 pz q1 x cid4 Λz Λw X1 π π cid3 cid3 cid4 Λz Λw X1 Λx cid8 π Λz Λw X1 cid9 cid3 cid3 e Λ w X w cid3 X cid4cid4 cid10 cid3 π Λz Λ cid3 cid3 e position w X1 W X w X W X cid3 X1 cid4cid4cid4 w X1 w 31 Condition 31 translates topology CEG The probability idle CEG event Λz conditioned passing position w X W X equal probability idle CEG Λz conditioned passing cid3 X edge leaving w X assigned probability 1 manipulation This condition edge ew X w hold w X W X The second properties tells p y x z p y q1 x z y value Y event Y y corresponds event Λ y Substituting expression gives π Λ y Λx Λz π π cid3 Λ y Λw X1 Λx Λz cid8 cid9 Λ y Λw X1 cid4 cid3 cid3 e Λ w X w cid3 X cid4cid4 Λz cid10 cid3 π Λ y Λ cid3 cid3 e w X W X cid3 X1 w X1 w cid4cid4 cid4 Λz 32 cid3 π Λ y Λ cid3 cid3 e w X1 w cid4cid4 cid4 Λz cid3 X1 cid3 π Λ y Λ cid3 cid3 e w X2 w cid4cid4 cid4 Λz cid3 X2 positions w X1 w X2 W X Condition 32 translates The probability idle CEG event Λ y Y y conditioned Λz passing edge ew X w cid3 X independent w X W X edge emanates Theorem 1 Back Door theorem With W X W Y Λx Λ y detailed Λz partition Ω Λz Back Door partition conditions 31 32 hold elements Λz w X W X A proof theorem appears Appendix A Recall Pearls Back Door conditions BNs refer explicitly sets problem measurement variables conditions 31 32 expressed terms events An event simple measurement variable taking particular value easily correspond collection variables taking combination values given set possible prior developments histories overlapping collection variables taking different combination values given different set possible prior developments So CEGbased Back Door theorem restrict analysis manipulations apply variable speciﬁc set variables blocking sets consist problem variables In Example 4 Back Door blocking set composed problem variables use produce identiﬁable probability expression eventbased Back Door theorem conditions 31 32 33 Checking conditions Back Door theorem One strengths Pearls Back Door theorem conditions checked directly topology idle BN The conditions Back Door theorem singular manipulations checked topology unmanipulated CEG This best illustrated example Example 4 Before look condition 32 little An advantage letting Λz collection events considerable ﬂexibility type events choose Each Λz form Λw union roottosink paths passing position w Λe P Thwaites Artiﬁcial Intelligence 195 2013 291315 303 Fig 7 BN CEG C Example 4 union roottosink paths passing edge e union events union roottosink paths ﬁts descriptions For remainder Section 3 use partitions Λz event associated collection positions Section 33 particular concentrate sets positions downstream manipulation positions precedes w X W X roottosink path Translating work events associated edges events associated positions upstream manipulation positions succeed w X W X roottosink path straightforward Some results upstream positions provided Section 34 focus basic Back Door theorem presented 26 We choose member Λz associated collection positions condition 32 automatically satisﬁed Let element Λz Back Door partition union events form Λw small collection positions Formally let V z V C set positions partitions Ω V z lies downstream W X upstream W Y downstream upstream Now elements V z exist C exist ˆCΛx So consider partition V z collection V 1 N number elements V z exist z V N z ˆCΛx V z contains precisely element V z exists ˆCΛx plus elements V z exist ˆCΛx Now let Λz consist N elements Λi z 1 N Λi z cid9 w zV z Λw z If choose Back Door partition Λz way condition 32 satisﬁed A demonstration provided Appendix A Example 4 Using Back Door theorem We illustrate use Back Door theorem medical example As earlier examples use binary variables illustrative convenience Our condition manifest forms C 1 2 Individuals adults develop condition forms display symptom S A age S B late teens Whether individual displays S A labelled variable A display S B variable B In cases variable takes value 1 symptom displayed value 0 There treatment T available eﬃcacy given individuals early teens Being treated labelled X 1 treated X 0 We life expectancy indicator Y dying age ﬁfty labelled Y 1 dying ﬁfty older Y 2 The relationships variables A X B C Y described portrayed CEG Fig 7 convenience edges labelled a0 A 0 Symptom S A missed doctors detected individual likely given treatment T We know distributions A X A 0 X A 1 We know X cid9 A 304 P Thwaites Artiﬁcial Intelligence 195 2013 291315 Evidence previous studies indicates Fig 8 Manipulated CEG ˆCΛx Example 4 individual displays symptom S B depends displayed symptom S A B cid9 X A displaying symptom means individual develop condition forms individuals displaying S A S B developing condition form 1 depend treatment T C cid9 X A 1 B 0 Also long live depends form condition develop Y cid9 X A 1 B 0 C individuals displaying S B developing condition form 1 depend displayed S A irrespective treated C cid9 A X B 1 Also long live depends treated form condition develop Y cid9 A X B 1 C If attempt portray problem BN look like Fig 7 Without considerable annotation BN express contextspeciﬁc conditional independence structure illustrated CEG We interested effects life expectancy treat everybody population early teens So consider singular manipulation Λx equivalent Do X 1 calculate probability π Λ y cid12 Λx P Y 1 cid12 X 1 The CEG satisﬁes conditions path passes position W X w 1 w 2 posi tion W Y w 8 w 11 w 12 w 16 Also position W X outgoing edge labelled x1 X 1 position W Y outgoing edge labelled y1 Y 1 Clearly A required variable Back Door blocking set Z based BN representation problem But know distribution A joint distribution involving A Can use Back Door theorem CEGs ﬁnd identiﬁable expression involving A In situations generally lot ﬂexibility determining Back Door partitionblocking set experimentation needed ﬁnd ideal allocation Here consider Λz form Λw The choice positions depend observe heavily inﬂuenced observation costs Note connection constraints choice positions subtle example clearly estimate P A 1 B 0 C 1 include position w 11 blocking set Here simply imagine constraints experimentation produced blocking set positions V z lying W X W Y comprising w 8 w 9 w 11 w 12 w 15 w 16 The CEG ˆCΛx given Fig 8 cid11 Checking condition 32 graph There 6 positions V z 4 appear ˆCΛx We combine cid11 original 6 positions produce 4 events form Λz Λw 65 different ways choice way depend number factors including particular combination satisﬁes condition 31 Here chosen Λ1 z Λw 9 Λw 15 Λw 16 The positions w 8 w 9 w 11 w 12 members V z exist ˆCΛx w 15 w 16 dont So result paragraphs immediately preceding Example 4 choice Λz satisﬁes condition 32 Λw 12 Λ4 z Λw 11 Λ3 z Λw 8 Λ2 z Checking condition 31 graph In Fig 7 earlier ﬁgures labelled edges probabilistic descriptions c1a1b0 This actually necessary forms probabilities completely speciﬁed topology P Thwaites Artiﬁcial Intelligence 195 2013 291315 305 colouring CEG In checking condition 31 need refer labels edges probability tables separate lists conditional independence properties For 31 need π Λz Λw X π Λz Λew X w cid3 X w X Λz This purely graphical manner Does π Λw 11 Λw 1 π Λw 11 Λew 1 w 3 π Λw 11 Λew 1 w 3 π Λw 11 Λw 3 Lemma 1 To w 1 w 11 w 3 w 4 probability 1 follow blue edge edge ew 7 w 11 To w 3 w 11 follow blue edge edge ew 7 w 11 So probabilities equal Similarly w 12 w 1 w 8 Does π Λw 9 Λw 15 Λw 16 Λw 1 π Λw 9 Λw 15 Λw 16 Λew 1 w 3 From Fig 7 Λw 15 Λw 16 Λw 10 To w 1 w 9 w 10 w 3 w 4 probability 1 follow red edge w 3 w 10 w 3 w 9 follow red edge So probabilities equal Similar quick checks w X w 2 conﬁrm Λz satisﬁes condition 31 Our manipulated probability expression p y1 cid12 x1 π Λ y cid12 Λx π Λ y Λx Λzπ Λz cid7 evaluated C simpliﬁes z pb0 p y1 b0 pb1 p y1 x1b1 So need know distribution B incidence symptom S B conditional distributions Y life expectancy events B 0 S B displayed X 1 B 1 treated S B displayed This expression involve A incidence S A interestingly involve C form condition takes It involve B impossible BN Fig 7 model B block Back Door paths X Y Note example gives insight choose component Λz partition If ﬁnd w z Λw z satisﬁes cid3 π Λw z Λ cid3 cid3 e w X w cid3 X cid4cid4cid4 cid3 cid4 Λw z Λw X π w X W X Λw z Λz Other Λz produced combining position w z exists ˆCΛx positions w z disappear create ˆCΛx way union associated events satisﬁes condition 31 w X W X 34 Using W X create Back Door partition If apply Pearls Back Door theorem BN Fig 3 use X1 Season blocking set manipu lation Do X3 1 described Example 3 Here X1 Q X3 set parents X3 blocking set type gives revised Back Door expression cid7 p y cid12 x p qx cid3 cid4 y x qx cid3 cid4 qx p qx runs possible vectors values Q X In example pslippery cid12 sprinkler pslippery sprinkler Spring pSpring pslippery sprinkler Summer pSummer The CEGanalogue use W X create Back Door partition So Section 33 let element Λz partition union events form Λw positions members W X In Section 32 suggested analogy Q X qx BNs Λw X CEGs In fact analogy perfect better analogy parents BN set stages positions Recall positions stage immediate future developments positions probability distribution sets emanating edges colour scheme Let element Back Door partition form Λz Λw X Λu X cid9 w X u X 306 P Thwaites Artiﬁcial Intelligence 195 2013 291315 u X event Λu X union roottosink paths passing position w X member stage u X Note w X W X needs member stage u X Λu X Λz ii w X u X cid3 X Λu X Λz needs element W X Also w X u X manipulated edges ew X w carry label colour These labels differ different stages This actually particularly restrictive set manipulations consider contains basic Do inter ventions BNs functional manipulations argument function subset parent set manipulated variable In fact argue set contains functional manipulations BN If manipulation functional value manipulate X depends value taken variable W essentially decision problem BN representation Inﬂuence Diagram ID representation X decision node Clearly value W known X manipulated ID representation edge W X example 23 W parent X Hence argue functional manipulations BNs argument function subset parent set manipulated variable Given conditions Λz new CEGbased Back Door probability expression π Λ y cid12 Λx cid7 cid3 π Λ y Λu X Λx cid4 cid3 cid4 Λu X π u X A demonstration result appears Appendix A For intervention Do X3 1 Put sprinkler set W X w 3 w 4 w 5 w 6 Fig 3 separates stages u3 w 3 w 4 u4 w 5 w 6 Now Λu3 Λw 3 Λw 4 Spring rain Spring rain Spring CEGbased expression identical BNbased 4 A Front Door theorem CEGs Pearls Front Door theorem 1415 BNs cases Back Door theorem conditions hold events needing observed Back Door theorem large observational cost Like Back Door theorem Front Door theorem provides conditions effects manipulation estimated subset variables observed unmanipulated Pearls Front Door theorem states certain conditions sets variables X Y Z write cid7 p y cid12 x pz x cid7 cid3 p cid3 y x z cid4 cid3 p cid4 cid3 x z xcid3 expression value estimated partially observed idle This expression complex Back Door theorem CEGanalogue imposes greater restrictions types manipulation consider We concentrate singular manipulations The expression suggests need sum variable corresponding variable X Hence need produce partition Ω Λx event manipulate element So instance Example 3 partition Ω events Λ1 x union roottosink paths passing edge labelled union roottosink paths passing edge labelled x Λ2 For simplicity look manipulations form Do X x consider positions w X W X number emanating edges edges carry labels w X Example 3 positions w 3 w 4 w 5 w 6 emanating edges labelled Note fairly regular problems depictable BNs histories parental conﬁgurations variable X probability particular outcome zero Although normally draw zeroprobability edges CEG case advisable edges emanating positions associated variable X Suppose CBN valid expression causal model Pearls Front Door conditions hold Then Back Door Theorem conditional independence properties read DAG BN These cid4 Z Q X Z cid9 Q X X Y cid9 X cid3 Note Z normally descendant X ancestor Y If CEG expresses causal model conditional independence statements produce Front Door conditions topology CEG The ﬁrst properties tells p y q1 z p y q1 xi z y value Y q1 speciﬁed vector values Q X z vector values Z Here xi value X event X xi corresponds event CEG form Λi X x w X W X edge ew X w X edge leaving w X labelled xi The set roottosink paths partitioned Λew X w w X W X cid11 P Thwaites Artiﬁcial Intelligence 195 2013 291315 307 Λi x manipulate element partition collection contains members edges leaving w X W X The event Λx Substituting CEGanalogues events Section 32 p y q1 z p y q1 xi z gives cid3 π Λ y Λw X1 Λz cid4 π cid3 Λ y Λw X1 Λi cid8 x Λz cid9 π Λ y Λw X1 cid4 cid3 cid3 e Λ w X w X cid10 cid4cid4 Λz cid3 π Λ y Λ cid3 cid3 e w X1 w X1 w X W X cid4cid4 cid4 Λz 41 cid3 π Λ y Λw X1 Λi x Λz cid4 cid3 π Λ y Λw X1 Λ j x Λz cid4 position w X1 W X elements Λi x Λ j x partition edges leaving w X1 Note Λz Front Door partition Ω present imposed restrictions form Λz example Section 33 Condition 41 translates topology CEG The probability idle CEG event Λ y Y y conditioned Λz passing edge emanating w X W X dependent edge utilised This condition hold w X W X Λz Front Door partition The second properties tells pz xi pz q1 xi Substituting expression gives cid3 cid3 π Λz Λi x cid4 π π Λz Λw X1 Λi x cid8 cid9 Λz Λw X1 cid4 cid10 cid4cid4 cid3 cid3 e Λ w X w X cid3 π Λz Λ cid3 cid3 e w X W X cid4cid4cid4 w X1 w X1 42 cid3 cid4 cid3 cid4 π Λz Λw X1 Λi x positions w X1 w X2 W X element Λi Λz Λw X2 Λi x π Condition 42 translates The probability idle CEG event Λz conditioned leaving position W X edge labelled xi independent position w X W X passed This condition hold edges xi values X x partition edge leaving w X W X 41 A Front Door theorem singular manipulations Theorem 2 Front Door theorem If W X W Y Λ y detailed Section 3 Λi x form detailed Λz partition Ω satisﬁes conditions 41 42 cid12 cid12 Λi ˆπ Λx Λ y π Λz Λx cid7 cid7 Λ y π π cid4 cid3 cid4 cid3 x Λz Λi x partition Ω individual Λi x z We Λz Front Door partition A proof theorem Appendix A Example 5 Using Front Door theorem We consider example 15 Section 333 reference Pearls hypothetical data This example relates debate concerning relationship smoking lung cancer summarised 24 In Pearls example vertices BN Fig 9 correspond binary variables follows X 1 smoker X 0 nonsmoker Y 1 lung cancer Y 0 lung cancer B 1 tar lungs B 0 tar lungs The variable A associated unobservable genetic tendency presence A 1 individual affects probability individual smokes lung cancer The variable B contrast observable Pearl 308 P Thwaites Artiﬁcial Intelligence 195 2013 291315 Fig 9 BN CEG C Example 5 Fig 10 Manipulated CEG ˆCΛx Example 5 uses BN possible estimate plung cancer cid12 smoker joint conditional distributions variables X B Y exist unobservable genetic tendency We demonstrate use Front Door theorem CEGs example The unmanipulated CEG given Fig 9 edges labelled a0 A 0 We consider manipulation Λx equivalent Do X 1 use Theorem 2 ﬁnd expression π Λ y cid12 Λx P Y 1 cid12 X 1 The manipulated CEG ˆCΛx given Fig 10 Note A observable use Back Door theorem CEGs W X w 1 w 2 doubling blocking set Section 34 possible element W X distinct stage For Front Door theorem W X w 1 w 2 partition Ω corresponding values X x union paths passing edge labelled x1 x union paths passing edge labelled x0 given Λ1 Λ2 The event Λ y union paths passing edge labelled y1 We use ﬂexibility CEG analysis Λz different form Section 33 instead union events form Λw union events form Λe So let Λ1 Λ2 z union paths passing edge labelled b1 z union paths passing edge labelled b0 P Thwaites Artiﬁcial Intelligence 195 2013 291315 309 Checking condition 41 graph π Λ y Λw 1 Λ1 x Λ1 z probability taking edge labelled y1 given passed position w 1 edge labelled x1 edge labelled b1 Note need know probabilities edges need refer separate list conditional independence properties Using Lemma 1 probability simply taking upper edge leaving w 7 given passed w 7 But clearly equal probability π Λ y Λw 1 Λ2 Using symmetry problem condition 41 holds x Λ1 z Checking condition 42 graph π Λz Λw 1 Λ1 x probability taking edge labelled b1 given passed position w 1 edge labelled x1 Using Lemma 1 probability blue edge But clearly π Λz Λw 2 Λ1 Using symmetry problem condition 42 holds x probability blue edge probabilities equal Our manipulated probability expression Theorem 2 evaluated C equal p y1 cid12 x1 cid7 b pb x1 cid7 x p y1 x b px So Pearl expression plung cancer cid12 smoker estimated joint conditional distributions variables X smoker B tar lungs Y lung cancer 42 An alternative form Front Door theorem At start Section 4 produced partition Ω Λx element conﬁned ma nipulations form Do X x This required consider positions w X number emanating edges edges carried label w X This restriction dilutes powerful reasons CEGs causal analysis possibility analysing complicated functional manipulations form Do X gW set variables W Corollary 1 gives alternative Front Door expression appropriate range singular manipulations It require knowledge probability distribution events Λw X w X W X joint conditional distributions including events As events correspond values problem measurement variable distributions easy quantify The Theorem 2 ver sion Front Door expression requires knowledge probability distribution events Λi x values problem variable X likely known Corollary 1 If W X Λx Λ y detailed Section 3 Λz partition Ω satisﬁes conditions 41 42 Λz Front Door partition cid7 ˆπ Λx Λ y π Λz Λx cid7 cid3 π Λ y Λw X Λz cid4 cid3 cid4 Λw X π z w X W X The proof corollary follows proof Theorem 2 line A4 Note partitions Λw X Λi x differ considerably size partition larger If estimate relevant probabilities choose versions Front Door theorem dependent relative size sets 5 Discussion As noted Introduction number recent advances BN theory concentrate representation analysis asymmetric problems analysis controlled models The CEG presented complementary graphical model appropriate analysis areas In section consider appropriate use CEGs BNs particular appropriate use causal analysis CBNs We consider CEGbased causal analysis develop future We use CEGs problems admit natural product space structure problem variables different sets possible outcomes possible outcomes given different vectors values ancestral variables In Example 1 warning light shows machine checked Example 4 individual displays symptom develop condition forms We use CEG degree problem asymmetry topology associated BN yields little information In Example 1 property judged faulty independent light 1 given light 2 read DAG In Example 4 conditional independence property readable BN B cid9 X A The signiﬁcant contextspeciﬁc conditional independence properties obscured 310 P Thwaites Artiﬁcial Intelligence 195 2013 291315 We note BN model expressible CEG problems sensible use graph This certainly case problems essentially symmetric beneﬁts concise graph outweigh having explicit representation outcome spaces problem variables We use CEGs causal analysis idle better modelled CEG example ideal analysis asymmetric controlled models treatment regimes We use analyse effects asymmetric manipulations functional stochastic interventions These manipulations tend fairly simple representation CEG analysis necessarily straightforward BN particularly manipulated variable value variable takes dependent values variables These types intervention require addition edges DAGrepresentation problem cause diﬃculties analyst trying ﬁnd suitable blocking sets We use CEGs causal analysis BNbased techniques ﬁnd identiﬁable expressions manipulated probabilities Any manipulated probability identiﬁable result Pearls Back Door theorem simple functional ma nipulation BN identiﬁable CEG representation However case noncausal analysis problems CBNs appropriate graph The obvious example idle essentially symmetric manipulations simple Do X x interventions occasions CEGbased analysis useful indicate Obviously use CEGbased Back Door theorem CEG causal analysis However reasons Pearls Back Door conditions easily checked topology CBN asset diminishes lot contextspeciﬁc information encoded DAG CBN manipulations complex Do X x interventions Furthermore Back Door theorem BNs requires analyst able calculate estimate pz p y x z values z blocking set variables Z With CEG partition need correspond ﬁxed subset measurement variables deﬁne BN This ﬂexibility useful events X Y Z taking certain vectors values unobservable large observational costs It useful measurements taken identiﬁcation usable function measurement variables prevent possibly expensive collection unnecessary information We seen Example 4 use CEG version theorem cases impossible use BN version model obey conditions speciﬁed Pearl The reasons outlined CEGbased Back Door theorem apply equally CEGbased Front Door theorem cid11 As indicated Example 4 65 possible partitions Λz satisﬁed condition 31 Λw z specifying positions w z ability choose Back Door partition restricting Λz form elements correspond vectors values problem variables gives lot ﬂexibility Now partition Λz ﬁxed sense membership constant Suppose let membership depend way whichever w X W X w 0 w path passes If choice possible partitions enormous It useful adapt Back Front Door theorems produce workable versions non singular manipulations type described 26 Section 32 automate search event space CEG partitions Λz satisfy conditions theorems Longer term aim produce necessary conditions causal identiﬁability expressed functions topology idle CEG In mirroring work 6172728 causal identiﬁability BNs Acknowledgements Much initial work leading paper whilst author supported EPSRC grant EPF0367521 Thanks referees useful comments helped markedly improve clarity paper Appendix A Proof Lemma 1 Consider single roottosink path λ passing w 1 w 2 w 3 This path consists set edges assign probability equal product primitive probabilities labelling edges Call probability π λ Moreover probability subpath λ equal product primitive probabil ities labelling edges So π λ written product probabilities subpaths μ0w 0 w 1 μ1w 1 w 2 μ2w 2 w 3 μ3w 3 w Thus π λ πμ0 w 1 w 0πμ1 w 2 w 1πμ2 w 3 w 2πμ3 w w 3 Consider event Λw 1 w 2 w 3 union roottosink paths passing w 1 w 2 w 3 Since Λw 1 w 2 w 3 intrinsic event Section 21 P Thwaites Artiﬁcial Intelligence 195 2013 291315 311 cid3 cid4 Λw 1 w 2 w 3 π cid8 cid7 cid10cid8 cid7 πμ0 w 1 w 0 cid10 πμ1 w 2 w 1 μ0M0 cid8 cid7 μ1M1 cid10cid8 cid7 πμ2 w 3 w 2 cid10 πμ3 w w 3 μ3M3 Mi 0 1 2 set subpaths w w i1 M3 set subpaths w 3 w But cid6 πμ0 w 1 w 0 πμ3 w w 3 simply probability reaching w w 3 equals 1 And μ2M2 cid6 μ3M3 μ0M0 probability reaching w 1 w 0 π Λw 1 Λw 0 So cid3 cid4 Λw 1 w 2 w 3 π cid3 cid4 Λw 1 Λw 0 π cid3 cid4 Λw 2 Λw 1 π cid3 cid4 Λw 3 Λw 2 π 1 Similarly cid3 π cid4 Λw 1 w 2 cid3 cid4 Λw 1 Λw 0 π cid3 cid4 Λw 2 Λw 1 π 1 cid3 cid4 Λw 3 Λw 1 Λw 2 π π Λw 1 w 2 w 3 π Λw 1 w 2 Λw 1 Λw 2 Λw 1 w 2 construction cid3 cid4 Λw 3 Λw 2 π cid2 Proof Theorem 1 ˆπ Λx Λ y cid7 cid3 ˆπ Λx w X W X Λw X Λ y cid7 cid4 w X W X cid3 cid4 Λw X cid3 cid4 Λ y Λw X ˆπ Λx ˆπ Λx Λw X form partition atomic events cid3 cid4 Λw X π cid3 cid4 Λ y Λw X ˆπ Λx cid7 w X W X cid7 w X W X cid7 w X lies upstream manipulation Deﬁnition 8iv cid3 cid4 Λw X π ˆπ Λx cid3 Λ y Λw X Λ cid4cid4 cid3 w cid3 X Λw X Λew X w cid3 X Λw cid3 cid4 Λw X π cid3 X ˆCΛx cid3 ˆπ Λx Λ y Λ cid4cid4 cid3 w cid3 X w X W X form speciﬁed Λ y fact w X w cid3 X From deﬁnition manipulation edge lying w w Y w Y W Y ˆCΛx result Lemma 1 cid3 cid3 X w path C remains ˆCΛx retains X ˆCΛx corresponds set pathsegments C cid3 X probability set original probability Hence set pathsegments starting w probability set Given form speciﬁed Λ y ˆπ Λx Λ y Λw pathsegments starting w cid3 cid3 ˆπ Λx Λ y Λ cid4cid4 cid3 w cid3 X X ˆCΛx Hence cid4cid4 cid3 Λ y Λ w cid3 cid3 X π ˆπ Λx Λ y cid7 cid3 cid4 Λw X π cid3 π Λ y Λ cid4cid4 cid3 w cid3 X w X W X cid7 w X W X cid3 cid4 Λw X π cid3 π Λ y Λ cid3 cid3 e w X w cid3 X cid4cid4 cid3 Λ w cid4cid4 cid3 X form speciﬁed Λ y fact ew X w w Y w Y W Y C result Lemma 1 cid7 w X W X cid3 cid4 Λw X π cid3 π Λ y Λ cid3 cid3 e cid3 cid3 X w X cid4cid4cid4 cid3 X w X w 312 P Thwaites Artiﬁcial Intelligence 195 2013 291315 Λew X w cid3 X Λw cid7 cid3 X C cid3 π Λw X cid4 cid7 cid3 π Λz Λ y Λ cid3 cid3 e w X w cid3 X cid4cid4cid4 Λz form partition atomic events w X W X z cid7 w X W X cid7 w X W X cid3 cid3 π π cid4 cid7 Λw X z cid4 cid7 Λw X z cid3 π Λ y Λ cid3 cid3 e w X w cid3 X cid4cid4 cid3 cid4 π Λz Λz Λ cid3 cid3 e w X w cid3 X cid4cid4cid4 π Λ y Λx Λzπ cid3 cid4 Λz Λw X A1 substituting 31 32 cid7 z π Λ y Λx Λzπ Λz cid2 Satisfying condition 32 Let Λz consist N elements form Λi z z position w z exists ˆCΛx Call position w i1 V z Consider expression π Λ y Λew X1 w cid3 X1 Λi ew X1 w cid3 X1 edge emanating w X1 assigned probability 1 manipulation Then z w X1 speciﬁed element W X edge cid11 w zV z Λw z 1 N cid3 π Λ y Λ cid3 cid3 e w X1 w cid3 X1 cid4cid4 cid4 cid3 π Λi z Λ y Λ cid3 cid3 e w X1 w cid4cid4 cid3 Λ w cid4 cid4 cid3 X1 Λi z cid3 X1 passing edge ew X1 w cid3 X1 necessarily entails passing position w cid3 X1 π Λi π Λi z z Λ y Λew X1 w cid3 Λew X1 w X1 Λw cid3 X1 cid3 X1 Λw cid3 X1 cid3 X1 π Λi z Λ y Λw cid3 Λw X1 π Λi z Lemma 1 Hence cid3 π Λ y Λ cid3 cid3 e w X1 w cid3 X1 cid4cid4 cid4 Λi z π But pathsegment C starting w cid3 cid3 cid4 cid4 Λi z cid3 X1 w Λ y Λ X1 remains ˆCΛx know w cid3 cid3 X1 w j z j cid2 2 ˆCΛx pathsegments joining w A2 j z jcid22 exist ˆCΛx cid3 j z j cid2 2 X1 w pathsegments joining w C Therefore cid3 cid4 cid4 cid3 cid3 X1 Λ w j z φ j cid2 2 Λ w cid3 Λ w cid4 cid3 X1 Λi z Λ cid3 w cid3 X1 cid4 cid3 Λ cid4 w i1 z expression A2 cid4cid4 cid4 cid3 cid3 cid3 cid3 cid3 e π Λ y Λ w X1 w Λ y Λ Λ y Λ Lemma 1 So Λ y conditionally independent position w X W X considered π π Λi z w i1 z w i1 z w cid3 cid3 cid3 X1 cid4cid4 cid3 cid4 Λ cid3 X1 cid4cid4 cid3 π Λ y Λ cid3 cid3 e w X1 w cid3 X1 cid4cid4 cid4 cid3 π Λi z Λ y Λ cid3 cid3 e w X2 w cid3 X2 cid4cid4 cid4 Λi z w X1 w X2 positions W X Hence condition 32 satisﬁed Lemma 2 W X based Back Door probability expression For CEG C w X W X V C w X u X LC Λx cid11 w X W X cid3 π Λew X w cid3 X edge ew X w cid4 Λx Λw X cid4 Λx Λu X π cid3 cid3 X w X u X carries label P Thwaites Artiﬁcial Intelligence 195 2013 291315 313 This tells probability leaving stage edge carrying particular label leaving component positions edge carrying label cid3 X label value X w X u X This case basic Do The equality holds edges ew X w interventions functional manipulations A3 cid3 X w X u X carry Proof cid3 cid4 Λx Λu X π cid8 π Λx cid9 cid10 Λw X w X u X cid11 π Λx cid11 π w X u X Λw X w X u X Λw X And events Λw X w X u X disjoint Deﬁnitions 1 3 equals cid6 w X u X cid6 π Λx Λw X π Λw X w X u X Consider speciﬁc w X u X Call w X1 Then cid14 cid13 cid9 Λx Λw X1 cid3 cid3 e Λ w X w cid3 X cid4cid4 Λw X1 w X u X cid3 cid3 e Λ w X1 w cid4cid4 cid3 X1 Λw X1 Λew X2 w cid3 X2 Λw X1 w X2 cid13 w X1 w X2 W X So π Λx Λw X written cid3 e cid4cid4cid4 cid3 cid3 π cid4 Λw X Λw X Λ cid3 X Λw X constant w X u X u X stage edges ew X w But π Λew X w label So probability outside summation cid4 Λw X w X w w X w π cid3 e cid4cid4 Λ cid3 X cid3 X π cid3 cid3 cid3 cid3 cid4 Λx Λu X π π Λew X w w X u X π Λw X cid6 cid3 X Λw X cid6 w X u X cid4cid4 π Λw X cid4 cid3 Λw X X cid3 X Λw X π cid3 cid3 Λ cid3 w X w e π Λew X w π Λw X π Λx Λw X π Λw X A3 cid3 cid4 Λx Λw X π cid2 W X based Back Door probability expression Using proof Theorem 1 write π Λ y cid12 Λx ˆπ Λx Λ y cid7 cid3 cid4 Λw X π cid3 π Λ y Λ cid3 cid3 e w X w cid3 X cid4cid4cid4 cid7 cid3 w X W X cid4 Λw X π cid3 π Λ y Λw X Λx cid4 w X W X cid7 cid7 cid3 cid4 Λw X π cid3 π Λ y Λw X Λx cid4 u X cid7 w X u X cid7 cid13 w X u X cid13 cid6 u X cid7 cid14 π Λw X Λx Λ y π Λx Λw X w X u X π Λw X Λx Λ y π Λx Λu X cid3 Λ y Λu X Λx cid4 π cid4 Λu X u X cid7 cid3 π u X cid14 π Λu X Λx Λ y π Λx Λu X cid13 cid7 cid14 u X cid2 314 P Thwaites Artiﬁcial Intelligence 195 2013 291315 Proof Theorem 2 This follows proof Theorem 1 line A1 We invoke conditions 41 42 cid4 cid4 cid7 cid7 cid3 cid3 ˆπ Λx Λ y π Λw X π Λ y Λw X Λz π Λz Λx w X W X cid7 π Λz Λx z cid7 cid3 π Λ y Λw X Λz cid4 cid3 cid4 Λw X π z cid7 z π Λz Λx Λi x forms partition Ω cid7 π Λz Λx w X W X cid7 cid7 w X W X cid7 cid7 cid3 π cid3 π Λ y Λw X Λz cid3 cid4 π Λw X Λi x cid4 A4 Λ y Λw X Λi x Λz cid3 cid4 π Λw X Λi x cid4 z w X W X condition 41 But cid3 π Λw X Λi x cid4 π Λw X Λi x Λz π Λz Λw X Λi x π Λw X Λi x Λz π Λz Λi x condition 42 So ˆπ Λx Λ y cid7 z cid7 z References cid3 π Λw X Λi x Λz cid4 cid3 cid4 π Λi x π Λz Λx cid7 cid7 cid3 π Λ y Λw X Λi x Λz cid3 cid4 π Λw X Λi x Λz cid4 cid3 cid4 π Λi x π Λz Λx w X W X cid7 cid3 π Λ y Λi x Λz cid4 cid3 cid4 π Λi x cid2 1 T Bedford R Cooke Probabilistic risk analysis Foundations methods Probabilistic Risk Analysis Foundations Methods Cambridge 2001 pp 99151 2 C Boutilier N Friedman M Goldszmidt D Koller Contextspeciﬁc independence Bayesian Networks Proceedings 12th Conference Uncertainty Artiﬁcial Intelligence 1996 pp 115123 3 GA Churchill Accurate restoration DNA sequences C Gatsaris et al Eds Case Studies Bayesian Statistics vol 2 SpringerVerlag 1995 pp 90148 4 AP Dawid Causal inference counterfactuals Journal American Statistical Association 95 2000 407448 5 AP Dawid Inﬂuence diagrams causal modelling inference International Statistical Review 70 2002 161189 6 AP Dawid V Didelez Identifying consequences dynamic treatment strategies A decisiontheoretic overview Statistics Surveys 4 2010 184 231 7 S French Ed Readings Decision Analysis Chapman HallCRC 1989 8 D Glymour GF Cooper Computation Causation Discovery MIT Press 1999 9 D Heckerman A Bayesian approach Learning Causal Networks W Edwards et al Eds Advances Decision Analysis CUP 2007 pp 202220 10 SL Lauritzen Graphical Models Oxford 1996 11 SL Lauritzen Causal inference graphical models OE BarndorffNielsen et al Eds Complex Stochastic Systems Chapman Hall 2001 12 R Lyons Random walks percolation trees Annals Probability 18 1990 931958 13 D McAllester M Collins F Periera Case factor diagrams structured probabilistic modeling Proceedings 20th Conference Uncertainty Artiﬁcial Intelligence 2004 pp 382391 14 J Pearl Causal diagrams empirical research Biometrika 82 1995 669710 15 J Pearl Causality Models Reasoning Inference Cambridge 2000 16 J Pearl Statistics causal inference A review Sociedad Estadistica e Investigacion Operativa Test 12 2003 281345 17 J Pearl JM Robins Probabilistic evaluation sequential plans causal models hidden variables Proceedings 11th Conference Uncertainty Artiﬁcial Intelligence 1995 pp 444445 18 D Poole NL Zhang Exploiting contextual independence probabilistic inference Journal Artiﬁcial Intelligence Research 18 2003 263313 19 JM Robins A new approach causal inference mortality studies sustained exposure period application control healthy worker survivor effect Mathematical Modelling 7 1986 13931512 20 A Salmeron A Cano S Moral Importance sampling Bayesian Networks probability trees Computational Statistics Data Analysis 34 2000 387413 21 G Shafer The Art Causal Conjecture MIT Press 1996 22 JQ Smith PE Anderson Conditional independence Chain Event Graphs Artiﬁcial Intelligence 172 2008 4268 23 JQ Smith PA Thwaites Inﬂuence diagrams EL Melnick BS Everitt Eds Encyclopedia Quantitative Risk Analysis Assessment vol 2 Wiley 2008 pp 897910 24 P Spirtes C Glymour R Scheines Causation Prediction Search SpringerVerlag 1993 P Thwaites Artiﬁcial Intelligence 195 2013 291315 315 25 PA Thwaites JQ Smith RG Cowell Propagation Chain Event Graphs Proceedings 24th Conference Uncertainty Artiﬁcial Intelligence Helsinki 2008 pp 546553 26 PA Thwaites JQ Smith EM Riccomagno Causal analysis Chain Event Graphs Artiﬁcial Intelligence 174 2010 889909 27 J Tian Identifying dynamic sequential plans Proceedings 24th Conference Uncertainty Artiﬁcial Intelligence Helsinki 2008 pp 554 561 28 J Tian J Pearl A general identiﬁcation condition causal effects Proceedings 18th National Conference Artiﬁcial Intelligence AAAI Press 2002 pp 567573