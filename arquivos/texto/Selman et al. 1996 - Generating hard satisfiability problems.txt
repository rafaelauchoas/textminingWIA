Artificial Intelligence 81 1996 1729 Artificial Intelligence Generating hard satisfiability problems Bart Selman David G Mitchell bl Hector J Levesque bv2 AI Principles Research Department ATT Bell Laboratories Murray Hill NJ 07974 USA b Department Computer Science Vniversiry Toronto Toronto Canada M5S IA4 Received May 1993 revised May 1995 Abstract We report results largescale experiments satisfiability testing As observed testing satisfiability random formulas appears surprisingly easy Here right distribution instances appropriate parameter values possible generate random formulas hard satisfiability testing difficult Our results provide benchmark evaluation satisfiability testing procedures Keywords Satisfiability Random problems Phase transitions 43 Benchmarks Empirical study 1 Introduction Many computational tasks AI extent precisely characterized shown NPhard general form However fundamental disagreement AI community impli cations It claimed hand performance algorithms designed solve NPhard tasks degrades rapidly small increases input size need given obtain acceptable behavior On hand argued analysis irrelevant AI based worstcase scenarios An earlier version paper Corresponding Work carried visiting ATT Bell Laboratories author Telephone 291 presented AAAI92 908 5822221 Email selmanresearchattcom Email mitchellaitorontoedu 2 Fellow Canadian Institute Advanced Research Supported grant Natural Sciences Engineering Research Council Canada Email hectoraitorontoedu 00043702961500 SSDIOOO4370295000453 1996 Elsevier Science BV All rights reserved 18 B Sehan et alArtcial Intelligence 81 1996 1729 needed better understanding average procedures perform The computational task shown NPhard Cook 9 propositional makes tasks shown NPhard proving true according formula SAT Unlike NPhard SAT Given formula propositional variables Subsequent satisfiability assignment interpretation hard SAT Roughly task NPhard good algorithm SAT special concern given collection base facts 2 sentence satisfiable Many forms reasoning planning usually fact SAT fundamental essential AI applications require propositional image interpretation AI direct relationship calculus decide usual rules entail tasks 171 catalogue deductive reasoning good algorithm Y deduced iff Z U TX including default reasoning diagnosis direct appeal satisfiability The fact calculus work task developing SAT procedures simply highlights We ask reasonable settle result strange encodings answering expected difficulty SAT time rely largely empirical questions tailored use sound complete procedure SAT Do hard cases come specific purpose One difficulty results It appear applicable analytical results A number papers discussed claimed difficulty SAT randomly generated problems result Goldberg polynomial practice blush worst cases suggests 20 SAT readily time This settle question methods work AI contrived solved average relevant appear daunting For example oftenquoted instances Goldberg The big problem assume distribution 141 refuted choice distribution easy distribution preponderance space problem hard cases Nevertheless examine procedure average Indeed discuss Franc0 Paul1 It Goldberg clever algorithm problem easy instances That way produced direct consequence appear purporting result showing papers continue empirically sampled instances efficacy new procedure presenting propositional given easy problems danger biasing data suggesting variablescan large satisfiability solved How evaluate sample unwittingly suit procedure distribution problemswith demonstrate 22241 thousands results question simply empirical In paper present empirical results showing random fiability generated particular SAT procedure robustness procedures develop want consider wide spectrum examples While way easy hard sets instances predictable advance easy cases s01ved performance instances satis If care B Selman et alArtificial Intelligence 81 1996 1729 19 Procedure DP Given set clauses 2 defined set variables V If 2 contains unit clause C assign variable men truth value satisfies C return result calling DP If E return satisfiable If _E contains clause return unsatisfiable UnitClause Rule tioned simplified Splitting Rule Select V variable u assigned truth If formula value Assign returns satisfiable set u opposite value return value DP simplified return satisfiable Otherwise result calling DP resimplified formula formula Fig 1 The DP procedure reasonable method losers Thus data presented challenging SAT procedures example The SAT procedure tests DavisPutnam Selman et al 3 13234 hard cases ultimately separate test material winners developers procedure 16351 case resolution widely general good choice reasons First equivalent reasoning AI second recently empirical work SAT testing We believe particular method refinement method facilitates comparison We suspect results hard easy areas generalize extension remain 29 The primary observations This paper larger sample sizes 10000 arguments formulas point 500 eliminates sampling error gives clearer picture behaviors We added data Section 3 average cost truth assignments We improved data comparing formula models extended clarified updated references added especially theoretical median number satisfying different Section 4 Some discussions SAT procedures satisfying truth assignments previous random results report organized follows In Section 2 Davis Section 3 study performance distribution produces computationally fixed clause length model We right choice parameter In Section 4 consider challenging SAT instances testing procedures We briefly review related work Section constant density model argue useful The rest paper Putnam procedure formulas values second distribution evaluation satisfiability 5 summarize results Section 6 2 The DavisPutnam procedure One widely methods 121 Our procedure refer DP splitting propositional satisfiability testing DavisPutnam procedure 20 B Selman et alArtcial Intelligence 81 1996 1729 variant DavisPutnam procedure described 111 pure literal rule The pure literal rule literal p occurs formula negation p immediately assigned value true DP sketched Fig 1 It takes input set clauses _Z set variables Y returns satisfiable unsatisfiable A clause disjunction literals A set clauses represents conjunction disjunctions formula conjunctive normal form CNF DP performs backtracking depthfirst search space truth assignments incrementally assigning truth values variables simplifying formula If new variable assigned value producing clause backtracks changing previously variable assignment In implementation variables given arbitrary ordering splitting step choose variable according ordering set true The performance simple backtracking greatly improved employing unit clause rule Whenever clause containing single literal arises variable occurring clause immediately assigned appropriate truth value The formula simplified lead new unit clauses This process unit propagation executed time linear total number literals 3 The fixed clause length model In section study formulas generated fixed clause length model random KSAT There parameters number variables N number literals clause K number clauses M To volume data presented manageable detailed picture limit attention formulas K 3 random 3SAT Some data values K 262833 For given N M instance random 3SAT produced randomly generating M clauses length 3 Each clause produced randomly choosing distinct variables set N available negating probability 05 Note method generation allows duplicate clauses formula strictly speaking formulas sequences clauses sets However N gets large duplicates rare generally select linear number clauses Most analytical work random KSAT uses model We consider performance DP random formulas Fig 2 shows total number recursive calls DP satisfying assignment determine formula unsatisfiable There curves formulas 2040 50 variables Along horizontal axis ratio clauses variables number clauses normalized division number variables Each data point gives median number calls random sample 10000 formulas We use medians instead means means number calls heavily influenced small number extremely large values Although occur rarely values large variance large mean But current bulk instances distribution like unusual extreme cases As median robust presence B Sehnun et al Articial Intelligence 81 1996 1729 21 20variable 40variable 50variable formulas I formulas Sk formulas Number gfIJ calls 2500 2000 1500 1000 500 0 2 3 4 5 6 7 8 Ratio clausestovariables Fig 2 Median number recursive DP calls random 3SAT formulas function ratio clauses variables outliers 11 appears informative statistic current purposes 3 In Fig 2 following pattern For formulas relatively short relatively long DP finishes quickly formulas medium length longer Since formulas clauses underconsrruined satisfying assignments assignment likely early search Formulas clauses overconstrained usually unsatisfiable contradictions easily search completed quickly Finally formulas harder relatively satisfying assignments clause generated assigning values variables resulting deep search tree Similar overconstrained areas random instances NPcomplete problems 8361 The curves Fig 2 formulas given size composites satisfiable unsatisfiable subsets In Fig 3 median number calls 50variable formulas factored satisfiable unsatisfiable cases showing sets different The extremely rare unsatisfiable short formulas hard rare long satisfiable formulas remain moderately difficult Thus easy parts composite distribution appear consequence relative abundance short satisfiable formulas long unsatisfiable ones To understand hard area terms likelihood satisfiability experimen tally determined probability random 50variable instance satisfiable Fig 3 A reasonable question ask big sample required good estimate mean Because potentially exponential nature problem increase sample size continue larger rarer samples place mean 18331 22 B Selman et alArrQicial Intelligence 81 1996 1729 Number bfP calls 2000 0 2 4 3 5 Ratio clausestovariables 6 7 8 Fig 3 Median DP calls 50variable random 3SAT function ratio clauses variables Probability 1 08 06 04 0 2 4 3 5 Ratio clausestovariables 6 7 8 Fig 4 Probability satisfiability 50variable formulas function ratio clauses variables peak curve number 4 There remarkable recursive 05 The main empirical conclusion draw hardest area satisjiability near point 50 formulas satisjiable probability calls point formula correspondence satisfiable This 50satisfiable point occur fixed ratio number clauses 43 times number effect small formulas location gradually occurs 455 formulas 20 variables 436 number variables number clauses variables There boundary decreases N 50point 50 variables determined We conjecture variables The peak hardness described point confirmed detailed experiments 50 satisfiable point These observations 10271 100 variables DP exhibits 431 43 150 variables empirically ratio approaches 425 large numbers behavior 50satisfiable performance DP improved clever variable While heuristics ter easyhardeasy challenging 438 unlikely pattern The formulas selection heuristics qualitatively al hard area appear strategies tested conjecture B Selman et alArtifcial Intelligence 81 1996 1729 23 bfIJ Number 15000 calls 10000 5000 0 35 4 5 45 55 Ratio clausestovariables 65 6 7 75 8 Fig 5 Searching assignments Median DP calls 50variable random 3SAT function ratio clauses variables Larrabee DavisPutnam heuristic method This conjecture supported workers Tsuji 271 satisfiability procedure different example procedure hard easy areas The phenomenon Fig 4 called threshold phenomenon phase variables 43 For transition Our results phase unsatisfiable discussion phase transition observe KSAT 261 transition phase ratio clauses relation general phase satisfiable phase transition phenomena probability satisfiability specific In terms known theoretically The general case K 2 challenging threshold conjecture random 3SAT variables probability satisfiability approaches 0 For case 2SAT shown 1 61319 recent progress substantial transition So far shown N gets large probability random 3SAT satisfiable approaches 0 3003 151 approaches 1 ratio greater 4758 seen empirical best theoretical bounds ratio clauses approaches 1 ratio open problem theoretical bounds instance variables 251 As results agreement finegrained true threshold ratio clauses narrowing insight To search performed DP consider happens let DP search space stop procedure soon assignment Fig 5 gives total number recursive calls Again data point gives median value sample 10000 formulas We size variables search space monotonically This consistent expectation longer deeper search tree We takes DP run contradiction formulas average search tree somewhat DP This intuitively tends relatively long branches assignments The search space underconstrained decreasing fewer clauses explained fact assignment order satisfy clauses generates assign variables larger satisfiable ratios clauses formula satisfying increases 24 B Selman et al Artificial Intelligence 81 1996 1729 le06 10000 Number solutions 1000 100 1 3 35 4 45 5 55 6 65 Ratio clausestovariables Fig 6 Median number satisfying assignments satisfiable 50variable random 3SAT formulas function ratio clauses variables Note logarithmic scale formulas quickly extremely large For example ratio 33 200000 recursive calls satisfiable instances Note large search space problem searching single assignment Part reason satisfying assignments underconstrained formulas This shown Fig 6 In figure median number satisfying assignments satisfiable random 3SAT formulas function ratio clauses variables Each data point based 10000 instances For example ratio 33 formulas 110000 satisfying assignments When searching single satisfying assignments DP able early search 4 The constantdensity model We examine formulas generated constantdensity model The model parameters number variables N number clauses M instead fixed clause length clauses generated including variable clause given probability P negating probability 05 Large formulas generated way clause unit clauses tend trivially unsatisfiable easily shown satisfiable Thus interesting results modified version unit clauses disallowed This distribution random PSAT Analytic results Franc0 Paul1 141 suggest probably generate computationally challenging instances model experiments confirm prediction In Fig 7 compare number recursive DP calls solve instances random PSAT random 3SAT number variables In case set probability P average clause length 3 Although slight easyhardeasy pattern previously noted Hooker Fedjki 23 hard area nearly pronounced random 3SAT formulas similar size absolute terms random PSAT formulas easier Note B Selman et alArtifcial Intelligence 81 1996 1729 25 10000 t I 1 I 25var KSAT 50 KSAT t 25var PSAT B 50var PSAT x DP calls 1000 100 10 2 3 Ratio 4 6 clausestovariables 5 7 8 Fig 7 Comparison median DP calls fixedlength 3SAT constantdensity formulas average clause length 3 25 50 variables Table 1 Number DP calls hardest point fixedlength KSAT constantdensity PSAT formulas 25 50 75 variables The numbers brackets indicate number literals clause PSAT model avenge number literals clause Variables 25 50 7s KSAT 3 253 3683 469 15 Formula distribution PSAT 3 PSAT 4 33 68 111 53 157 392 logarithmic represents greater difficulty scale number DP calls greater height 3SAT curve rate growth difficulty random 3SAT formulas median number DP calls hardest point curve Further Table 1 gives random 3SAT random PSAT For comparison include numbers clause random higher formulas function number variables random PSAT expected growth rate table clearly shows large difference length 4 Again It argued larger PSAT formulas sufficiently challenging formula models formulas easy comparison Some data larger formulas type sized random KSAT difficult N results formulas Moreover host analytical gets large instances family distributions easy solve Our experimental mode1 suitable strongly suggest 24281 While results analytical results strongly suggest constantdensity testing procedures comparably evaluating satisfiability 26 B Selman et alArtifcial Intelligence 81 1996 1729 5 Related work recently random satisfiability results The main consisted analytic large body literature testing formulas impetus SAT fact solvable average DP Franc0 Paul1 141 showed Goldbergs There research early results Goldberg efficiently variant positive constantdensity modeland formulas easy satisfy algorithm simply tried randomly generated assignments probability constant number guesses Further analytic distribution overly optimistic Goldbergs results constantdensity model 53037 results direct consequence 1 satisfying assignment 201 suggested approaching useda instances Franc0 Paul1 141 investigated fixed clause length 3 suggested random fixed ratio clauses truth assignments probability ratio clauses expected expected approaching variables hypothesis confirmed experimentally DP forced variables time exponential 1 number variables approaches performance DP random formulas useful generating They showed satisfying number variables infinity keeping tell result directly fixed Unfortunately time single assignment 7 gives A result Chvatal Szemeredi 2 11 showed approaching resolution 1 unsatisfiable insight Extending ground requires ex random 3SAT formulas strategy variables held constant Random 3SAT formulas approaching 1 251 So given DP corresponds ratio clauses particular resolution variables follows average time complexity formulas strategy ratio clauses result Haken time probability breaking ponential unsatisfiable probability greater 4758 mentioned exponential variables result applies variables Chvatal Szemeredis fixed number variables varying number variables n Our results fixed 4 They growth DP tree exponential This result appear inconsistent claim overconstrained formulas pattern formulas number clauses case ratio easy Our results easyhardeasy given ratio clauses increase number variables clauses keeping clauses function ratios hard area grows faster easy overconstrained confirmed recent results highlyoptimized lo Experiments Crawford Auton procedure difference consistently 50000clause formulas area This variant DP developed hard area ratio 43 257 This For example DP lOOOvariable 1290clause determine instances 3SAT 300variable scales 217 ratio 10 scaling growth rate important practical consequences solve So called takes seconds practically exponential unsatisfiability easy area suggest 4 To state differently consider Fig 2 Chvatal Szemeredi analyze scaling behavior going vertical direction given fixed ratio clauses variables B Selman et alArtcial Intelligence 81 1996 1729 21 definitely easy compared formulas hard area 50point lower values n easy useful test formulas For formulas larger numbers variables eventually truly easy area occur higher ratios clauses variables Turning underconstrained formulas behavior DP partially explained fact tend satisfying truth assignmentssee Fig SO procedure finds early search For ratios 3003 simple heuristic algorithm finds satisfying assignments random 3SAT high probability polynomial time 151 Other analytic results random 3SAT reviewed 3525 As mentioned Section 3 establishing theoretically exact nature satisfi ability transition random KSAT K 2 challenging open problem The experimental data suggests threshold satisfiability 425 clauses variable case 3SAT Threshold phenomena common types combinatoric structures random graphs 21 Not experimental results consistent analytic results provide finegrained picture 3SAT behaves practice One reason limitations analytic results complexity analyses required Another asymptotic hold limit number variables goes infinity necessarily tell formulas modest number variables thousand encountered practice A valuable contribution Cheeseman et al 81 explored hardness random instances NPcomplete problems They observed similar easy hardeasy pattern function problem parameters instances graph coloring Hamiltonian circuit They preliminary results satisfiability But exactly formulas generated fully specify test procedure findings based relatively small formulas 25 variables Possibly preliminary nature investigation observe know generate hard SAT instances transformation hard graph coloring problems instance distribution certainly somewhat different random 3SAT 6 Conclusions There debate AI importance worstcase complexity results NPhardness results In particular suggested satisfiability testing easy average We carried detailed study averagecase difficulty SAT testing random formulas We confirmed previous observations instances easy showed hard instances generated The fixed clause length model roughly 43 times clauses variables gives computationally challenging instances 05 probability satisfiable Randomly generated formulas fewer clauses easy 28 B Selman et alArttjcial Intelligence 81 1996 1729 Our data provide important lessons The constantdensity model inappropriate evaluating satisfiability procedures dominated easy instances values parameters The second necessarily case generating larger formulas provides harder formulas For example DP solve lOOOvariable 3000clause underconstrained lOOOvariable 50000 clause overconstrained random 3SAT instances seconds On hand consistently solve random 3SAT instances 300 variables 1290 clauses Because random 3SAT instances readily generated hard area useful evaluation satisfiability testing procedures algorithms related tasks Boolean constraint satisfaction We hope results help prevent inaccurate misleading reports averagecase performance SAT procedures Acknowledgements We thank James Crawford Larry Auton providing efficient tableau code modified obtain fast implementation DP We thank Henry Kautz useful discussions comments Fahiem Bacchus helpful comments earlier draft The second authors funded Natural Sciences Engineering Research Council Canada Institute Robotics Intelligent Systems References I 1 RJ Beckman RD Cook Outlier s Technometrics 25 2 121 B Bollobas Random Graphs Academic Press London 1985 3 1 A Broder A Frieze E Upfal On satisfiability maximum satisfiability random 3CNF formulas Proceedings Fourth Annual ACMSIAM Symposium Discrete Algorithms 1993 322 330 1983 119149 14 1 M Buro H KleineBurring Report SAT competition Technical Report I 10 Department Mathematics Informatics University Paderbom Germany 1992 5 I M Chao J France Probabilistic analysis generalization unitclause literal selection I61 I91 I71 181 heuristics k satistiability problem Inform Sci 51 1990 2342 V Chvatai B Reed Mick gets odds Proceedings FOCS92 1992 620627 V Chvatal E Szemeredi Many hard examples resolution J ACM 35 4 1988 759208 P Cheeseman B Kanefsky WM Taylor Where hard problems Proceedings IJCAI91 Sydney Australia 1991 163169 SA Cook The complexity theoremproving procedures Proceedings 3rd Annual ACM Symposium Theory Computing New York 1971 151158 JM Crawford LD Auton Experimental results crossover point satisfiability problems Proceedings AAAI93 Washington DC 1993 M Davis G Logemann D Loveland A machine program theoremproving Commun ACM 5 1962 394397 M Davis H Putnam A computing procedure quantification theory J ACM 7 1960 201215 1121 13 I WF la Vega On random ZSAT Manuscript 1992 I I4 I J Franc0 M Paull Probabilistic analysis Davis Putnam procedure solving satistiability III I 1101 problem Discrete Appl Math 5 1983 7787 B Sebnan et alArtificial Intelligence 81 1996 1729 29 I5 1 A Frieze S Suen Analysis simple heuristics random instance kSAT Manuscript 1992 1 I6 1 Z Galil On complexity regular resolution DavisPutnam procedure Theoret Comput Sci 4 1977 2346 1 17 1 MR Carey DS Johnson Computers Intracrability A Guide Theory NPCotnplereness Freeman New York 1979 I8 1 IP Gent T Walsh Easy problems hard Artit Intell 70 1994 335345 19 1 A Goerdt A threshold unsatisfiability Manuscript 1991 I20 1 A Goldberg On complexity satisfiability problem Courant Computer Science Report No 16 New York University New York 1979 21 1 A Haken The intractability resolution Theor Comput Sci 39 1985 297308 122 I JN Hooker Resolution vs cutting plane solution inference problems computational experience Uper Res Len 7 1 1988 i7 I23 1 JN Hooker C Fedjki Branchandcut solution inference problems propositional logic Ann Math Arr Intell 1 1990 123139 1241 AI Kamath NK Karmarker KG Ramakrishnan MGC Resende Computational experience interior point algorithm satisliability problem Proceedings Integer Programming Combinatorial Optimization Waterloo Ont 1990 333349 I 25 I AP Kamath A Motwani R Palem P Spirakis Tail bounds occupancy satisfiability threshold conjecture Proceedings FOCS94 1994 26 I S Kirkpatrick B Selman Critical behavior satisfiability random Boolean expressions Science 264 1994 12971301 127 1 T Larrabee Y Tsuji Evidence satisfiability threshold random 3CNF formulas Proceedings AAAI Spring Symposium AI NPhard problems Palo Alto CA 1993 28 I DG Mitchell HJ Levesque Some pitfalls experimenters random SAT Artif Intell 81 I I l125 volume 129 I DG Mitchell B Selman HJ Levesque Hard easy distributions SAT problems Proceedings AAAI92 San Jose CA 1992 459465 30 I P Purdom A survey average time analyses satisfiability algorithms J Inform Process 13 4 1990 131 I B Selman Stochastic search phase tmnsitions Al meets physics Proceedings IJCAI95 Montreal Que 1995 1321 B Selman H Kautz B Cohen Local search strategies satisfiability testing DIMACS Series Discrete Marhemarics Theoretical Computer Science ACM Press Providence RI 1996 preliminary version Proceedings AAAI94 Seattle WA 1994 337343 I 33 I B Selman S Kirkpatrick Critical behavior computational cost satisfiability testing Artif Intell 81 1996 273295 volume 134 I B Selman HJ Levesque DG Mitchell GSAT new method solving hard satisfiability problems Proceedings AAAI92 San Jose CA 1992 440446 135 I A Vellino The complexity automated reasoning PhD Thesis Department Philosophy University Toronto Toronto Ont 1989 I36 I CP Williams T Hogg Using deep structure locate hard problems Proceedings AAAI92 San Jose CA 1992 472277 I37 I LC WU CY Tang Solving satisfiability problem randomized approach Inform Process Letr 41 1992 187190 I 38 I R Zabih D McAllester A rearrangement search strategy determining propositional satisfiability Proceedings AAAI88 St Paul MN 1988 155160