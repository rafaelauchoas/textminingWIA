Artiﬁcial Intelligence 172 2008 18371872 Contents lists available ScienceDirect Artiﬁcial Intelligence wwwelseviercomlocateartint Outlier detection default reasoning Fabrizio Angiulli Rachel BenEliyahu Zohary b1 Luigi Palopoli DEIS Università della Calabria Via Pietro Bucci 41C 87036 Rende CS Italy b BenGurion University Jerusalem College Engineering BeerShevaJerusalem Israel r t c l e n f o b s t r c t Article history Received 5 March 2007 Received revised form 9 July 2008 Accepted 29 July 2008 Available online 15 August 2008 Keywords Default logic Disjunctive logic programming Knowledge representation Nonmonotonic reasoning Computational complexity Data mining Outlier detection 1 Introduction Default logics usually regular behavior normal properties domain elements In paper suggest conversely framework default logics exploited detecting outliers Outliers observations expressed sets literals feature unexpected semantical characteristics These sets literals selected explicitly embodied given knowledge base Hence essentially perceive outlier detection knowledge discovery technique This paper deﬁnes notion outlier related formalisms specifying defaults Reiters default logic extended disjunctive logic programs For formalisms ﬁnding outliers complex Indeed prove versions outlier detection problem lie second level polynomial hierarchy We believe thorough complexity analysis useful preliminary step developing effective heuristics exploring tractable subsets outlier detection problems 2008 Elsevier BV All rights reserved This paper detecting outliers In work outliers unexpected observations strange characteristics individuals given application domain Exceptionality determined respect given trustable knowledge base given set elements comply The issue address locate unusual elements automatically A ﬁrst step automatically detecting outliers state formal deﬁnition In work assumed given knowledge base expressed default reasoning language formalize deﬁnition outliers framework The languages mainly dealt propositional default logics extended disjunctive logic programs Default logic originally developed tool working incomplete knowledge Default rules allow normal behavior draw consequent conclusions As default rules exploited detecting outliersobservations unexpected according default theory hand This basic idea paper We refer outliers sets observations demonstrate properties contrasting logically justiﬁed according given knowledge base Along outliers witnesses singled outthose unexpected properties characterize outliers To illustrate informal application examples outlier detection described This manuscript extended comprehensive report results appeared IJCAI03 title Outlier Detection Using Default Logic ECAI04 title Outlier Detection Using Disjunctive Logic Programming Corresponding author Email addresses fangiullideisunicalit F Angiulli rachelbguacil R BenEliyahu Zohary palopolideisunicalit L Palopoli 1 Part work author visiting scholar Division Engineering Applied Sciences Harvard University Cambridge Massachusetts 00043702 matter 2008 Elsevier BV All rights reserved doi101016jartint200807004 1838 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 Using outliers diagnosis hardware Suppose usually takes seconds download giga byte ﬁle server day slower instead seconds needed perform task While seconds indicate good performance nonetheless helpful ﬁnd source delay order prevent critical faults future In case download operation outlier delay witness Mechanical failure Assume someones car brakes making strange noise Although functioning properly normal behavior car brought servicing In case car brakes outlier noise witness Knowledge base integrity If abnormal property discovered database source reported information checked Detecting abnormal properties detecting outliers lead update default rules knowledge base For example suppose rule birds ﬂy observe bird ﬂy This occurrence outlier theory reported knowledge engineer The engineer investigates case ﬁnds bird actually penguin updates knowledge base default penguins ﬂy According approach exceptions explicitly recorded knowledge base abnormals logicalbased abduction 162347 Rather abnormality singled precisely properties characterizing justiﬁed given theory In paper formally deﬁne outliers related formalisms Reiters default logic Extended disjunctive logic programming EDLP Reiters Default Logic powerful nonmonotonic formalism deal incomplete information logic program ming practical tool widely employed KRR The paper deals propositional fragment logics However ﬁrstorder default theories shall brieﬂy discussed paper Section 5 In logic programming framework focus Answer Set Semantics advanced systems knowledge representation 384043 Extended logic programs ELP Answer Set Semantics allow negation fail ure classical negation These programs naturally embedded default theories considered subset default logic As consequence results default theories carry simply ELPs However unlike ELP extended disjunctive logic programs EDLP Answer Set Semantics headdisjunction allowed viewed subset default logic default logic volume include disjunction Indeed motivation developing disjunctive logic programming lies limitations default logic han dling disjunctive knowledge paper Poole 47 In context EDLP considered convenient tool representing manipulating complex knowledge 38 declarativity expressive power In follows ﬁrst introduce formal deﬁnition outliers Then analyze complexities involved incorporating outlier detection mechanism knowledge bases expressed default logic extended disjunctive logic programs We believe thorough complexity analysis useful step singling complex subtasks involved outlier detection This ﬁrst step conducive designing effective algorithms implementation purposes According view adopted work witness observation outlier property behavior explicitly opposite expected Representing contradicting properties requires usage classical negation Both default logic extended logic programs use classical negation Hence languages repre sent natural setting outlier detection A different approach require negation exceptional property explicitly inferred simply entailed logic program taken 5 As explained thoroughly paper anomalies singled deﬁnition 5 different outliers detected work presented This mirrored different complexity ﬁgures obtained outlier detection problems investigated lie level polynomial hierarchy complex problems considered 5 contained second level In sequel elaborate differences The rest paper organized follows Section 2 provides preliminary deﬁnitions Section 3 deﬁnes outliers related notions Section 4 discusses complexity ﬁnding outliers general propositional disjunction free default logics Section 5 deals ﬁrstorder defaults Section 6 discusses related workin particular relationship outlier detection abduction Finally Section 7 draws conclusions 2 Preliminary deﬁnitions In section brieﬂy review preliminary deﬁnitions default logic extended disjunctive logic programs Note propositional fragment logics considered Outlier detection ﬁrstorder default languages shall brieﬂy discussed Section 5 Thus default theory logic program variables referred abbreviation grounded version F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1839 21 Default logic Default logic ﬁrst introduced Reiter ﬁrstorder setting 49 Next recall basic deﬁnitions concerning propositional fragment default logic Let T propositional theory S set propositional formulas Then logical closure T S set s s S A set literals L inconsistent literal denote T cid2 L cid2 L A propositional default theory cid3 pair D W consisting set W propositional formulas set D default rules In paper deal ﬁnite default theories A default theory cid3 D W ﬁnite set default rules D set propositional formulas W ﬁnite A default rule δ form α β1 βm γ 1 α βi 1 cid2 cid2 m γ propositional formulas In particular α called prerequisite β1 βm called justiﬁcations γ called consequent conclusion δ The prerequisite missing jus tiﬁcation consequent required justiﬁcation tantamount having identically true literal true Ray Reiter Personal communication 1992 speciﬁed place If conclusion default rule included justi ﬁcation rule called seminormal 25 conclusion identical justiﬁcation rule called normal A default theory containing seminormal defaults called seminormal Given default rule δ preδ justδ conclδ denote prerequisite justiﬁcation consequent δ respectively Analogously given set default rules D δ1 δn preD justD conclD denote respectively sets preδ1 preδn justδ1 justδn conclδ1 conclδn A propositional default theory cid3 D W disjunction free DF short 33 W set literals preδ justδ conclδ conjunctions literals The informal meaning default rule δ stated follows If preδ known hold consistent assume justδ infer conclδ The formal semantics default theory cid3 deﬁned terms extensions denote maximal sets conclusions drawn cid3 Thus E extension theory cid3 D W satisﬁes following set equations E0 W cid3 0 E i1 E cid2 E i0 E γ αβ1βm γ D α E β1 E βm E An extension E ﬁnite propositional default theory cid3 D W ﬁnitely characterized set DE generating defaults E wrt cid3 4958 In fact 58 shows ﬁnite propositional default theory cid3 D W extension E iff exists set DE D generating defaults E wrt cid3 partitioned ﬁnite number strata D n E 1 E D 0 E D 0 E δ δ DE preδ W D 1 cid2 cid2 n D δ DE β justδβ W conclDE δ Dpreδ W conclDE β justδβ W conclDE δ DE j E preδ W concl E δ δ DE E j i1 j0 D i1 j0 D cid2 cid2 If set DE exists E W conclDE extension cid3 For case DF theories useful rewrite deﬁnition extension 33 Let cid3 D W DF default theory Then E extension cid3 exists sequence defaults δ1 δn D sequence sets E0 E1 En 0 E0 W E E i1 conclδi preδi E i1 cid10 c justδic En cid10 δ Dpreδ En conclδ cid10 En cid10 c justδc En E logical closure En En called signature set E denoted litsE sequence rules δ1 δn set DE generating defaults E Although default theories nonmonotonic normal default theories satisfy property semimonotonicity The cid12 W default theories D D orem 32 49 That Let cid3 D W cid3cid12 D extension E cid3 extension E cid3cid12 E E cid12 cid12 cid12 1840 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 A default theory extensions like theory β β Then default theory called coherent extension incoherent Normal default theories coherent A coherent default theory cid3 D W called inconsistent extension inconsistent By Theorem 22 49 theory cid3 inconsistent iff W inconsistent The entailment problem basic problems KR formalisms For default theories follows Given default theory cid3 propositional formula φ extension cid3 contain φ In aﬃrmative case write cid3 cid14 φ For set propositional formulas S analogously write cid3 cid14 S denote φ S cid3 cid14 φ The entailment realizes form reasoning called skeptical cautious reasoning 18 22 Extended disjunctive logic programs A literal expression form cid2 cid2 cid2 propositional letter symbol denotes classical negation A propositional EDLP collection rules form L1 Lk Lk1 Lm Lm1 Ln n m k cid3 0 symbol denotes negation default Li literal If k 0 rule called integrity clause If 0 cid2 k cid2 1 rule said nondisjunctive A propositional ELP collection nondisjunctive rules An EDLP given semantics answer sets 26 deﬁned follows Let LitP denote set literals obtained propositional letters occurring P By context 12 mean subset LitP Let P negation bydefaultfree EDLP A context S closed P rule L1 Lk Lk1 Lm P Lk1 Lm S 1 k Li S An answer set P minimal context S 1 S closed P 2 S inconsistent S LitP For general EDLPs answer sets deﬁned follows Let reduct P wrt context S denoted RedP S EDLP obtained P deleting rule L body L S ii remaining subformulas form L rule bodies Then context S answer set RedP S answer set P The collection consistent answer sets EDLP P denoted ANSWP An EDLP P ANSWconsistent iff S ANSWP P cid14 G ANSWP cid10 An EDLP P entails propositional formula F written P cid14 F F S set propositional formulas G means F GP cid14 F 23 Complexity theory Some basic deﬁnitions complexity theory recalled particularly polynomial time hierarchy The reader referred 3145 details Decision problems mappings strings encoding input instance suitable alphabet yes The language associated decision problem set strings alphabet decision problem outputs yes A possibly nondeterministic Turing machine M answers decision problem given input x branch M halts accepting state iff x yes instance ii branches M halt rejecting state iff x instance NPcid9P k cid10P cocid9P More generally classes cid9P The class P set decision problems answered deterministic Turing machine polynomial time The class decision problems solved nondeterministic Turing machine polynomial time denoted NP class decision problems complementary problem NP denoted coNP k form polynomial hierarchy deﬁned follows cid9P k cid9P k cid3 1 cid9P k1 cid10P k k use oracle solving problem cid9P constant computational cost Thus NP cid9P conjunction independent problems cid9P language L DP problem cid10P k modeled computability nondeterministic polynomial time Turing machine k1 An oracle loosely speaking subprogram run k k cid3 1 class problems deﬁned k That problem associated k L2 associated k languages L1 associated problem cid9P k Finally need recall notion reduction A decision problem A1 polynomially reducible decision prob lem A2 polynomial time computable function h x hx deﬁned A1 output yes input x iff A2 outputs yes input hx A decision problem A complete class C polynomial hierarchy iff A belongs C problem C polynomially reducible A 2 L L1 L2 Note k cid3 1 cid9P k cid10P 1 coNP cid10P 1 The class DP P cid10P 0 DP k cid9P k1 0 A wellknown cid9P k complete problem decide satisﬁability formula QBEk formula form X1 X2 Q Xk f X1 Xk Q k odd k X1 Xk disjoint sets variables f X1 Xk propositional formula conjunctive normal form k odd disjunctive normal form k set variables X1 Xk Analogously deciding validity formula QBEk formula form X1 X2 Q Xk f X1 Xk Q k odd k f X1 Xk propositional formula disjunctive normal form k odd conjunctive normal form k set variables X1 Xn F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1841 complete cid10P complete DP k k Finally deciding conjunction cid11 cid12 cid11 QBEk formula cid12 QBEk formula 3 Outliers Next shall formally deﬁne notion outlier context default logic extended disjunctive logic pro gramming Also shall introduce number signiﬁcant decision problems shall queries associated singling outliers 31 Outliers default logic We start deﬁning concept outlier default logic To motivate deﬁnition clarify present examples Example 31 Consider following default theory represents knowledge birds normally ﬂy penguins normally ﬂy Moreover know penguins birds Also observed Tweety bird Pini penguin Tweety ﬂy cid3 D W cid5 Birdx Flyx Flyx Penguinx Flyx Flyx cid4 BirdTweety PenguinPini FlyTweety cid6 cid6 cid5 Penguin X Bird X This default theory extensions One extension logical closure W BirdPini FlyPini logical closure W BirdPini FlyPini As FlyTweety W extensions include literal But Tweetys ﬂying strange Indeed known birds normally ﬂy Tweety bird apparent justiﬁcation fact Tweety ﬂy FlyTweety belonging W Were Tweety penguin Tweetys ﬂying promptly explained But theory stands Tweetys ﬂying inexplicable Moreover try nail makes exceptional notice dropped observation FlyTweety W exact opposite concluded Tweety ﬂy But FlyTweety BirdTweety dropped W longer concluded Tweety ﬂies Hence FlyTweety looked consequence fact Tweety bird Thus BirdTweety observation considered exceptional FlyTweety determines exceptionality A set literals like BirdTweety called outlier set literals like FlyTweety called witness set following In sum deﬁne outlier observation characterized exceptional semantical property In logic observation denoted set literals Such sets literals going denote anomalous characteristics elements world knowledge base encodes bird named Tweety example Therefore follows talk informally outliers individuals clear formally outliers observations encoded sets literals We formal deﬁnition outlier We use following notation given set W list sets S1 Sn W S1Sn denotes set W S1 S2 Sn Deﬁnition 32 Outliers outlier witness set default logic L et cid3 D W propositional default theory let L W set literals2 If exists nonempty set literals S W L D W S cid14 S ii D W SL cid10cid14 S L outlier set cid3 S outlier witness set L cid3 If L L cid3 L minimal outlier set outlier witness set S cid12 cid12 cid12 L S cid12 W Lcid12 According deﬁnition default theory Example 31 conclude BirdTweety denotes outlier set FlyTweety witness Remark 33 We point regard outlier detection kind data mining technique Therefore explicitly observed facts accordingly outliers witnesses deﬁned sets literals explicitly included set observations W 2 Note preliminary version work 4 outlier deﬁned single literal In work generalize deﬁnition sequel scenarios original deﬁnition restrictive 1842 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 ii In situations useful analyst allowed provide speciﬁc set outliers witnesses mined This certainly sensible interesting idea application viewpoint However use different deﬁnition outliers according idea difference conceptual theoretical development going present following Next shall illustrate deﬁnition examples Example 34 A wellknown center rare diseases located small city Lamezia Calabria One hot day summer walking nice streets Lamezia notice young man wearing heavy coat going direction In situation student school medicine interested genetic diseases want ask man rare illness Another way fact man wearing coat hot summer day makes outlier probable explanations time place behavior man rare genetic disease A default theory cid3 describes episode follows cid3 D W cid5 Dayx Warmx Person y WearCoat y x WearCoat y x cid4 cid6 DayTuesday WarmTuesday PersonJim WearCoatJim Tuesday This theory claims normally person wear coat warm day The observations Tuesday day Tuesday warm Jim person wearing coat Tuesday This preferably conclude Jim argument outlier Indeed reader verify following facts true D W WearCoatJimTuesday cid14 WearCoatJim Tuesday 1 D W WearCoatJimTuesdayPersonJim cid10cid14 WearCoatJim Tuesday 2 D W WearCoatJimTuesdayDayTuesday cid10cid14 WearCoatJim Tuesday 3 D W WearCoatJimTuesdayWarmTuesday cid10cid14 WearCoatJim Tuesday Hence PersonJim DayTuesday WarmTuesday WearCoatJim Tuesday unique outlier witness set minimal outliers theory Outlier witnesses deﬁned sets general single literal suﬃce form witness given outlier We illustrate following example Example 35 Consider default theory cid3 D W set default rules D conveys following information weather traﬃc SummerWeekendTraﬃc_JamAccidentTornado AccidentTornado accident occurred tornado hit freeway normally traﬃc jam summer weekend ii AccidentPoliceAmbulance iii TornadoPoliceAmbulance PoliceAmbulance PoliceAmbulance normally accident occurred police ambulances normally tornado hits freeway police ambulances Suppose W SummerWeekend Traﬃc_Jam Police Ambulance Then set S Police Ambulance cid12 Traﬃc_Jam Note lier witness outlier L SummerWeekend outlier L singleton witness outlier Example 36 Consider following default theory cid3 cid3 D PlantOwnerx MakesMoneyx MakesMoneyx GoodWillingx WantsReducedPollutionx WantsReducedPollutionx PlantOwnerx GoodWillingx Donatesx Donatesx cid5 W PlantOwnerJohnny GoodWillingJohnny MakesMoneyJohnny DonatesJohnny WantsReducedPollutionJohnny cid4 cid6 This theory claims normally plant owners money goodwilled plant owners interested reduced pollution donations The observations Johnny goodwilled plant owner money interested reduced pollution makes donations Therefore interesting KR automatically conclude Johnny argument outliers Indeed reader verify following facts true F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1843 D W MakesMoneyJohnny cid14 MakesMoneyJohnny ii D W WantsReducedPollutionJohnny cid14 WantsReducedPollutionJohnny iii D W MakesMoneyJohnnyPlantOwnerJohnny cid10cid14 MakesMoneyJohnny iv D W WantsReducedPollutionJohnnyGoodWillingJohnny cid10cid14 WantsReducedPollutionJohnny Hence MakesMoneyJohnny WantsReducedPollutionJohnny outlier witnesses PlantOwnerJohnny GoodWillingJohnny corresponding outliers Finally following example demonstrates sensible deﬁne outlier set single literal Example 37 Consider set default rules D conveying following information watering grass normally sprinkler grass wet WetGrass normally raining grass wet sprinkler normally operate winter SprinklerOnWetGrass WetGrass ii RainWetGrass iii SprinklerOnWinterTime iv WinterTime WinterTimeChimneySmoke ChimneySmoke normally smoke chimney winter time ﬁreplace Now suppose outliers deﬁned single literals Then observation W 1 Rain WetGrass Rain outlier witness set WetGrass Similarly observations W 2 SprinklerOn WetGrass SprinklerOn outlier witness set WetGrass However observation W 3 SprinklerOn Rain WetGrass outliers singled This D W WetGrass cid14 WetGrass ii D W WetGrassRain cid14 WetGrass D W WetGrassSprinklerOn cid14 WetGrass However Rain SprinklerOn dropped W longer possible infer WetGrass Rain WetGrass outlier according deﬁnition witness set WetGrass For example suppose set D W 4 SprinklerOn ChimneySmoke Then SprinklerOn outlier witness ChimneySmoke observations W 6 WinterTime WinterTime outlier witness ChimneySmoke However SprinklerOn ChimneySmoke outliers outlier deﬁned single literal WinterTime SprinklerOn outlier according deﬁnition outlier witness ChimneySmoke observations W 5 WinterTime ChimneySmoke If Thus deﬁnition restricts outlier single literal restrictive cid2 32 Outlier detection extended disjunctive logic programs We deﬁne concept outlier context EDLP Within reasoning framework assume general knowledge world encoded extended disjunctive logic program D called rule program factual evidence aspects current status world encoded set literals W called observations set Thus ruleobservations program P pair P D W consisting rules program observations set Intuitively ruleobservations program relates general knowledge encoded D evidence world encoded W In following denote P D W EDLP D W Also given disjoint subsets L S W denote P S logic program D W S P SL logic program D W S L In context EDLP knowledge bases deﬁnition outlier analogous given framework default logic Deﬁnition 32 Deﬁnition 38 Outliers outlier witness set extended logic programs Let ruleobservations program P D W set literals L W given If exists nonempty set literals S W L P S cid14 S ii P SL cid10cid14 S L outlier set S outlier witness set L P All motivating examples given Section 31 default logic framework Example 35 translated EDLP For instance default theory given Example 31 translated EDLP follows Let P D W W BirdTweety FlyTweety Bird X Penguin X D set 1844 cid5 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 Fly X Bird X Fly X cid6 Fly X Penguin X Fly X Analogous showed Section 31 trying understand makes Tweety exception notice drop observation FlyTweety conclude exact opposite Tweety ﬂy Thus FlyTweety witness according Deﬁnition 38 Furthermore drop observations FlyTweety BirdTweety longer able conclude Tweety ﬂies This implies FlyTweety consequence fact Tweety bird BirdTweety outlier In example use disjunctive information represented EDLP headcyclefree 11 We interested fullﬂedged EDLP main reasons First noted 11 headcyclefree EDLPs faithfully translated disjunctionfree logic programs Second disjunctionfree programs equivalent subset default logic expressive power strictly general disjunctive programs 18 The following example adapted 15 We assume situation goods set G produced companies set C owned set stock holders H Each good produced companies company produce goods Suppose currently H produces goods G means companies represents business advantage competitors Hence owners policy prescribes company c C safely sold H loose capability producing goods Therefore owners consider safely sellable company belongs minimal sets companies producing goods The situation complicated presence control relationship companies company c controlled triplet companies c1 c2 c3 If case c considered safely sellable controlling companies c1 c2 c3 safely sellable Call strategic company safely sold according owners policy The owners need know companies safely sold The situation formalized EDLP follows There literals form prodg c1 c2 good g denote good g produced companies c1 c2 We use literal prodg c c denote good g produced company c There literals form contrc c1 c2 c3 denote c controlled c1 c2 c3 Rules P follows company strategic consistent assume strategic X strategic X companies producing good strategic strategicY strategicZ prod X Y Z company controlled strategic companies strategic strategicW contrW X Y Z strategic X strategicY strategicZ normally strategic companies sellable unsell X strategic X unsell X We recall establish company c strategic setting cid10P 2complete problem 15 expressed means disjunctionfree logic program disjunctionfree logic programs express problems complex coNP Now assume following literals observed cid5 W prodg1 c1 c2 prodg2 c1 c3 prodg3 c2 c3 prodg4 c2 c4 prodg5 c3 c4 prodg6 c1 c4 cid6 prodg7 c2 c5 contrc5 c1 c2 c3 contrc5 c1 c2 c4 contrc5 c2 c3 c4 unsellc5 Then evident outlier observations Indeed according formal deﬁnition unsellc5 outlier witness outlier contrc5 c1 c2 c3 33 Some extensive examples In section extensive application examples proposed framework 331 Learning knowledge base integrity Assume database examples givenboth positive negative examples We want acquire knowledge abstracts examples A way learn rules encoding knowledge Clear expressive rule language employed learning purposes richer description example database properties learnt process In context techniques induce defaults examples applied guarantee capability encoding defeasible cid9P 2 properties database instance learning Horn rules result possibility encoding certain polynomial time properties For instance techniques 2042 applied F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1845 Once set default rules learned outlier detection techniques applied checking abnormality occurring knowledge base Next example application framework learning default theories proposed 20 First recall deﬁnition learned default theory provided there3 Deﬁnition 39 Learning default theory 20 Given set positive examples E e pe assumed true e E true e E theory consists ﬁnding set D defaults cid9 e1 e2 en predicate p cid12 pe assumed 1 e initial consistent set ﬁrst order formulas W containing occurrence p learning default set negative examples E cid12 2 e cid12 m cid9 cid7 cid8 cid7 cid8 D W cid14 pe pe eE eE Informally speaking4 default rules learnt method reported 20 following form ϕ X p X ψ X p X ϕ X p X ψ X p X resp cid7 cid9 formula ϕ X generalizes positive negative resp examples formula ψ X generalizes exceptions ϕ X negative positive resp examples generalized ϕ X Consider following set ﬁrstorder formulas W bird4 bird5 mam6 mam7 mam8 mam9 bat10 superpen11 bird3 pen2 pen1 pen X bird X superpen X pen X bat X mam X pen stands penguin mam stands mammal Assume following set positive negative examples concerning predicate ﬂies given 3 4 5 10 11 1 2 6 7 8 9 E E cid5 cid6 ﬂies3 ﬂies4 ﬂies5 ﬂies10 ﬂies11 cid5 ﬂies1 ﬂies2 ﬂies6 ﬂies7 ﬂies8 ﬂies9 cid6 Using technique 20 learn following set defaults D δ1 bird X ﬂies X pen X δ3 superpen X ﬂies X ﬂies X ﬂies X δ2 pen X ﬂies X superpen X δ4 bat X ﬂies X ﬂies X ﬂies X δ5 mam X ﬂies X bat X ﬂies X Let cid3 D W D W deﬁned Assume set facts W ins bird12 ﬂies12 added theory cid3 theory cid3ins D W W ins obtained Then theory cid3ins set L bird12 outlier witness S ﬂies12 Indeed cid3cid12 D W W ins S cid3cid12 cid14 ﬂies12 means default rule bird Xﬂies Xpen X cid3cid12cid12 D W W ins ﬂies X SL cid3cid12cid12 cid10cid14 ﬂies12 bird12 longer entailed cid3cid12cid12 An outlier indicate functioning wrong actions taken In example hand individual 12 unhealthy requires cured If believed outlier removed knowledge base basically accomplished different procedures context example hand According ﬁrst procedure acknowledged bird 12 penguin literal pen12 added theory cid3ins According second procedure recognized 12 ﬂy wings broken Consequently fact sick12 added set W 12 added set negative examples novel set defaults Drev taking account kind exception learned In particular set Drev differ set D default rules δ1 δ2 replaced following ones δrev 1 δrev 2 bird X ﬂies X pen X sick X ﬂies X pen X sick X ﬂies X superpen X ﬂies X 3 A slightly different deﬁnition provided authors 42 4 The reader referred 20 details 1846 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 It interesting stress relationships outliers learned default theories Let cid3 D W learned added Assume pc W theory assume set facts W outlier witness set outlier cid12 pc cid14 pc c behaves positive example L W W stated exact opposite pc negative example provided update set W A similar reasoning followed case witness set pc cid12 Then case D W W cid12 cid12 cid12 332 A biological rule database For reasons realm biology interesting applying outlier detection techniques First rules biology exceptions Second domain completely known Third knowledge base data base tools bioinformatics applications critically needed 44 With aid biologist formalized following knowledge base central dogma molecular biology process according DNA sequences translated proteins The knowledge base cid3bio Dbio W bio follows Rule1 Rule2 Rule3 Rule4 Rule5 Rule6 Rule7 Rule8 DNAS transRNAS transRNAS DNAS promS transRNAS transRNAS transRNAS RBSS transProteinS transProteinS transProteinS degS degS DNAS promS promS transRNAS RBSS RBSS recDegS foundSubseqS foundSubseqS transProteinS degS foundProteinS foundProteinS Rule9 foundProteinS foundProteinS oldS foundSubseqS foundSubseqS Rule11 promS repS transRNAS Rule10 Rule12 promS transRNAS Rule13 degS recDegS oldS Rule14 foundSubseqS degS Normally generic DNA sequence transcribed RNA Normally DNA sequence having promotor transcribed RNA Normally transcribed DNA sequence Ribosomal Binding Site translated protein Normally translated protein degradated Normally DNA sequence doesnt promotor Normally transcriptable RNA sequence Ribosomal Binding Site Normally protein degradated recently broken subse quences wet lab experimental sample Normally sequence translated protein protein degradated protein experimental sample Normally proteins experimental samples Normally degradated protein old subsequences It known repressor binds promotor region DNA sequence sequence transcribed It known promoter region DNA sequence transcribed It known degradated proteins degra dated recently old ones It known broken subsequences experi mental sample protein degradated Assume results different wet lab experiments encoded following sets literals cid5 cid5 W exp 1 W exp 2 DNAseqA promseqA RBSseqA foundProteinseqA cid6 cid6 DNAseqB promseqB repseqB RBSseqB foundSubseqseqB foundProteinseqB Then theory Dbio W bio W exp sets DNAseqA promseqA RBSseqA outliers witness foundProteinseqA Indeed sets include indications protein Therefore concluded repressor binds promotor region DNA sequence protein degradated Also theory Dbio W bio W exp outliers In particular L repseqB foundSubseqseqB minimal outlier having witness S foundProteinseqB In fact surprising protein repressor present broken subsequences lab sample 1 2 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1847 Table 1 Complexity results outlier detection Query Theory Normal default EDLP Normal DF default ELP Outlier Outlierk OutlierL OutlierS OutlierkS OutlierSL OutlierminL OutlierminSL cid9P cid9P cid9P DP DP DP DP 3 complete 3 complete 3 complete 2complete 2complete 2complete 3complete 3complete cid10P cid9P cid9P cid9P 2 complete 2 complete 2 complete DPcomplete DPcomplete DPcomplete DP 2complete 2complete cid10P 4 Complexity results In section study computational complexity underlying outlier detection problems Formal proofs results present reported Appendix A results Section 42 concerning default theories Appendix B results Section 43 concerning extended disjunctive logic programs Below provide theorems informal outline proofs To start deﬁne outlier detection problems going analyze 41 Outlier detection queries result summary In order analyze computational complexity underlying outlier detection refer decision problems called queries deﬁned These queries refer given knowledge base KB KB default theory cid3 D W EDLP ruleobservations program P D W Outlier Given KB exist outlier set KB Outlierk Let k constant positive integer Given KB exist outlier set cardinality k KB OutlierL Given KB set literals L W L outlier KB OutlierS Given KB set literals S W S witness outlier set L KB OutlierkS Let k constant positive integer Given KB set literals S W S witness outlier set L cardinality k KB OutlierSL Given KB set literals S W set literals L W L outlier witness S KB Furthermore interested complexity abovedeﬁned problems minimal outliers singled Thus consider following additional queries OutlierminL Given KB set literals L W L minimal outlier KB outlier OutlierminSL Given KB set literals S W set literals L W L minimal outlier S cid12 L KB L cid12 L witness set L KB Note complexity query asking existence minimal outlier set obviously query Outlier outlier exists given theory minimal Complexity results summarized Table 1 explained It clear Table 1 answering outlier detection problems propositional normal general disjunctionfree resp default theories turns hard answering propositional disjunctive nondisjunctive resp extended logic programs 42 Complexity outlier detection Reiters default logic In subsection analyze complexity associated detecting outliers general DF propositional fault logic We preliminarily notice membership results established general theories general disjunctionfree theories hardness results established strict subset normal theories Hence complexity results hold overall normal default theories general default theories We start analysis query Outlier general set Given default theory query asks exists outlier theory Theorem 41 On propositional default theories Outlier cid9P 3 complete general default theories cid9P 2 complete DF theories 1848 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 Proof outline It follows Deﬁnition 32 Cmembership query Outlier given propositional default theory cid3 D W C denotes suitable complexity class proved building nondeterministic Turing machine T simultaneously guesses disjoint subsets L S s1 sn W veriﬁes cid12 D W S cid14 s1 sn entailment problem q D W SL cid10cid14 s1 sn entailment problem q cid12cid12 class coCe Thus T employ Ce oracle solve q Let Ce complexity class entailment problem cid3 Then problem q cid12cid12 q C NP coNP DF propositional default theories 33 As consequence query Outlier belongs classes NPcid9P NPNP cid9P class Ce problem Hence query Outlier class 2 general propositional default theories 2754 3 2 general propositional default theories DF propositional default theories respectively Ce Recall entailment problem cid10P cocid9P 2 cid9P q cid12cid12 2 cid12 cid12 Completeness proved reducing cid9P k complete k 2 3 problem deciding validity QBEk formula Outlier The reader referred Appendix detailed proof cid2 Let turn analyzing second query Given theory positive integer number k query Outlierk asks existence outlier size k theory The complexity query stated Theorem 42 On propositional default theories Outlierk cid9P DF default theories 3 complete general theories cid9P 2 complete propositional Proof outline Bounding size outlier change complexity singling Indeed member ship witness set S outlier set L L cid2 k guessed rest proof follows line reasoning outlined Theorem 41 As hardness construction referred Theorem 41 holds outlier set L employ proof size 1 complies possible value k cid2 Next focus query OutlierL It turns knowing outlier set L advance reduce com plexity wrt general Outlier query particular number possible outlier witness sets S W L L exponential This summarized following theorem Theorem 43 On propositional default theories OutlierL cid9P 3 complete general theories cid9P 2 complete DF theories Proof outline The Theorem 41 cid2 Given default theory set literals S query OutlierS asks S witness set outlier theory It turns complexity OutlierS lower complexity Outlier This candidate outlier witness set S given need check potential outlier witnesses exponential number potential witnesses The result given following theorem Theorem 44 On propositional default theories OutlierS DP 2complete general theories DPcomplete DF theories cid12 cid10P 2 DF propositional default theories coNP As problem q introduced proof Proof outline In order prove membership refer entailment problems q outline Theorem 41 time outlier witness set S ﬁxed advance We recall general propositional 2 default theories q NP general theories DF theories respectively provided L known standard entailment problems general DF default theories However possible q belongs classes L answered showing exists set L W S extension E theory D W SL known Indeed q S E Thus nondeterministic polynomial time Turing machine T M built guesses simultaneously set L W S subset D E D generating defaults extension E D W SL ordering rules D E Then T M proceeds follows cid9P q cid12cid12 cid12cid12 cid12cid12 cid12 cid12cid12 general propositional default theories T M uses NP oracle check conditions D E satisfy set generating defaults E b verify s1 sn E These steps performed executing polynomially bounded number calls NP oracle DF default theories T M checks conditions D E satisfy set generating defaults extension E disjunctionfree theory b veriﬁes s1 sn E checking 1 cid2 cid2 n si conclusion default D E These steps performed polynomial time F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1849 Thus general default theories OutlierS conjunction independent problems belonging cid10P DP NP OutlierS DP 2 2 For DF default theories OutlierS conjunction independent problems coNP 2 cid9P As hardness consider following decision problem problem q Given independent default theories cid31 cid32 letters s1 s2 problem q verify following true cid31 cid14 s1 cid32 cid10cid14 s2 problem q For general propositional default theories q DP 2complete problem testing cid32 cid10cid14 s2 cid9P 2 complete 2754 For DF propositional default theories q DPcomplete problem testing cid31 cid14 s1 coNPcomplete testing cid32 cid10cid14 s2 NPcomplete 33 Then hardness query OutlierS proven reducing q query OutlierS Given instance q default theory cid3q Dq W q associated q s1 s2 W q q true iff s1 outlier witness set s2 cid3q cid2 2complete problem testing cid31 cid14 s1 cid10P The following result shows similarly shown query Outlier bounding size outlier set associated provided witness set S advance change complexity ﬁgures Theorem 45 On propositional default theories OutlierkS DP 2complete general theories DPcomplete DF theories Proof outline Both membership hardness proved discussed Theorem 44 To prove membership suﬃces guess outlier sets size k As hardness reduction proceeds described proof outline Theorem 44 outlier witness sets employed construction singleton sets cid2 Next analyze query OutlierSL Note query important basic operator outlier detection propositional default theories We recall given default theory sets literals S L query simply asks S outlier witness set outlier L theory Theorem 46 On propositional default theories OutlierSL DP 2complete general theories DPcomplete DF theories Proof outline Complexity query OutlierSL query OutlierS Similarly happens query OutlierL respect query Outlier knowing outlier set L advance reduce complexity OutlierSL respect query OutlierS Indeed recall sets L S ﬁxed nonetheless deﬁned proof outline Theorem 41 respectively cid10P 2 needed solve entailment problems q complete coNPcomplete resp cid9P 2 complete NPcomplete resp propositional general DF resp default theories Hence result cid2 q cid12cid12 cid12 Given default theory set literals L query OutlierminL asks L minimal outlier set theory Although outlier set given input query OutlierminL turns complex outlier detection problems considered work complex general Outlier query Theorem 47 OutlierminL propositional default theories DP 3complete general theories DP 2complete DF theories 2 DF theories 3 complete general default theories cid9P Proof outline The membership theorem proved follows First consider problem verifying L outlier exists witness set S W L L It shown Theorem 43 OutlierL cid9P 2 complete DF theories Once veriﬁed L outlier shown L minimal outlier nonempty subset L W Lcid12 L satisfy Deﬁnition 32 The negation problem solved polynomial time nondeterministic Turing machine oracle entailment problem guesses subsets L veriﬁes satisfy Deﬁnition 32 As consequence problem cid10P 3 general default theories cid10P L subset S S S cid12 cid12 cid12 cid12 cid12 cid12 It concluded overall query OutlierminL general resp DF theories conjunction independent problems cid9P 3 resp cid9P 2 cid10P 3 resp cid10P 2 lies DP 3 resp DP 2 Hardness query OutlierminL general theories proved reducing problem deciding validity formula F cid11 cid10 XY Z f X Y Z cid11 cid10 W U V gW U V problem OutlierminL Within F f X Y Z Boolean formula conjunctive normal form g X Y Z Boolean formula disjunctive normal form Formula F conjunction QBE3 QBE3 reduction establishes completeness OutlierminL general theories class DP 3 A similar reduction 1850 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 exploiting conjunction QBE2 formula QBE2 formula prove hardness OutlierminL DF default theories cid2 Let consider query OutlierminSL Recall given default theory disjoint sets S L query asks L minimal outlier set having S witness set theory Note query complex query OutlierSL checks L S represent pair outlier necessarily minimal witness The precise complexity stated Theorem 48 OutlierminSL propositional default theories cid10P theories 3complete general theories cid10P 2complete DF satisfy Deﬁnition 32 D W Scid12 cid10cid14 S Proof outline Let ﬁrst consider membership In order answer query OutlierminSL veriﬁed S L satisfy Deﬁnition 32 D W S cid14 S D W SL cid10cid14 S b subset L cid12 The query coincides OutlierSL L DP 2 resp DP general resp DF theories Vice versa query b cid10P 2 general resp DF theories negation answered nondeterministic polynomial time Turing machine guesses cid12 W Lcid12 checks form outlier witness pair oracle pair disjoint subsets L cid9P 2 Thus overall problem cid10P As hardness case general resp DF theories proved reducing problem deciding validity D W Scid12Lcid12 cid14 S 3 resp cid10P 2 3 resp cid10P cid12 L S L S W Lcid12 S cid12 cid12 cid12 cid12 cid12 QBE3 resp QBE2 formula query OutlierminSL cid2 43 Complexity results extended disjunctive logic programs This section discusses complexity detecting outliers ELPs Section 431 EDLPs Section 432 sidered 431 Complexity outlier detection extended logic programs Extended logic programs disjunction allowed correspond subset default theories The correspon dence languages follows 26 For ELP rule r L0 L1 Lm Lm1 Ln let δr denote following default rule L1 Lm Lm1 Ln L0 justiﬁcation δr identically true literal true r negation failure literals n m Then ELP P associate default theory cid3P δr r P following holds 26 If M answer set P deductive closure M extension cid3P ii extension cid3P deductive closure exactly answer set P In sequel given ELP ruleobservations program P D W cid3P denote associated default theory δr r D W Note cid3P disjunctionfree Similarly given disjunctionfree default theory cid3 D W δ D consequent δ literal conjunction justiﬁcation δ P cid3 denote associated ruleobservations program r δr D W In order state following complexity results technical Lemma needed Lemma 49 Let P D W ELP ruleobservations program let cid3P associated DF default theory Then L outlier set P witness set S iff L outlier set cid3P witness set S Proof By relationship holding answer sets ELP P extensions default theory cid3P stated 26 recalled follows given ELP ruleobservations program P D W subset Z W answer sets P Z onetoone correspondence extensions D cid12 W Z D cid12 W cid3P cid2 All given complexity results general ELPs summarized following theorem Theorem 410 The complexities outlier detection problems ELP follows Outlier Outlierk OutlierL cid9P Outliermin DP OutlierS OutlierkS OutlierSL DPcomplete 2complete OutlierminSL cid10P 2 complete 2complete F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1851 Proof Membership Given ELP ruleobservations program P D W construction cid3P disjunctionfree default theory size polynomiallybounded size P Thus claim follows Lemma 49 membership parts Theorems 4148 Hardness Given normal DF default theory cid3 D W δ D δ form L1LmL0 P cid3 ELP ruleobservations program size construction polynomially bounded size cid3 Hence hardness follows Lemma 49 hardness parts Theorems 4148 concerning DF default theories Indeed recall hardness parts theorems use normal DF default theory conclusion justiﬁcation default rule occurring consists single literal cid2 L0 432 Complexity outlier detection disjunctive extended logic programs We analyzed complexity outlier detection problems extended logic programs exploiting results ob tained default theories However general class extended disjunctive logic programs mapped language default theories Therefore able directly exploit complexity results proved default logics order derive correspondent results EDLPs Nevertheless turns outlier detection problems EDLPs precisely hard corresponding tasks evaluated default logics summarized following theorem Theorem 411 For general EDLPs queries 1 Outlier 2 Outlierk 3 OutlierL cid9P 4 OutlierS 5 OutlierkS 6 OutlierSL DP 8 OutlierminSL cid10P 3complete 2complete query 7 OutlierminL DP 3 complete queries 3complete query 3 follows given ruleobservation pair P D W query answered Proof outline 1 Membership cid9P polynomialtime nondeterministic Turing machine guesses outlier set L witness set W employs 2 oracle decide P S cid14 S cid10P cid9P cid9P 3 hardness proved reducing problem validity QBE3 formula query Outlier The reduction associates negationfree EDLP ruleobservation pair P cid11 Dcid11 W cid11 QBE3 formula cid11 XY Z f X Y Z conjunctive normal form The properties P cid11 analogous properties default theory cid3cid11 described discussing query Outlier default theories Theorem 41 However differently Theorem 41 saturation technique employed guarantee properties 2 problem P SL cid10cid14 S cid9P 2 problem 2 3 The proof uses ideas illustrated query Outlier 4 Membership DP 2 proved taking account problem corresponds conjunction independent problems deciding P S cid14 S P SL cid10cid14 S While problem cid10P 2 shown cid9P 2 L provided input problem Indeed proceed guessing outlier set L minimal model M P SL S cid10 M checking minimal exploiting NP oracle cid12cid12 DP 2hardness proved reducing query OutlierS problem deciding program P cid9P inconsistent cid10P 2 check 2 check program P 5 6 The results proved line reasoning illustrated query OutlierS 7 Membership analogous Theorem 47 As hardness line reasoning analogous hardness Point 1 Theorem 47 technical point view construction Point 1 Theorem 411 cid9P cid12cid12 r representing distinct copies program reduction shown Point 1 theorem order build logic ruleobservations program P F conjunction F cid11 cid12 QBE3 formula cid11 encoded cid12cid12 valid suitable set L minimal outlier set rules r P F 3 complete problem taken account employed Loosely speaking sets rules r QBE3 formula cid12 encoded rules r cid12 cid12 cid12 consistent 8 Both membership hardness analogous Theorem 48 hardness exploits rules r Point 7 proof cid2 5 The ﬁrstorder case cid12cid12 We discuss extension framework ﬁrstorder case variables allowed occur defaults We use formal framework similar aspects set Cadoli et al 15 A ﬁnite ﬁrstorder default theory cid3 D W consists ﬁnite set W ﬁrstorder formulas ﬁnite set D default rules form 1 prerequisite justiﬁcations consequence ﬁrstorder formulas free variables X X1 Xn A default closed α β1 βn γ contains free variables A default theory closed formulas W D closed A default default theory closed called open It assumed Herbrand Universe U ﬁnite default theory nonempty ﬁnite function symbols allowed occur theory In following consider ﬁnite ﬁrstorder default theories The semantics closed ﬁrstorder default theory based notion extension deﬁnition analogous deﬁnition extension provided Section 21 context propositional default theory 15 The deﬁnition 1852 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 extension applied open default theories assuming defaults free variables implicitly stand set closed defaults obtained replacing free variables terms Herbrand Universe U default theory Let φX formula free variables X X1 Xn let ζ ζ1 ζn list objects U Then denote φXζ result simultaneously substituting ζi Xi φ 1 n Let cid3 D W ﬁrstorder default theory We denote INSTW instantiation W set closed formulas φXζ φX W ζ U n cid6 cid5 cid3 Similarly denote INSTD instantiation D set closed defaults αXζ β1Xζ βmXζ γ Xζ αX β1X βmX γ X cid4 D ζ U n serves purpose eliminating free variables formulas The instantiation INSTcid3 cid3 INSTD INSTW For example consider group friends decide watch movie given like going movies This encoded theory cid3ex D W Then U mary jennie movie instantiation INSTcid3ex cid3ex INSTW W INSTD Xlikes X Y watchY watchY cid4 likesmary movie likesjennie movie watchmovie cid6 cid3 D W cid5 cid3 Xlikes X mary watchmary watchmary Xlikes X movie watchmovie watchmovie Xlikes X jennie watchjennie watchjennie cid4 Now position extend deﬁnition outlier context ﬁrstorder default theories Deﬁnition 51 Firstorder outliers outlier witness set Let cid3 D W ﬁrstorder default theory let L W set ground literals If exists nonempty set ground literals S W L INSTD INSTW S cid14 S ii INSTD INSTW SL cid10cid14 S L outlier set cid3 S outlier witness set L cid3 For example consider theory cid3ex Then L likesjennie movie outlier witness S watchmovie Given ﬁnite default theory cid3 instantiation cid3 contains closed formulas general ground theory possible presence quantiﬁers A ﬁnite propositional default theory associated cid3 follows Let F Xφ X F Xφ X resp universally existentially resp quantiﬁed formula Then propositional version PROPF F Domain Closure formula ζ U φζ resp The propositional version PROPφ quantiﬁerfree formula φ formula φ Let φ formula propositional version PROPφ φ obtained recursively substituting subformula ψ φ propositional version PROPψ ζ U φζ cid12 cid13 Let cid3 D W ﬁrstorder default theory We denote PROPW propositional version W set propositional formulas cid5 cid6 PROPφ φ INSTW cid3 Similarly denote INSTD propositional version D set propositional defaults α β1 βm γ PROPα PROPβ1 PROPβm PROPγ INSTD cid4 The propositional version PROPcid3 cid3 propositional default theory PROPD PROPW Since assumed Herbrand Universe U theory cid3 ﬁnite propositional default theory PROPcid3 ﬁnite For example consider theory cid3ex The propositional version PROPcid3ex cid3ex PROPW W PROPD cid3 likesmary movie likesjennie movie likesmovie movie watchmovie watchmovie likesmary mary likesjennie mary likesmovie mary watchmary watchmary likesmary jennie likesjohn jennie likesmovie jennie watchjennie watchjennie cid4 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1853 Let cid3 D W ﬁrstorder default theory let S L W disjoint subsets ground literals Then construction PROPcid3 L outlier witness S cid3 L outlier witness S propositional default theory PROPcid3 The converse holds provided outliers witnesses constrained subsets W PROPW 5 We remarked constraining outliers witnesses singled given subset set literals W change complexity ﬁgures Thus PROPcid3 ﬁnite propositional default theory complexity results Section 42 directly applied case input theory PROPcid3 Thus complexity analysis presented Section 42 allows characterize diﬃculty mining problem hand propositional version ﬁrstorder theory available For example consider theory cid3ex D W Since PROPW W outliers propositional theory PROPcid3ex onetoone correspondence outliers ﬁrstorder theory cid3ex As matter fact recalled theory PROPcid3 exponentially larger cid3 And seen exponential increase size theory complexity deciding existence outlier ﬁrstorder theory NEXPTIMEcid9P 2 exponential analogue cid9P 3 NPcid9P 2 Furthermore pointed approach regard outlier detection data mining technique explicitly observed facts belonging W These facts naturally regarded tuples database interested singling anomalies In database scenario pertinent issue characterize data complexity 57 complexity query evaluation database assumed vary query expression assumed ﬁxed Next going address issue context outlier detection default theories scenario Let cid3 D W ﬁrstorder default theory We denote W fact extensional component cid3 subset W consisting ground literals W The extensional component assimilated relational database The ﬁrstorder component cid3 conversely set W rule W W fact Deﬁnition 52 Data complexity outlier detection queries The data complexity outlier query Q Q queries deﬁned Section 41 knowledge base ﬁrstorder default theory cid3 D W rule W fact complexity deciding Q measured size extensional component W fact cid3 In words data complexity Q complexity answering Q ﬁrstorder default theory assumption set default rules ﬁrstorder component held ﬁxed component allowed vary extensional Next data complexity measure query Outlier cid9P 3 complete complexity propositional counterpart Theorem 53 The data complexity Outlier cid9P 3 complete Proof outline Consider membership Given ﬁrstorder default theory cid3 D W rule W fact let k maximum number variables occurring default rule D formula W rule let n number distinct elements Herbrand Universe U cid3 The number n linear size extensional component W fact cid3 n OW fact Hence assuming D W rule input size theory PROPcid3 Onk polynomial size W fact input Outlier query In order complete proof suﬃcient recall query Outlier ﬁnite general propositional default theories cid9P 3 shown membership Theorem 41 Point 1 As hardness shown appendix details exists ﬁxed set default rules D FO ﬁxed set nonatomic formulas W FO mapping given input QBE3 formula cid11 outputs set W cid11 ground atoms theory PROPcid3FO W FO W cid11 equivalent propositional theory cid3cid11 described hardness Theorem 41 Point 1 The rest proof follows mentioned theorem Details reduction reported appendix cid2 The construction described proof Theorem 53 adapt reductions depicted hardness theorems concerning general propositional default theories order obtain reductions valid data complexity measure Therefore obtain Theorem 54 The data complexity Outlier cid9P OutlierkS OutlierSL DP 3 complete ii Outlierk OutlierL cid9P 2complete iv OutlierminL DP 3complete v OutlierminSL cid10P 3 complete iii OutlierS 3complete By construction Theorems 53 54 hold ﬁnite normal ﬁrstorder default theories 5 From technical point view transformation PROPcid3 modiﬁed directions hold immediately To aim suﬃces replace open case single constant U nonground literals cid2 W formulas form f f cid2 1854 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 6 Related work Research related work presented paper divided groups abduction ii outlier detection data iii outlier detection logic programming stable model semantics 61 Abduction The research logicbased abduction 161922233239475152 related outlier detection Generally speaking framework logicbased abduction domain knowledge described logical theory T A subset X hypotheses abduction explanation set manifestations M T X consistent theory entails M The work Eiter Gottlob Leone abduction default theories 24 relevant work presented In paper authors present basic model abduction default logic analyze complexity associated abductive reasoning tasks They present modes abduction based brave reasoning cautious reasoning According 24 default abduction problem DAP tuple cid21H M W Dcid22 H set ground literals called hypotheses M set ground literals called observations D W default theory The goal explain observations M hypotheses context default theory D W The authors propose following deﬁnition explanation Deﬁnition 61 See 24 Let P cid21H M D W cid22 DAP let E H Then E skeptical explanation P iff D W E cid14 M ii D W E consistent extension The relationship outlier detection normal propositional default theories skeptical explanations sum marized following theorem Theorem 62 Let cid3 D W normal default theory W consistent Also let L W S W disjoint sets Then S outlier witness set L cid3 L minimal nonempty skeptical explanation S DAP P cid21L S D W SLcid22 Proof Only If Let cid3 D W normal default theory L W S W outlier witness set L By deﬁnition outlier case D W S cid14 S words D W SL L cid14 S Moreover D W normal default theory D W SL L In addition W consistent W S Hence D W S consistent extension Therefore Deﬁnition 61 L skeptical explanation S DAP P ii If Suppose L minimal nonempty skeptical explanation S DAP P cid21L S D W SLcid22 By deﬁnition D W S cid14 S b D W S consistent extension Moreover L minimal nonempty explanation following true D W SL cid10cid14 S b D W SL consistent extension Since cid3 D W normal default theory W consistent theory case cid3 D W SL normal default theory W SL consistent Hence default theory D W SL consistent extension Therefore case D W SL cid10cid14 S concluded S outlier witness set L D W cid2 In sum follows sort duality hold context normal default theories abduction outlier detection problems Nonetheless outlier detection problems outlier witness set S according Theorem 62 analog set observations abduction problems guessed set observations abduction given input We shown Section 4 high complexity outlier detection problems arises fact set S given advance Hence fact witness set S given input signiﬁcant computational complexity point view prevents borrowing complexity results abduction problems Remark 63 Theorem 62 valid ordered seminormal default theories This second condition Deﬁnition 61 requires default theory consistent extension ordered seminormal default ories guaranteed property 25 For subclasses default theories Theorem 62 hold Consider example following default theory cid3 D W D ls s sqp p slq q spl l F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1855 W l s This default theory seminormal ordered The reader verify l outlier set s witness set However D W s consistent extension l minimal nonempty skeptical explanation s DAP P cid21l s D W slcid22 Research logicbased abduction disjunctive logic programs 2252 related outlier detection comprehensibly studied context logic programming 19 survey This issue explored directions The ﬁrst line work logic programs AI tool knowledge representation reasoning abduction second approach concept abduction deﬁning semantics logic programs In context disjunctive logic programming research focused relationship semantics DLP abductionbased semantics logic programs example 52 Eiter et al 22 studied abduction context normal disjunctive logic programs type negation negation failure considered extended logic programs classical negation negation failure allowed In addition unlike framework model Eiter et al allow explicit exploitation integrity constraints Their abduction schema assumes inference operator provided input Eiter et al deﬁne logic programming abduction problem follows Deﬁnition 64 See 22 Let V set propositional atoms A logic programming abduction problem LPAP P V consists tuple cid21H M L P cid14cid22 H V ﬁnite set hypotheses M V v v V ﬁnite set manifestations L P propositional logic program V cid14 inference operator They deﬁne solution LPAP Deﬁnition 65 See 22 Let P cid21H M L P cid14cid22 LPAP let S H Then S solution explanation P iff L P S cid14 M According 22 abductive conclusions lead inconsistency Hence use variant skeptical inference answer set exist We establish formal relationship outlier detection abduction disjunctive logic programs deﬁnition outliers requires ability prove negative literals classical negation sense semantics 22 prove negative literals program use negative literal Sakama Inoue deﬁned abduction context EDLPs suggested program transformation abductive programs disjunctive programs 52 However techniques complexity results apply case outlier detection investigated credulous reasoning skeptical reasoning framework observation constrained single literal However use framework Eiter et al described Deﬁnitions 64 65 adapt skeptical version work Sakama Inoue following Theorem 66 Let P D W ruleobservations program let L S W Then following holds If S outlier witness set L P L explanation LPAP A cid21W S P cid12 D W SL cid14cid22 cid14 entailment EDLPs deﬁned Section 22 ii If L minimal explanation LPAP A cid21W S P Section 22 S outlier witness set L P cid12 D W SL cid14cid22 cid14 entailment EDLPs deﬁned Proof Let P D W ruleobservations program let L S W Assume S outlier witness set L P By deﬁnition outlier case D W SL L cid14 S Then Deﬁnition 65 L explanation S LPAP A ii Suppose L minimal explanation S LPAP A cid21W S P cid12 D W SL cid14cid22 By Deﬁnition 65 known D W SL L cid14 S Therefore D W S cid14 S Moreover L minimal explanation following true D W SL cid10cid14 S Hence concluded S outlier witness set L D W cid2 1856 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 As default logic clear difference frameworks The construction given proof Theorems 62 66 provide technique solve outlier detection problems abduction outlier detection outlier L outlier witness set S singled abduction hypotheses observations ﬁxed sets In fact outlier detection knowledge discovery technique task outlier detection learn exceptional observations information witnessing 62 Outlier detection data The vast body literature concerning outlier detection databases largely exploits techniques borrowed statistics machine learning ﬁelds 92856 In cases techniques deal data organized single relational table Often numerical attributes handled metrics relating pairs rows table ﬁrst required These approaches classiﬁed supervisedlearning methods example labeled exceptional 3750 unsupervisedlearning methods labels required The approach obviously general As technique proposed work unsupervised sequel section focus unsupervised techniques These techniques categorized groups Statisticalbased methods assume given data set distribution model Outliers objects satisfy discordancy test signiﬁcantly larger smaller wrt values supposed assume according hypothesized distribution 9 Deviationbased techniques identify outliers inspecting typical characteristics objects deﬁnes ob jects deviate features 853 A different technique ﬁnds outliers observing low dimensional projections search space presented 1 In paper point considered outlier located low density subspace Yu et al 17 introduced method based wavelet transform identiﬁes outliers removing clusters original data set Wavelet transform 55 detect outliers stochastic processes A group methods use densitybased techniques 14 exploit notion locality measures plausi bility object outlier respect density local neighborhood To reduce computational load Jin et al 30 proposed method determine topn local outliers Distancebased outlier detection introduced Knorr Ng 3435 overcome limitations statistical meth ods A distancebased outlier deﬁned follows A point p data set outlier respect parameters k R k points data set lie distance greater R p This deﬁnition generalizes deﬁnition outlier statistics appropriate data set ﬁt standard distribution Ramaswamy et al 48 modiﬁed deﬁnition outlier They provide ranking outliers singled The deﬁnition suggest based distance kth nearest neighbor point p denoted Dkp proceeds follows Given k n point p outlier n 1 points q data set higher value Dkq p This means points q having n greatest Dkq values singled outliers A deﬁnition outlier considers point sum distances k nearest neighbors proposed 267 The authors present algorithm uses Hilbert spaceﬁlling curve exhibits scaling results close linear Similarly nearlinear time algorithm detection distancebased outliers exploiting randomization described 10 The general differences analogies approaches described suggested present work signiﬁcant In fact approaches deal knowledge encoded single relational table In contrast technique deals complex knowledge bases comprising relationallike information generally include semantically richer forms knowledge axioms default rules forth Hence framework analyzed paper complex relations relating objects underlying theory expressed As consequence intuitive general sense computing outliers contexts analogous conceptual technical developments different formal properties computed outliers Sometimes domain knowledge help single outliers diﬃcult identify methods like ones surveyed The following example intended provide intuition The example serves highlight different types knowledge mined approach opposed For purpose comparison approach typical distancebased approach To facilitate comparison use example literals included evidential knowledge denote facts concerning integer numbers Example 67 Let I 0 1 2 99 100 Consider binary predicate px y normally represent pairs x y I 2 x y 100 b x cid10 y assume following set observations available cid6 cid5 DB p0 100 p1 99 p2 98 p49 51 p50 50 p51 49 p98 2 p99 1 p100 0 According knowledge informally stated literal p50 50 associated anomaly D B pair integers x 50 y 50 satisﬁes condition condition b Now suppose wants single anomalous observations DB In case absence domain knowl edge unsupervised data mining technique outliers DB For example distancebased outlier F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1857 deﬁnition given 34 suitable purpose Assume Euclidean distance employed pa rameters k R set k 3 R 2 distance separating point x y DB nearest cid12 DB According parameters outliers DB 0 100 100 0 These neighbor x points precisely extremes distribution associated points DB cid12 y Notice according distancebased deﬁnition point 50 50 worst candidate represent outlier DB fact centermost point DB And combination values parameter k R holds point 50 50 distancebased outlier DB points DB distancebased outliers A similar situation characterize methods surveyed subsection Assume conversely domain knowledge informally stated available encoded default theory cid3 D W cid5 W DB cid3 sx y x y x y I sx y 100 ex y px y px y D cid6 cid5 ex x x I cid4 cid6 cid3 x y I sx y z sx y z cid4 x y z I ternary predicate sx y z represents sum sx y z W z x y binary predicate ex y represents equality ex y W x y By exploiting Deﬁnition 32 abnormality perceived knowledge encoded theory cid3 singled Indeed D W p5050 cid14 p50 50 D W p5050e5050 cid10cid14 p50 50 set S p50 50 outlier witness set outlier set L e50 50 Loosely speaking e50 50 outlier interpreted number 50 behaving abnormally p50 50 witness interpreted explanation abnormality point 50 50 satisfy conditions b nonetheless included set observations DB concerning predicate p cid2 Before concluding want emphasize framework developed paper relies heavily concept default rules The default rules normally expected exploited detecting observations normal according default theory hand Such default rules given advance frameworks discussed section Furthermore outliers single witnessesthose unexpected properties characterize outliers As far know justiﬁcations outliers provided approaches described 63 Outlier detection stable model semantics We originally presented outlier detection context default logics 4 Outlier detection successively studied context nondisjunctive logic programs stable model semantics 5 Next recall notion stable model deﬁnition outlier provided 5 A propositional logic program LP short collection classicalnegationfree nondisjunctive propositional rules Clearly syntactic viewpoint LPs form subset ELPs precisely consisting classicalnegationfree ELPs The stable model semantics LP P assigns P set stable models SMP corresponds set answer sets P Let S set propositional letters Then program P entails S resp S denoted P cid14 S resp P cid14 S model M SMP letter L S L M resp L M So loosely speaking logic programs rely closed world assumption CWA short states explicitly inferred false Extended logic programs hand relay open world assumption OWA short states explicitly inferred true rest unknown In following clear context order differentiate operator deﬁned logic programs relying CWA operator deﬁned extended logic programs relying vice versa OWA denote cid14cwa cid14owa A LP ruleobservation pair P D W deﬁned 5 analogously ELP ruleobservation pair D logic program W set letters positive literals Next deﬁnition outlier context logic programs stable model semantics recalled Deﬁnition 68 Given 5 Let P D W LP ruleobservations program let L W set literals If exists nonempty set literals S W L P S cid14cwa S ii P SL cid10cid14cwa S L outlier set S outlier witness set L P 1858 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 As noted introduction 5 weaker assumption adopted deﬁne outliers Indeed normal logic programs stable model semantics allow classical negation negation failure As consequence 5 negation witness required explicitly inferred witness entailed logic program This contrast view adopted present paper witnessing set outlier property explicitly observed opposite expected Hence approach 5 singles anomalies different nature These differences substantiated formal point view showing Deﬁnitions 32 68 reduced means natural program transformations usually employed order prove normal logic programs semantically equivalent extended logic programs6 26 Given extended logic program observation pair P investigate program transformations positive form P P informally speaking LP representing counterpart P stable model semantics twovalued form P P formally deﬁned loosely speaking ELP representing closedworld interpretation P denote propositional letter cid2 resp propositional letter cid2 Deﬁnition 69 Let P D W ELP ruleobservation pair let L set propositional letters occurring P For cid2 L let cid2 denote novel propositional letter Let L L positive literal cid2 resp negative literal Let S subset L L cid2 L L S For rule r L1 L2 Lm Lm1 Ln let r Then S denote rule W D L 2 L L 1 r D C cid2 cid2 cid2 L cid2 C cid2 L cid2 C cid2 L C new letter The sets r D introduced order assure literal negation belong answer set answer set forced include literals appearing logic program denote set L m1 L P LP ruleobservation pair P n The positive form P m L By results 26 holds M consistent resp inconsistent answer set P M resp stable model P M C The deﬁnition twovalued form extended logic program ELP follows Deﬁnition 610 Let P D W ELP ruleobservation pair let L set propositional letters occurring D p p p L P The twovalued form P W P ELP ruleobservation pair P D W D W Given ELP LP resp ruleobservation pair P denote cid9owaP cid9cwaP resp set pairs S L L outlier set P S outlier witness set L P according Deﬁnition 32 68 resp We following properties hold OP1 Let P ELP ruleobservation pair S L cid9owaP cid2 S L cid9cwaP S L cid9cwaP cid2 S L cid9owaP OP2 Let P ELP ruleobservation pair S L cid9owaP cid2 S L cid9owaP S L cid9owaP cid2 S L cid9owaP OP3 Let P LP ruleobservation pair S L cid9cwaP S L cid9owaP OP1 states outliers according Deﬁnition 32 generic ELP programobservation pair P incomparable P OP2 states outliers according Deﬁnition 32 outliers according Deﬁnition 68 positive form P generic ELP programobservation pair P incomparable outliers according Deﬁnition 32 twovalued form P P ﬁnally OP3 states Deﬁnition 32 single outliers LP ruleobservation pair P according Deﬁnition 68 means transformation P It follows properties framework mining outliers described general scribed 5 OP1 OP2 OP3 proved Theorem 611 OP1 Let P ELP ruleobservation pair Then S L cid9owaP cid2 S cid9cwaP cid2 S L cid9owaP L cid9cwaP S L Next prove statement providing counterexamples Let start ﬁrst implication Consider ELP pair cid14P D W D includes rule p p q 6 We grateful anonymous referee suggesting line comparison F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1859 C p p W set p q Then cid14P D p C p q Consider outlier L q cid14P associated witness S p It clear L W C q q p q p D W form outlierwitness pair cid14P q cid14P M1 p p unique stable model M2 logic program set cid14P As second implication OP1 consider ELP pair cid15P D W D includes rule Indeed cid14P p cid14cwa p p belong unique stable model pq cid14cwa p C C q C S p q p q W set p q Then cid15P D W C q q D C p q p C q cid15P W form outlierwitness pair P Indeed cid15P p cid10cid14owa p unique answer set ELP cid15P p q C p p p q Consider outlier L q p It clear L S associated witness S q C p C Theorem 612 OP2 Let P ELP ruleobservation pair Then S L cid9owaP cid2 S L cid9owaP S L cid9owaP S L cid9owaP cid2 Next prove statement providing counterexamples Let start ﬁrst implication OP2 Consider ELP pair cid14P preceding example corresponding twovalued form cid14P D D W p q Consider outlier L q cid14P associated witness S p Also case L S pq unique answer set p q p cid14owa p ELP cid14P Indeed cid14P As second implication OP2 consider ELP pair cid15P preceding example corresponding p p q q p p q W form outlierwitness pair cid14P cid14P pq cid14owa p twovalued form cid15P D D W p p q q p q p q Consider outlier L q cid15P W outlierwitness pair cid15P Indeed unique answer set cid15P p q cid15P p cid10cid14owa p associated witness S p Then L S form Next provide intuition implications cited Theorems 611 613 actually fail hold As positive form transformation Theorem 611 consider condition ii Deﬁnition 32 P SL cid10cid14owa S cid11 cid10 s Ss M M ANSWP SL Following results 26 assuming consistency condition ii Deﬁnition 68 formulated cid11 cid10 s S M ANSWP SL s M P SL cid10cid14cwa S Clearly ﬁrst condition imply general second exist answer set M s For inverse implication similar line s occur M Consequently S L cid9owaP cid2 S reasoning followed cid9cwaP L As twovalued form transformation Theorem 613 consider condition ii Deﬁnition 32 Clearly condition exclude exists answer set M s M Therefore program P rule s s case M associated answer set M s M For inverse implication similar line reasoning drawn Consequently S L cid9owaP cid2 S L cid9owaP P Conversely faithful correspondence holds cid9cwaP cid9owaP shown Theorem 613 OP3 Let P LP ruleobservation pair Then S L cid9cwaP S L cid9owaP Proof It known M stable model LP P M M cid5 cid6 cid2 cid2 L M L set propositional letters occurring P answer set P P represented form shown M stable model P Thus cid10 cid11 cid10 M SMP S s M cid11 cid10 s M M SMP SL ANSWP M cid10 M cid11 s M S cid11 ANSWP s M SL P S P cid14owa S SL cid10cid14owa S P S cid14cwa S P SL cid10cid14cwa S This completes proof cid2 26 Moreover answer set 1860 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 For example consider logic program P D W D consists rule q m e W q m e The ELP program P D W D q m e q q m m e e W pair P q belongs unique answer set program consequently q belong p m e Consider outlier L e P associated witness set q L P form outlierwitness qe cid10cid14owa q q cid14owa q rule q q P Indeed veriﬁed P The following example helps clarifying dissimilarities frameworks Consider railroad crossing scenario assume current state world viewed Agent A modeled proposition red_light represents knowledge semaphore located near railroad red crossB representing knowl edge Agent B passing railroad track The knowledge base Agent A supposedly rule asserting normally railroad crossed light red Let consider formalisms representing knowledge base First assume knowledge Agent A encoded default theory consisting single default rule red_lightcrossx equivalently ELP rule answer set semantics crossx crossx red_light Equipped knowledge Agent A conclude wrong crossB witness outlier red_light removing crossB current state world explicitly derives exact opposite crossB removing crossB red_light entail crossB To conclude worth pointing rule crossx crossx red_light plays role program cid14P introduced counterexamples prove Theorem 611 crossx Second assume instead encoded default logic knowledge Agent A encoded logic program stable model semantics In case Agent A rely kind knowledge somewhat different weaker knowledge encoded default rule Indeed explicit negation formalism logic programming rule like crossx red_light This rule models somewhat hazardous decision unknown semaphore light red railroad crossed According work 5 situation conclude red_light outlier crossB witness This removing crossB current state world crossB longer explicitly inferred consequently crossB entailed removing crossB red_light crossB explicitly inferred consequently crossB entailed Again worth noticing connection theorems proved case rule crossx red_light plays role program cid15P introduced counterexamples prove Theorem 611 crossx This example demonstrates basic differences formalism adopted 5 Indeed previous example fault rule red_lightcrossx equivalently ELP rule answer set semantics crossx crossx red_light captures knowledge normally railroad crossed light red example state emergency One claim rule stable model semantics faithfully corre spond default rule states conditions cross instead saying default cross The problem natural way saying similar language normal logic programs stable model semantics language classical negation previous theorem classical negation faithfully simulated To illustrate way note outlier detection stable model semantics 5 observations encoded positive literals Now consider example look outliers stable model semantics If construct perfectly corresponding example default reasoning outliers witnesses exactly involved default rules strong negated literals consequences according Deﬁnition 32 consequences directly coded stable model semantics strong negation allowed It worth pointing complexity pictures derived fragment nondisjunctive logic programs stable model semantics exploited derive complexity results concerning disjunctive logic programs answer set semantics general And fact outlier detection EDLPs complex outlier detection disjunctionfree logic programs stable model semantics considered For instance shown previous sections outlier existence problem cid9P 3 complete case problem cid9P 2 complete case 5 7 Conclusion Suppose walking street blind person going opposite direction You believe blind feeling way walking stick Suddenly falls bag surprise ﬁnds immediately probing ﬁngers expect blind person This kind behavior renders person blind suspicious situation In paper provided formal framework type commonsense reasoning Our framework essentially data mining technique allows automatic discovery outliers The user built outlier detection method specify suspicious observations provide list potential outliers Rather F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1861 identiﬁes exceptional observations analyzing data default rules knowledge base hand This method applications diagnosis homeland security We related logics formal analysis Reiters default logic extended disjunctive logic programming answer set semantics Reiters default logic chosen constitutes powerful nonmonotonic formalism deals incomplete information logic programming chosen practicality Logic programming tool KRR widely employed Artiﬁcial Intelligence eﬃcient implemented systems available 384043 We addressed main issues related idea outlier detection framework default logics ex tended disjunctive logic programs answer set semantics First introduced formal deﬁnition outliers justiﬁed application examples Second analyzed complexities involved incorporating outlier detection mechanism knowledge bases expressed default logic extended logic programs In view thor ough complexity analysis essential singling complex subtasks involved outlier detection This ﬁrst step conducive designing effective algorithms implementation purposes We provided extensive comparison formalism methods exist literature outlier detection Our approach relies existence default rules knowledge base Hence methods automatically create defaults application technique For instance techniques developed Nicholas Duval 2042 allow learning default theories examples In Section 33 demonstrated example outlier detection context learned default theories Other techniques learning rules deserve attention coupling method techniques interesting topic future research Among techniques inductive logic programming deals learning variants logic programs settings 36 For instance Inoue Kudoh 29 worked learning extended logic programs Learning rules realized semisupervised settings approach like metaquerying 313 This work extended directions First concept outliers frameworks default reason ing like System Z 46 Circumscription 41 studied Second intelligent heuristics enable heavy computational task involved eﬃcient outlier detection investigated In respect identiﬁcation tractable subsets task outlier detection possible step making computation task eﬃcient Third ideas developed exploited default logic specifying semantically rich integrity constraints relational databases tuple comply constraints outlier cf Section 33 Private public organizations overwhelmed vast quantities data knowledge Procedures eﬃciently analyze data report essential information great need Our framework knowledge discovery procedure capable identifying abnormal properties abnormal observations automatically It remains ﬁnd ideas developed paper work practice To end hope develop outlier detection test realworld data Acknowledgements The authors thank Michael Gelfond fruitful discussions Francesco Scarcello Gianluigi Greco providing useful insights computational complexity issues raised The second author grateful Barbara Grosz inviting spend year Harvard DEAS visiting scholar The authors thankful anonymous reviewers valuable constructive comments allowed signiﬁcantly improve paper We thank Estelle Schulgasser proofreading manuscript Appendix A Proofs Section 4 The following notations sequel Let L set literals Then denote L set positive literals occurring L L set negative literals occurring L Let T truth assignment set x1 xn variables Then LitT denotes set literals cid21 cid2n cid2i xi T xi true xi T xi false 1 n Let T 1 T 2 truth assignments disjoint sets X Y variables respectively Then T 1 T 2 denotes truth assignment T set variables X Y T x T 1x x X T x T 2x x Y Proof Theorem 41 Outlier propositional default theories 1 cid9P 2 cid9P 3 complete general theories 2 complete DF theories Proof 1 Membership Given theory cid3 D W exist disjoint subsets L S s1 sn W D W S cid14 s1 sn problem q Prob 2 complete 2754 Thus polynomialtime nondeterministic Turing machine lem q D W Sl cid10cid14 s1 sn problem q 2complete problem q cid10P cid9P cid12cid12 cid12cid12 cid12 cid12 1862 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 built cid9P solves problems q cid12 cid12cid12 calls oracle Hardness To prove completeness query Outlier cid9P q QBE3 formula reduced A QBE3 formula cid11 form XY Z f X Y Z 2 oracle solves query Outlier follows machine guesses sets L S 3 complete problem deciding validity X Y Z disjoint sets variables f X Y Z propositional formula X Y Z Intuitively reduction associates default theory cid3cid11 Dcid11 W cid11 formula cid11 exists literal l W cid11 belong outlier set witness set exists bijection possible outlier witness sets S W cid11 potential truth assignments variables set X cid3S cid11 Dcid11 W cid11S encodes cid11 cid3S cid11 cid14 S iff Y Z f X Y Z valid subject truth assignment X induced S l acts switch removed W cid11S Dcid11 W cid11Sl cid10cid14 S outlier witness set S More formally let cid11 XY Z f X Y Z quantiﬁed Boolean formula X x1 xn Y y1 ym Z disjoint set variables With cid11 default theory cid3cid11 Dcid11 W cid11 associated W cid11 set literals l φ x1 xn Dcid11 D1 D2 D3 D4 cid12 xi x cid12 x δ12i xi xi δ13i l l δ23 l φ φ δ124 cid12 xi x cid12 x cid4 1 n φ xi xi cid4 cid4 cid3 D1 δ11i cid3 D2 δ21 cid3 cid3 D3 D4 δ4 x δ22 φ φ y j y j cid12 x n cid12 1 δ31 j δ32 j j 1 m y j y j cid4 f X Y Z φ φ cid12 cid12 cid12 x n new letters Occurrences letters removed defaults Dcid11 affecting 1 x X correctness reduction However use makes reduction easier understand Clearly cid3cid11 built polynomial time Now shown cid11 valid iff exists outlier cid3cid11 First note extension E default theory Dcid11 W cid11S S arbitrary subset W cid11 logical closure maximal consistent subset set U X X cid12 Y Y cid12 l φ X Y l φ Claims 13 account role defaults belonging set Dcid11 deﬁned Claim 1 Let S subset W cid11 cid3cid12 Dcid11 W cid11S Then l S implies cid3cid12 cid10cid14 s s W cid11 l Proof Claim 1 Assume l S Then applying rules δ22 δ23 exists extension E cid3cid12 φ E Consequently xi S defaults δ13i 1 cid2 cid2 n exists extension E cid3cid12 xi E cid2 Claim 2 Let S W cid11 outlier witness outlier set L W cid11 cid3cid11 Then φ S W cid11 l Proof Claim 2 Let cid3cid12 theory Dcid11 W cid11SL Suppose l S From Claim 1 l S implies cid3cid12 cid10cid14 s s W cid11 l Hence conclude l S implies S l But rule δ23 exist rule Dcid11 having l consequence cid3cid12 cid14 l cid3cid12cid12 cid14 l matter value L Thus l outlier witness set W cid11 S W cid11 l theory Dcid11 W cid11S let cid3cid12cid12 Suppose φ belong S S x1 xn Since literal φ belongs W cid11S exists E x1 xn obtained applying defaults δ13i 1 cid2 cid2 n S extension E cid3cid12 outlier witness set contradiction cid2 Claim 3 Let T X truth assignment set X variables let S xi X T X xi false φ Then extension E Dcid11 W cid11S holds E LitT X Proof Claim 3 Assume exists extension E Dcid11 W cid11S E cid10 LitT X Then case exists letter xi false according T X xi E Since xi S case rule δ13i generating default E rule δ12i Notice precondition rule δ13i φ As φ S cid12 case rule δ4 generating default E applied rule δ13i Since rule δ4 letter x precondition F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1863 concluded δ12i generating default E equivalently xi E contradiction cid2 generating default E applied δ4 xi E Thus δ13i We continue main proof Suppose cid11 valid Then exists truth assignment T X set X variables T X satisﬁes Y Z f X Y Z Let S xi X T X xi false φ We S outlier witness l cid3cid11 For truth assignment T Y set variables Y consider subset EY extensions Dcid11 W cid11S consisting extensions E Y E Y LitT Y In particular Claim 3 E Y E Y LitT X LitT Y Since cid11 valid case exists truth assignment T Z set variables Z T X T Y T Z satisﬁes f X Y Z Hence E Y EY holds f X Y Z E Y rule δ4 generating default extension E Y To conclude sets EY induce partition set extensions Dcid11 W cid11S Dcid11 W cid11S cid14 S Suppose exists outlier set L cid3cid11 Then exists nonempty set literals S S outlier witness set L cid3cid11 Claim 2 φ S W cid11 l Let T X truth assignment set variables X T X xi false xi S T X xi true xi S Then Claim 3 extension E Dcid11 W cid11S holds E LitT X Now shown T X satisﬁes Y Z f X Y Z cid11 valid For truth assignment T Y set variables Y exists subset EY extensions Dcid11 W cid11S set extensions E Y E Y LitT Y We recall E Y LitT X Thus order L outlier cid3cid11 case set literals LitT Y set extensions EY extension E Y EY holds φ E Y By defaults δ21 δ4 φ E Y φ E Y δ4 generating default E Y exists truth assignment set variables Z T X T Y T Z satisﬁes f X Y Z As sets extensions EY form partition extensions Dcid11 W cid11S conclude cid11 valid As outlier set L note S outlier witness set L l cid3cid11 Indeed consider theory cid3cid12cid12 Dcid11 W cid11Sl It follows Claim 1 cid3cid12cid12 cid10cid14 S cid9P 2 Membership Analogous Point 1 Theorem 41 difference NP oracle place 2 oracle Hardness Let cid11 XY f X Y quantiﬁed Boolean formula disjunctive normal form X x1 xn Y y1 ym disjoint set variables f X Y D1 Dr Dk tk1 tk2 tk3 tk1 tk2 tk3 literal set X Y k 1 r The default theory cid3cid11 Dcid11 W cid11 associated cid11 W cid11 l φ x1 xn set letters l φ new letters distinct occurring cid11 Dcid11 D1 D2 D3 D4 identical set defaults reported point 1 Theorem 41 set D4 cid3 D4 δ4hk x cid12 1 cid12 x n dk tkh dk k 1 r h 1 2 3 cid4 cid3 δ4 cid4 d1 dr φ φ d1 dr new letters distinct occurring cid11 Clearly cid3cid11 built polynomial time By exactly following line reasoning Theorem 41 Point 1 shown cid11 valid iff exists outlier cid3cid11 cid2 Proof Theorem 43 OutlierL propositional default theories 1 cid9P 2 cid9P 3 complete general theories 2 complete DF theories Proof 1 Membership The proof analogous Point 1 Theorem 41 Hardness The reduction Point 1 Theorem 41 Clearly cid11 valid iff l outlier set cid3cid11 2 The proof analogous Point 2 Theorem 41 cid2 Proof Theorem 44 OutlierS propositional default theories 2complete general theories 1 DP 2 DPcomplete DF theories Proof 1 Membership See Section 42 Hardness Let cid31 D1 W 1 cid32 D2 W 2 normal propositional default theories let s1 s2 letters let q problem cid31 cid14 s1 cid32 cid10cid14 s2 Wlog assumed cid31 cid32 contain different letters 1864 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 αβ β q conjunction cid10P Notice given normal default theory D W literal q problem deciding cid3 cid14 q cid10P case W Thus following assume W 1 W 2 sets 2complete Problem q associated default theory cid3q Dq W q deﬁned follows Let Dq s2αβ D1 D2 W q s1 s2 We q true iff s1 witness outlier cid3q Note β 2hard cid9P 2 hard problem proves DP 2hardness Suppose q true We s1 outlier witness s2 cid3q Consider theory cid3cid12 Dq W qs1 First note cid3cid12 cid14 s1 Indeed cid31 cid14 s1 s2 W qs1 concluded cid3cid12 cid14 s1 means defaults coming set D1 Consider theory cid3cid12cid12 Dq W qs1s2 As cid32 cid10cid14 s2 exists extension E cid3cid12cid12 s2 belong E associated set D E generating defaults contain rule set defaults Dq D2 We note cid3cid12cid12 consistent cid31 cid32 consistent Thus concluded cid3cid12cid12 cid10cid14 s1 Hence s1 outlier witness s2 cid3q Suppose s1 witness outlier set L cid3q Let cid3cid12 cid3cid12cid12 denote theories Dq W qs1 Dq W qs1L respectively First note cid3cid12 cid14 s1 As literal s1 occurs rules Dq coming D1 rules D2 letters common rules letter s2 s2 W qs1 case cid31 cid14 s1 In order cid3cid12cid12 cid10cid14 s1 hold L include letter s2 Since W q s1 s2 L equal s2 Clearly case cid3cid12cid12 cid10cid14 s2 cid32 cid10cid14 s2 This proves problem q veriﬁed 2 Both membership hardness analogous Point 1 Theorem 44 cid2 Proof Theorem 46 OutlierSL propositional default theories 2complete general theories 1 DP 2 DPcomplete DF theories Proof The membership proof identical Theorem 44 The hardness proof identical Theorem 44 minor addendum Indeed problem considered Theorem 44 outlier set L unknown outlier witness set S input problem considered outlier set L witness set S input Note reduction employed Theorem 44 outputs default theory cid3q Dq W q refer theorem form formula q W q s1 s2 S s1 witness set cid3q q valid It inferred S witness set L s2 outlier set Thus conclude hardness proof suﬃcient include sets L s2 S s1 theory cid3q input problem OutlierSL cid2 Proof Theorem 47 OutlierminL general propositional default theories 1 DP 2 DP 3complete general theories 2complete DF theories cid12 Proof 1 Membership Given default theory cid3 D W set literals L W L outlier cid3 exists set S W L D W S cid14 S D W SL cid10cid14 S query q ii L cid12 minimal outlier nonempty subset L cid12 D W Scid12Lcid12 cid14 S D W Scid12 cid10cid14 S Query q solved polynomial time nondeterministic Turing machine cid9P calls oracle twice decide D W S cid14 S D W SL cid10cid14 S cid9P negation query q sets L problem conjunction independent problems cid9P problem DP 3 decided polynomial time nondeterministic Turing machine cid9P cid12 calls oracle times decide Q holds cid10P 2 oracle guesses set S 3 Furthermore 2 oracle guesses 3 Summarizing 3 implies outlier cid3 subset S 3 cid10P cid12 holds query q Hardness Completeness query OutlierminL general theories proved reducing problem decid cid12 L L cid12cid12 cid12 W L S cid12cid12 cid12 cid12 cid12 ing validity formula cid11 cid10 XY Z f X Y Z cid11 cid10 W U V gW U V F problem OutlierminL f X Y Z Boolean formula conjunctive normal form g X Y Z Boolean formula disjunctive normal form Formula F conjunction QBE3 QBE3 formula complete problem class DP 3 A similar reduction considering conjunction QBE2 formula QBE2 formula prove result DF default theories In particular default theory DF W F associated formula F F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1865 outlier set L precisely consists literals L l1 l2 b W F L partitioned subsets S X S W subset S W F L exists bijection sets S S X S S W possible truth assignment variables X W respectively c DF DF W F S cid14 S S X DF W F Sl1 cid14 S S X DF W F Sl2 cid14 S S X DF W F Sl1l2 cid10cid14 S S X iff Y Z f X Y Z holds true subject truth assignment variables set X induced S S X d DF DF W F S cid14 S S W DF W F Sl1 cid10cid14 S S W DF W F Sl2 cid10cid14 S S W iff U V g X Y Z holds true subject truth assignment variables set W induced S S W It follows point d order l1 l2 minimal outlier set case exist truth assignment variables set W U V g X Y Z true formula W U V gW U V true As consequence witness S L S S X point 3 S encodes truth assignment variables set X Y Z f X Y Z true Note point c subset S S X represents witness l1 l2 ﬁnally proves L minimal outlier set DF W F iff formula F true We proceed detailed proof Let cid11 XY Z f X Y Z cid12 W U V gW U V quantiﬁed Boolean formulas X x1 xn Y y1 ym Z W w 1 w p U u1 uq V disjoint set variables Let F formula cid11 cid12 The normal default theory cid3F DF W F associated With F W F set letters l1 l2 φ x1 xn ψ w 1 w p l1 l2 φ ψ new letters distinct occurring F DF D1 D8 f X Y Z φ φ cid12 l2 x 1 cid12 x n f X Y Z φ φ cid4 cid3 D1 D2 D3 D4 D5 D6 D7 D8 cid3 cid3 cid3 cid3 cid3 cid3 cid3 cid4 1 n cid12 xi x cid12 x φ xi xi cid4 j 1 m cid12 xi x cid12 x y j y j cid12 l1 x 1 xi xi y j y j cid12 x n cid4 l2 φ φ wk wk cid12 k l1 φ φ wk w cid12 w k uh uh uh uh l1 l2 w cid12 1 l1 l2 ψ ψ wk w cid12 w k cid12 k cid4 cid4 k 1 p ψ wk wk h 1 q gW U V ψ cid4 cid12 p w ψ cid4 Clearly W F consistent cid3F built polynomial time Now shown F valid iff l1 l2 minimal outlier set cid3F Suppose F valid We l1 l2 minimal outlier cid3F Since F valid exists truth assignment T X variables set X T X satisﬁes Y Z f X Y Z Let S φ xi T X xi false We S witness outlier set l0 l1 First note rules set D1 extension E DF W F S xi E xi E resp xi true false resp according T X Furthermore rules set D2 extension E DF W F S associated truth assignment T Y set Y variables In order literal φ belong extension theory DF W F S case rules set D3 exists truth assignment T Y set Y variables Z f X Y Z true subject truth assignment T X T Y equivalently formula Y Z f X Y Z true subject truth assignment T X contradicts deﬁnition T X It follows φ belong extension DF W F S By rules sets D1 D4 conclude negation variables set S entailed default theory DF W F S 1866 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 cid12 Finally default theory DF W F Sl1l2 entail S prerequisites rules set D4 removed W F appear conclusion default rule cid3F Thus l1 l2 outlier set cid3F Next shown l1 l2 minimal outlier set cid3F l1 l2 witness sets cid3F First note l1 l2 belong witness set recall l1 l2 appear cid12cid12 denote set S φ x1 xn S consequence rule DF Furthermore subset S W F let S cid12 φ x1 xn witness set l1 l2 denote set S ψ w 1 w p Note S cid12 resp Indeed shown order DF W F Scid12 cid14 S hold case S encodes truth assignment variables set X consequently φ belongs extension default theory DF W F Scid12 Nevertheless scenario default theory DF W F Scid12l1 DF W F Scid12l2 resp continue entail φ rules belonging set D4 cid12cid12 S S cid12 It concluded l1 l2 resp outlier set cid3F associated witness set S cid12cid12 S ψ w 1 w p Note ψ belong S S encode witness rules S ψwk 1 cid2 k cid2 p set D5 Now sake contradiction assume l1 l2 resp outlier set cid3F wk cid12cid12 S Notice rules set D5 extension E DF W F S wk E wk E resp s resp Hence set S encodes truth assignment variables set W Furthermore rules set D6 extension E DF W F S associated truth assignment T U variables set U Since l1 ψ belongs extension E l2 resp outlier set default theory DF W F S entails S DF W F S By rules sets D7 concluded truth assignment T U set variables U exists truth variable assignment set variables V makes formula gW U V false literal ψ belongs extension default theory DF W F S It concluded exists truth assignment T W set variables W U V gW U V true cid12 valid contradicts fact F cid11 cid12 valid Hence conclude l1 l2 outlier sets cid3F Thus l1 l2 minimal outlier set cid3F Suppose l1 l2 minimal outlier cid3F Since l1 l2 outlier set exists subset S cid12 S φ x1 xn Assume contradiction witness set l1 l2 The set S cid12cid12 φ x1 xn ψ w 1 w p DF W F S cid14 S Let S cid12cid12 exists nonempty subset S contain literal ψ rules ψwk hold wk case ψ entailed default theory DF W F S Since ψ entailed rule set D8 concluded l1 l2 outlier sets cid3F having associated witness set S contradicts fact l1 l2 minimal outlier set Hence set S ψ w 1 w p S S 1 cid2 k cid2 p set D5 In order DF W F S cid14 S cid12 k S cid12 S cid12 s k cid12cid12 cid12cid12 cid12cid12 cid12cid12 cid12cid12 cid12cid12 cid12cid12 cid12cid12 cid12cid12 cid12cid12 Since S As observed previous point rules set D5 associate subset S truth assignment T W set variables W rules set D6 associate extension DF W F S truth assignment variables set U rules set D7 evaluate T W implies U V gW U V Hence fact S set concluded truth assignment T W U V gW U V cid12 W U V gW U V valid case S S cid12 s0 sn In order S witness set case cid12 E holds φ E Now note rules set D1 extension E DF W F Scid12 S resp Let T X truth assignment set variables X T X xi true xi E xi E resp si S T X xi false resp si S resp By rules set D2 E associated truth assignment T E set variables Y In particular T E T E y j true T E y j false resp y j E y j E resp Since extension E DF W F Scid12 holds φ E rules set D3 follows f X Y Z E follows truth assignment T E set variables Y exists truth assignment T Z E set variables Z T X T E T Z E satisﬁes formula f X Y Z To conclude case S encodes truth assignment T X variables set X T X implies Y Z f X Y Z follows formula cid11 valid It eventually concluded F cid11 cid12 valid formula si S si S cid12 cid12 cid12 cid12 cid12 cid12cid12 2 Membership This analogous membership Point 1 theorem Hardness Let cid11 XY f X Y cid12 Z W gZ W quantiﬁed Boolean formulas X x1 xn Y y1 ym Z z1 zl W w 1 w p disjoint sets variables f X Y d1 dr formula disjunctive normal form disjunct d j 1 cid2 j cid2 r conjunction literals d j t j1 t j2 t j3 gZ W c1 cs formula conjunctive normal form conjunct ch 1 cid2 h cid2 s disjunction literals ch uh1 uh2 uh3 Let F formula cid11 cid12 We associate F default theory cid3F DF W F identical theory described Point 1 theorem sets rules D3 D7 follows cid4 cid4 cid3 cid3 t jk dk cid12 li x 1 cid12 x n dk w cid12 1 l1 l2 w D3 D7 cid3 1 2 j 1 r k 1 2 3 cid12 p uh1 uh2 uh3 ψ ψ h 1 s d1 dp φ φ cid4 The rest proof analogous Point 1 theorem cid2 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1867 Proof Theorem 48 OutlierminSL general propositional default theories 1 cid10P 2 cid10P 3complete general theories 2complete DF theories L Problem q cid12 Proof 1 Membership In order answer query OutlierminSL veriﬁed problem q Deﬁnition 32 D W S cid14 S D W SL cid10cid14 S problem q cid12 S satisfy Deﬁnition 32 D W Scid12 cid10cid14 S D W Scid12Lcid12 cid14 S proper subset L cid12cid12 cid12 cid12 cid12 cid12 cid12 S L satisfy cid12 W Lcid12 L S cid12cid12 3 cid10P cid10P coincides OutlierSL DP 2 DP resp general DF resp theories Furthermore 2 resp general DF resp theories negation answered nondeterministic cid12 W Lcid12 checks form problem q polynomial time Turing machine guesses pair disjoint subsets L outlier witness pair oracle cid9P 2 Thus overall problem cid10P Hardness Let cid12 W U V gW U V quantiﬁed Boolean formula W w 1 w p U u1 u p V disjoint set variables With cid12 default theory cid3cid12 Dcid12 W cid12 associated W cid12 set literals l1 l2 s ψ w 1 w p l1 l2 s ψ new letters distinct occurring cid12 Dcid12 composed default rules sets D5 D6 D7 D8 reported reduction shown Point 1 Theorem 47 plus set rules D0 l1s cid12 L S 2 resp 3 cid10P Next shown cid12 valid iff L l1 l2 minimal outlier set outlier witness set S s cid3cid12 It follows Point 1 Theorem 47 l1 l2 outlier sets Dcid12 D0 W cid12 associated witness set S W ψ w 1 w p cid12 valid Thus order L minimal outlier set case cid12 valid Finally rules set D0 holds s l1l2s s l2s s Dcid12 W cid12s cid14 s Dcid12 W cid12l1s cid14 s Dcid12 W cid12l2s cid14 s Dcid12 W cid12l1l2s cid10cid14 s Hence result follows 2 Both membership hardness analogous Point 1 theorem cid2 Appendix B Proofs Section 43 Proof Theorem 411 For general EDPLs 3 complete 3 complete 3 complete 2complete 1 Outlier cid9P 2 Outlierk cid9P 3 OutlierL cid9P 4 OutlierS DP 5 OutlierkS DP 6 OutlierSL DP 7 OutlierminL DP 8 OutlierminSL cid10P 2complete 2complete 3complete 3complete Proof 1 Membership Given ruleobservations program P D W exist disjoint sets S cid12cid12 W L W P S cid14 S problem q P SL cid10cid14 S problem q 2complete problem q cid9P 2 complete 21 Thus build polynomialtime nondeterministic Turing machine equipped cid9P 2 oracle cid12cid12 solves query Outlier follows machine ﬁrst guess sets S L solve queries q calling oracle twice Problem q cid10P q cid12cid12 cid12 cid12 cid12 Hardness Let cid11 XY Z f X Y Z quantiﬁed Boolean formula X x1 xn Y y1 ym Z f X Y Z z1 zl disjoint set variables f X Y Z Boolean formula conjunctive normal form C1 C N Ch th1 th2 th3 th1 th2 th3 literal set X Y Z h 1 N We associate cid11 ruleobservations program P cid11 cid21Dcid11 W cid11cid22 W cid11 o x0 x1 xn consists letters set X plus new letters x0 o distinct occurring cid11 Dcid11 1868 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 r0 φ o r1i xi xi φ r2i xi xi φ cid12 xi r3i x cid12 r4 j y j y j cid12 r5k zk z k r6k zk φ cid12 r7k z φ k r8h φ σ th1 σ th2 σ th3 0 cid2 cid2 n 0 cid2 cid2 n 1 cid2 cid2 n 1 cid2 j cid2 m 1 cid2 k cid2 l 1 cid2 k cid2 l 1 cid2 k cid2 l 1 cid2 h cid2 N cid12 cid12 cid12 x 1 x X n Y σ X X Y Y Z Z cid28 X X cid12 y cid12 1 y cid12 m Z cid12 Y Y cid12 cid12 z 1 z cid12 cid12 Z Z following mapping cid12 l new letters distinct occurring cid11 σ t cid12 x cid12 y j cid12 z k t t xi 1 cid2 cid2 n t y j 1 cid2 j cid2 m t zk 1 cid2 k cid2 l Clearly P cid11 built polynomial time Now cid11 valid iff exists outlier P cid11 By contradiction suppose exists answer set M Given truth assignment T subset X Y Z let IT denote context σ LitT Suppose cid11 valid We shall L o outlier P cid11 Then exists truth assignment T X variables set X T X satisﬁes Y Z f X Y Z Let S x0 LitT X We P cid11S cid14 S By rules r2i case cid12 T Y denotes truth cid12 cid10 S As set form s x S s x s x S cid12 φ o S T Y denotes truth assignment set variables φ M cid12 assignment set variables Y S consequence set M IT X IT Y Z Z Y answer set P cid11S cid12 P cid11S S cid10 M cid12 φ o S form IT X IT Y Z Z Furthermore rules r1i M cid12 cid12 cid12 As M answer set P cid11S minimal context closed RedP cid11S M follows truth cid12cid12 IT X IT Y IT Z o S M context closed We assignment T Z variables set Z subset M RedP cid11S M Thus T Z exists h 1 N σ th1 σ th2 σ th3 M conclude exists answer set M P cid11S S cid10 M T X satisﬁes cid12cid12 cid12 cid12 Y Z Ncid20 r1 tr1 tr2 tr3 Y Z f X Y Z contradicts fact T X satisﬁes Y Z f X Y Z Hence P cid11S cid14 S Let L o rules r9 r1i P cid11SL cid10cid14 S Thus L o outlier set outlier witness set S Suppose exists outlier L W cid11 witness S W cid11 P As o entailed P cid11S case S X x0 From stated P cid11S cid14 S implies truth value assignment T X set variables X T X xi false xi S satisﬁes Y Z f X Y Z cid11 valid To conclude literal L o outlier having witness 2 The proof analogous Point 1 3 The proof analogous Point 1 4 Membership Given ruleobservations program P D W subset S W verify P SL cid10cid14 S problem q exists L W S P S cid14 S problem q cid10P 2 complete answered polynomialtime nondeterministic Turing machine NP oracle follows machine guesses outlier L W S consistent context M P SL S cid10 M veriﬁes M closed RedP SL M decides M closed RedP SL M NP oracle Hence decide conjunction q We noted problem q 2complete As problem q cid12 M exists M DP cid9P cid12 q cid12cid12 cid12cid12 cid12cid12 cid12 cid12 cid12 Hardness Let r EDLP rule let hr br denote respectively head body r Let P cid12cid12 EDLPs Wlog assume P l Consider ruleobservations program P D W D hr br l r P W s l By noting ANSWP cid10P outlier witness s P contain common letters contain letters s cid12cid12 cid12cid12 ANSWP sl follows P inconsistent 2 complete check 21 Theorem 40 iff l cid12 hr br l r P cid12 2complete check 21 Theorem 39 P cid12 ANSWP s ANSWP consistent cid9P P P cid12cid12 cid12 2 problem cid12 cid12cid12 5 The proof analogous Point 4 6 The proof analogous Point 4 7 Membership Analogous membership Theorem 47 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1869 Hardness Let cid11 XY Z f X Y Z quantiﬁed Boolean formula X x1 xn Y y1 ym Z f X Y Z Boolean formula conjunctive normal form C1 C N Ch z1 disjoint sets variables th1 th2 th3 th1 th2 th3 literal set X Y Z h 1 N Let cid12 W U V gW U V quantiﬁed Boolean formula W w 1 w p U u1 uq V v 1 vr disjoint sets variables gW U V Boolean formula disjunctive normal form D1 D M Dh sh1 sh2 sh3 sh1 sh2 sh3 literal set W U V h 1 M Let F formula cid11 cid12 We associate F ruleobservations program P F cid21DF W F cid22 W F o1 o2 x0 x1 xn w 0 w 1 w p consists letters set X W plus new letters x0 w 0 o1 o2 distinct occurring F DF r r r r r r r r r cid12 0 cid12 1i cid12 2i cid12 3i cid12 4 j cid12 5k cid12 6k cid12 7k cid12 8h φ o1 o2 xi xi φ xi xi φ cid12 x y j y cid12 zk z k zk φ cid12 z φ k φ σ th1 σ th2 σ th3 xi cid12 j 0 cid2 cid2 n 0 cid2 cid2 n 1 cid2 cid2 n 1 cid2 j cid2 m 1 cid2 k cid2 l 1 cid2 k cid2 l 1 cid2 k cid2 l 1 cid2 h cid2 N r r r r r r r cid12 j cid12 k w cid12cid12 01 cid12cid12 02 cid12cid12 1i cid12cid12 2i cid12cid12 3i cid12cid12 4 j cid12cid12 5k cid12cid12 6k cid12cid12 7k cid12 80 cid12cid12 81h cid12cid12 82h cid12cid12 r 83h cid12 cid12 w 1 w ψ o1 ψ o2 w w ψ 0 cid2 cid2 p w w ψ 0 cid2 cid2 p cid12 1 cid2 cid2 p w 1 cid2 j cid2 q u j u 1 cid2 k cid2 r vk v 1 cid2 k cid2 r vk ψ v 1 cid2 k cid2 r ψ ψ d1 dM dh σ sh1 dh σ sh2 dh σ sh3 cid12 1 u 1 cid2 h cid2 M 1 cid2 h cid2 M 1 cid2 h cid2 M cid12 v cid12 q V cid12 p U cid12 k r r r r r cid12 cid12 cid12 x 1 x n Y cid12 X l W letters distinct occurring F σ X X Y Y Z Z W W U U V V cid28 X X Y Y following mapping cid12 r new cid12 cid12 1 y cid12 1 v cid12 U U cid12 1 z cid12 m Z cid12 y cid12 u cid12 z cid12 cid12 Z Z cid12 W W cid12 x cid12 j y cid12 k z cid12 w cid12 j u cid12 k v t cid12 V V t xi 1 cid2 cid2 n t y j 1 cid2 j cid2 m t zk 1 cid2 k cid2 l t w 1 cid2 cid2 n t u j 1 cid2 j cid2 m t vk 1 cid2 k cid2 l σ t Clearly P F built polynomial time Now F valid iff o1 o2 minimal outlier set P F The line reasoning employed prove result analogous hardness Theorem 47 Point 1 The reader referred discussion preceding reduction explanation line reasoning Next technicalities concerning reduction presented pointed First order understand role rules r r structure rules reduction given Point 1 proof cid9P considered resp reduction depicted note rules 3 complete problem cid12 In particular rules r serve purpose guaranteeing DF W F S cid14 S S X formula cid11 XY Z f X Y Z satisﬁable Point c discussion recalled rules r serve purpose guaranteeing DF W F S cid14 S S W formula cid12 W U V gW U V satisﬁable Point d discussion cid12cid12 As relationship minimality outlier set o1 o2 satisﬁability formula cid11 cid12 cid12cid12 02 refer discussion Theorem 47 Point 1 Point 1 cid12cid12 01 r cid12 0 r cid12 cid12cid12 taken care rules r proof details 8 Both membership hardness analogous Theorem 48 For hardness use rules deﬁned Point 7 proof plus rules equivalent defaults set D0 deﬁned Point 1 Theorem 48 cid2 cid12cid12 r Appendix C Proofs Section 5 Proof Theorem 53 The data complexity Outlier cid9P 3 complete 1870 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 Proof Membership See Section 5 Hardness To prove completeness query Outlier cid9P 3 complete problem deciding validity QBE3 formula reduced A QBE3 formula cid11 form XY Z f X Y Z X x1 xn Y y1 ym Z disjoint sets variables f X Y Z propositional formula X Y Z Without loss generality assumed Boolean formula f X Y Z conjunctive normal form exactly literals clause f X Y Z c1 c2 cr ck tk1 tk2 tk3 k 1 r We ﬁxed default theory cid3FO DFO W FO W FO contain atomic formulas mapping W cid11 QBE3 formula cid11 set ground literals exists outlier cid3FOcid11 DFO W FO W cid11 formula cid11 satisﬁable We encode formula cid11 extensional component W cid11 cid3FOcid11 means following sets atoms W X W Y W f cid5 cid5 cid6 exi xi1 1 n 1 cid6 u y j y j1 j 1 m 1 cid11 cid10 ck ck1 sgntk1 lettk1 sgntk2 lettk2 sgntk3 lettk3 cid5 c cid10 cr c0 sgntr1 lettr1 sgntr2 lettr2 sgntr3 lettr3 cid6 cid5 exn x0 cid6 u ym y0 cid5 c cid5 cid11cid6 cid6 k 1 r 1 sgncid2 constant p cid2 positive literal constant n cid2 negative literal letcid2 propositional letter occurring literal cid2 Intuitively atoms functor e list existential variables set X atoms functor u list universal variables set Y atoms functor c list clauses formula f X Y Z Variables set Z explicitly listed needed sake reduction In following set W X W Y W f denoted W cid11 It avoided atoms set W cid11 outlier witness encoding formula cid11 invalidated With aim following rules forming set W FO employed r0 f f t r1 t tx0 r2 t ex0 x1 r3 t u y0 y1 r4 t cc0 c1 p x0 p x0 p x0 cid11 cid10 r5 ABC e A B eB C cid11 cid10 r6 ABC u A B uB C cid11 cid10 c A B V 1 V 2 V 3 V 4 V 5 V 6 cB C V 7 V 8 V 9 V 10 V 12 V 12 r7 ABCV 1 V 12 Rules r2 r3 r4 introduce additional existential variable universal variable clause respectively roles clariﬁed Rules r5 r6 r7 serve purpose making overall theory inconsistent atom set W cid11 removed W cid11 Indeed assume atom form exi xi1 removed W cid11 Then formula exi1 xi exi xi1 consequently formula r5 evaluates false In particular formula r5 true atomic formulas form exi xi1modn1 true false Hence follows formula r2 atoms set W X removed theory inconsistent The reasoning applied atoms set W cid11 Assume L outlier witness S cid3FOcid11 L S W cid11 cid10 Then default theory DFO W FO W cid11SL inconsistent DFO W FO W cid11SL cid14 S contradiction Thus outliers witnesses contain atoms belonging set W cid11 Given propositional variable v use literals tv tv represent information v true v false respectively certain truth value assignment The truth value 3CNF formula clauses encoded means atoms evaluated following ﬁrstorder formula F ABT 1T 2T 3 cid21cid10 cid11 c A B p T 1 p T 2 p T 3 tT 1 tT 2 tT 3 cid10 cid11 c A B n T 1 p T 2 p T 3 tT 1 tT 2 tT 3 cid10 cid11 c A B p T 1 n T 2 p T 3 tT 1 tT 2 tT 3 cid11 cid10 c A B n T 1 n T 2 p T 3 tT 1 tT 2 tT 3 cid10 cid11 c A B p T 1 p T 2 n T 3 tT 1 tT 2 tT 3 cid10 cid11 c A B n T 1 p T 2 n T 3 tT 1 tT 2 tT 3 cid10 cid11 c A B p T 1 n T 2 n T 3 tT 1 tT 2 tT 3 cid10 c A B n T 1 n T 2 n T 3 tT 1 tT 2 tT 3 cid11cid22 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 1871 Indeed according formula F clause ck literal tk1 tk2 tk3 true considered truth value assignment Now position complete reduction cid3FOcid11 The set W cid11 given W cid11 cid6 cid5 l φ tx1 txn DFO ﬁxed set defaults D1 D2 D3 D4 cid3 D1 D2 D3 D4 cid3 cid3 cid3 e A C t A ok A ok A e A C t A t A e A C φ t A t A e A C t A ok A ok A cid4 l φ φ l φ l φ uB C tB tB uB C tB tB cid4 Ae A C ok A F φ φ cid4 cid4 The reader verify grounded version PROPcid3FOcid11 ﬁnite propositional general default theory equivalent default theory cid3cid11 described hardness Theorem 41 Point 1 Hence stated Theorem 41 result follows cid2 References 1 CC Aggarwal PS Yu Outlier detection high dimensional data Proceedings ACM Int Conf Management Data Santa Barbara California USA 2001 pp 3746 2 F Angiulli S Basta C Pizzuti Distancebased detection prediction outliers IEEE Transactions Knowledge Data Engineering 18 2 2006 145160 3 F Angiulli R BenEliyahuZohary G Ianni L Palopoli Computational properties metaquerying problems ACM Transactions Computational Logic 4 3 2003 149180 4 F Angiulli R BenEliyahuZohary L Palopoli Outlier detection default logic Proceedings Eighteenth International Joint Conference Artiﬁcial Intelligence IJCAI 2003 pp 833838 5 F Angiulli G Greco L Palopoli Outlier detection logic programming ACM Transactions Computational Logic 9 1 2007 6 F Angiulli C Pizzuti Fast outlier detection high dimensional spaces European Conference Principles Data Mining Knowledge Discovery Helsinki 2002 pp 1526 7 F Angiulli C Pizzuti Outlier mining large high dimensional data sets IEEE Transactions Knowledge Data Engineering 17 2 2005 203215 8 A Arning C Aggarwal P Raghavan A linear method deviation detection large databases Proc Int Conf Knowledge Discovery Data Mining Portland Oregon USA 1996 pp 164169 9 V Barnett T Lewis Outliers Statistical Data John Wiley Sons 1994 10 SD Bay M Schwabacher Mining distancebased outliers near linear time randomization simple pruning rule Proc Int Conf Knowledge Discovery Databases 2003 pp 2938 11 R BenEliyahu R Dechter Propositional semantics disjunctive logic programs Annals Mathematics Artiﬁcial Intelligence 12 1994 5387 12 R BenEliyahuZohary R Dechter Propositional semantics disjunctive logic programs Proceedings Eighteenth Joint International Confer ence JICSLP92 1992 pp 813827 13 R BenEliyahuZohary E Gudes G Ianni Metaqueries Semantics complexity eﬃcient algorithms Artiﬁcial Intelligence 149 1 2003 6187 14 MM Breunig H Kriegel RT Ng J Sander Lof Identifying densitybased local outliers Proc ACM Int Conf Management Data Dallas Texas USA 2000 pp 93104 15 M Cadoli T Eiter G Gottlob Default logic query language IEEE Transactions Knowledge Data Engineering 9 3 1997 448463 16 L Console DT Dupré P Torasso On relationship abduction deduction Journal Logic Computation 1 5 1991 661690 17 D Yu S Sheikholeslami A Zhang Findout Finding outliers large datasets Tech Report 9903 Univ New York Buffalo 1999 pp 119 18 E Dantsin T Eiter G Gottlob A Voronkov Complexity expressive power logic programming ACM Computing Surveys 33 3 2001 374425 19 M Denecker C Kakas Abductive logic programming Journal Logic Programming 44 13 2000 14 20 B Duval P Nicolas Learning default theories ESCQARU 1999 pp 148159 21 T Eiter G Gottlob On computational cost disjunctive logic programming Propositional case Annals Mathematics Artiﬁcial Intelligence 15 1995 289323 22 T Eiter G Gottlob N Leone Abduction logic programs semantics complexity Theoretical Computer Science 189 12 1997 129177 23 T Eiter G Gottlob The complexity logicbased abduction Journal ACM 42 1 1995 342 24 T Eiter G Gottlob N Leone Semantics complexity abduction default theories Artiﬁcial Intelligence 90 12 1997 177223 25 DW Etherington Formalizing nonmonotonic reasoning systems Artiﬁcial Intelligence 31 1 1987 4185 26 M Gelfond V Lifschitz Classical negation logic programs disjunctive databases New Generation Computing 9 1991 365385 27 G Gottlob Complexity results nonmonotonic logics Journal Logic Computation 2 3 1992 397425 28 V Hodge J Austin A survey outlier detection methodologies Artiﬁcial Intelligence Review 22 2 2004 85126 29 K Inoue Y Kudoh Learning extended logic programs IJCAI 1997 pp 176181 30 W Jin AKH Tung J Han Mining topn local outliers large databases Proceedings ACM Int Conf Knowledge Discovery Data Mining San Francisco California USA 2001 pp 293298 31 DS Johnson A catalog complexity classes J van Leeuwen Ed Handbook Theoretical Computer Science vol A Algorithms Complexity ElsevierThe MIT Press 1990 pp 67161 Chapter 9 32 A Kakas R Kowalski F Toni The role abduction logic programming AC Kakas RA Kowalski F Toni Eds The Role Abduction Logic Programming Handbook Logic Artiﬁcial Intelligence Logic Programming vol 5 Oxford University Press 1998 pp 235324 33 HA Kautz B Selman Hard problems simple default logics Artiﬁcial Intelligence 49 13 1991 243279 1872 F Angiulli et al Artiﬁcial Intelligence 172 2008 18371872 34 E Knorr R Ng Algorithms mining distancebased outliers large datasets Proc Int Conf Very Large Databases New York USA 1998 pp 392403 35 E Knorr R Ng V Tucakov Distancebased outlier algorithms applications VLDB Journal 8 34 2000 237253 36 N Lavrac S Dzeroski Inductive Logic Programming Techniques Applications Ellis Horwood New York 1994 37 W Lee SJ Stolfo KW Mok Mining audit data build intrusion detection models Proc ACM Int Conf Knowledge Discovery Data Mining New York USA 1998 pp 6672 38 N Leone G Pfeifer W Faber T Eiter G Gottlob S Perri F Scarcello The dlv knowledge representation reasoning ACM Transactions Computational Logic 7 3 2006 499562 39 F Lin JH You Abduction logic programming A new deﬁnition abductive procedure based rewriting IJCAI 2001 pp 655666 40 F Lin Y Zhao ASSAT Computing answer sets logic program SAT solvers Proc 8th National Conference Artiﬁcial Intelligence Fourteenth Conference Innovative Applications Artiﬁcial Intelligence AAAIIAAI02 Menlo Parc CA USA 2002 pp 112118 41 J McCarthy Circumscriptiona form nonmonotonic reasoning Artiﬁcial Intelligence 13 12 1980 2739 42 P Nicolas B Duval Representation incomplete knowledge induction default theories LPNMR 2001 pp 160172 43 I Niemelä P Simons Smodels An implementation stable model wellfounded semantics normal LP Proc 4th International Conference Logic Programming Nonmonotonic Reasoning LPNMR Berlin 1997 pp 420429 44 L Palopoli SE Rombo G Terracina Flexible pattern discovery extended disjunctive logic programming ISMIS 2005 pp 504513 45 CH Papadimitriou Computational Complexity AddisonWesley Reading MA 1994 46 J Pearl System z natural ordering defaults tractable applications nonmonotonic reasoning Proceedings 3rd Conference Theoretical Aspects Reasoning Knowledge Monterey CA 1990 pp 121135 47 D Poole Normality faults logicbased diagnosis Proceedings International Joint Conference Artiﬁcial Intelligence Detroit Michigan USA 1989 pp 13041310 48 S Ramaswamy R Rastogi K Shim Eﬃcient algorithms mining outliers large data sets Proc ACM Int Conf Management Data Dallas Texas USA 2000 pp 427438 49 R Reiter A logic default reasoning Artiﬁcial Intelligence 13 12 1980 81132 50 S Rosset U Murad E Neumann Y Idan G Pinkas Discovery fraud rules telecommunicationschallenges solutions Proc ACM Int Conf Knowledge Discovery Data Mining San Diego California USA 1999 pp 409413 51 C Sakama K Inoue On equivalence disjunctive abductive logic programs International Conference Logic Programming 1994 pp 489503 52 C Sakama K Inoue Abductive logic programming disjunctive logic programming relationship transferability Journal Logic Program ming 44 13 2000 75100 53 S Sarawagi R Agrawal N Megiddo Discoverydriven exploration olap data cubes Proc Sixth Int Conf Extending Database Technology Valencia Spain March 1998 pp 168182 54 J Stillman The complexity propositional default logics Proceedings 10th National Conference Artiﬁcial Intelligence San Jose California USA July 1992 pp 794800 55 ZR Struzik A Siebes Outliers detection localisation wavelet based multifractal formalism Tech Report INSR0008 CWI Amsterdam 2000 56 PN Tan M Steinbach V Kumar Introduction Data Mining AddisonWesley 2005 57 MY Vardi The complexity relational query language Proc 14th ACM Symp Theory computing San Francisco CA USA May 1982 pp 137 146 58 A Zhang W Marek On classiﬁcation existence structures default logic Fundamenta Informaticae 13 4 1990 485499