Artiﬁcial Intelligence 110 1999 57101 Computing intersections Horn theories reasoning models I Thomas Eiter acid3 Toshihide Ibaraki b1 Kazuhisa Makino c2 Institut und Ludwig Wittgenstein Labor für Informationssysteme KnowledgeBased Systems Group Technische Universität Wien Treitlstrasse 3 A1040 Wien Austria b Department Applied Mathematics Physics Graduate School Informatics Kyoto University Kyoto 606 Japan c Department Systems Human Science Graduate School Engineering Science Osaka University Toyonaka Osaka 560 Japan Received 6 April 1998 Abstract Modelbased reasoning proposed alternative form representing accessing logical knowledge bases In approach knowledge base represented set characteristic models In paper consider computational issues combining logical knowledge bases represented characteristic models particular study taking logical intersection We present loworder polynomial time algorithms prove intractability major computation problems context knowledge bases Horn theories In particular model intersection cid6 Horn theories cid61 cid6l represented characteristic models linear time characteristic model cid6 polynomial time Moreover present algorithm enumerates models cid6 polynomial delay The analogous problem characteristic models proved intractable possible exponential size output taken account Furthermore approximate computation set characteristic models difﬁcult Nonetheless deduction cid6 possible large class queries polynomial time abduction turns intractable We consider generalization Horn theories prove negative results basic questions indicating extension positive results Horn theories immediate cid211 1999 Elsevier Science BV All rights reserved I An abstract paper containing results appeared Proc National Conference Artiﬁcial Intelligence AAAI98 Madison WI July 2630 1998 pp 292297 cid3 Corresponding author Email eiterkrtuwienacat 1 Email ibarakikuampkyotouacjp 2 Email makinosysesosakauacjp 0004370299 matter cid211 PII S 0 0 0 4 3 7 0 2 9 9 0 0 0 2 1 1 1999 Elsevier Science BV All rights reserved 58 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 Keywords Automated reasoning Modelbased reasoning Characteristic models Algorithms complexity Knowledge representation 1 Introduction Logical languages widely basis representing knowledge advanced knowledge based systems cf 17 The investigation adequate languages syntactical semantical level ongoing quest improving capabilities current systems In approach knowledge traditionally represented means logical formulas stored knowledge base KB intuitively KB meant capture knowledge certain domain state affairs called world The knowledge accessed posing queries KB typically expressed logical formulas cid11 The query cid11 answered deduction inference method KB tested KB entails query cid11 KB cid11 One main disadvantages approach deciding KB cid11 holds intractable plain settings propositional context wellknown coNPcomplete problem More recently modelbased reasoning proposed alternative form representing accessing logical knowledge base cf 1324262930 It seen approach Levesques notion vivid reasoning 31 asks straight representation knowledge base commonsense reasoning easier suitable traditional In modelbased reasoning KB represented subset S models commonly called characteristic models set formulas Reasoning KB easy test given query cid11 cid11 true models S For suitable cid11 decided efﬁciently Moreover shown abduction KB represented characteristic models polynomial 242529 problem intractable formula representation 1538 This time speed comes price space formulabased modelbased approach orthogonal sense KB small representation formalism exponentially larger representation The intertranslatability approaches particular Horn theories addressed 242729 A number techniques efﬁcient modelbased representation fragments propositional logic devised cf 252930 However little attention paid far important issue representation different knowledge bases KB1 KBl combined single KB Main problems studied The semantical issue combining knowledge bases closely related issues studied recent literature 127182333363941 We intend discuss issue interested tools algorithms operational level needed implementation suitable semantics In context principal operation taking logical intersection knowledge T Eiter et al Artiﬁcial Intelligence 110 1999 57101 59 S bases KB1 KBl resulting knowledge base KB models common KBi s While operation easily accomplished formula based representation KB VD KBi task appears complicated modelbased representation In fact priori clear characteristic models individual KBi s characteristic models KB efﬁciently constructed computational cost intrinsic problem For example efﬁcient algorithm simply deciding consistency KB unclear In paper address issue study problems computing characteristic arbitrary models logical intersection cid6 D cid61 cid1 cid1 cid1 cid6l propositional theories cid6i Here assume theory set models We focus cid6i s Horn theories theories frequently encountered context knowledge representation study modelbased reasoning received main attention 13202427 discussed 29 In particular consider following main problems context model computation Given sets characteristic models M1 Ml representing Horn theories cid61 cid6l cid15 compute arbitrary model theory cid6 D cid15 compute arbitrary characteristic model cid6 Problem CMODEL cid15 compute models theory cid6 Problem ALLMODELS cid15 compute characteristic models cid6 Problem ALLCMODELS Further problems models model checking 832 recognition T l iD1 cid6i Problem MODEL models cid6 characteristic models considered Notice Problem MODEL contains consistency problem cid6 subproblem efﬁcient algorithm MODEL use efﬁcient check cid6 consistent cid6 6D holds Note results 14 21 Problem MODEL consistency check solved linear time formula representation Obviously Problem MODEL harder Problem CMODEL procedure solving problem However remains computation arbitrary model efﬁciently characteristic model Problem ALLMODELS generalizes ﬁrst problem Ideally generation models time stop time models desired Such procedure valuable casebased reasoning example tries ﬁnd model reality ﬁts given description provides good approximation More generally enumeration procedure serve general purpose method restricting search space set models f0 1gn models knowledge base cid6 particular models cid6 computed Problem ALLCMODELS requests complete output cid6 terms characteristic models In ALLMODELS satisﬁed models initially produced fast enumeration slows useful want ﬁnd good model limited time On hand ALLCMODELS quick generation characteristic models important good overall behavior From results 24 easily follows output size Problem ALLMODELS exponential input size number characteristic models l D 1 Hence polynomial time algorithm problem impossible notion 60 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 efﬁcient computation reconsidered A proposal vein algorithm enumerates models polynomial delay 22 model output time polynomial input size algorithm stops polynomial time output Any algorithm runs polynomial total time 22 polynomial combined size input output polynomial total time algorithm exists problem considered intractable As discussed modelbased paradigm proposed speed online reasoning It important know reasoning logical intersection theories accomplished In seminal paper 24 deduction abduction Horn theory represented characteristic models considered shown tractable We consider modes reasoning intersection cid6 Horn theories cid61 cid6l represented characteristic models The main issues similar benign results 2425 obtained particular suitable reasoning procedure given characteristic models cid61 cid6l query proceed Main results We addressed problems answers Some results deduction intersection fast hardness computing characteristic models unexpected Brieﬂy main results paper summarized follows cid15 Problems MODEL CMODEL solvable polynomial time In fact unique minimal model cid6 computable time linear input size Problem MODEL solvable linear time As shown 14 model Horn theory given Horn formula linear time obtain formula modelbased representation computing model cid6 particular model cid6 possible linear time As consequence representations consistency problem deciding cid6 6D solved linear time cid15 Problem ALLMODELS solved polynomial delay developed respective enumeration algorithm produces model time Also result parallels polynomial time result formulabased representation In fact models Horn theory cid6 given Horn formula enumerated polynomial delay 12 procedure The delay algorithm order best formula case 12 cid15 We Problem ALLCMODELS polynomial time algorithm We prove describing family instances In ALLCMODELS n number atoms output ALLCMODELS 2n models instances l D 2 cid61 cid62 2n characteristic models Proposition 51 Thus ALLCMODELS exponential output input size clearly polynomially solvable This improves result 20 Theorem 6 states terminology ALLCMODELS l D 2 solved polynomial time P D NP T Eiter et al Artiﬁcial Intelligence 110 1999 57101 61 cid15 Problem ALLCMODELS polynomial total time algorithm P D NP This somewhat negative result means merging Horn knowledge bases modelbased representation complex task general In fact establish l D 2 intersection Horn theories hard compute We derive result following associated decision problem proved NPcomplete Given characteristic models cid61 cid6l subset S characteristic models cid6 D l iD1 cid6i decide characteristic model exists cid6 n S cid15 Since computing set characteristic models Ccid3cid6 hard consider issue efﬁcient approximations However natural notion sound complete approximation Ccid3cid6 hard compute More precisely prove approximation N cid18 f0 1gn Ccid3cid6 contains polynomial fraction Ccid3cid6 polynomially larger Ccid3cid6 hard compute This strong result shows want compute signiﬁcantly large Ccid3cid6 allow junk output face intractable problem To knowledge type result novel area modelbased reasoning proof technique applied obtain similar results wide range similar problems Furthermore prove similar results computing maximal models cid6 constitute nonpolynomial fraction Ccid3cid6 This shows natural quantitative terms numbers models qualitative semantically described approximations Ccid3cid6 hard compute reinforces view computing Ccid3cid6 difﬁcult cid15 Despite fact number characteristic models intersection cid6 Horn theories cid61 cid6l exponential possible answer deductive queries cid11 cid6 polynomial time In particular query cid11 given jCcid3cid6i j time CNF formula deciding cid6 jD cid11 possible Omn m number clauses cid11 n number atoms jCcid3cid6ij number characteristic models cid6i cid11 single clause positive formula deciding cid6 jD cid11 possible linear time These results promising taking intersections Horn theories benign property modelbased reasoning preserved CNF query posed Horn theory answered polynomial time 2425 P cid15 On hand abduction intersection cid6 Horn theories cid61 cid6l intractable l ﬁxed 2 We prove deciding query letter q explanation cid6 set assumptions A NPcomplete This result tells benign properties characteristic models preserved consider intersections theories In fact indicates tractability result abduction single Horn theory cid61 robust advantage particular properties taken case longer possible theories cid61 cid62 combined Section 62 discussion 62 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 Usage signiﬁcance results Our results complete picture computational properties modelbased reasoning approach different Horn knowledge bases KB1 KBn combined taking logical intersection Since undoubtedly principal operation algorithms results signiﬁcant reasoning adopts modelbased approach incorporates operation embedded sophisticated combination semantics Our algorithms described detailed level easily implemented Moreover algorithms run linear time optimal order lowpolynomial degree improvements linear time feasible require effort sophisticated methods Furthermore algorithms complexity results insight potential tradeoff offline compilation online reasoning For example results adhoc online deductive reasoning intersection cid6 direct inference method cid61 cid6l advisable computing ﬁrst characteristic models cid6 applying polynomial algorithm 25 Even case repetitive queries direct method beneﬁcial cid6 characteristic models course hand cid6 small sets characteristic models cid61 cid6l huge better Ccid3cid6 Another aspect dynamic combination knowledge bases For example suppose pool knowledge bases KB1 KBl answering query runtime subcollection KBi1 KBi2 KBik relevant knowledge bases selected combined The different relevant subcollections vary store number characteristic sets In worst case number exponential l Even small pool size l assumption knowledge bases relevant query need storage For example l D 10 KBi s relevant query need store cid18 cid19 cid18 cid19 10 2 C 10 3 D 45 C 120 D 165 characteristic sets number relevant KBi s increased need 275 characteristic sets Thus scenario direct reasoning strategy employs deduction algorithms preferable This evident updates changes knowledge bases account update single knowledge base KBi requires recompile characteristic subsets subcollection KBi belongs example number cid18 cid19 cid18 9 1 D 9 C 36 D 45 cid19 9 2 C respectively 129 subcollections size respectively Of course mixed strategy viable subcollections small characteristic sets prestored direct methods applied For abductive queries picture similar deduction different Here current method answering abductive queries set CNF Horn formulas requires T Eiter et al Artiﬁcial Intelligence 110 1999 57101 63 exponential time computing characteristic models requires exponential space general abductive queries solved polynomial space Observe obliterative reasoning approach characteristic models enumerated deleted avoiding space problems proﬁtable intractable tell characteristic model Extension work Characteristic models generalized nonHorn theories 29 making use monotone theory 6 characterization Boolean functions introduced computational learning The approach 29 promising advantages Horn theories carry nonHorn theories In direction investigate extended Horn theories contains Horn reverse Horn theories theories Horn negating elementary propositions It appears extended Horn theories ﬁnding model ﬁnding characteristic model intractable As consequence polynomial total time algorithms ﬁnding models characteristic models respectively unlikely exist Moreover means deduction abduction atomic queries intersection theories given characteristic models intractable case These results indicate computational generalization characteristic models approach intersections theories immediately feasible sense offline compilation online reasoning direct methods expensive general Structure paper The remainder paper organized follows In section recall basic concepts introduce notation In Section 3 consider Problem MODEL model checking recognition model intersection We address Section 4 Problem CMODEL characteristic model checking After study Section 5 Problems ALLMODELS ALLCMODELS output ALLCMODELS exponential input In Section 6 consider deduction abduction intersection Horn theories Section 7 addresses possible generalization results extended Horn theories The ﬁnal Section 8 discusses aspects concludes paper In order distract ﬂow reading longer proofs technical details proofs moved Appendix A 2 Preliminaries We assume standard propositional language atoms x1 x2 xn xi takes value 1 true 0 false Negated atoms denoted xi A literal atom negation A model v vector f0 1gn ith component denoted vi For models v w denote v 6 w usual componentwise ordering vi 6 wi 64 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 Fig 1 Space models n D 4 theories cid61 cid62 D 1 2 n 0 6 1 v w means v 6D w v 6 w As usual v w reverse ordering For set B cid18 f1 ng denote xB model v vi D 1 2 B vi D 0 2 B D 1 n A theory set cid6 cid18 f0 1gn models cardinality denoted jcid6j By mincid6 maxcid6 denote sets minimal maximal models cid6 respectively v 2 cid6 maximal respectively minimal model cid6 w 2 cid6 w v respectively w v A propositional clause C D 1 _ cid1 cid1 cid1 _ k Horn literal positive CNF Horn contains Horn clauses A theory cid6 Horn exists Horn CNF representing We shall denote bcid6 set clauses Horn CNF representing cid6 3 Horn theories cid6 wellknown modeltheoretic characterization 34 13 proof propositional case Denote v w componentwise AND vectors v w 2 f0 1gn 0101 1001 D 0001 Furthermore denote ClS closure S cid18 f0 1gn Then cid6 Horn cid6 D Clcid6 Note consequence Horn theory cid6 6D unique minimal model v D w2S w S cid18 f0 1gn componentwise AND vectors S particular S deﬁnition w2cid6 w mincid6 D fvg Here use notation V V w D 11 1 w2S Similarly v _ w denotes componentwise OR vectors 0101 _ 1001 D 1101 For example consider cid61 D f0101 1001 1000g cid62 D f0101 1001 1000 0001 0000g Fig 1 Then v D 0101 w D 1000 v w 2 cid61 v w D 0000 2 cid61 cid61 Horn On hand Clcid62 D cid62 cid62 Horn In fact represented Horn CNF x3 x1 _ x2 x2 _ x4 bcid6 D fx3 x1 _ x2 x2 _ x4g For Horn theory cid6 model v 2 cid6 called characteristic 24 extreme 13 v 2 Clcid6 nfvg The set characteristic models cid6 characteristic set cid6 denoted Ccid3cid6 Note Horn theory cid6 unique characteristic 3 Observe bcid6 uniquely deﬁned use conversion set models equivalent formula needed contexts T Eiter et al Artiﬁcial Intelligence 110 1999 57101 65 set Ccid3cid6 maxcid6 cid18 Ccid3cid6 In example 0101 2 Ccid3cid62 0000 2 Ccid3cid62 holds Ccid3cid62 D cid61 We remark characteristic set Horn theory negative clauses studied context relational databases known generating set 3 28 discussion Throughout paper suppose sets vectors S cid18 f0 1gn represented standard way model v 2 f0 1gn stored sequence v1v2 cid1 cid1 cid1 vn 0s 1s However algorithms adapted forms storage model tree given binary decision tree 3 Finding recognizing model In section consider problem ﬁnding model logical intersection Horn theories represented characteristic models More formally problem speciﬁed follows Problem MODEL Input Sets characteristic models Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l Output A model v cid6 D T l iD1 cid6i cid6 6D No The main result section model fact model cid6 computable linear time Moreover obtain model checking cid6 recognizing members cid6 possible linear time We start following lemma useful purposes Lemma 31 Let cid6i cid18 f0 1gn D 1 2 l Horn theories let cid6 D Then v 2 cid6 satisﬁes l_ cid18 cid19 v w iD1 w2Ccid3cid6i T l iD1 cid6i 31 Proof First note w D v D w D cid1 cid1 cid1 D w2Q1 w2Q2 w2Ql w holds Qi cid18 Ccid3cid6i D 1 2 l deﬁnitions v Ccid3cid6i Then v w2Ccid3cid6i w 31 2 V Based lemma ﬁnd model cid6 follows Clearly cid6 model cid6i consider models v1 vl cid61 cid6l respectively If coincide v D v1 model cid6 output Otherwise exploiting Lemma 31 look upper bound v1 vl new candidate u model fact v 2 cid6 satisfy u 6 v Since v generated characteristic models cid6i discard characteristic models Ccid3cid6i sure contribute process Since resulting theories 66 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 Horn iterate build chain C u1 u2 cid1 cid1 cid1 uk uk model cid6 cid6 D detected The formal description algorithm follows Algorithm GENMODEL Input Characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 l Output A model v 2 cid6 D T l iD1 cid6i cid6 6D No Step 0 D 1 2 l Qi VD Mi Step 1 Qi D output No halt Step 2 V V w D w2Q1 output v D V w D cid1 cid1 cid1 D w2Q2 V w2Ql w w2Q1 w halt Step 3 u VD V W l iD1 w2Qi w D 1 l Qi VD fw 2 Qi j w ug goto Step 1 Example 31 Let M1 D Ccid3cid61 D f0110 0011 1010g M2 D Ccid3cid62 D f1110 0111 0011g The corresponding Horn theories formulabased representation bcid61 D fx1 _ x2 x1 _ x4 x2 _ x4 x3g bcid62 D fx1 _ x4 x1 _ x2 x3g V D 0010 v D 0010 output Note cid6 D f0110 0010 0011g obvious bcid6 D fx1 x2 _ x4 x3g output v D 0010 correct In Step 2 D 0010 w2Q1 w2Q2 V An analysis run time algorithm gives following result Appendix A proof Theorem 32 Problem MODEL solved Algorithm GENMODEL On2 jMi j time P l iD1 As immediate corollary result consistency intersection cid6 Horn jMi j time We state result theories cid61 cid6l decidable On2 point problem solved faster P l iD1 V Recall Horn theories closed intersection Horn theory cid6 w2cid6 w In fact underlying idea Algorithm GENMODEL model hard actually ﬁnds particular model cid6 Example 32 Let reconsider Example 31 There Algorithm GENMODEL outputs vector 0010 model cid6 D f0110 0010 0011g Corollary 33 Given characteristic sets Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 l Algorithm GENMODEL ﬁnds model v cid6 D On2 jMi j time cid6 6D outputs No cid6 D T l iD1 cid6i P l iD1 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 67 Fig 2 Data structure set Q1 D f0101 0110g MODEL Using sophisticated data structures possible improve running time Algo jMi j linear time input size Basically rithm GENMODEL On method use lists crossreferences counters avoid examination bit input constant times We use similar data structures beneﬁcial speeding reasoning algorithms P l iD1 V The operations need perform compute w2Qi holds w 2 Qi u VD W l iD1 V w2Qi w w compute set components k wk D 1 b update Qi removing models Qi Recall vector u monotonically increases execution Algorithm GEN MODEL observe sets Qi monotonically decrease For operation use counters Qi1 Qi2 Qin Qik tells models Qi value 1 component k Qik D jfw 2 Qi j wk D 1gj In order ﬁnd counters certain value quickly prepare buckets BiT0U BiT1U Bi TmU m D jQi j component k counter Qik reference bucket Bi TQikU Moreover use counter Qi tells number jQi j vectors Qi For operation b lists Lik references models w 2 Qi wk D 0 establish pointer component k wk D 0 w list Lik Fig 2 shows data structure Q1 D f0101 0110g We furthermore prepare bucket B 2 B holds Bi TQiU 6D The algorithm described ﬁrst scans input builds data structures After proceeds manner similar GENMODEL processes sets models Algorithm GENMODEL Input Characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l Output A model v 2 cid6 D l iD1 cid6i cid6 6D No T Step 0 D 1 2 l Qi VD Mi u VD 0 0 0 2 f0 1gn Scan input set initial counters buckets described Step 1 Qi D 0 holds output No halt Step 2 B D output v VD u halt begin Select arbitrary 2 B 68 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 k BiTQiU begin models Qi 1 component k uk VD 1 h D 1 2 l begin update buckets lists related Qh Remove k BhTQhkU model w Lhk begin eliminate w 2 Qh wk D 0 Qh VD Qh cid0 1 j D 1 2 n wj D 0 Remove w Lhj elsif j BhTQhj U begin wj D 1 update Qhj BhTcid1U Qhj VD Qhj cid0 1 Move j BhTQhj C 1U BhTQhj U endfelsifg endfwhileg endfforg endfforg B VD h D 1 2 l update bucket B BhTQhU 6D B VD B fhg goto Step 1 endfifg Initially algorithm sets u smallest possible model If Qi nonempty B cid6i component k models value 1 0 0 model cid6i output Otherwise 2 B exists models Qi cid6i value 1 component k If cid6 nonempty model cid6 value 1 component Thus candidate model u component uk set 1 sets Qj data structures updated accordingly removing models w wk D 0 If Qi cid6 D detected process continued To speed selectable components k Qi processed We omit example algorithm clear proceeds The result establishes Algorithm GENMODEL desired property Theorem 34 Algorithm GENMODEL solves Problem MODEL On time linear time P l iD1 jMi j Similarly Algorithm GENMODEL notice following corollary Corollary 35 Given characteristic sets Ccid3cid6i Horn theories cid6i cid18 f0 1gn D T l 1 2 l deciding consistency computing model cid6 D iD1 cid6i possible Algorithm GENMODEL On jMij time linear time P l iD1 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 69 Yet corollary membership problem cid6 model checking v cid6 efﬁciently Corollary 36 Given characteristic sets Ccid3cid6i Horn theories cid6i cid18 f0 1gn D T l 1 l v 2 f0 1gn deciding v 2 cid6 D iD1 cid6i possible Algorithm GENMODEL On jMi j time linear time P l iD1 lC1 Proof Indeed v 2 cid6 holds iD1 cid6i 6D cid6lC1 D fvg Since Ccid3cid6lC1 D fvg use Algorithm GENMODEL solve problem P l On iD1 jMij time Corollary 35 2 jMij C 1 D On jMij D On P l iD1 lC1 iD1 P T 4 Finding recognizing characteristic model In section consider problem ﬁnding characteristic model logical intersection cid6 Horn theories problem recognizing model characteristic model cid6 The problem ﬁrst step algorithm computing characteristic models problem hard computing characteristic models hard The problem relevant question computational upper bound generation additional characteristic models recognition problem easy enumeration procedure advantage fact rule possible candidates loworder polynomial time The main ﬁndings computing recognizing characteristic model possible polynomial time 41 Finding characteristic model We ﬁrst consider computation characteristic model following problem Problem CMODEL Input Sets characteristic models Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D T l iD1 cid6i cid6 6D No Output A characteristic model v cid6 D 1 2 l T For solving problem proceed follows We construct model u cid6i candidate Ccid3cid6 possible Algorithm GENMODEL cid6 D improved version Then cases arise u 2 Ccid3cid6 case output u stop ii u 2 Ccid3cid6 u replaced new larger candidate model u0 u u0 2 cid6 exist process repeated new candidate model u0 Since chain models C u D u1 u2 cid1 cid1 cid1 uk bounded algorithm eventually ﬁnds characteristic model maximal model characteristic halts 70 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 A straightforward implementation algorithm uses test u 2 Ccid3cid6 Algorithm CHECKCMODEL described Section 42 case u 2 Ccid3cid6 method selecting proper model u0 described However variant strategy gives faster algorithm Rather testing u 2 Ccid3cid6 consider stronger sufﬁcient necessary condition case test fails proceed like case ii selection model u0 fast The stronger condition given following lemma Let Qi D fv u j v 2 Mi g Pij D fw 2 Qi j wj D 1g Lemma 41 Let cid6 Pij deﬁned Then u 2 Ccid3cid6 holds following condition holds j uj D 0 H l iD1 ClPij D 41 Note converse hold general On hand 41 violated j model v 2 ClPij model cid6 v u Although immediately imply u characteristic model cid6 says characteristic model w w v exist Therefore proceed case ii safely select u0 D v replace Mi set fw u0 j w 2 Pij g continue new candidate model u0 The following example illustrates algorithm Example 41 Let M1 D Ccid3cid61 D f0110 0011 1010g M2 D Ccid3cid62 D f1110 0111 0011g The model cid6 D cid61 cid62 u D u1 D 0010 Thus Q1 1 D M1 Q1 2 D M2 For j D 2 P 1 12 cid0 cid0 P 1 0110 2 Cl 22 Cl P 1 12 cid1 D f0110g P 1 22 cid1 D f1110 0111g violates 41 Thus set u2 D 0110 continue set M 2 M 2 2 Consequently j P 2 1j v D u2 output VD f0110g D Q2 D f1110 0111g 2 means condition 41 true VD f1110 0111g Then obtain Q2 1 1 Note Ccid3cid6 D f0110 0011g output v D 0110 correct An implementation method straightforward time consuming We save time exploiting following observation If j uj D 0 satisﬁes 41 check 41 holds j later Indeed means exists w0 2 cid6 w0 u w0 j Formally algorithm written follows D 1 Algorithm GENCMODEL Input Characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l T Output A model v 2 Ccid3cid6 cid6 D l iD1 cid6i cid6 6D No Step 1 Find model u cid6 u exists output No T Eiter et al Artiﬁcial Intelligence 110 1999 57101 71 D 1 2 l Qi VD fw 2 Mi j w ug Step 2 j D 1 2 n uj D 0 begin D 1 2 l Pij VD fw 2 Qi j wj D 1g T l iD1 ClPij 6D begin Find model w0 u VD w0 D 1 2 l T l iD1 ClPij Qi VD fw 2 Pij j w ug end end Step 3 Output model v VD u Observe algorithm sets Pij characteristic sets Horn theories T l iD1 ClPij 6D ﬁnding model ClPij Thus testing condition T l iD1 ClPij Step 3 resorts instance Problem MODEL considered previous section solved polynomial time An analysis running time Algorithm GENCMODEL yields following result Theorem 42 Problem CMODEL solved Algorithm GENCMODEL On2 jMi j time P l iD1 Similar case Algorithm GENMODEL Algorithm GENCMODEL outputs particular model cid6 In fact easily outputs maximal model cid6 Recall maxcid6 cid18 Ccid3cid6 holds general characteristic model maximal We obtain following result Corollary 43 Given characteristic sets Ccid3cid6i Horn theories cid6i D 1 l GENCMODEL ﬁnds maximal model v cid6 D jMij time cid6 6D outputs No cid6 D T l iD1 cid6i On2 P l iD1 Corollaries 35 43 unique smallest model maximal model cid6 computed polynomial time We come result consider abductive reasoning intersection We remark point ﬁnding maximum model cid6 model largest number components set 1 maximal model problem statement Corollary 43 intractable PDNP shown 20 Observe ﬁnding maximum model arbitrary Horn theory cid6 intractable input Horn formula bcid6 representing cid6 easily On jMi j time linear time input Ccid3cid6 P l iD1 72 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 42 Recognizing characteristic model The fact compute characteristic model intersection cid6 efﬁciently automatically mean recognize characteristic model fast nonetheless task solved polynomial time The key obtaining result following lemma Lemma 44 Let cid6 Horn theory v model cid6 Then v 2 Ccid3cid6 holds v 6D 11 cid1 cid1 cid1 1 v D cid6v D fw 2 cid6 j w vg w w2mincid6v V Proof The ifpart obvious For onlyifpart let v 2 Ccid3cid6 Then v D w w w2mincid6v w Clearly component j exists uj D 0 u 2 cid6v wj D 1 w 2 mincid6v However contradicts w 2 mincid6v satisﬁes w 6 u 2 wD v mincid6v cid18 cid6v If w2mincid6v w w2cid6v w2cid6v w2cid6v V V V V Exploiting lemma construct following algorithm recognizing characteristic model set S construct mincid6v Since w 2 mincid6v satisﬁes wj D 1 j vj D 0 S constructed collecting wj j vj D 0 wj model set fw 2 cid6v j wj D 1g Algorithm CHECKCMODEL Input Characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 l model v 2 cid6 D T l iD1 cid6i Output Yes v 2 Ccid3cid6 No Step 0 v D 11 1 output Yes halt S VD Step 1 j vj D 0 begin D 1 2 l Pij VD fw 2 Mi j w v wj D 1g T l iD1 ClPij 6D begin T l wj model iD1 ClPij S VD S fwj g end end Step 2 v D V wj2S wj output No output Yes T Eiter et al Artiﬁcial Intelligence 110 1999 57101 73 Example 42 Let consider M1 D Ccid3cid61 D f0110 0011 1010g M2 D Ccid3cid62 D f1110 0111 0011g suppose v D 0110 Then Step 0 CHECKCMODEL S VD Step 1 j takes values 1 4 For j D 1 obtain P11 VD P21 VD f1110g ClP11 ClP21 D S unchanged For j D 4 P14 D P24 D f0111g S D changed In Step 2 check v D wj2S wj yields false recall V w2S w D 11 1 holds S D output Yes Note v D 0110 V characteristic model cid6 seen Example 41 Similarly Algorithm GENCMODEL sets Pij characteristic sets Horn T l iD1 ClPij 6D ﬁnding T l iD1 ClPij Step 3 polynomial time GEN theories ClPij Thus testing condition model CMODEL An analysis running time Algorithm CHECKCMODEL yields following result Theorem 45 Given characteristic sets Ccid3cid6i Horn theories cid6i cid18 f0 1gn iD1 cid6i checking v 2 Ccid3cid6 possible D 1 l model v 2 cid6 D On2 jMi j time Algorithm CHECKCMODEL T l P l iD1 Recall Algorithm GENCMODEL outputs maximal model Corollary 43 We remark Algorithm CHECKCMODEL subroutine modify GENCMODEL computes characteristic model polynomial time necessarily maximal model theory cid6 This CHECKCMODEL testing u 2 Ccid3cid6 method described beginning Section 41 However resulting algorithm higher running time GENCMODEL 5 Computing characteristic models models We turn issue generating characteristic models models theory cid6 cid6 intersection Horn theories cid61 cid6l Let ﬁrst consider computing characteristic models 51 Computing characteristic set intersection It known easy Horn theory cid6 number jcid6j models exponential jCcid3cid6j Thus output size Problem ALLMODELS exponential input size For Problem ALLCMODELS derive analogous result Proposition 51 For n 1 exist Horn theories cid61 cid62 jCcid3cid61j D jCcid3cid62j D 2n jCcid3cid6j D 2n cid6 D cid61 cid62 74 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 Proof Fix n deﬁne sets vectors S1 S2 cid18 f0 1g4n follows Let Vi D S 3 iD0 Vi D f1 4ng observe fi cid1 n C j j j D 1 ng D 0 3 V D V0 contains ﬁrst n components V1 n components Then S1 D S2 D cid9 cid8 xV nV2fj3nCj g xV nV2fnCj3nCj g j 1 6 j 6 n cid9 cid8 xV nV3fj2nCj g xV nV3fnCj2nCj g j 1 6 j 6 n Notice S1 vector penultimate block n bits set 0 The blocks set 1 bit j block bit j ﬁrst second block switched 0 The set S2 similar S1 penultimate blocks exchanged For n D 2 example S1 D f01110001 11010001 10110010 11100010g S2 D f01110100 11010100 10111000 11101000g Observe jS1j D jS2j D 2n Since S1 D maxS1 S2 D maxS2 Horn theories cid61 cid62 Ccid3cid61 D S1 Ccid3cid62 D S2 Since models xB Ccid3cid61 respectively Ccid3cid62 satisfy B V2 D respectively B V3 D models xB 2 cid6 satisfy B cid18 V0 V1 2n bits model cid6 0 Deﬁne S D fxB j B cid18 V0 V1 j 2 B n C j 2 B 1 6 j 6 ng For n D 2 S D f00110000 10010000 01100000 11000000g Observe jSj D 2n holds It shown S D Ccid3cid6 holds Appendix A proves result 2 51 52 Let state problem computing characteristic models intersection formally Problem ALLCMODELS Input Sets characteristic models Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D T l iD1 cid6i Output All characteristic models v cid6 D 1 2 l The previous proposition tells output size problem exponential input size Therefore polynomial time algorithm input size impossible This improves previous result 20 Theorem 6 states ALLCMODELS T Eiter et al Artiﬁcial Intelligence 110 1999 57101 75 l D 2 solvable polynomial time P D NP Proposition 51 true regardless P D NP holds However hope ALLCMODELS polynomial total time algorithm However hope come true following related problem intractable Problem ADDCMODEL Input Characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l set S cid18 Ccid3cid6 cid6 D Question Ccid3cid6 n S 6D T l iD1 cid6i Theorem 52 Problem ADDCMODEL NPcomplete This holds l ﬁxed 2 Proof For candidate model v 2 f0 1 gn apply Theorem 45 check condition v 2 Ccid3cid6 n S polynomial time Thus ADDCMODEL NP V We prove NPhardness reduction satisﬁability problem SAT 19 Given m CNF formula cid8 D iD1 Ci n atoms x1 xn deﬁne polynomially computable sets M1 M2 S vectors f0 1gnC2m M1 D Ccid3cid61 M2 D Ccid3cid62 S cid18 Ccid3cid61 cid62 Moreover S D Ccid3cid61 cid62 holds cid8 unsatisﬁable Without loss generality following assumptions literals L D fxi xi j 1 6 6 ng appear cid8 literal appears clauses ii cid8 tautology ﬁxing truth values atoms xi xj It easy restrictions cid8 affect NPcompleteness SAT Deﬁne V D VL V1 V2 VL D f1 2 n 1 2 ng V1 D fn C 1 n C 2 n C mg V2 D fn C m C 1 n C m C 2 n C 2mg Intuitively elements VL correspond literals L elements n C j V1 n C m C j V2 correspond clause Cj cid8 Now deﬁne instance problem follows Ccid3cid61 D T11 T12 cid8 xV1nfnCj gVLnfqg j n C j 2 V1 q 2 Cj cid8 xVLnfkkgV2 j k 2 VL cid9 I T11 D T12 D Ccid3cid62 D T21 T22 cid9 53 54 T21 D T22 D cid8 xV2nfnCmCj gVLnfqg j n C m C j 2 V2 q 2 Cj cid9 cid8 xVLnfkkgV1 j k 2 VL I cid9 76 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 S D S1 S2 cid9 cid8 xVLnfkkg j k 2 VL cid8 xVLnfkkqg j k q 2 VL q 6D k k cid9 S1 D S2 D 55 56 57 q 2 Cj denotes literal corresponding q appears clause Cj C1 D x1 _ x3 _ x4 write 1 3 4 2 C1 k D k Each vector S generated intersection vector T11 vector T12 respectively vector T21 vector T22 Observe vectors T11 value 0 components V2 vectors T21 value 0 components V1 fact vectors T11 T21 similar roles V1 V2 interchanged Intuitively vector T11 represents choice literal q 2 Cj represented switching component n C j block 1s V1 component q block VL 0 By selecting vectors v1 vm T11 clause obtain collection literals m satisfying literals makes cid8 true note intersection v D iD1 vi vectors vector cid61 0 components V1 V2 Similarly selecting corresponding vectors u1 um T21 v generated m intersection v D iD1 ui cid62 Thus v belongs cid61 cid62 If v corresponds selection select literal opposite v generated intersection set vectors S intersection 0 k k component k This means characteristic vector cid61 cid62 exists contained S An arbitrary selection literals include opposite literals q q illegal selections 0 components k k k corresponding vector v generated S Summarizing exists additional characteristic model cid6 contained S exists legal choice literals clauses cid8 satisﬁes formula The details proof Appendix A 2 V V The result intuitively explained fact characteristic model special model satisfy intersection condition While feasible check condition given model difﬁcult ﬁnd model satisﬁes condition additional constraints There exponential number candidates efﬁcient method hand candidate space substantially reduced Corollary 53 Given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l set S cid18 Ccid3cid6 cid6 D l iD1 cid6i deciding S D Ccid3cid6 coNPcomplete T Exploiting Theorem 52 obtain theorem Theorem 54 There polynomial total time algorithm Problem ALLCMODELS PDNP T Eiter et al Artiﬁcial Intelligence 110 1999 57101 77 Proof Towards contradiction assume algorithm A ALLCMODELS polynomial running time pI O I input length O output length We solve ADDCMODEL A follows Execute A halts ii time pI jSj reached In case output Yes A outputs vector Ccid3cid6 n S No In case ii output Yes implies Ccid3cid6 n S 6D Hence ADDCMODEL solvable time polynomial I jSj contradicts Theorem 52 P D NP 2 Observe result strengthens result 20 Theorem 6 way stating polynomial algorithm exists relativize run time taking possible exponential output size account Practically speaking means computing characteristic models intersection Horn theories hard problem 52 Approximation characteristic set In previous subsection shown computing characteristic set intersection cid6 Horn theories cid61 cid6l intractable As hard problems context reasoning cf 1037 natural ask compute suitable approximation Ccid3cid6 polynomial total time Towards goal ﬁrst agree suitable approximation Ccid3cid6 Recall Ccid3cid6 unique smallest set S cid18 cid6 models cid6 D ClS holds A reasonable requirement approximation M Ccid3cid6 contain models cid6 M cid18 cid6 This assures ClM cid18 cid6 sense soundness representation On hand desirable cid6 cid18 ClM holds M complete respect cid6 4 Let set models M sound complete respect cid6 Ccid3cid6 cid18 M cid18 cid6 holds conservative approximation Ccid3cid6 Observe M D Ccid3cid6 M D cid6 best weakest conservative approximations Ccid3cid6 respectively A conservative approximation seen nonoptimal compact representation cid6 sound complete purpose reasoning cid6 It natural ask ﬁnding reasonably sized conservative approximation M Ccid3cid6 tractable possible output polynomial time Clearly M size exponential size Ccid3cid6 acceptable limit attention M sizes polynomial size Ccid3cid6 The result tells ﬁnding arbitrary conservative approximation intractable Theorem 55 Let pcid1 polynomial 5 Then given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l polynomial total time algorithm computing conservative approximation M Ccid3cid6 cid6 D T iD1 cid6i jMj 6 pjCcid3cid6j P D NP This holds l ﬁxed 2 l 4 Note soundness completeness understood respect representation cid6 If respect query answering cid6 notions reversed 5 Here rest paper assume usual polynomials monotone increasing 78 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 Proof Assume polynomial total time algorithm A exists problem Then outputpolynomial total algorithm Problem ALLCMODELS exists ﬁrst apply A remove output M models v v 2 Ccid3cid6 polynomial time Theorem 45 size Ccid3cid6 observe size intermediate result M bounded polynomial pjCcid3cid6j By Theorem 54 ALL CMODELS polynomial total time algorithm P D NP result follows 2 This result shows gaining tractability conservative approximations Thus soundness completeness approximation abandoned It natural retain soundness completeness dispensable answering certain queries knowledge base Section 61 discussion In giving completeness decide Ccid3cid6 omitted order able use result approximation This straightforward depends intended use knowledge base We embark general issue point principal limitations approach Our result shows approximation Ccid3cid6 regardless sound returns polynomialsize fraction Ccid3cid6 polynomially bounded jCcid3cid6j intractable polynomial total algorithm computation Theorem 56 Let pcid1 qcid1 polynomials Then polynomial total time algorithm A computing given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l set models N cid18 f0 1gn jCcid3cid6j 6 qjN Ccid3cid6j ii jNj 6 pjCcid3cid6j P D NP This holds l ﬁxed 2 As consequence polynomial total time algorithm computing half characteristic set constant fraction Thus quantitative approxima tion Ccid3cid6 infeasible consider qualitative approximations meaningful semantical portions Ccid3cid6 sufﬁcient certain purposes An example portion maximal models maxcid6 intersection cid6 Recall maxcid6 included Ccid3cid6 easily seen set exponentially smaller Ccid3cid6 results apply Moreover easily seen maxcid6 sound complete respect answering negative deductive queries cid11 cid6 deciding cid6 jD cid11 cid11 D C1 cid1 cid1 cid1 Cm _ cid1 cid1 cid1 _ xik reasoning cid6 conjunction negative clauses Ci D xi1 Section 6 As know Corollary 43 computing maximal model cid6 D cid6i possible polynomial time However proof Proposition 51 follows exponentially maximal models exist Thus expect regard polynomial total time algorithm T Unfortunately turns algorithm approximation maxcid6 hard By slight adaptation proof Theorem 52 obtain ﬁnding additional maximal model NPhard Moreover follows Corollary 36 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 79 Lemma 41 cf Lemma 61 recognizing maximal model polynomial Thus analogous arguments proofs previous subsections obtain following result Theorem 57 Given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 l coNPcomplete decide maxcid6 D S holds cid6 D T l iD1 cid6i S given set maximal models cid6 ii polynomial total time algorithm computing maxcid6 P D NP iii polynomial total time algorithm computing polynomial approxi mation maxcid6 P D NP Here polynomial approximation iii understood setting Theorem 56 There reason raising ones hands desperation negative results After ideas characteristic models offline compilation efﬁcient online reasoning For offline compilation willing pay high computational price The results tell case intersection knowledge bases pay price However mean abandon search reasonable good algorithms compilation In rest section present algorithm enumerating arbitrary models cid6 polynomial delay algorithm basis algorithm computing Ccid3cid6 contexts 53 Computing models intersection Let consider problem computing models intersection The formal statement problem follows Problem ALLMODELS Input Sets characteristic models Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l Output All models v cid6 D T l iD1 cid6i It turns problem easier related Problem ALLCMODELS shall present polynomial delay algorithm Informally algorithm ﬁrst ﬁnds T l model cid6 step systematically shrinks theory cid6 D iD1 cid6i subset cid6 0 model cid6 0 output far ﬁnding model cid6 0 efﬁciently possible The enumeration algorithm based dynamic lexicographic enumeration 12 improves previous technique 40 efﬁcient enumeration models Horn theory represented Horn formula The idea restrict cid6 subset cid6 0 models different models v1 v2 vk D v output previous steps select cid6 0 model w largest common preﬁx v By clever bookkeeping previous preﬁxes possible ﬁnd model cid6 0 cid6 6D efﬁciently The bookkeeping maintaining binary vector mark 2 f0 1gn value marki indicates search models w 2 cid6 common preﬁx 80 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 cid0 1 vj D wj 1 6 j vi 6D wi successfully attempted marki D 1 marki D 0 output ﬁrst model v1 mark initialized zero vector 00 0 The algorithm ALLMODELS uses subroutine PARTMODEL following speciﬁcation Procedure PARTMODELcid61 cid62 cid6lI b1 b2 br Input Characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l list b1 b2 br r 6 n values bi 2 f0 1g 1 6 6 r T l iD1 cid6i wi D bi holds D 1 2 r Output A model w 2 cid6 D model exists No By means procedure possible check partial vector given b1 br completed model cid6 model returned case Observe procedure implemented described proof Lemma 61 returns model possible outputs The main algorithm follows Algorithm ALLMODELS Input Characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l Output All models v 2 cid6 D T l iD1 cid6i cid6 6D No Step 1 GENMODEL ﬁnd model v 2 cid6 answer No output No halt begin output v mark VD 00 0 VD n end Step 2 marki D 0 begin PARTMODELcid61 cid6lI v1 vicid01 1 cid0 vi model w returned begin output w set v VD w marki VD 1 j D C 1 n markj VD 0 VD n C 1 end end Step 3 D 1 halt begin VD cid0 1 goto Step 2 end T Eiter et al Artiﬁcial Intelligence 110 1999 57101 81 The algorithm reformulated slightly efﬁcient use readable version sake simplicity We illustrate algorithm following example Example 51 Let consider M1 D Ccid3cid61 D f0110 0011 1010g M2 D C cid3 cid62 D f1110 0111 0011g In Step 1 GENMODEL returns model cid6 v D 0010 model output mark initialized 0000 VD 4 In Step 2 PARTMODEL called list 0 0 1 1 bi values omit cid61 cid6l accessed global variables The model 0011 returned output assigned v mark updated 0001 set 5 decreased 4 Step 3 computation returns Step 2 In Step 3 decreased 3 iteration Step 2 PARTMODEL called bi values 000 The answer No decreased 2 Step 3 Subsequently Step 2 PARTMODEL called bi values 01 The model w D 0110 returned output v VD 0110 mark VD 0100 VD 5 In 2 iterations PARTMODEL called bi values 0111 010 respectively No returned decreasing 1 PARTMODEL called single bi value 1 returns No Hence Step 3 D 1 true algorithm stops Thus models output 0010 0110 0011 precisely models cid6 The analysis time complexity Algorithm ALLMODELS gives result Theorem 58 Algorithm ALLMODELS polynomial delay algorithm Problem ALLMODELS delay jMij O n2 lX iD1 number atoms times input length By combining Algorithms ALLMODELS CHECKCMODEL obtain algorithm enumerating characteristic models cid6 polynomial delay algorithm Nonetheless Algorithm ALLMODELS restrict search space vectors f0 1gn models cid6 cid6 small size polynomial size Ccid3cid6 algorithm runs polynomial total time The algorithm particularly attractive size input I D M1 Ml cid18 f0 1gn small number n observe I exponential n computing models characteristic models possible time polynomial input size brute force search 82 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 6 Reasoning intersection In section turn attention reasoning intersection cid6 Horn theories cid61 cid6l In particular ﬁrst consider answering deductive query cid11 posed cid6 abduction setting propositional letter q explanation basis set A assumptions theory cid6 61 Deduction One striking advantages modelbased reasoning large classes queries knowledge base evaluated efﬁciently It shown 24 deduction arbitrary CNF formula cid11 Horn theory cid6 polynomial cid6 represented characteristic models Ccid3cid6 To evaluate deduction cid6 jD cid11 sufﬁcient check cid6 jD C holds clause C cid11 problem solved checking Horn strengthening C0 C Horn clause C0 obtained C removing positive literal true characteristic models As shown 2425 cid6 jD cid11 decidable OjCcid3cid6j cid1 jcid11j2 time jcid11j length cid11 Following paradigm arbitrary query cid11 posed intersection cid6 Horn theories cid61 cid6l answered following way Compute Ccid3cid6 ii Apply fast algorithm deciding cid6 jD cid11 Ccid3cid6 Example 61 Reconsider theories bcid61 D fx1 _ x2 x1 _ x4 x2 _ x4 x3g bcid62 D fx1 _ x4 x1 _ x2 x3g Example 31 characteristic sets Ccid3cid61 D f0110 0011 1010g Ccid3cid62 D f1110 0111 0011g respectively Suppose want know cid6 jD x1 _ x4 _ x3 cid6 D cid61 cid62 observe query cid11 Horn After computing Ccid3cid6 D f0110 0011g check Ccid3cid6 jD x1 _ x3 Ccid3cid6 jD x4 _ x3 holds x1 _ x3 x4 _ x3 Horn strengthenings cid11 However clauses evaluate false 0110 cid6 6jD cid11 concluded Indeed observe bcid6 D fx1 x2 _ x4 x3g query cid11 derivable On hand cid6 jD x1 _ x2 holds x1 false models Ccid3cid6 This approach infeasible computation Ccid3cid6 need exponential time results previous section Nonetheless possible evaluate cid6 jD cid11 efﬁciently method bypasses computation Ccid3cid6 The reason test cid6 jD C single clause C reduced consistency test efﬁciently solvable This consequence lemma Let formula cid30 modelscid30 denote set models Lemma 61 Given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l literals 1 deciding cid1 D models1 cid1 cid1 cid1 T l iD1 cid6i 6D holds ﬁnding model cid1 exists possible P l iD1 On jMij time linear time T Eiter et al Artiﬁcial Intelligence 110 1999 57101 83 Proof We obtain algorithm desired slight adaptation Algorithm GENMODEL ﬁxes values components models according 1 Suppose j D xij j D 1 h j D xij j D h C 1 k opposite literals 1 cid1 D Modify GENMODEL follows Let w 2 f0 1gn vector value 1 components ij j D 1 h cid1 cid1 cid1 xih set N VD fij j value 0 w model xi1 h C 1 6 j 6 ag Then cid15 replace Step 0 assignment Qi VD Mi Qi VD fv 2 Mi j v wg assignment u VD 0 0 0 u VD w cid15 replace Step 2 assignment uk VD 1 conditional statement k 2 N output No halt uk VD 1 Along argument proof Theorem 34 shown modiﬁed algorithm correctly outputs model fact model cid1 exists No observe search space models restricted set cid1 cid1 cid1 xih search stopped soon f0 1gn set models xi1 T l cid1 cid1 cid1 xih recognized model modelsxi1 iD1 cid6i value 1 component j xj occurs hC1 It easy modiﬁcations order run time affected jMij This proves lemma 2 remains On P l iD1 Theorem 62 Given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l clause C D 1 _ cid1 cid1 cid1 _ deciding cid6 jD C holds possible On jMij time linear time P l iD1 Proof Clearly cid6 jD C cid6 modelsC D holds Since C equivalent 1 cid1 cid1 cid1 denotes complement literal result immediately follows Lemma 61 2 Corollary 63 Given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l CNF formula cid11 cid6 jD cid11 checked Onm jMij time m number clauses cid11 P l iD1 Proof Since cid6 jD cid11 holds cid6 jD C clause C cid11 follows Theorem 62 2 For particular important class formulas obtain following result Recall formula cid30 necessarily CNF positive atoms occurs number negations particular negationfree formula positive Theorem 64 Given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l positive formula cid11 cid6 jD cid11 checked On jMij C jcid11j time linear time jcid11j denotes length cid11 P l iD1 Proof Since cid30 positive holds theory cid6 cid6 jD cid11 holds v jD cid11 holds v 2 mincid6 29 Section 3 84 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 Since cid6 Horn unique minimal model u provided cid6 6D jMij time Corollary 35 Moreover checking v jD cid11 possible constructed On time On C jcid11j Hence result follows 2 P l iD1 62 Abduction Abduction 35 principal mode reasoning heavily daily life reasoning Informally abduction task ﬁnding explanation certain observations based background theory describing relationships causes effects There growing literature subject recognized important principle commonsense reasoning 5 applications references 15 More formally abduction deﬁned follows recall bcid6 transforms Horn theory cid6 equivalent set Horn clauses Deﬁnition 61 Let cid6 theory A subset atoms cid6 q atom Then subset E literals atoms A explanation q cid6 A bcid6 E consistent bcid6 E jD q 6 Usually interested minimal explanations explanations E contain explanation properly Example 62 Consider theory bcid6 D cid8 x1 _ x4 x4 _ x3 x1 _ x2 cid9 Suppose want explain q D x2 A D fx1 x4g Then ﬁnd E D fx1g explanation Indeed bcid6 fx1g consistent bcid6 fx1g jD x2 Moreover E minimal On hand E0 D fx1 x4g alternative nonminimal explanation x2 One main obstacles implementation abduction intrinsic computa tional cost Under formulabased representation ﬁnding abductive explanation NP complete Horn case 38 6p 2 complete general propositional theories 15 prototypical complexity nonmonotonic reasoning problems However shown 2425 ﬁnding explanation polynomial Horn case cid6 represented characteristic models This encouraging result shows deduction abduction Horn theory polynomial time Since Theorem 64 previous subsection states deduction intersection cid6 Horn theories cid61 cid6l polynomial time advantageous similar result obtained abduction However turns desired generalization positive result 25 apparent 6 Observe texts explanations sets positive literals As Horn theories known cf 29 explanation exists explanation containing merely positive literals exists fact minimal explanations form T Eiter et al Artiﬁcial Intelligence 110 1999 57101 85 Theorem 65 Given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 l assumption set A cid18 fx1 xng atom q x1 xn deciding T l q explanation cid6 D iD1 cid6i A NPcomplete Proof The problem NP guess explanation E check polynomial time bcid6 E consistent Lemma 61 bcid6 E jD q testing equivalent condition cid6 jD E cid27 q Theorem 62 The NPhardness shown modiﬁcation reduction proof Theorem 52 There constructed CNF formula cid8 characteristic sets Ccid3cid61 D T11 T12 Ccid3cid62 D T21 T22 Horn theories cid61 cid62 respectively subset S characteristic set cid6 D cid61 cid62 characteristic model v 2 Ccid3cid6 n S exists cid8 satisﬁable We modify construction follows Introduce new component atom 0 set component 0 vectors T12 T22 1 vectors T11 T21 denote resulting sets T 0 i2 D 1 2 ij j D 1 2 let Ccid3cid6 0 Observe vector resulting intersection set vectors T 0 i1 value 1 component 0 vector resulting intersection involves i2 value 0 component Moreover vectors Ccid3cid6 0 vector T 0 incomparable T 0 i1 D 1 2 Following argument proof Theorem 52 seen model cid6 0 D cid6 0 1 i2 characteristic set Horn theory D cid6 0 2 form xB B cid18 VL f0g model D T 0 cid6 0 T 0 T 0 i1 vk D xVLnfkkg belongs cid6 0 k 2 VL notice vk component 0 set 0 Let q propositional atom corresponding newly introduced component 0 let A propositional atoms corresponding components alternatively set A D VL Intuitively want explain q ﬁnd model v cid6 following properties v value 1 component 0 ii ﬁx values literals A v possible switch component 0 0 model cid6 Since vk components k k 0 set 0 v correspond choice literals satisfaction makes cid8 true In Appendix A detailed proof q explanation cid6 A cid8 satisﬁable The theorem follows 2 This result shows tractability result abduction 24 robust The intuitive reason positive result 24 explanation exists explanation easily maximal models cid6 included Ccid3cid6 However case cid6 intersection theories maxcid6 explicitly given exponential number maximal models exist While computing maximal model tractable Corollary 43 computation maximal model gives rise explanation E NPhard As abduction intersection intractable suspected strategy computing Ccid3cid6 running polynomial algorithm 24 useful Although case Ccid3cid6 requires exponential space 86 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 general computation takes exponential time evaluation abductive query possible polynomial space exponential time cases polynomial time An example following special case follows immediately Theorem 62 simple exhaustive search Theorem 66 Given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 l assumption set A cid18 fx1 xng atom q x1 xn ﬁnding T l explanation q cid6 D iD1 cid6i A possible polynomial time size jMij time linear time A Olog n Moreover possible On jAj 6 k holds constant k P l iD1 The conclusion draw look particular query proﬁles frequent tractable decide strategy follow basis results inquiry Observe space issue answering polynomially solvable abductive queries longer exponentially longer ﬁrst compile Ccid3cid6 offline online evaluation cid61 cid6l 7 NonHorn theories In section consider possible generalization results nonHorn theories In particular consider class extended Horn theories includes Horn theories close variant thereof We shall particular class main problems considered previous sections intractable 71 Generalized characteristic models We ﬁrst review monotone theory Boolean functions introduced 6 recall deﬁnition characteristic models arbitrary classes C Boolean functions Given model b 2 f0 1gn deﬁne partial order 6b f0 1gn v 6b w holds v cid8 b 6 w cid8 b holds cid8 denotes XOR operation componentwise addition modulo 2 1100 cid8 0110 D 1010 v 6b w written w b v v b w respectively v b w denotes v 6D w v 6b w respectively v b w In words bi D 0 order ith component normal 0 bi 1 hand bi D 1 order reversed 1 bi 0 The monotone extension model z 2 f0 1gn respect b deﬁned cid9 cid8 v 2 f0 1gn j v b z Mbz D monotone extension theory cid6 cid18 f0 1gn respect b deﬁned Mbcid6 D Mbz z2cid6 The set minimal models cid6 respect b deﬁned minbcid6 D fz j z 2 cid6 v 2 cid6 satisﬁes v b zg T Eiter et al Artiﬁcial Intelligence 110 1999 57101 87 Observe mincid6 D min000cid6 maxcid6 D min111cid6 respectively Mbcid6 rewritten Mbcid6 D Mbz 71 72 z2minbcid6 This Mbv cid18 Mbw holds pairs v w v b w It easy following properties cid6 cid18 Mbcid6 b 2 cid6 b 2 Mbcid6 73 b 2 f0 1gn Furthermore Mb monotonic cid6 distributes unions cid61 cid62 satisﬁes Mbcid61 cid62 cid18 Mbcid61 Mbcid62 Hence 73 72 obtain Mbcid6 cid18 cid6 cid18 Mbcid6 cid18 b 2cid6 b2f01gn Consequently cid6 characterized follows Proposition 71 cid6 D b2f01gn Mbcid6 D b 2cid6 Mbcid6 b 2cid6 Mbcid6 74 In right hand 74 models b 2 cid6 necessary represent cid6 Mbcid6 hold B cid18 f0 1gn n cid6 This leads following T b2B cid6 D deﬁnition T Deﬁnition 71 Bshouty 6 A set models B called basis theory cid6 Mbcid6 holds Furthermore B called basis class theories C cid6 D basis theories C b2B Clearly f0 1gn f0 1gn n cid6 bases theory cid6 f0 1gn basis class theories C It known class Horn theories CH BH D fb j k b k n cid0 1g P n iD1 xi basis 29 kxk D 75 Call theory cid6 reverse Horn 29 negating atoms xi resulting theory Horn cid6 reverse Horn cid6 closed union models v w 2 cid6 implies v _ w 2 cid6 It easy BRH D fb j kbk 6 1g basis class reverse Horn theories CRH 76 88 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 Monotone theory concept basis deﬁne characteristic models arbitrary theories follows Deﬁnition 72 Khardon Roth 29 Let C class theories let B basis C For theory cid6 2 C deﬁne set characteristic models cid0 B cid6 respect B follows cid0 B cid6 D 77 minbcid6 b2B This deﬁnition regarded generalization Horn theories Ccid3cid6 D cid0 BH cid6 78 holds Horn theories cid6 29 Note maxcid6 subset Ccid3cid6 represented maxcid6 D min111cid6 Any model v Ccid3cid6 minimal respect b kbk D n cid0 1 72 Extended Horn theories As generalization class Horn theories 75 reverse Horn theories 76 let deﬁne BEH cid18 f0 1gn cid8 cid9 BEH D b 2 f0 1gn j kbk n cid0 1orkbk 6 1 79 A theory cid6 cid18 f0 1gn called extended Horn BEH basis cid6 let CEH denote class extended Horn theories Clearly Horn theory reverse Horn theory extended Horn In remainder section consider Problems MODEL CMODEL ALL MODELS ALLCMODELS Sections 35 CEH place CH That input sets Mi D 1 2 l sets characteristic models extended Horn theories cid61 cid6l Since class CEH natural extension Horn theories small basis expect positive results previous sections carry Unfortunately case Already Problem MODEL solvable linear time CH intractable Theorem 72 Problem MODEL class CEH NPhard l ﬁxed 2 Proof We reduce following NPcomplete problem 19 problem Problem EXACTHITTINGSET Input A collection S D fS1 S2 Smg subsets ﬁnite set S D f1 2 rg Question Does S exact hitting set subset H cid18 S jH Si j D 1 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 89 Without loss generality assume jSi j D 3 holds 19 Set n D 2m C r let V D f1 ng Deﬁne Q1 Q2 cid18 f0 1gn cid8 xV nfmCkmClmCrCig j k l 2 Si k 6D l cid9 cid8 fimChg j h 2 Si I x Q1 D Q2 D cid9 models Q1 Q2 illustrated follows Let cid61 D ClQ1 cid62 D Cl_Q2 Cl_Q denotes union closure Q dual intersection closure Obviously cid61 cid62 2 CEH cid61 cid62 Horn reverse Horn theories respectively Informally model Q1 corresponds exclusion elements k l Si forming hitting set H model Q2 corresponds inclusion h 2 Si hitting set H Note ﬁrst m components intersection models Q1 1 similarly m components union models Q2 0 Hence model v 2 cid61 cid62 correspond choice exactly element set Si D 1 m To prove result Appendix A set characteristic models cid6i respect class CEH Mi D cid0 BEH cid6i obtained Qi S time polynomial n jQi j D 1 2 ii cid61 cid62 6D S exact hitting set 2 Corollary 73 For class CEH Problem CMODEL NPhard exist polynomial total time algorithms Problems ALLMODELS ALLCMODELS PDNP Proof NPhardness CMODEL immediate Theorem 72 The shown applying argument similar proof Theorem 54 2 Corollary 74 For class CEH answering deductive query cid11 ﬁnding abductive explanation coNPhard cid11 atom set assumptions A respectively From view formulabased representation ﬁnd intractability results surprising Any CNF formula cid8 rewritten conjunction cid8 D cid81 cid82 Horn CNF cid81 reverse Horn CNF cid82 respectively cid81 obtained replacing 90 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 negative literals xi cid8 positive literals yi adding clauses xi _ yi cid82 contains clauses xi _ yi yi new variables An interesting question exists class formulas extends Horn CNFs problems intersection intractable modelbased representation tractable formula based representation This left study 8 Conclusion In paper considered problem taking intersection cid6 D cid6i Horn theories cid6i represented characteristic models We positive negative results T On positive shown deciding consistency computing model characteristic model cid6 polynomial deductive queries cid11 CNF cid6 answered polynomial time More precisely presented algorithms solve model ﬁnding model checking inference cid6 jD C jMij time time linear input size For characteristic clause C On model computation characteristic model checking enumerating models P l jMij time case described algorithms work On2 iD1 upper bound delay subsequent outputs P l iD1 On negative shown computing characteristic models cid6 hard number models taken account In technical terms shown polynomial total time algorithm computing characteristic models P D NP The intrinsic difﬁculty problem unveiled results computing approximation set characteristic models hard problem general quantitative notion polynomiallysized fraction superset qualitative notion terms maximal models theory Moreover shown abductive reasoning intersection cid6 intractable contrasts result 24 shows abductive reasoning given characteristic models cid6 polynomial As discussed results shed light suitability computational aspects modelbased reasoning approach They tell line reasoning versus offline compilation reasoning intersection deliberated offline computation online usage reasoning pay deductive reasoning For insight need study typical structure knowledge bases query proﬁles lack date Further issues remain research One direction extension results classes theories As shown extended Horn theories main problems considered Horn theories intractable This indicates characteristic models approach immediately advantageous computational combining knowledge bases An investigation classes theories Horn theories benign combination remains Another issue concerns possible combination modelbased formulabased approach order complementary representations knowledge base suitable different purposes It appear context T Eiter et al Artiﬁcial Intelligence 110 1999 57101 91 difﬁcult problems computing characteristic set easier In fact recognizing characteristic models cid6 known coNPcomplete maybe polynomial input theories cid61 cid6l represented characteristic models sets Horn clauses Finally comment Problem MODEL somewhat related extension problem double Horn functions 16 extension problem establish Boolean function f consistent given partially deﬁned Boolean function pdBf T F f v D 1 respectively 0 holds v 2 T respectively v 2 F 411 double Horn extension f natural restriction Horn function This relationship comes similarity efﬁcient algorithms solving extension problem problem MODEL However deep semantical relation known Further operations combining theories cid6i needed taking union cid6i Notice cid6 necessarily Horn cid6i Horn Such theory cid6 D approximated Horn theories described 9202526 S Acknowledgement The authors grateful anonymous referees comments paper pointing corrections providing helpful suggestions improvements paragraph Section 72 comment This work partially supported Austrian Science Fund Project N Z29INF The authors gratefully acknowledge partial support Scientiﬁc Grant Aid Ministry Education Science Culture Japan Part research conducted ﬁrst author visited Kyoto University 1995 1998 support Scientiﬁc Grant Aid Ministry Education Science Culture Japan Grant 06044112 Appendix A Proofs Theorem 32 Problem MODEL solved Algorithm GENMODEL On2 jMi j time P l iD1 Proof We ﬁrst prove Algorithm GENMODEL correct Let Qj Step 1 j th iteration let cid18 l_ cid19 uj D w iD1 w2Qj denote set Qi denote model u obtained Step 3 j th iteration Consider ﬁrst iteration If w D w D cid1 cid1 cid1 D w w2Q1 1 w2Q1 2 w2Q1 l 92 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 obviously v D V w2Q1 1 w cid6 Otherwise claim v 2 l iD1 cid1 cid0 Q1 Cl v 2 cid1 cid0 Q2 Cl l iD1 A1 cid18 Q1 holds For converse direction note satisﬁes v u1 Lemma 31 This means v The ifpart holds Q2 iD1 ClQ1 model v 2 represented T l v D w D w D cid1 cid1 cid1 D w2Q0 1 w2Q0 2 w2Q0 l w Q0 cid18 fw 2 Q1 Now A1 implies Q2 j w u1g D Q2 D holds This proves onlyifpart cid6 D l iD1 cid1 cid0 Q1 Cl D I order ﬁnd model v 2 cid6 check model v 2 T iD1 ClQ2 l problem solved returning Step 1 We iterate loop Steps 13 j D 1 2 We claim iteration ﬁnitely terminates To prove uj uj C1 holds Algorithm GEN MODEL halt j C 1st iteration consequence halts n C 1 iterations Since sets Qj monotone nonincreasing respect j uj 6 uj C1 holds Let assume uj D uj C1 holds j Then deﬁnition Qj C1 uj 6 w 6 uj C1 A2 w2QjC1 holds Therefore uj D uj C1 implies uj D w D w D cid1 cid1 cid1 D w w2QjC1 1 w2QjC1 2 w2QjC1 l GENMODEL halts Step 2 j C 1st iteration This proves claim Finally iteration obviously carried cid12 cid12 O n cid12 cid12Qj lX iD1 D O n lX iD1 jMij time Algorithm GENMODEL requires On2 P l iD1 jMi j time total 2 Corollary 33 Given characteristic sets Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 l Algorithm GENMODEL ﬁnds model v cid6 D On2 jMi j time cid6 6D outputs No cid6 D T l iD1 cid6i P l iD1 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 93 Proof Deﬁne Qj proof Theorem 32 Let assume Algorithm GEN MODEL outputs model vcid3 Step 2 kth iteration Then extending A1 j D 1 2 k cid0 1 l cid1 cid0 Q1 Cl v 2 D cid6 v 2 cid1 cid0 Q2 Cl l iD1 cid1 cid1 cid1 v 2 cid0 Qk cid1 Cl l iD1 A3 iD1 T l Thus cid6 D minimal model iD1 ClQk T l iD1 ClQk holds It follows deﬁnition vcid3 vcid3 unique model cid6 2 Theorem 34 Algorithm GENMODEL solves Problem MODEL On time linear time P l iD1 jMi j V w2Mi Proof Algorithm GENMODEL similar GENMODEL Its correctness comes following observation By Lemma 31 u 2 cid6 u w holds D 1 2 l This implies models w Mi satisfy wk D 1 k uk D 1 hold Hence compute model u 2 cid6 ﬁrst initialize u D 00 0 component k satisfying argument update uk VD 1 remove models w wk D 0 Mi new k exists ii Mi D holds In case current u satisﬁes u 2 cid6 u 2 cid6 exists This combined fact buckets counters maintained properly shows correctness GENMODEL P l iD1 For time complexity observe Step 0 setting data structure jMij time bit input incorporated structures On constant time The number iterations Steps 1 2 n numbers 1 v strictly increases iteration Thus total Step 1 maintenance jMij time respectively Furthermore n iterations B Step 2 require On jMij time This Step 2 maintenance B executed On component j model w referred pointer list Lhj immediately removed ﬁrst reference removal entry Lhj induces constant number counter maintenance steps Consequently overall running time GENMODEL On P l iD1 P l iD1 jMij 2 P l iD1 Theorem 42 Problem CMODEL solved Algorithm GENCMODEL On2 jMi j time P l iD1 Proof To establish correctness GENCMODEL remains discussion beginning section verify Lemma 41 V Proof Lemma 41 We assume 41 holds u 2 Ccid3cid6 derive contradiction Then exists model u0 2 cid6 u0 u u 2 Ccid3cid6 implies u02S u0 holds S cid18 Ccid3cid6 model u0 S satisﬁes u D T u0 u Consequently u0 2 l iD1 ClPij hold component j u0 D 1 uj D 0 Since 41 true u holds j uj D 0 j 94 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 conclude u0 follows u 2 Ccid3cid6 contradiction This proves lemma 2 P l iD1 P l iD1 It remains prove bound time complexity Step 1 jMij time Algorithm GENMODEL Corollary 35 In Step 2 On j constructing Pij updating Qi obviously T l iD1 ClPij 6D On P output w0 2 l jMi j iD1 jMi j time In total time Thus P l On2 iD1 T l iD1 ClPij On jMij time Similarly Step 1 checking entire Step 2 executed On2 jMi j time required 2 P l iD1 Theorem 45 Given characteristic sets Ccid3cid6i Horn theories cid6i cid18 f0 1gn iD1 cid6i checking v 2 Ccid3cid6 possible D 1 l model v 2 cid6 D On2 jMi j time Algorithm CHECKCMODEL T l P l iD1 Proof Note models wj 2 S Algorithm CHECKCMODEL satisfy wj v Thus Lemma 44 showing S cid19 mincid6v A4 proves correctness CHECKCMODEL For u 2 mincid6v component j uj D 1 vj D 0 For j let Qi VD fw 2 Mi j w v wj D T T l l 1g D 1 2 l Then u 2 iD1 ClQi Horn theory iD1 ClQi holds Since unique minimal model wj However u 2 mincid6v implies u D wj A4 follows P l iD1 For time complexity CHECKCMODEL Step 0 possible constant time The P l jMij time ifstatement iD1 jMi j jMij time Hence Algorithm CHECKCMODEL inner forloop Step 2 feasible Onj Onj time Step 3 Onj P l runs On2j iD1 jMi j virtue Corollary 35 Hence Step 2 possible On2j jMij time 2 P l iD1 P l iD1 Proposition 51 For n 1 exist Horn theories cid61 cid62 jCcid3cid61j D jCcid3cid62j D 2n jCcid3cid6j D 2n cid6 D cid61 cid62 Proof continued It remains S D Ccid3cid6 52 holds We ﬁrst S D maxcid6cid18 Ccid3cid6 A5 It easy S cid18 cid6 Assume model xB 2 cid6 B cid18 V1 V2 j n C j 2 B j 2 V1 Then j n C j 2 B xB 2 cid61 3n C j 2 B However contradiction 51 Hence fj n C j g 6cid18 B A6 holds implies maximality models S A5 For nonmaximal model xB 2 cid6 n S verify 51 A6 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 v D xB xB 2S xB v holds v 2 Ccid3cid6 This proves claim 52 2 95 A7 Theorem 52 Problem ADDCMODEL NPcomplete This holds l ﬁxed 2 Proof continued Clearly models Ccid3cid6i maximal exist Horn theories cid6i deﬁned characteristic models To reduction appropriate ﬁrst prove following containments S cid18 cid6 B cid18 VL holds xB 2 cid6 S1 cid18 maxcid6cid18 Ccid3cid6 S2 cid18 Ccid3cid6 cid3 S cid18 C cid6 A8 A9 A10 A11 A12 This shows 53 54 55 fact legal instance problem A8 Consider xB D xVLnfkkqg2 S q D k k allowed By assumption cid8 literal q appears clause Cj Thus xV1nfnCj gVLnfqg 2 Ccid3cid61 holds j This combined xVLnfkkgV2 2 Ccid3cid61 implies xB D xV1nfnCj gVLnfqg xVLnfkkgV2 2 cid61 Similarly xB 2 cid62 Hence A8 holds A9 Since xB1 2 cid61 satisﬁes V2 cid18 B1 V2 B1 D xB2 2 cid62 satisﬁes V2 cid18 B2 V2 B D xB 2 cid6 Symmetrically V1 B D holds xB 2 cid6 Hence A9 holds xB 2 cid6 A10 Let xB D xVLnfkkg2 S1 If xB 2 maxcid6 A8 A9 models cid9 cid8 xVL xVLnfkg xVLnfkg cid6 Since xB1 2 Ccid3cid61 satisﬁes B1 cid19 VL xVL 2 cid6 Furthermore xVLnfqg 2 cid61 q D k k possible xVLnfqg D xV1nfnCj gVLnfqg A13 nCj 2V1 holds However impossible assumption cid8 literal q L appears clauses Cj 96 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 A11 For v D xVLnfkkqg 2 S2 exactly w D xVLnfkkg 2 S w v Thus v represented intersection models Ccid3cid6 models cid8 xVLnfkqg xVLnfkqg xVLnfqg cid9 contained Ccid3cid6 n S However proof c b model exists cid6 cid8 ﬁxing appropriate atoms cid8 contradicts assumption ii cid8 Therefore A11 holds A12 Immediate A10 A11 2 Clearly Ccid3cid61 Ccid3cid62 S constructed polynomial time cid8 Hence complete proof remains Ccid3cid6 n S 6D holds b cid8 satisﬁable It easy model u u 6 w w 2 S ClS Thus equivalent existence model xB 2 cid6 xB 66 w holds w 2 S As consequence equivalent c existence model xB 2 cid6 satisfying k 2 B k 2 B k 2 VL To prove equivalence b equivalence conditions b c c b By xB 2 cid61 A9 xB represented xB D xV1nfnCj gVLnfqj g nCj 2V1 qj 2 Cj satisﬁes qj 2 VL n B Since k k contained B conclude cid8 satisﬁable model v cid8v D 1 constructed ﬁxing vk D 1 k 2 VL n B 0 k 2 VL n B 0 1 arbitrarily k k 2 VL n B b c For model v cid8v D 1 let VL n B D fk j vk D 1g fk j vk D 0g This means Cj component qj 2 Cj VL n B Furthermore xB D D xV1nfnCj gVLnfqj g 2 cid61 nCj 2V1 qj 2Cj VLnB nCmCj 2V2 qj 2Cj VLnB xV2nfnCmCj gVLnfqj g 2 cid62 holds model xB 2 cid61 cid62 D cid6 This completes proof 2 Theorem 56 Let pcid1 qcid1 polynomials Then polynomial total time algorithm A computing given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 2 l set models N cid18 f0 1gn jCcid3cid6j 6 qjN Ccid3cid6j ii jNj 6 pjCcid3cid6j P D NP This holds l ﬁxed 2 Proof We prove result extension proof Theorem 52 applying argument similar proof Theorem 54 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 97 Recall shown Theorem 52 Problem ADDCMODEL NPhard In proof described construction characteristic sets Ccid3cid61 Ccid3cid62 set models S cid18 Ccid3cid6 cid6 D cid61 cid62 restricted CNF formula cid8 S 6D Ccid3cid6 holds cid8 satisﬁable The restrictions cid8 literal L appears cid8 literal appears clauses ii cid8 tautology ﬁxing truth value atoms xi xj Without loss generality replace stronger condition i0 atom xi clause xi _ xi occurs cid8 require addition iii cid8 satisﬁable exponentially models size jcid8j cid8 Condition iii easily achieved adding cid8 sufﬁciently clauses yi _ yi yi fresh atoms For formula cid8 satisfying i0 ii iii follows construction characteristic models v 2 Ccid3cid6 n S correspond 11 models cid8 Hence follows cid8 satisﬁable Ccid3cid6 exponential jcid8j cid8 unsatisﬁable S D Ccid3cid6 polynomial jcid8j Suppose algorithm A hypothesized exists running time bounded polynomial rI O I O input output length respectively We use A solve Problem ADDCMODEL polynomial time follows We run A cid61 cid6l rI qpjSj steps maximum running time Ccid3cid6 D S holds Since jCcid3cid6 n Sj exponential jSj S 6D Ccid3cid6 follows S D Ccid3cid6 A halts time S 6D Ccid3cid6 A Consequently Problem ADDCMODEL decided polynomial time implies P D NP result follows 2 Theorem 58 Algorithm ALLMODELS polynomial delay algorithm Problem P l jMij number atoms times ALLMODELS delay On2 iD1 input length Proof The correctness Algorithm ALLMODELS follows fact instance general enumeration scheme described 12 omit details P l iD1 For time complexity note Corollary 33 Algorithm GENMODEL jMi j Furthermore ﬁrst successful ﬁnds model cid6 time On PARTMODEL successful calls PARTMODEL n cid0 1 failing calls PARTMODEL occur Lemma 61 implies run time P l jMij follows delay consecutive outputs PARTMODEL On iD1 P l jMij Finally n cid0 1 failing calls PARTMODEL bounded On2 iD1 jMij occur algorithm halts stops time On2 output P l iD1 Consequently ALLMODELS outputs models cid6 On2 jMij P l iD1 lay 2 Theorem 65 Given characteristic sets Mi D Ccid3cid6i Horn theories cid6i cid18 f0 1gn D 1 l assumption set A cid18 fx1 xng atom q x1 xn deciding T l q explanation cid6 D iD1 cid6i A NPcomplete 98 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 Proof continued We claim q explanation cid6 A cid8 satisﬁable Prior proof claim observe following useful lemma Lemma A1 A letter q explanation Horn theory cid6 assumptions A exists model v cid6 v jD q cid6 jD E cid27 q E set seen conjunction literals A v jD Proof The direction trivial onlyif direction suppose E0 explanation Then exists model v cid6 v jD E0 q Let E described E0 cid18 E bcid6 E0 jD q bcid6 E jD q cid6 jD E cid27 q 2 To prove onlyif direction claim suppose explanation E exists We assume E form Lemma A1 model v 2 cid6 0 Then component 0 v value 1 v intersection vectors T 0 11 Moreover intersection correspond choice literal clause opposite literals selected v D xB B fk 6D k 2 VL For model vk D xVLnfkkg 2 cid6 0 w D v vk satisfy w jD E w 6jD q contradicts E explanation From v obtain model formula cid8 proof Theorem 52 For ifdirection suppose cid8 satisﬁable Then model cid8 construct similar proof Theorem 52 model v cid6 0 intersection models T11 components k k set 0 k 2 VL observe v value 1 component 0 Let E Lemma A1 E explanation q Indeed model w 2 cid6 value 0 component 0 w jD q value 0 components k k k 2 VL It follows w jD E clearly cid6 jD E cid27 q Thus Lemma A1 E explanation q This proves claim result 2 Theorem 72 Problem MODEL class CEH NPhard l ﬁxed 2 Proof continued Let consider M1 By 77 M1 D cid0 BH cid61 cid0 BRH cid61 Since maxQ1 D Q1 cid61 D ClQ1 Ccid3cid61 D Q1 Thus 78 cid0 BH cid61 D Q1 Concerning cid0 BRH cid61 let z D w zb D w2Q1 w w2Q1 wb b kbk D 1 Then z 6b v respectively zb 6b v holds v 2 cid61 vj D 0 respectively vj D 1 j denotes index bj D 1 follows min000cid61 D z minbcid61 cid18 fz zbg This implies cid0 BRH cid61 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 99 computable Q1 polynomial time Consequently M1 computable Q1 polynomial time The set M2 obtained similar manner proves ii Any model v 2 cid61 cid62 satisfy vj D 1 vj D 0 j D 1 2 m j D m C r C 1 m C r C 2 m C r C m To prove onlyifpart ii assume model v 2 cid61 cid62 exists Then A14 A15 _ v D w D w w2Q0 1 w2Q0 2 cid18 Q2 We H D fh j xfimChg 2 cid18 Q1 Q0 2 g cid18 S forms exact hitting set S By A14 D 1 2 m holds nonempty sets Q0 1 Q0 2 h xfimChg 2 Q0 jH Si j 1 2 This means H satisﬁes Furthermore A15 elements k l xV nfmCkmClmCnCig 2 Q0 1 implies k l 2 H Thus jH Si j 6 1 By A16 A17 conclude H exact hitting set S For ifdirection assume H exact hitting set S Then deﬁne cid9 cid8 xV nfmCki mCli mCrCig j fki lig D Si n H D 1 2 m cid9 cid8 xfimChi g j fhig D Si H D 1 2 m D D 0 Q 1 Q0 2 We theorem 2 w2Q0 1 V W w D w2Q0 2 w D v holds v 2 cid61 cid62 proves ii A16 A17 References 1 C Baral S Kraus J Minker Combining multiple knowledge bases IEEE Trans Knowledge Data Engineering 3 2 1991 208220 2 C Baral S Kraus J Minker VS Subrahmanian Combining knowledge bases consisting ﬁrst order theories M Ras ZW Zemankova Eds Proc 6th International Symposium Methodologies Intelligent Systems ISMIS91 Lecture Notes Artiﬁcial Intelligence Vol 542 Springer Berlin 1991 pp 92101 3 C Beeri M Down R Fagin R Statman On structure armstrong relations functional dependencies J ACM 31 1 1984 3046 4 E Boros T Ibaraki K Makino Errorfree bestﬁt extensions partially deﬁned Boolean functions Inform Comput 140 1998 254283 5 G Brewka J Dix K Konolige Nonmonotonic reasoningan overview CSLI Lecture Notes 73 CSLI Publications Stanford University 1997 6 NH Bshouty Exact learning Boolean functions monotone theory Inform Comput 123 1995 146153 100 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 7 R Burke KJ Hammond Combining databases knowledge bases assisted browsing Proc AAAI Spring Symposium Information Gathering 1995 8 M Cadoli The complexity model checking circumscriptive formulae Inform Process Lett 44 1992 113118 9 M Cadoli Semantical computational aspects Horn approximations Proc IJCAI93 Chambéry France 1993 pp 3944 10 M Cadoli M Schaerf Tractable reasoning approximation Artiﬁcial Intelligence 74 2 1995 249310 11 Y Crama P Hammer T Ibaraki Causeeffect relationships partially deﬁned Boolean functions Ann Oper Res 16 1988 299326 12 R Dechter A Itai Finding solutions ﬁnd Technical Report ICSTR9261 University California Riverside September 1992 13 R Dechter J Pearl Structure identiﬁcation relational data Artiﬁcial Intelligence 58 1992 237270 14 W Dowling JH Gallier Lineartime algorithms testing satisﬁability propositional Horn theories J Logic Programming 3 1984 267284 15 T Eiter G Gottlob The complexity logicbased abduction J ACM 42 1 1995 342 16 T Eiter T Ibaraki K Makino Double Horn functions Inform Comput 144 1998 155190 17 D Gabbay C Hogger J Robinson Eds Handbook Logic Artiﬁcial Intelligence Logic Programming Clarendon Press Oxford 1993 18 P Gärdenfors Knowledge Flux Bradford BooksMIT Press Cambridge MA 1988 19 M Garey DS Johnson Computers IntractabilityA Guide Theory NPCompleteness WH Freeman New York 1979 20 G Gogic C Papadimitriou M Sideri Incremental recompilation knowledge J Artiﬁcial Intelligence Res 8 1998 2337 21 A Itai JA Makowsky Uniﬁcation complexity measure logic programming J Logic Programming 4 1987 105117 22 DS Johnson M Yannakakis CH Papadimitriou On generating maximal independent sets Inform Process Lett 27 1988 119123 23 H Katsuno AO Mendelzon Propositional knowledge base revision minimal change Artiﬁcial Intelligence 52 1991 253294 24 H Kautz M Kearns B Selman Reasoning characteristic models Proc AAAI93 Washington DC 1993 25 H Kautz M Kearns B Selman Horn approximations empirical data Artiﬁcial Intelligence 74 1995 129245 26 D Kavvadias C Papadimitriou M Sideri On Horn envelopes hypergraph transversals W Ng Ed Proc 4th International Symposium Algorithms Computation ISAAC93 Lecture Notes Computer Science Vol 762 Springer Berlin 1993 pp 399405 27 R Khardon Translating Horn representations characteristic models J Artiﬁcial Intelligence Res 3 1995 349372 28 R Khardon H Mannila D Roth Reasoning examples propositional formulae database dependencies Acta Informatica appear 29 R Khardon D Roth Reasoning models Artiﬁcial Intelligence 87 12 1996 187213 30 R Khardon D Roth Defaults relevance modelbased reasoning Artiﬁcial Intelligence 97 12 1997 169193 31 H Levesque Making believers computers Artiﬁcial Intelligence 30 1986 81108 32 P Liberatore M Schaerf The complexity model checking belief revision update Proc AAAI 96 Portland OR 1996 pp 556561 33 P Liberatore M Schaerf Arbitration merge knowledge bases IEEE Trans Knowledge Data Engineering 10 1 1998 7690 34 J McKinsey The decision problem classes sentences quantiﬁers J Symbolic Logic 8 1943 6176 35 CS Peirce Abduction induction J Buchler Ed Philosophical Writings ChS Peirce Dover New York 1955 Chapter 11 36 PZ Revesz On semantics theory change arbitration old new information Proc ACM Symposium Principles Database Systems PODS93 1993 pp 7179 T Eiter et al Artiﬁcial Intelligence 110 1999 57101 101 37 D Roth On hardness approximate reasoning Artiﬁcial Intelligence 82 12 1996 273302 38 B Selman HJ Levesque Abductive default reasoning A computational core Proc AAAI90 Boston MA 1990 pp 343348 39 V Subrahmanian Amalgamating knowledge bases ACM Trans Database Syst 19 2 1994 291331 40 L Valiant The complexity enumeration reliability problems SIAM J Comput 8 1979 410421 41 M Winslett Updating Logical Databases Cambridge Univ Press Cambridge 1990