Artiﬁcial Intelligence 202 2013 2951 Contents lists available SciVerse ScienceDirect Artiﬁcial Intelligence wwwelseviercomlocateartint On conditional independence implication problem A latticetheoretic approach Mathias Niepert Marc Gyssens b Bassem Sayraﬁ c Dirk Van Gucht d Computer Science Engineering University Washington 185 Stevens Way Seattle WA 981952350 USA b School Information Technology Hasselt University Transnational University Limburg Martelarenlaan 42 B3500 Hasselt Belgium c Computer Science Department Birzeit University PO Box 14 Birzeit West Bank Palestine d Computer Science Department Indiana University Lindley Hall 215 150 S Woodlawn Ave Bloomington IN 474057104 USA r t c l e n f o b s t r c t Article history Received 4 July 2011 Received revised form 4 June 2013 Accepted 19 June 2013 Available online 28 June 2013 Keywords Conditional independence Probability lattice theory Conditional independence crucial notion development probabilistic systems successfully employed areas vision computational biology natural language processing We introduce latticetheoretic framework permits study conditional independence CI implication problem relative class discrete probability measures Semilattices associated CI statements ﬁnite sound complete inference relative semilattice inclusions presented This shown 1 sound complete inferring general saturated CI statements 2 complete inferring general general CI statements We general probabilistic CI implication problem reduced elementary CI statements The completeness inference latticetheoretic characterization yields criterion use falsify instances probabilistic CI implication problem heuristics approximate falsiﬁcation criterion polynomial time We propose validation criterion based representing constraints sets constraints sparse 01 vectors encode semilattices The validation algorithm works ﬁnding solutions linear programming problem involving vectors matrices We provide experimental results algorithm eﬃcient related approaches 2013 Elsevier BV All rights reserved 1 Introduction Conditional independence important concept artiﬁcial intelligence machine learning It plays fundamen tal role working probabilistic systems successfully employed areas vision speech recognition computational biology robotics Numerous realworld systems modeled probability distribution set random variables Unfortunately reasoning joint probability distribution intractable smallest number cases It notion conditional independence facilitates decomposition joint proba bility distributions smaller parts processed sophisticated ways compute aposteriori probabilities Bayesian Markov networks commonly probabilistic graphical models leveraging conditional dependencies answer probabilistic queries learn probabilistic parameters eﬃciently 1 A deeper theoretical Corresponding author Email addresses mniepertcswashingtonedu M Niepert marcgyssensuhasseltbe M Gyssens bassemsayraﬁgmailcom B Sayraﬁ vguchtcsindianaedu D Van Gucht 00043702 matter 2013 Elsevier BV All rights reserved httpdxdoiorg101016jartint201306005 30 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 investigation mathematical algorithmic properties conditional independence central standing probabilistic models 23 A deep theoretical understanding conditional independence way leveraged probabilistic graphical mod els allows understand shortcomings said models Indeed joint probability distribution decomposed according graphical structure loss information 45 Finding ways assessing suit ability graphical models representation given distribution crucial In particular Studený 6 brought issue forefront leading impressive body work algebraic representations conditional inde pendence structures providing deep links algebraic geometry 67 supermodular functions sets novel algorithms reasoning conditional independencies 89 More motivation research provided problem knowledge elicitation ﬁeld reasoning certainty 1011 Consider problem eliciting knowledge domain experts model probabilistic The resulting incomplete expert feedback combination speciﬁc subjective probabilities conditional independency dependency information random variables consideration conditional probabilities Sta tistical tests different heterogeneous data sets provide additional sources evidence Each piece information interpreted constraint joint probability distribution modeled ﬁnding suitable model constraint satisfaction problem CSP approach harness CSP solvers instances related problems wellknown 1213 However conditional independence dependence statements pose special problem introduce nonlinear constraints resulting unfeasible CSP instances Therefore remaining challenge test consistency conditional independence dependence information collected different sources requires algorithm deciding implication problem CI statements 14 A central notion realm reasoning conditional independence probabilistic conditional independence implication problem decide set CI statements implies single CI statement relative class discrete probability measures While remains open implication problem class discrete probability measures decidable known exists ﬁnite sound complete inference 15 However exist ﬁnite sound inference systems attracted special The prominent semigraphoid axiom Pearl 3 refer System G present paper One main contributions work extend semigraphoids ﬁnite inference refer System A sound complete general probabilistic implication problem In way semigraphoid inference rules provide lower bound inferred System A provides upper bound We demonstrate general case number variables ﬁxed ﬁnite axiomatization exists considering lower upper bounds provides deep insights implication problem allows develop novel algorithm validating rejecting implication problem instances The techniques use obtain results possible introduction latticetheoretic framework We associate semilattices sets variables CI statements Derivability single CI statement set CI state ments System A characterized inclusion semilattice union semilattices We use framework derivability System A context arbitrary CI statements reduced derivability context elementary CI statements CI statements express independence single variables given set variables This result important ramiﬁcations practical point view use elementary CI statements allows canonical representation CI statements We introduce additive implication problem CI statements relative certain classes realvalued functions specify properties classes guarantee soundness completeness A Through concept multiinformation functions induced probability measures 6 ﬁnally link additive implication problem class functions multiplicationbased probabilistic CI implication problem This allows instance System A sound complete inference arbitrary CI statements sets saturated CI statements relative class binary probability measures class discrete probability measures Saturated CI statements deﬁnition involve variables consideration The combination latticeinclusion techniques completeness System A general probabilistic conditional independence problem allows derive criteria falsify validate instances impli cation problem We introduce approximate logical implication algorithm combines falsiﬁcation validation criteria The validation algorithm based results reduction derivability System A general CI statements derivability elementary CI statements It represents set elementary CI statements sparse 01 matrix validates instances implication problem solving linear programs matrix constraint ma trix Thus requiring algorithm decide majority probabilistic conditional independence implication problems leverage linear constraint solvers purposes We present experimental evaluation investigate fraction instances implication problem decided novel approach We report results extensive experiments designed assess viability approach We relate exper imental results falsiﬁcation criteria obtained earlier racing algorithm introduced Bouckaert Studený 8 The linear programming techniques validation criteria subsequently Bouckaert et al 9 We compare experimental results validation criteria results The results exper iments approximation algorithm works effectively compares favorably related work outperforming orders magnitude M Niepert et al Artiﬁcial Intelligence 202 2013 2951 31 2 Related work Probabilistic conditional independence important notion disciplines 23 forming theoretical basis probabilistic graphical models particular eﬃcient probabilistic inference general Numerous lines research devoted study mathematical logical algorithmic properties The ﬁrst axiomatic approach conditional independence introduced Dawid 2 A closely related inference probabilistic CI developed Pearl Paz 16 In lines work threeplace relation characterized similar axiom systems While Dawid termed relation separoid cf Dawid 17 Pearl Paz termed graphoid These relations shown surface context probabilistic conditional independence notions statistics artiﬁcial intelligence Shafer 18 provides comprehensive survey advances use investigation probabilistic conditional independence year 1996 published special issue Annals Mathematics Artiﬁcial Intelligence 1923 A line work stimulated considerable probabilistic conditional independence Pearls book probabilistic expert systems 3 A recent overview principles practice graphical models Koller Friedman 1 A considerable related work exists area uncertainty artiﬁcial intelligence Studenýs work structural representations conditional independence 6 instance highly related present work In fact close connection latticetheoretic representation Studenýs theory imsets 6 algebraic framework study supermodular functions sets Building Studenýs work Hemmecke et al 7 tools integer programming solve open problems concerning imsets Studený discussed use maximization problem class lstandardized supermodular functions posed linear program 24 A different related linear programming formulation validation algorithm CI implication problem introduced Niepert et al 25 Independently Bouckaert et al 9 leveraged theory imsets 6 assemble linear programs verify instances CI implication problem Their approach similar use orders magnitude compact eﬃcient representation We compare linear programming formulations experimental section Section 9 Similarly inﬂuential present work work Geiger Pearl 14 Malvestuto 26 algorithmic logical properties conditional independence In work probabilistic conditional independence approached purely logical point view syntactic inference systems properties respect classes proba bility measures investigated The authors discuss possible algorithms probabilistic conditional independence implication problem computational complexity problems pose open problems This article substantial extension terms theoretical experimental results previous conference papers authors 2527 With article extend theory fully cover case elementary CI statements Section 5 serves basis results Section 9 In addition additional examples reﬁnement theoretical results respect additive implication problem Section 6 signiﬁcant generalization validation algorithm Section 7 experimental section Section 9 expanded additional experiments included previous publications The construction constraint matrix validation algorithm novel contribution increasing eﬃciency validation algorithm The latticetheoretic framework developed continuation previous work present authors Purdom 2832 The theory applicable different areas science Sayraﬁs work instance focused primarily class frequency functions ﬁnite relational databases 31 The derived inference rules frequent itemset mining algorithms heuristics prune search space 33 Matúš 34 Waal van der Gaag 3536 introduce stable independence notion compactly rep resent information conditional independence1 To end conditional independence statements partitioned stable nonstable allowing eﬃcient storage retrieval probabilistic conditional independencies Stable independence studied earlier work present authors 5 Though elaborated paper theory develop applicable stable sets CI statements 3 Preliminaries We deﬁne conditional independence CI statements syntactic notion Finite inference systems frequently decide logical entailment statements syntactic level In context CI statements consider System G semigraphoid axioms Pearl 3 System S Malvestuto 26 Geiger Pearl 14 We add novel inference referred System A compare existing ones purely syntactic level With regard set notation write A B union A B ab set b singleton set confusion possible Throughout paper S denotes ﬁnite universe containing sets consideration For set A write A S A complement A respect S We begin deﬁning conditional independence CI statements 1 Two sets variables stably independent independent relative set variables C remain independent relative superset C 32 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 Fig 1 The inference rules semigraphoid System G Fig 2 The inference rules System S saturated CI statements Fig 3 The inference rules System A Deﬁnition 1 A conditional independence CI statement expression I A BC A B C pairwise disjoint subsets S If A BC S I A BC saturated If A B I A BC trivial In paper consider inference systems CI statements If I inference C set CI statements c single CI statement denote C cid5I c c derivable C inference rules System I Theclosure C I C I set c C cid5I c We ﬁrst consider wellknown semigraphoid axiom 3 denoted System G shown Fig 1 System S 1426 shown Fig 2 In contrast System G rules System S applicable saturated CI statements yield saturated CI statements In rules sets assumed pairwise disjoint Clearly following Proposition 2 System S inferred System G weak contraction rule inferred symmetry decompo sition contraction inference rules Finally consider set inference rules Fig 3 denoted System A Besides rules semigraphoid axiom contains strong union strong contraction rules Clearly G subsumed System A Proposition 3 System G inferred System A weak union rule inferred decomposition strong union rules From System A rules inferred composition rule shown Fig 4 As System A plays pivotal role work use following abbreviations If C set CI statements c single CI statement short C C cid5 c short C cid5A c similarly C A We emphasize section purely syntactic viewpoint CI statements inference rules inference systems In particular imply rules exhibited Figs 1 2 3 4 necessarily M Niepert et al Artiﬁcial Intelligence 202 2013 2951 33 Fig 4 The composition rule Fig 5 For S b c L bc c abc abc b abc c sound andor complete Notice example strong union sound rule inference CI statements relative class discrete probability measures illustrated Examples 35 38 4 Latticetheoretic framework We ﬁrst introduce latticetheoretic framework basis theory developed work We sociate CI statements socalled meet semilattices partially ordered sets pair elements inﬁmum meet 37 If semilattice class sets inﬁmum pair elements set intersection In following term semilattice meet semilattice class sets Subsequently characterize derivability CI statements terms associated semilattices Given subsets A B S write A B U A U B We associate semilattices conditional independence statements follows Deﬁnition 4 Let I A BC CI statement The semilattice I A BC denoted L A BC equals C S A S B S U S C U A U cid7 B U cid7 Notice L A BC closed intersection Example 5 First let S b c Then L bc c illustrated Fig 5 Next let S b c d Then L bc da abcd L bc abcd L ab cd abcd cid2 cid3 bc abcd d abcd cid2 cid3 bc abcd abcd cid2 cid3 ab abcd cd abcd ab ac b c d ac ad bc bd 34 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 For CI statement c L c denotes semilattice c set CI statements C L C cid4 ccid8C L c cid82 Deﬁnition 6 Let I A BC CI statement The set witness sets I A BC denoted W A BC equals b A b B Note I A BC trivial W A BC Using previously deﬁned notion witness sets CI statement rewrite associated semilattice union lattices This crucial opens door proofs induction latticeelements The following result straightforward consequence Deﬁnition 4 Proposition 7 For CI statement c I A BC L c cid4 W W c C W Example 8 Let S b c d consider CI statement Ibc da Then L bc da S bc S d S ab ac Alternatively apply Proposition 7 deduce W bc da bd cd L bc da bd cd ac ab ab ac We given set CI statements C single CI statement c C cid5 c L c L C This characterization derivability CI statements System A terms associated semilattices basis work CI implication problem The implication left right shown straightforward structural induction Therefore focus implication right left need notion witness decomposition Deﬁnition 9 The witness decomposition CI statement I A BC denoted wdec A BC equals Ia bC A b B For set CI statements C wdecC cid8 cid4 ccid8C wdecc We justify decomposition showing CI statement c closure witness decomposition A equal closure c A b union semilattices associated elements witness decomposition equal semilattice associated c Proposition 10 Let c CI statement Then 1 c wdecc 2 L c cid4 ccid8wdecc L c cid8 Proof Let c I A BC For ﬁrst statement inclusion right left derived straightforwardly decomposition symmetry rules To reverse inclusion let A For b B Ia bC wdecc By repeat edly applying composition rule infer Ia BC symmetry IB aC By repeated application composition rule infer IB AC symmetry I A BC Hence c wdecc For second statement let Ia bC wdecc let W b Clearly W bC W Proposition 7 L bC C W The statement follows Proposition 7 cid2 We position prove fundamental equivalence derivability System A inclu sion relationship lattice decompositions consequent antecedents Theorem 11 Let C set CI statements let c single CI statement Then C cid5 c L c L C Proof As said focus Let Ia bC wdecc let W b Since L c L bC L C 1 By Proposition 10 suﬃces Ia bC wdecC statement V C W Ia bV wdecC Ia bW wdecC W L symmetry For inductive step let C V W The inductive hypothesis states V Ia bV Ia 2 As base case exist strong union Let W distinguish cases cid8 Thereto prove stronger downward induction C W For base case cid8 wdecC cid8 W derive Ia bW strong union cid8 W cid8V wdecC cid8 b use symmetry infer Ia bV Otherwise By statement 1 W L C By Proposition 10 exist cid8 b C V V cid8 b cid8 wdecC cid8 W cid8 Hence Ia cid8 If W ccid8wdecc cid8 L c b cid8 b cid8 b cid8 b cid8 b cid8 b cid8 b cid8C cid8C cid8 cid8 cid8 cid8 cid4 Exactly b cid8 2 derive Ia b cid8 cid8 W Assume bV decomposition derive Ia bV cid8 W Using contraction Ia b cid8V Ia bV b cid8 wdecC W Using strong contraction Ia cid8 b cid8V Ia bV cid8 Ia bV b cid8 wdecC ii Neither cid8 2 derive Ia bV cid2 b cid8 We conclude section illustrative example 2 Observe union meet semilattices meet semilattice M Niepert et al Artiﬁcial Intelligence 202 2013 2951 35 Fig 6 The inference rules System E Example 12 Let S b d e let C Ia b Id ea Id eb let c Id e Each CI statements witness set b ﬁrst d e On hand Proposition 7 L C ab b ab b d e ab L c ab b ab Therefore L c L C On hand derive Id e Ia b Id ea Id eb strong contraction rule Therefore C cid5 c consistent Theorem 11 5 Elementary CI statements A witness decomposition CI statement Deﬁnition 9 equivalent original statement derivations System A Proposition 10 Therefore CI statements involved witness decompositions deserve study Deﬁnition 13 A CI statement elementary form Ia bC b distinct elements S C subset S b Elementary CI statements play important role Section 8 following apply developed theory obtain falsiﬁcation validation algorithms probabilistic implication problem Here study properties Deﬁnition 14 Let c I A BC arbitrary CI statement We deﬁne Delc Ia bV C V A BC b A b B Moreover DelC cid8 cid4 ccid8C Delc Given set arbitrary CI statements C arbitrary CI statement c consider sets elementary CI statements G c G DelC 3 We present System E shown Fig 6 involves elementary CI statements In Theorem 16 DelC Delc In Theorem 15 state C c Delc C cid5 c cel Delc DelC cid5E cel G C DelC G Delc These results yield normal form derivations System A ﬁrst given set CI statements derive set elementary CI statements given set CI statements System G set derive new set elementary CI statements System E ﬁnally set derive targeted CI statement inference System G Notice System E inferred System A We start ﬁrst stage normalization straightforward Theorem 15 Let c arbitrary CI statement let C set arbitrary CI statements Then c G c Delc DelC C DelC G Delc G C G We turn second stage normalization involves System E shown Fig 6 System E structed way elementary CI statements derived In addition following property Theorem 16 Let C set elementary CI statements let c single elementary CI statement Then C cid5E c L c L C Proof System E inferred System A The direction follows Theorems 11 15 The proof direction straightforward adaptation proof direction Theorem 11 cid2 Theorems 11 15 16 yield following corollary 3 We emphasize sets elementary CI statements considered witness decompositions corresponding arbitrary CI statements While witness decomposition obtained rules System G decomposition symmetry rules reconstruction original CI statement requires strong union rule 36 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 Corollary 17 Let C arbitrary set CI statements let c single arbitrary CI statement Then following statements equivalent C cid5 c cel Delc DelC cid5 cel cel Delc DelC cid5E cel 6 The additive implication problem An important insight study probabilistic implication problem CI statements gained Studenýs seminal work conditional independence structures 6 He showed CI statement I A BC discrete prob ability measure P satisﬁes I A BC meaning P CP A BC P ACP BC possible assignments variables sets A B C multiinformation function M P induced P function deﬁned Section 7 satis ﬁes M P C M P A BC M P AC M P BC This relationship nontrivial remarkable relates condition deﬁned numerous constraints variable assignment single constraint additive set function Hence reduced multiplicationbased probabilistic CI implication problem additionbased implication problem Therefore ﬁrst develop mathematical machinery additive implication problem section This theory directly applicable analyze probabilistic implication problem Studenýs transformation 61 Preliminaries problem statement We ﬁrst introduce terminology In work realvalued function function F 2S R associating real number subset S Deﬁnition 18 Let I A BC CI statement F realvalued function We F asatisﬁes I A BC denoted cid13a F I A BC F C F A BC F AC F BC For realvalued function F class CI statements C F asatisﬁes C denoted cid13a F CI statement C C F asatisﬁes Deﬁnition 19 Let C set CI statements c single CI statement F class realvalued functions We F c function F asatisﬁes CI statements C C aimplies c relative F denoted C cid13a asatisﬁes c Now given class realvalued functions F classes CI statements C1 C2 additive implication problem C1 C2F decide C cid13a F c C C1 c C2 We proceed deﬁning notion density realvalued function Deﬁnition 20 The density cid5 U XS1U X F U X S realvalued function F realvalued function cid2F deﬁned cid2F X The following wellknown relationship realvalued function density known Möbius inversion justiﬁes 38 Proposition 21 Let F realvalued function Then X S F X cid5 U XS cid2F U The asatisfaction realvalued function CI statement characterized terms equation involving density function This characterization central developing results follows general result 31 Proposition 22 Let cid5 U L ABC cid2F U 0 I A BC CI statement F realvalued function Then cid13a F I A BC In remainder section study properties classes realvalued functions guarantee soundness andor completeness inference systems subsumed System A additive implication These results related probabilistic conditional independence implication Section 7 62 General soundness properties We ﬁrst deﬁne soundness exhibit characterizations M Niepert et al Artiﬁcial Intelligence 202 2013 2951 37 Deﬁnition 23 Let I inference CI statements F class realvalued functions C1 C2 classes CI statements Then I sound additive implication problem C1 C2F set CI statements C C1 single CI statement c C2 C cid5I c implies C cid13a F c In remainder Section 6 shall consider Call class CI statements universe S Csat class saturated CI statements S In order characterize soundness additive implication inference systems introduce zerodensity property Deﬁnition 24 A class realvalued functions F zerodensity property set CI statements C realvalued function F F CI statement c C cid13a F c implies cid2F U 0 U L c Example 30 lists realvalued functions illustrating zerodensity property We provide characterizations soundness System A Theorem 25 Let I consist symmetry weak union strong union rules Let F class realvalued functions The following statements equivalent 1 System I sound additive implication problem Call CallF 2 F zerodensity property Call 3 System A sound additive implication problem Call CallF cid4 W W I ABC Proof 1 2 Let I A BC CI statement let F F realvalued function cid13a F I A BC We cid2F V 0 V L A BC The proof goes downward induction L A BC By Proposition 7 L A BC C W Hence base case prove cid2F W 0 W W A BC Let W b W I A BC A b B Now Ia bC A B b derivable I A BC weak union symmetry Furthermore Ia bW derivable Ia bC A B b strong union C A B b W Thus I A BC cid5I Ia bW soundness I F Ia bW Because L bW W invoke I A BC cid13a Proposition 22 conclude cid2F W 0 For inductive step let V L A BC The inductive hypothesis states cid8V cid2F U 0 U L A BC strict supersets V Similar base case infer cid13a U L Acid8Bcid8V cid2F U 0 1 Clearly A cid8V supersets V Hence inductive hypothesis 1 reduces cid8 B L A cid2F V 0 cid8 A V B cid8V L A BC Also sets L A cid8 B V V pairwise disjoint Hence Proposition 22 F I A BC follows cid13a F Ia bW Since cid13a F I A C 2 3 Let C set CI statements c single CI statement C cid5 c Let F F cid13a F Since F zerodensity property U L C cid2F U 0 By Theorem 11 C cid5 c implies L c L C Hence Property 22 cid13a cid8 B cid8 B cid5 3 1 All rules System I belong System A forweak union inferred Proposi F c tion 3 cid2 63 Soundness properties saturated CI statements We discuss additive implication problem Csat CallF Theorem 26 Let I consist symmetry weak union rules Let F class realvalued functions The following statements equivalent 1 System I sound additive implication problem Csat CallF 2 F zerodensity property Csat 3 System A sound additive implication problem Csat CallF 4 System G sound additive implication problem Csat CallF Proof 1 2 Let I A BC saturated CI statement let F F realvalued function cid13a F I A BC We cid2F V 0 V L A BC The proof similar corresponding Theorem 25 use strong union In base case downward induction argued W b W I A BC A b B CI statement Ia bC A B b inferred I A BC weak union symmetry Since S A BC CI statement equals Ia bW A similar argument applies inductive step 2 3 Analogous corresponding proof Theorem 25 38 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 Table 1 Densities realvalued functions considered Example 30 Density cid2F 10 cid2F 11 cid2F 12 cid2F 13 cid2F 2 01 0 0 0 02 0 03 0 0 02 b 0 0 06 0 06 c 0 0 0 09 03 bc 0 0 0 0 0 ac 0 0 0 0 0 ab 0 0 0 0 0 abc 0 0 0 0 0 3 4 System G inferred System A Proposition 3 4 1 System I subset System G cid2 64 General completeness properties We ﬁrst deﬁne completeness study Section 62 Deﬁnition 27 Let I inference CI statements F class realvalued functions C1 C2 classes CI statements Then I complete additive implication problem C1 C2F set CI statements C C1 single CI statement c C2 C cid13a F c implies C cid5I c In order characterize completeness additive implication System A introduce theKronecker property Deﬁnition 28 A class realvalued functions F Kronecker property Ω 2S U Ω exists F U F cid2F U U cid7 0 X Ω X cid7 U cid2F U X 0 The Kronecker property inspired observation Ω cid2F U behaves Kronecker delta function zero point Let Ω 2 V S V cid2 2 Relative class realvalued functions Kronecker property Ω 2 implies completeness System A Theorem 29 Let F class realvalued functions If F Kronecker property Ω 2 System A complete additive implication problem Call CallF Proof Let F Kronecker property Ω 2 let C cid13a F c Let C set CI statements let c single CI statement Assume C cid2 c equivalently L c cid3 L C Theorem 11 By Proposition 7 sets L C L c Ω 2 Now let U L c L C Since F Kronecker property Ω 2 know exists F U F cid2F U U cid7 0 X Ω 2 X cid7 U cid2F U X 0 From Proposition 22 readily follows cid13a F c F Hence C cid7cid13a F c By contraposition C cid13a F c implies C cid5 c cid2 C cid7cid13a The following example illustrates zerodensity Kronecker properties Example 30 Let S b c Let F1 F 10 F 11 F 12 F 13 F2 F 2 deﬁned densities given Table 1 Now Ω 2 b c F1 Kronecker property Ω 2 F 10 F 11 F 12 F 13 satisfy Deﬁnition 28 respectively b c Hence Theorem 29 System A complete additive implication problem Call CallF1 We investigate F1 satisﬁes zerodensity property First consider F 10 The zerodensity property relative F 10 broken constraint I A BC L A BC C A cid7 B cid7 However F 10 asatisfy constraint deﬁning condition F 10C F 10 A BC F 10 AC F 10BC ﬁrst term nonzero zero Similar arguments given F 11 F 12 F 13 Hence F1 satisﬁes zerodensity property Theorems 25 29 System A sound additive implication problem Call CallF1 Finally consider F2 F 2 satisfy Kronecker property contain functions densities nonzero member Ω 2 It zerodensity property cid13a Ib c F 2 cid2F 2 cid7 0 By Theorem 25 System A sound additive implication problem Call CallF2 Theorem 29 allow statements completeness System A case Theorem 29 goes direction following weak converse Theorem 31 Let F class realvalued functions If A sound additive implication problem Csat CallF complete additive implication problem Csat CsatF F Kronecker property Ω 2 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 39 Table 2 Example binary probability distribution S A B C A B C P 0 0 0 025 0 0 1 000 0 1 0 025 0 1 1 000 1 0 0 025 1 1 1 000 1 1 0 000 1 1 1 025 Proof If S cid3 1 Ω 2 statement true Thus assume S cid2 2 For U Ω 2 let C set nontrivial saturated CI statements I A BC satisfy 1 A U 2 C U cid7 By Proposition 7 L C Ω 2 By construction U L C Now let X Ω 2 X cid7 U If X meets U U let X1 X U X2 X U Otherwise let X1 X2 nonempty disjoint sets X1 X2 X It easily veriﬁed cases I X1 X2 X C X L C Thus L C Ω 2 U Now let U 1 U 2 nonempty disjoint sets U 1 U 2 U let c IU 1 U 2U Since U L c L c L C cid7 By Theorem 11 C cid2 c completeness A additive implication problem Csat CsatF C cid7cid13a F c Hence exists F U F c Since A sound additive implication problem Csat CallF F zerodensity cid13a F U property Csat Theorem 26 Thus X L C Ω 2 U cid2F U X 0 Proposition 22 cid2F U U cid7 0 cid7cid13a F U C cid7cid13a F U c cid2 Theorem 31 Theorem 29 immediately yield following corollary Corollary 32 Let F class realvalued functions If A sound additive implication problem Csat CallF complete additive implication problem Csat CsatF A complete additive implication problem Call CallF 7 The probabilistic CI implication problem Although theory developed Section 6 concerns additive implication problem CI statements applicable probabilistic implication problem The link notion multiinformation functions Studený 6 induced probability measures4 71 Preliminaries problem statement We ﬁrst introduce notations terminology stating studying probabilistic implication problem A prob ability model S s1 sn pair dom P dom domain mapping associating si ﬁnite domain domsi 1 n P probability measure having doms1 domsn sample space For i1 ik S domain vector A domsi1 domsik In follows subsequence 1 n A si1 sik focus probability measures leaving probability models implicit If domains underlying probability model binary consisting values probability measure binary We denote class probability measures Pall class binary probability measures Pbin For probability measure P A S denote P A marginal probability measure P A domain vector A P Aa b P b b ranges domain vectors S A cid5 We deﬁne probability measure satisﬁes CI statement Deﬁnition 33 Let I A BC CI statement P probability measure Then P msatisﬁes I A BC denoted P I A BC domain vectors b c A B C respectively P C cP A BC b c P AC cP BC b c cid13m Relative multiplicative notion msatisfaction deﬁne probabilistic implication CI statements Deﬁnition 34 Let C set CI statements c single CI statement P class discrete probability measures Then C mimplies c relative P denoted C cid13m P c probability measure P P msatisﬁes CI statements C msatisﬁes c For C c P denote C P set c C cid13m P c C class discrete probability measures involved clear context Before continuing illustrate concepts example Example 35 Let S A B C P binary probability distribution shown Table 2 Clearly P A B 0 0 P A B 0 1 P A B 1 0 P A B 1 1 025 P A0 P A1 P B 0 P B 1 050 Hence domain vector u 4 In work consider discrete probability measures 40 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 πuP A B π A B u P Aπ AuP B πB u π X denotes projection X evaluates true We S P conclude P msatisﬁes I A B However P C 0P A BC 0 0 0 075 025 P AC 0 0P BC 0 0 050 050 yields different result Hence P msatisfy I A BC Given class discrete probability measures P classes CI statements C1 C2 probabilistic implication problem C1 C2P decide C cid13m P c C C1 c C2 Next deﬁne KullbackLeibler divergence 39 Deﬁnition 36 Let P Q probability measures satisfying Q s 0 P s 0 domain vectors s S Then KullbackLeibler divergence H deﬁned HP Q cid6 s P s log P s Q s s ranging domain vectors S P s 0 For P Q wellknow property 39 HP Q cid2 0 HP Q 0 P Q We deﬁne multiinformation functions induced probability measures 6 Deﬁnition 37 Let P probability measure The multiinformation function induced P realvalued function M P 2S R deﬁned M P 0 M P A H cid10 P A cid11 cid11 cid11 cid11 cid12 A cid13 P A S A cid7 A realvalued function F 2S R isotone disjoint subsets A B S F A B cid2 F A supermodular pairwise disjoint subsets A B C S F A F A BC cid2 F A B F AC Studený 6 showed multi information functions isotone supermodular By previous remark multiinformation functions nonnegative The class multiinformation functions induced class discrete probability measures P denoted MP P c With result reduce multiplicative probabilistic implication problem CI statements additive implication problem CI statements advantage additive problems usually easier deal multiplicative problems Moreover apply machinery developed Section 6 Studený 6 showed CI statement c cid13a c cid13m MP 72 Soundness completeness properties Deﬁnitions 23 27 soundness completeness inference additive implication problem C1 C2F C1 C2 classes CI statements F class realvalued functions adapted setting probabilistic implication provided F replaced class discrete probability measures P aimplication cid13a replaced mimplication cid13m Example 38 From Example 35 conclude strong union sound probabilistic implication problem Call CallPbin Hence sound probabilistic implication problem Call CallPall It known 40 semigraphoid axioms sound probabilistic implication problem Call CallPall However System G complete Moreover exist ﬁnite set inference rules sound complete implication problem 6 In addition unknown problem decidable For saturated CI statements situation different Malvestuto 26 Geiger Pearl 14 independently showed System S sound complete probabilistic implication problem Csat CsatPall 40 Using results Section 6 bootstrap results follows Theorem 39 1 The class multiinformation functions MPall zerodensity property Csat 2 System A sound probabilistic implication problem Csat CallPall Proof Since System G sound general probabilistic implication problem Call CallPall Csat CallPall The result follows immediately Theorem 26 cid2 sound M Niepert et al Artiﬁcial Intelligence 202 2013 2951 41 Theorem 40 1 The class multiinformation functions MPall Kronecker property Ω 2 2 System A complete probabilistic implication problem Call CallPall Proof By Theorem 392 System A sound probabilistic implication problem Csat CallPall Since System S complete probabilistic implication problem Csat CsatPall follows particular System A The result follows immediately Theorem 31 Corollary 32 cid2 It shown direct calculation class multiinformation functions induced class binary probabil ity measures Kronecker property Ω 2 Therefore System A complete probabilistic implication problem Call CallPbin Please note completeness System A respect class probability functions P automatically imply completeness respect subclass P cid8 P We conclude section soundandcompleteness result Theorem 41 Both System A System G sound complete probabilistic implication problems Csat CallPall Csat CallPbin Proof It remains System G complete probabilistic implication problems This System G complete probabilistic implication problem Csat CallP P arbitrary class probability measures System A 41 cid2 Notice Theorem 41 donot assume CI statements derived saturated 8 Falsiﬁcation validation criteria Decidability CI implication problem class discrete probability measures open known ﬁnite sound complete inference 15 Nonetheless Theorem 40 demonstrates ﬁnite complete inference System A useful provides falsiﬁcation criterion decide nonvalid instances Section 82 Of course instances falsiﬁed desirable validation criteria decide valid ones We develop validation criterion based linear programming techniques Section 83 In preparation explore simpliﬁcations Section 81 First reduce general probabilistic implication problem probabilistic implication problem elementary CI statements Then demonstrate suﬃces consider variables occur CI statements consideration In Section 9 experimental evidence combination falsiﬁcation validation criteria useful deciding large set instances probabilistic implication problem 81 Simpliﬁcations To reduce probabilistic CI implication problem elementary CI statements build work Section 5 elementary CI statements considered purely syntactical point view Proposition 42 Let C set CI statements c single CI statement Then 1 C DelC 2 C cid13m Pall Delc c c cel Delc DelC cid13m Pall cel Proof It suﬃces prove ﬁrst statement set CI statements C By Theorem 15 DelC C sound probabilistic implication problem Call CallPall DelC C G derive C DelC yields C DelC DelC C cid2 G Since System G Theorem 15 We turn second simpliﬁcation variables occur given CI statements need considered implication problem In particular case hidden variables For set CI statements ﬁnite universe S set variables let varC cid8 set variables occurring CI statement C cid8 C cid8 P c probabilistic implication problem relative S Intuitively variables S outside varC c play role Nevertheless restricting instance probabilistic implication problem relevant variables means restricting probability measures considered Therefore need prove formally intuition correct Now consider instance C cid13m 42 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 Lemma 43 Let U V disjoint sets variables Let P U probability measure U Then exists probability measure P U V U V subset X U P X U V P X U Proof Designate 0 element domain variable U V Let u domain vector U v domain vector V Let 0V domain vector V component 0 We deﬁne cid14 P U V u v 0 v cid7 0V P U V u 0V P U u Clearly P U V probability measure U V X U P X U V P X U cid2 For U S PU denotes class probability measures U Proposition 44 Let U V disjoint sets variables C set CI statements U c single CI statement U Then C cid13m c C cid13m c PU PU V U V Obviously P U PU X U P X Proof We ﬁrst prove Thereto let P U V PU V P U V msatisﬁes CI statements C Let P U P U c U V msatisﬁes c P U V msatisﬁes c We turn Thereto let P U P follows P U P U P U msatisﬁes CI statements C By Lemma 43 exists probability function P U V PU V P U P U U V The remainder proof goes lines cid2 U V Hence P U msatisﬁes CI statements C From C cid13m PU P X U An immediate corollary Proposition 44 set CI statements C single CI statement c S PS c targeted simpliﬁcation We shall disregard irrelevant variables c C cid13m PvarC c C cid13m 82 Falsiﬁcation criterion Theorems 11 40 yield falsiﬁcation criterion suﬃcient condition falsify certain instances probabilistic CI implication problem Corollary 45 Let C set CI statements If L c cid3 L C C cid7cid13m Pall c We recall 5 testing lattice inclusion coNPcomplete exists lineartime reduction SAT problem leverage SAT solvers decide semilattice inclusion effectively hundreds variables involved Now falsiﬁed implications average small fraction falsiﬁable result disappointing practical point view Fortunately able large number implications falsiﬁed latticeexclusion criterion identiﬁed Corollary 45 polynomial time heuristics exist provide good approximations said criterion The falsiﬁcation criterion heuristics consider formally exhibited Algorithms 1 2 3 Fig 7 It follows Proposition 7 heuristics returns false L c cid3 L C Corol lary 45 C cid7cid13m c Pall Example 46 The inference rule I A BDC I A DBC I A B DC isnot sound relative class discrete proba bility measures Falsiﬁcation Heuristic 1 reject instance probabilistic implication problem The Falsiﬁcation Criterion actually leads family polynomial time heuristics While Falsiﬁcation Heuristic 1 checks greatest lower bound L c L C Falsiﬁcation Heuristic 2 checks upper bounds L c L C select additional elements semilattice located extremes derive falsiﬁcation heuristics Finally observe alternative falsiﬁcation strategy The principal idea construct discrete probability measure provides counterexample decidable theory reals addition This Bouckaert Studený racing algorithms 8 Needless expensive approach produce false positives sense falsify instances probabilistic implication problem valid This problematic application different goal mind 83 Validation criterion A validation criterion probabilistic implication problem accepts instance problem implication valid If criterion accept instance imply instance invalid One prominent validation criteria algorithm computes closure semigraphoid axioms 23 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 43 Fig 7 The different falsiﬁcation criteria heuristics derived completeness inference A unfortunately validate small fraction set veriﬁable instances Here introduce powerful validation criterion based latticetheoretic framework We harness results represent set CI statements C sparse 01 matrix AC rows correspond elements L C columns correspond certain CI statements form Ia bC induced C Subsequently given CI statement c associate instance C cid13m c linear program equality constraints involving encoding c terms associated semilattice L c matrix AC We C cid13m introduce relevant elementary CI statements c valid linear program solution To achieve Pall Pall Deﬁnition 47 An elementary CI statement c relevant set CI statements C L c L C The set CI statements denoted RC Since System A complete sound probabilistic implication problem Theorem 40 C cid5 c equivalently P c relevant statements associated C need L c L C Theorem 11 necessary suﬃcient C cid13m probabilistically implied C By Proposition 42 subset RC probabilistically equivalent C With CI statement c universe S associate vector vc 2S cid14 vcU 1 U L c 0 U L c In words vc representation characteristic function L c Apart set elementary CI statements equivalent given set CI statements C derivations System A RC following attractive property justiﬁes calling RC basis C Proposition 48 Let C set CI statements let c single CI statement C cid5 c Then CI statement cel RC exists nonnegative integer number kcel vc celRC kcel vcel cid5 Proof With semigraphoid inference rules decomposition weak union L A bDC L A bC D L A DC Moreover L A bC D L A DC set contains supersets C D contain supersets C Hence vI AbDC vI AbC D vI ADC By applying repeatedly follows elementary CI statement cel Delc exists nonnegative integer kcel vc celDelc kcel vcel The ﬁnal result follows observing Corollary 17 Theorems 15 11 Delc RC cid2 cid5 44 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 Observe Ia bC RC Ib aC RC semilattice They associated vector To avoid duplication deﬁne R2C RC CI statements form Ia bC Ib aC longer distinguished Clearly Proposition 48 holds RC replaced R2C We need couple additional results construction linear program The ﬁrst involved multiinformation function M P discrete probability measure P Proposition 49 Let A B C pairwise disjoint subsets S let P discrete probability distribution Then cid5 U L ABC cid2M P U cid2 0 Proof For realvalued function F F C F AC F BC F A BC modular lefthand nonnegative Since M P supermodular 6 Proposition 49 immediately follows cid2 U L ABC cid2F U 31 If F super cid5 We deﬁned vector associated single CI statement We deﬁne vector associated set CI statements C sum vectors associated CI statements C vC cid5 cC vc Proposition 50 Let C set CI statements c single CI statement kc positive real number If CI statement cel R2C exists nonnegative real number kcel vC kcvc cid6 kcel vcel celR2C C cid13m Pall c Moreover C cid13m Pall cel cel R2C kcel 0 C By Proposition 49 CI statement cel Proof Let P discrete probability measure cid13m P R cid5 U L cel cid2M P U cid2 0 Hence cid6 cid6 kcel celR2C U L cel cid2M P U cid2 0 cid5 cid6 cid5 Again Proposition 49 cid5 ccid8C U L ccid8 cid2M P U 0 Proposition 22 Now U L c cid2M P U cid2 0 Now P satisﬁes CI statements C cid6 cid6 0 cid2M P U kc cid2M P U kcel cid2M P U cid6 cid6 ccid8C U L ccid8 U L c celR2C U L cel second equality follows precondition statement Proposition 50 Since terms U L c cid2M P U 0 Thus Propo righthand equation nonnegative kc 0 necessarily sition 22 cid13m P cel cel kcel 0 cid2 P c By token cid13m cid5 Proposition 50 holds sum ranges elementary CI statements There point considering relevant C careful examination proof reveals coeﬃcients sum necessarily 0 contribute solutions equation We write equation Proposition 50 linear program Schrijver 42 minimize cT x subject Ax b x cid2 0 As interested satisfying constraint interested existence feasible solution set c 0 objective function cT x zero As parameters condition A AC matrix associated C deﬁned L C R2C AC U cel cid14 1 U L cel 0 U L cel b vC kcvc Clearly x solution Ax b x vector values kcel cel R2C satisfying equation Proposition 50 Example 51 Let S b d e f cid15 C Ia b Ia bde Id ea Id eb cid16 Based results Section 81 concerning set relevant CI statements exclude variable f Then R2C equals M Niepert et al Artiﬁcial Intelligence 202 2013 2951 45 cid15 Ia b Ia bd Ia Ia bde Id e Id ea Id eb Id eab cid16 Fig 8 The matrix AC Example 51 We denote relevant elementary CI statements c1 c8 respectively Let c c5 Id e Hence varC c b d e The 01 matrix AC shown Fig 8 The rows AC correspond elements L C b d e ab S S 1 26 computed relative varC c S While number possible rows matrix 2 varC c varC c 1 11 L C computed relative ﬁrst reduced 2 varC c 7 The columns correspond relevant elementary CI statements c1 c8 respectively Actually columns equal vectors vc1 vc8 respectively Notice given S number elementary CI statements symmetry cid10 cid13 S 2 S2 2 80 We ﬁrst reduced number cid10 cid13 varC c 2 varC c2 2 24 number relevant elementary CI statements symmetry 8 Compared maximum possible size 26 80 2080 matrix size 7 8 56 C 1 1 1 1 1 2 2 Now choose kc 1 Then vT 0 0 0 1 1 1 2 This vector sum 2nd 3rd 8th column AC Hence AC x vC kcvc nonnegative solution xT 0 1 1 0 0 0 0 1 By Proposition 50 C cid13m c C cid13m We vT C kcvT c c3 C cid13m c2 C cid13m c8 Pall Pall Pall Pall It wellknown linear program LP solvable polynomial time number variables As calculated Example 51 worst case LP exponential number variables matrix columns constraints matrix rows cid13 cid10 S 2 S2 2 2 S S 1 respectively As rule thumb columns matrix AC diﬃcult corresponding LP problem comes An advantage validation strategy naïve approach AC consists vectors representing relevant elementary CI statements R2C This means actual number variables LP small compared worst case We emphasize matrix A 01 matrix leading better numerical stability possibility employ existing sparse matrix data structures5 We come algorithmic issues discuss results experiments Finally consider Proposition 50 Unfortunately express condition kc 0 linear program6 There fore particular choice kc kc 1 Example 51 In remainder section shall relate different choices kc Thereto let CIkc denote set pairs C c elementary CI statement 5 In rare cases solutions LPs inaccurate roundoff truncation errors Therefore obtain solution convert components fractional form integer numerator denominator For resulting vector xfrac check Axfrac b holds exactly accept x solution case 6 Please note authors paper 9 developed method circumvent problem It potential future work combine approach present 46 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 cel R2C exists nonnegative real number kcel vC kcvc monotonicity property cid5 celR2C kcel vcel We following Proposition 52 If k2 cid2 k1 0 CIk2 CIk1 Proof Let C c CIk2 Then cel R2C exists kcel Proposition 50 C cid13m exists k celR2C kcel vcel By c Theorem 40 C cid5 c By Proposition 48 follows cel R2C cid2 0 vC k2vc vcel Combining obtain cid2 0 vc Pall cid5 celR2C k cid8 cel cid8 cel cid5 vC k2vc cid6 kcel vcel celR2C k1vc k2 k1vc cid6 kcel vcel k1vc cid6 cid2 celR2C celR2C k2 k1k cid8 cel kcel cid3 vcel Since k2 cid2 k1 cel R2C k2 k1k cid8 cel kcel cid2 0 Consequently C c C Ik1 cid2 We actually inclusions Proposition 52 strict Example 53 This adaptation Example 63 6 Let S b d e C Ia d Id eb Ib ed Ia ebd Ib dae c Ia deb It easily veriﬁed vC 05vc 05vIad 05vIae 05vIdeb 05vIbed 05vIbde 05vIdeab 05vIbead 05vIbdae CI statements R2C Hence solution equation Proposition 50 kc 05 One verify equation solution kc 05 In Section 9 shall explore actual impact choice kc We conclude section example implication holds falsiﬁed validated algorithms Example 54 This adaptation Example 41 6 Let S b d e C Ia b Ia bd Ia Id eab c Ia bde Observe L c L C latticeexclusion criterion falsify instance implication problem Moreover Studený 6 showed C cid13m c equation Proposition 50 solution kc 0 Pall 9 Experiments The theory previous sections provides formal foundation implementations practical falsiﬁcation validation algorithms probabilistic implication problem With experiments present section address following empirical questions 1 Effectiveness What fraction instances probabilistic CI implication problem falsify validate close decision procedure 2 Eﬃciency How fast algorithm run To variables scale How eﬃcient algorithm compared naïve approach7 terms time space complexity How algorithm compare approaches literature 3 Structural numerical properties How large constraint matrix A different instances What numer ical properties validation algorithm To extent parameter kc validation algorithm inﬂuences effectiveness eﬃciency algorithm Since restrict attention elementary CI statements investigate probabilistic implication problem Cel CelPall Cel class elementary CI statements For experiment ﬁrst generated instances 7 Naïve approach refers straightforward application Corollary 45 simpliﬁcations developed Section 81 falsiﬁcation restricting elementary CI statements relevant ones validation M Niepert et al Artiﬁcial Intelligence 202 2013 2951 47 Fig 9 Falsiﬁcation validation curves approximate decision algorithm 5 variables For number antecedents 90 000 instances considered horizontal line The number decidable instances sum number falsiﬁed instances number validated instances Table 3 Mean standard deviation 10 000 trials time solve linear program optimizing constraint matrix A Variables Without optimizing A With optimizing A 7 8 9 10 Mean 095 ms 379 ms 3299 ms 17430 ms Standard deviation 039 ms 183 ms 5128 ms 90753 ms Mean 020 ms 025 ms 040 ms 061 ms Standard deviation 033 ms 049 ms 077 ms 054 ms implication problem randomly selecting n different sets elementary CI statements C S antecedent m different elementary CI statements c S consequence time We ﬁrst applied falsiﬁcation algorithm instances C cid13m c When falsiﬁcation algorithm failed applied validation algorithm took advantage results create constraint matrix AC vector b C c described Section 8 To solve resulting linear programs Gurobi8 mixed integer linear programming solver employs version simplex algorithm 4243 branchandcut method integer programs We change standard optimization settings solver Furthermore accepted solution rational expansion solved respective constraints For purposes entirely unproblematic objective validate instances implication problem possible ruling false positives All experiments run dualcore 32 GHz Linux PC 3 GB RAM Pall For set elementary CI statements C build optimized constraint matrix AC bottomup System E First closure strong union rule computed Thereafter closure elementary contraction strong contraction rules computed Then compute closure strong union rule Although procedure involve exponential number steps size S naïve method building constraint matrix set elementary CI statements S complex Fig 9 shows number instances probabilistic implication problem falsiﬁed validated algorithms 5 variables For cid5 2 58 number antecedents randomly created n 4500 different sets cid5 elementary CI statements randomly selected m 20 different elementary CI statements consequences time resulting 90 000 instances value cid5 The results 1 small fraction instances decided 2 larger values cid5 5 variables cid5 40 instances falsiﬁed validated The behavior algorithm similar tested numbers variables Table 3 reveals computational eﬃciency gained optimizing constraint matrix A relevant elemen tary CI statements compared naïve approach elementary CI statements The times provided 710 variables averaged 10 000 trials n 100 sets cid5 10 antecedents m 100 different consequences time Table 4 shows average time construct solve linear program sets cid5 10 antecedents 515 variables averaged 100 000 trails n 1000 m 100 The high standard deviations construction solving times exhibit high variance depending input Table 5 ﬁnally compares size optimized constraint matrix constraint matrix resulting naïve approach 8 See httpwwwgurobicom 48 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 Table 4 Mean standard deviation 100 000 trials time needed construct respectively solve linear program relevant elementary CI statements Variables Construction time Solving time 5 6 7 8 9 10 11 12 13 14 15 Mean Standard deviation 050 ms 171 ms 394 ms 868 ms 1619 ms 6574 ms 18098 ms 64062 ms 215081 ms 699910 ms 25 96852 ms 065 ms 219 ms 051 ms 148 ms 371 ms 911 ms 2618 ms 5404 ms 3924 ms 47101 ms 49767 ms Mean 018 ms 016 ms 013 ms 010 ms 026 ms 053 ms 100 ms 223 ms 609 ms 1019 ms 2712 ms Standard deviation 010 ms 015 ms 014 ms 019 ms 032 ms 070 ms 128 ms 248 ms 503 ms 981 ms 2108 ms Table 5 Mean standard deviation 100 000 trials size optimized constraint matrix A compared maximal possible values parenthesis Variables Number rows Number columns 5 6 7 8 9 10 11 12 13 14 15 Mean 1953 26 3514 57 6066 120 9846 247 14672 502 24442 1013 35502 2036 53119 4083 82341 8178 115484 16 369 193060 32 752 Standard deviation Mean Standard deviation 202 573 1185 2312 4166 6801 10274 17639 34751 67225 96026 3863 80 7012 240 10705 672 15236 1792 18832 4608 31961 11 520 42829 28 160 61884 67 582 92339 159 744 130933 372 736 208980 860 160 876 1899 2738 4409 5849 9517 12863 20568 38819 77452 104663 To investigate impact choice kc Proposition 50 conducted experiments sets cid5 10 20 30 antecedents 510 variables averaged 1 000 000 trials m 1000 n 1000 Each run kc 10 6 Despite large difference values 1176 additional instances total 1 000 000 kc 10 20 antecedents 6 variables validated Hence lowering kc provide added beneﬁt small values kc lead numerical instabilities We want empirically verify 1 latticeexclusion criterion falsify large fraction falsiﬁable stances 2 Heuristics 1 2 good approximations fullblown latticeexclusion criterion To results comparable results approaches adopted experimental setup racing algorithm Bouckaert Studený 8 5 attributes One thousand sets antecedents generated randomly selecting 3 10 elementary CI statements resulting total 8000 sets antecedents The falsiﬁcation algorithm heuristics run sets remaining elementary CI statements consequence time This resulted 77 000 instances probabilistic implication problem sets 3 antecedents 70 000 instances sets 10 antecedents The rejection procedure racing algorithm rooted theory imsets instance rejected constructed supermodular functions countermodel It doubleexponential running time reject valid stances probabilistic CI implication problem This racing algorithm purpose deciding implication problem imsets additive implication problem relative class supermodular functions The falsiﬁcation algorithm based Corollary 45 rejects invalid instances CI implication problem Fig 10 left shows results The falsiﬁcation procedure racing algorithm rejects instances approach possibly valid instances Fig 10 right shows rejection curves falsiﬁcation algorithm Heuristics 1 2 combination The compares favorably falsiﬁcation algorithm 95 falsiﬁcations 3 antecedents 77 10 antecedents Also Heuristic 2 effective Heuristic 1 Subsequent conference paper 25 ﬁrst introduced linear programming formulation validation algorithm based Proposition 50 Bouckaert et al 9 leveraged theory imsets 6 include construction linear programs verify instances CI implication problem Their approach identical optimize constraint matrix A considering relevant CI statements columns elements semilattice C rows In addition earlier version LP formulation account parameter kc Proposition 50 We adopted experimental setup Bouckaert et al 9 empirical comparison linear pro gramming formulations For S 410 randomly generated 1000 sets consisting 3 elementary CI statements M Niepert et al Artiﬁcial Intelligence 202 2013 2951 49 Fig 10 Left Rejection acceptance curves racing falsiﬁcation algorithms Right Falsiﬁcations based latticeexclusion criterion heuristics Table 6 Comparison LP formulation Bouckaert et al 9 presented S Bouckaert et al 9 LPsexperiment Timeexperiment Niepert et al paper LPsexperiment Timeexperiment Time construct A Nr rows A Nr columns A Time solve LP Overall nr LPs 4 5 6 7 8 9 10 24 4 ms 834 103 ms 02 ms 606 834 01 ms 8342 80 18 ms 1085 174 ms 044 ms 884 1085 012 ms 10 854 240 115 ms 1745 268 ms 093 ms 1456 1745 01 ms 17 449 672 658 ms 245 406 ms 136 ms 2136 245 011 ms 24 501 1792 5037 ms 4608 15038 s 3545 718 ms 328 ms 3231 3545 011 ms 35 450 5231 1542 ms 81 ms 4902 5231 014 ms 52 306 11 520 38621 s 7979 4301 ms 2306 ms 7518 7979 025 ms 79 790 constructed set relevant CI statements constraint matrix A set antecedents ﬁnally ran validation algorithm possibly implied elementary CI statements consequence Because restrict relevant CI statements number LPsexperiment Table 6 smaller approach approach Bouckaert et al The table lists statistics LP formulations The average time construct constraint matrix A increases 02 ms 4 variables 23 ms 10 variables Since size constraint matrix A remains small average 80 80 10 variables average time solve single LP 025 ms 10 variables compared average time 38621 s11520 300 ms constraint matrix consisting elementary CI statements Bouckaert et als LP formulation orders mag nitudes slower Our procedure needs 4301 ms 10 variables compared 38621 s Bouckaert et als approach 10 Discussion future work Logical inference algorithms probabilistic conditional independence statements important applications checking consistency knowledge elicitation constraintbased structure learning graphical models 44 As generally known exist ﬁnite sound complete axiomatization probabilistic conditional independence implication 6 try best thing enclosing problem lower bound ﬁnite set inference rules sound upper bound ﬁnite set inference rules complete It wellknown semigraphoid axiom referred paper System G sound 40 One main contributions present paper introducing ﬁnite set inference rules System A shown complete probabilistic implication problem While sound complete ﬁnite inference rules transformed tighter lower bound adding true logical implications provable analogous strategy obvious transforming complete sound inference rules tighter upper bound It justiﬁed ask System A sense optimal upper bound This work future research Of course question principle asked complete sound axiomatization It important observe connection System A latticeinclusion property plays pivotal role present paper The theory underlying present paper based study additive implication problem scope applications broader probabilistic implication problem Other application areas include database 50 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 constraints data mining reasoning uncertainty 28293233 Within context probabilistic implication problem theory applicable types sets CI statements stable sets CI statements 5 An important contribution paper falsiﬁcation validation heuristics probabilistic implica tion problem While heuristics rooted latticetheoretical framework supermodularity multi information function played pivotal role development validation criterion Therefore thorough study additive implication respect class supermodular functions called Finally latticeinclusion property heuristics developed paper utilized store information conditional independencies eﬃciently nonredundant representations 5 This line previous work eﬃcient maintenance conditional independence information 3536 Overall believe convincingly argued latticetheoretic framework reasoning conditional independence novel powerful tool Acknowledgements We thank Remco Bouckaert providing source code racing algorithm We want thank Milan Studený continuous support present work particular information provided concerning complete axiomatization implication problem attributes We thank anonymous reviewers conferences workshops UAI PGM especially Artiﬁcial Intelligence journal detailed comments suggestions helped improve clarity quality article References 1 D Koller N Friedman Probabilistic Graphical Models Principles Techniques MIT Press Cambridge MA 2009 2 A Dawid Conditional independence statistical theory J R Stat Soc 41B 1979 131 3 J Pearl Probabilistic Reasoning Intelligent Systems Networks Plausible Inference Morgan Kaufmann Publishers Inc 1988 4 Y Xiang SKM Wong N Cercone Critical remarks single link search learning belief networks Proceedings 12th Conf Uncertainty Artiﬁcial Intelligence Morgan Kaufmann Publishers 1996 pp 564571 5 M Niepert D Van Gucht M Gyssens Logical algorithmic properties stable conditional independence Internat J Approx Reason 51 5 2010 531543 6 M Studený Probabilistic Conditional Independence Structures SpringerVerlag 2005 7 R Hemmecke J Morton A Shiu B Sturmfels O Wienand Three counterexamples semigraphoids Combin Probab Comput 17 2 2008 239257 8 R Bouckaert M Studený Racing algorithms conditional independence inference Internat J Approx Reason 45 2 2007 386401 9 R Bouckaert R Hemmecke S Lindner M Studený Eﬃcient algorithms conditional independence inference J Mach Learn Res 11 2010 34533479 10 SMMS Renooij HJM TabachneckSchijf Eds Proceedings 6th UAI Bayesian Modelling Applications Workshop 2008 11 JY Halpern Reasoning Uncertainty The MIT Press 2003 12 MJ Druzdzel LC van der Gaag Elicitation probabilities belief networks Combining qualitative quantitative information UAI 1995 pp 141148 13 R Dechter Constraint Processing Morgan Kaufmann Publishers Inc 2003 14 D Geiger J Pearl Logical algorithmic properties conditional independence graphical models Ann Statist 21 4 1993 20012021 15 M Studený Conditional independence statements complete characterization Transactions 11th Prague Conference Information Theory 1992 pp 377396 16 J Pearl A Paz Graphoids graphbased logic reasoning relevance relations Adv Artif Intell II 1987 357363 17 AP Dawid Separoids A mathematical framework conditional independence irrelevance Ann Math Artif Intell 32 14 2001 335372 18 G Shafer Advances understanding use conditional independence Ann Math Artif Intell 21 1997 111 19 JTA Koster A graphical characterization lattice conditional independence models Ann Math Artif Intell 21 1997 1326 20 SA Andersson D Madigan MD Perlman CM Triggs Gibbs Markov properties graphs Ann Math Artif Intell 21 1997 2750 21 SL Lauritzen FV Jensen Local computation valuations commutative semigroup Ann Math Artif Intell 21 1997 5169 22 M Studený Semigraphoids structures probabilistic conditional independence Ann Math Artif Intell 21 1997 7189 23 F Matúš Conditional independence structures examined minors Ann Math Artif Intell 21 1997 99128 24 M Studený Structural imsets algebraic method describing conditional independence structures Proceedings Conference Informa tion Processing Management Uncertainty IPMU 2004 pp 13231330 25 M Niepert Logical inference algorithms matrix representations probabilistic conditional independence Proceedings 25th Conference Uncertainty Artiﬁcial Intelligence 2009 pp 428435 26 FM Malvestuto A unique formal binary decompositions database relations probability distributions graphs Inform Sci 59 1992 2152 27 M Niepert D Van Gucht M Gyssens On conditional independence implication problem A latticetheoretic approach Proceedings 24th Conference Uncertainty Artiﬁcial Intelligence 2008 pp 435443 28 B Sayraﬁ A measuretheoretic framework constraints bounds measurements data PhD thesis Indiana University 2005 29 B Sayraﬁ D Van Gucht Inference systems derived additive measures Workshop Causality Causal Discovery London Canada 2004 30 B Sayraﬁ D Van Gucht M Gyssens Measures databases data mining Tech Report TR602 Indiana University Computer Science 2004 31 B Sayraﬁ D Van Gucht Differential constraints Proceedings ACM Symposium Principles Database Systems 2005 pp 348357 32 B Sayraﬁ D Van Gucht M Gyssens The implication problem measurebased constraints Inf Syst 33 2 2008 221239 33 B Sayraﬁ D Van Gucht PW Purdom On effectiveness eﬃciency computing bounds support itemsets frequent itemsets mining problem OSDM 05 Proceedings 1st International Workshop Open Source Data Mining 2005 pp 4655 34 F Matúš Ascending descending conditional independence relations Transactions 11th Prague Conference Information Theory 1992 pp 189200 35 P Waal LC van der Gaag Stable independence complexity representation Proceedings 20th Conference Uncertainty Artiﬁcial Intelligence 2004 pp 112119 36 P Waal LC van der Gaag Stable independence perfect maps Proceedings 21st Conference Uncertainty Artiﬁcial Intelligence 2005 pp 161168 M Niepert et al Artiﬁcial Intelligence 202 2013 2951 51 37 GA Grätzer General Lattice Theory second ed BirkhäuserVerlag 1998 38 JH van Lint RM Wilson A Course Combinatorics second ed Cambridge University Press 2001 39 S Kullback RA Leibler On information suﬃciency Ann Math Stat 22 1951 7986 40 J Pearl A Paz Graphoids Graphbased logic reasoning relevance relations x tell y know z Advances Artiﬁcial Intelligence II Seventh European Conference Artiﬁcial Intelligence 1986 pp 357363 41 M Gyssens M Niepert D Van Gucht About completeness semigraphoid axioms derivation arbitrary conditional independence statements saturated ones Tech rep Indiana University 2011 42 A Schrijver Theory Linear Integer Programming John Wiley Sons Inc 1986 43 G Dantzig Linear Programming Extensions Princeton University Press 1963 44 P Gandhi F Bromberg D Margaritis Learning Markov network structure independence tests Proceedings SIAM International Conference Data Mining 2008 pp 680691