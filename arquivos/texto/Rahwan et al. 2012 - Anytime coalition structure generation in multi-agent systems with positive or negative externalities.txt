Artiﬁcial Intelligence 186 2012 95122 Contents lists available SciVerse ScienceDirect Artiﬁcial Intelligence wwwelseviercomlocateartint Anytime coalition structure generation multiagent systems positive negative externalities Talal Rahwan a1 Tomasz Michalak ab1 Michael Wooldridge c Nicholas R Jennings ad School Electronics Computer Science University Southampton Southampton SO17 1BJ UK b Institute Informatics University Warsaw Warsaw 02097 Poland c Department Computer Science University Liverpool Liverpool L69 3BX UK d Department Computing Information Technology King Abdulaziz University Saudi Arabia r t c l e n f o b s t r c t Article history Received 2 February 2011 Received revised form 29 October 2011 Accepted 17 March 2012 Available online 29 March 2012 Keywords Mechanism design Classiﬁcation Game theory Approximation Much literature multiagent coalition formation focused Characteristic Function Games effectiveness coalition affected agents arranged In contrast little attention given general class Partition Function Games emphasis formation coalition inﬂuence performance coexisting coalitions However intercoalitional dependencies called externalities coalition formation play crucial role realworld multiagent applications agents conﬂicting overlapping goals Against background paper ﬁrst computational study coalitional games externalities multiagent context We focus Coalition Structure Generation CSG problem involves ﬁnding exhaustive disjoint division agents coalitions performance entire optimized While problem challenging absence externalities exponential size search space taking externalities consideration makes challenging size input given n agents grows O 2n O nn Our main contribution development ﬁrst CSG algorithm coalitional games positive negative externalities Speciﬁcally prove possible compute upper lower bounds values set disjoint coalitions Building prove order establish worstcase guarantee solution quality necessary search certain set coalition structures deﬁne We progressively improve guarantee search Since previous CSG algorithms games externalities benchmark algorithm stateoftheart approaches games externalities present Surprisingly ﬁnd far worstcase guarantees concerned algorithm outperforms orders magnitude For instance reach bound 3 given 24 agents number coalition structures need searched algorithm 00007 needed Sandholm et al 1999 1 05 needed Dang Jennings 2004 2 This despite fact algorithms advantage special properties games externalities 2012 Elsevier BV All rights reserved Corresponding author Email address trecssotonacuk T Rahwan 1 Both Talal Rahwan Tomasz Michalak principle authors paper 00043702 matter 2012 Elsevier BV All rights reserved httpdxdoiorg101016jartint201203007 96 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 1 Introduction The ability create effective coalitions key goals multiagent systems research Coalitional games models capture opportunities cooperation explicitly modeling ability agents joint actions primitives 3 In context key challenges generate coalition structure exhaustive disjoint division set agents performance entire optimized This Coalition Structure Generation CSG problem received attention multiagent literature 41526 cid3 To date work CSG problem AI community focused primarily class coalitional games known Characteristic Function Games CFGs effectiveness value coalition affected way nonmembers partitioned There settings assumption hold Such settings known Partition Function Games PFGs 7 Speciﬁcally PFGs coalitions value inﬂuenced formation coalition cid3 C1 C2 C3 value C1 For instance given coalition structures CS C1 C2 C3 CS merger C2 C3 Such effect known externality coalition formation different CS CS example induced C1 merge C2 C3 leads formation coalition C2 C32 Games externalities widely studied economics social sciences interdependencies coalitions play important role Examples include collusion oligopolies cooperating companies seek undermine competitive position ﬁrms market forms international macro economicenvironmental policy coordination countries 89 For instance hightech companies decide cooperate order develop new technology standard companies lose competitive position subject negative externalities For instance 1970s Japanese ﬁrms established Very Large Scale Integration VLSI consortium Fifth Generation Computer Systems FGCS project 10 Another example decision group countries reduce pollution positive impact countries regions induces positive externalities Finus 11 Yi 10 The issue externalities increasingly important domains multiagent techniques applied In ecommerce example British company Aerogistics3 enables small mediumsize aircraft component manufacturers service providers form online ad hoc supplychain coalitions bid manufacturing projects large individual participant Since components ultimately conform standards cost standarization procedures incurred coalition depends number structure winning coalitions In multiagent systems negative externalities coalition nonmembers caused sharing resources 121 Thus agents forming coalition consume resources means fewer resources available coalitions This case instance congestion games 13 Negative externalities caused conﬂicting goals Intuitively satisfying goals coalition actually world coalitions goals 14 Conversely overlapping partially overlapping goals cause positive externalities coalitions satisfy goals coalitions 1 In spite important applications little attention given computational aspects games externalities In particular exist algorithms literature solve CSG problem PFGs To end noted space possible solutions CSG problem CFGs PFGs O nn solutions n agents The main difference lies size input O 2n CFGs O nn PFGs This coalition input contains single value representing performance CFG case PFG case contains values possible partitions agents outside coalition Section 2 details This makes CSG problem signiﬁcantly challenging compared CFG case NPcomplete 1 In fact easily shown general case PFGs possible solve CSG problem examining possible coalition structure Intuitively examined arbitrarily better rest Against background focus important classes PFGs PFG coalitional games weakly positive externalities In class externalities nonnegative merge coalitions detrimental coalitions PFG coalitional games weakly negative externalities Here externalities nonpositive merge coalitions beneﬁcial coalitions system4 It stressed nearly examples coalitional games externalities listed belong class Speciﬁcally cartels environmental policy coordination countries multiagent systems partially overlapping goals games positive externalities That belong class PFG Conversely collusion oligopolies exogenous coalition formation emarket places multiagent systems shared resources andor conﬂicting goals belong PFG class 2 In remainder paper refer coalitional games simply games externalities coalition formation simply externalities 3 See wwwaerogisticscom details 4 Throughout paper refer weakly positive negative externalities simply positive negative externalities T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 97 PFG Our aim paper develop anytime techniques solve CSG problem PFG henceforth To end algorithm deemed anytime return solution point time noted PFG execution quality solution improves monotonically termination This particularly desirable multiagent context agents suﬃcient time run algorithm completion es pecially search space problem hand exponential size Moreover anytime makes algorithm robust failure execution stopped algorithm normally terminated provide agents solution better initial solution intermediate PFG To end major obstacles developing algorithms PFG algorithms testedevaluated This signiﬁcantly challenging compared case games externalities main challenges PFG The ﬁrst generate random input instances guaranteed satisfy positivenegative externality condition To end note general CFG case conditions considered generating input instances Thus characteristic function sampled distribution Uniform Normal ensure positive negative externalities On hand dealing PFG occur coalitions merge This means particular arbitrary coalition structures CS created CS series coalition merges value coalition involved CS merges smaller greater CS CS CS PFG cid3 cid3 cid3 The second challenge different input instances stored memory This particularly needed compare different algorithms settings As mentioned size partition function quickly prohibitive growing number agents For instance given 20 agents partition function consists 4 1014 values require 394 terabytes memory What desirable able store partition functions concisely Taking account main contributions follows We develop ﬁrst CSG algorithm PFG PFG IP The building blocks algorithm summarized follows We prove possible compute upper lower bounds values set disjoint coalitions These bounds identify unpromising coalition structures improve PFG PFG eﬃciency CSG algorithms ii We prove order establish worstcase guarantee solution quality PFG search certain set coalition structures PFG necessary iii We identify subsets coalition structures need searched certain order worstcase guarantee proven drop subset iv In general PFG case possible prune partition subset agents upper bound PFG partition lower lower bound partition subset Yet PFG pruning possible speciﬁc conditions Based result develop preprocessing technique prune unpromising coalition structures subsets need searched v In order search promising subsets extend depthﬁrst search algorithm Rahwan et al 6 applicable PFG PFG We provide equation generating random input instances prove resulting partition function guar We prove function consists O nn values anteed satisfy conditions PFG requires storing O 2n values memory This function standard benchmark evaluating poten tial CSG algorithms developed future PFG PFG PFG Since previous CSG algorithms games externalities benchmark algorithm stateoftheart algorithms games externalities present We ﬁnd far worstcase guarantees concerned algorithm outperforms algorithms orders magnitude For instance reach bound 3 given 24 agents number coalition structures need searched algorithm 00007 needed Sandholm et al 1 05 needed Dang Jennings 2 This despite fact algorithms advantage special properties games externalities The remainder paper organized follows In Section 2 introduce basic concepts related coalitional games externalities In Section 3 algorithms currently available solving coalition structure generation problem discuss relative advantages limitations In Section 4 Empirical evaluation provided Section 5 Section 6 concludes paper outlines CSG algorithm PFG future work Finally provide Appendix A summary main notations paper PFG 98 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 2 Preliminaries In section formally introduce notions coalitions coalition structures Section 21 games externalities Section 22 games externalities Section 23 Finally formalize CSG problem coalitional games provide list important notations paper Section 24 21 Coalitions coalition structures Throughout paper denote n number agents A a1 a2 set agents We assume nonempty subset A possible coalition denote C set coalitions More formally C C C A C cid6 This implies C 2n 1 Example 1 There 15 coalitions created A a1 a2 a3 a4 a1 a2 a3 a4 a1 a2 a1 a3 a1 a4 a2 a3 a2 a4 a3 a4 a1 a2 a3 a1 a2 a4 a1 a3 a4 a2 a3 a4 a1 a2 a3 a4 A formal deﬁnition coalition structure follows Deﬁnition 1 Coalition structure A coalition structure denoted CS C1 C2 CCS exhaustive partition A disjoint coalitions satisﬁes following conditions 1 CS Ci cid6 b i1 Ci A c j 1 CS cid6 j Ci C j cid2CS The set coalition structures denoted P A set coalition structures containing exactly s coalitions s The number possible coalition structures known nth Bell number given n agents denoted P A computed P A P A s 1 j s jn 1 cid3 n s1 cid6 cid7 s j cid4 cid4P A s cid4 cid4 1 s1cid5 j0 Example 2 In total 15 coalition structures created A a1 a2 a3 a45 cid9 cid8 cid8 cid8 cid8 cid8 a1a2a3a4 cid9 a1 a2a3a4 a1 a3a2a4 a1 a4a2a3 a1a2 a3a4 cid9 cid9 cid9 cid9 cid9 cid8 cid8 cid8 cid8 cid8 a1a2 a4a3 a1a2a3 a4 cid9 a1 a2 a3a4 a1 a2 a4a3 a1 a3 a4a2 cid9 cid9 cid8 cid8 cid8 cid8 cid8 cid9 cid9 cid9 cid9 a1a2 a3 a4 a1 a2a3 a4 a1 a3a2 a4 a1 a4a2 a3 cid9 a1 a2 a3 a4 Observe difference C P A grows exponentially number agents An example shown following table n C P A 1 1 1 3 7 5 5 31 52 7 127 877 9 511 21 147 11 2047 678 570 13 8195 27 644 437 15 32 783 1 382 958 545 22 Characteristic function games Conventionally coalitional games externalities modeled characteristic function takes input coalition C C outputs value vC R reﬂects performance coalition Formally v C R A tuple A v called Characteristic Function Game CFG It clear deﬁnition type game value coalition independent coalition As standard literature 126 assume vC cid2 0 C C 5 For notational convenience commas omitted coalitions risk confusion T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 99 Example 3 Let sample characteristic function A a1 a2 a3 a4 deﬁned follows cid10 a2 a4 cid10 a3 a4 cid10 a1 a2 a3 cid10 a1 a2 a4 a1 a3 a4 a2 a3 a4 a1 a2 a3 a4 cid10 a1 a2 cid10 a1 a3 cid10 a1 a4 cid10 a2 a3 cid10 a1 cid10 a2 cid10 a3 cid10 a4 1 2 2 1 3 4 1 5 6 4 cid11 cid11 6 8 cid11 5 5 v v v v v v v v v v v v cid11 cid11 cid11 cid11 cid11 cid11 cid11 cid11 7 v v v cid10 cid10 cid10 cid11 cid11 cid11 cid11 23 Partition function games In games externalities value coalition depends way agents partitioned A coalition C coalition structure CS called embedded coalition denoted C CS The set embedded coalitions set A denoted EC For embedded coalition C CS EC partition function w outputs value reﬂects performance C CS Formally w EC R cid8 cid9cid11 a1 a2 a3a4 Example 4 Let sample partition function A a1 a2 a3 a4 cid9cid11 1 a1a2a3a4 cid9cid11 1 a2 a3a1a4 cid9cid11 0 a2 a4a1a3 cid9cid11 05 a3 a4a1a2 cid9cid11 0 a1a2 a3 a4 cid9cid11 2 a1a2a3a4 cid9cid11 1 a3 a4a1a2 cid9cid11 2 a1 a3a2a4 cid9cid11 1 a1 a4a2a3 cid9cid11 0 a1 a3 a4a2 cid9cid11 2 a1a2a3a4 cid9cid11 1 a1 a2a3a4 cid9cid11 2 a1 a4a2a3 cid9cid11 1 a2 a4a1a3 cid9cid11 0 a1 a2 a4a3 cid9cid11 1 a1a2a3a4 cid9cid11 05 a2 a3a1a4 cid9cid11 05 a1 a3a2a4 cid9cid11 1 a1 a2a3a4 a4 a1 a2 a1 a2 a1 a3 a1 a3 a1 a4 a1 a4 a2 a3 a2 a3 a2 a4 a2 a4 a3 a4 a3 a4 a1 a2 a3 a1 a2 a4 a1 a3 a4 a2 a3 a4 a1 a2 a3 a4 a1 a1 a1 a1 a1 a2 a2 a2 a2 a2 a3 a3 a3 a3 a3 a4 a4 a4 a4 0 cid9cid11 a1 a2a3a4 cid9cid11 a1 a2a3 a4 cid9cid11 a1 a3a2a4 cid9cid11 a1 a3a2 a4 cid9cid11 a1 a4a2a3 cid9cid11 a1 a4a2 a3 cid9cid11 a2 a3a1a4 cid9cid11 a2 a3a1 a4 cid9cid11 a2 a4a1a3 cid9cid11 a2 a4a1 a3 cid9cid11 a3 a4a1a2 cid9cid11 a3 a4a1 a2 a1 a2 a3a4 a1 a2 a4a3 a1 a3 a4a2 a2 a3 a4a1 w w w w w w w w w w w w w w w w w w w w w w w w w w w w w w w w w w w w w cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid10 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 cid8 3 2 4 3 1 1 5 4 6 4 4 3 cid9cid11 cid9cid11 cid9cid11 cid9cid11 5 5 6 8 cid9cid11 a1 a2 a3 a4 7 A tuple A w called Partition Function Game PFG Whenever convenient use concise notation rep resent partition functions values coalitions embedded given coalition structure represented vector Formally given coalition structure CS C1 CCS values C1 CS CCS CS denoted wC1 CS wCCS CS Example 5 A shorthand notation partition function Example 4 Coalition structure a1a2a3a4 a1 a2a3a4 a1 a3a2a4 a1 a4a2a3 a1a2 a3a4 a1a2 a4a3 a1a2a3 a4 a1 a2a3 a4 Vector 1 2 2 1 3 1 1 4 2 05 1 1 2 1 5 05 0 6 1 05 1 4 2 3 Coalition structure a1 a3a2 a4 a1 a4a2 a3 a1 a2 a3a4 a1 a2 a4a3 a1 a3 a4a2 a1a2 a3 a4 a1 a2 a3 a4 Vector 3 4 1 4 5 0 5 0 6 0 0 8 7 The partition function takes account externality coalition formation By mean change value given coalition caused merge coexisting coalitions6 More formally 6 For discussion alternative notions externalities multiagents systems 15 comprehensive economic study externalities related issues 16 100 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 Deﬁnition 2 Externalities Let CS CS cid3 C CS C embedded coalition C CS C cid6 C cid3 P A coalition structures CS cid3 CS deﬁned cid3cid3 Then formation C cid3cid3 CS C cid3cid3 CS cid3 C cid3cid3 cid3 C cid3 C cid3 C cid3 cid2 3 exist C cid3 C cid3cid3 CS cid3 C cid3 imposes externality cid3cid3 CS cid3 cid2C CS CS cid3 wC CS wC CS cid3 Thus externality uniquely determined tuple C CS CS cid3 A set tuples game A w denoted T w Now formally deﬁne games positive externalities PFG games negative externalities PFG Deﬁnition 3 Game positive negative externalities We partition function game A w characterized positive negative externalities C CS CS cid3 T w following holds cid2C CS CS cid3 cid2 cid3 0 Example 6 The game deﬁned Example 4 negative externalities For example externalities affecting coalition a1 cid10 cid9cid11 cid8 cid8 a1a2 a3a4 w a1 a1a2a3a4 cid9cid11 cid9 cid8 cid9 a1a2a3a4 cid10 cid8 cid9cid11 a1a2 a4a4 cid8 cid9 a1a2a3 a4 cid2 cid2 cid2 cid2 cid2 cid2 cid8 cid8 cid8 a1 cid10 w cid10 a1 cid10 w cid10 a1 cid10 w cid10 a1 cid10 w cid10 a1 cid10 w cid10 a1 cid10 w a1a2 a3a4 a1 cid8 a1a2 a4a3 a1 cid8 a1a2 a3 a4 a1 cid8 a1a2 a3 a4 a1 cid8 a1a2 a3 a4 a1 cid8 a1a2 a3 a4 a1 cid8 cid8 cid8 cid9 cid9 cid9 a1a2 a3 a4 a1a2 a3 a4 a1a2a3a4 cid10 cid8 cid9cid11 w a1 a1a2a3a4 cid10 cid8 cid9cid11 cid8 cid8 cid8 cid9cid11 a1 w a1a2 a3a4 cid10 cid8 a1 w a1a2 a4a3 cid10 cid8 a1 w a1a2a3 a4 cid10 cid8 a1 w cid9cid11 cid9cid11 a1a2a3a4 cid9cid11 a1a2a3a4 cid9cid11 a1a2 a3a4 cid9cid11 a1a2 a4a3 cid9cid11 cid9cid11 cid9cid11 cid9cid11 0 1 05 cid9cid11 cid9cid11 cid9cid11 1 0 05 a1a2 a3 a4 a1a2a3 a4 It diﬃcult check externalities affecting coalitions game nonpositive Observe CFGs special case PFGs externality equals zero They special case PFG This means particular available algorithm designed games externalities PFG directly applied externalities Conversely algorithms proposed paper PFG directly applicable CFGs PFG 24 The CSG problem formalized The CSG problem ﬁnd optimal coalition structure CS P A formally deﬁned CFGs follows CS arg max CSP A cid5 CCS vC PFGs deﬁned follows CS arg max CSP A cid5 CCS wC CS a1 a3 a2 a4 This Example 7 Referring game externalities deﬁned Example 3 CS va1 a3 va2 a4 10 greater value coalition structure game As 8 game externalities deﬁned Example 4 CS greater value coalition structure game a1a2 a3 a4 wa1 CS wa2 a3 a4 CS T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 101 3 Related work In section brieﬂy discuss available CSG algorithms games externalities CFGs Broadly divided exact nonexact algorithms 6 Basically nonexact algorithms return good solutions relatively quickly scale increase number agents involved Shehory Kraus 4 Sen Dutta 5 However provide guarantees quality solutions Exact algorithms hand guaranteed ﬁnd optimal coalition structure In paper interested ﬁnding optimal coalition structure focus solely exact algorithms To end algorithms based main techniques Anytime optimization The basic idea generate initial solution guaranteed ﬁnite bound optimal After coalition structures examined improve solution bound quality optimal solution Sandholm et al 1 Dang Jennings 2 Rahwan et al 176 Although anytime CSG algorithms worst case end searching entire space run O nn time robust failure execution stopped algorithm normally terminated return solution better initial intermediate Dynamic Programming The basic idea dynamic programming break optimization problem sub problems solved recursively combine results solve original problem avoiding work recomputing answer time subproblem encountered Yeh 18 Rothkopf et al 19 Rahwan Jennings 20 The advantage dynamic programming algorithms compared anytime counterpart run O 3n time However disadvantage provide interim solution completion Recently number algorithms developed combine techniques Rahwan Jennings 21 Service Adams 2223 In algorithms focus settings coalition values given explicitly table 2n values However line research focuses solving CSG problem given concise representations Ohta et al 24 Rahwan et al 25 Ueda et al 26 However issue scope paper Next algorithms CFG literature use similar techniques later Section 4 construct PFG algorithm To end observe dynamic programming techniques applied PFGs This depend heavily CFG assumption coalition group disjoint coalitions value coalition structure containing This assumption makes possible reuse result different coalition structures In PFGs assumption hold externalities coalition structure different Against background anytime algorithms use dynamic programming techniques Such algorithms divided categories focus ﬁrst worstcase guarantee focus second solution quality The following subsections categories 31 Algorithms focus worstcase guarantees The main focus algorithm establish worstcase ratio bound β solution quality identify subset coalition structures P cid3 P A cid3 cid3 maxCSP A maxCSP cid3 CCS wC CS CCS wC CS cid3 β In algorithms focus dividing search space subsets identifying sequence subsets searched β guaranteed improve subset The ﬁrst anytime CSG algorithm developed Sandholm et al 1 Here space coalition structures P A represented coalition structure graph Every node represents coalition structure All nodes categorized n levels noted P A 1 P A n level P A s set coalition structures contain exactly s coalitions Every undirected edge connects coalition structures belonging consecutive levels P A s coalition structure level P A s merging exactly coalitions In words edge graph represents merger coalitions followed upwards split coalition followed downwards s1 created level P A s1 P A Fig 1 shows example coalition structure graph given 4 agents Sandholm et al 1 proved exists minimum set coalition structures searched order establish bound quality solution Speciﬁcally achieved searching ﬁrst levels coalition structure graph contain 2n1 coalition structures total result search ratio bound β n optimal If additional time available ﬁrst levels searched desirable improve bound search To end Sandholm et al proposed search remaining levels starting 102 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 Fig 1 The coalition structure graph 4 agents level P A n moving upwards They proved bound improves algorithm searches levels In assuming algorithm completed searching level P A s bound β cid12nhcid13 h cid12n s2cid13 2 The exception n h 1 mod h n s mod 2 case bound β cid15nhcid16 A different algorithm proposed Dang Jennings 2 This algorithm starts searching levels Sandholm et als algorithm After instead searching remaining levels Sandholm et al algorithm searches certain subsets remaining levels Speciﬁcally searches coalition structures coalition size cid15nd 1dcid16 d running cid12n 14cid13 2 Dang Jennings proved given value d algorithm establishes bound β 2d 1 As mentioned introduction algorithms identify coalition structures need searched order improve ratio bound They specify search process carried implicitly assumed simple bruteforce procedure applied 32 Algorithms focus solution quality Such algorithms focus searching space coalition structures quickly possible reducing worstcase ratio bound The stateoftheart algorithm category IP algorithm 17 This algorithm based novel representation search space divides coalition structures subspaces based sizes coalitions contain 27 In subspace represented integer partition n7 For example given 4 agents possible integer partitions 4 1 3 2 2 1 1 2 1 1 1 1 represents subspace containing coalition structures coalition sizes match parts integer partition For example 1 1 2 represents subspace coalition structures coalitions size 1 coalition size 2 The integer partition graph graph node represents integer partition edge connects cid3 I j cid17 j 21 Fig 2 integer partitions I I shows example 4 agents cid3 exist j I I cid3 In I I I value best solution P A What signiﬁcant representation subspace possible compute upper lower bounds value best solution To end let Maxs Avgs maximum average values coalitions size s respectively Also let In set integer partitions n P A I subspace corresponds integer partition I In Then I In possible compute upper bound I follows UB A UB A I value cid3 I best solution P A sI Avgs8 These bounds establish worstcase guarantees quality best solution far prune subspace potential contain solution better current best As remaining subspaces IP searches time value higher upper bound subspace case subspace longer needs searched Searching subspace eﬃcient process applies branchandbound techniques avoid examining solution For details IP algorithm 6 I computed follows LBI sI Maxs Similarly lower bound LB A cid3 7 Recall integer partition positive integer number consists set positive integers called parts add exactly 28 For presentation clarity use square brackets paper instead curly ones represent integer partitions 8 Interestingly Rahwan et al 17 proved lower bound actually average value solutions P A I T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 103 Fig 2 The integer partition graph subspaces represented different nodes 4 The IP algorithm In section CSG algorithm PFG PFG The IP comes fact algorithm based integer partition representation coalition structure space Section 3 details The remainder section composed ﬁve subsections introduce main building blocks IP Speciﬁ cally Section 41 possible compute upper lower bounds values coalitions sets disjoint coalitions In Section 42 prove exists certain set coalition structures searched order establish bound optimal solution In Section 43 present procedure identiﬁes subspaces coalition structures need searched order improve bound In Section 44 propose preprocessing procedure uses upper lower bounds subspaces prune unpromising ones Finally order search promis ing subspaces extend Section 45 breadthﬁrst search technique Rahwan et al 6 applicable PFG PFG 41 Computing upper lower bounds cid3 We deﬁne value coalition structure CS P A denoted W CS sum values coalitions CS CCS wC CS Moreover coalition C C denote C agents A belong W CS C C AC Furthermore deﬁne partition C set containing disjoint coalitions union equals C denote set partitions P C 9 While element partition P P C coalition risk confusion denote element small letter p notational convenience Finally coalition structure CS value partition P CS denoted W P CS deﬁned sum values coalitions partition W P CS cid3 pP wp CS Now following theorem PFG Theorem 1 Consider PFG following holds agents C denoted a1 aC setting Given coalition C C partition P P C coalition structure CS P cid10 W P C P cid11 cid3 cid2 W P CS cid3 cid2 W cid10 cid8 P a1 aC cid9 cid11 P Proof To simplify notation let CS CS cid6 CS Then given PFG cid3cid3 cid3 cid3 C P CS PFG CS cid6 CS cid10 cid11 W P CS cid3 cid3 cid2 W P CS cid3cid3 a1 aC P Also loss generality assume setting ﬁrst need prove 2 performing multiple steps involving merging Beginning CS possible reach CS coalitions In step coalitions P remain unchanged negative positive externalities values decrease increase As result inequality 2 holds Similarly beginning CS proved cid3cid3 cid2 following holds W P CS cid3 cid2 W P CS cid3cid3 cid3 Theorem 1 bounds value given partition C Speciﬁcally partition P P C upper bound UBP lower bound LBP computed PFG PFG setting follows C a1 aC 9 Note C A partition C coalition structure 104 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 cid10 UBP LBP cid10 LBP UBP cid11 cid11 cid10 cid10 w w cid5 pP cid5 pP cid11 p P C cid8 p P a1 aC cid9cid11 By assuming P C possible equations compute upper bound UBC lower bound LBC value coalition C Now let denote 2C power set C set subsets C Moreover let denote Ik set possible integer partitions number k N Then given coalition C C integer partition I I s s cid3 C deﬁne P C I set consisting possible P 2C sizes subsets P match parts I Consider following example Example 8 For C a1 a2 a3 a4 I 1 2 P a1a2a3a4 12 a1 a2 a3 a1 a2 a4 a1 a3 a4 a2 a1 a3 a2 a1 a4 a2 a3 a4 a3 a1 a2 a3 a1 a4 a3 a2 a4 a4 a1 a2 a4 a1 a3 a4 a2 a3 Now given Theorem 1 compute upper lower bounds denoted UBC I LBC I respectively values elements P C I follows C C s cid3 C I I s UBC I max P P C I UBP LBC I min P P C I LBP Observe P C I P a1a2a3a4 12 subset P C I IC For example P a1a2a3a4 112 subset P a1a2a3a4 42 Establishing worstcase bound Having computed upper lower bounds coalition partition values previous section identify minimum search required establish worstcase ratio bound β optimum In order use following general theorem Theorem 2 Let deﬁne X Y Z follows X set elements Y set containing subsets X Z set containing subsets X y Y partitioned subsets Z Furthermore let deﬁne ν V follows ν function ν X Y R 0 We νx y value x y νx y 0 y x y V function deﬁned y Y follows V y x y νx y We V y value y cid3 Then Y cid3 Y following holds cid5 z Z y cid3 Y cid3 z y cid3 xz cid10 ν x y cid11 cid3 max yY cid5 xz νx y 3 We max yY V y cid3 max yY cid21 ycid21Z max ycid3Y cid3 cid11 cid3 cid10 V y cid21 ycid21Z deﬁned follows cid21 ycid21Z cid2 Zcid3Z min Zcid3 yzzcid3Zcid3 zzcid3 cid4 cid4Z cid3 cid4 cid4 In words let deﬁne cid21 ycid21Z size y respect Z basically minimum number subsets Z partition subset For example Z contains following subsets x1 x2 x4 x1 x3 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 105 given y x1 x3 x4 cid21 ycid21Z 2 In case size y respect Z 2 Now subset Z appears maximum value subsets Y cid3 ratio bound best subset Y This bound equals biggest subset Y respect Z best subset Y cid3 Proof Let y That best subset Y y arg max yY V y Moreover let Z smallest partition y Z cid8 Z 1 z Z z cid9 Z cid19 Z y z z jcid6i Now Z cid11 cid10 V y partition y cid5 cid10 write V y cid10 cid5 cid11 cid11 x y ν x y cid4 cid4 cid20 cid20 y cid20 cid20Z cid4 cid4Z follows ν xz 1 This turn implies cid4 cid11 cid4 max Z cid4 cid4Z cid3 V y cid10 z xz Z cid10 ν x y cid11 cid5 xz Now Z cid21 y cid21Z cid21 y cid5 cid21Z cid3 max yY cid21 ycid21Z cid10 cid11 ﬁnd cid11 cid10 V y cid3 max yY cid21 ycid21Z max Z z ν x y xz Furthermore assuming 3 holds z Z y cid3 Y cid3 z y cid3 Now following holds z cid5 xz cid10 ν x y cid11 cid3 max yY cid5 xz νx y cid5 xz cid10 ν x y cid11 cid3 max yY Z cid5 xz νx y Then 5 6 ﬁnd z Z y cid3 Y cid3 z y cid3 cid10 ν x y cid11 cid3 cid2 cid5 xz cid10 ν x y cid11 cid5 xz Moreover know y cid3 Y cid3 z y cid3 cid5 x ycid3 cid10 ν x y cid11 cid3 cid2 cid5 cid10 ν x y cid11 cid3 Based 8 fact V y cid5 y cid3 Y cid3 z cid3 y cid10 cid11 cid3 cid2 V y xz xz cid3 cid3 cid10 cid3 ν x y x ycid3 νx y cid11 cid3 ﬁnd From 7 9 ﬁnd z Z y cid3 Y cid3 z y cid3 V cid10 cid11 cid3 y cid2 cid5 xz cid10 ν x y cid11 This turn implies y cid3 Y cid3 cid11 cid3 cid10 V y cid2 max Z z cid10 ν x y cid11 cid5 xz Finally 4 10 ﬁnd y cid3 Y cid3 cid11 cid10 V y cid3 max yY cid21 ycid21Z V cid10 cid11 cid3 y cid2 4 5 6 7 8 9 10 Having proved Theorem 2 proving main theorem establishing ratio bound β PFG PFG 106 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 I I In I cid3 2 Theorem 3 To establish bound β value coalition structure given PFG searched With search number coalition structures searched 2n1 bound β n On hand given I I n n 1 1 n 2 1 1 1 1 1 searched With search number PFG coalition structures searched 2n n 1 β cid15 n 2 setting subspace P A setting subspace P A cid16 Proof To establish bound maximum possible value coalition C observed coalition structure setting coalition structure C guaranteed maximum value C AC Based Given PFG subspaces P A I I In I cid3 2 searched contain 2n1 coalition structures To prove β n use Theorem 2 follows We consider X set coalitions That X C We consider Y set coalition structures Y cid3 size 1 2 That Y P A Y cid3 P A I I In I cid3 2 We consider Z C C C subset Y containing coalition structures Now subset Z appears maximum value coalition structures Y cid3 coalition structure Y cid3 implies β n cid21a1 ancid21Z n ratio bound β best coalition structure Y β max yY cid21 ycid21Z best This On hand given PFG setting coalition structure C guaranteed maximum value C a1 aC a1 aC C Based following subspaces searched P A I I n n 1 1 n 2 1 1 1 1 1 With search number searched coalition structures 2n n 1 possible coalition appears unique coalition structure singleton ones appear single coalition structure As PFG case use Theorem 2 prove β cid15 n 2 cid16 Here We consider X set coalitions We consider Y set coalition structures Y P A consider Y cid3 P A n P A n11 P A n211 P A 11 We consider Z C C C C C C C 1 subset Z contains single coalition combination singletons Note maximum possible value combination observed P A 11 Theorem 1 The implies best coalition structure Y cid3 ratio bound β best coalition structure Y possible subset Z appears maximum value Y cid3 This bound equals size biggest coalition structure respect Z Theorem 2 Importantly combination singletons belongs Z derived CS grouping coalition structures CS CS singletons coalition cid21CScid21Z cid21CS Based easily shown biggest coalition structures respect Z belonging P A 222 number agents In case max yY cid21 ycid21Z cid15 n cid3cid21Z 2221 number agents odd P A contains singleton CS CS cid16 cid2 cid3 cid3 cid3 2 Interestingly CFGs suﬃcient search ﬁrst second levels coalition structure graph order bound β 1 However possible bound β searching set coalition structures long I coalition appears set On hand given PFG I I In I cid3 2 n n 1 1 n 2 1 1 1 1 1 given PFG Theorem 3 setting necessary search P A I setting necessary search P A 43 Improving worstcase bound In section present procedure reducing ratio bound search This procedure based Theorem 2 X considered set coalitions Y considered set coalition structures basic idea select Y cid3 Z obtain initial bound β identiﬁed Theorem 3 After add certain elements Y cid3 Z drop bound β 1 repeat process drop β 2 Z desired bound obtained That ﬁrst select Y cid3 For presentation clarity ﬁrst discuss example procedure works present pseudo code procedure In particular example 10 agents positive externalities shown Fig 3 integers cid3 C C represent coalition sizes For instance C C C C 2 represented 2 Similarly C C 4 C cid3 3 represented 4 3 In cid3 C C Fig 3A Z initially contains possible subset X size 1 Y cid3 tures P A I I I 10 I cid3 2 Z contains integers 1 2 10 ﬁgure Y cid3 initially contains coalition struc contains integer T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 107 Fig 3 Example procedure reducing ratio bound algorithm search given 10 agents positive externalities The circles surround combination integers color partitions 10 contains exactly integers Since subset Z appears Y cid3 maximum value Theorem 1 best coalition structure Y cid3 ratio bound β best Y This bound equal size biggest subset Y respect Z Here biggest subset happens represented 1 1 a1 size 10 108 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 Fig 4 Example integer model ﬁnds subspaces searched order improve ratio bound Fig 3B Here add Z combination singletons Z contains 1 1 ﬁgure To ensure addition subset Z appears Y cid3 coalition structures correspond 8 1 1 Theorem 1 Importantly modiﬁcation Z reduces size biggest subset Y respect Z In particular computing size a1 respect Z drops 10 5 maximum value need add Y cid3 Fig 3C Here add Z combinations singletons combinations coalitions size coalition structures combinations appear maximum values ﬁgure As result additions Z Y cid3 2 We add Y cid3 elements added Z Y cid3 size biggest subset Y respect Z dropped 5 4 Fig 3D The key question stage following elements added Z Y cid3 order drop size biggest subset Y respect Z In example biggest subsets Y size 4 belong subspaces highlighted ﬁgure As seen trivial determine elements add Z Y cid3 We solve problem Integer Programming solver The basic idea represent problem boolean matrix row corresponds subspaces need dealt subspace containing subsets size respect Z equals β column corresponds unique combination added Z Fig 4 The value matrix given row r column c equals 1 adding Z combination corresponds column c drop size subspace corresponding row r Otherwise value 010 In Fig 4 example value row 2 column 4 4321 drops 4 3 adding Z combinations 1 This size subset P A coalitions size 2 size 1 What need ﬁnd set columns row value matrix equals 1 columns In Fig 4 example highlighted columns represent possible solution The process ﬁnding required set columns integer programming solver The integer formulation takes consideration column size subspace needs added Y cid3 cost vector Fig 4 For example adding Z combinations coalitions sizes 2 1 1 cost 1260 This need add P A contains 1260 coalition structures The integer solver ﬁnds feasible set columns cost minimal 6211 Y cid3 I I In I cid3 2 PFG Having presented detailed example procedure reducing ratio bound present pseudo code case search n11 P A procedure Algorithm 1 In initially search P A steps 1 5 This interpreted putting subspaces Y cid3 P A n211 P A putting Z subsets X appear maximum value subspace Z C C C Ccid3 Ccid3 C C Ccid3 It easily shown bound case β cid15 n 2 searched compute smallest partition I Z denoted partitionI steps 6 8 This partition simply groups singletons PFG case partitionI initialized cid3 C C 1 C cid3 1 PFG cid16 Theorem 2 After subspace P A I case pair singletons PFG Z C C C C C C 1 PFG 111 PFG cid3 C C n P A 10 The values equal 0 omitted matrix Fig 4 presentation clarity T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 109 Algorithm 1 Lowering ratio bound search 1 PFG 2 Search P A n P A n11 P A n211 P A 111 3 4 Search P A I I cid3 2 search P A n211 5 end 6 I In searchedP A 7 8 end 9 β cid15 n 2 r 1 c 1 10 I In searchedP A 11 initializepartitionI Algorithm 11 cid16 2 main loop I 0 r r 1 rowsr partitionI I cid3cid3 partitionI cid3 I cid3 cid17 I I cid3 cid17 I columnsc I cid3cid3 columns cid3cid3 c c 1 I 0 partitionI β end end end r 1 rows c 1 columns I cid3 I cid3cid3 rowsr I matrixrc 1 cid3 cid17 I cid3cid3 columnsc matrixrc 0 end end end c 1 columns subspacec P A PFG columnsccid17I subspacec P A columnsccid17I cid3 Incolumnsc I cid3 1 1 cid3 I cid3 I cid3 Incolumnsc I cid3 n columnsc end end c 1 columns searchedP A costc 0 subspacec 1 costc subspacec end end c 1 columns 1 c cid3 c 1 columns subspacec subspacec r 1 rows cid3 matrixrc matrixrc cid3 1 cid3 0 matrixrc 1 end end end end end λ integerSolvermatrix cost integer solver c 1 columns λc 1 Search subspacec end end I In searchedP A 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 I 0 cid3cid3 partitionI I cid3cid3 partitionI c 1 columns λc 1 I cid3 I partitionI 60 61 62 63 64 65 66 end 67 Search remaining coalition structures This drop β 2 1 cid3cid3 columnsc end end cid3cid3 I end cid3 cid17 I cid3 cid17 I I cid3 I 110 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 partitionI cid3 multiplicity1 I Algorithm 11 initilizepartitionI Algorithm 1 1 partitionI 2 I 1 partitionI 3 4 end 5 PFG cid3 1 1 I I 6 partitionI 7 8 cid3 1 1 I 9 k 1 cid12multiplicity1 I2cid13 10 partitionI 11 12 13 14 15 16 end partitionI partitionI partitionI partitionI 1 end I I cid3 cid3 end cid12multiplicity1 I2cid13 cid6 cid15multiplicity1 I2cid16 1 1 1 3 PFG partitionI 1 1 1 3 Algorithm 11 For example given I 1 1 1 3 partitionI As described earlier size biggest partitions determines ratio bound β PFG need drop size order improve bound This main loop steps 9 66 size bound β drops 1 iteration More speciﬁcally build matrix row corresponds biggest partitions steps 10 12 ii column corresponds combination reduces size partitions steps 13 17 iii matrix row r column c assigned value 1 combination column c reduces size partition row r assigned value 0 steps 19 27 An example matrix seen Fig 4 After column c store subspacec subspace needs searched needs added Y cid3 combination corresponding column c observed maximum value steps 28 34 For example given 10 agents given combination 3 4 subspace needs searched 1 1 1 3 4 PFG 3 3 4 PFG Theorem 1 An integer solver ﬁnd set columns row exists column value 1 This solver takes consideration cost column computed steps 35 41 In cost given column size corresponding subspace subspace searched case cost 0 The integer formulation follows Minimize columnscid5 c1 λc costc st r 1 rows columnscid5 λc matrixrc cid2 1 cid8 cid9 1 columns c c1 λc 0 1 An important point note different columns corresponding subspace For example given setting 10 agents column corresponding combination 5 1 corresponding 4 1 PFG require searching P A 541 Similarly columns corresponding 7 1 7 1 1 1 1 1 require searching P A 7111 This means pay cost adding combinations Z search subspace combination appears maximum value add combinations Z extra cost To account columns need combined More speciﬁcally given set columns I require searching P A combine column cδ I cδ c1 I c2 I follows For row r set 1 exists column ck 0 As matrixrcδ I j 0 In Fig 4 example columns 2 9 require I remaining columns c searching subspace P A 541 combine column column 9 setting matrix19 1 matrix29 1 marix39 1 setting matrixr2 0 row r Note cost columns remains unchanged Once integer solver ﬁnds required columns step 53 search subspace corresponds columns steps 54 58 Finally subspace P A searched update I partitionI consideration combinations observed maximum values steps 59 65 For example given partition2233 2 2 3 3 given searched subspace corresponds combination 2 2 interpreted adding 2 2 Z As result update partition2233 setting 2 2 3 3 1 set matrixrcδ I I matrixrck j cid6 1 set matrixrc j I I I 44 Preprocessing Before detailing preprocessing procedure ﬁrst discuss underlying theoretical background In particular main theoretical results build follows T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 111 Fig 5 The ﬁgure shows integer partitions 4 5 appear integer partition 6 Lemma 1 Given integer partition graph s GI s let GI ss partition contains s GI ss cid3 identical GI ss integers equal 1 s cid3 cid3 cid3 cid3 s Then remove s denote GI s node integer parts node GI ss cid3 cid3 An example shown Fig 5 What interesting removing 1 1 node GI 62 example integer partitions I 4 integer partitions ordered connected exactly way GI 4 This particular observation preprocessing algorithm later section Now main theorem Theorem 4 Consider PFG P pruned search space exists partition P PFG cid3 P C setting Then given coalition C C partition P P C coalition structure containing p cid3 P cid3 p P cid3 p UBP cid3 LBP p cid3 cid3 p P p prove coalition structure CS P exists coalition structure CS setting given partitions P P cid3 P C p cid3 P PFG cid3 p cid3 P cid3 Since P partition C CSP partition C In particular let P CSP course CS P P cid3 P In end different coalition structure denoted CS CS cid3 P cid3 cid3 cid10 cid11 cid3 cid10 cid3 cid11 cid3 cid10 cid11 cid3 cid3 p P p W CS W P CS W P CS W cid3 P Since p fact P P P performing multiple steps involving merging coalitions P CS negative positive externalities cid11 11 cid3 Based cid3 reached P P This turn implies CS CS performing merging steps involve coalitions P As result partitions coalition ﬁnd P P cid3 p coalition P P subset coalition P P reached CS W cid3 W P CS CS CS P cid10 cid3 cid3 cid3 cid3 cid3 V P CS cid3 V cid3 P CS On hand UBP cid3 LBP cid3 V P CS cid3 V cid3 P CS cid10 cid11 From 11 12 13 ﬁnd V CS cid3 V CS space cid2 12 13 cid3 This turn implies CS pruned search Proof Given PFG cid3 UBP cid3 LBP W CS cid3 W CS cid3 Now replacing P P case From Theorem 4 following lemma holds Lemma 2 Consider PFG partition G In I G pruned search space exists integer partition I setting Then given integer partition I I s s cid3 n subspace represented integer cid3 I s PFG I cid11 cid3 cid10 I J I cid3 I UBI cid3 LBI cid3 cid5 j J 112 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 I cid21I Add 1 element cid21I Algorithm 2 Prune subspaces based Lemma 2 1 cid21I 1 Initialization 2 s 2 n 3 4 5 6 cid21I cid21I getIntPartss2 7 8 I I cid17 1 end I cid21I PFG PFG I I cid3 cid21I I I cid3 cid21I I cid21I cid21II remove I cid21I cid3 UBI cid3 LBI cid3 cid3 I UBI cid3 LBI cid3 9 end 10 end 11 12 end 13 return cid21I The condition I I number parts I belonging consequent levels graph In case use notation I I 1 5 1 1 1 1 2 1 1 1 1 2 1 5 Lemma 2 implies number parts I smaller greater connected integer partition graph s series nodes cid3 I In Fig 5 example cid3 I I cid3 J I cid3 cid3I j J I cid3 cid3 We Lemmas 1 2 preprocessing algorithm prune subspaces Algo rithm 2 Basically algorithm tries ﬁnd integer partitions I 2 pruned Lemma 2 moves I 3 I 4 reaches In The way moves I s1 I s observation Lemma 1 More speciﬁcally algorithm adds 1 integer partition I s1 combines resulting integer partitions I s contain 1 To generate integer partitions s contain 1s use getIntPartss 2 This function implemented algorithm generates doublyrestricted11 integer partitions Parta algorithm 29 45 Searching subspace In section brieﬂy searching method IP algorithm revised PFG PFG case cid3 cid3 I follows UBI As mentioned earlier Section 3 IP algorithm computes I In upper lower bounds value best coalition structure P A sI Maxs LBI sI Avgs These bounds identify consequently prune unpromising subspaces As promising ones IP searches time value higher upper bound subspace case subspace longer needs searched The order algorithm searches subspaces based upper bounds starts highest upper bound secondhighest Searching subspace P A I I i1 i2 iI carried depthﬁrst search combined branchandbound Basically coalition size i1 denoted C1 algorithm ﬁnds coalitions size i2 overlap C1 coalition denoted C2 algorithm ﬁnds coalitions size i3 overlap C1 C2 This repeated reach coalitions size iI overlap C1 C2 CI1 For coalition denoted CI coalition structure CS C1 CI P A This process repeated way guaranteed coalition I structure P A I exactly To speed search IP applies branchandbound technique follows If denote CS best coalition structure far algorithm goes coalitions size ix overlap C1 C x1 checks following holds12 vC1 vC x1 Maxix MaxiI cid3 V cid11 cid10 CS If holds need coalitions size ix overlap C1 C x1 This coalition structure containing C1 C x1 possibly better CS The main difference PFG setting compared CFGs instead having value coalition C maximum value UBC minimum value LBC Section 41 details Based modify IP follows PFG We add preprocessing stage consists Algorithm 1 prune unpromising subspaces Algorithm 2 identify order remaining subspaces need searched 11 Unlike restricted integer partitions parts bounded maximum value doublyrestricted integer partitions consist parts bounded minimum value getIntPartss 2 sets minimum value 2 resulting integer partitions contain 1s 12 Here vC instead wC CS refer value C CS This IP deals CFGs coalition value regardless coalition structure belongs T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 113 We compute Maxs Avgs follows s cid3 n Maxs max UBC C A Cs Avgs avgC A Cs LBC The order search subspaces based anytime algorithm reducing ratio bound β search subspaces necessary drop current ratio bound While searching subspace P A I I i1 i2 iI going coalitions size ix overlap C1 C x1 check following holds UBC1C x1 computed Section 41 UBC1C x1 Maxix MaxiI V cid11 cid10 CS 5 Performance evaluation 14 In section propose equation generating random input instances evaluating CSG algorithms PFG PFG Section 51 This equation evaluating IP algorithm Section 52 51 Input generation In order evaluate IP algorithm need able generate random input instances PFG positive negative externalities occur coalitions merge This means particular created CS series coalition mergers value arbitrary coalition structures CS CS coalition involved mergers smaller greater CS CS Next provide equation generating random input instances prove resulting partition function guaranteed satisfy conditions PFG CS PFG PFG cid3 cid3 cid3 To end let assume loss generality agents coalition ordered ascendingly coalitions partition ordered ascendingly based smallest13 agent coalition Now let lai C location agent ai C la6 a2 a5 a6 a9 3 let lai P location coalition P contains ai la6 a1 a7 a3 a5 a6 a4 a9 2 With deﬁnitions place generate condition met At ﬁrst coalition C generate following non coalition values PFG j1 eC j eC After coalition structure negative random values v C eC eC1 eC2 eCC CS cid23 C set value C follows cid3C PFG wC CS v C cid5 ai C eClaiC cid6 1 lai CSC 1 C cid7 15 In v C represents value coalition C absence externalities remainder left hand 15 represents externality induced C CS Note externality smaller equal eC This comes fact ai C lai CSC cid2 1 implies cid6 cid5 ai C eClaiC cid7 1 lai CSC 1 C cid6 cid7 1 1 1 C eClaiC eClaiC cid5 ai C cid5 cid3 cid3 ai C cid3 eC Theorem 5 By setting value coalition Eq 15 obtain PFG PFG setting Proof Given partition P coalition p P let sp denote smallest agent p let sp P deﬁned follows sp P cid8 cid9 s p p P s p sp 16 In words sp P contains smallest agent coalition appears p P sa4 a9 cid3 P C p cid3 P cid3 p P p cid3 p prove a1 a7 a3 a5 a6 a4 a9 a1 a3 Next given coalition C given partitions P P following holds 13 For agents ai j A ai smaller j j 114 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 cid10 v C C P cid11 cid3 cid2 cid10 v C C P cid11 cid3 17 From 15 ﬁnd inequality 17 holds cid6 cid5 ai C eClaiC 1 lai P 1 C cid7 cid2 cid5 ai C eClaiC cid6 cid3 1 1 lai P C cid7 cid5 By removing eClai C ﬁnd cid6 cid6 1 lai P 1 C cid5 cid2 cid7 cid7 cid3 1 1 lai P C ai C cid5 ai C cid5 ai C lai P 1 C lai P cid3 cid5 ai C ai C lai P cid3 1 cid5 cid3 C ai C cid10 ai P l cid11 cid3 Then prove 17 holds suﬃcient prove cid10 ai P cid11 cid3 ai C lai P cid3 l To end agent ai C let pi p respectively Then prove 18 holds need prove number coalitions appear pi P smaller equal number cid3 This coalitions appear p proving In words need prove spi P cid3 sp cid3 coalitions contain ai P P cid3 P cid3 P 18 cid3 cid3 spi P s cid11 cid3 cid10 cid3 P p cid3 In order ﬁrst prove agents spi P belong sp P cid3 belong spi P To end note agents sp cid3 P cid3 After prove Every agent spi P appears different coalition P cid3 In words coalition P cid3 spi P Otherwise agents spi P appear coalition P subset coalition P contradicts following assumption p cid3 p cid3 subset pi comes fact ai pi p P p contains agent coalition cid3 cid3 cid3 P cid3 b spi smaller equal sp This p cid3 p cid3 P cid3 p P p ai p cid3 p From observations 16 ﬁnd agent spi P belongs sp agents sp Assume 6 cid3 What left cid3 belong spi P We following example cid3 P cid3 P cid8 cid9 P cid3 P a1 a8 a3 a4 a9 a5 a6 a7 cid8 a1 a8 a3 a9 a4 a5 a7 a6 cid9 In case p6 a5 a6 a7 p cid3 6 a6 As seen sp6 P a1 a3 sp cid3 6 P cid3 a1 a3 a4 a5 cid2 Importantly Eq 15 places assumptionsrestrictions v C eC In words sampled distribution Gaussian Uniform Also note coalition C coalition structure CS cid23 C total externality imposed C smaller equal eC This gives ability place upper bound externality For example order simulate setting coalitions value increase decrease 30 externalities simply set eC 03 v C Next analyze memory required store different input instances In particular resulting partition function consists O nn values prove requires storing O n2n values Theorem 6 An input instance generated Eq 15 stored memory maintaining O n2n values Proof From Eq 15 coalition C equation requires storing v C eC1 eC2 eCC14 Moreover C C C cid3 n 1 This means number values need stored coalition C C equal n The total number values n 2n cid2 14 Note need store eC computed simply summing values eC1 eC2 eCC T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 115 Fig 6 Given 24 agents ﬁgure shows ratio bound function number searched coalition structures log scale 52 Performance evaluation As mentioned earlier introduction establish progressively better ratio bounds PFG setting propose way dividing search space subspaces ii sequence subspaces searched bound improved subspace While algorithms exactly Sandholm et als 1 Dang Jenningss 2 designed CFGs applied PFG setting Nevertheless ﬁrst algorithm PFGs CFGs special case PFGs benchmark algorithms CFG setting Intuitively expect algorithm perform worse especially exploit special properties CFGs In CFG algorithms advantage assumption coalition value regardless coalition structure embedded Obviously advantage algorithm originally designed PFGs Given 24 agents Fig 6 illustrates log scale ratio bound function number coalition structures searched15 As seen given PFG setting algorithm signiﬁcantly faster existing CFG ones For example number coalition structures required algorithm establish ratio bound 3 0001 required Sandholm et al 1 1 required Dang Jennings 2 On hand given PFG setting algorithm requires searching coalition structures compared algorithms order establish 11 ﬁrst ratio bound Theorem 3 However establishes bound requires searching 4 10 space signiﬁcantly faster compared For example number coalition structures establish ratio bound 3 00007 05 compared Sandholm et als Dang Jenningss respectively The main reason gain steps deﬁned informed manner compared algorithms More speciﬁcally step Sandholm et als algorithm searches coalition structures certain size step Dang Jenningss algorithm searches coalition structures biggest coalition certain size Our results best steps drop bound By tailoring steps suite objective rapidly reduce bound manage outperform algorithms So far evaluated way IP divides search space sequence subspaces searched Next evaluate algorithms ability ﬁnd progressively better solutions test settings In context tested algorithm given different numbers agents ranging 10 2016 different types externalities positive negative different percentages externalities ranging 0 100 Here reporting result given x externality mean total externality affecting given coalition x value More speciﬁcally coalition C value eC sampled uniform distribution U 0 vC x100 different value distributions Speciﬁcally use following standard distributions CSG literature 306 Normal vC C Nμ σ 2 μ 1 σ 01 b Uniform vC C U b 0 b 1 C c NDCS vC Nμ σ 2 μ C σ 15 Similar patterns observed given different numbers agents 16 The results reported average 500 runs given n 10 11 12 300 runs given n 13 14 15 100 runs given n 16 20 116 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 Fig 7 Given negative externalities ﬁgure shows log scale total run time IP given different numbers agents Every combination represents different setting For example possible setting 18 agents positive externalities percentage externalities equal 10 Uniform distribution Hence given large number possible settings report results similar patterns observed remaining ones report certain result negative externalities implicitly means similar results observed positive externalities In experiments process calculating sequence subspaces took insigniﬁcant time space 1 second 15 kb memory aforementioned settings This process deals space integer partitions space coalition structures given 20 agents 627 integer partitions opposed 5 1013 coalition structures Furthermore process calculating sequence subspaces needs given number agents sequence stored different problem instances unlike process searching subspaces needs repeated problem instance Given negative externalities Fig 7 shows log scale total run time IP given different numbers agents time measured clock time milliseconds PC 8 Intel 267 GHz processors 12 GB RAM As seen growth rate runtime similar O 27n given NDCS distribution similar O 232n given Uniform Normal distributions This signiﬁcantly smaller O nn growth rate size search space This difference comes algorithms ability identify prune unpromising subspaces coalition structures Next test algorithm given different percentages externalities In particular Fig 8 shows change percentage affects total run time number expansions algorithm17 As expected direct correlation results The ﬁgure shows number expansions slightly PFG This effectiveness branchandbound technique directly reﬂected To better understand reason need analyze number expansions slightly PFG effect different externalities Eq 14 main equation branchandbound technique Intuitively sides equation increase PFG ratio sides different PFG resulting change effectiveness branchandbound In decrease PFG PFG PFG Eq 14 increases PFG term V CS terms Maxix term UBC1C x1 increases PFG unchanged PFG MaxiI increases PFG decreases PFG remain unchanged PFG decreases PFG x 0 case remains The means increase lefthand Eq 14 PFG turn implies number prunings greater PFG PFG greater decrease PFG This Next analyze solution quality bound quality improve run time Observe bound evaluated different evaluated earlier Fig 6 bound calculated based coalition values problem instance hand previous bound calculated based sequence subspaces independent coalition values 17 Recall subspace searched depthﬁrst search The number expansions total number nodes searched algorithm different subspaces T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 117 Fig 8 Given 20 agents ﬁgure shows total run time IP righthand given different percentages externalities lefthand total number expansions IP search tree 118 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 Fig 9 Given 20 agents negative externalities ﬁgure shows solution quality bound quality improve run time IP Fig 9 shows solution quality bound quality improve run time given 20 agents negative externalities18 In Xaxis ﬁgure corresponds percentage time elapsed 0 time algorithm starts 100 time terminates For percentage time t report following 18 Observer bound calculated information extracted problem instance hand unlike bound calculated earlier based sequence subspaces independent problem instance Thus different bound calculated earlier based sequence subspaces independent problem instance T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 119 Fig 10 Given negative externalities ﬁgure shows log scale percentages space searched IP agents given different numbers 120 IP T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 solution quality This computed ratio value best coalition structure time t value optimal coalition structure time 100 IP bound quality This computed ratio value best coalition structure maximum upper bound remaining subspaces searched pruned Theoretical bound β This computed shown Section 43 As seen solution quality exceeds 90 1 runtime given Normal Uniform distribu tions 10 given NDCS distribution Moreover bound quality signiﬁcantly better theoretical worstcase bound Finally given negative externalities Fig 10 shows log scale percentage space searched IP given different numbers agents This computed ratio number expansions algorithm total number expansions search space As seen algorithm searches extremely small fraction space 000001 given 20 agents Furthermore fraction gets consistently smaller number agents increases 6 Conclusions The Coalition Structure Generation CSG problem AI community studied exclusively context characteristic function games externalities allowed This despite fact realworld settings externalities exist need accounted Taking externalities consideration makes CSG problem signiﬁcantly challenging input size grows O 2n O nn PFG externalities weakly positive PFG Against background provide paper ﬁrst computational study CSG partition function games More speciﬁcally develop novel anytime algorithm solves CSG problem important classes games Our algorithm PFG capitalizes following theoretical results Firstly prove possible bound values group Secondly identify set coalition structures searched order establish coalitions PFG worstcase bound solution quality Thirdly prove traversing space possible solutions particular manner guaranteed improve worstcase bound Fourthly satisfying certain conditions possible prune parts search space weakly negative PFG PFG To test algorithm propose equation generating random input instances prove resulting We prove function consists partition function guaranteed satisfy conditions PFG O nn values requires storing O 2n values memory This function standard benchmark evaluating potential CSG algorithms developed future PFG PFG PFG Since previous CSG algorithms games externalities benchmark algorithm stateoftheart approaches games externalities present Surprisingly ﬁnd far worstcase guarantees concerned algorithm outperforms orders magnitude despite fact advantage special properties games externalities algorithm With paper laid foundations work CSG problem partition functions games In particular keen develop eﬃcient CSG algorithm classes PFGs considered paper Indeed building theoretical results ﬁrst attempt recently proposed Banerjee Landon 31 externalities inﬂuenced agents types However algorithms general classes devel oped Another interesting direction extend idea generating random instances PFGs O n2n space use idea building block developing concise representations classes PFGs Acknowledgements This article signiﬁcantly revised extended version 32 15 Speciﬁcally present paper comprehensive review CSG literature Moreover procedure reducing ratio bound brieﬂy described 32 provide pseudo code procedure detailed explanations extensive exam game classes ples We provide mathematical proof function generates random instances PFG discuss memory requirements Furthermore evaluation section substantially extended In particular analyze effect different amounts externalities runtime algorithm number expansions algorithm We solution quality worstcase guarantee improve runtime Finally analyze percentage space searched algorithm given different numbers agents different value distributions PFG Tomasz Michalak Michael Wooldridge acknowledge support EPSRC project Market Based Control Complex Computational Systems GRT1065701 Tomasz Michalak acknowledges support EPSRC project ALADDIN Autonomous Learning Agents Decentralised Data Information Systems project jointly funded BAE Systems EPSRC strategic partnership T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 121 Appendix A Summary Notation The set agents Agent A The number agents A A coalition Agents A belong C C AC The set coalitions A The set coalitions size s A coalition structure An optimal coalition structure The set coalition structures The set coalition structures size s level s coalition structure graph The set coalition structures coalition sizes match parts integer partition I The set partitions coalition C The set partitions C coalition sizes match parts integer partition I Partition P C Element partition P Coalition C embedded coalition structure CS The value C CS value embedded coalition C CS The value P CS The value coalition structure CS The value coalition C Upper bound value best CS P A I Upper bound values partitions P C I Upper bound value coalition C Upper bound value partition P Lower bound value best CS P A I Lower bound values partitions P C I Lower bound value coalition C Lower bound value partition P The set possible integer partition number k The integer partition graph k Level s integer partition graph k A ai n C C C Cs CS CS P A P A s P A I P C P C I P p C CS wC CS W P CS W CS vC UB A I UBC I UBC UBP LB A I LBC I LBC LBP Ik GIk GIk s References 1 TW Sandholm K Larson M Andersson O Shehory F Tohme Coalition structure generation worst case guarantees Artiﬁcial Intelligence AIJ 111 12 1999 209238 2 VD Dang NR Jennings Generating coalition structures ﬁnite bound optimal guarantees Proceedings Third International Joint Conference Autonomous Agents MultiAgent Systems AAMAS 2004 pp 564571 3 S Ieong Y Shoham Marginal contribution nets compact representation scheme coalitional games EC05 ACM 2006 pp 170179 4 O Shehory S Kraus Methods task allocation agent coalition formation Artiﬁcial Intelligence AIJ 101 12 1998 165200 5 S Sen P Dutta Searching optimal coalition structures Proceedings Sixth International Conference MultiAgent Systems ICMAS00 2000 pp 286292 6 T Rahwan SD Ramchurn A Giovannucci NR Jennings An anytime algorithm optimal coalition structure generation Journal Artiﬁcial Intelli gence Research JAIR 34 2009 521567 7 W Lucas R Thrall nPerson games partition function form Naval Research Logistics Quarterly X 1963 281298 8 E Catilina R Feinberg Market power incentives form research consortia Review Industrial Organization 28 2 2006 129144 9 J Plasmans J Engwerda B van Aarle GD Bartolomeo T Michalak Dynamic Modelling Monetary Fiscal Cooperation Among Nations Springer New York USA 2006 10 SS Yi Endogenous formation economic coalitions survey partition function approach The Endogenous Formation Economic Coalitions Edward Elgar London UK 2003 pp 80127 11 M Finus New developments coalition theory application case global pollution control Environmental Policy International Perspective Kluwer Academic Publishers Netherlands 2003 pp 1949 12 P Dunne Multiagent resource allocation presence externalities CEEMAS 2005 pp 408417 13 J Oh Multiagent social learning large repeated games PhD thesis School Computer Science Carnegie Mellon University 2009 14 JS Rosenschein G Zlotkin Rules Encounter Designing Conventions Automated Negotiation Computers MIT Press MA USA 1994 15 TP Michalak T Rahwan J Sroka A Dowell MJ Wooldridge PJ McBurney NR Jennings On representing coalitional games externalities J Chuang L Fortnow P Pu Eds ACM Conference Electronic Commerce ACMEC 2009 pp 1120 16 R Cornes T Sandler The Theory Externalities Public Goods Club Goods Cambridge University Press 1996 17 T Rahwan SD Ramchurn A Giovannucci VD Dang NR Jennings Anytime optimal coalition structure generation Proceedings Twenty Second Conference Artiﬁcial Intelligence AAAI 2007 pp 11841190 18 DY Yeh A dynamic programming approach complete set partitioning problem BIT Numerical Mathematics 26 4 1986 467474 19 MH Rothkopf A Pekec RM Harstad Computationally manageable combinatorial auctions Management Science 44 8 1995 11311147 122 T Rahwan et al Artiﬁcial Intelligence 186 2012 95122 20 T Rahwan NR Jennings An improved dynamic programming algorithm coalition structure generation Proceedings Seventh International Conference Autonomous Agents MultiAgent Systems AAMAS 2008 pp 14171420 21 T Rahwan NR Jennings Coalition structure generation dynamic programming meets anytime optimisation Proceedings Twenty Third Conference Artiﬁcial Intelligence AAAI 2008 pp 156161 22 TC Service JA Adams Approximate coalition structure generation Proceedings Twenty Fourth Conference Artiﬁcial Intelligence AAAI 2010 23 TC Service JA Adams Constant factor approximation algorithms coalition structure generation Autonomous Agents MultiAgent Sys tems 23 1 2011 117 24 N Ohta V Conitzer R Ichimura Y Sakurai A Iwasaki M Yokoo Coalition structure generation utilizing compact characteristic function representa tions IP Gent Ed CP09 Lecture Notes Computer Science vol 5732 Springer ISBN 9783642042430 2009 pp 623638 25 T Rahwan TP Michalak E Elkind P Faliszewski J Sroka M Wooldridge NR Jennings Constrained coalition formation Twenty Fifth AAAI Conference Artiﬁcial Intelligence AAAI 2011 pp 719725 26 S Ueda M Kitaki A Iwasaki M Yokoo Concise characteristic function representations coalitional games based agent types IJCAI11 Twenty Second International Joint Conference Artiﬁcial Intelligence 2011 pp 393399 27 T Rahwan SD Ramchurn VD Dang NR Jennings Nearoptimal anytime coalition structure generation Proceedings Twentieth International Joint Conference Artiﬁcial Intelligence IJCAI 2007 pp 23652371 28 SS Skiena The Algorithm Design Manual SpringerVerlag New York USA 1998 29 W Riha KR James Algorithm 29 eﬃcient algorithms doubly multiply restricted partitions Journal Computing 16 1974 163168 30 K Larson T Sandholm Anytime coalition structure generation average case study Journal Experimental Theoretical Artiﬁcial Intelli gence 12 1 2000 2342 31 B Banerjee K Landon Coalition structure generation multiagent systems mixed externalities Proceedings Ninth International Conference Autonomous Agents MultiAgent Systems AAMAS 2010 pp 175182 32 T Rahwan T Michalak NR Jennings M Wooldridge P McBurney Coalition structure generation multiagent systems positive negative externalities Proceedings Twenty First International Joint Conference Artiﬁcial Intelligence IJCAI Pasadena USA 2009