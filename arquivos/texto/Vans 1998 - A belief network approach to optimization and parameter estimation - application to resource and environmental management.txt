Artificial Intelligence 101 1998 135163 Artificial Intelligence A belief network approach optimization parameter estimation application resource environmental management Olli Varis Laborutor Water Resources Helsinki University Technolog lO Box 5300 FIN02015 HUT Helsinki Finland Received 11 January 1996 received revised form 23 June 1997 Abstract An approach constructed optimization use Bayesian belief networks resource environmental management A belief network deterministic model update conditional probabilities components model components parameter values information An iteration scheme developed posterior distributions information The scheme different optimization optimization policy options Also multiobjective optimization approach Elsevier Science BV All rights reserved presented illustration associated different model The divergence prior posterior probability distributions model structure force prior different sources tasks including parameter estimation possible The illustrated example costeffective management river water quality 0 1998 indication inconsistency equal This removes work parallel inconsistencies Keywords Bayesian methods Belief networks Environmental policies Hybrid models Parameter estimation Probabilistic models Optimization Resource management Water quality 1 Introduction Uncertainty ment Interest discussed probabilistic assessment topics environmental resource manage risk analysis related techniques grown Email ovarislekahutfi 0004370298S1900 0 1998 Elsevier Science BV All rights reserved PM SOOO437029800010l 136 0 Varis Articial Intelligence 101 1998 135163 1545 Probabilistic risk analyses increasingly countries Riskconscious recent years practical assessment work international typically rapidly cepted thorities precautionary theory recently developed computational uncertain field At present utilized ac national au principle endorsed numerous governments Modern decision processing applications far properly known fully techniques information provide wide base novel potential approaches organizations riskaverse approaches opportunities 843 1 acquisition grouped information The concept uncertainty facets context From decisiontheoretic presentation given systems fuzzy set theory In study Bayesian clusters available issues Pearl 2 preferences 19 divides computational view uncertainty propagation problem groups probabilistic ones Bayes DempsterShafer calculus unified approach estimation strong theoretical basis provide theories questions testing 3 structural logicbased statistical deterministic logic rulebased objectives monotonous known approaches techniques inference resource management restricted entire model construct dominated classical Bayesian space In decision Bayesian analysis uncertainty considering game theory 1930s 1940s 25 Games evolved uncontrolled nature abstractions Bayesian decision theoretical 81620 applications Bayesian analysis theory idea stem subjectivity sequential games trees developed 44 These late 1960s parameter subject applicable ones increasing notice emphasis concepts developed parameter estimation theory gradually gained decision 9 Within environmental Further development linked advances related computational mathemat impact intelligence rapidly growing approaches applicable potentially ics 22126 Artificial years A set probabilistic Bayesiantype applica ble decision analysis high uncertainty emerged 7192530 Characteristic techniquesknown Markov networks interdependencies lows construction operate interactively application areas including nition principle al realizable way theory medicine pattern recog belief networks causal networks Bayesian nets qualitative network presentation probabilistic variables The localupdating influence diagrams constraint networksis In recent years spread quickly large densely coupled networks online fault diagnosis practically reliability According Bobrow 3 particularly successful 1719 technique belief network present impact approach Pearl Pauker 30 stated Pearls formulation revolutionary AI As usual techniques Bayesian analysis parameter space cf 61827 probability evident violation Kolmogorov strongly argues subjected classical theory different sets outcomes allowed related nodes yielding Bayes formula Pearl 171 hypothesis spaceis In contrast It hard textbook axiomatization entire modelthe study Szolovits axiomatization Pearl wider practical 0 VarisArtijicial Intelligence 101 1998 135163 137 view probability interesting aspects Many decision analytic approaches ideas instance theory presents distorted view human reasoning misses line 42223 resource management 17191 offered suggestions making Varis 33 examined Pearls methodology environmen approach suitable decision analysis tal studies The suggested approach adapted ideas particularly Bayesian decision analysis common practices field The essential suggestion nodes linked layers 1 probabilities outcomes possible cal state values model variable node propagated belieffunction algebraic logi culus 2 outcomes linked deterministic cal This implies updating simulations Monte Carlo analysis useless This updating works instantly require offline simulation In present understood approximate numerical approach different parts model making probabilistic runs approach basic uncertainty network uncertainty propagation equations scheme Yet extensions developed applicability order provide l Direction specic link instead Milj Mjli Pearl uses pp 158159 continuation 19 Milj Mjli allowed l The link strength approach parameter define link matrix l Negative Node dependency level sum link strength parameters links variables negative links interconnection node define dependent node rest network The goal study formulate test use approach look inconsistencies deterministic model parameter estimation The basic conceptstemming network parallel modelis information observations prior posterior probabilities treatment iteration scheme developed management targets model fitted Inconsistencies indices shown diverging control variables parameters wastewater levels In addition certain properties links adjusted empirically An handle uncertainties cost optimization idea belief different parts external model outcomes levels environmental purpose concerned presentation listed propagation All categories uncertainty jectives preferences structure supported Uncertain discrete belieffunction calculus As far presentation ties objectives preferences use concepts utility information following manner network conditional assigned number possibilities metamodel ob propagated information analysis uncertain domain allows analysis valueof equations second dependency variables The approach provides 343639 probabilities This structure allows degree belief variables linked deterministic use models different modeling analysis Structural uncertainty twolayered model discrete probabilistic deterministic theory including riskattitude handled traditions The approach understood generalized discrete Kalman filter state equation uncertaintythe structural uncertainty deterministic model 138 0 Varis ArtiJicial Intelligence IO1 1998 135163 estimated Bayesian filtering approaches bidirectional propagation scheme influence diagrams 2223 previously 46 structural uncertainty property The approach illustrated series numerical examples case study continuum number water policy analysis river basin This work policy studies resource environmental management developing Bayesian approaches The methodology decision analysis included 133435394042 probabilistic lake water quality management change studies fisheries management 10311 The applications river basin management climatic techniques influence diagrams risk analysis 12373841 belief networks design global change knowledge observational engineering including 2 The uncertainty balance approach Assume solve complex control andor diagnosis problem high uncertainties The available A balanced view problem based information information comes diverse sources contradictory sources needed 21 Structure targets uncertainty balance dynamics organic pollution We construct model crucial elements problem term model slightly different meaning statistician deterministic modeler I try fuse merge concepts try include meanings term model The model instance set differential general relatively basis reasoning knowledge diverse uncertain reasonable compromise river tool We want use structure model uncertain We want balance different pieces information experience data goals All information In addition information dissolved oxygen simple management contradictory analytic external information framework equations oriented There observations goals targets possible external information model Technically layers communicate The deterministic state layer includes state equations layer numerical values model variables levels conditional probability distributions approach divides model layer oxygen layer consists network approximate river The probabilistic It called outcome equations constitute outcomes 22 Noninformative network implies balance How use belief networks assist parameter estimation generally optimizing prior posterior probability control variables fulfill targets defined The key proposition distributions target variables observations 0 Varis Artial Intelligence 101 1998 135163 139 goals constraints management distributions external modeled distributions distributions value analogy priors posteriors assures error minimization iteration equal This information presented prior distributions implies joint equal posterior probability variables appearing prior information priors converge stepwise properly utilized This optimal values This procedure error shown difference The belief network constructed external model prediction noninformative distributions model external uniform distributions tells information discrete probability information agrees fully model information diverging network layer consists uniform available provided distributions If probabilistic 23 New information links induces need reestablish balance control variables Introduce new piece external probabilistic information targets Its probability distribution analysis outcomes corresponding model component general probability values different approximated discrete distribution The probabilistic layer propagate model model information match completely A controversy exists needs new information uniform distribution indicate Evidently distributions external analyzed proper balance deviating decisioncontrol This adjusting variables They treatment plants control water river target In set targets costs targets parameters fit model data match targets wastewater river upgraded quality involved balanced situation typically contradictory purification levels improve According information external layer posterior distributions information This achieved changing calculated probabilistic joint distributions proposition previous section balance forcing distributions equal uniform This implies modeled goal attained The form outcomes control variables consideration posterior distribution gives clear indication distributions achieve balance parameters controlled Another set components If instance link strength terms describing strongly variables interlinked including deterministic model equation 1 assume equation If link strength 0 assume describing link strengths clearly equation influence calculated state layer The lower link strength error bounds expected behavior The reason tells phenomenon Moreover defined mathematically section corresponding model uncertainty 100 adequate phenomenon probabilities 140 0 Varis Artificial Intelligence 101 1998 135163 DecisionControl variables Control adjust model meet targets Other model components Propagate information iterate noninformative Fig I Outline uncertainty balance iteration link strengths enable account model structural uncertainty 24 Iteration balance propagated achieve situation external information variables The search We want probabilistic distributions Fig 1 An intrinsic component analysis benefit analyses interaction information available Therefore interactive possible operated online joint probability control variables distributions equal uncertainty balance prior iteration analyst herhimself approach designed nontrivial problems comes learning 3 Computational solution 31 Propagation state layer outcome layer deterministic state equations usually If deterministic uncertainty propagation approaches series expansion The accuracy consider firstorder approximation cases sufficiently For equations deviations xl variance y state equations nonlinear practice analytical laborious Yet approximate 11151 One widely ones Taylor terms included We accurate output y nominal value caused firstorder approximation x nominal values deviations required expressing vary M evarxi il 2 1 1 2 0 Varis Artijicial Intelligence 101 1998 135163 141 There specific cases practical equations uncertainty y derived weighted sums components components In case weighted sums expected value products powers 2 3 4 5 6 7 n YC il UiXi mean variance obtained n il dYl 2Uf Valxil 22 il il jil 2 UiUjCOVXi Xj Accordingly product power equations n I 4 II il mean variance UYI n wilai il vary X 2 varlxi il 2 y I The variance equation processed variation cv cv2y 22 v2xJ convenient form coefficient 8 assumed model structurally Above need case As shown later uncertainty estimate given model structure expressed link strength I parameter defining link matrix probabilistic state layer following approximate manner layer Details given Section 33 The link strength augmented correct In present approach cvy 25 NY1 fi coefficient cvy uncertainty included variation In cvy excluded model prediction structural 142 0 Vs Artijcial Intelligence 101 1998 135163 32 Information state layer probabilistic layer The normally distribution n equally distributions information level differing reveal net A practical probabilistic distribution This feature layer shown later distributed model prediction likely uniform Fig 2 approximated discrete network measured target measurement If external information intervals Hence model prediction included nonuniform distributions rationale layer vector product discrete uniform distributions uniform distributions important propagating information uniform probabilistic state layer uses continuous Since discrete form discrete approximations taking priors probabilistic First define y1 v2 distributions continuous probabilistic random variables needed layer layer The following approximation P4 6 y1 l3 Py1 y y2 l3 Py y2 l3 These values obtained standard normal deviates Yl PY 043075 y2 _Luv 043070 10 11 In words model prediction equally discrete approximation intervals obtained approximated discrete distribution likely intervals Also number These values evidence vector e This Pel Pe u Pe2 PVI e 21 Pa Pe y2 These values evidence vector probabilistic layer 33 Propagation probabilistic layer belief network The belief network approach propagation information layer based Pearls work 191 set extensions Eqs 14 2 1 adopted Pearl Introduction probabilistic In precise 12 The probabilistic layer belief network consists nodes connected links Nodes Each node network contains l A vector possible discrete outcomes state values yi defined inputs depend outcomes nodes 0 Varis Artijcial Intelligence 101 1998 135163 143 State layer 3 Equally likely intervals Probabilistic layer 1 0 12 3 4 5 6 0 12 3 4 5 6 y 22 22y20 y28 _ Fig 2 Discrete approximation observation l An evidence vector ei probabilities present study number outcomes information data targets model el ek assigned In The evidence vector transmits external k outcomes l A posterior probability distribution Beli The prior probabilities parts network yielding assigned outcomes updated information posterior probability distribution linked link uncertainty It defined link matrix Milj Links A probabilistic conditional probability given j In simplest case unidirectional link matrix equals Markov chain state transition matrix information variables transfers node j denoting chain link layer parallel distribution deterministic preserve probabilistic uncertainty j Since structural distribution increased correspondingly strength link single parameter matrix element separately The following approach fulfills moment requirements It instead inserting values stated equations describes variance skewness kurtosis structural uncertainty It practical expected value moments The link strength parameter k x k link matrix Mjli denoted ojli constructed 11 j q qjli E I function vii A symmetric input qo qrl k 17 CO qkr rlk II rOqr pzOqkr 1W 13b The sum absolute values link strength parameters links node allowed certifies evidence leaving links entering node This twice network The sum absolute values exceed 1 The applies counted 144 0 Vans Artcial Intelligence 101 1998 135163 link strengths network For completely ones 1 node indicates nodes level dependency nodes independent variables 0 completely dependent Two Network propagation called n h computed The updated belief obtained convolution product messages prior belief This approach update messages direction propagation directions symmetric cases propagation changed Computationally likelihood messages independent When propagating n messages messages coming node j leaving node denoted ni For node denoted pjli messages node j node j preconditioned piii MjliXi The likelihood vectors pjli xi consist following elements 14 15 For elements Y ny message message xi _ evidence e scaled vector product joint distribution r r nili ejJqj 16 LI scaling constant scaling incoming message rrlri_r nodes 1 predecessors sum k vector elements xi unity The joint distribution messages piit pili_1 I nillil il lI dk kl 17 Starting node 110 1 nt et pzp 1 M211nl reverse The direction messages coming node j denoted Aj For node preconditioned similar All leaving node j j node node j denoted Zitj messages h messages The rest computationally Zij A41 jkj The 1j message joint distribution message ijljtn evidence ej AS 51 jn BejAr jln 18 19 B scaling constant The incoming message Xjljtn messages t0 Zjln nodes IZ j successors Zjljl n ljn n klj kjl convolution 20 0 Varis Artificial Intelligence 101 1998 135163 145 For node j posterior belief distributions Belj calculated basis prior distribution node vectors Kjltjt ej updating information Ijljt respectively subnetwork y scaling constant The equation written vector product likelihood messages evidence vector BeIj ynjlljt l ej l ljljl 21b 34 Information probabilistic layer state layer In approach proposed different paths information probabilistic layer state layer l The link strength parameter l The deviations prior posterior distributions r involved propagation uncertainty 9 important diagnostic fulfill given model targets information model distributions In parameter estimation posteriors iterated adjustment uniform The suggested quadraticlinear based comparison probabilities different outcomes control variable They iterated equal iteration scheme 22 providing rapid convergence Pr Wi CVi Beli Bel 1 Beli Bel 1 VTQi bBel lk 224 22b b convergence parameters Bel posterior probability outcome r k number outcomes pi mean prior distribution node control link strength refers updated iteration value This variable vi estimated iteration scheme experimentally parametric approaches rtest based iteration markedly rapid practical 4 Numerical examples 4 I Twodirectional propagation uncertainly The uncertainty twodirectional scheme belief networks following example simplicity state layer The example comes fish stock assessment restrictions Extensive data collection question high costs indirect data typically This type data tends corrupted types biases Decisions allowable catches needed regularly typically annual basis impose proper fisheries illustrated needed nature The simplest possible model includes mutually dependent variables fish stock fish catch fishing unit fishing night Fig 3 This dependency variables There ways obtaining usually assessment 146 0 VarisArtijicial Intelligence 101 1998 135163 Fish Stock Fish Catch o 0 Link Node 0 Fig 3 Structure example model In general links twodirectional independent number returned taxation relation increase records professional information Here fish stock assessment based catch estimates taggings catch assessment stock estimates fishermen enterprises The outcomes variables level 30 previous year 30 decrease unchanged A methodologically interesting fish stock understood consideration Assessment resource management feedback fish catch fish stock question arises fact scale cause fish catch effect cause effect vice versa clearly strength environmental task In longer time frame years The following notation e stock information taggings ech taxation records n likelihood message fish stock fish catch h fish catch fish stock M link matrix equal directions u I scaling parameters Now obtain variables Bek posteriors elements returned Bel r WKJC P stock 1 e P stockJJ khr B4akh Pcatch 1 eitock f3Pcatchn hn The messages n JC Mtock 1 Mecatch Examine propagation The link matrix given estO 0103 06T implying information b Assume scheme numerical cases Fig 4 information returned taggings stock likely grow instead stock exists catch Now eh 08015 005T c All information simultaneously available This controversial informa tion forces belief vectors close noninformative ones d The evidence vectors support This results higher belief increasing suggest stocks catches evidence vectors 42 Twolayered model including deterministic dependencies Let elaborate equations practice convention known example variables Such highly aggregated demonstrate transparency requirements phenomenon equations resource constraints concern certainty The use deterministic 0 VarisArtzl Intelligence 101 1998 1351153 147 b FISH STOCK y e 30 01 Same 03 30 06 Bel h 01 033 03 033 06 033 e y Bel h 30 033 061 061 Same 033 022 022 30 033 016 016 c y e Bel h 30 01 027 061 022 Same 03 30 06 043 016 03 M 073 013 013 013 073 013 013 013 073 d e y Bel h 30 01 007 025 Same 03 025 031 30 06 069 043 M 073 013 013 I 013 073 013 013 013 073 FISH CATCH Bel e y Bel e y Bel e y Fig 4 Propagation fish stock information mutually supporting d information posteriors fish catch vice versa b impacts controversial c structural causal uncertainty following manner involved model modeled belief network Instead outcomes yi 30 Same 30 use numerical quantities catch ways One standards 70000 100000 130000T The stock assessment given following stock equation Ystock Ycatch mF F 1 ePmPF rates F fishing mortality rate m natural mortality rate Use example F 03 m 01 Using stock equation YstoCk 283 000404 000 526000T Taking evidence vectors link matrix Fig 4a resulting model shown case illustration F 05 m 02 Fig 5c rate parameter values changed ycatch 10000 20000 30000 imply weaker dependency Fig 5d link matrix changed variables eh 08015 005T Fig 5a For Fig 5b shows 43 Parameter estimation uncertainty balance This example contains state probabilistic layers decision variables parameters To define state layer consider targets observations following linear model yit ay 123 148 0 Varis Artcial Intelligence 101 1998 135163 y FISH STOCK h Bel e FISH CATCH Bel e W Y e 1946711011 Bel h 278 101 03 03 033 361531 06 06 033 iill fzJq pzJq c y e Bel h liiI_i pzJq 4 Y e Bel h M 047 027 027 e Bel Bel e Y 70000 100 000 130000 Y 70000 100000 130000 Y 10000 20000 30000 Y 10000 20000 30000 Fig 5 Twolayered propagation layer examples Figures italics outcome layer figures probabilistic Node 2 Estimated link Node eNode 3 iziiide Fig 6 Structure example model yi model prediction observed variable eT point parameter expected value All variables normally distributed The tasks estimate link strengths parameter estimate models structural uncertainty These estimates based observations structure model Microsoft Excel code given Fig 7 et ez Fig 6 presents No external numerical step model probabilistic principle Therefore changes information example In following propagation estimation procedure scheme calculated present observations As includes layer takes form shown Fig 8 Due discrete approximation illustrated stepwise In state layer Fig 2 distributions uniform external information introduced parameters initial states introduce changes 5 2 C z 3 2 C 5 1 E 3 1 C T L U M M 5 2 C 3 2 C 5 l E 3 l C T L U M M 4 1 C 4 l C I R C Z 1 2 1 I E 3 e d o N 2 D 1 4 B 3 D 6 C D 2 e d o N I e B I 5 2 C 3 2 C 5 1 E 3 l C T L U M M l l l E O 1 E 0 1 C 9 E 9 C 2 c 1 4 B I 3 c Q 9 E 9 C C 1 e d o N 3 Y I l 4 B T R Q S G C _ v c 1 z B 9 B M U S 9 8 5 2 e 3 0 C 0 e 6 C 5 C 3 C Z C c s d o t s l m o n 3 3 3 O s C F I l l l l t E 1 C O E O C 9 E Q C l l O E O 1 C l l B 9 B M U S b C 1 B G G 5 C 2 C c s d o t s m r o n 3 3 3 0 5 C F I I I E l l l t C O E O 1 C t 9 E S C l l E l l C 4 J C l 3 C 1 l B W M U S l 1 8 4 1 8 6 6 6 0 3 3 3 2 3 1 C I G C 5 C 3 C Z C c s s m r o n 3 3 3 0 b C F l X 1 h t g n e r t s _ k m l _ d e t r e t M M x I r t m k n L 1 e d o N 1 8 9 1 1 0 4 3 1 4 1 150 0 Varis Artijicial Intelligence IO1 1998 135163 I Fig 8 The model external information Fig 9 Propagation propagated observation n eT A discrete approximation evidence vector el probabilistic influence probability distributions layer Changes link strength values change values link matrices included When adding observation nodesay outcomes discrete approximation node 1 continuous distribution observation e approximated discrete network Fig 9 Note posterior coming node 1 Eqs lo 12 The information Bels equal n messages information et included One observation examplethe distribution having model output distribution n message propagated distributions h The nonuniform available estimation model distributions information including Bel4 This feature later parameter imply More observation approximation distribution ez information Now add observation node 3 Fig 10 A discrete propagated 0 VarhArtijicial Intelligence 101 1998 135163 151 Fig IO Propagation propagated observation e A discrete approximation evidence vector e3 ia Fig I I Propagation propagated observation CT A discrete approximation T direction node I evidence vector ez h direction node 3 network Correspondingly add observation node 2 Fig 11 Note Bels longer equal 7t k messages scaled vector product The posterior parameter Be14 updated This step estimates Parameter estimation 1 value parameter 2 link strengths nodes 1 2 nodes 2 3 Fig 12 The principle applied optimization tasks shown river example later The idea obtain values parameter link strength Be14 uniform Fig 13 gives set examples possible distributions Bel4 inference basis distributions Note parameter value link strength value observed value changed values evidence vectors changed outcome distributions probability change 152 Y Choi 81 Qal 1 25 03 I 0 Varis Artijkial Intelligence IO1 1998 135163 Observation e cka I 22 03 1 63 ch 1 03 I I Fig 12 The model iteration Be14 uniform distribution 0 02 04 a6 Q6 1 Eparameter Link strength low high high high low high OK OK OK low high OK Fig 13 Some example posterior distributions parameter distributions Be14 inference based types 5 A river quality management case 51 The management problem watershed problem It represents treatment plants classical This example deals costeffective upgrading wastewater river 32 Priorization problems character particular government agencies countries short capital The study including watershed basis ambient water quality criteria basin management funding organizations example generated context comprehensive Europe 29 They midst rapid socialist countries including water quality profound management low At present change past water quality data limited validity pressing need improving water pollution transition process affecting sectors societies ambient effluent monitoring integration undergoing industry considerable priorization Previously 0 Varis Artificial Intelligence 101 1998 135163 153 control The scarcity capital suggests treatment costeffective basis 28 A detailed documentation given policy gradual upgrading wastewater study 34 improve A hypothetical watershed municipal wastewater river water quality Each plant discharges tributary The impact different ambient water quality criteria diverse levels studied precepts costeffective prioritization upgrading ranging 2934 Initially upgraded different investment levels plants A variety treatment treatment plants level 1 available 1 advanced solutions treatment plants effluent level 0 chemical alternatives treatment 52 A probabilistic river model Based results comprehensive water quality management study Nitra 14291 extended StreeterPhelps model state variables River Basin Slovakia chosen study The state variables dissolved oxygen DO biological oxygen steadystate BOD ammonium demand evolution river water quality NH4 The state equations dBOD dt dNH4 dt ktBOD NH4 dD0 dt klBOD k2NH4 k3DO DO estimated k3 reaeration r water travel time DOs saturation ki rate parameters oxygenation equations layer The probabilistic Fig 14a State variables Evidential states obtained analytically information layer rate The unit state equations solvable analytical solutions based network corresponding parameters represented field measurements DO water k2 NH4 mass time These state river topology belief network nodes concentration BOD oxygenation kl divided approach The analysis subsequent phases uncertainty iteration balance Table 1 targets decision variables Figs 14b 14c First parameter estimation mean values state layer iterated equal posteriors The link strengths links link strengths different The model layers estimated performed including Table 1 Definition decision control variables targets diagnostic policy analysis parts study Diagnosis Policy model Decision variables Parameters Dischargers Targets Observed water quality Water quality targets Target costs 154 0 Varis ArtiiaE Intelligence 101 1998 135163 Link 0 Total costs fficient purification level Estimated link Noninformative link Other link Dewsian node Other node 9 y9 Unitcosts _ _ _ _ 0 Total costs Efficient purification level __ Noninformative link Other link Decision node Geffective purification level NH4 BOD DO NH4 Fig 14 Probabilistic b diagnostic phase observations targets model parameters control variables c policy analysis phase water quality criteria total costs targets purification layer river model configuration levels control variables 0 Varis Artificial Intelligence 101 1998 135163 155 shown Fig 14b estimated equations values structural uncertainties state taking The second phase consists finding river water targets river quality management costs involved Now different instead parameters previous phase link strengths estimated water quality targets target cost level targets versus observations previous phase costeffective water quality levels decision variables account treatment solutions The definition variables changed course analysis directional uncertainty propagation scheme At diagnostic phase downstream upstream n h respectively messages In policy analysis phase h message going upstream diagnosis data model meet balance propagation directions predictions In policy analysis phase targets influence treatment plants downstream point target set When detecting model prediction distributions similar parameter estimation target propagated upstream way posterior levels This provides basis iteration treatment plant purification This deviation message iterated induced 53 Model versus data illustration approach The model calibration propagation evidential hypothetical data shown Fig 15 Take example model equations observations information 15 1 NH4 I 1 2 3 4 5 6 7 8 9 10 Fig 15 The nominal case Calibrated stand observations link strengths 083 BOD 087 DO 081 NH4 The dots solid line calculated level 90 confidence intervals shown 156 0 Varis Artial Intelligence 101 1998 135163 12 3 4 5 6 7 6 9 10 12345678910 __ I 12 3 4 5 6 7 8 9 IO 12345678910 12 3 4 5 6 7 8 9 l0 12345678910 30 20 10 0 I 100 60 60 40 20 0 12 3 4 5 6 7 8 9 10 12345678910 wtcome layer tToDatxIIstlc layer Fig 16 Propagation posterior distributions observed Bels model prediction different points probabilistic information layer The columns right correspondence task In case B observation available probability distribution In case A observations information BOD Fig 16 We want know model modeling want good possible The reference consists modelsystem probabilistic case observations layer consists uniform distributions success modeling discretized according evidence vector information Case C includes observation discretized Case D includes series observations scaled vector product Bels based iteration joint distribution uniform distribution The differences column heights right hand figures misfit model data The better model fit lower structural uncertainty Eqs lo 12 Fig 2 This vector net Fig 16 fed net In cases B C D parameter estimation proposed procedure propagated 0 Vans Artificial Intelligence 101 1998 135163 157 model We demonstrate influence prior uncertainties Table 2 Fig 17 The data low uncertainty uncertainties poor In case case A link strengths model high prediction highly uncertain uncertainty uncertain link strengths high prediction low uncertainty uncertainty high uncertainty If data high remains mode fit good case C If data high model fit good link strengths high prediction fit poor link strengths high prediction case B If data low uncertainty low structural uncertainty fit posterior model fit case D The issue complex model state equation case river model Here state equations interlinked BOD NH4 equations estimated turn Success BOD NH4 concentrations strongly depends success BOD prediction parameters DO equation predicting happen river However Table 2 Different Fig 17 typical combinations prior information influence posterior information cf Case Priors Posteriors Edata versm Uncertaintydata Link strengths Uncertainty Emodel prediction Model prediction A B C D low accordance low accordance high accordance high accordance low high low high low high high high high high low high A cv 028 Links 036 B cv 042 Links 068 C cv 028 Links 081 D cv 042 Links 086 Fig 17 Example BOD equation The influence uncertainties uncertainties posterior cf Table 2 information controversies prior information 158 0 Varis Artijicial Intelligence 101 1998 135163 uncertainties BOD NH4 data higher accuracy variability different substances uncertainties data analytical conditions propagated highly uncertain case model structure longer efficient model configuration considered instance empirical model based strongly highquality empirical evidence DO nature Under BOD NH4 predictions high state layer DO prediction In Fig 18 This occurs despite good empirical evidence state equations Often different These values reasons prefixed set parameter values standard fashion use literature values considered In case link strength adequate lower empirical parameter values equal Accordingly pay price standard parameter values conditions higher uncertainty empirical parameters prediction occurs target economic At policy analysis phase analysis follows outline The largest difference example link strengths estimated phase An interesting level set high compared ambient phenomenon water quality looseness targets set lower ambient targets higher single solution set beginning upgrading wastewater targets The approach single solution provide support model exampleto treatment plantsthe To meet objectives targets Either economic prioritization 1 2 3 4 5 6 7 8 9 IO Fig 18 The DO prediction andor NH4 predictions high uncertainty remains highly uncertain DO observations accurate BOD 0 Varis Artijicial Intelligence 101 1998 135163 159 targets There ways setting water quality targets ambient water quality varying targets The study 34 produce policy scenarios diverse economic presents scenarios 1 equal purification level equity dischargers prevalent paradigm Western countries 2 equal improvement 3 minimum concentration level river 4 targets specific points river city outflow water intake recreational area parts river protected site 5 target probability Fig 19 shows example results comparing normative levels frequencies occurrence conventional 2 The comparison imposed improvement equal purification river quality standards expensive environmentbased approach risk averse approach cases scenarios strategy dischargers yield 1 I I I c 1 2 3 4 5 6 7 8 9 10 10 05 00 1 2 3 4 5 6 7 8 9 10 1 234567 8 9 10 Scenario Normative Actual costs 93 I Ambient targets Improve 1 mgl 1 min Ptarget met 1 031 1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 Scenario Ambient I Actual costs 86 Ambient targets Improve 1 mgl I min Ptarget met I 032 10 I Fig 19 Sample policy scenarios comparison nonnative costeffective optimized In upperleft plots dots target 90 confidence level dotted lines indicate ambientbased interval results The levels solid line 160 0 Varis Art1 Intelligence 101 1998 135163 results scenarios costly way improving studied options clearly justifies institutionally workable problem juridically The important feature level plants treatment prioritization region normative equal ambient water quality issue countries setting Another 6 Discussion conclusions An approach belief networks probabilistic modeling presented The approach enables updating uncertainties It remarkably interactively approaches requiring offline simulation optimization dif rapid particularly runs Approaches criticized inaccurate practicable cases timeconsuming 151 The major disadvantage implementation approaches pilotstudy phase docu laborintensive relatively simulation parameter estimation ferent model components compared conventional Monte Carlo simulation noninteractive proposed approach compared conventional mented simultaneously included compromise optimization The proposed approach detect inconsistencies information different model components Possible Bayesian prior posterior distributions feature distributions changing network different pieces inconsistency appears difference given model component This approach prior posterior equal This belief values control variables develop optimization linking properties adjusting objective iterated functions The uncertainty balance For instance approach handle river basin example objective management function optimization objectives target costs target ambient water quality The approach finds tradeoff targets multiobjective easily comprehensible analytically results The proposed approach allows consideration practical assessment policy modeling Transparency simple constructs simple wellknown resource management approach Within environmental ment models relatively use relatively great advantage assurance critical points striving lization modeling uncertain constructs The structural uncertainty models linked fused pieces probabilistic In management natural resources environment sectors common practical manage solved The quality proper critical attitude uti models estimated empirically conceptual models high extreme In case probabilistic models means main concern modeling work tails probability distributions Yet parametric distributions distribution parameters assessment tails difficult These problems form distribution attempts common assumptions tails sensitive In case discrete distributions assumption innumerable probabilistic information uncertainties distribution approaches 0 Varis Artificial Intelligence 101 1998 135163 161 problems fuzzy set theory rulebased overcome approaches However increasingly accepted growing demand efficient probabilistic practice administrative techniques systems approach risk analysis appears bodies policy makers handling probabilistic information anticipating The belief network approach different versions adopted fields 3 sector studies belief Future shows occur natural resource environmental There strong reasons networks include probabilistic effort accuracy compatibility Bayesian computation decision analysis expected utility theory compatibility deterministic management models performing versa 24 possibility performing online reasonable effects vice twodirectional causes calculations Acknowledgements Institute This study funded supervised partly UNUWIDER special Finnish Project Fund supported Ministry Foreign Affairs Finland partly International Applied Systems Analysis Laxenburg Austria Many basic ideas influenced Sakari Kuikka Finnish Game supporting criticism colleagues Institute Fisheries Research IIASA Water Resources Project especially LBszl6 Somlyody David Yates Kenneth Strzepek Ilya Masliev I want thank colleagues Helsinki University especially Petri Kylmala gave valuable comments concept Technology motivation support Also I want link strength parameter Pertti Vakkilainen thank anonymous referees constructive I grateful comments References l ADB Environmental Risk AssessmentDealing Asian Development Bank Manila 1990 Uncertainty Environmental Impact Assessment 2 JS Breese RP Goldman construction probabilistic 1579 MP Wellman decision models IEEE Trans Syst Man Cybemet 24 11 1994 1577 section knowledgebased Introduction special 3 DG Bobrow Artificial Intelligence perspective retrospective volumes ArtiJiciul Intelligence Journal Artificial Intelligence 59 1993 S20 4 RT Clemen Making Hard Decisions PWS Kent Boston MA 1991 S P De Jongh Uncertainty EIA P Wathem Ed Environmental Impact Assessment Theory Practice Routledge London 1988 pp 6284 6 J Gordon EH Shortliffe A method managing evidential reasoning hierarchical hypothesis space Artificial 7 EJ Horwitz Intelligence 26 1985 323357 JS Breese M Henrion Decision Intemat J Approximate Reasoning 2 1988 247302 theory expert systems artificial intelligence 181 RA Howard The foundations Decision Analysis 9 C Howson P Urbach Bayan IO H Koivusalo 0 Varis L Somlybdy Water Quality Nitra River SlovakiaAnalysis science Nature 350 1991 371374 reasoning IEEE Trans Syst Sci Cybemet 4 1968 21 l219 Organic Material Pollution WP92084 International Institute Applied Systems Analysis Laxenburg 1992 162 0 Vans Artijcial Intelligence IO1 1998 135163 l 11 GA Kern TM Kom Mathematical Handbook Scientists Engineers McGrawHill New York 1968 121 S Kuikka 0 Varis Use Bayesian Influence Diagram Fisheries Managementthe Baltic Salmon Case CM D5 International Council Exploration Sea 1992 131 S Kuikka 0 Vatis Uncertainties climatic change impacts Finnish watersheds Bayesian network analysis expert knowledge Boreal Environm Res 2 1997 109128 14 I Masliev L Somlyly Uncertainty Analysis Parameter Estimation Class River Dissolved Oxygen Models WP949 International Institute Applied Systems Analysis Laxenburg 1994 15 MG Morgan M Henrion Uncertainty A Guide Dealing Uncertainty Quantitative Risk Policy Analysis Cambridge University Press Cambridge MA 1990 16 DW North A tutorial 17 J Pearl Fusion propagation 181 J Pearl On evidential 19 J Pearl Probabilistic Reasoning Kaufmann San Mateo CA 1988 introduction Decision Theory IEEE Trans Syst Sci Cybernet 4 1968 structuring belief networks Artificial Intelligence 29 1986 241288 reasoning hierarchy hypotheses Artificial Intelligence 28 1986 9l 5 Intelligent Systems Networks Plausible Inference Morgan 20 H Raiffa Decision Analysis AddisonWesley Reading MA 1968 21 S Russell P Norvig Artificial Intelligence A Modem Approach PrenticeHall Englewood Cliffs NJ 1995 22 RD Shachtcr Evaluation influence diagrams Oper Res 34 1986 871882 23 RD Shachter Probabilistic 24 RD Shachter DE Heckerman Thinking backward inference influence diagrams Oper Res 36 1988 589604 knowledge acquisition AI Magazine 8 1987 5561 25 G Shafer Decision making G Shafer J Pearl Eds Readings Uncertain Reasoning Morgan Kaufmann San Mateo CA 1990 pp 6167 26 G Shafer J Pearl Eds Readings 27 PP Shenoy G Shafer Propagating Uncertain Reasoning Morgan Kaufmann San Mateo CA 1990 IEEE Expert Fall 1986 belief functions local computations 4352 28 L Somlyody Quo vadis water quality management Central Eastern Europe Water Sci Technol 30 1994 114 29 L Somlybdy WP9440 I Masliev P Petrovic M Kularathna Water Quality Management Institute Applied Systems Analysis Laxenburg 1994 International Nitra River Basin 30 P Szolovits SG Pauker Categorial probabilistic reasoning medicine revisited Artificial Intelligence 59 1993 167l 80 31 A Taskinen 0 Varis H Sirvio J Mutanen P Vakkilainen Probabilistic uncertainty assessment phosphorus balance calculations watershed Ecol Modelling 74 1994 125135 32 RV Thomann Systems analysis Ed Systems Analysis 25 year retrospective Water Quality Management Pergamon Oxford 1987 pp 114 water quality managementa MB Beck 33 0 Varis Belief networks modeling assessment environmental change Environmetrics 6 1995 439144 34 0 Varis A Belief Network Approach Optimization Environmental Management Models WP9511 Laxenburg 1995 35 0 Varis Interconnections forces impacts policy tools Proceedings Development October 2023 1997 Graphlink Kathmandu 1997 36 0 Varis Bayesian decision analysis environmental water food poverty global urbanization qualitative analysis driving International Conference Large Scale Water Resources Developing Countries New Dimensions Prospects Problems Kathmandu Nepal Parameter Estimation Applied Systems Analysis Resource International Institute resource management Environmental Modeling Software 12 1997 177185 37 0 Varis J Kettunen H Sirvio Bayesian influence diagrams complex environmental management including observational design Comput Statist Data Anal 9 1990 7791 38 0 Varis S Kuikka Analysis Sardine Fisheries Management Lake Kariba Zimbabwe ZambiaStructuring Analysis Institute Applied Systems Analysis Laxenburg 1990 Bayesian Influence Diagram Model WP9048 International 0 Varis Artijicial Intelligence 101 1998 135163 163 39 0 Varis S Kuikka Joint use multiple environmental assessment models Bayesian metamodel Baltic salmon case Ecol Modelling 102 1997 34135 1 40 0 Varis S Kuikka BeNeEIA Bayesian approach expert judgment elicitation case studies climatic change impacts surface waters Climatic Change 37 1997 539563 41 0 Varis B Klove J Kettunen Evaluation realtime forecasting river water quality tradeoff risk attitudes costs uncertainty Environm Monit Assessment 28 1993 2012 13 Baltic Salmon Case 42 0 Varis S Kuikka J Kettunen Belief Networks Fish Stock Assessmentthe CM D 13 International Council Exploration Sea 1993 43 0 Varis S Kuikka A Taskinen Modeling water quality decisions uncertainty subjectivity information objectives mode1 structure Ecol Modelling 74 1994 91101 44 A Wald Statistical Decision Functions Wiley New York 1950 45 WCED Our Common Future Report World Commission Environment Development Oxford University Press Oxford 1987 46 FH Zeitz III PS Maybeck An alternate algorithm discretetime filtering IEEE Trans Aerosp Electr Syst 29 1993 1123l 135