Artiﬁcial Intelligence 174 2010 442448 Contents lists available ScienceDirect Artiﬁcial Intelligence wwwelseviercomlocateartint A note minimal dseparation trees structural learning Binghui Liu Jianhua Guo BingYi Jing b Key Laboratory Applied Statistics MOE School Mathematics Statistics Northeast Normal University Changchun 130024 Jilin Province China b Department Mathematics Hong Kong University Science Technology Hong Kong r t c l e n f o b s t r c t Structural learning Bayesian network decomposed problems related subgraphs approaches decomposition proposed In 2006 Xie Geng Zhao proposed dseparation tree improve power conditional independence tests eﬃciency structural learning In research note study minimal dseparation tree partial ordering maximal eﬃciency obtained Our results demonstrate minimal dseparation tree directed acyclic graph DAG constructed searching clique tree minimal triangulation moral graph DAG 2010 Elsevier BV All rights reserved Article history Received 2 April 2009 Received revised form 19 January 2010 Accepted 23 January 2010 Available online 2 February 2010 Keywords Bayesian network Clique tree Minimal dseparation tree Minimal triangulation Separation tree Structural learning 1 Introduction Bayesian networks BNs known directed acyclic graphical models useful probabilistic graphical models represented DAGs For Bayesian network components involved First DAG qualitative component represents dependence independence relationships absence directed edges represents existence certain conditional independence relationships variables presence edges represent existence direct dependence relationships causal relationships 1017 Second joint probability distribution quantitative component expresses strength association variables We special structure recovery DAGs Several methods structural learning DAGs considered mainly basic approaches structural learning 23 constraintbased approach searchandscore approach We introduce constraintbased algorithms As mentioned 23 constraintbased algorithm search dseparators pairs variables major problem orientation edges structure recovery DAG Here dseparator subset variables variable pairs dseparated Verma Pearl 21 presented IC algorithm searched dseparator S possible variable subsets variables u v conditionally independent S As search dseparators timeconsuming algorithms proposed speed search For example PC algorithm iterative algorithm searched dseparators contained variables adjacent u v step 19 variables said adjacent edge variables Decomposition approaches 722 useful approaches speed search Using approaches original learning question decomposed subquestions smaller dimensions For constraintbased algorithms steps recover DAG structures 23 First learn moral graph target DAG applying Markov blanket learning algorithms Markov blanket variable u deﬁned Corresponding author Email addresses liubh024yahoocomcn B Liu jhguonenueducn J Guo majingusthk BY Jing 00043702 matter 2010 Elsevier BV All rights reserved doi101016jartint201001002 B Liu et al Artiﬁcial Intelligence 174 2010 442448 443 set variables composed parents children childrens parents 16 Second perform independence tests edge orientation based moral graph learned ﬁrst step To speed second step Xie Geng Zhao 22 proposed algorithms adopting decomposition approach supported useful important deﬁnition dseparation tree They introduced deﬁnition depict separations conditional independen cies sets random variables deﬁnition following section Given dseparation tree T problem searching dseparators large network localized smaller subnetworks dseparators searched node tree separately Theorem 2 22 Then number independence tests mentioned second step certainly reduced Different dseparation trees carry corresponding eﬃciencies The eﬃciency deﬁned different angles different purposes For example aim search tree largest node minimum size eﬃciency deﬁned inversely proportional number vertices largest node tree Our aim slightly different eﬃciency deﬁned inversely proportional maximum number possible tests described following section To appropriate dseparation tree high eﬃciency ﬁrst introduce deﬁnition minimal dseparation trees DAG Our paper focuses characterization construction minimal dseparation tree Xie Geng Zhao 2006 proposed suﬃcient condition dseparation trees Based work minimal dseparation tree DAG equivalent minimal separation tree moral graph DAG turn equivalent clique tree minimal triangulation moral graph According equivalences useful algorithms searching minimal trian gulations clique trees available construct minimal dseparation tree leads minimal number independence tests mentioned required orientation edges The deﬁnitions moral graph clique tree triangulation 101213 introduced section In Section 2 introduce notation deﬁnitions As paper mainly inspired Xie Geng Zhao mainly follow terminology 22 Section 3 discusses characterization construction minimal dseparation tree DAG In Section 4 conclusion paper 2 Notation deﬁnitions We follow terminology 1322 noted 21 Undirected graphs separation trees We consider simple connected graphs Let G V E denote undirected graph V vertex set E set undirected edges An undirected edge vertices u v denoted u v A V induces subgraph G A A E A E A E A A A subset V called complete pair vertices subset connected edge A complete subset maximal wrt inclusion called clique A path p vertices u v sequence vertices w 0 u w 1 wn v w i1 w E 1 cid2 cid2 n n cid3 1 w cid6 w j 1 cid2 j cid2 n A cycle path w 0 wn A chord cycle pair vertices w w j w w j E j cid6 1 1 Two subsets A B V A B said separated C V G paths A B pass C vertex u A vertex v B paths u v intersect C vertices The partition A B S V said decomposition undirected graph G 1 S separates A B G 2 S complete G Then G decomposed subgraphs G AS G BS H h1 Ch V T denotes tree node set C edge set E T Inspired deﬁnition dseparation tree Deﬁnition 1 22 propose similar deﬁnition separation tree undirected graphs Let C C1 C H cid2 Deﬁnition 1 A tree T C E T said separation tree undirected graph G V E edge Ci C j C k 1 2 C 1 C 2 node sets E T V 1Ci C j V 2Ci C j separated Ci C j G V k T 1 T 2 obtained removing edge Ci C j tree T CCk cid2 If edge Ci C j E T Ci C j complete G T decomposition tree G A tree T C E T reduced vertex set C contained redC C red stands operation deleting smaller sets C1 C2 C1 C2 22 Triangulated graphs clique trees A triangulated graph known chordal graph undirected graph contains cycles length cid3 4 chord For undirected graph G V E edges added resulting graph Gt V E F called cid9 triangulation given graph G triangulated A triangulation Gt G said minimal G triangulated proper subset F cid9 V E F F cid9 444 B Liu et al Artiﬁcial Intelligence 174 2010 442448 Fig 1 An undirected graph G V E left minimal triangulation Gt right G Fig 2 A DAG G Example 1 We Gt Fig 1 triangulation undirected graph G contains cycles length cid3 4 chord And Gt minimal triangulation G 1 V E 1 4 G 2 V E 4 5 triangulated We continue graph G 3 triangulated Let G 3 V E 3 5 3 6 looks like triangulation However exists cycle 1 2 4 6 5 1 chord contrary deﬁnition Let KG denote collection cliques undirected graph G 5 For triangulated graph G exists subset set trees KG known clique trees 5 Deﬁnition 2 Assume G triangulated graph A tree T KG said clique tree G T satisﬁes cliqueintersection property pair distinct cliques K K j KG set K K j contained clique path connecting K K j tree Note clique tree triangulated graph G said junction tree cliques G 6 given triangulated graph G T clique tree G T decomposition tree G Theorem 46 6 There eﬃcient algorithms computing clique trees triangulated graph The commonly cited MCS algorithm 20 O n m time bound n number vertices m number edges given triangulated graph 23 Directed graphs dseparation trees Let G V E denote DAG V ﬁnite vertex set E set directed edges A directed edge vertex u v denoted cid10u vcid11 If directed edge u v v said child u u parent v Denote set parents vertex v pav denote set children vertex u chu We u ancestor v v descendant u path u v G edges path point direction v We denote set ancestors vertex v anv set descendants vertex u deu For A V v A anv A A said ancestral set For B V let AnB denote smallest ancestral set containing B The moral graph Gm V Em DAG G deﬁned undirected graph edge set constructed marrying parents dropping directions connecting vertices common child making edges graph undirected 13 A path p said dseparated set Z D AG G 1 p contains chain u v w fork u v w middle vertex v Z 2 p contains collider u v w middle vertex v Z descendant v Z 17 Two distinct sets X Y vertices said dseparated set Z G Z dseparates path vertex X vertex Y 17 We Z dseparates X Y G In fact Z dseparates X Y G Z separates X Y moral graph G An XY Z written G An XY Z m 13 Example 2 We example dseparation Fig 2 A 2 B 6 dseparated C 1 In Fig 2 paths 2 6 2 1 5 6 2 4 3 1 5 6 2 4 7 6 2 1 3 4 7 6 We 2 1 5 6 contains fork 2 1 5 2 4 3 1 5 6 contains fork 3 1 5 2 4 7 6 2 1 3 4 7 6 contain collider 4 7 6 middle vertex 7 C descendant 7 C To depict dseparations conditional independencies multiple variable sets notion dseparation tree ﬁrst proposed 22 Replacing undirected graph DAG replacing separated dseparated Deﬁnition 1 obtain deﬁnition dseparation tree DAG We examples dseparation trees Fig 2 Fig 3 B Liu et al Artiﬁcial Intelligence 174 2010 442448 445 Fig 3 T 1 T 2 dseparation trees G Fig 2 minimal dseparation tree T 3 minimal dseparation tree G The following theorem Theorem 1 22 gives valuable important property dseparation tree central decomposing approach structural learning Theorem 1 See Xie et al 22 Let T dseparation tree DAG G Vertices u v dseparated S V u v G 1 u v contained node T 2 exists node C contains u v subset S C dseparates u v cid9 Theorem 1 implies problem searching dseparators constructing skeleton DAG divided smaller problems nodes T eﬃciency vastly improved By different dseparation trees obtain different eﬃciencies To depict appropriate dseparation tree maximal eﬃciency present minimal dseparation tree DAG let Ccid9 C redC C C cid9 C We proceed deﬁne partial order trees T C E T T cid9 Ccid9 cid9 Ccid9 E T cid9 Ccid9 cid6 C For tree T C E T use lessT denote following collection cid9 Ccid9 Note Ccid9 C Ccid9 C C C cid9 For collections subsets C Ccid9 cid9 T Ccid9 C Ccid9 exist C C C T treescid3 T cid9 T Ccid9 cid5 cid4 E T cid9 cid9 reduced cid7 cid9 V T cid9 T C cid6 C cid9Ccid9 Deﬁnition 3 A reduced dseparation tree T C E T DAG G V E said minimal dseparation tree G tree T cid9 Ccid9 E T cid9 lessT dseparation tree G As mentioned given dseparation tree T C1 C H E T eﬃciency structural improved To construct global skeleton DAG need execute conditional cid8 C j 2 times obviously smaller C 2 V 2 learning independence tests V 2 Deﬁne cost function f dseparation H j1 C 2 C j 2 trees way f T Hcid9 j1 C j 2 C 2 C j2 And deﬁne eﬃciency function eff 1 f For reduced dseparation trees T 1 T 2 DAG G V E T 1 T 2 f T 1 f T 2 rigorously proved Lemma 3 Section 3 Therefore dseparation tree T 1 better T 2 terms eﬃciency improvement Computing dseparation tree smallest cost best choice following searching work However problem computing dseparation tree minimum cost great computational complexity related polynomially solvable problem computing dseparation tree minimal cost interesting Example 3 Consider DAG G Fig 2 Three dseparation trees T Ci E T 1 2 3 shown Fig 3 cid10 cid10 cid10 C1 C2 C3 1 2 3 4 1 3 4 5 4 5 6 4 6 7 1 2 3 4 5 4 5 6 4 6 7 1 2 3 4 1 4 5 4 5 6 4 6 7 cid11 cid11 cid11 446 B Liu et al Artiﬁcial Intelligence 174 2010 442448 Taking T 3 example 2 3 5 6 7 dseparated 1 4 1 2 3 6 7 dseparated 4 5 1 2 3 5 7 dseparated 4 6 C3 C1 C3 C2 C3 T 3 T 1 T 3 T 2 Then f T 3 f T 1 f T 3 f T 2 In fact T 3 minimal dseparation tree DAG G Similarly deﬁnition minimal separation tree undirected graph replacing dseparation separation replacing DAG undirected graph Deﬁnition 3 Now given necessary background deﬁnitions minimal dseparation trees important topic constructing minimal dseparation trees 3 Construction minimal dseparation trees In section focus relationships minimal dseparation trees minimal separation trees clique trees minimal triangulations Afterwards construct minimal dseparation trees taking advantage algorithms minimal triangulation widely studied Lemma 1 In DAG G V E following statements equivalent 1 Tree T C E T dseparation tree G 2 T separation tree Gm 3 T decomposition tree triangulation Gt Gm Proof 3 1 Considering Ci C j E T let K Ci C j Then V 1K V 2K separated K Gt Since Gm fewer edges Gt know V 1K V 2K separated K Gm Therefore T dseparation tree G 1 2 For Ci C j E T V 1K V 2K dseparated K DAG G V 1K V 2K separated K G AnV 1K V 2K K m Gm Then T separation tree Gm cid2 2 3 Let Gt V CC E C E C b b C cid6 b Considering Ci C j E T let K Ci C j For x V 1K y V 2K x y C C In fact exists subset C1 C x y C1 let C1 node T 1 loss generality Then y C1K V 1K contrary fact y V 2K V 1K V 2K separated K Gm By construction Gt know x y edge Gt Then V 1K V 2K separated K Gt T decomposition tree Gt Gt decomposed step step complete subgraphs Gt triangulated graph For x y Em C C x y C In fact x y set C dx y 0 Deﬁnition A1 22 Let dx y dC3 C4 x C3 C y C4 C Let C5 ﬁrst node path T C3 C4 K C3 C5 Then C3K C4K separated K Gm Since x y contained K result x y separated K Gm contrary fact x y Em Therefore Gt triangulation Gm T decomposition tree Gt cid2 Lemma 2 In DAG G V E following statements equivalent 1 Tree T C E T reduced dseparation tree G 2 T reduced separation tree Gm 3 T clique tree triangulation Gt Gm Proof 3 1 This point proved Theorem 2 22 C cid2 1 2 T reduced T reduced separation tree Gm Lemma 1 2 3 Let Gt V Gm T decomposition tree Gt C K C complete Gt Furthermore clique K K contained We continue decompose subgraph step step K ﬁnally contained C C b b C cid6 b By proof Lemma 1 Gt triangulation Gt C K Gt Gt decomposed subgraphs K certainly Gt In fact C C exists K K C Et CC Et Now T clique tree Gt Let C C arbitrary distinct subsets C For node Ci path For edge Ci C j let K Ci C j Then path T C C V 1K V 2K separated K Gt Therefore C C x K paradoxical result x x separated K Gt By deﬁnition clique tree know T clique tree Gt cid2 cid9 K Ci In fact exists vertex x C C let C j ﬁrst node Ci C cid9 cid9 cid9 cid9 Lemma 3 Assume T 1 T 2 reduced dseparation trees DAG G V E If T 1 T 2 f T 1 f T 2 clique tree Gti 1 2 Proof From Lemma 2 exist triangulations Gt1 Gt2 Gm T From Lemma 221 13 increasing sequence Gt1 G 0 G 1 Gk Gt2 triangulated graphs differ B Liu et al Artiﬁcial Intelligence 174 2010 442448 447 exactly edge k difference numbers edges Gt1 Gt2 Let G j V E j 0 cid2 j cid2 k Suppose E1E0 α β Lemma 219 13 graph G 1 α β member clique C Let β 1 cid2 q cid2 n Let K C1 Cq1 Cq1 Cn Cq1 Cq2 KG 1 KG 0 Cq1 C redK We C1 Cn Cq C α Cq2 C cid9 CKG0 C 2 C 2 C cid9 CKG1 cid8 C 2 C 2 C cid2 cid9 C 2 C 2 C cid9 C 2 C 2 C CKG1 Cq2 2 Cq2 2 Cq1 C 2 Cq1 C 2 C 2 C 2 CK Cq1 2 Cq1 2 cid8 C Cq Cq2 C 2 Cq2 2C 2 Cq 2 Cq 2 Cq1 0 Similarly prove C 2 cid8 C 2 C 2 CKGk C 0 f T 1 f T 2 cid2 CKG j1 C 2 C 2 C 2 C 2 C 0 1 cid2 j cid2 k implies cid8 CKG0 C C 2 CKG j Theorem 2 In DAG G V E following statements equivalent 1 Tree T C E T minimal dseparation tree G 2 T minimal separation tree Gm 3 T clique tree minimal triangulation Gt Gm Proof 3 1 T clique tree Gt T reduced dseparation tree G Suppose T minimal d separation tree G There exists tree T reduced dseparation tree G By Lemma 2 know cid9 V E CCcid9 Et triangulation G C Et C Because C C Ccid9 Ccid9 fewer edges Gt Gt minimal triangulation Gm contrary fact b b C cid6 b T clique tree Gt We know Gt V Et Et lessT T Gm T furthermore G clique tree G cid9 CC Et cid9 E C cid6 Ccid9 G cid2 cid2 cid9 cid9 cid9 cid9 cid9 cid9 1 2 Assume T minimal separation tree Gm exists tree T reduced dseparation tree G Lemma 2 contrary fact cid9 cid9 lessT T cid9 reduced separation tree Gm Thus T T minimal dseparation tree G cid2 2 3 Since T minimal separation tree Gm know T clique tree triangulation Gt C Suppose Gt minimal triangulation Gm exists reduced cid9 C C KGcid9 KGcid9 It obvious minimal Gm Gt V Et Et cid9 triangulation G separation tree Gm For C C cid6 KGcid9 T minimal separation tree Gm contrary fact Thus Gt triangulation Gm ﬁnally know T clique tree minimal triangulation Gt Gm cid2 Gm fewer edges Gt Construct clique tree T cid9 KGcid9 C C C cid9 KGcid9 E T cid9 G CC Et T cid9 cid9 Example 4 To construct minimal dseparation tree DAG Fig 2 need compute minimal triangulation Fig 1 right moral graph Fig 1 left construct clique tree minimal triangulation We T 3 Fig 3c clique tree minimal triangulation According Theorem 2 minimal dseparation tree equivalent clique tree minimal triangulation moral graph Then eﬃcient algorithms ﬁnding minimal triangulations clique trees available construct minimal dseparation tree We continue introduce algorithms minimal triangulation Several characterizations algorithms minimal triangulations general undirected graphs presented 1976 As Heggernes pointed 9 approaches compute characterize minimal triangulations vertex elimination minimal separators given graph The ﬁrst characterizations minimal triangulations given simultaneously Ohtsuki 14 Ohtsuki et al 15 Rose et al 18 1976 These characterizations strongly connected vertex elimination Based characteriza tions algorithms algorithm Ohtsuki 14 LEX M algorithm 18 MCSM algorithm 3 proposed time bound O nm n number vertices m number edges given graph For 20 years O nm O n3 remained best known time bound minimal triangulations A breakthrough 2004 new implementation LEX M described Kratsch Spinrad 11 runs time O n269 There useful algorithms minimal triangulations based characterizations strongly connected mini mal separators LBTriang algorithm Berry et al 14 vertex incremental minimal triangulation algorithm Berry et al 2 Fast Minimal Triangulation algorithm Heggernes et al 8 The ﬁrst algorithms running times O nm runs on2376 simultaneous breakthrough LEX M implementation 2004 448 B Liu et al Artiﬁcial Intelligence 174 2010 442448 4 Conclusions We proposed partial ordering dseparation trees fact tree smaller implies smaller eﬃcient Under ordering deﬁnition minimal dseparation tree introduced We obtained equivalence minimal dseparation trees DAG G clique trees minimal triangulations moral graph G Theorem 2 Therefore eﬃcient algorithms minimal triangulations clique trees directly construct minimal dseparation trees DAGs Accordingly work performing independence tests second steps constraintbased algorithms structural learning carried maximal eﬃciency However generally speaking constructed minimal dseparation tree minimum dseparation tree largest eﬃciency Our minimal dseparation tree exhibits tradeoff eﬃciency computation time Acknowledgements The authors grateful editor reviewers insightful comments helpful suggestions greatly improved quality presentation paper This research partially supported National Natural Science Foundation China Grant Numbers 10701022 10871038 10826110 10926186 National 973 Key Project China 2007CB311002 HK RGC Grant HKUST611702 References 1 A Berry A widerange eﬃcient algorithm minimal triangulation Proceedings Tenth Annual ACMSIAM Symposium Discrete Algorithms SODA99 1999 pp S860S861 2 A Berry P Heggernes Y Villanger A vertex incremental approach dynamically maintaining chordal graphs Algorithms Computation ISAAC 2003 Lecture Notes Comput Sci vol 2906 Springer Berlin 2003 pp 4757 3 A Berry JRS Blair P Heggernes BW Peyton Maximum cardinality search computing minimal triangulations graphs Algorithmica 39 4 2004 287298 4 A Berry JP Bordat P Heggernes G Simonet Y Villanger A widerange algorithm minimal triangulation arbitrary ordering J Algo rithms 58 1 2006 3366 5 JRS Blair B Peyton An introduction chordal graphs clique trees A George JR Gilbert J Liu Eds Graph Theory Sparse Matrix Computation SpringerVerlag New York 1993 6 RG Cowell AP David SL Lauritzen DJ Spiegelhalter Probabilistic Networks Expert Systems Springer Publications New York 1999 7 Z Geng C Wang Q Zhao Decomposition search Vstructures DAGs J Multivariate Anal 170 2005 422439 8 P Heggernes JA Telle Y Villanger Computing minimal triangulations time O nα log n on2376 SIAM J Discrete Math 19 4 2005 900913 9 P Heggernes Minimal triangulations graphs A survey Discrete Math 306 2006 297317 10 FV Jensen Bayesian Networks Decision Graphs SpringerVerlag 2001 11 D Kratsch J Spinrad Minimal ﬁll O n269 time Discrete Math 306 2006 366371 12 HG Leimer Optimal decomposition clique separators Discrete Math 113 1993 99123 13 SL Lauritzen Graphical Models Clarendon Press Oxford 1996 14 T Ohtsuki A fast algorithm ﬁnding optimal ordering vertex elimination graph SIAM J Comput 5 1976 133145 15 T Ohtsuki LK Cheung T Fujisawa Minimal triangulation graph optimal pivoting ordering sparse matrix J Math Anal Appl 54 1976 622633 16 J Pearl Probabilistic Reasoning Intelligent Systems Morgan Kaufmann San Mateo CA 1988 17 J Pearl Causality Models Reasoning Inference Cambridge University Press Cambridge 2000 18 D Rose RE Tarjan G Lueker Algorithmic aspects vertex elimination graphs SIAM J Comput 5 1976 146160 19 P Spirtes C Glymour R Scheines Causation Prediction Search 2nd edition MIT Press 2000 20 RE Tarjan M Yannakakis Simple lineartime algorithms test chordality graphs test acyclicity hypergraphs selectively reduce acyclic hypergraphs SIAM J Comput 13 1984 566579 21 T Verma J Pearl Equivalence synthesis causal models Proceedings 6th Conference Uncertainty Artiﬁcial Intelligence Elsevier Amsterdam 1990 pp 255268 22 X Xie Z Geng Q Zhao Decomposition structural learning directed acyclic graphs Artiﬁcial Intelligence 170 2006 422439 23 X Xie Z Geng A recursive method structural learning directed acyclic graphs J Mach Learn Res 9 2008 459483