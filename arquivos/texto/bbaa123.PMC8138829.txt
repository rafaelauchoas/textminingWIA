Briefings Bioinformatics 223 2021 112 httpsdoiorg101093bibbbaa123 Problem Solving Protocol Evaluating assembly variant calling software strainresolved analysis large DNA viruses ZhiLuo Deng Akshay Dhingra Adrian Fritz Jasper Götting Philipp C Münch Lars Steinbrück Thomas F Schulz Tina Ganzenmüller Alice C McHardy Corresponding author Alice C McHardy Department Computational Biology Infection Research Helmholtz Centre Infection Research Braunschweig Germany Tel 49 531 39155271 Email AliceMcHardyhelmholtzhzide Abstract Infection human cytomegalovirus HCMV cause severe complications immunocompromised individuals congenitally infected children Characterizing heterogeneous viral populations evolution highthroughput sequencing clinical specimens requires accurate assembly individual strains sequence variants suitable variant calling methods However performance methods assessed populations composed low divergent viral strains large genomes HCMV In extensive benchmarking study evaluated 15 assemblers 6 variant callers 10 labgenerated benchmark data sets created different library preparation protocols identify best practices challenges analyzing data Most assemblers especially metaSPAdes IVA performed range metrics recovering abundant strains However Savage recovered low abundant strains highly fragmented manner Two variant callers LoFreq VarScan2 excelled strain abundances Both shared large fraction false positive variant calls strongly enriched T G changes GG context The magnitude contextdependent systematic error linked experimental protocol We provide benchmarking data results entire benchmarking workf low named QuasiModo Quasispecies Metric determination omics GNU General Public License v30 httpsgithubcom hzibifoQuasimodo enable reproducibility benchmarking data Key words HCMV strain mixtures virus benchmark genome assembly variant calling ZL Deng postdoctoral researcher Department Computational Biology Infection Research Helmholtz Centre Infection Research His research focuses viral genomics microbiome A Dhingra PhD student Institute Virology Hannover Medical School working nextgeneration sequencing viruses He currently postdoctoral researcher A Fritz PhD student Department Computational Biology Infection Research Helmholtz Centre Infection Research He focuses developing software strainresolved assembly metagenomics J Götting PhD student Institute Virology Hannover Medical School working nextgeneration sequencing viruses NGS data analysis P C Münch PhD student Department Computational Biology Infection Research Helmholtz Centre Infection Research Max von Pettenkofer Institute Ludwig Maximilian University Munich L Steinbrück working generation sequencing Institute Virology Hannover Medical School T F Schulz director Institute Virology Hannover Medical School And research focuses virology infection T Ganzenmüller working clinical virologist Institute Virology Hannover Medical School She currently working Institute Medical Virology University Hospital Tübingen senior physician A C McHardy head Department Computational Biology Infection Research Helmholtz Centre Infection Research The department studies human microbiome viral bacterial pathogens human cell lineages individual patients analysis largescale biological epidemiological data sets computational techniques Submitted 21 December 2019 Received revised form 18 May 2020 The Authors 2020 Published Oxford University Press All rights reserved For Permissions email journalspermissionsoupcom This Open Access article distributed terms Creative Commons Attribution NonCommercial License httpcreativecommonsorglicensesbync40 permits noncommercial reuse distribution reproduction medium provided original work properly cited For commercial reuse contact journalspermissionsoupcom 1 2 Deng et al Introduction Human cytomegalovirus HCMV causes lifelong infection typically major clinical symptoms After primary infection HCMV persists latently infected cells 1 Primary reinfections reactivation HCMV cause significant morbidity severe complications immunocompromised individuals HIVinfected persons transplant recipients congenitally infected children 2 3 HCMV double stranded DNA genome approximately 235 kb including ter minal internal repeats contains 170 open reading frames 4 With genome sizes known viruses ranging 1 kb Circovirus SFBeef 2 Mb Pandoravirus salinus 5 HCMV belongs larger known viruses coevolved host millions years 6 Multiple HCMV strain infections strain time prob ably contribute prolonged viremia delayed viral clearance complications 710 The establishment highthroughput sequencing tech niques accompanying bioinformatics analysis methods greatly advanced viral genomic research 1116 Assembling individual virus strains mixed viral genomes population variant calling essential characterizing evolution genetic diversity viral pathogens HCMV vivo Although HCMV mutates evolves slowly RNA viruses faster herpes viruses high levels genetic variation mixed multiple viral strain infections individual observed 1720 These multiple strain infections likely result reactivation latent strains andor reinfections 17 21 22 Assemblers leverage short read sequence data linking sequences kmer read graphs cases vari ant frequencies reconstruct viral haplotypes recently developed HaROLD 23 makes use longitudi nal sequence data There variant callers available including programs calling lowfrequency variants LoFreq 24 VarScan2 25 commercial CLC Genomics Workbench 26 Those programs use information basecall mapping quality determine variant site read sequencing error mapping bias reflects true biological diversity 2426 A recent study simulated mock viromes suggests choice assembler largely influences virome characteriza tion 27 Several assemblers evaluated including IDBA UD 28 SPAdes 29 Ray 30 Megahit 31 previously assessed divergent simulated spiked mock viromes 27 32 This case included strains 97 average nucleotide identity ANI 33 resulted shorter assem blies low divergent community members Viral haplotype assemblers reconstruct small viral genomes HIV Zika hepatitis C virus good genome fractions However highly fragmented case Savage 34 consist longer contigs substantial misassemblies case PEhaplo 35 QuasiRecomb 36 PredictHaplo 37 Viral haplotype assemblers far evaluated smaller divergent genomes genome size 10 kb divergence 127 34 38 They assessed substantially larger genomes low density variants far A recent assessment variant callers 39 reported variable complementary performances FreeBayes 40 LoFreq VarDict 41 VarScan2 minority variant detection simulated short read data Respiratory Syncytial Virus RSV small virus 15 kb genome size So far strainlevel assembly variant calling methods evaluated large DNA viruses runtime memory consumption algorithms criti cal benchmark data include experimental biases library preparation sequencing To investigate issues largest benchmark kind far created sequenced samples HCMV strains different mixing ratios evaluated 21 computational methods resulting WGS data Analysis labcreated benchmark data sets allowed dissect effects computational methods library preparation protocols Results Creation quality control viral sequence samples To produce benchmark dataset mixed viral strains includes technical artifacts introduced experimental data generation created viral strain mixtures mimicking clinical samples patients mixed strain infections vitro For combined viral DNA HCMV strains TB40E BAC4 AD169 designated TA derived directly bacte rial artificial chromosomes BAC viral genomes prepared Escherichia coli strains TB40E BAC4 Merlin designated TM amplified human cellcultures respectively mixing ratios 11 110 150 The ANIs pair strains 0977 Table S1 In addition pure strains sequenced separately experiment resulting data sets TB40E AD169 strains target enrichment TB40E Merlin strain enrichment For TA mixture experiments library preparation protocol protocol 1 details Material Methods target enrichment TM mixtures protocol including target enrichment protocol 2 All 10 samples 6 HCMV strain mixtures 4 pure strains sequenced 2 300 bp pairedend sequencing Illumina MiSeq resulting 158 million raw reads average sample After quality control 11 million quality reads sample average base quality 30 remained As HCMV strains TA mixtures corresponding pure strain samples extracted E coli BACs E coli reads samples average fraction 486 165 Table S2 Based genome size HCMV 235 K E coli 46 M abundance contaminating E coli 5 The TM data sets pure Merlin strain TM01 include detectable bacterial contamina tion 517 reads TM10 pure TB40E strain human origin Strainresolved genome assembly For mixed strain data sets ultimate aim assembly recover genomes individual strains To obtain compre hensive performance overview existing software evalu ated performances generic metagenome assemblers SPAdes metaSPAdes 42 Megahit ABySS 43 Ray IDBAUD Tadpole BBMAP toolkit 44 IVA 45 Vicuna 46 viral haplotype assemblers Savage PredictHaplo PEhaplo QuasiRecomb ShoRAH 47 VirGenA 48 data sets Material Methods Evaluating assembly variant calling software strainresolved analysis large DNAviruses 3 S4 IVA produced average second fewest 81 79 longest contigs 1596 778 kb especially abundant strains 1608 723 kb 10 501 101 parts genomes covered multiple times duplication ratio 101 003 Figures 1 2 Table S3 The Tadpole assembly lowest duplication ratio 1001 0001 fewest mismatches 100 kb 185 398 Figures 1 2 Table S3 However mainly assembled little data generated short contigs NGA50 124 158 kb covered half 529 380 underlying genomes Megahit reconstructed overall largest fraction genomes average 798 165 genomes fraction high level duplication 17 06 mismatches 100 kb 1715 1684 The haplotype assembler Savage reference based mode recovered second 791 200 genome fraction strains low abundant ones Figure 2 However produced shorter contigs largest contig length 215 228 kb duplicates 138 023 The referencebased assembler VirGenA recovered 958 34 genome sequence dominant strains followed Megahit 935 57 SPAdes 934 24 ABySS 927 32 Ray 916 78 low abundant strains 0 383 200 352 66 373 145 122 45 respectively MetaSPAdes IVA recovered relatively large fraction 834 282 864 212 respec tively dominant strains little 387 284 85 60 respectively genome low abundant strains All haplotype assemblers Savage novo mode PredictHaplo PEhaplo QuasiRecomb ShoRAH assembled contigs terminated running 10 days 24 CPU cores Furthermore tested 1000 random weights sets calculate summary score assemblers metaSPAdes IVA maintained ranking 850 1000 sets This suggests assemblers good performance deliver highquality assembly metrics As genome assembly computationally intensive timeconsuming benchmarked disk space consumption IO output memory maximum memory require ment run time different algorithms Ray ABySS 30 MB output IVA SPAdes metaSPAdes Savage consumed 20 GB disk space output intermediate output Figure 3 Megahit memory efficient assembler 1 GB memory ABySS VirGenA Savage Vicuna consumed 10 GB As run times Megahit required 10 mins assembly Vicuna Savage needed 20 h 24 threads server 62 24GHZ CPUs 200 TB disk space 1 TB memory Variant calling We evaluated variant callers LoFreq VarScan2 low fre quency variant caller CLC genomics workbench BCFtools 50 FreeBayes GATK HaplotypeCaller 51 mixed strain pure strain different strains details material methods WGS samples A ground truth gen erated pairwise genome alignment respective strains MUMmer 52 Methods Figure 4 identified 35004000 variants including 200 short insertions dele tions InDels Sites genomes classified variant nonvariant alignment compared pre dicted variants determine true positive TP false negative FN false positive FP calls Since major strain Figure 1 Radar plot assembler performances metrics 10 samples Values scaled based average performance metric tools samples best performance 1 lowest performance 0 All metrics calculated combined reference statistics MetaQuast NGA50 available genomespecific report The NGA50 average NGA50 individual genomes samples Assemblies assessed based common assembly quality metrics metaQUAST 49 genome fraction duplication ratio largest alignment NGA50 strain genomes references respective mixtures Methods Figure 1 The genome fraction defined fraction reference genome covered contig The duplication ratio number bases reference genome covered divided total number aligned bases assembly The largest alignment size biggest contig aligned reference genome The NGA50 value assembly calculated sorting aligned contigs split misassembly events size descending order returning length contig exceeds 50 genome fraction If assembler fails produce 50 genome fraction NGA50 value calculated set 0 kb To summarize performance assemblers HCMV datasets defined composite quality metric strain resolved assembly performances consisting weighted score combining metaQUAST assembly metrics duplication ratio genome fraction number contigs number mismatches 100 kb Materials Methods In weighted score considered genome fraction largest alignment important metrics reflect ability assembler reconstruct individual strains completeness largest assembly largest alignment NGA50 All programs reconstructed genome sequence bet ter dominant minor strain With weighted summary score metaSPAdes achieved highest score 895 large genome fraction assembled 738 198 versus 647 302 IVA mean standard deviation second best largest alignment 1459 566 kb NGA50 1023 690 kb best number contigs 124 91 duplication ratio 101 001 Figure 1 Tables S3 S4 Next IVA 856 ranked best largest alignment NGA50 second best number contigs ABySS 787 Figure 1 Tables S3 4 Deng et al Figure 2 Performance genome assemblers haplotype assembler Savage reconstructing HCMV strains mixed sequence samples In mixture types HCMV strains AD169 Merlin high abundant strains respectively TB40E abundant ratios ranging 11 150 Boxplots display median black line interquartile range individual assembly quality metrics panels AF 10 data sets metaSPAdes abbreviated metaSPA Strain genomes denoted abundances individual mixtures For instance 110 blue indicates low abundant strain 110 mixture TB40E TA110 TM110 101 purple represents abundant strain 110 mixture AD169 Merlin TA110 TM110 respectively The best assembler metric marked bold red To illustrate performance assemblers strain mixture different abundance ratios genomespecific reports metaQUAST It noted contrary combined reference statistics Figure 1 genomespecific estimates based nonunique mappings entire set reference genomes metaQUAST unique option leads minor discrepancies metrics increased genome fraction duplication ratio number mismatches expected low frequency variants 2 10 respectively mixtures ratios 150 110 Variant calls false nucleotide predicted variant site considered FPs Based number TP FN FPs calculated precision recall F1score detection quality metrics caller sample Precision purity reflects fraction predicted variants true variants precision TP TPFP quantifies reliable predictions particular method Recall known completeness measures fraction truly existing variants data set detected caller recall TPFN measures complete predictions caller respect variants discover To allow comparison based single metric F1score commonly harmonic mean precision recall F1 2 precisionrecall precisionrecall TP Applying commonly cutoff 20 Phred quality scores QUAL 53 accepting predicted variants evaluated performance variant callers single nucleotide polymorphisms SNPs LoFreq achieved best average precision 0940 0011 VarScan2 highest recall 0872 0050 Figure 5A Table S5 mixture samples LoFreq VarScan2 consistently performed best sam ples average F1scores 0890 0009 0880 0011 Figure 3 Inputoutput IO memory consumption run time assembly programs measured snakemake benchmarking function samples Each dot boxplot indicates sample mixture reference evaluate perfor mance variant callers identifying low frequency vari ants originating minor strain mixture Evaluating assembly variant calling software strainresolved analysis large DNAviruses 5 164 59 381 163 Notably FPs mixtures 707 173 based LoFreq predictions 376 79 based VarScan2 shared Figure S3 This significant 16 odds ratio overlap Fishers exact test Pvalue 22 10 34168 16011 indicates systematic shared bias regardless variant callers Variant calling Figure S4 indicated allele frequencies intended dilutions closely reached protocol 2 TM mixture differed slightly protocol 1 TA mixture Genomic context variant calls We analyzed specific genomic signal asso ciated variant calls considering separately correct false calls mutational context analysis 5456 Focusing exemplarily LoFreq approach analyzes frequency certain SNP sequence context specifically flanking3 5cid3 bases For predictions certain caller genomic context substitution types C A C G C T T A T C T G calculated R package SomaticSignatures 56 mixtures pure strain samples 2 samples TB40E 1 Merlin 1 AD169 Since analysis strandspecific considered equivalent G T G C G A A T A G A C respectively We observed strong context independent preference C T T C transitions fraction 0803 0016 variant calls samples panel Figure 7A B pronounced true positives middle panel Figure 7A B FPs For variants observed pairwise combinations 30 E coli 30 HIV genomes obtained NCBI RefSeq database Table S7 respectively observed concordant results Figures S5 S6 For data transitions accounted 0716 0058 0681 0017 variants genome pairs respectively We pronounced contextdependent signal FP calls LoFreq VarScan2 Here T G variants GG context cor respond FPs TA TM mixtures 571 100 868 183 respectively panel Figure 7A B This enrichment highly significant Pvalue 00001 Fishers exact test odds ratio 452 TM mixture T G calls 452 times frequent context 199 frequent TA mixture For false variant calls pure Merlin AD169 samples T G calls GG context dominant For LoFreq pure Merlin TM01 sample genomic context pattern false calls highly correlated context pattern FPs mixed strain samples average Pearson correlation 0903 Pvalue 00001 For AD169 strain respective mixtures correlation Pearson lower average 0697 highly significant Pvalue 00001 The allele frequencies FP LoFreq variants substantially lower true positive variants 16 Figure S7 Wilcoxon test Pvalue 22 10 TA150 sample highestlevel E coli cloning vector contamination False T G calls GG context 10 lower frequency false calls Pvalue 1181 10 10 TA mixtures The TM mixtures Figure S8 816 10 allele frequency FP SNPs slightly lower protocol 2 TM 00237 00522 protocol 1 TA 00242 00121 Wilcoxon Pvalue 0000559 95 CI 000363 00120 The extent signal differed samples created different protocols Though overall FP rate similar contextdependent false calls T G GG doubled protocol Figure 4 Schematic presentation variant calling benchmark Mixed samples include HCMV strains different abundance ratios A genome alignment strains generate ground truth defining divergent conserved sites denoted G genomic difference G genomic difference respectively Based caller sites classified predicted variants C predicted conserved C defining true positive TP blue false positive FP red false negative FN orange variant calls If variant called differed ground truth variant considered FP respectively Figure 5B Table S5 CLC slightly lower F1 score 0806 0025 variable performance samples BCFtools GATK Freebayes performed poorly F1score 0166 0288 0261 0388 0289 0428 0122 0230 respectively particularly low recall 0215 0338 0253 0386 Across strains abun dance ratios tested LoFreq consistently performed VarScan2 consistent abundance ratios performed differently strain mixtures varied precision CLCs recall dropped dramatically mixture TM150 BCFtools GATK FreeBayes performed poorly comparison samples highly diluted samples recall 0 To analyze effect returned Phred quality scores variant callers performances evaluated SNPs InDels called different thresholds quality scores recallprecision curve LoFreq best recallprecision balance followed VarScan2 CLC FreeBayes demonstrated high performance samples TA11 TM11 Figure S1 To compare variant caller performances optimized performance conditions determined performances variants called best F1scores different settings samples Notably performance FreeBayes increased substantially CLC slightly performances methods remained similar Figure 5C D Figure S2 Table S6 The callers achieving good recall LoFreq CLC VarScan2 identified 2400 2700 shared true positive SNPs mixed strain samples quality score threshold 20 Figure 6 On pure strain samples SNPs expected LoFreq VarScan2 predicted 61 33 71 42 FPs respectively substantially mixed strain samples 6 Deng et al Figure 5 Comparison variant caller performances samples A B SNPs quality score 20 C D All variants including SNPs InDels threshold quality scores maximizing F1 analyzed RTGtools In scatterplots shapes indicate samples colors variant caller The box boxplots indicates interquartile range colored boxes median black line outliers points outside box caller performances samples A C share figure legend color shape 2 Figure 7A B We signal false LoFreq variants calls MiSeq sequencing data HIV lab data 57 frequency GTGCAC patterns genomes similar Figure S9 Materials methods Creation sequencing HCMV strain mixtures We created mixtures pairs strains TB40E BAC4 AD169 subclone HB5 TA TB40E BAC4 strain Merlin TM For strain pair mixtures different mix ing ratios 11 110 150 created Accordingly strains AD169 Merlin dominant strains mixtures genomes reference variant calling mixed samples In addition pure strains sequenced The mixture specifies included strains mixing ratio For instance mixture TB40E Merlin ratio 110 denoted TM110 Pure strain samples denoted TA10 TB40E TA01 AD169 created protocol 1 details TM10 TB40E TM01 Merlin created protocol 2 Two protocols generate sequencing libraries In protocol 1 DNA TA mixtures TA11 TA110 TA 150 pure strain samples TA01 TA10 extracted BAC host E coli strain GS1783 Plasmid Midi Kit Macherey Nagel Library preparation performed Ultra II FSKit NEB according standard protocol manufacturer Fragmentation time 10 mins library amplified 4 cycles mixtures 5 cycles pure BACs multiplexed sequenced MiSeq Illumina reagent kit v3 generate 2 300 bp pairedend reads Protocol 2 generate TM mixture data sets TM11 TM110 TM150 pure strain samples data sets Merlin TM01 TB40E BAC4 TM10 The HCMV strains TB40E BAC4 Merlin isolated cell cultures The library preparation performed previously described 20 KAPA library preparation kit KAPA Biosystems USA modifications After PCR preamplification 614 cycles adapterspecific primers Evaluating assembly variant calling software strainresolved analysis large DNAviruses 7 Figure 6 Intersection SNPs genomes SNP calls LoFreq VarScan CLC score 20 750 ng DNA target enriched HCMV fragments HCMVspecific RNA baits HCMVenriched libraries indexed amplified 17 20 cycles TruGrade oligonucleotides Integrated DNA Technologies multiplexed sequenced MiSeq Illumina reagent kit v3 generate 2 300 bp pairedend reads Quality control sequencing data Sequencing reads produced MiSeq sequencer qualitycontrolled fastp v0194 58 Fastp allin FASTQ data preprocessing toolkit functionalities including quality control adapter detection trimming error correction sequence filtering splitting The remaining adapter sequences clipped raw reads bases 5cid3 3cid3 reads base quality score 20 Reads shorter 130 bp trimming removed The remaining PhiX sequences originating Illumina PhiX spikein control removed dataset mapping qualitycontrolled reads PhiX reference genome downloaded Illumina BWAMEM v0717 59 Contamination E coli human host removed method Consensus assembly evaluation To benchmark performance commonly assemblers evaluated SPAdes v3120 kmer sizes 21 33 55 77 99 127 careful option metaSPAdes v3120 kmer sizes 21 33 55 77 99 127 Megahit v113 kmer sizes 21 41 61 81 101 121 141 151 Ray kmer size 31 ABySS v214 kmer size 96 IDBA v113 default settings Tadpole v3799 default settings IVA v109 default settings Vicuna v13 default settings The quality resulting contigs scaffolds assessed metaQUAST v502 Only contigs longer 500 bp taken account Since reference genomes strains highly similar ANI 98 unique mappings considered assessment allowing single contig map reference genomes combined reference report The metrics include overall number aligned contigs largest alignment genome frac tion duplicate ratio NGA50 number mismatches 100 kb Here largest alignment refers largest contig scaffold mapped reference genome Genome fraction repre sents fraction genome recovered contigs assembly The duplication ratio total number aligned bases assembly divided total number reference httpsgithubcomablabquast NGA50 N50 value contigs mapped reference genomes contigs split misassemblies The NGA50 value calculated assemblies recover 50 genome terms genome fraction set 0 instead ensure comparability The individual reference report metaQUAST evaluate performance abundant low abundant strains mixtures All overall metrics values regardless specific strain mixture calculated combined reference report metaQUAST NGA50 Haplotype reconstruction Of viral quasispecies assemblers ran PEHaplo v01 Predic tHaplo v04 Savage v040 QuasiRecomb v12 ShoRAH v1995 VirGenA v14 single reference mode default settings details code repository We run HaROLD requires longitudinal clinical samples source The haplotype assemblies evaluated metaQUAST consensus assemblies mentioned A composite quality metric strainresolved assembly To summarize assembly performances defined weighted score based metaQUAST assembly metrics com bined reference including genome fraction largest alignment 8 Deng et al Figure 7 Genomic context LoFreq predictions TA A TM B strain mixtures All genomic context pattern predicted SNPs TP true positive variant calls FP false positive variant calls The 16 mutation contexts mutation type indicated box lower right NGA50 duplication ratio number contigs number mis matches 100 kb As NGA50 available combined reference report metaQUAST average NGA50 based individual genomes individual references report Of metrics considered genome fraction largest alignment important metrics reflect ability assembler reconstruct individual strains To calculate weighted summary score assembler performance weighted metrics factors 03 03 01 01 01 01 genome fraction largest alignment NGA50 duplication ratio number contigs number mis matches 100 kb respectively The score assembler metric formulated based scale average performance spi multiplied factor 10 ensure score range 010 scorei 10 weighti spi Evaluating assembly variant calling software strainresolved analysis large DNAviruses 9 spi scaled performance metric The value scaled 01 minmax normalization defined follows cid2 spi min pi max min max pi max min p bigger better p smaller better In formula pi average performance sam ples given assembler metric min max smallest largest average performance value metric assemblers Determination genome differences strains MUMmer v323 default setting align genomes strains mixture identify differences genomes ground truth Command snps MUMmer package employed determine SNPs short InDels differing aligned genomes parameter setting CTHr repeat regions masked The genomic differences TB40E Merlin considered ground truth variants TM mixtures differences TB40E AD169 considered ground truth TA mixtures Variant calling Qualitycontrolled reads mapped reference genome HCMV strains Merlin AD169 BWAMEM seed length 31 HCMV Merlin AD169 genomes reference genomes major strains mixtures The resulting BAM files deduplicated Picard package httpbroadinstitutegithubiopicard remove possible amplification duplicates bias allele frequency identified variants To compare performance different variant callers LoFreq parameter q 20 Q 20 m 20 VarScan2 minavgqual 20 Pvalue 001 FreeBayes p 1 m 20 q 20 F 001 mincoverage 10 CLC overall read depth 10 average basecall quality 20 forwardreverse read balance 0109 variant frequency 01 BCFtools p 001 ploidy 1 mv Ob GATK HaplotypeCaller minbase qualityscore 20 ploidy 1 identify variants The variants difference genomes detected MUMmer considered positive variants Based standard precision recall F1score computed evaluate callers The pairwise genome differences 30 E coli 30 HIV genomes determined MUMmer To evaluate performance different callers SNP InDel prediction command vcfeval RTGtools 60 generate recallprecision curves based Phred scaled QUAL score field squashploidy f QUAL sample ALT Data code availability The benchmarking program developed study available GNU General Public License V30 httpsgithubco mhzibifoQuasimodo This program assess variant calling assembly results viral mixed strain data sets readme repository details All assem bly variant calling results freely accessible Zenodo 105281zenodo3739874 The sequence data deposited ENA accession number PRJEB32127 Discussion conclusions Mixed infections multiple HCMV strains commonly observed patients active HCMV replication 10 1720 Accurately reconstructing genomic sequences indi vidual haplotypes implications gaining deeper standing viral pathogenicity viral diversity host To identify suitable software analysis mixed viral genome sequencing samples low evolutionary diver gence comparatively large genomes evaluated multiple stateoftheart assemblers variant callers labgenerated strain mixtures HCMV In assembly benchmarking metagenome genome assemblers particular metaSPAdes IVA recov ered abundant strains terms metrics genome fraction contig length mismatches When considering strains low abundance Savage recovered largest fractions underlying genomes reference based mode However achieved highly fragmented manner consistent reports authors Table 3 34 Thus stateoftheart assembly methods including generic metagenome specialized viral quasispecies assemblers reconstruct large viral HCMV genomes low abundance low variant density high quality This surprising programs originally designed primarily mixtures large divergent microbial genomes viral genomes tenth size HCMV genome higher variant density In terms resource usage Ray ABySS produced smallest outputs Megahit memory efficient fastest assembler good performance weighted score 5 Of variant callers LoFreq faithfully identified true variants samples closely followed VarScan2 Both high F1scores samples high mixing ratios When analyzing genomic context predicted variants true positive calls observed context independent enrichment T C C T transitions A preference transitions transversions common molecular evolution 61 62 This case terms observed mutations transitions lead synonymous mutations tend neutral negative selection nonsynonymous changes population level For false variant calls striking enrichment T G changes GG context representing unreported contextdependent signal Calls pattern lower allele frequencies true positive variant calls pronounced sample PCR cycles protocol 2 614 cycles versus 4 protocol 1 indicating link DNA amplification Amplification error introduced PCR cycles accumulate exponentially occur frequencies depend introduced PCRinduced errors lower frequency introduced early amplification cycles 57 Schirmer coworkers studied error profiles amplicon sequencing MiSeq dif ferent library preparation methods showed library preparation method choice primers significant sources bias cause distinct error patterns 63 They observed runspecific preference substituting nucleotide They observed A C prone substitution errors A C C A compared G T differ results We context dependent signal HIV quasispecies data set 10 Deng et al generated Nextera XT DNA Library Prep chemistry Illumina Illuminas MiSeq platform suggesting FP pattern originates step unique HCMV sequencing protocol preamplification amplification PCR library preparation Notably experimental protocols substantially affected nature generated data bioinformatics results Protocol 1 led substantial amplification E coli host DNA lower coverage viral strains This resulting differences actual mixing ratios relative protocol 2 likely explain higher recall slightly lower precision observed variant detection Figure S4 An earlier study based simulated sequencing data showed variant calling lower coverage samples achieved higher recall lower precision 64 Protocol 2 extensive DNA amplification cultivation human cell culture This resulted higher coverage viral strain genomes comparison protocol 1 doubling contextdependent FP variant calls GG context discussed Figure 7 Figure S10 S11 Taken results suggest strain mixtures large DNA viruses low variant density assemblers reconstruct abundant strain high quality assembly low abundant strains challenging Variant callers designed low frequency variant detection provided best results detected true variants These findings rel evant interpretation program outputs analyzing clinical patient samples We provide resource facili tates benchmarking including result evaluation visualization software QuasiModo produced benchmarking data sets results flexible assessment methods similar data sets Key Points The strainresolved novo assembly large DNA virus low variant density challenging evaluated assemblers Some generic meta genome assemblers metaSPAdes IVA performed particularly recovering dominant strain LoFreq VarScan2 good choices identifying low frequency variants strain mixture large DNA viruses The pattern false variant calls likely links experimental protocol generate sequenc ing data More amplification cycles led pro nounced FP variant calls All analyses reproduced QuasiModo developed study QuasiModo uti lized evaluate methods benchmark ing data sets study similar data sets Acknowledgments We thank Dr TillRobin Lesker Susanne Reimer ing helpful comments This work supported German Center Infection Research DZIF Hannover Braunschweig site TI Bioinformatics Platform TTU Infections Immunocompromised Host Deutsche Forschungsgemeinschaft Collaborative Research Center 900 Chronic Infections A Dhingra J Götting supported graduate program Infection Biology Hannover Biomedical Research School References 1 Goodrum F Caviness K Zagallo P Human cytomegalovirus persistence Cell Microbiol 20121464455 2 Griffiths P Baraniak I Reeves M The pathogenesis human cytomegalovirus J Pathol 201523528897 3 Manicklal S Emery VC Lazzarotto T et al The silent global burden congenital cytomegalovirus Clin Microbiol Rev 20132686102 4 Dolan A Cunningham C Hector RD et al Genetic J Gen Virol tent wildtype human cytomegalovirus 200485130112 5 CampilloBalderas JA Lazcano A Becerra A Viral genome size distribution correlate antiquity host lineages Front Ecol Evol 20153728 6 Murthy S OBrien K Agbor A et al Cytomegalovirus distri bution evolution hominines Virus Evol 20195vez015 7 Nichols WG Corey L Gooley T et al High risk death bacterial fungal infection cytomegalovirus CMVseronegative recipients stem cell transplants seropositive donors evidence indirect effects primary CMV infection J Infect Dis 200218527382 8 Manuel O Asberg A Pang X et al Impact genetic poly morphisms cytomegalovirus glycoprotein B outcomes solidorgan transplant recipients cytomegalovirus disease Clin Infect Dis 20094911606 9 Vinuesa V Bracho MA Albert E et al The impact virus population diversity dynamics cytomegalovirus DNAemia allogeneic stem cell transplant recipients J Gen Virol 201798253042 10 AravBoger R Strain variation disease severity congenital cytomegalovirus infection search viral marker Infect Dis Clin N Am 20152940114 11 Datta S Budhauliya R Das B et al Nextgeneration sequenc ing clinical virology discovery new viruses World J Virol 2015426576 12 Liu S Chen Y Bonning BC RNA virus discovery insects Curr Opin Insect Sci 201585461 13 Quick J Loman NJ Duraffour S et al Realtime portable surveillance Nature sequencing Ebola genome 201653022832 Supplementary Data Supplementary data available online httpsacademi coupcombib Conf lict There conf lict 14 Quick J Grubaugh ND Pullan ST et al Multiplex PCR method MinION Illumina sequencing Zika virus genomes directly clinical samples Nat Protoc 201712126176 15 Ali R Blackburn RM Kozlakidis Z Nextgeneration sequenc ing influenza virus short review published implementation attempts HAYATI J Biosci 2016231559 16 MartíCarreras J Maes P Human cytomegalovirus genomics transcriptomics lens nextgeneration Evaluating assembly variant calling software strainresolved analysis large DNAviruses 11 sequencing revision future challenges Virus Genes 20195513864 17 Cudini J Roy S Houldcroft CJ et al Human cytomegalovirus haplotype reconstruction reveals high diversity superinfection evidence withinhost recombination Proc Natl Acad Sci U S A 201911656938 18 Suárez NM Wilkie GS Hage E et al Human cytomegalovirus genomes sequenced directly clinical material vari ation multiplestrain infection recombination gene loss J Infect Dis 201922078191 19 Suárez NM Musonda KG Escriva E et al Multiplestrain infections human cytomegalovirus high genomic diversity common breast milk human immun odeficiency virusinfected women Zambia J Infect Dis 2019220792801 20 Hage E Wilkie GS LinnenweberHeld S et al Char acterization human cytomegalovirus genome diver sity immunocompromised hosts wholegenome sequencing directly clinical specimens J Infect Dis 2017215167383 21 Chou SW Acquisition donor strains cytomegalovirus renaltransplant recipients N Engl J Med 1986314141823 22 PuchhammerStöckl E Görzer I Zoufaly A et al Emergence multiple cytomegalovirus strains blood lung lung transplant recipients Transplantation 20068118794 23 Goldstein RA Tamuri AU Roy S et al Haplotype assignment virus NGS data covariation variant frequencies bioRxiv 2018444877 24 Wilm A Aw PPK Bertrand D et al LoFreq sequencequality aware ultrasensitive variant caller uncovering cell population heterogeneity highthroughput sequencing datasets Nucleic Acids Res 20124011189201 25 Koboldt DC Zhang Q Larson DE et al VarScan 2 somatic mutation copy number alteration discovery cancer exome sequencing Genome Res 20122256876 26 CLC Manuals clcsupportcom 27 Sutton TDS Clooney AG Ryan FJ et al Choice assembly software critical impact virome characterisation Microbiome 2019712 28 Peng Y Leung HCM Yiu SM et al IDBAUD novo assembler singlecell metagenomic sequencing data highly uneven depth Bioinformatics 20122814208 29 Bankevich A Nurk S Antipov D et al SPAdes new genome assembly algorithm applications single cell sequencing J Comput Biol 20121945577 30 Boisvert S Raymond F Godzaridis E et al Ray meta scalable novo metagenome assembly profiling Genome Biol 201213R122 31 Li D Liu CM Luo R et al MEGAHIT ultrafast singlenode solution large complex metagenomics assembly succinct Bruijn graph Bioinformatics 20153116746 32 Aguirre Cárcer D Angly FE Alcamí A Evaluation viral genome assembly diversity estimation deep metagenomes BMC Genomics 201415989 33 Roux S Emerson JB EloeFadrosh EA et al Benchmarking viromics silico evaluation metagenomeenabled estimates viral community composition diversity PeerJ 20175e3817 36 Töpfer A Zagordi O Prabhakaran S et al Probabilistic infer ence viral quasispecies subject recombination J Comput Biol 20132011323 37 Prabhakaran S Rey M Zagordi O et al HIV haplotype infer ence propagating Dirichlet process mixture model IEEEACM Trans Comput Biol Bioinform 20141118291 38 Schirmer M Sloan WT Quince C Benchmarking viral haplotype reconstruction programmes overview capacities limitations currently available pro grammes Brief Bioinform 20141543142 39 Said Mohammed K Kibinge N Prins P et al Evaluating performance tools minority variants genome shortread data Wellcome Open Res 2018321 40 Garrison E Marth G Haplotypebased variant detection shortread sequencing arXiv preprint 201212073907 41 Lai Z Markovets A Ahdesmaki M et al VarDict novel versatile variant caller nextgeneration sequencing cancer research Nucleic Acids Res 201644e108 42 Nurk S Meleshko D Korobeynikov A et al metaSPAdes new versatile metagenomic assembler Genome Res 20172782434 43 Simpson JT Wong K Jackman SD et al ABySS paral lel assembler short read sequence data Genome Res 200919111723 44 Bushnell B BBMap fast accurate spliceaware aligner Lawrence Berkeley National Lab 2014 45 Hunt M Gall A Ong SH et al IVA accurate novo assembly RNA virus genomes Bioinformatics 20153123746 46 Yang X Charlebois P Gnerre S et al De novo assembly highly diverse viral populations BMC Genomics 201213475 47 Zagordi O Bhattacharya A Eriksson N et al ShoRAH esti mating genetic diversity mixed sample generation sequencing data BMC Bioinformatics 201112119 48 Fedonin GG Fantin YS Favorov AV et al VirGenA referencebased assembler variable viral genomes Brief Bioinform 2019201525 49 Mikheenko A Saveliev V Gurevich A MetaQUAST evaluation metagenome assemblies Bioinformatics 201632108890 50 Li H A statistical framework SNP calling mutation discovery association mapping population genetical parameter estimation sequencing data Bioinformatics 201127298793 51 Poplin R RuanoRubio V DePristo MA et al Scaling accurate genetic variant discovery tens thousands samples bioRxiv 2018201178 52 Kurtz S Phillippy A Delcher AL et al Versatile open soft ware comparing large genomes Genome Biol 20045R12 53 LowyGallego E Fairley S ZhengBradley X et al Variant calling GRCh38 assembly data phase 1000 genomes project Wellcome Open Res 20194 50 54 NikZainal S Alexandrov LB Wedge DC et al Mutational processes molding genomes 21 breast cancers Cell 201214997993 55 Alexandrov LB NikZainal S Wedge DC et al Signa tures mutational processes human cancer Nature 201350041521 34 Baaijens JA Aabidine AZE Rivals E et al De novo assem bly viral quasispecies overlap graphs Genome Res 20172783548 56 Gehring JS Fischer B Lawrence M et al SomaticSignatures inferring mutational signatures singlenucleotide vari ants Bioinformatics 20153136735 35 Chen J Zhao Y Sun Y De novo haplotype reconstruction viral quasispecies pairedend read guided path finding Bioinformatics 201834292735 57 Howison M Coetzer M Kantor R Measurement error variantcalling deep Illumina sequencing HIV Bioinfor matics 201935202935 12 Deng et al 58 Chen S Zhou Y Chen Y et al Fastp ultrafast allinone FASTQ preprocessor Bioinformatics 201834i88490 59 Li H Aligning sequence reads clone sequences assem bly contigs BWAMEM arXiv preprin 201313033997 60 Cleary JG Braithwaite R Gaastra K et al Comparing variant files performance benchmarking nextgeneration sequencing variant calling pipelines bioRxiv 2015023754 61 Vogel F Nonrandomness base replacement point mutation J Mol Evol 1972133467 62 Lyons DM Lauring AS Evidence selective basis transitiontoTransversion substitution bias RNA viruses Mol Biol Evol 201734320515 63 Schirmer M Ijaz UZ DAmore R et al Insight biases sequencing errors amplicon sequencing Illumina MiSeq platform Nucleic Acids Res 201543e37 64 Fumagalli M Assessing effect sequencing depth sample size population genetics inferences PLoS One 20138e79667