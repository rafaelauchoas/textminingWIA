ELSEVIER Artificial Intelligence 103 1998 7793 Artificial Intelligence Object identification Bayesian analysis application traffic surveillance Timothy Huang Stuart Russell Computer Science Division University California Berkeley CA 94720 USA Abstract Object fundamental identificationthe allow identity sentences formulated evidence task deciding requirement standard probability grounded identity represented equality operator observed objects fact situated agent reasons individuals predicate calculus terms firstorder concept Raw sensory observations hand essentially theory This paper sensory observations gap We begin defining physical event space probabilities correspond objectis Object essentially propositionalespecially describes patterns reasoning bridging defined We introduce identity criterion selects identity observed objects From able compute objects given stream observations appear subsequent natural mode1 type reasoning We apply appearance observations given current appearance sites theory large numbers freeway network new heuristics objects online learning appearance probability models Despite extremely noisy observations able achieve high levels performance 0 1998 Elsevier Science BV All rights reserved probability objects We cars observed cameras widely separated defines object expected handle inevitable complexity matching task recognizing events probability Kqwordr Object identification Matching Data association Bayesian inference Traffic surveillance This work sponsored JPLs New Traffic Sensor Technology program California PATH MOU 152214 ONR Contract NOO0149710941 Corresponding author Now Department Mathematics Computer Science Middlebury College Middlebury VT 05753 USA 0004370298 PIl SOOO4370298000678 matter 0 1998 Elsevier Science BV All rights reserved 7x 7 Hung S Russell Artd Intelligence 103 1998 7793 1 Introduction Object requirement fundamental identificationthe task deciding situated agent observed objects fact objectis reasons involved individuals Our aim paper establish object identification To avoid possibly theorizing couple investigation real application freeway significance context traffic Each refinement theoretical task Section 2 application We begin general probability identity Section 3 shows provides Bayesian probability Section 4 describes implementation domain Related work discussed foundation expressed terms appearance probabilities Section 5 presents experimental patterns reasoning identification application computing Section 6 economic identification illustrated introduction vehicles framework results 1 I Conceptual theoretical issues central conceptualization The existence individuals world While object recognition deals assigning objects categories 1988 Toyota Celicas adult humans object identiJication deals recognizing ones car ones spouse One specific relations marriage Hence particular objects encounters speaking individuals fairly certain ownership identity specific individuals important Formally identity expressed equality operator firstorder lot interested logic C question possibility Having detected object C parking MyCar Because mistaken probability identity identity PC MyCar 1 available evidence events corresponding There little work question AI 2 The approach Section 2 standard Bayesian approach define event space assign prior condition evidence identify truth identity sentence The key step takes form ident criterion Once formula probability identity way compute available appearance probability This quantity covers diverse domainspecific ranging applicants natural usable motion models require calibration ground truth phenomena changes address credit sensor domain model Section 3 shows natural quantity effects motion pose lighting usual division terms quantities 12 Application The authors participants Roadwatch widearea freeway traffic surveillance control major project aimed automation required 7 Object identification In contrast reasoning category membership based evidence canonical task probabilistic inference Proposing Car small category misses point T Huang S Russell Artificial Intelligence 103 1998 7793 79 h Fig I Images upstream 99 Sacramento California The boxed vehicle identified cameras b surveillance cameras roughly downstream vehicle report stream tracks local IDS matching 2 paths global IDS miles apart Highway Link travel times OD counts tracking software The video streams processed camera site Fig 2 Overall design traffic surveillance running customized parallel hardware The resulting vehicle ordered vehicle reports sent TMC Traffic Management Center The TMC uses reports determine vehicle detected camera reappeared path vehicle travels link travel times OD counts desired The output traffic information display updated real time use traffic operations managers individual drivers These matches build compute freeway network The set paths queried streams chronologically time taken actual timethe link travel total number vehicles measure fixed points freeway network OD countsthe traffic purposes provide travel traveling origindestination points network given time interval The sensors project video cameras placed poles freeway Fig 1 The overall design shown complete Fig 2 In addition realistic microscopic placed traffic patterns The simulator traffic freeway network transmit level management center TMC The reported data corrupted desired includes virtual cameras realtime freeway simulator capable simulating implemented streams vehicle reports vehicles real surveillance second 80 7 Huang S RussellArtijcial Inrelligence 103 1998 7793 noise We simulator surveillance algorithms invaluable tool designing debugging reasons bandwidth In addition feasible Obviously licenseplate reader render vehicle identification measurements rainy foggy nighttime task trivial In fact restricted political technical vehicle reports sent TMC contain communication contained reports bytes information extremely noisy especially conditions Thus thousands vehicles passing camera hour possible matches vehicle This leads combinatorial likely consistent faced assignments radar sonar data association form object tracking Section 6 explores heuristic selecting data association reliable matches This scheme online learning appearance models handle changing viewing traffic conditions yields performance good practical deployment problem arising We adopt solution literature introduce new leaveoneout large sets vehiclesthat similar problemfinding connection Section 5 identification 2 Inferring identity observations This section shows probability identity defined events We begin formal framework illustrate terms physical observations traffic domain 21 Formal Bayesian framework Let 0 random variable domain That particular value 0 correspond objects agent 0 01 o Let oa ob specific observations think having caused objects b 3 Informally write probability identity b Pa b 1 0 01 4 set complete observation histories complete set observations To probability evaluable define event space S HI HN life history kth object universe Hk random variable denoting event Ntuple specifying life history N objects We think index k invisible object identification number We impose prior distribution PS invariant permutation restriction prior exchangeable For purposes paper assume observation exactly physical theory mechanism objects corresponds object This assumption relaxed cost introducing generate observations 4 One tempted write Prc h 1 01 condition conjunction positive conditioning positive vehicles given time place The stated positive past observations negative Obviously observations However conditioning positive observations observations temptation observations assumption reflects natural semiclosedworld negative observationsthat observations assumes assumption future 7 Huang S Russell Artijicial Intelligencr 103 1998 7793 81 indices Also use notation oi E Hk mean observation oi object generated kth object Now key step provide identity criterion select events corresponding b object We write b ti v I E ffk A oh E ffk That observed objects observation generated life history object This basic step relating propositional observations identity sentences Since propositions disjunction mutually exclusive PabI O Pa b 0 P0 1 PO cPoa k E Hc A Co E ffd 0 Conditioning event space S yields Pabl O Po oh E Hk 0 1 sps ds oa ob E Hk shorthand Hk 0 1 s obtain PabI Opo 1 oa E Hk A oh E Hk Finally expand Po oh E P0 lOaobEHksPoaobE Hk lsPsds 1 In way express probability identity given events We framework concrete domain terms probability observations context traffic 22 Identity trufic domuin The basic vehicle identification task involves cameras freeway upstream appropriate downstream The TMC monitors vehicles progress matching upstream observation vehicle appropriate downstream observation natural observation upstream camera U D observations o E U vehicle pair rtu fiu rlf includes time observation r observed values intrinsic location vehicle features parts U observations camera d Each observation history 0 separated downstream corresponds It vehicle color size The holds observation 0 E D vehicle reasonable vehicles place j It assume r unique vehicle places Hk thought trajectory kth vehicle specifying position function time The identity criterion observed vehicles u b b ti vri E Hk A rf E Hk x2 7 Huang S Russell Artificial Intrlligencr 103 1998 7793 Fig 3 Timespace diagrams observations showing In I b b I h possible events twocar universe given observations 0 0 To illustrate Eq I consider simplified case universe contains exactly vehicles similar appearance moving constant velocity road Two reliable cameras located yU yd observations vehicles pass From time t 0 t T observation history 0 consists U oU recorded ta D 1 recorded fb The event space S HI Hz ranges possible 1 UI trajectories 2 IQ yl y2 positions vehicles time tu 1 IQ velocities Fig 3 shows possible events consistent observationsone b h turn defined random variables vehicles It turns easiest compute probability identity ratio Pu b 0 sPs ds Jses Pa b 0 I sPs d7 P 0 term Eq 1 cancels Suppose yd y 2000 meters tb ta 100 seconds Furthermore uniformly uniformly distributed integration ratio given range lo ms 40 ms Then Ps constant range suppose PS yl y2 independently yll yd 1 u2 independently range distributed lid IWfbt vd2lorfI Jlo dwdy2 1 dtht du jfdht dy2 2 Pa b 1 0 l3 3 Appearance models The previous section showed express probability identity terms probability involve observation observations given events Some domains traffic surveillance including initial observations objects subsequent sets contain Huang S Russell Artificial Infelligence 103 1998 7793 83 objects In situations observations objects observed point past expected future provide usable model In section express Eq 1 terms appearance probabilities appearance probabilities define appear point standard motion sensor models specific appearance probabilities vehicle identification domain 3 I Identity terms appearance probabilities Suppose given observation history 0 lJ U D U consists initial objects Keeping observations sets separate Eq 1 gives following objects D consists subsequent observations Pa b 1 U D 1 PU D SC YES k PU D 1 o oh E Hk sPo oh E Hk 1 sPsds Expanding PlJ D 1 oa Ob E Hk s yields 1 PUD PD 1 UOaot E ffkSPU 1 oOb E fs x Poob E ffk 1 sPs ds indicating simply pairing At point define new event space 2 coarsening S First need observations new terms matching generated object For example set subsequent object generated oa Ob Given set initial observations observations assignment spuce Q event space ranges space possible assignments It divides relatively subset effectively condition observationsbecause homogeneous specifies starting point ending point vehicles trajectory space S subsets events subset observation set matchings set The b indicates assignment matching Summing assignments w satisfy identity criterion b gives Pu b I U D 1 PUD c OER abao PD I U wPU I wFw Since principle exchangeability constant given information correspond normalization constant PU D constant requires uniform prior Q P U w U terms grouped outside summation observations observations Pu b U D c CR nbao PD 1 U w Our final assumption specific initial observation matching probability specific subsequent observation given independent observations 84 Z Huang S Russell Artificial Intelligence 103 I 998 7793 observations matchings factor PD U o product individual probabilities This assumption discussed Hence follows 2 PD 1 u w n POi 1 j jEw In expression Po 1 j appearance probability object initially generated observation subsequently write Pod 1 0 confusion possible appearance probability probability j probability generated observation 0 We note It important Eq 2 substituted identity equation PabIUDw c n PoS Ioij 3 wes2 abew ijEw This basic equation use identifying candidate objects matching assignments task essentially based heuristic approximation b E w contains set w E consistent b It shown complexity objects Notice n n I possible unavoidable implementation permanent matrixso involves computing To ground discussion discuss specific observed features appearance probability models traffic domain 32 Observedfeaturesfor traic When certain camera c observes vehicle generates vehicle report consisting Thus observation vector features Currently variousfeatures use features shown Table 1 Table 1 Features vehicle observation reports Name Descriotion Time observation Lane position I 2 3 Distance lane Lateral velocity Forward velocity Vehicle width Sum vehicle length height h Mean vehicle color hue Mean vehicle color saturation Mean vehicle color value Histogram color distribution vehicle uixels u c I Huang S Russell Artijcial Intelligence 103 1998 7793 85 The matching algorithm designed features arbitrary complexity changing algorithm additional In particular informativeness independent specific features new noise level added possible use direct matching vehicle images feature long communication bandwidth available 33 Appearanceprobabilitiesfor trafic The appearance independent models probability currently treated product following l lane x discrete distribution Pxd Ix l size w I multivariate Gaussian d Ww d 1 I wL1 3 0 N t c wd w Id P l color h s v multivariate Gaussian Ph d sd vd 1 hU sl vu NwhsuCh hd hU sd s ud v l arrival time t univariate Gaussians conditioned upstream downstream lane Ptd 1 tU xd x Ngu du td t I The arrival time model particularly vehicle pairs considered important drastically plausible matches The parameters reduces number represent start upstream accurately model example lanes mean standard deviation predicted lane xU end downstream link travel time cars lane xd This allows fact cars carp001 lane travel faster cars Our assumption vehicle trajectories independent little sense traffic fact appearance probability Eq 2 submodel Xd XI kLt arrival time parameterized travel time link Clearly trajectories consecutive cars stream heavy traffic highly correlated current average subsume correlation independent travel time The assumption independence assumption Petty et al 8 work discussed given average travel time identical current average Section 6 distributions In examining empirical probability feature surprised level noise lack correlation different cameras Some features color saturation vehicle width appear virtually uncorrelated In estimate size color features provide 34 bits information appearance measurements 34 Online learning appearance models Because traffic lighting conditions day uses appearance probability model parameters As new change online recursive estimation 86 005 0 005 0 I 015 02 025 03 0 03 025 02 X position upstream camera 015 0 I Data camera 005 0 005 A 01 showing observed upstream downstream xposition data sample 41 matched Fig 4 Top diagram upstream xposition vehicles Mack Road Florin Road cameras The horizontal axis corresponds vertical axis corresponds single matched vehicle Lane dividers shown horizontal vertical lines For example 13 vehicles observed upstream lane 4 onramp highest x values 7 observed downstream Pxd 2 j x 4 054 Boftom upstream downstream hue data sample 25 matched vehicles The color line y x corresponds includes hue saturation value components perfect reproduction hue cameras The appearance probability downstream xposition Each marked point corresponds modeled multivariate Gaussian lane 2 middle lane indicating matches identified vehicle matcher parameters updated based sites Fig 4 shows sample set observed feature values upstream downstream x values matched vehicles Pxd 1 x estimated sample Phd 1 hU estimated To adapt set hue values matched vehicles changing conditions uses online exponential forgetting For example Z Huang S Russell Artcinl Intelligencr 103 lY98 7793 87 new match vehicle travel time t mean travel time updated follows lane xU upstream lane 8 downstream link The parameter ranges 00 1 O controls previous readings given significant weight effective window size The assumes match fact correct In practice certain A better motivated approach model updates weight update probability avoids matching altogether correct An approach match Section 6 described 4 Matching algorithm We begin describing camera detected downstream extension handle onramps offramps simplest case vehicles detected upstream onramps offramps We 41 Matching correspondence The aim pairs vehicles n b Pu b 1 II D 1 E small E We derived Eq 3 quantity certain independence assumptions equation As mentioned computing face intractability shown compute appearance probabilities earlier problem summation involved The core approach observation Cox Hingorani pairing n vehicles time On3 formulating probable assignment problem weighted bipartite matching problem wellknown algorithms task To construct association matrix M appearance probabilities entry 5 Mj lOgPO Or assignment total weight matrix corresponds assignment Eq 2 according probable situation likely assignment For purposes knowing It easily happen c IZ vehicles similar fairly close clique One common example cliques freewaya major airports Given clique size c yellow cabs freeways c assignments probable having clique unreliable employ leuve assignment Since matches oneout heuristic best assignment For forbids forbidden match measure reduction results significant Matches forbidding turn match contained likelihood reduction deemed reliable new best assignment probability roughly leading 88 7 Huang S Russell ArtiJicial Intelligence 103 1998 7793 Downstream rows account entering exiting vehicles Each entry replaced negative logarithmic value Fig 5 Extended association matrix upstream downstream observations columns computing minimum weight assignment showing additional corresponds upstream vehicle question situation appears reasonable assignment For example suppose following association matrix Downstream Upstream n z h c 32 25 127 85 45 73 50 44 50 X b z c y total weight 126 Notice Here best assignment If y closest match leaves good match n y b z c x weight 142 If forbid x best assignment difference t 5 weights greater reliability 142 126 t accept x match reasonable choice exist On hand forbid b z best assignment weight 127 If 127 126 t reject b 2 match b yields t obtain reliable matches good overall assignment By increasing overall number accepted error rate E reduced matches threshold reduces threshold 42 New missing vehicles In general case vehicles appear onramps cameras fail detected upstream add extra rows columns association Equivalently disappear offramps downstream matrix With m upstream n downstream vehicles columns allow possibilities Fig 5 illustrates camera To handle matrix m n rows structure matrix 5 The value compared reliability threshold negative logarithm relative likelihood observations given best assignment observations given best assignment forbidden match T Huang S Russell Arcial Intelligence 103 1998 7793 89 freeway vehicle exits freeway B number cameras unit time Poi refers table explain m n 2 Here CY probability vehicles entering prior probability seeing vehicle features o 6 The formulas fact human observers feel far confident matching unusual vehicles interesting typical vehicles probability confusion vehicles lower upstream vehicle exited replaced vehicle probability unusual appearance discounted extra multiplicative Poi factor unusual vehicle tiny 5 Results We tested vehicle matcher data regionbased vehicle tracker video sequences sites Fig 1 refers fraction proposed matches On given run number matches proposed vehicle matcher depends threshold selected run In results discussed coverage refers reliability fraction vehicles observed cameras matches proposed fact correct In general accuracy threshold coverage goes reliability increased accuracy goes groundtruth matches determined To verify accuracy matcher digitized sequences aid framebased movie viewer Since human viewing match minute video method required 3 hours viewing testing ran matcher vehicle report data framebased movie viewer verify suggested matches correct early stages testing In subsequent Testing involved startup phase estimated appearance Fig 6 trained entered exited freeway probability models online For results shown pair 60second video sequences ran immediately following 60second sequences The sequences contained 29 vehicles detected cameras cameras The resulting 40 vehicles accuracycoverage achieved 100 accuracy coverage 14 50 accuracy coverage 80 To simulate performance freeway sections onramps offramps tracks entering exiting vehicles data stream This makes tried removing problem substantially easier achieved 100 accuracy coverage 37 64 accuracy coverage 80 Fig 6b The boxed vehicles Fig 1 pair vehicles correctly matched curve Fig 6a shows despite noisy sensors Link travel times camera pair currently calculated averaging travel times matched vehicles These times accurate observed distance miles wide range coverageaccuracy suggests matched vehicles representative traffic flowthat process select vehicles biased distribution speeds 1 tradeoff points This matching In implementadon models learned online cy B specific individual lanes 90 Huang S Russell Artzl Intelligence 103 99X 7793 1 b Fig 6 Sample matching values A low threshold high accuracy 40 entering exiting vehicles exiting vehicles removed graphs shows accuracy versus coverage results implies high coverage low accuracy high threshold threshold low coverage Results 60second video sequence containing 29 vehicles detected cameras b Results sequence tracks entering simulate performance freeway sections onramps offramps range reliability implies 6 Related work related literature closely traditional new observations air traffic control typical application The vehicle matching problem tracking data association downstream problem tracks upstream camera camera associated alreadyestablished radar dish determines Radar surveillance approximate position aircraft seconds new set positions large literature data associated set existing associationtypically text BarShalom appear 2 Ingemar Cox 4 surveys Fortmann Fig 5 Coxs integrates developments aim review paper present field vision robotics community resolve problems images moving robot Major identifying visual features seen temporally differences work standard data association timevarying 100 papers year The standard ideas data association include sitedependent 3 recent developments formulas similar tracks There following camera separated deriving 1 Sensor noise bias large unknown dependent sensor observations highdimensional 2 In radar tracking distance moved object observations freeway traffic opposite typically small compared true interobject distances 3 Traffic observations 4 Vehicle trajectories asynchronous traffic highly correlated Section 3 problem dealt approach conditioning link travel time This device prove modelling large systems involving As explained trajectories current average useful applications aggregate parameters Z Huang S Russell Artijicial Inrelligence 103 I 998 7793 91 The closely related work statistical estimation travel time Petty et al 8 travel times ensemble matching detects downstream propagation distinct arrival time patterns estimate They shown possible approach individual vehicles Because loopsthat vehicle Using technique traffic conditions The method intervening onramps offramps instead uses arrival times operate data passage travel times estimated accurately wide range loops fairly close limited induction coils placed road surface indicate approach maintained proportional approximate assignment Hence corresponding sum assignments defined detailed balance transitions exchange pairings We currently collaborating authors ensemble develop approaches overcome shortcomings Ritov use Monte Carlo Markov Chain Eq 3 The states Markov pairs combines The basic idea primarily algorithm chain complete assignments vehicles The transition probabilities fraction time given state occupied probability proposition true Results Jerrum Sinclair particular chain gives polynomialtime This approach fact estimate given b estimated fraction time spent states 6 Monte Carlo method applied convergence travel times OD counts selecting travel time average OD likely vehicle matches simply compute counts assignments visited chain Similarly appearance probability models updated transition assignment correct limit updated models reflect observed data correctly Since changing appearance transition probabilities chain process iterated models changes convergence This instance EM algorithm hidden variables approach link travel times We currently experimenting realtime setting structure Markov chain continually changing new vehicles detected probability average 7 Conclusions work involved establishing patterns reasoning This paper described events correspond identity observations objects We proposed formal foundation based prior space physical events identity criterion defining observations object In case vehicle matching events different given freeway network When single trajectory passes sets trajectories vehicles vehicle observations object This general approach makes possible define probability identity integrate intelligent agent views rational tradition prior beliefs applying Bayesian updating lifetime The general relationship perception formation agent beginning uninformative internal models subject needs investigation This research seen step Carnapian implies observations correspond necessary patterns reasoning 11 92 7 Huang S Russell Arttcial Intelligence 103 1998 77W We showed abstract probability terms measurable appearance probabilities define objects future observed point These appearance probabilities environmentsuch changing weather lighting traffic patterns adapt changing conditions appear point past expected learned online expressed identity We implemented tested complete set recorded paths capable tracking vehicle matching efficient heuristic Despite cameras achieved high level reliable video vehicles enabling build camera data link travel times Although experimental path vehicle time period computed time period For successful long sequence cameras need improve rate tracking subsystem We perform algorithm based bipartite matching combined leaveoneout noisy feature measurements individual matching accuracy based measuring available sequence camera sites Thus OD counts examining OD measurement matching coverage detection crude analysis follows accuracy vehicle OD counts need a9 09 Suppose n 10 To achieve 90 accuracy order x 0988 sufficiently high number tracked vehicles tracked 10 sites sampling error low The required percentage vehicles depend flow rates length reporting period To track 10 vehicles 10 sites need plc9 01 Given p 095 means need achievement 988 accuracy 82 coverage c x 082 Currently simultaneous improved measurement features width feasible However anticipate height provide dramatic improvement include selecting subset pixels rear plane vehicle match feature singlecamera correctly c matching coverage accuracy Other possibilities tracked y1 sites pnancnl rate p probability vehicle matcher vehicle detection coverage independence assuming identification object different The patterns reasoning described broad applicability domains database management For example entity Thus US possible record 500 million creditusing Americans credit reporting agencies problem help maintaining database consistency consolidating multiple databases containing overlapping loo120 million actually distinct individuals Applying approach records correspond problem occurs information References I F Bacchus JY Halpern H Levesque Reasoning noisy sensors situation calculus Proc 14th International San Mateo CA August 1995 pp 19331940 Joint Conference Artificial Intelligence IJCAI95 Montreal Quebec Morgan Kaufmann 2 Y BarShalom MA 1992 Ed Multitarget Multisensor Tracking Advanced Applications Artech House Norwood 3 Y BarShalom TE Fortmann Tracking Dam Association Academic Press New York 1988 4 IJ Cox A review statistical data association motion correspondence techniques International Journal Computer Vision 10 1993 5366 7 Huang S Russell Artcial Intelligence 103 1998 7793 93 5 IJ Cox SL Hingorani An efficient implementation evaluation Reids multiple hypothesis tracking algorithm Jerusalem visual tracking Israel October 1994 pp 437442 Proc 12th IAPR International Conference Pattern Recognition Vol I 6 M Jerrum A Sinclair The Markov chain Monte Carlo method DS Hochbaum Ed Approximation Algorithms NPhard Problems PWS Publishing Boston MA 1997 7 J Malik S Russell Traffic surveillance detection technology development new sensor technology final report Research Report UCBITSPRR976 California PATH Program 1997 8 KF Petty P Bickel M Ostland J Rice Y Ritov F Schoenberg Accurate estimation travel times singleloop detectors Transportation Research 32A I 1998 l17