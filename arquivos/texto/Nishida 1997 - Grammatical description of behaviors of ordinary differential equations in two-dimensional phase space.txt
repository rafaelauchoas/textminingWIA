Artificial Intelligence 91 1997 332 Artificial Intelligence Gxmrnatical description behaviors ordinary differential equations twodimensional phase space Toyoaki Nishida Graduate School Information Science Nara Institute Science Technology 89165 Takayama Ikoma Nara 63001 Japan Received April 1996 Abstract The major task qualitative analysis systems ordinary differential equations rec ognize global pattern solution curves phase space In paper I present av grammar phase space grammatical specification possible patterns solution curves I fiow pattern semisymbolic representation patterns solution patterns phase space important class flow patterns specified flow grammar I flow grammar presented paper generate flow pattern resulting structurally stable flow plane I properties flow grammar related enumeration patterns In particular I estimate upper limit number applications rewriting rules needed derive given flow pattern Finally I flow grammar qualitative analysis plan monitor interpret result numerical computation 1997 Elsevier Science BV Keywords Qualitative reasoning Intelligent scientific computation Dynamical systems theory Flow grammar Flow mapping 1 Introduction In domains behavior differential science technology faced understanding equations The behavior differential equations fairly Email nishidaisaistnaraacjp 00043702971700 1997 Elsevier Science BV All rights reserved PII SOOO437029600055O 4 Z NishidaArtifcial Intelligence 91 1997 332 complex subtle nonlinearity comes play Even small numerical error result entirely different conclusion sensitivity initial conditions In applied mathematics known geometric methods effective qualitative analysis nonlinear differential equations Thus understand qualitative behaviors ordinary differential equations ODES analyzing geometric topological features solution curves phase space 23 I taken geometric approach developed program called PSX2NL 67 Given ODES PSX2NL takes following steps produce semi symbolic description behavior l Step 1 Collect geometric features solution curves varieties quantitative techniques l Step 2 Infer topology phase portrait geometric cues l Step 3 Reason global behavior analyzing topology phase portrait In paper I present Jlow grammar grammatical specification possible patterns solution curves phase space I 0 pattern semisymbolic representation patterns solution patterns phase space important class flow patterns specified flow grammar I flow grammar presented paper generate flow pattern resulting structurally stable flow plane I properties flow grammar related enumeration patterns In particular I estimate upper limit number applications rewriting rules needed derive given flow pattern Finally I flow grammar qualitative analysis plan monitor interpret result numerical computation 2 Qualitative theory ODES qualitative analysis In paper consider systems ODES state variables 2 fx xt Xltd2t t E R fR24t2 1 The space I spanned state variables 1 called phase space Eq phase space righthand 1 said introduce vector jeld Eq 1 specifies velocity state change point phase space A trajectory resulting traversing phase portrait according vector field called solution curve orbit Each orbit represents solution initial IR2 returns condition characterized function t point phase space function time The collection orbits phase space called phase portrait thought introducing flow characterized function ax x E R t c t E R2 lR T NishidaArtcial Intelligence 91 1997 332 5 Fig 1 The phase portrait ECq 2 The following typical ODES investigate paper dx Tit 2x3 2x 2y dY dt _x 2 nonlinear righthand equations general algorithm sense linear differential This x3 Unlike nonlinear ODES analytically fairly complex ory 23 powerful means understanding available form solution terms solving equations studying geometric topological properties phase portrait provides qualitative behaviors ODES explicit In addition certain situations According sides contain nonlinear known behavior nonlinear differential dynamical systems Fig 1 illustrates approximately portion phase portrait Eq 2 number orbits drawn numeric integration according asymptotic Orbits classified t t fco As systems ODES state variables orbits diverge place infinity tend jixed point orbit consisting single point Eq 1 zero limit cycle cyclic orbit makes attracts repels nearby orbits righthand proved behaviors As phase portrait 0O limit cycle 0O long run In sense limit cycle called olimit cycles attract nearby orbits t called alimit cycles orbits tend limit cycle t cm exhibit periodical behavior existence fixed point fixed point limit cycle In contrast Fig 1 conjecture It known 2 This folXows PoincarkBendixson theorem See 3 p 2481 details 6 I NishidaArtijicial Intelligence 91 1997 332 The goal qualitative analysis identify patterns behaviors initial conditions investigating geometric topological properties orbits given ODES We general means representing x explicit function t symbolically manipulating Eq 1 It possible obtain approximate picture orbit numerical integration algorithm RungeKutta algorithm examples paper However numerical methods support small portion entire process understanding behavior pointed 111 Moreover numerical methods result logical errors incompleteness caused numeric errors incompleteness In order supplement numerical methods I propose method representing knowl edge patterns orbits phase space applying planning monitoring interpreting numeric computation The basic idea partition phase space regions called cells characterize fragments orbits region flow flow mappings regions reason global mappings behavior Currently technique handle flow open regions This means method global analysis limited flow bounded region In sections I semisymbolic representation patterns orbits bounded region introduce grammatical specification possible patterns orbits bounded region 3 Semisymbolic description patterns orbits cell We assume cell convex region phase space twodimensional Generally fragment orbit cell C approaches fixed point limit cycle cuts boundary X C t 31 Bundle orbit intervals We contiguous segment orbit orbit interval denote t t E R When end orbit interval 4 fixed point f orbit interval contain f 4t asymptotically approaches f f cc To account extended orbit interval containing ends extend region parameters set real numbers R set hyperreals B R U consider closure orbit interval 4 denoted Given cell C couple orbit intervals contained C define distance d 4 r maximal value minimal distance point orbit interval orbit interval Namely d99 r iff 3uoEBflu ECAuECAIuUIr vuEWuECt3vEIWuECAuur vu E Ru E c 3u E R4u E c A 14u u r T IVishidaArtifcial Intelligence 91 1997 332 U Fig 2 Points contact A bundle orbit intervals cell aggregation nearby orbit intervals cell Namely given cell C orbit intervals 4 9 C consider 4 belong bundle orbit intervals iff positive number E exists orbit intervals yi ym d4syt eAVil ii WI 1 dyiYil 1 Ady E The collection orbit intervals cell classified collection bundles orbit intervals It noted set bundles orbit intervals determined geometric relations flow cell In order compute collection orbit intervals identify following char acteristic points given cell l Fixed points cell type fixed point sink source saddle node l Points contact boundary cell orbit tangent boundary cell lies boundary immediately contact A point contact called concave node orbit passing lies inside region immediately contact shown Fig 2a Otherwise point contact called COMLX nude Fig 2b Those points Fig 2c called point contact orbit point lies different cell l Landmarks points orbit running concave node cuts cell boundary stable unstable manifold saddle node cuts cell boundary We compute location fixed points Eq 1 solving fx o points contact solving fx aO denotes orientation orthogonal boundary edge In order compute location landmarks track orbits saddle nodes concave nodes position cut cell boundary We use numeric integration tracking orbits A contiguous segment cell boundary delimited points contact called boundary segment At boundary segment orientation flow qualitatively 8 K NishidaArtificial Intelligence 91 1997 332 Fig 3 Part flow Fig 1 b Its schematization equally coming going cell A boundary segment called entrance segment exit segment flow coming going cell respectively A boundary segment partitioned boundary edges landmarks boundary segment A boundary segment contain landmarks makes boundary edge The collection orbit intervals makes bundle orbit intervals orbit interval cuts boundary edge Example Let consider flow Fig 1 Fig 3a The flow schematized Fig 3 b The cell contains concave nodes convex nodes partition boundary cell boundary segments AS SB BP R Those boundary segments partitioned boundary edges For example boundary segment A S partitioned boundary edges A Qi R CD R S landmark P R I stands flow cell R inverse image concave node R 32 Flow mappings We represent flow set 0 mappings specifies flow maps point phase space For example consider flow region ABEF shown Fig 3 Some points segment E F mapped fixed point X region come points boundary Although points Z NishidaArtcial Intelligence 91 1997 332 9 open segment t Q F come points boundary source contmuous segment sum open segments P Q S P CD R s m represent flow related I Q F collection seven flow mappings landmarks delimiting t P I S t I PPQ QP SP IPIS GRS lSlR _ ERlRF Thus flow ABEF represented sum sixteen flow mappings follows 3 I I1 AR f RA 12 RSlSlR cJQ BS S B I4 WJ f lPS c EP PE 16 ULQ IQIP 17XQlQ 18ERlRF cR RRlR qS SSJ1S wP PXQ QQ X 3 Generally represent bundle orbit intervals cell C flow mapping u p called generalized source generalized sink respectively They boundary edge fixed point limit cycle orbits cut tend t oo t oo 3 The essential The involve subtlety critical discussion T NishidaArcial intelligence 91 1997 332 Symbolic renresentation I constituents X type fixedpoint source A type convexnode A GR type boundaryedge entrance lR type landmark entrance R S type boundaryedge entrance boundarylist flowmappings A A R R fK1R S R al1 A i9lR R A 9 112 QR R o x1x b Schematic diagram fig 4 The flow pattern local flow region ABEF Fig 3 b 33 Flow patterns We use 0 patterns represent collection orbit intervals cell C collection flow mappings A flow pattern consists l constituents set geometric constituents C fixed points limit cycles convex nodes concave nodes boundary edges landmarks geometric properties l boundarylist counterclockwise order geometric cues cell boundary l jawmappings set flow mappings characterizing flow C I NishidaArtcial Intelligence 91 1997 332 11 Fig 4 shows flow pattern local flow region ABEF Fig 3 b A flow pattern focuses topology shape flow given cell Note exist multiple flow patterns flow cell differ labeling Flow patterns x y said equivalent differ way labels attached The computability complexity generating flow patterns depend class ODES For twodimensional piecewise linear differential equations result approximating occurrence nonlinear terms nonlinear differential equation set connected pieces linear functions process computable 83 For complex classes ODES difficulties arise mainly complete information available complexity mathematical problems encountered 71 This implies procedure fail tries divide phase space uniform regions annotate flow boundary regions Moreover handcrafting procedures deal situations painstaking unmanageably combinations possibilities To overcome difficulties grammatical approach presented section The main stream global analysis merge flow patterns turn examine topological properties resulting flow patterns larger regions Limit cycles detected finite steps far totally contained single region result phase space partition local flows related regions properly analyzed 71 We use heuristics incompleteness Since attracting repelling sets planar ODES fixed points limit cycles fixed points determined analysis local flow gives complete process global analysis theory Of course chance method fail produce incorrect result failure characterizing local flow numerical error This common difficulty encounter addressing nonlinear problems 34 Composition jlow mappings recursive mapping Given couple bundles flow mappings 1 I J 2 J K let define composition 2 o I I 2 2l cD2lx y iff 32 IX z 2Z Yl We grasp behavioral characteristics solution ODES partitioning phase space cells investigating topological structure compositions flow mappings cell We composite flow mapping o o 41 contracting range subset domain recursive mapping tfBrn 0 0Z c I Similarly 0 0 1 extending recursive mapping CjIrn 0 oqhZ 3 I 12 I NishidaArtcial Intelligence 91 1997 332 Existence contracting existence extending recursive mapping entails existence attractor Similarly recursive mapping entails existence repeller 4 Flow grammar A JEow grammar specifies possible regions formal grammar 4 Generally G B D C B set basic Jlow patterns D set distortion rules C set composition rules We flow pattern finite number rules D C flow pattern generated G B D C obtained applying flow grammar flow patterns closed B 41 Flow grammar FG1 In remainder paper particular formulations possible Particularly assume regions fixed points boundary FGl closed structurally stable Moreover limit cycles efficiency Limit cycles handled flow grammar 71 flow grammar called flow flow grammar presented generate algorithm calls given 411 Basic Jlow patterns Basic flow patterns specify type points contact boundary The flow pattern flow patterns contain fixed point We Fig 5 Basic flow patterns Fig 5a basic flow patterns illustrated simplest simplest containing containing fixed points Flow patterns exactly fixed point Fig 5 bd 412 Distortion rules Distortion rules specify flow patterns arising flow boundary segment complex cell We distortion relative geometric relation rules shown Fig 6a increasing sequence concave node convex node ment introduces reverse order number fixed points hot b One introduces 41 wition rules c 1 _ni rules specify way flow patterns fixed point computed We consider flow pattern n n 2 2 fixed points generated fusing couple flow patterns n 1 fixed points 4 The notion flow grammar inspired process grammar 51 5 Structurally stable flows persist infinitesimal perturbation parameters If purpose analyze ODFs physical systems structurally stable systems observed Peixotos theorem suggests fixed points appear structurally stable flows sinks sources saddle points 2 p 601 T NishidaArtijcial Intelligence 91 1997 332 13 Bo fixed points constituents boundaryedge A convexnode AB B convexnode BA boundaryedge entrance exit boundarylist A AB B BA flowmappings AB BA constituents boundarylist flowmappings 2 boundaryedge s fixedpoint Xl A s entrance sink constituents boundarylist boundaryedge s fixedpoint exit source flowmappings s 7i b B sink 1 B source d B saddle 1 constituents boundarylist flowmappings entrance entrance L1 landmark L1 A boundaryedge A convexnode sf fixedpoint L1 mA A L1 A K saddle Fig 5 Basic flow patterns exactly fixed point shown Fig 7 flow patterns P1 P2 fused boundary segments al bl PI P2 In order flow properly fused flow boundary segments 11 bl patterns PI 9 2 b2 complementary outgoing incoming flow PI correspond incoming outgoing flow P2 convex concave node PI correspond convex concave node Pz See Fig 8 At end points ar bi flow patterns shown Fig 9 Note assume cell contain fixed point cell flow patterns resulting fusing flow pattern P containing fixed points generated applying distortion rules P 14 T NishidaArtifcial Inielligence 91 1997 332 lfQTA Ic _ A ____ cvdistortion rn J Iti b vcdistortion l __ _ I _ c effect application distortion rule flow mappings WI CW lb PC DO Fig 6 Distortion rules Fig 7 Composition flow patterns fusing L NishidaArtijicial Intelligence 91 1997 332 15 Fig 8 Conditions fusing couple flow patterns Fig 10 illustrates flow pattern shown Fig 4 obtained applying sequence distortion rules basic flow pattern B Fig 11 illustrates flow patterns formed applying composition rule basic flow patterns B_ FGl introduced far following characteristics Proposition 1 Any Jrow pattern representing structurally stable jlow region twodimensional plane generated FGl jlow contains limit cycle Proof Peixotos theorems endorses simplest flow patterns generated C flow twodimensional plane containing fixed point shown Fig 5 Now suppose given arbitrary structurally stable flow region twodimensional plane containing limit cycle consider process growing fusing small cells fixed points region large region 7 It possible small region fixed point flow pattern conforms basic flow patterns shown Fig 5 microscopic nature C flow relatively simple sense approximated linear flow appropriately small region The distortion rules shown Fig 6 cover situations convex concave nodes introduced complication geometric relation cell boundary flow growing single cells The composition rule shown Fig 7 covers situations flow linked cells El We designed FGl flow pattern contain limit cycles However flow grammar useful qualitative analysis design unmanageably increase number possible flow patterns observation Our program PSX2NL 67 mechanism partitioning 6 See 2 p 601 7 When region contains fixed points start region flow pattern conforms shown Fig Sa 7 NishidaArtcial Intelligence 91 1997 332 1 introduction 01 concave ntxlc E E c 2 deletion convex node E L E 3 merge convex node I I L Fig 9 Four patterns governing fusion flow end points l convex INtiC 0 concave Fig 10 The derivation flow pattern shown Fig 4 drawn schematically T NishidaArtificial Intelligence 91 1997 332 Fig 11 Flow patterns formed basic flow patterns Bk B cell smaller pieces limit cycles contained finds symptom limit cycles piece 42 Indexing jbw parrems We classify We patt sources involved flow patterns number fixed points points contact le called Jrow index index set flow patterns A flow index n n nss n denotes flow number convex nodes concave nodes nsa saddle nodes nSS sinks For example flow index basic flow pattern Bo 2000 B B_ OOO I B 4010 As flow patterns 2011 5 l 2 6 7 9 11 Although index appears shown following property Fig 11 flow 3 8 lo 4211 fourdimensional index flow pattern 12 equally 3111 4 actually threedimensional 18 NishidaArtcial Intelligence 91 1997 332 Proposition 2 For C structurally stable 0 closed region R let number saddle points sinks sources R nsa nSS respectively Let number convex nodes concave nodes boundary dR R n n respectively Then following relation n nc 2 x nsa nss 1 4 Proof We use mathematical process partitioning generating basic flow patterns associated induction prove Eq 4 The idea observe C flow given cell exactly flow pattern applying distortion inverse process rules composition First Eq 4 holds basic flow patterns 8 application distortion Second rule preserves IQ 4 increase number concave convex nodes respectively Third consider apply composition nV2 nc2 nsa2 nSSz assume rule fuse flow patterns 4 Eq flow indices holds Thus nl nl nsal I w ncl 2 x nsal nssl l nv2 k2 2 x h2 nss2 1 5 6 On hand flow patterns Then let n n ss n flow index flow pattern resulting flsai nsa2 nss nssi nSS2 7 8 The number convex nodes concave nodes disappears segments fusion introduced cases n n decreases Hence Fig 8 A new convex concave node Fig 9 In ends segment end points shown fusion shown nc n nt nc2 nt nV2 2 9 From Eqs 59 Eq 4 0 Thus difference number convex nodes concave nodes number sinks sources saddle nodes Given number sinks sources saddle nodes number convex concave nodes flow patterns containing couple flow patterns containing simpler smaller 8 The interested user refer 2 Proposition 184 p 5 11 describes basic properties index fixed points Z NishidaArtcial Inielligence 91 1997 332 19 Fig 12 Minnmal flow patterns derived basic flow patterns applying distortion rule Definition 3 Let flow indices flow patterns n n n pattern g n n A n nh A nsa A nss n respectively A flow pattern c sa nJ f g n n nSa n flow f said simpler Since n n nsar nss computed detecting numerical constraint enumerate follows Eq 4 index 2201 flow patterns efficiently For example nsa nss 1 Thus start enumerating independently errors missing information theorem It n n 2 flow patterns 43 Enumerating jlow patterns The flow grammar presented sense usually exists derivation produces flow pattern In order cope unfortunate property rely generate test method In order decrease previous ambiguous subsection The technique sequence The second cost enumeration use techniques pose constraint sequence derivations derivations eventually technique produces representation flow pattern level described suppress generated Section 52 Definition 4 Flow pattern P minimal flow pattern Q P results applying distortion rule Q As flow patterns shown Fig 11 1 2 4 lo 12 minimal Let consider flow patterns flow index strategy deriving flow patterns flow index n n nsa nss At lirst glance think flow patterns derived firstly deriving minimal applying composition rules n naive procedure fail generate n flow patterns shown Fig 12 The flow pattern shown Fig 12a derived simply applying rule couple basic flow patterns apply distortion composition rule shown Fig 13 rules basic flow patterns applying distortion given values Unfortunately nsar nss repeatedly 20 Z NishidaArtiial Intelligence 91 1997 332 distortion t Fig 13 Example derivation process flow pattern Fig 12a However know upper bound number applications distortion composition rules derive flow pattern given flow index described Proposition 5 Whenever flow pattern c derived applying composition rule flow patterns b internal segment fusion s contains couple convex concave nodes resulting application distortion rules exist otherow patterns b derivable FGl denved application distortion rule ii b equivalent b b couple points contact s iii c derived applying composition rule b Proof Without losing generality assume flow pattern c derived flow patterns b applying composition rule portion interval p segment fusion s shown Fig 142 Consider partitioning c surface s differs s interval p orbits coherently cutting boundary Fig 143 Such partitioning possible continuity C flow Let resulting flow patterns b Fig 14 1 Flow pattern derived applying distortion rule Flow pattern b b points contact interval ap It generated FGl structurally stable flow obtained slightly perturbing interval aP b Proposition 1 holds 0 T NishidaArtifcial Intelligence 91 1997 332 21 b b identical difference q 2 composition I 3 Fig 14 A case flow pattern c results applying distortion rule applying composition rule In case proposition suggests exists alternative way deriving c flow patterns b simpler aad b respectively The flow pattern proposition thought resulting apply ing distortion rule applying composition rule In case proposition suggests exists alternative way deriving c flow patterns u b simpler b respectively Similarly cases application distortion rule immediately prior application composition rule avoided employing alternative simpler derivation process shown Fig 15 Unfortu nately case shown Fig 16 composition occurs boundary edge resulting application distortion rule ways replacing derivation process simpler containing applica tion distortion rule immediately prior application composition rule Thus Proposition 6 We derive allflow patterns application distortion rule pennitted prior application composition rule However noted peculiar cases application dis tortion rule necessary prior application composition rule limited case shown Fig 16 variants In cases number Z NishidaArtQicial Intelligence 91 1997 332 ax 4 Fig 15 Cases application distortion rule immediately prior application composition rule avoided employing alternative simpler derivation process h complex 0 Fig 16 The composition occurs boundary edge resulting application distortion rule ways replacing derivation process simpler containing application distortion rule immediately prior application composition rule cave nodes flow patterns cation distortion fused In addition concave node application total number concave nodes appli rule So introduced composition rule prior T NishidaArtiJcial Intelligence 91 1997 332 23 Proposition 7 A 0 pattern flow index n nc nsa nss derived ap plying distortion rule n times composition rule nsa nss times 44 Evaluation flow grammar requirements General l soundness flow patterns generated flow grammar correspond flow grammar realizable flow l completeness flow patterns corresponding existing flow derived finite steps partly complete way This means unambiguity single flow pattern derived The flow grammar FGl mentioned unambiguous derived use FGl knowledge upper bound number steps derivation We know far enumerate addition need devise algorithm generate consistent observed geometric cues Some kind constraint We idea soundness FGl way sense Proposition 1 case flow pattern redundant computation source predicting behavior Although Proposition 7 suggests effect powerful efficient fashion In set flow patterns satisfaction help positive conjecture unavoidable flow patterns 5 Use flow grammar qualitative analysis flow We implemented algorithm enumerating flow patterns incorporated called PSX2NL 51 Bottomup analysis PSX2NL according prescribed In normal situations PSX2NL examines description given flow fixed points flow bottomup manner attempting fixed sequence PSX2NL build qualitative examines determines type If fixed point given region PSX2NL partitions cells fixed point contained given features flow traces key orbits cell given numerical region qualitative behavior given region Thus abstract description gradually constructed necessary generates properties flow mappings examines integration abstract descriptions set flow mappings derives conclusions geometric investigates region For example Fig 17 illustrates PSX2NL analyzes flow Van der Pols situations PSX2NL derives set flow equation mappings region ABCD 2 3 cell ABEF normal I NishidaArcial Intelligence 91 1997 332 Fig 17 Reasoning qualitative behavior flow mappings Z NishidaArcial Intelligence 91 1997 332 2 CDFQQEC cell FECD By combining sets flow mappings cells PSX2NL obtains _ 2icQ FQ ciVQ DpQ lQf c EQ 1 02FQ c EQ 25 10 11 12 13 Since Eq 13 suggests interval PSX2NL concludes attracting bundle C orbits containing I o Fe 0 lo It follows t 4 orbits passing PoincarBendixon theorem9 limit cycle interval F Q leave exists interval F Q tend transverse orbits passing 52 Topdown analysis PSX2NL If goes wrong standard sequence topdown mode trying turns intractable plausible flow grammar FGl The flow grammar provides PSX2NL observations far As knowledge inter source PSX2NL theoretical analysis process switches pretation uses constraints matches allowing operate topdown manner The topdown analysis consisting basically partially generate test method The input traced orbits estimated set observations location convex concave nodes A flow pattern P interpretation observation 0 set assumptions A 0 P U A An interpre exists observa tation tion smaller set assumptions PSX2NL uses enumerator described previous tion possibly minimal turn seeks minimal interpretation explains flow patterns generate interpreta section observation shown For example given interpretations number observations minimal increase shown minimal simply Whenever PSX2NL detects symptom suggesting given region orbit Focusing observation future limit cycle contained divide region line limit cycle like left resolving ambiguity interesting problem Fig 18 PSX2NL produces Fig 19 Currently PSX2NL interpretation PSX2NL additional First features described predict flow grammar allows PSX2NL existence key orbits plan numerical computation location For example given observation g See 3 p 2481 details loNote tharl om 1Q1020 26 Z NishidaArtijcial Intelligence 91 1997 332 Fig 18 Observation drawn schematically Fig 19 Minimal interpretations observation Fig 18 inferred location ol predicted saddle node fig 20 Planning numerical computation invariant manifolds location Fig 20a PSX2NL predicts illustrated attempts given region narrowing envelop enclosing invariant manifolds infers Fig 20d Fig 20c finally phase space predicted existence saddle node infers Fig 20b boundary location intersect saddle node saddle node associated location saddle node Z NishidaArtijicial Intelligence 91 1997 332 Observation _ j_________ __p t _Q _ 0 _ w __ __ ____ ______ 4 1 c 27 search interpretation frep inferred 1 5 1 5 1 5 1 1 5 b Searching flow patterns explain observation candidates listed simplest ones case equally simple candidates 12 patterns match freps No 1 1 1 5 1 1 5 1 5 1 5 No 2 1 1 5 3 1 5 1 5 3 1 5 1 3 1 5 1 5 3 1 5 1 5 No 3 No 4 5 3 1 5 1 1 1 5 5 3 1 5 1 No 5 5 1 5 3 1 1 1 5 5 1 5 3 1 No 6 5 1 1 5 1 1 5 1 1 5 1 No 7 1 1 5 1 3 1 5 1 5 1 5 31 No 8 5 3 1 1 5 1 1 5 3 1 5 1 No 9 5 1 11 5 1 3 1 5 1 5 3 1 No 10 I 5 1 C 5 3 1 1 5 1 1 5 3 1 No 11 1 5 1 5 3 1 5 1 5 1 5 3 1 No 12 5 1 5 3 1 3 1 5 1 5 3 3 1 candidate No 7 candidate No 9 I 5 I s c In order resolve ambiguity numerical computation planned executed d Candidate No 9 selected plausible interpretation Fig 21 Focusing numerical computation 28 7 NishidaArtcial intelligence 91 1997 332 Symptom unexpected limit cycle detected region divided b Flow region analyzed individually results merged Fig 22 Rearranging analysis process unexpected result obtained Second flow grammar permits PSX2NL focus numerical interpretation computation observation expected computation For upper half resolve example possible Fig 21 PSX2NL plan numerical ambiguity Third lower half Fig 21 flow grammar enables PSX2NL unexpected result analysis process obtained For example symptom unexpected rearrange I NishidaArtificial Intelligence 91 1997 332 29 plausible interpreetation Fig 23 Correcting inconsistency numerical errors observed Fig 22a PSX2NL divide region symbolic existence limit cycle numerical cells computation limit cycle try prove Fig 22b Finally plausible violated numerical plausible interpretation flow grammar helps detect inconsistent For example nonintersection results propose orbits errors Fig 23 In cases PSX2NL suggests numerical constraints To reduce interpretation cost comparing Fig 23 b flow patterns use shorthand representation segment mapped orbit intervals list I form boundary denotes counterclockwise SiXily l segment delimited couple order points If segment B use flow pattern involved xij mapped fromto relative position B counted boundary counterclockwise flow patterns An frep cyclic Each elernent frep corresponds points contact qualitatively boundary interval corresponding positive order current boundary use negative integer si denotes flow comes outside indicating integer segment If fixed point limit cycle orientation flow For example frep flow pattern leaves outside Fig 24 53111515131t511 14 boundary element Note frep set flow mappings variants differ And importantly left future different segment AC second CC uniquely defined existence way fixed points numbered freps More study flow mappings different 53 Implementation issues For procedure illustrated bolic computation act It noted highlevel qualitative previous subsection reasoning procedure work numerical sym inter lowlevel procedures highlevel closely l1 We denote cyclic list consisting xl xn XI n By definition XI xn x2 XnXlXnXIxl 30 T NishidaArtifcial Intelligence 91 1997 332 flow governed b Fig 24 A nonlinear flow flow pattern representing portion dynamical systems lhmy highlevel qualimive nlunelicxl routines I I symbolic algebra lowlevel quantitative Fig 25 A blackboard model basis control scheme PSX2NL produce intensive procedures yield conclusion incomplete need cilitate employed shared memory knowledge The blackboard model makes complete highlevel procedures evidence incomplete provided sense determine accurate answer In order important order avoid missing coupling processes different blackboard model basis control solution sense lowlevel procedures fa levels abstraction Fig 25 Thus scheme KSs contents blackboard library processes sources KSs interact indirectly updating space blackboard possible implement multiple strategies T NishidaArtificial Intelligence 91 I 997 332 31 To allow complex control structure implemented easily employed following features explicit representation control structure blackboard KSs directly access manipulate ii uniform On hand approach representation objects blackboard designing implementing attributevalue pairs PSX2NL following limitations knowledge form KSs terminology designed ii problem solving represented procedural representing objects relations carefully iii attempt incorporate intuitive guidance possibly obtained horizontal coordination problem designing statistics Thus addressed implementing PSX2NE 6 Related work Attempts information incorporate authors constraint orbits partial constraints global lo Unfortunately computational methods developed nonintersection ability reasoning comes flow grammar provide constraints asymptotic behaviors 4 far use limited Their weakness flow patterns aspects geometric reason structure global reasoning symbolically lack adequate global behaviors allowing envisioner representation In contrast means implemented programs based conventional Intelligent analysis nonlinear ODES new field POINCARE 9 analysis nonlinear ODES POINCARE PSX2NL Both POINCARE nonlinear ODES POINCARE PSX2NL The differ intelligent phase portrait analysis analysis addressing program integrates quantitative methods qualitative PSXZNL work planar ODES including supports bifurcation ence POINCARE ogy This leads keeps geometric ample PSX2NL keeps POINCARE derive richer conclusion demonstrated pleteness information external package In contrast PSX2NL grammar consequences topological information previous numerical fixed points switch locating location points orbits Second PSX2NL simulation PSX2NL makes use saves computational First PSX2NL information representation technol resources form For ex abstract essential points orbits analysis incom relies robust approximate method based flow obtained quantitative robust errors For example POINCARE fails POINCABE section Third PSX2NL If package fails observation 32 T NishidaArtificial Intelligence 91 1997 332 A stochastic approach l candidate uniform havior supported mathematical complementary nature theories Since interesting treatment global stochastic approach possesses seek way combining 7 Conclusion I presented aow grammar grammatical specification possible patterns solution semisymbolic studied grammar numerical computation curves phase space I described representation patterns solution patterns properties flow grammar Finally qualitative analysis plan monitor jlow pattern phase space I described flow result interpret An important work left future research extension challenging theoretically extension work higher dimensional secondly far complicated direction flow The research Unfortunately firstly dimensional topological paper help extension flow patterns geometric objects structure flow However believe hard thirdly subtle concepts exploited higher dimensional practically flows trivial higher representing characterize References l J Doyle EP Sacks Stochastic analysis qualitative dynamics Proceedings IJCAI89 Detroit MI 1989 21 J Guckenheimer 11871192 P Holmes Nonlinear Oscillations Dynamical Systems Bifurcations Vector Fields Springer Berlin 1983 3 MW Hirsch S Smale Dierential Equations Dynamical Systems Linear Algebra Academic Press New York 1974 4 WW Lee BJ Kuipers Nonintersection simulation qualitative 5 M Leyton A processgrammar 61 T Nishida S Doshita A geometric approach Proceedings AAAI88 St Paul MN 1988 286290 shape Artif Intell 34 1988 213247 trajectories qualitative phase space global constraint total envisioning Proceedings IJCAI91 Sydney 1991 11501155 7 T Nishida K Mizutani A Kubota S Doshita Automated phase portrait analysis integrating qualitative quantitative analysis Proceedings AAAI91 Anaheim CA 1991 8 1 l8 16 8 T Nishida S Doshita Qualitative analysis behavior systems piecewise linear differential equations state variables Artif Intell 75 1995 329 9 EP Sacks Automatic analysis oneparameter planar ordinary differential equations intelligent numeric simulation Art Intell 48 1991 2756 lo P Struss Global filters qualitative behaviors Proceedings AAAI88 St Paul MN 1988 275 279 111 KMK Yip Generating global behaviors deep knowledge local dynamics Proceedings AAAI88 St Paul MN 1988 280285