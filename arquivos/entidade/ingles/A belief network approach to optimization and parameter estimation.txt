Artificial Intelligence 101 (1998) 135-163 Artificial Intelligence A belief network approach to optimization and parameter estimation: application to resource and environmental management Olli Varis ’ Laborutor?; of Water Resources, Helsinki University of Technolog)? l?O. Box 5300, FIN-02015 HUT, Helsinki, Finland Received 11 January 1996; received in revised form 23 June 1997 Abstract An approach is constructed in optimization to use Bayesian belief networks on resource and environmental management. A belief network a deterministic model, and it is used to update conditional probabilities components at the model components parameter values, and other information used. An iteration scheme was developed posterior distributions information. The scheme can be used in different optimization and optimization between various policy options. Also multiobjective optimization approach Elsevier Science B.V. All rights reserved. is presented, with an illustration to associated with different of that model. The divergence between prior and posterior probability distributions between model structure, to force prior and between different sources of tasks including parameter estimation is possible. The is illustrated with an example on cost-effective management of river water quality. 0 1998 is used as an indication on the inconsistency to become equal. This removes to work parallel inconsistencies Keywords: Bayesian methods; Belief networks; Environmental policies; Hybrid models; Parameter estimation; Probabilistic models; Optimization: Resource management; Water quality 1. Introduction Uncertainty ment. Interest is among the most discussed in probabilistic assessment, topics in environmental and resource manage- risk analysis, and related techniques has grown ’ Email: ovaris@leka.hut.fi. 0004-3702/98/S19.00 0 1998 Elsevier Science B.V. All rights reserved. PM: SOOO4-3702(98)00010-l 136 0. Varis /Arti$cial Intelligence 101 (1998) 135-163 [ 1,5,45]. Probabilistic and risk analyses are increasingly in many countries. Risk-conscious, in the recent years in practical assessment work by international typically rapidly cepted thorities precautionary theory, together with various recently developed computational uncertain in the field. At present, utilized. ac- and by national au- such as the principle have been endorsed by numerous governments. Modern decision for processing to applications are far from being properly known and fully techniques information, provide a wide base for novel, potential approaches organizations risk-averse approaches these opportunities [8,43]: (1) acquisition, can be grouped of information The concept of uncertainty has several facets in this context. From a decision-theoretic presentation, of a given into systems, etc.) and fuzzy set theory, etc.). In this study, Bayesian in three clusters available; issues. Pearl (2) preferences [19] divides computational view, uncertainty and propagation problem; two groups: probabilistic ones (Bayes, Dempster-Shafer, calculus unified approach estimation to have a strong theoretical basis and to provide an theories, and to questions of testing and and (3) structural logic-based to statistical and deterministic logic in rule-based is used because and objectives (monotonous it is known approaches techniques inference, and resource management, is restricted the entire model as a construct have been dominated by classical Bayesian space. In decision the Bayesian analysis to uncertainty considering from the game theory of the 1930s and 1940s [25]. Games evolved against uncontrolled ‘nature’, and abstractions Bayesian decision theoretical [8,16,20]. the applications of Bayesian analysis in which theory, the idea of stem and subjectivity into sequential games trees were developed. [44]. These the late 1960s to the parameter subject into more applicable ones until increasing notice and emphasis concepts were not developed i.e., parameter estimation, theory gradually gained such as decision [9]. Within environmental Further development has been linked with advances in related computational mathemat- impact within intelligence has had a rapidly growing approaches applicable or potentially the last ten ics [2,21,26]. Artificial years. A set of probabilistic, Bayesian-type applica- ble to decision analysis under high uncertainty has emerged [7,19,25,30]. Characteristic of these techniques-known Markov networks, of interdependencies lows construction and to operate interactively application areas, including nition. principle used al- realizable way to many theory, medicine, and pattern recog- as belief networks, causal networks, Bayesian nets, qualitative the network presentation between probabilistic variables. The local-updating influence diagrams, or constraint networks-is In recent years, they have spread quickly of large and densely coupled networks and on-line. fault diagnosis, in a practically reliability According to Bobrow [3], a particularly successful [17,19], which was also used technique has been the belief network and in the present impact on much of approach by Pearl Pauker [30] stated that “. . . Pearl’s formulation has had a revolutionary AI”. As is usual in such techniques, to Bayesian analysis, not only the parameter space (cf. [6,18,27]). probability evident violation of the Kolmogorov strongly argues against subjected to classical theory, different sets of outcomes are allowed for related nodes, yielding an of the Bayes formula, yet Pearl [ 171 hypothesis space-is In contrast “It is not hard to see that this textbook this very axiomatization: the entire model-the study. Szolovits axiomatization is from Pearl. a wider practical 0. Varis/Artijicial Intelligence 101 (1998) 135-163 137 view of probability its most interesting aspects.” Many decision analytic approaches have also been with these ideas (see, for instance, theory presents a rather distorted view of human reasoning and misses in line [4,22,23]). in resource management [17-191, and offered suggestions for making Varis [33] examined Pearl’s methodology and environmen- the approach more suitable for decision analysis tal studies. The suggested approach has adapted ideas particularly from Bayesian decision analysis and from some common practices within the field. The most essential suggestion was that nodes can be linked in two layers: (1) the probabilities of all outcomes (all possible cal- state values) of the each model variable (node) can be propagated using belief-function (algebraic or logi- culus; and (2) the outcomes can be linked using deterministic cal). This implies to updating simulations (such as Monte Carlo analysis) useless. This updating works instantly and does not require off-line simulation In the present is understood as an approximate, numerical approach in different parts of the model, making probabilistic runs. approach, the basic uncertainty that the network the uncertainty propagation equations scheme Yet, several extensions were developed applicability: to it, in order to provide l Direction speci$c link: instead of Milj = Mjli that Pearl uses (e.g., pp. 158-159 and continuation in [ 19]), also Milj # Mjli is allowed. l The link strength approach: one parameter can be used to define the link matrix. between l Negative . Node dependency level: the sum of the link strength parameters of links two variables can also be negative. links: the interconnection to a node define how dependent the node is from the rest of the network. The goal of this study was to formulate and test the use of this approach to look at inconsistencies to a deterministic model and parameter estimation. The basic concept-stemming network parallel the model-is information observations prior and posterior probabilities treatment iteration scheme was developed such as management targets to which the model should be fitted. Inconsistencies indices, are shown by diverging in control variables (such as parameters or, say, wastewater levels). In addition, certain properties of the links are adjusted empirically. An to handle uncertainties between (cost in optimization from the idea of using a belief in different parts of and external etc.) or the model outcomes levels, environmental for this purpose. are concerned, and presentation, listed above (i.e., propagation All three categories of uncertainty jectives and preferences, and structure) are supported. Uncertain using discrete belief-function calculus. As far as the presentation ties in objectives and preferences the use of many concepts of utility information following manner: by a network of conditional assigned number of possibilities one meta-model. ob- is propagated information and analysis of uncertain- domain allows analysis and value-of- in the equations, and second to be dependency between variables. The approach also provides a [34,36,39] within probabilities. This structure allows a degree of belief first, the variables can be linked by deterministic to use models from different modeling analysis. Structural uncertainty in the two-layered model the discrete probabilistic to a deterministic theory, including risk-attitude is handled traditions The approach can also be understood as a generalized, discrete Kalman filter, in which also the state equation uncertainty-the structural uncertainty of the deterministic model- 138 0. Varis /ArtiJicial Intelligence IO1 (1998) 135-163 is estimated. Bayesian filtering approaches bi-directional propagation scheme. influence diagrams [22,23] have been previously [46], but without the structural uncertainty property, and without been used in the The approach is illustrated by a series of numerical examples, and a case study of is in continuum with a number of water policy analysis of a river basin. This work policy studies on resource and environmental management using and developing Bayesian approaches. The methodology decision analysis has included [13,34,35,39,40,42], probabilistic lake water quality management, change studies, and fisheries management. [ 10,311. The applications have been on river basin management, climatic techniques influence diagrams risk analysis [12,37,38,41], belief networks design, global change and knowledge observational engineering including and 2. The uncertainty balance approach Assume that we must solve a complex control and/or diagnosis problem with high uncertainties. The available A balanced view of the problem based on all the information information comes from diverse sources and is contradictory. sources is needed. 2.1. Structure, targets, and uncertainty balance the dynamics of organic pollution We have or we construct a model to describe (the the crucial elements of the problem term model has a slightly different meaning for a statistician and a deterministic modeler, but I try to fuse and merge these two concepts, and try to include both of these meanings in the term model). The model could be, for instance, a set of differential describe general, a relatively a basis for our reasoning. (knowledge, put this diverse, uncertain, which a reasonable compromise be found. that in a river, or in more tool. We want to use this structure as to the model is uncertain. We want to in can and balance between different pieces of information experience, data, goals, etc.). All the information In addition, we have information and dissolved oxygen simple management and contradictory into an analytic that is external information framework equations oriented There are observations and goals (= targets), with other possible external information that can be used together with the model. Technically, two layers that communicate with one another. The deterministic state layer, since it includes the state equations. because from that layer, one can get numerical values for the model variables levels conditional probability distributions the approach divides the model into the layer, (e.g., oxygen layer, consists of a network of approximate, in a river). The other, probabilistic It could also be called the outcome equations constitute for the outcomes. 2.2. Noninformative network implies full balance How to use belief networks to assist in parameter estimation and, more generally, when optimizing that the prior and posterior probability control variables to fulfill the targets defined? The key proposition is distributions of the target variables (observations, 0. Varis /Art@ial Intelligence 101 (1998) 135-163 139 goals, constraints, management distributions of the external to the modeled distributions distributions), by value in analogy between priors and posteriors. and assures in which to any error minimization iteration etc.) should become equal. This information (presented as prior distributions) implies that the joint should be equal as the posterior probability of these variables (appearing that the prior information the priors converge stepwise is properly utilized. This is done to the optimal values. This is procedure; here the error is shown as a difference The belief network is constructed so that if there is no external from the model prediction, are noninformative, distributions the model, or, if there is external uniform distributions. only, this tells us that no information then all the discrete probability information, it agrees fully with the model. information diverging in the network layer consists of uniform is available other than that provided by distributions If the probabilistic 2.3. New information and links induces a need to re-establish the balance using control variables Introduce now a new piece of external, probabilistic information on targets Its probability distribution analysis. the outcomes are the same as in the corresponding model component, but in general probability values become different. is approximated with a discrete distribution in the in which the The probabilistic layer is used to propagate the model. that the model information do not match completely. A controversy exists and it needs to this new information from the uniform distribution throughout indicate deviating Evidently, all distributions and the external be analyzed, and a proper balance should be found. the decision/control This can be done by adjusting variables. They can be, e.g., treatment plants (= control) water in the river (a target again). In the latter, another set of targets may be the costs targets should be parameters used to fit the model to data (= match targets), or wastewater along a river to be upgraded quality involved, and a balanced situation between found. these, typically contradictory to various purification levels to improve According information of the external layer (= posterior distributions) information. This can be achieved by changing calculated by the probabilistic that the joint distributions to the proposition made in the previous section, the balance can be found by to forcing the distributions are equal be uniform. This implies for to that of the modeled until this goal is attained. The form outcomes of the control variables under consideration, can be found. of the posterior distribution gives a clear indication of how these distributions to achieve the balance are the parameters that can be controlled Another set of components If, for instance, a link strength (terms describing how strongly two variables are interlinked. to a including in deterministic model equation = 1, then we assume that this equation If the link strength = 0, then we assume describing these link strengths clearly that the equation influence calculated at the state layer. The lower the link strength is, the further the error bounds are from the expected behavior of the system. The reason tells nothing on the phenomenon. Moreover, this one will be defined mathematically in the next section) corresponding the model uncertainty it should describe. is 100% adequate the phenomenon the probabilities 140 0. Varis /Artificial Intelligence 101 (1998) 135-163 Decision/Control variables Control and adjust the model to meet the targets Other model components Propagate information (iterate until it is - non-informative) Fig. I. Outline of the uncertainty balance iteration. for this is that link strengths enable us to take into account model. the structural uncertainty of the 2.4. Iteration for balance in which propagated to achieve a situation external information of these variables. The search We want probabilistic, distributions (Fig. 1). An intrinsic component of the analysis of the benefit of such analyses interaction with the information available. Therefore, be as interactive as possible and to be operated on-line. the joint probability into control variables distributions equal is done by uncertainty balance of all the prior iteration is the analyst her/himself, because much from and to the approach has been designed in nontrivial problems comes from the learning 3. Computational solution 3.1. Propagation in state layer (outcome layer; deterministic state equations) is usually If the deterministic of uncertainty that can be used propagation approaches series expansion. The more accuracy consider here the first-order approximation, which in many cases is sufficiently For equations deviations of xl, variance of y is state equations are nonlinear, as very often in practice, the analytical too laborious. Yet, there are many approximate [ 11,151. One of the most widely used ones is the Taylor the more terms can be included. We accurate. in output y from its nominal value, caused by for the the first-order approximation . . , x, from their nominal values, the deviations is required, expressing var[y] M evar[xi] i=l 2 . [ 1 1 2 0. Varis /Artijicial Intelligence 101 (1998) 135-163 141 There are two specific cases in which rather practical equations uncertainty of y can be derived: the weighted sums of components of the components. In the case of weighted sums for expected value and and products of powers (2) (3) (4) (5) (6) (7) n Y’C i=l UiXi the mean and the variance can be obtained by n i=l ‘dYl= 2U-f Valxil + 22 i=l i=l j=i+l 2 UiUjCOV[Xi, Xj]. Accordingly, for product and power equations n )I= , “4’ I-I i=l the mean and the variance are UYI = n wilai, i=l var[y] X 2 varlxi] i=l 2 . $y” I ( > The variance equation can be processed of variation (cv) hence, cv2[y] 22 &%v2,xJ in a more convenient form by using the coefficient (8) it was assumed that the model is structurally this Above, does not need to be the case. As will be shown later, an uncertainty estimate can be given of the model structure, expressed as link strength I], a parameter defining a link matrix in the probabilistic to the state layer in the following approximate manner: layer. Details are given in Section 3.3. The link strength can be augmented correct. In the present approach cv’[y] 25 - NY1 fi’ is the coefficient where cv’[y] uncertainty is included. of variation In cv[y] it is excluded. of the model prediction when structural 142 0. V&s /Artijcial Intelligence 101 (1998) 135-163 3.2. Information from state layer to probabilistic layer The normally distribution with n equally all distributions information, level, etc.) differing reveal it in the net. A further, practical probabilistic distribution. This feature layer, as shown later. distributed model prediction likely are uniform. (Fig. 2) is approximated by a discrete in a network with no measured target (measurement, If any external information intervals. Hence, from the model prediction is included, then nonuniform distributions rationale layer is that a vector product of two discrete uniform distributions for using uniform distributions is important when propagating information in the is a uniform in the probabilistic the state layer uses continuous Since discrete form, discrete approximations when taking them as priors to the probabilistic First, define y1 and v2 such that distributions of the continuous and the probabilistic is in random variables are needed is used. layer layer. The following approximation P(4‘ 6 y1) = l/3, P(y1 < y < y2) = l/3. P(y > y2) = l/3. These values can be obtained by, e.g., using standard normal deviates: .Yl = PY - 0.43075., y2 = /_Luv + 0.43070,. (10) (11) In other words, the model prediction three equally used to find the discrete approximation using the intervals obtained above. is approximated here with a discrete distribution with likely intervals. Also other number could be used. These values can then be of the evidence vector e. This will now be made P(el) = P(e < .u), P(e2) = P(VI < e < ~21, P(a) = P(e > y2). These values are used as the evidence vector in the probabilistic layer. 3.3. Propagation in probabilistic layer (belief network) The belief network approach used in the propagation of information layer is based on Pearl’s work [ 191 with a set of extensions Eqs. ( 14)-( 2 1) are adopted from Pearl. (see Introduction). in the probabilistic In precise, (12) The probabilistic layer (belief network) consists of nodes connected with links. Nodes. Each node i in a network contains: l A vector of possible (discrete) outcomes (state values) yi that can be defined as inputs, or they may depend on the outcomes of other nodes. 0. Varis /Artijcial Intelligence 101 (1998) 135-163 143 State layer 3 Equally likely intervals Probabilistic layer 1 0 12 3 4 5 6 0 12 3 4 5 6 y < 2.2 2.2<y<2.0 y>2.8 ----~_ Fig. 2. Discrete approximation of an observation l An evidence vector ei, with probabilities present study, the number of outcomes information (data, targets, etc.) to the model. el , . . , , ek assigned In the is three. The evidence vector transmits external to k outcomes. l A posterior probability distribution Beli . The prior probabilities other parts of the network, yielding assigned to the outcomes are updated with information the posterior probability distribution. linked from link (uncertainty It is defined as the link matrix Milj between Links. A probabilistic another. the conditional probability of i given j. In the simplest case of a unidirectional link matrix equals a Markov chain state transition matrix. information two variables transfers from one node i and j, denoting chain, the link) to layer parallel the distribution to the deterministic of i should preserve the probabilistic uncertainty, of j Since structural distribution increased correspondingly give the strength of each link using a single parameter matrix element separately. The following approach fulfills the moment requirements above. their of the It should be to instead of inserting values for each stated equations describes all except variance. skewness, kurtosis) to the amount of structural uncertainty. It is often practical (expected value, the moments The link strength parameter k x k link matrix Mjli is denoted as ojli, is constructed 11. i # j, or just as q. qjli E [-I, as a function of vii;, which is now A symmetric, used as an input: q>o: q=r=l,. ..,k; 17 CO: q=k-r, r=l,...,k, ~~.~-~[I-[~+~(I-~)]], r>O:q/r; pzO:q#k-r. (1W (13b) The sum of the absolute values of the link strength parameters of all the links a node is not allowed certifies that no evidence leaving to all links entering a node. This twice in the network. The sum of the absolute values to exceed 1. The same applies is counted 144 0. Van’s /Art$cial Intelligence 101 (1998) 135-163 of link strengths the network. For completely ones it is 1. to a node indicates the node’s level of dependency of the other nodes in independent variables, it is 0, and for completely dependent Two Network propagation. called n and h, are computed. The updated belief is obtained as the convolution product of these messages and the prior belief. This approach does not update messages direction the two propagation directions are symmetric. in cases where the propagation is changed. Computationally, likelihood messages, independent When propagating the n messages, all messages coming to a node, say j, from another leaving node i are denoted by ni . For any node, say i, are denoted by pjli and messages by any node i (i < j): node j, preconditioned piii = MjliXi. The likelihood vectors pjli and xi consist of the following elements: (14) (15) For elements Y, the ny message message xi;, .,.i _ , and the evidence e[. is the scaled vector product (joint distribution) of the r r =i = ni,l...i =~ejJq$..j-] (16) where (LI is a scaling constant, scaling incoming message rrlr...i_r the node’s i - 1 predecessors: the sum of the k vector elements of xi to unity. The is the joint distribution of all the messages, piit to pili_1, from I nill...i-l i-l = l-I d,k. k=l (17) Starting from the first node, the ~110 = 1 and nt = et, pzp, 1 = M211nl and so on. is reverse The direction messages coming node j are denoted by Aj . For any node i, preconditioned similar. All the leaving by any node j, with i < j. to node i from node j are denoted by Zitj and messages in the h messages. The rest is computationally Zi(j = A41 jkj. The 1j message is the joint distribution of the message ijlj+t,.,n and the evidence ej. AS = “51 j...n = BejAr\ j+l...n (18) (19) where B is a scaling constant. The incoming message Xjlj+t,,,n messages, t0 Zjln, from the node’s IZ - j successors: Zjlj+l n *~lj+*...n = n 'k'lj. k=j+l is a convolution of all the (20) 0. Varis /Artificial Intelligence 101 (1998) 135-163 14.5 For each node j, the posterior belief distributions Belj can now be calculated on the basis of the prior distribution before and after the node, i.e., vectors Kjlt,,,j-t ej, updating it with the information and Ijlj+t.,,,, respectively: from the sub-network where y is a scaling constant. The same equation can be written as a vector product of the two likelihood messages and the evidence vector: BeIj = ynjll...j-t l ej l ljlj+l...,. (21b) 3.4. Information from probabilistic layer to state layer In the approach proposed, there are two different paths of information from the probabilistic layer to the state layer: l The link strength parameter l The deviations between prior and posterior distributions r is involved in the propagation of uncertainty (9). give important diagnostic about to fulfill given the model. targets, information model distributions. In parameter estimation the posteriors are iterated or other adjustment of the them uniform to make The suggested quadratic/linear is based on comparison of the probabilities of the different outcomes of a control variable. They are iterated to be equal to one another. iteration scheme (22) providing rapid convergence Pr = Wi + a CVi . (Beli - Bel&) 1 Beli - Bel: 1, VT=Qi +b.(Bel:- l/k), (224 (22b) where a and b are convergence parameters, Bel,’ is the posterior probability of outcome r, k is the number of outcomes, pi is the mean of the prior distribution of node i (a control link strength, and * refers to an updated iteration value. This variable), vi is the estimated than iteration scheme was found experimentally parametric approaches such as r-test based iteration. to be markedly more rapid and practical 4. Numerical examples 4. I. Two-directional propagation of uncertainly The uncertainty two-directional scheme of belief networks the following example which, for simplicity, has no state layer. The example comes from fish stock assessment restrictions. Extensive data collection is most often out of the question due to high costs, and indirect data are typically used. This type of data tends to be corrupted by many types of biases. Decisions on allowable catches are needed regularly, typically on an annual basis. to impose proper fisheries is illustrated with that are needed from nature The simplest possible model for the system includes two mutually dependent variables: fish stock and fish catch per fishing unit (e.g., one fishing night; Fig. 3). This dependency of both variables. There are several ways of obtaining is usually used in assessment 146 0. Varis/Artijicial Intelligence 101 (1998) 135-163 Fish Stock Fish Catch o-~ -0 Link Node 0 Fig. 3. Structure of the example model. In general, the links are two-directional. independent and the number of returned taxation are, in relation increase. records of professional information on them. Here, fish stock assessment is based on catch estimates taggings, and the catch assessment on stock estimates and fishermen or enterprises. The outcomes of both variables level, and a 30% to the previous year, say a 30% decrease, an unchanged A methodologically interesting fish stock can be understood consideration, Assessment and resource management feedback from fish catch to fish stock. question arises from the fact that, in the scale under as the cause and fish catch as the effect. from cause to effect and vice versa is clearly a strength in any environmental task. In a longer time frame, over several years, there is also a The following notation is used: e stock is the information taggings, e&ch is the one from taxation records, n is the likelihood message from fish stock to fish catch, h is the one from fish catch to fish stock, M is the link matrix which is equal in both directions, and u and /I are scaling parameters. Now, we obtain variables Be&k the posteriors of the elements from returned and Be&l, r of by WKJC, = P (stock’ 1 e,‘,&,) = a P (stock’)JJ = @&,,khr, B4akh = P(catch’ 1 eitock) = ,f3P(catch’)n” = @,‘,,,hn’. The messages n and ), are JC = M’%tock, 1 = Mecatch. Examine now the propagation (a) The link matrix is as given estO& = (0.1,0.3, 0.6)T, implying that information, (b) Assume scheme with four numerical cases. in Fig. 4, and information from returned taggings is that the stock is likely to grow. instead of stock, exists on catch only. Now e&h = (0.8,0.15, 0.05)T. (c) All the above information is simultaneously available. This controversial informa- tion forces both the belief vectors close to noninformative ones. (d) The evidence vectors support one another. This results a higher belief on increasing would suggest. stocks and catches than the evidence vectors alone 4.2. Two-layered model including deterministic dependencies Let us elaborate equations between practice due to convention, they are known not to describe the above example two variables. Such highly aggregated further to demonstrate transparency requirements, the phenomenon equations in resource constraints etc., although under concern with full certainty. The are often used the use of deterministic 0. Varis/Art@zl Intelligence 101 (1998) 135-1153 147 (a) (b) FISH STOCK y e - 30% 0.1 Same 0.3 + 30% 0.6 Bel h 0.1 0.33 0.3 0.33 0.6 0.33 e y Bel h - 30% 0.33 0.61 0.61 Same 0.33 0.22 0.22 + 30% 0.33 0.16 0.16 (c) y e Bel h - 30% 0.1 0.27 0.61 0.22 Same 0.3 + 30% 0.6 0.43 0.16 0.3 M 0.73 0.13 0.13 0.13 0.73 0.13 0.13 0.13 0.73 / (d) e y Bel h - 30% 0.1 0.07 0.25 Same 0.3 0.25 0.31 + 30% 0.6 0.69 0.43 M 0.73 0.13 0.13 I 0.13 0.73 0.13 0.13 0.13 0.73 FISH CATCH Bel e y Bel e y Bel e y Fig. 4. Propagation of fish stock information mutually supporting (d) information on posteriors. to fish catch (a) and vice versa (b); impacts of controversial (c) and structural (causal) uncertainty in the following manner. involved in the model can be modeled using a belief network Instead of using outcomes yi such as (-30%, Same, +30%), we use now numerical quantities, catch can be done in many ways. One of the standards e.g., for &at& = (70000, 100000, 130000)T. The stock assessment given the is the following stock equation: Ystock = Ycatch m+F F( 1 - ePmPF) the rates: where F is fishing mortality rate and m is natural mortality rate. Use, for example, F = 0.3 and m = 0.1. Using the stock equation, YstoCk = (283 000,404 000, 526000)T. Taking now the evidence vectors and the link matrix from Fig. 4(a), the resulting model is as shown the case in which illustration, to F = 0.5 and m = 0.2, in Fig. 5(c) the rate parameter values have been changed ycatch = (10000, 20000, 30000)‘, to imply a weaker dependency between and in Fig. 5(d) the link matrix has been changed the variables, and e&h = (0.8,0.15, 0.05)T. in Fig. 5(a). For further Fig. 5(b) shows 4.3. Parameter estimation by uncertainty balance This example contains, besides the state and the probabilistic layers, also and decision variables (parameters). To define the state layer, consider targets the (observations), following linear model yi+t =ay;, i = 1,2,3, 148 0. Varis /Art$cial Intelligence 101 (1998) 135-163 (a) y FISH STOCK h Bel e FISH CATCH Bel e (W Y e 194671101~1 Bel h 278 101 0.3 0.3 0.33 361531 0.6 0.6 0.33 /iill f!zJ-q pz.Jq (c) y e Bel h lii’I_i pzJq (4 Y e Bel h M 0.47 0.27 0.27 e Bel . Bel e Y 70000 100 000 130000 Y 70000 100000 130000 Y 10000 20000 30000 Y 10000 20000 30000 Fig. 5. Two-layered propagation layer. examples. Figures in italics: the outcome layer, other figures: the probabilistic Node 2 - Estimated link Node ’ eNode 3 i iziii;de Fig. 6. Structure of the example model. where yi is the model prediction of an observed variable eT at point i , and a is a parameter. the expected value All these variables are normally distributed. The tasks are to estimate (= link strengths). of the parameter a, and to estimate the model’s structural uncertainty These estimates are based on the three observations the structure of the model, and the Microsoft Excel code is given in Fig. 7. et, eg, ez. Fig. 6 presents No external a numerical step, a model probabilistic principle Therefore, changes information. example, In the following, and the propagation the estimation procedure scheme is calculated is present with no observations. As it now includes layer, it takes the form shown in Fig. 8. Due to the discrete approximation is illustrated with stepwise. In the first the state layer and the (Fig. 2), all distributions are uniform if no external information introduced in parameters or initial states introduce no changes is there. in the )52Cz32C,51E:31C(TLUMM=)52C:32C,5lE:3lC(TLUMM=41C=4lC=IRCZi121 ,IE3edoN2D’14B:3D=6C=D2edoN,IeB.- .”“I)52C:32C,51E:3lC(TLUMM:)lll’E~~~O1E01C+9E9C’2c’14B=‘I3c=Q:(/’9E9C-~C1edoN3-YIl)4B(TRQSGC :_vc)1iz(B:9BMUS98=/5.2,’e.3 0,"C0,e,,,))6C5C3CZC(csidotslmon,333,O,“=sC(F=I)ll’ll’tE1COEOC+9EQCl’(/’lOEO1C=~)ll(B:9BMUSbC1B’.)),GG5C~,,2C(csidotsmron,333.0,‘“=5C(F=I)IIE’lll’tCOEO1Ct9ESC’(/llE’llC=~4JC=il3C-) 1lB:W(MUS/l18-.-418’666.0+333&=2/)31C-I(=)),,,GC5C3CZC(csismron,333.0,”bC(F=l?X=1,htgnerts_kml_detareti,=,,,, M=MxIrtamkniL1edoN18911043141                                 150 0. Varis /Artijicial Intelligence IO1 (1998) 135-163 I Fig. 8. The model with no external information. Fig. 9. Propagation through propagated of the observation the n system. eT. A discrete approximation (evidence vector el ) is made, and it is probabilistic but do not influence any of the probability distributions. layer. Changes in link strength values change only values in the link matrices, is included. When adding an observation at any node-say, the same outcomes as were used in the discrete approximation node 1 as an continuous distribution of the observation e; is approximated with a discrete of the in through the network (Fig. 9). Note that the posterior coming up at node 1 (Eqs. (lo)-( 12)). The information (Bels) now equal the n messages, because there is no information in et is included One observation example-the distribution having model output distribution the n message, and is now propagated distributions to the h system. The nonuniform available besides estimation. the model, distributions that there is also other information including Bel4. This feature will be used later in parameter imply More than one observation. approximation is made to the distribution of ez, and the information Now, add an observation into node 3 (Fig. 10). A discrete through is propagated 0. Varh/Artijicial Intelligence 101 (1998) 135-163 151 Fig. IO. Propagation through propagated of the observation e;. A discrete approximation (evidence vector e-3) is made, and it ia the i system. Fig. I I. Propagation through propagated of the observation CT;. A discrete approximation the T system to the direction of node I, and through (evidence vector ez) is made. and it is the h system to the direction of node 3. the network. Correspondingly, we can add an observation to node 2 (Fig. 11). Note that the Bels are no longer equal to either the 7t or the k messages, but their scaled vector product. The posterior of parameter Be14 is again updated. This step estimates Parameter estimation. (1) a value to the parameter and (2) the link strengths between nodes 1 and 2, and nodes 2 and 3 (Fig. 12). The principle used can also be applied to many other optimization tasks, as will be shown in the river example later on. The idea is to obtain such values to the parameter and the link strength that Be14 becomes uniform. Fig. 13 gives a set of examples of possible distributions of Bel4, and of the inference that can be made on the basis of such distributions. Note that when either a parameter value, link strength value, or observed value is changed, values in the evidence vectors are also changed, because the outcome distributions the probability change. 152 Y, Ch”o*i 8.1 Q+al. 1 2.5 0.3 I 0. Varis /Artijkial Intelligence IO1 (1998) 135-163 Observation e*, cka I 2.2 0.3 1 6.3 ch.,. ( 1 0.3 I I Fig. 12. The model after iteration of Be14 to be a uniform distribution. 0 02 04 a6 Q6 1 E(parameter) Link strength too low too high too high too high too low too high OK OK OK too low too high OK Fig. 13. Some example posterior distributions of the parameter distributions. (Be14) and the inference based on these types of 5. A river quality management case 5.1. The management problem and the watershed problem It represents treatment plants a classical This example deals with cost-effective upgrading of wastewater in a river [32]. Priorization problems of this character are of particular and government agencies in countries short of capital. The study including watershed on the basis of ambient water quality criteria. basin management interest to funding organizations example was generated within the context of a comprehensive in Europe [29]. They are in the midst of a very rapid and several former socialist countries including water quality profound has been management. low. At present, change, and past water quality data are of limited validity, yet there is a pressing need for improving water pollution transition process, affecting all sectors of the societies, of ambient and effluent monitoring the integration is undergoing the industry considerable priorization Previously, 0. Varis /Artificial Intelligence 101 (1998) 135-163 153 control. The scarcity of capital suggests treatment on a cost-effective basis [28]. A more detailed documentation given elsewhere the policy of gradual upgrading of wastewater of the study is [34]. to improve A hypothetical watershed is used with ten municipal wastewater the river water quality. Each plant discharges to into tributary. The impact of different ambient water quality criteria and diverse levels are studied under the precepts of cost-effective prioritization of upgrading ranging from no [29,34]. Initially, be upgraded a different investment levels at the plants. A variety of treatment treatment all the plants here are at level 1. is available, (1) to more advanced solutions treatment plants the effluent (level 0), chemical alternatives treatment 5.2. A probabilistic river model Based on the results of the comprehensive water quality management study of the Nitra [ 14,291, an extended Streeter-Phelps model with three state variables River Basin, Slovakia was chosen for this study. The state variables are dissolved oxygen (DO), biological oxygen the steady-state (BOD) and ammonium demand evolution of the river water quality are: (NH4). The state equations that describe dBOD - dt dNH4 - dt = -ktBOD, = +NH4, dD0 ~ dt = -klBOD - k2NH4 + k3(DO, - DO) that are estimated: and k3 is reaeration where r is water travel time, DOs is the saturation ki are three rate parameters oxygenation, equations layer. The probabilistic (Fig. 14(a)). State variables Evidential for states is obtained are analytically information layer rate. The unit of state equations solvable, and their analytical solutions is based on a network corresponding and parameters are represented from field measurements. of DO in water, and k2 is NH4 is mass per time. These are used as the state the river topology as belief network nodes. concentration is BOD oxygenation, kl is divided approach The analysis into two subsequent phases, at both of which the uncertainty iteration is used, balance (Table 1, but the targets, decision variables, Figs. 14(b) and 14(c)). First, the parameter estimation in which the mean values at the state layer are iterated to equal the posteriors. The link strengths of the links link strengths are different is used. The same model the two layers and estimated is performed, including Table 1 Definition of decision (control) variables and targets in the diagnostic and in the policy analysis parts of the study Diagnosis Policy model Decision variables Parameters Dischargers Targets Observed water quality Water quality targets. Target costs 154 0. Varis /Arti$iaE Intelligence 101 (1998) 135-163 Link 0 Total costs fficient purification level Estimated link Non-informative link -- Other link Dewsian node Other node ‘9 ‘y9 Unitcosts ‘_ _ _ - - _ ‘0 Total costs Efficient purification level __. .- Non-informative link Other link Decision node G&-effective purification level NH4 BOD DO NH4 Fig. 14. Probabilistic (b) the diagnostic phase: observations are targets, and model parameters are control variables are, and (c) the policy analysis phase: water quality criteria and total costs are targets, and purification layer of the river model. (a) configuration, levels are control variables. 0. Varis /Artificial Intelligence 101 (1998) 135-163 155 shown in Fig. 14(b) are estimated; equations. their values show the structural uncertainties of the state taking The second phase consists of finding for river water targets for the river and the quality management, costs involved. Now, different (instead of parameters at the previous phase), link strengths are not estimated, and water quality targets together with the target cost level are used as targets (versus observations at the previous phase). the most cost-effective the water quality levels are used as decision variables into account treatment solutions The definition of variables can be changed in the course of the analysis due to the two- directional uncertainty propagation scheme. At the diagnostic phase, both downstream and upstream (n and h, respectively) messages are used. In the policy analysis phase, only the h message going upstream in the diagnosis, all the data and model to meet the balance, hence both propagation directions are used. predictions In the policy analysis phase, the targets influence only the treatment plants downstream of the point at which a target is set. When detecting model prediction, distributions similar to that in parameter estimation. target and is propagated upstream all the way to the posterior levels. This provides a basis for iteration of the treatment plant purification is used. This is because a deviation between the message are iterated induced 5.3. Model versus data: illustration of the approach The model calibration the propagation of evidential for the hypothetical data is shown in Fig. 15. Take an example of in one of the model equations, say (observations) information 15 1 NH4 I 1 2 3 4 5 6 7 8 9 10 Fig. 15. The nominal case. Calibrated stand for observations, link strengths are 0.83 for BOD, 0.87 for DO, and 0.81 for NH4. The dots and the solid line for the calculated level. 90% confidence intervals are also shown. 156 0. Varis /Art@ial Intelligence 101 (1998) 135-163 12 3 4 5 6 7 6 9 10 12345678910 __ I 12 3 4 5 6 7 8 9 IO 12345678910 12 3 4 5 6 7 8 9 l0 12345678910 30 20 10 0 I 100% 60% 60% 40 % 20 % 0% 12 3 4 5 6 7 8 9 10 12345678910 -. wtcome layer ^ t-ToDat.xIIstlc layer . . . . Fig. 16. Propagation posterior distributions of observed (Bels) of the model prediction at different points. in the probabilistic information layer. The columns on the right show the correspondence task. In case B, there is one observation available, and its probability distribution In case A, there are no observations, and there is no information BOD (Fig. 16). We want to know how well the model is modeling our system and we want to be as good as possible. The system reference consists the model/system and the probabilistic in this case of observations. layer consists of uniform distributions, on the success in our modeling is discretized according used as an evidence vector, and this information Case C includes one more observation, which is again discretized Case D includes a series of observations. (scaled vector product) of the Bels to a is based on the iteration of the joint distribution uniform distribution. The more differences there are in the column heights on the right- hand figures, the more misfit there is between model and data. The better the model fit, the lower is its structural uncertainty. (Eqs. (lo)-( 12); Fig. 2). This vector is the net (Fig. 16). and fed into the net. In cases B, C, and D, the parameter estimation to the proposed procedure is propagated throughout 0. Van’s /Artificial Intelligence 101 (1998) 135-163 157 and model We next demonstrate the influence of prior uncertainties (Table 2, Fig. 17). The data may have a low uncertainty, uncertainties is poor. In such a case (case A), the link strengths become of the model becomes high, and the prediction highly uncertain. uncertainty uncertain link strengths are high and prediction has low uncertainty uncertainty high uncertainty If the data have high remains and the mode fit is good, then the (case C). If the data have high and the model fit is good, then the link strengths are high and prediction has and the fit is poor, the link strengths may still be high, but prediction (case B). If the data have low uncertainty low, structural uncertainty fit on posterior but the model fit (case D). The issue becomes more complex if the model has more than one state equation, as is the case with the river model. Here, the state equations are inter-linked for the BOD and NH4 equations must be estimated is in turn. Success BOD and NH4 concentrations first, and thereafter strongly depends on success in the BOD prediction so that the parameters the DO equation the in predicting that the it may often happen the river. However, along Table 2 Different Fig. 17) typical combinations of prior information and their influence on posterior information (cf. Case Priors Posteriors E(data) versm Uncertainty(data) Link strengths Uncertainty E(model prediction) (Model prediction) A B C D low accordance low accordance high accordance high accordance low high low high low high high high high high low high A: cv = 0.28, Links = 0.36 B: cv = 0.42, Links = 0.68 C: cv = 0.28, Links = 0.81 D: cv = 0.42, Links = 0.86 Fig. 17. Example with the BOD equation: The influence of uncertainties on uncertainties in the posterior (cf. Table 2). information and controversies in prior information 158 0. Varis /Artijicial Intelligence 101 (1998) 135-163 the uncertainties the BOD and NH4 data are much higher accuracy and variability of different substances uncertainties within data, due to analytical such conditions, propagated becomes highly uncertain a case, the model structure might no longer be as efficient and another model configuration could be considered, for instance, an empirical model based more strongly on high-quality empirical evidence. the DO in nature. Under of the BOD and NH4 predictions become high and are (state layer) to the DO prediction, which also In such (Fig. 18). This occurs despite good empirical evidence. the state equations than those within throughout Often, for different is used. These values reasons, a prefixed set of parameter values might be used in standard fashion or when the use of literature values would be considered In such a case, the link strength becomes more adequate lower than it would be if empirical parameter values were used, unless they were equal. Accordingly, we pay a price for using standard parameter values under conditions of higher uncertainty than that of empirical parameters. in prediction. occurs if the target economic At the policy analysis phase, the analysis follows the same outline. The largest difference in the example is, however, that link strengths are not estimated at this phase. An interesting level is set too high compared with the ambient phenomenon water quality is looseness targets should be set lower or the ambient targets should be higher, or both should be done to find a single solution. set in the beginning of the upgrading of wastewater targets. The approach does not find a single solution, because provide support in the model can be used of the example-to treatment plants-the To meet the objectives in the targets. Either the economic prioritization there 1 2 3 4 5 6 7 8 9 IO ~ Fig. 18. The DO prediction and/or NH4 predictions have high uncertainty. remains highly uncertain even though DO observations are very accurate, but if BOD 0. Varis /Artijicial Intelligence 101 (1998) 135-163 159 targets. There are many ways of setting water quality targets for ambient water quality and varying targets. The study [34] to produce policy scenarios with diverse economic presents five scenarios: (1) equal purification level (equity to all dischargers, the prevalent paradigm in Western countries); (2) equal improvement (3) minimum concentration level in any part of the river; (4) target(s) at specific point(s) of the river (city, outflow, water intake, recreational area, in all parts of the river; protected site, etc.); and (5) target probability Fig. 19 shows an example of these results, comparing normative levels (frequencies of occurrence; of conventional, and (2). The comparison are imposed improvement to equal purification in river quality standards would be more expensive than an environment-based approach. risk averse approach). two cases from these scenarios strategy, in which all dischargers less and yield (1) I I I c : / 1 2 3 4 5 6 7 8 9 10 1.0 0.5 0.0 1 2 3 4 5 6 7 8 9 10 1 234567 8 9 10 Scenario Normative Actual costs 9.3 I Ambient targets Improve 1 mg/l 1 min [P(target met)] 1 0.31 1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 Scenario Ambient I Actual costs 8.6 Ambient targets Improve 1 mg/l I min [P(target met)] I 0.32 10 ~ I Fig. 19. Sample policy scenarios: comparison of nonnative is more cost-effective optimized than the former. In the upper-left plots, the dots show the target its 90% confidence level, and the dotted lines indicate (above) and ambient-based interval. (below) results. The latter levels, the solid line the 160 0. Varis /Art@%1 Intelligence 101 (1998) 135-163 in the results of these scenarios is the most costly way of improving the studied options, which clearly justifies institutionally is workable the problem and juridically The most important feature level at all plants treatment among whether the prioritization region. is that normative, equal ambient water quality issue is in the countries of the setting. Another 6. Discussion and conclusions An approach to using belief networks for probabilistic modeling is presented. The approach enables updating of uncertainties It is therefore remarkably interactively. approaches requiring off-line simulation in optimization and in dif- rapid, particularly when runs. Approaches and have been criticized as being inaccurate although practicable in many cases, are time-consuming, [ 151. The major disadvantage implementation when approaches, at least at the pilot-study phase docu- labor-intensive computer is the relatively simulation parameter estimation ferent model components compared with conventional such as Monte Carlo simulation, noninteractive, of the proposed approach compared with conventional mented here. simultaneously. included a compromise optimization The proposed approach can be used to detect inconsistencies information in different model components. Possible between Bayesian prior and posterior distributions, feature was used distributions changing network. among different pieces of inconsistency appears as a difference in a given model component. This approach in which prior and posterior to become equal. This can be done by in the belief the values of control variables to develop an optimization linking properties and adjusting of objective are iterated functions The uncertainty balance For instance, approach can handle more in the river basin example, than one objective the management function optimization two objectives: target costs and target ambient water quality. The approach finds (trade-off) between these targets, and can thus be used as a multiobjective or easily comprehensible, that often can be analytically results. The proposed approach allows consideration in practical assessment and policy modeling. Transparency simple constructs simple and well-known and resource management approach. Within environmental ment models are relatively use of relatively a great advantage assurance are often critical points when striving lization of modeling as uncertain constructs. The structural uncertainty models can be linked and fused with other pieces of probabilistic In the management of natural resources and the environment, sectors, common practical manage- solved. The is and quality for the proper, critical attitude and uti- of such models and the can be estimated empirically, conceptual models are often very high or extreme. In the case of probabilistic models, this means that the main concern of the modeling work should be in the tails of probability distributions. Yet, when using and to parametric distributions, distribution of the parameters. the assessment of tails is still more difficult. These problems form of the distribution, attempts are common assumptions the tails are very sensitive In the case of discrete distributions without assumption and there have been innumerable to all probabilistic information. the uncertainties to distribution approaches, 0. Varis /Artificial Intelligence 101 (1998) 135-163 161 these problems by fuzzy set theory, rule-based to overcome approaches. However, increasingly accepted a growing demand for efficient the probabilistic in practice by administrative techniques systems, and many other approach (i.e., in risk analysis) appears to become bodies and policy makers, and there is for handling probabilistic information. for anticipating The belief network approach has, in different versions, been adopted in many fields [3]. sector. that there will be further studies using belief Future shows whether the same will occur in the natural resource and environmental There are strong reasons networks, which may include probabilistic effort and accuracy, compatibility with Bayesian computation decision analysis and expected utility theory together with compatibility with deterministic management models, and of performing versa [24]. the possibility of performing on-line with reasonable to effects and vice two-directional, from causes calculations Acknowledgements Institute This study has been funded and supervised partly by UNUWIDER under the special Finnish Project Fund, which is supported by the Ministry of Foreign Affairs of Finland: and partly by the International for Applied Systems Analysis, Laxenburg, Austria. Many of the basic ideas have been influenced by Sakari Kuikka from Finnish Game and to the supporting criticism of the colleagues at Institute. Fisheries Research the IIASA Water Resources Project, especially to LBszl6 Somlyody, David Yates, Kenneth Strzepek and Ilya Masliev. I also want to thank my colleagues at the Helsinki University and especially Petri Kylmala who gave valuable comments on the concept of Technology for motivation and support. Also I want of link strength parameter and Pertti Vakkilainen to thank the two anonymous referees for their constructive I am grateful comments. References [l] ADB, Environmental Risk Assessment-Dealing Asian Development Bank, Manila, 1990. with Uncertainty in Environmental Impact Assessment, [2] J.S. Breese, R.P. Goldman construction of probabilistic 1579. and M.P. Wellman, and decision models, IEEE Trans. Syst. Man Cybemet. 24 (11) (1994) 1577- section on knowledge-based Introduction to special [3] D.G. Bobrow, Artificial Intelligence in perspective: a retrospective on fifty volumes of the ArtiJiciul Intelligence Journal, Artificial Intelligence 59 (1993) S-20. [4] R.T. Clemen, Making Hard Decisions, PWS Kent, Boston, MA, 1991. [S] P. De Jongh, Uncertainty in EIA, in: P. Wathem (Ed.), Environmental Impact Assessment: Theory and Practice, Routledge, London, 1988, pp. 62-84. [6] J. Gordon and E.H. Shortliffe, A method of managing evidential reasoning in a hierarchical hypothesis space. Artificial [7] E.J. Horwitz, Intelligence 26 (1985) 323-357. J.S. Breese and M. Henrion, Decision Intemat. J. Approximate Reasoning 2 (1988) 247-302. theory in expert systems and artificial intelligence. 181 R.A. Howard, The foundations of Decision Analysis, [9] C. Howson and P. Urbach, Bay&an [IO] H. Koivusalo, 0. Varis and L. Somlybdy, Water Quality of Nitra River, Slovakia-Analysis in science, Nature 350 (1991) 371-374. reasoning IEEE Trans. Syst. Sci. Cybemet. 4 (1968) 21 l-219. of Organic Material Pollution, WP-92-084, International Institute for Applied Systems Analysis, Laxenburg, 1992. 162 0. Van’s /Artijcial Intelligence IO1 (1998) 135-163 [l 11 G.A. Kern and T.M. Kom, Mathematical Handbook for Scientists and Engineers, McGraw-Hill, New York, 1968. [ 121 S. Kuikka and 0. Varis, Use of Bayesian Influence Diagram in Fisheries Management-the Baltic Salmon Case, C.M. D:5, International Council for the Exploration of the Sea, 1992. [ 131 S. Kuikka and 0. Vatis, Uncertainties of climatic change impacts in Finnish watersheds: a Bayesian network analysis of expert knowledge, Boreal Environm. Res. 2 (1997) 109-128. [14] I. Masliev and L. Somly&ly, Uncertainty Analysis and Parameter Estimation for a Class of River Dissolved Oxygen Models, WP-94-9, International Institute for Applied Systems Analysis, Laxenburg, 1994. [15] M.G. Morgan and M. Henrion, Uncertainty, A Guide to Dealing with Uncertainty in Quantitative Risk and Policy Analysis, Cambridge University Press, Cambridge, MA, 1990. [16] D.W. North, A tutorial [17] J. Pearl, Fusion, propagation, [ 181 J. Pearl, On evidential [19] J. Pearl, Probabilistic Reasoning Kaufmann, San Mateo, CA, 1988. introduction to Decision Theory, IEEE Trans. Syst. Sci. Cybernet 4 (1968). and structuring in belief networks, Artificial Intelligence 29 (1986) 241-288. reasoning in a hierarchy of hypotheses, Artificial Intelligence 28 (1986) 9-l 5. in Intelligent Systems: Networks of Plausible Inference, Morgan [20] H. Raiffa, Decision Analysis, Addison-Wesley, Reading, MA, 1968. [21] S. Russell and P. Norvig, Artificial Intelligence: A Modem Approach, Prentice-Hall, Englewood Cliffs, NJ, 1995. [22] R.D. Shachtcr, Evaluation of influence diagrams, Oper. Res. 34 (1986) 871-882. [23] R.D. Shachter, Probabilistic [24] R.D. Shachter and D.E. Heckerman, Thinking backward inference and influence diagrams, Oper. Res. 36 (1988) 589604. for knowledge acquisition, AI Magazine 8 (1987) 55-61. [25] G. Shafer, Decision making, in: G. Shafer and J. Pearl (Eds.), Readings in Uncertain Reasoning, Morgan Kaufmann, San Mateo, CA, 1990, pp. 61-67. [26] G. Shafer and J. Pearl (Eds.), Readings [27] P.P. Shenoy and G. Shafer, Propagating in Uncertain Reasoning, Morgan Kaufmann, San Mateo, CA, 1990. IEEE Expert (Fall 1986) belief functions with local computations, 43-52. [28] L. Somlyody, Quo vadis water quality management in Central and Eastern Europe?, Water Sci. Technol. 30 (1994) 1-14. [29] L. Somlybdy, WP-94-40, I. Masliev, P. Petrovic and M. Kularathna, Water Quality Management Institute for Applied Systems Analysis, Laxenburg, 1994. International in the Nitra River Basin, [30] P. Szolovits and S.G. Pauker, Categorial and probabilistic reasoning in medicine revisited, Artificial Intelligence 59 (1993) 167-l 80. [31] A. Taskinen, 0. Varis, H. Sirvio, J. Mutanen and P. Vakkilainen, Probabilistic uncertainty assessment of phosphorus balance calculations in a watershed, Ecol. Modelling 74 (1994) 125-135. [32] R.V. Thomann, Systems analysis (Ed.), Systems Analysis 25 year retrospective, in Water Quality Management Pergamon, Oxford, 1987, pp. 1-14. in water quality management-a in: M.B. Beck [33] 0. Varis, Belief networks for modeling and assessment of environmental change, Environmetrics 6 (1995) 439-144. [34] 0. Varis, A Belief Network Approach to Optimization Environmental Management Models, WP-95-11, Laxenburg, 1995. [35] 0. Varis, Interconnections forces, impacts, and policy tools, in: Proceedings Development October 20-23, 1997, Graphlink, Kathmandu, 1997. [36] 0. Varis, Bayesian decision analysis for environmental on water, food, poverty, and global urbanization: a qualitative analysis on driving International Conference on Large Scale Water Resources in Developing Countries: New Dimensions of Prospects and Problems, Kathmandu, Nepal, and Parameter Estimation and for Applied Systems Analysis, in Resource International Institute and resource management, Environmental Modeling and Software 12 (1997) 177-185. [37] 0. Varis, J. Kettunen and H. Sirvio, Bayesian influence diagrams in complex environmental management including observational design, Comput. Statist. Data Anal. 9 (1990) 77-91. [38] 0. Varis and S. Kuikka, Analysis of Sardine Fisheries Management on Lake Kariba, Zimbabwe and Zambia-Structuring and Analysis Institute for Applied Systems Analysis, Laxenburg, 1990. of a Bayesian Influence Diagram Model, WP-90-48, International 0. Varis /Artijicial Intelligence 101 (1998) 135-163 163 [39] 0. Varis and S. Kuikka, Joint use of multiple environmental assessment models by a Bayesian meta-model: the Baltic salmon case, Ecol. Modelling 102 (1997) 341-35 1. [40] 0. Varis and S. Kuikka, BeNe-EIA: a Bayesian approach to expert judgment elicitation with case studies on climatic change impacts on surface waters, Climatic Change 37 (1997) 539-563. [41] 0. Varis, B. Klove and J. Kettunen, Evaluation of a real-time forecasting system for river water quality- a trade-off between risk attitudes, costs and uncertainty, Environm. Monit. Assessment 28 (1993) 201-2 13. Baltic Salmon Case, [42] 0. Varis, S. Kuikka and J. Kettunen, Belief Networks in Fish Stock Assessment-the C.M. D: 13, International Council for Exploration of the Sea, 1993. [43] 0. Varis, S. Kuikka and A. Taskinen, Modeling for water quality decisions: uncertainty and subjectivity in information, in objectives, and in mode1 structure, Ecol. Modelling 74 (1994) 91-101. [44] A. Wald, Statistical Decision Functions, Wiley, New York, 1950. [45] WCED, Our Common Future: Report of the World Commission on Environment and Development, Oxford University Press, Oxford, 1987. [46] F.H. Zeitz III and P.S. Maybeck, An alternate algorithm for discrete-time filtering.. IEEE Trans. Aerosp. Electr. Syst. 29 (1993) 1123-l 135. 