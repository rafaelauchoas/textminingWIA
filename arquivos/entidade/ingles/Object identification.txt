ELSEVIER Artificial Intelligence 103 (1998) 77-93 Artificial Intelligence Object identification: a Bayesian analysis with application to traffic surveillance * Timothy Huang ’ , Stuart Russell * Computer Science Division, Univer.sity of California, Berkeley CA 94720, USA Abstract Object a fundamental identification-the that allow identity sentences when formulated as evidence task of deciding requirement in standard probability to be grounded identity, as represented by the equality operator between that two observed objects are in fact one and the for any situated agent that reasons about individuals. in predicate calculus, two terms a first-order concept. Raw sensory observations, on the other hand, are essentially theory. This paper in sensory observations, the gap. We begin by defining a physical event space over which probabilities that correspond same object-is Object is essentially propositional&especially describes patterns of reasoning thereby bridging are defined. We then introduce an identity criterion, which selects to identity between observed objects. From this, we are able to compute two objects are the same, given a stream of observations that any that the to appear at subsequent is a natural mode1 for this type of reasoning. We apply in a appearance observations given its current appearance, sites the theory large numbers freeway network, with new heuristics of objects and with online learning of appearance probability models. Despite extremely noisy observations, we are able to achieve high levels of performance. 0 1998 Elsevier Science B.V. All rights reserved. the probability of many objects. We show cars observed by cameras at widely separated which defines how an object can be expected to handle the inevitable complexity of matching to the task of recognizing those events probability, Kqword.r: Object identification; Matching; Data association; Bayesian inference; Traffic surveillance * This work was sponsored by JPL’s New Traffic Sensor Technology program, by California PATH under MOU 152/214, and by ONR Contract NOO014-97-1-0941. * Corresponding author. ’ Now at the Department of Mathematics and Computer Science, Middlebury College, Middlebury, VT 05753, USA. 00043702/98/$ PIl: SOOO4-3702(98)00067-8 -see front matter 0 1998 Elsevier Science B.V. All rights reserved 7x 7: Hung, S. Russell /Art@d Intelligence 103 (1998) 77-93 1. Introduction Object requirement a fundamental identification-the task of deciding for any situated agent that two observed objects are in fact one and the same object-is that reasons involved about individuals. Our aim in this paper is to establish in object identification. To avoid possibly empty theorizing, we couple this investigation with a real application in freeway significance: in the context of this traffic. Each refinement of the theoretical task. Section 2 application. We begin with a general the probability of identity. Section 3 shows provides a Bayesian how this probability and Section 4 describes our implementation. domain. Related work is discussed foundation can be expressed in terms of appearance probabilities, Section 5 presents experimental the patterns of reasoning to the identification in the application for computing in Section 6. of economic identification is illustrated introduction of vehicles framework results 1. I. Conceptual and theoretical issues is central to our conceptualization The existence of individuals of the world. While object recognition deals with assigning objects to categories, such as 1988 Toyota Celicas or adult humans, object identiJication deals with recognizing such as one’s car or one’s spouse. One can have specific relations it is often or marriage. Hence, particular objects one encounters. speaking, to individuals, to be fairly certain about such as ownership the identity of the specific individuals, important Formally identity is expressed by the equality operator of first-order lot, one might be interested logic. in whether C = this becomes a question of the is always a possibility, Having detected an object C in a parking MyCar. Because mistaken probability of identity: what is identity P(C = MyCar 1 all available evidence)? the events corresponding There has been little work on this question in AI. 2 The approach we will take (Section 2) is the standard Bayesian approach: define an event space, assign a prior, condition on the evidence, and identify to the truth of the identity sentence. The key step is the last, and takes the form of an ident& criterion. Once we have a formula for that are the probability of identity, we must find a way to compute is the available appearance probability. This quantity, which covers diverse domain-specific ranging applicants, seems to be more natural and usable motion models, which require calibration against ground truth. phenomena to changes of address of credit into sensor and in the domain model. Section 3 shows that one natural quantity of interest from the effects of motion, pose, and lighting than the usual division it in terms of quantities 1.2. Application The authors are participants in Roadwatch, of wide-area freeway traffic surveillance and control a major project aimed at the automation is required [7]. Object identification * In contrast, reasoning about category membership based on evidence is the canonical task for probabilistic inference. Proposing that &Car is just a very small category misses the point. T Huang, S. Russell /Artificial Intelligence 103 (1998) 77-93 79 (a) (h) Fig. I Images from upstream 99 in Sacramento. California. The boxed vehicle has been identified at both cameras. (b) surveillance cameras roughly (a) and downstream vehicle report stream tracks with local IDS matching e.g. a = 2 paths with global IDS two miles apart on Highway Link travel times O/D counts tracking software system. The video streams are processed at each camera site by Fig. 2. Overall design of our traffic surveillance running on customized parallel hardware. The resulting vehicle ordered vehicle reports are sent to the TMC [Traffic Management Center). The TMC uses these reports determine when a vehicle detected at one camera has reappeared up a path for each vehicle as it travels through link travel times and O/D counts as desired. The output of the system is a traffic information display, updated real time for use by traffic operations managers or by individual drivers. to at another. These matches are used to build to compute in the freeway network. The set of paths can be queried streams of chronologically time taken actual time-the link travel total number of vehicles first, to measure two fixed points on the freeway network; (O/D) counts-the for traffic for two purposes: to provide to travel between traveling between any two origin/destination points on the network in a given time interval. The sensors used in this project are video cameras placed on poles beside the freeway (Fig. 1). The overall system design is shown a complete in Fig. 2. In addition in realistic microscopic that can be placed anywhere on traffic patterns. The simulator to the traffic the freeway network and that transmit level of management center (TMC). The reported data can be corrupted by any desired includes virtual cameras real-time freeway simulator capable of simulating system, we also implemented streams of vehicle reports several hundred vehicles to the real surveillance and second, 80 7: Huang, S. Russell/Artijcial Inrelligence 103 (1998) 77-93 noise. We found the simulator surveillance algorithms. to be an invaluable tool for designing and debugging the reasons, bandwidth, In addition, this is not feasible. Obviously, a license-plate reader would render the vehicle identification the measurements in rainy, foggy, and night-time task trivial, but In fact, because of very restricted for political and technical the vehicle reports sent to the TMC can contain only about communication contained in the reports one hundred bytes of information. are extremely noisy, especially conditions. Thus, with thousands of vehicles passing each camera every hour, there may be many possible matches for each vehicle. This leads to a combinatorial most likely consistent to that faced in assignments in radar and sonar data association, a form of the object from the tracking. Section 6 explores heuristic for selecting data association reliable matches. This, together with a scheme for online learning of appearance models to handle changing viewing and traffic conditions, yields a system with performance good enough for practical deployment problem arising in more detail. We adopt a solution literature, but also introduce a new “leave-one-out” two large sets of vehicles-that is very similar problem-finding this connection (Section 5). identification between 2. Inferring identity from observations This section shows how the probability of identity can be defined and events. We begin with the formal framework and then illustrate in terms of physical it in the observations traffic domain. 2.1. Formal Bayesian framework Let 0 be a random variable whose domain That is, any particular value of 0 might correspond objects made by some agent: 0 = (01, . . , o,}. Let oa and ob be two specific observations made, which we may think of as having been caused by objects a and b. 3 Informally, we may write the probability of identity of a and b as P(a = b 1 0 = (01, . . , on)). 4 is the set of complete observation histories. to the complete set of observations of To make this probability evaluable, we define an event space S = (HI, , HN), where the “life history” of the kth object in the universe, each Hk is a random variable denoting and each event is an N-tuple specifying the life history of all N objects. We can think of the index k as an invisible “object identification number”. We impose a prior distribution P(S), i.e., invariant under any permutation of with the restriction that the prior is exchangeable, ’ For the purposes of this paper, we will assume that each observation to exactly one physical into the theory the mechanism whereby objects corresponds object. This assumption can be relaxed, at the cost of introducing generate observations. 4 One is tempted to write this as P(rc = h 1 01, , on), i.e., to condition on a conjunction of the “positive” is not the same as conditioning on both positive of no vehicles at a given time and place. The that the stated positive are all that have been made in the past, and that all other observations were negative. Obviously, observations. However, conditioning on the positive observations observations temptation observations one does not make this assumption reflects a natural “semi-closed-world” and negative observations-that is, observations one assumes assumption: the future. regarding therefore 7: Huang, S. Russell /Artijicial Intelligencr 103 (1998) 77-93 81 indices. Also, we will use the notation oi E Hk to mean that observation oi was object generated by the kth object. Now the key step is to provide an identity criterion to select those events corresponding to a and b being the same object. We write this as a = b t--i v [(%I E ffk) A (oh E ffk)] That is, the two observed objects are the same if each observation was generated by the life history of the same object. This is the basic step in relating propositional observations to identity sentences. Since the propositions in this disjunction are mutually exclusive, we have P(a=bI O)= P(a =b, 0) P(0) 1 = - P(O) cP((oa k E H/c) A Co/, E ffd, 0). Conditioning on the event space S yields P(a=bl O)=- P(o,, oh E Hk> 0 1 s>p(s) ds where oa, ob E Hk is shorthand Hk, 0 1 s) to obtain P(a=bI O)=po 1 for (oa E Hk) A (oh E Hk). Finally, we expand P(o,. oh E P(0 lOa,obEHk.s)P(oa,obE Hk ls)P(s)ds. (1) In this way, we express the probability of identity given events. We now make this framework more concrete domain. in terms of the probability of observations in the context of the traffic 2.2. Identity in the trufic domuin The basic vehicle identification task involves two cameras on a freeway, one upstream the appropriate and one downstream. The TMC monitors a vehicle’s progress by matching upstream observation of the vehicle with the appropriate downstream observation. natural to keep the observation upstream camera U) and D (observations o/’ E U of vehicle i is a pair (rtu, fiu), where rlf’ includes time of observation, while r to observed values of intrinsic the location of the vehicle and the features of the in two parts, U (observations camera d). Each observation history 0 separated by downstream corresponds It is by vehicle, such as color and size. The same holds for observation 0; E D of vehicle reasonable nor can two vehicles be in the same place at once. j. It is to assume that each r is unique, since a vehicle cannot be in two places at once, Hk can be thought of as a trajectory for the kth vehicle, specifying its position as a function of time. The identity criterion for observed vehicles u and b now becomes a = b ti v[(ri E Hk) A (rf E Hk)]. x2 7: Huang S. Russell /Artificial Intrlligencr 103 (1998) 77-93 Fig. 3. Time-space diagrams (and no other observations). showing In (a). we have (I = b. while in (b), we have (I # h. two possible events in the two-car universe, given observations 0; and 0: To illustrate Eq. (I), consider the simplified case where the universe contains exactly two vehicles of similar appearance, each moving at constant velocity along the same road. Two reliable cameras, located at yU and yd, make observations whenever vehicles pass by. From time t = 0 to t = T, the observation history 0 consists of U = (o,U} recorded at ta and D = (~$1 recorded at fb. The event space S = (HI, Hz) therefore ranges over all possible (~1, UI ) trajectories and (~2, IQ), where yl and y2 are the positions of the vehicles at time tu and ~1 and IQ are the velocities. Fig. 3 shows two possible events consistent with the observations-one where a = b and one where a # h. these can, in turn, be defined by the random variables for two vehicles; It turns out to be easiest to compute the probability of identity from the ratio & P(u = b, 0 ( s)P(s) ds J’ses P(a # b. 0 I sP(.s> d.7 since the P( 0) term in Eq. (1) cancels. Suppose now that yd - y, is 2000 meters, and that tb - ta is 100 seconds. Furthermore, and uniformly uniformly distributed of integration and the above ratio is given by and in the range [lo m/s, 40 m/s]. Then P(s) is constant over the range suppose P(S) is such that yl and y2 are independently [yll, yd], and ~1 and u2 are independently in the range distributed ‘lid IWfb-t,,) (vd-).2)l(orf,I) & - Jlo dwdy2 1 ~,$d(th-t<,) du, j?fd”@h-t) dy2 = 2’ hence P(a = b 1 0) = l/3 3. Appearance models The previous section showed how to express the probability of identity in terms of the probability involve observation of observations given events. Some domains, traffic surveillance, including initial observations of objects as well as subsequent sets that contain ?: Huang, S. Russell /Artificial Infelligence 103 (1998) 77-93 83 of objects. In these situations, observations objects observed at some point in the past can be expected future, seem to provide a more usable model In this section, we show how to express Eq. (1) in terms of appearance probabilities describe appearance probabilities, which define how to appear at some point in the than standard motion and sensor models. and the specific appearance probabilities used in the vehicle identification domain. 3. I. Identity in terms of appearance probabilities Suppose we are given observation history 0 = lJ U D, where U consists of initial of objects. Keeping observations these sets separate in Eq. (1) gives the following of objects, and D consists of subsequent observations for P(a = b 1 U, D): 1 P(U, D) SC YES k P(U, D 1 o,. oh E Hk, s)P(o,. oh E Hk 1 s)P(s)ds Expanding P(lJ, D 1 oa, Ob E Hk, s) yields 1 P(U.D) P(D 1 U.Oa,ot, E ffk.S)P(U 1 o,,Ob E f&.s) x P(o,,ob E ffk 1 s)P(s) ds. indicating is a simply a pairing At this point, we define a new event space ~2, which is a coarsening of S. First, we need that two observations were some new terms: a matching generated by the same object. For example, that the same and a set of subsequent object generated oa and Ob. Given a set of initial observations observations, assignment spuce Q is an event space that ranges over the space of possible assignments. It thus divides is relatively each subset then effectively if we condition on the observations-because homogeneous specifies that starting point and ending point of each vehicle’s trajectory. the space S into subsets of events, such that each subset for every observation is a set of matchings in each set. The (a, b) indicates an assignment the matching Summing over only those assignments w that satisfy the identity criterion for a and b gives P(u = b I U, D) = ~ 1 P(U,D) c OER: (a.b)ao P(D I U, w)P(U I wF’(w) Since the principle of exchangeability is constant given no information correspond, normalization constant P(U, D)-’ these constant requires a uniform prior over Q, and since P( U / w) in U terms can be grouped outside of the summation along with the to which the observations about the observations so that we have P(u = b / U, D) = a! c (*CR: (n,b)ao P(D 1 U. w). Our final assumption specific initial observation and a matching between is that the probability of a specific subsequent observation, given a is independent of the two observations, 84 Z Huang, S. Russell /Artificial Intelligence 103 (I 998) 77-93 the other observations and matchings. we can factor P(D ( U, o) into the product of the individual probabilities (This assumption is discussed further below.) Hence, as follows: (2) P(D 1 u, w) = n P(O;i 1 or, i = j). (i, j)Ew In this expression, P(o~ 1 or, i = j) is an appearance probability, object that initially generated observation or subsequently will write this as P(od 1 0’) where no confusion is possible. appearance probability is not the probability that i = j. that an the probability generated observation 0;. We to note that the It is important Eq. (2) can be substituted into the identity equation to give P(a=bIU,D)=w c n P(oS Io;,i=j). (3) wes2: (a.b)ew (i,j)Ew This is the basic equation we will use for identifying candidate objects for matching, assignments our task essentially will be based on a heuristic approximation. (a, b) E w) contains then the set (w E a: consistent with a = b. It can be shown that this complexity objects. Notice that if there are n (n - I)! possible is unavoidable- our implementation the permanent of a matrix-so involves computing To ground this discussion, we will now discuss the specific observed features and appearance probability models used in the traffic domain. 3.2. Observedfeaturesfor tra#ic When a certain camera c observes some vehicle i, it generates a vehicle report consisting Thus, the observation or in our system is a vector of features. Currently, of variousfeatures. we use the features shown in Table 1. Table 1 Features used in vehicle observation reports Name Descriotion Time of observation Lane position (I, 2, 3, etc.) Distance along lane Lateral velocity Forward velocity Vehicle width Sum of vehicle length and height h Mean vehicle color hue Mean vehicle color saturation Mean vehicle color value Histogram of color distribution over vehicle uixels u c I: Huang, S. Russell /Artijcial Intelligence 103 (1998) 77-93 85 The matching algorithm is designed features of arbitrary complexity, changing the algorithm. as an additional In particular, informativeness, to be independent of the specific features used; new and noise level can be added without it is possible to use direct matching of vehicle images feature as long as the communication bandwidth is available. 3.3. Appearanceprobabilities,for trafic The appearance independent models: probability is currently treated as the product of the following l lane (x): discrete distribution P(xd Ix”); l size (w, I): multivariate Gaussian d Ww d > 1 I wL1 3 0 = N,, t,,., ,c,,, (wd - w”, Id - P): l color (h, s, v): multivariate Gaussian P(h d. sd, vd 1 hU , sl’ , vu) = Nwh,s,u~Ch,,,,, (hd - hU, sd - s” , ud - v”); l arrival time (t): univariate Gaussians conditioned on upstream and downstream lane P(td 1 tU, xd. x*> = Ng;~,,u .d,.,u (td - t”). .*I The arrival time model is particularly vehicle pairs that are considered important, since it drastically to be plausible matches. The parameters reduces the number of represent start upstream accurately model, for example, in other lanes. the mean and standard deviation of the predicted in lane xU and end up downstream link travel time for cars that in lane xd. This allows the system to the fact that cars in the carp001 lane travel faster than cars Our assumption that vehicle trajectories are independent, little sense for traffic, were it not for the fact that the appearance probability used in Eq. (2), would make submodel Xd XI’ by kLt ’ for arrival time is parameterized travel time for the link. Clearly, the trajectories of consecutive cars in a stream of heavy traffic are highly correlated in the current average but we subsume most of this correlation rather than independent, travel time. The assumption of independence to the assumption made by Petty et al. [8], whose work is discussed given average travel time is identical , the current average in Section 6. distributions In examining the empirical probability, we were of the same feature surprised by the level of noise and lack of correlation at two different cameras. Some features, such as color saturation and vehicle width, appear virtually uncorrelated. In all, we estimate that the size and color features provide only about 3-4 bits of information. for the appearance in measurements 3.4. Online learning of appearance models Because traffic and lighting conditions the day, our system uses for the appearance probability model parameters. As new throughout change online (recursive) estimation 86 0.05 0 -0.05 -0. I -0.15 -0.2 -0.25 -0.3 0 -0.3 -0.25 -0.2 X position at upstream camera -0.15 -0. I Data at first camera -0.05 0 0.05 A 0.1 showing observed upstream and downstream x-position data for a sample of 41 matched Fig. 4. Top: diagram to upstream x-position vehicles from the Mack Road and Florin Road cameras. The horizontal axis corresponds and the vertical axis corresponds to a single matched vehicle. Lane dividers are shown as horizontal and vertical lines. For example, 13 vehicles are observed upstream in lane 4 (onramp, highest x values), of which 7 are observed downstream that P(xd = 2 j x” = 4) * 0.54. Boftom: upstream and downstream hue data for a sample of 25 matched vehicles. The for color, line y = x corresponds which includes hue, saturation, and value components, to perfect reproduction of hue at the two cameras. The appearance probability to downstream x-position. Each marked point corresponds is modeled as a multivariate Gaussian. in lane 2 (middle lane), indicating matches are identified by the vehicle matcher, the parameters are updated based on the sites. Fig. 4 shows a sample set of observed feature values at the upstream and downstream x values for matched vehicles, from which P(xd 1 x’) can be estimated, as well as a sample from which P(hd 1 hU) can be estimated. To adapt set of hue values for matched vehicles, if a to changing conditions, our system uses online exponential forgetting. For example, Z Huang, S. Russell /Art$cinl Intelligencr 103 (lY98) 77-93 87 new match is found for a vehicle travel time t, then the mean travel time is updated as follows: in lane xU upstream and lane .8 downstream, with link The )/ parameter, which ranges from 0.0 to 1 .O, controls which previous readings are given significant weight. the effective “window size” over The above assumes that the match found is in fact correct. In practice, we can never be certain of this. A better motivated approach to model updates would be to weight each update by the probability that avoids matching altogether is correct. An approach that the match in Section 6. is described 4. Matching algorithm We begin by describing camera are also detected downstream, describe the extension to handle onramps and offramps. the simplest case, where all vehicles detected at the upstream and there are no onramps or offramps. We then 4.1. Matching with full correspondence The aim is to find pairs of vehicles n and b such that P(u = b 1 II, D) > 1 - E for some small E. We have derived an Eq. (3) for this quantity, under certain independence assumptions, the equation. As mentioned computing that we now face is the intractability that are used in of and shown how to compute the appearance probabilities earlier, the problem the summation involved. The core of the approach is the observation, due to Cox and Hingorani (pairing all n vehicles) can be found in time O(n3) by formulating probable assignment problem as a weighted bipartite matching problem and using any of several well-known algorithms for this task. To do this, we construct an association matrix M of appearance probabilities, where each entry [5], that a most the M/j = -lOgP(O: ) Or), so that the assignment with least total weight in the matrix corresponds assignment, to Eq. (2). according to the most probable situation the most likely assignment For our purposes, knowing is not enough. It can easily happen that some c of the IZ vehicles are all very similar and fairly close to each other on the that we call a clique. One common example might be cliques of freeway-a to major airports. Given a clique of size c, there yellow cabs on the freeways will be c! assignments as the most probable all having the clique may be very unreliable, we employ a leuve- assignment. Since matches within one-out heuristic in the best assignment. For that “forbids”, each forbidden match, we measure the reduction results in a significant Matches whose forbidding in turn, each match contained in likelihood reduction are deemed reliable, since this for the new best assignment. the same probability roughly leading 88 7: Huang, S. Russell /ArtiJicial Intelligence 103 (1998) 77-93 Downstream rows and to account for entering and exiting vehicles. Each entry will be replaced by its negative logarithmic value Fig. 5. Extended association matrix for two upstream and downstream observations, columns before computing the minimum weight assignment. showing additional corresponds upstream vehicle in question. to a situation where there appears to be no other reasonable assignment for the For example, suppose we have the following association matrix: Downstream Upstream n ,: z a h c 3.2 2.5 12.7 8.5 4.5 7.3 5.0 4.4 5.0 is (a = X, b = z, c = y}, with a total weight of 12.6. (Notice Here the best assignment If that a = y is the “closest” match for a, but leaves no good match for the others.) is {n = y, b = z,, c = x) with weight 14.2. If the we forbid a = x, the best assignment difference between t, 5 i.e., if these two weights is greater than some reliability 14.2 - 12.6 > t, then we accept the a = x match, since no other reasonable choice seems to exist. On the other hand, if we forbid b = z, the best assignment has weight 12.7. If 12.7 - 12.6 ,< t, then we reject b = 2, since there is another match for b that yields a t, we obtain more reliable matches, good overall assignment. By increasing the overall number of accepted i.e., the error rate E is reduced; however, matches. the threshold this reduces threshold 4.2. New and missing vehicles In the general case, vehicles can appear from onramps between the cameras or can they can fail to be detected at the upstream or this, we add extra rows and columns to the association (Equivalently, disappear onto offramps. downstream matrix. With m upstream and n downstream vehicles, and columns to allow for all possibilities. Fig. 5 illustrates camera.) To handle the matrix now has m + n rows the structure of the matrix for 5 The value compared with the reliability threshold is the negative logarithm of the relative likelihood of the observations given the best assignment and the observations given the best assignment with a forbidden match. T. Huang, S. Russell /Ar@cial Intelligence 103 (1998) 77-93 89 the freeway between that a vehicle exits the freeway, B is the number of the cameras per unit time, and P(oi) refers to the in the table explain m = n = 2. Here, CY is the probability vehicles entering prior probability of seeing a vehicle with features o; . 6 The formulas fact that human observers feel far more confident matching unusual vehicles the interesting than typical vehicles: not only is the probability of confusion with other vehicles lower, but that the upstream vehicle exited, only to be replaced by another vehicle the probability of the same unusual appearance, can be discounted because the extra multiplicative P(oi) factor for an unusual vehicle would be tiny. 5. Results We tested the vehicle matcher with data from a region-based vehicle tracker on video sequences from the sites in Fig. 1. refers to the fraction of proposed matches On any given run, the number of matches proposed by the vehicle matcher depends on threshold selected for that run. In the results discussed below, coverage refers the reliability to the fraction of vehicles observed by both cameras for which matches were proposed, and that were in fact correct. In general, accuracy threshold the coverage goes down as the reliability is increased, but the accuracy goes up. the ground-truth matches were determined by a To verify the accuracy of the matcher, the digitized sequences with the aid of a frame-based movie viewer. Since human viewing to match each minute of video, it was used this method required about 3 hours of viewing only during testing, we first ran the matcher on the vehicle report data and then used the frame-based movie viewer to verify whether the suggested matches were correct. the early stages of testing. In subsequent Testing our system involved a start-up phase during which it estimated the appearance in Fig. 6, we trained our system on a that either entered or exited the freeway in between probability models online. For the results shown pair of 60-second video sequences and then ran it on the immediately following 60-second sequences. The sequences contained 29 vehicles detected at both cameras, along with over the cameras. The resulting 40 vehicles accuracy/coverage the system achieved 100% accuracy with a coverage of 14%, and 50% accuracy with a coverage of 80%. To simulate performance on freeway sections without onramps and offramps, we also the tracks of entering and exiting vehicles from the data stream. This makes tried removing the problem substantially easier: we achieved 100% accuracy with a coverage of 37%, and 64% accuracy with a coverage of 80% (Fig. 6(b)). The boxed vehicles in Fig. 1 show a pair of vehicles correctly matched by our system. curve in Fig. 6(a) shows that despite very noisy sensors, Link travel times between each camera pair are currently calculated by averaging travel times for matched vehicles. These times were accurate observed a distance of two miles, over a wide range of coverage/accuracy suggests that matched vehicles are representative of the traffic flow-that process does not select vehicles with a biased distribution of speeds. the to within 1% over tradeoff points. This is, the matching ’ In our implementadon, each of these models is learned online; cy and B are also specific to individual lanes. 90 i? Huang, S. Russell /Art$$zl Intelligence 103 (/99X) 77-93 1 (b) Fig. 6. Sample matching values. A low threshold and high accuracy. well as over 40 entering and exiting vehicles. exiting vehicles removed, the graphs shows accuracy versus coverage results: implies high coverage and low accuracy, while a high threshold threshold low coverage (a) Results for a 60-second video sequence containing 29 vehicles detected at both cameras as (b) Results for the same sequence with the tracks of entering and to simulate performance on freeway sections without onramps and offramps. for a range of reliability implies 6. Related work related literature, is closely to the traditional in which new “observations” for air traffic control is a typical application: The vehicle matching problem from the tracking “data association” (from the downstream problem “tracks” (from the upstream camera). camera) must be associated with already-established the radar dish determines Radar surveillance an approximate position for each aircraft every few seconds, and each new set of positions is a large literature on data must be associated with the set of existing association-typically text is by Bar-Shalom appear in [2]. Ingemar Cox [4] surveys and and Fortmann to those in Fig. 5. Cox’s integrates various developments, aim in his review paper is to present field to the computer vision and robotics community, where they might be used to resolve problems of images by a moving robot. Major identifying visual features seen in temporally differences between our work and “standard’ data association time-varying, over 100 papers per year. The standard the ideas from the data association include site-dependent, [3], and recent developments formulas very similar tracks. There the following: and camera- separated deriving (1) Sensor noise and bias are large, unknown, dependent, and sensor observations are high-dimensional. (2) In radar tracking, the distance moved by each object between observations is in freeway traffic, the opposite is typically small compared true. to inter-object distances; (3) Traffic observations (4) Vehicle trajectories are asynchronous. in traffic are highly correlated. in Section 3, this last problem is dealt with in our approach by conditioning link travel time. This is a device that may prove to the modelling of very large systems using involving As explained trajectories on the current average be useful in many other applications aggregate parameters. Z Huang, S. Russell /Artij’icial Inrelligence 103 (I 998) 77-93 91 The most closely related work on statistical estimation of travel time is by Petty et al. [8]. travel times using an “ensemble” matching that detects downstream propagation of distinct arrival time patterns to estimate They have shown that it is possible approach individual vehicles. Because loops-that vehicle. Using this technique, traffic conditions. The method and have no intervening onramps or offramps. instead of it uses only the arrival times, it can operate using data from the passage of a travel times were estimated accurately over a wide range of to loops that are fairly close together is, however, limited is, induction coils placed under the road surface that indicate approach is maintained is proportional to approximate assignment. Hence, of the corresponding the sum over assignments are defined such that detailed balance and the transitions exchange pairings between We are currently collaborating with the authors of the “ensemble” to develop the two approaches and may overcome many of the shortcomings to Ritov, is to use a Monte Carlo Markov Chain in Eq. (3). The states of the Markov two pairs of a system that combines of each. The basic idea, due primarily algorithm chain are complete assignments vehicles. The transition probabilities and the fraction of time during which any given state is occupied the probability proposition is true. Results due to Jerrum and Sinclair this particular chain gives polynomial-time This approach can in fact estimate to of any given (such as a = b) can be estimated as the fraction of time spent in states where it [6] show that the Monte Carlo method applied convergence. travel times and O/D counts without ever selecting travel time and average O/D likely vehicle matches at all: simply compute counts over all the assignments visited by the chain. Similarly, the appearance probability models can be updated after each transition as if the assignment were correct; in the limit, the updated models will reflect the observed data correctly. Since changing the appearance the transition probabilities of the chain, the process must be iterated until models changes convergence. This is an instance of the EM algorithm, where the hidden variables are the to see if this approach can be used in a link travel times. We are currently experimenting real-time setting where the structure of the Markov chain is continually changing as new vehicles are detected. the probability the average 7. Conclusions and further work involved in establishing the patterns of reasoning This paper has described those events that correspond identity from observations of objects. We proposed a formal foundation based on a prior over the space of physical events, together with an identity criterion defining to observations of the same object. In the case of vehicle matching, the events are the different in a given freeway network. When a single trajectory passes sets of trajectories of vehicles through two vehicle observations, to the same object. This general approach makes it possible to define the probability of identity and to integrate into an intelligent agent. that views a rational tradition prior beliefs and then applying Bayesian updating its lifetime. The general relationship between perception and the formation of agent as beginning with uninformative throughout internal models is a subject that needs much more investigation This research can be seen as another step in the Carnapian that implies that the observations correspond the necessary patterns of reasoning [ 11. 92 7: Huang, S. Russell /Artt$cial Intelligence 103 (1998) 77-W We showed that the abstract probability in terms of measurable appearance probabilities, which define how, when, or where objects that were in the future. observed at some point in These appearance probabilities the environment-such as changing weather, lighting, and traffic patterns. to adapt to changing conditions to appear at some point in the past are expected can be learned online can be expressed of identity We have implemented and tested a system the complete set of recorded paths during for the system to do so, it is already capable of tracking for vehicle matching using an efficient heuristic. Despite from the cameras, our system achieved a high level of the first reliable video- vehicles, enabling us to build camera data were link travel times. Although experimental the path of a vehicle for a time period can be computed that time period. For successful over a long sequence of cameras, however, we need to improve both rate of the tracking subsystem. We can perform a algorithm based on bipartite matching combined with a leave-one-out very noisy feature measurements individual in matching accuracy based system for measuring not available over a sequence of camera sites. Thus, O/D counts by examining O/D measurement matching coverage and the detection crude analysis as follows: accuracy a vehicle in O/D counts, we need a9 = 0.9 Suppose now that n = 10. To achieve 90% accuracy in order to keep or a x 0.988 as well as a sufficiently high number of tracked vehicles to be tracked across the 10 sites sampling error low. The required percentage of vehicles will depend on flow rates and the length of the reporting period. To track, say, 10% of vehicles across 10 sites we need pl”c9 = 0.1. Given p = 0.95, this means we need achievement of 98.8% accuracy and 82% coverage is not c x 0.82. Currently, simultaneous that improved measurement of features such as width and feasible. However, we anticipate height would provide dramatic improvement include selecting a subset of pixels from the rear plane of each vehicle match feature. is a, and the single-camera is correctly is c, and the matching that in coverage and accuracy. Other possibilities tracked across y1 sites is pnan-‘cn-l rate is p, then the probability for the vehicle matcher vehicle detection if the coverage to be used as a independence). (assuming identification the object that two different The patterns of reasoning described here have broad applicability to other domains. in database management, where For example, to the same entity. Thus, US it is possible record over 500 million credit-using Americans, of whom only credit reporting agencies about to this problem could help with maintaining database consistency and with consolidating multiple databases containing overlapping loo-120 million are actually distinct individuals. Applying our approach records could correspond problem occurs information. References [I] F. Bacchus, J.Y. Halpern, H. Levesque, Reasoning about noisy sensors in the situation calculus, in: Proc. 14th International San Mateo, CA, August 1995, pp. 1933-1940. Joint Conference on Artificial Intelligence (IJCAI-95). Montreal, Quebec, Morgan Kaufmann, [2] Y. Bar-Shalom MA, 1992. (Ed.), Multitarget Multisensor Tracking: Advanced Applications, Artech House, Norwood, [3] Y. Bar-Shalom, T.E. Fortmann, Tracking and Dam Association, Academic Press, New York, 1988. [4] I.J. Cox, A review of statistical data association for motion correspondence, techniques International Journal of Computer Vision 10 (1993) 53-66. 7: Huang, S. Russell /Art$cial Intelligence 103 (1998) 77-93 93 ]5] I.J. Cox, S.L. Hingorani, An efficient implementation and evaluation of Reid’s multiple hypothesis tracking algorithm Jerusalem, for visual tracking, Israel, October 1994, pp. 437-442. in: Proc. 12th IAPR International Conference on Pattern Recognition, Vol. I. [6] M. Jerrum, A. Sinclair, The Markov chain Monte Carlo method, in: D.S. Hochbaum (Ed.), Approximation Algorithms for NP-hard Problems, PWS Publishing, Boston, MA, 1997. [7] J. Malik, S. Russell, Traffic surveillance and detection technology development: new sensor technology final report, Research Report UCB-ITS-PRR-97-6. California PATH Program, 1997. [8] K.F. Petty, P. Bickel, M. Ostland, J. Rice, Y. Ritov, F. Schoenberg, Accurate estimation of travel times from single-loop detectors, Transportation Research 32A (I) (1998) l-17. 