Analysis and Evaluation of Handwriting in Patients with Parkinson’s Disease Usingkinematic, Geometrical, and Non-linear FeaturesC. D. Rios-Urrego1, J. C. V´asquez-Correa1,2∗, J. F. Vargas-Bonilla1, E. N¨oth2, F. Lopera3, and J. R. Orozco-Arroyave1,2∗1Faculty of Engineering, University of Antioquia UdeA, Medell´ın, Colombia.2Pattern Recognition Lab, Friedrich-Alexander-Universit¨at Erlangen-N¨urnberg, Germany.3Neuroscience Research Group, Faculty of Medicine, University of Antioquia UdeA, Medell´ın, Colombia.0202beF31]GL.sc[1v11450.2002:viXraAbstractBackground and objectives: Parkinson’s disease is a neurological disorder that affects the motor system producing lack of coordi-nation, resting tremor, and rigidity. Impairments in handwriting are among the main symptoms of the disease. Handwriting analysiscan help in supporting the diagnosis and in monitoring the progress of the disease. This paper aims to evaluate the importance ofdifferent groups of features to model handwriting deficits that appear due to Parkinson’s disease; and how those features are able todiscriminate between Parkinson’s disease patients and healthy subjects.Methods: Features based on kinematic, geometrical and non-linear dynamics analyses were evaluated to classify Parkinson’s dis-ease and healthy subjects. Classifiers based on K-nearest neighbors, support vector machines, and random forest were considered.Results: Accuracies of up to 93.1% were obtained in the classification of patients and healthy control subjects. A relevance analysisof the features indicated that those related to speed, acceleration, and pressure are the most discriminant. The automatic classifica-tion of patients in different stages of the disease shows κ indexes between 0.36 and 0.44. Accuracies of up to 83.3% were obtainedin a different dataset used only for validation purposes.Conclusions: The results confirmed the negative impact of aging in the classification process when we considered different groupsof healthy subjects. In addition, the results reported with the separate validation set comprise a step towards the development ofautomated tools to support the diagnosis process in clinical practice.Keywords: Parkinson’s disease, Handwriting, kinematic features, Geometrical features, Non-linear dynamics1. IntroductionParkinson’s disease (PD) is a neuro-degenerative disorder,which produces motor and non-motor symptoms in the patients.Examples of motor impairments include resting tremor, bradyki-nesia, rigidity, micrographia, hypomimia, and others [1]. Whileexamples of non–motor impairments include depression, sleepdisorders, dementia, and others [2]. These symptoms appear asconsequence of the progressive loss of dopaminergic neuronsin the mid-brain [1]. Handwriting is one of the most impairedmotor activities in PD patients. The most common symptoms inhandwriting of PD patients include micrographia, which is re-lated to the reduction of the size in handwriting, and dysgraphia,which is related to difficulties performing the controlled finemotor movements required to write [3]. The progression ofmotor symptoms is currently evaluated with the third section ofthe Movement Disorder Society – Unified Parkinson’s DiseaseRating Scale (MDS-UPDRS-III) [4], which is administered byneurologist experts. The scale contains several aspects to evalu-∗corresponding author J. C. V´asquez-Correae-mail: juan.vasquez@fau.deAddress: Friedrich-Alexander-Universitt Erlangen-Nrnberg (FAU) Lehrstuhlf¨ur Informatik 5 (Mustererkennung) Martensstr. 3, Of 10.158, 91058 Erlan-gen Germanyate motor skills of the patients, including those directly or indi-rectly related with handwriting like finger tapping, hand tremor,hand rigidity, and others. The diagnosis process of PD is expen-sive and time-consuming for patients, caregivers, and the healthsystem [5, 6, 7]. Automatic handwriting analysis could help tosupport the process to diagnose and monitor the neurologicalstate of the patients.There is interest in the research community to automaticallyassess the handwriting of PD patients. Most of the studies con-sider data from on-line handwriting, which are captured fromdigitizer tablets, and contain information related to the dynam-ics of the handwriting process while the patient is putting thepen on the tablet (i.e., on-surface). Some of the features thatare typically extracted from the on-surface dynamics includethe pressure of the pen, and the azimuth and altitude angles.There are also tablets that allow to capture information of thein-air movement (i.e., before and/or after the patient to put thepen on the tablet’s surface). The classical way of addressing theanalysis of on-line handwriting is based on on-surface features.For instance in [8] the authors proposed features related to thepower spectral density of the speed stroke in the handwritingof 17 healthy control (HC) subjects and 13 PD patients. Theauthors classified PD patients vs. HC subjects using a neuralnetwork and reported an accuracy of up to 86.2%. In [9] the au-Preprint submitted to Computer Methods and Programs in BiomedicineFebruary 14, 2020   thors extracted kinematic features from the handwriting of 20HC subjects and 20 PD patients who wrote their addresses andfull names. The authors computed features related to the aver-age time on the tablet’s surface, the average in-air time of thepen, the speed of the trajectory, and the average pressure of thepen. The authors reported accuracies of up to 97% in the clas-sification of PD patients vs. HC subjects. In [10] the authorsevaluated the in-air movement during the handwriting processof 37 PD patients and 38 HC subjects who wrote the Czech sen-tence: Tramvaj dnes uz nepo-jede (the train will not go today).The authors extracted several kinematic features including theaverage in-air time of the pen, and the average on-surface time.The authors performed the classification of PD patients and HCsubjects using a support vector machine (SVM) with a Gaussiankernel, and reported accuracies around 86% when the featuresbased on pressure, kinematic, in-air time, and on-surface timeare combined. In [11] the authors analyzed different handwrit-ing tasks performed by the same set of patients considered in[10]. The set of tasks included the Archimedean spiral, the rep-etition of the graphemes l and le, simple orthographic isolatedwords, and the Czech sentence: Tramvaj dnes uz nepo-jede.The authors extracted kinematic and pressure-based features toclassify PD patients and HC subjects. Three different classi-fication methods were considered: SVM, K-nearest neighbors(KNN), and Adaboost. Accuracies of up to 76.5% were re-ported with the combination of kinematic and pressure-basedfeatures. In [12] the authors applied the Generalized CanonicalCorrelation Analysis (GCCA) to classify PD patients and HCsubjects, and to predict the neurological state of the patients us-ing information from handwriting, speech, and gait. Handwrit-ing analyses were based on kinematic features extracted fromthe vertical and horizontal axes, and the pressure of the pen.The authors concluded that the combination of speech, hand-writing, and gait using the GCCA approach improves the accu-racy in the classification and the prediction of the neurologicalstate.Other neurological disorders have also been studied usingonline handwriting. In [13] the authors proposed non-linear dy-namics (NLD) features to evaluate the handwriting of 10 HCsubjects and 25 patients with essential tremor. Several NLDfeatures such as the fractal dimension and Shannon entropywere extracted from the Archimedean spiral. The NLD featureswere combined with standard kinematic measures related to thespeed and pressure of the pen. The authors reported accuraciesof up to 85% classifying the patients vs. HC subjects.Recent deep learning approaches have also been used toclassify handwriting of PD and HC subjects. In [14] the au-thors modeled the handwriting dynamics of 18 HC and 74 PDsubjects using a smart-pen with several sensors. The partici-pants performed several tasks including the drawing of circlesand Archimedian spirals. The authors proposed a model basedon convolutional neural networks (CNNs). The signals from thesmart-pen were transformed into images by concatenating andreshaping the time-series. Several CNN configurations wereconsidered for each task, and a majority voting scheme was im-plemented to make the final decision. Accuracies up to 95%were reported by the authors. In [15] the authors considered a2model called deep echo state network to classify 67 PD patientsand 15 HC subjects who drew Archimedian spirals on a tablet.The deep learning model was based on recurrent neural net-works (RNNs), which process the time-series of horizontal andvertical movements, the grip angle, and the pressure of the pen.The authors reported accuracies of up to 88.3% with the pro-posed model. Recently, in [16] researchers from our researchLab considered a deep learning model based on CNNs to clas-sify PD patients and HC subjects using multimodal informationfrom speech, handwriting, and gait. The handwriting analysiswas based on the transition when the patients have the pen inthe air and put it on the tablets surface. The trajectories fromthe pen and the pressure of the pen were modeled with a CNN.The authors reported accuracies of up to 97.6% when informa-tion from speech, handwriting, and gait is combined; however,the accuracy obtained considering only the handwriting analy-sis was around 66.5%.According to the reviewed literature, most of the studiesconsidered kinematic features to evaluate handwriting impair-ments of patients with neurodegenerative disorders. There aresome recent studies that consider deep learning methods to as-sess the handwriting deficits of PD patients. Other kinds offeatures including geometrical, spectral, and NLD based havenot been extensively studied to support the diagnosis and mon-itoring of the patients. The analysis of these aspects will be themain outcomes of the current study.1.1. Research objectives of this studyThis paper evaluates the performance of three different fea-ture sets (kinematic, geometrical, and NLD) to model handwrit-ing impairments of PD patients. The method aims to providesuitable insights about the relevance of different features to dis-criminate between PD patients and HC subjects. The proposedapproach is evaluated in realistic conditions, i.e., with a differ-ent sets of patients and healthy subjects that never participatedin the training process. Finally, the study aims to evaluate thesuitability of the proposed approach to automatically classifypatients in different stages of the disease.2. Data Acquisition and ParticipantsThe data were collected with a Wacom Cintiq 13 HD tablet,with visual feedback to the patients and using a sampling fre-quency of 180 Hz. The tablet captures six different signals: hor-izontal position (x(t)), vertical position (y(t)), azimuth angle, al-titude angle, distance to the tablet surface (z(t)), and pressure ofthe pen. For this study the participants draw an Archimedeanspiral following a predefined template (Figure 1), which wasdisplayed on the tablet. Participants were requested to drawthe spiral between the lines of the template and avoiding tocross them. Additionally, the participants wrote the sentence“El abecedario es a, b, c,..., z” which in English is: “The al-phabet is a, b, c..., z”.With the aim to show real cases of how people with differ-ent age and health condition draw, Figures 2 and 3 include ex-amples of drawings obtained from three different participants:group includes 6 PD patients and 6 HC subjects, there are 3 fe-male in each group, and the ages range from 54 to 83 (mean= 68.33; SD = 10.19) and from 45 to 57 (mean = 53; SD =4.69), respectively. Demographic and clinical data, includingthe MDS-UPDRS-III score of each patient in this additionalvalidation set, are included in Table 2.3. MethodsThe methodology addressed in this work consists of threemain stages: feature extraction, dimensionality reduction, andautomatic classification. This methodology is summarized inFigure 5. Details of each stage are presented in the followingsubsections.Figure 1: Template of the Archimedean spiral.3.1. Feature Extraction23 years old subject (left), 65 years old subject (middle), and73 years old PD patient with a MDS-UPDRS-III score of 64(right).2.1. SubjectsFour groups of participants are considered in this study: pa-tients with PD; elderly HC subjects; young HC subjects; andan additional set of 12 participants, which is considered to vali-date the generalization capability of the models. Details of eachgroup are provided below.PD patients:This group is formed with 39 patients (26 female) with agesbetween 29 and 81 years (mean = 59.08; SD = 11.17). Allof them were evaluated by a neurologist expert according tothe MDS-UPDRS-III scale [4]. The scores of such evaluationsranged between 8 and 106 (mean = 35.72; SD = 23.25). Thisgroup of patients was recruited in the Foundation for Parkin-son’s patients in Medell´ın, Colombia. The patients were eval-uated during the “ON” phase of medication, i.e., no more thanthree hours after the intake.Elderly HC subjects (eHC):This group includes 39 healthy subjects (18 female) withages between 29 and 85 years (mean = 61.85; SD = 13.89).None of the participants in this group had symptoms of neuro-logical or movement disorders. The PD and eHC groups arematched for age (t(0.99) = −1.19, p = 0.12).Young HC subjects (yHC):A total of 40 healthy participants (16 female) are included inthis group. The age ranges from 20 to 42 years (mean = 24.43;SD = 4.08). Most of the participants of this set are students whowanted to participate in the study. None of them exhibited ormanifested symptoms of neurological or movement disorders.Table 1 includes demographic and clinical data of the sub-jects included in the aforementioned three groups. Figure 4shows the age distribution of the three groups of subjects.Additional validation set:This group of subjects was considered to validate the gen-eralization capability of the model proposed in this paper. TheThree different feature sets are extracted from the signals:features based on kinematic analysis, novel features based onthe geometrical and spectral analyses of the Archimedean spi-ral, and NLD features.3.1.1. kinematic features:x2(t) + y2(t),A total of eight features are extracted: (1) absolute/real tra-jectory of the Archimedean spiral r(t), computed as r(t) = (cid:112)where x(t) and y(t) are the horizontal and vertical positions, re-spectively; (2) speed of the trajectory; (3) acceleration of thetrajectory; (4) pressure of the pen; (5) first derivative of thepressure; (6) second derivative of the pressure; (7) distancefrom the tablet’s surface to the pen (z(t)); and (8) first deriva-tive of z(t). Six functionals are computed for each feature:mean, standard deviation, maximum value, minimum value,skewness, and kurtosis, forming a 48-dimensional feature vec-tor per drawing.3.1.2. Geometrical and spectral featuresA novel feature set with geometrical and spectral measuresof the Archimedean spiral is introduced. To create the featureset the spiral’s trajectory is modeled as the amplitude-modulatedsignal (cid:98)r(t) defined in Equation 1.(cid:98)r(t) = (cid:16)a3t3 + a2t2 + a1t + a0· sin(2π f t)(1)(cid:17)The real trajectory r(t) is modeled as a sinusoidal signalwith increasing amplitude and frequency f . The amplitude val-ues are given by a third-order polynomial which coefficients(ai) are estimated using a polynomial regression with the maxi-mum peaks of the original trajectory. A third-order polynomialis chosen because it avoids an oscillatory behavior across thesamples. Additionally, the third order guarantees a smooth firstderivative and a continuous second derivative across the trajec-tory [17]. The frequency f is obtained as the fundamental fre-quency of the trajectory using the Fourier transform. The modelof the trajectory is depicted in Figure 6 where the real and themodeled trajectories can be compared. Note that the trajectoryfor the PD patient is more irregular than those observed for thetwo HC subjects. Twelve features are extracted from the mod-eled trajectory: mean square error (MSE) between the real and3xyr15.2 cm1.9 cmFigure 2: Archimedean spiral drawn by three participants.Figure 3: Sentence written by a yHC (left), an eHC (middle), and a PD patient (right). The sentence is: El abecedario es a b c ... z.Table 1: Demographic and clinical information of the participants. PD: Parkinson’s disease, eHC: elderly healthy controls, yHC: young healthy controls, µ: average,σ: standard deviation.PD patientseHCyHCNumber of subjectsAge (µ ± σ)Age rangeTime post diagnose (years) (µ ± σ)MDS-UPDRS-III (µ ± σ)Range of MDS-UPDRS-IIIMale1362.8 ± 10.241 – 818.4 ± 4.534.6 ± 22.18 – 82Female2657.7 ± 11.425 – 7113.4 ± 12.736.3 ± 24.29 – 106Male2167.4 ± 12.849 – 84Female1860.5 ± 8.050 – 74Male2425.3 ± 4.521 – 42Female1623.1 ± 3.020 – 32Table 2: Demographic and clinical information of the participants in the ad-ditional validation dataset. PD: Parkinson’s disease, HC: healthy controls, t:time post diagnose [years], UPDRS-III: MDS-UPDRS-III.HCGender Age574550575455MFFFMMPD 1PD 2PD 3PD 4PD 5PD 6PDGender Age656963765483FFMMMFHC 1HC 2HC 3HC 4HC 5HC 6t8561456UPDRS-III242636694334modeled trajectories, the coefficients of the third order polyno-mial used for the model (ai, i ∈ {0, 1, 2, 3}), amplitude of the firstfive spectral components of the trajectory, the slope of the linethat links the peaks of the first and third spectral components ofthe trajectory, and the slope of the line that links the amplitudesof the third and fifth spectral components of the trajectory.3.1.3. Non-linear dynamics featuresThis study considers an exploratory analysis of NLD fea-tures to model the handwriting dynamics of PD patients. Thisapproach is motivated by the evidence reported in previous stud-ies [13, 18]. Based on these reports, we believe that whenthe disease progresses, the handwriting becomes more distortedand chaotic. Thus, NLD features should be able to reveal spe-cific characteristics in handwriting such that allow us to dis-criminate between PD patients and healthy controls. The NLDfeatures considered in this study are extracted from the trajec-tory signal r(t) of the Archimedean spiral and from the sen-tence. To understand the NLD analysis, the concept of phasespace should be introduced. It is a multidimensional represen-tation that allows computing topological features of a chaoticsystem. For a time series s(n), the phase space can be recon-structed using the embedding theorem introduced in [19]. Thephase space is defined according to Equation 2, where ˆs(n) isthe reconstructed attractor, n is the number of points in the timeseries, and m and τ are the embedding dimension and time de-lay, respectively. The embedding dimension is estimated usingthe false neighbors method [20], and the time delay is found asthe first minimum of the mutual information function.ˆs(n) = {s(n), s(n − τ), · · · , s(n − (m + 1)τ)}(2)Figure 7 shows attractors corresponding to trajectories of thespirals introduced in Figure 6. Note that the PD patient exhibits4Low pressureHigh pressure23 years old HC65 years old HC64 years old PD patient Low pressureHigh pressure23 years old HC65 years old HC64 years old PD patient In [24], the authors demonstrated that C(ε) represents a volumemeasure, hence CD can be defined by Equation 5.C(ε) = limn→∞1n(n − 1)n(cid:88)n(cid:88)i=1j=i+1Θ(ε − |s[i] − s[ j]|)(4)CD = limε→0log(C(ε))log(ε)(5)Hurst exponent (HE): This feature measures the long termdependence of a time series.It is defined according to theasymptotic behavior of the re-scaled range of a time series asa function of a time interval [25]. The estimation process con-sists of dividing the time series into intervals of size L and cal-culating the average ratio between the range R and the standarddeviation σ of the time series. HE is computed as the slope ofthe curve obtained from Equation 6.LHE = Rσ(6)Largest Lyapunov exponent (LLE): This feature representsthe average divergence rate of neighbor trajectories in the phasespace. Its estimation process follows the algorithm in [26]. Af-ter the reconstruction of the phase space, the nearest neighborof every point in the trajectory is estimated. The LLE is esti-mated as the average separation rate of those neighbors in thephase space.Lempel-Ziv complexity (LZC): This feature measures thedegree of disorder of spatio-temporal patterns in a time series [27].In the computation process the signal is transformed into bi-nary sequences according to the difference between consecutivesamples, and the LZC reflects the rate of new patterns in the se-quence. It ranges from 0 (deterministic sequence) to 1 (randomsequence). Further details of the computation process can befound in [28, 29].3.2. ClassificationThree different classifiers are used in this study:(1) K-nearest neighbors, (2) SVM with a Gaussian kernel, and (3)random forest (RF). The three aforementioned classifiers weretrained and tested following a leave one out cross-validationstrategy. This procedure is repeated for each sample to assurethat all data are tested. The parameters of the classifiers areoptimized in a grid-search. For the KNN the possible num-ber of neighbors was K ∈ {3, 5, 7}. For the SVM the param-eters C and γ were optimized up to powers of ten where C ∈{0.0001, 0.001, · · · , 1000} and γ ∈ {0.0001, 0.001, · · · , 1000}.Finally, for the RF the number of trees and their maximumdepth were N ∈ {5, 10, 15, 20, 50} and D ∈ {1, 2, 5, 10}, re-spectively. The performance of the classifiers was evaluatedconsidering several statistics including the F-score, accuracy,sensitivity, and specificity.Figure 4: Age distribution of the three groups of subjects.more irregular trajectories in its corresponding attractor thanthe HC subjects. Once the attractor is created, several featurescan be computed to measure its complexity. In this study a to-tal of seven NLD features are extracted from the reconstructedattractors.Approximate entropy (ApEn): The ApEn is a regularity statis-tic to measure the average conditional information generatedby diverging points on trajectories in the attractor. A time se-ries containing several repetitive patterns has a relatively smallApEn, while a more complex process has a higher ApEn. De-tails of the process to compute the ApEn are described in [21].Sample entropy (SampEn): The main drawback of ApEn isits dependence on the signal’s length due to self comparison ofattractor’s points. The SampEn is a modification of the ApEnwhich appears to overcome this drawback. Further details ofthe process to compute ApEn can be found in [22].Approximate and Sample entropies with Gaussian kernels:The computation of ApEn and SampEn estimates the regularityof the attractor’s trajectories by counting neighbor points. Thisprocess is performed using a Heaviside step function. Insteadof using such a step function, the computation of ApEn andSampEn with Gaussian kernels uses the exponential functionpresented in Equation 3, where R is a tolerance parameter of thedistance between near samples in the time-series s[n]. Furtherdetails of the computation process can be found in [23].dG(s[i], s[ j]) = exp(cid:32)−||s[i] − s[ j]||210R2(cid:33)(3)Correlation Dimension (CD): This feature allows to estimatethe exact space occupied by the attractor in the phase space.To estimate CD the correlation sum C(ε) is defined accordingto Equation 4, where Θ is the Heaviside step function. C(ε)can be interpreted as the probability to have pairs of points ina trajectory of the attractor inside the same sphere of radius ε.5PDeHCyHCPDeHCyHC20304050607080Age (years)Figure 5: General methodology.Figure 6: Comparison of the real trajectory of the Archimedean spiral r(t) and the model (cid:98)r(t) for a yHC (left), an eHC (middle) and a PD patient (right).Figure 7: Attractors of the trajectory of the Archimedean spiral for a yHC (left), an eHC (middle) and a PD patient (right).4. Experiments and resultsA total of five experiments are performed in this study. Fourof them comprise bi-class classification experiments: PD vs.yHC; PD vs. eHC; relevance analysis; and classification of PDvs. HC considering the separate validation sets described inTable 2. The fifth experiment is a multi-class classification taskwhere the goal is to differentiate among four different stages ofthe disease. Details of all these experiments are described in thenext subjections.4.1. Classification of PD vs. yHCTable 3 shows the results when PD patients vs. yHC sub-jects are classified using the aforementioned classifiers usingdifferent feature We performed a Kruskal-Wallis test to asseswhether a significant difference existed between the featurescomputed from the PD patients and yHC subjects. The nullhypothesis of both feature sets coming from the same distribu-tion was rejected in all cases (p (cid:28) 0.05). The results obtainedafter the relevance analysis with PCA (see section 4.3) are alsoincluded in this table. The best results are obtained with thefeatures computed from the Archimedean spiral (F1 = 0.94).Note that in general the SVM and the RF classifiers provide thehighest accuracies. Note also that there is a low variation ofthe optimal hyper-parameters along the feature sets and tasks,which gives an idea about the stability and robustness of theproposed approach.4.2. Classification of PD vs. eHCThe Kruskal-Wallis test to assess the significant differencebetween the features computed from the PD patients and eHCsubjects reflect that both feature sets do not come from thesame distribution (p (cid:28) 0.05). The results of the classificationbetween PD patients and eHC subjects are shown in Table 4.This table also includes the results obtained after the relevanceanalysis with PCA (see section 4.3). Note that the results areslightly lower than those obtained in the discrimination of PDpatients vs. yHC subjects. Although such a negative impact,high accuracies were also obtained when classifying PD pa-tients vs. elderly HC subjects (F1 score of up to 0.87). Thebest results are obtained with the kinematic and kinematic +Geometrical feature sets. Similar to the previous case, the bestclassifiers in this experiment were the SVM and the RF. Notealso that the dispersion of the hyper-parameters in this case ismuch larger than in the previous experiment, which gives countof the complexity of the classification problem. Note that thevalues of γ are, smaller than those in the previous experiment,indicating that the models are constrained and the set of supportvectors should include a large number of training samples.Figure 8 shows the Receiver Operating Characteristic (ROC)curves obtained from the previously described classification ex-6Feature extractionKinematicsGeometricalNon-linearDecisionClassification:SVM,KNN,RFTime (s)r(t)r(t) yHC 0100200300-100-200-3000246810Amplitude23 years old HCTime (s)r(t)r(t) eHC 0100200300-100-200-300400024681012Amplitude65 years old HCTime (s)r(t)r(t) PD 0100200300-100-200-300020406080Amplitude64 years old PD patient r(n)r(n-τ)r(n-2τ)23 years old HCr(n)65 years old HCr(n-τ)r(n-2τ)r(n)64 years old PD patient r(n-τ)r(n-2τ)Table 3: Classification of PD patients vs. yHC subjects using SVM, KNN, and RF classifiers. Kinem: kinematic features, Geom: Geometrical features, NLD:NLD features, Acc: Accuracy, Spec. Specificity, Sens. Sensitivity, F1: F1 scoreFeature setTaskSpiralSpiralSpiralSpiralSpiralSpiralSentence Kinem.Sentence NLDSentence Kinem.+NLDC10Kinem.1Geom.Kinem.+Geom.101NLDKinem.+Geom.+NLD10PCA Kinem.+Geom.+NLD 111010SVMγ0.010.10.010.10.010.010.010.10.001Acc (%)94.078.593.777.291.193.792.081.393.3Spec0.940.790.940.770.910.940.920.810.93Sens0.940.780.940.770.910.940.920.810.93F10.940.780.940.770.910.940.920.810.93K Acc (%)35555535386.072.286.169.687.388.686.777.385.3KNNSpec0.890.730.880.710.900.900.880.780.86RFSens0.860.720.860.700.870.890.870.770.85F10.860.720.860.690.870.890.860.770.85N205551510502050D Acc (%)52111551592.477.283.567.188.691.690.774.789.3Spec0.920.780.840.670.890.920.910.750.89Sens0.920.770.840.670.890.920.910.750.89F10.920.770.840.670.890.920.910.740.89Table 4: Classification of PD patients vs. eHC subjects using SVM, KNN, and RF classifiers. Kinem: kinematic features, Geom: Geometrical features, NLD:NLD features, Acc: Accuracy, Spec. Specificity, Sens. Sensitivity, F1: F1 scoreFeature setTaskSpiralSpiralSpiralSpiralSpiralSpiralSentence Kinem.Sentence NLDSentence Kinem.+NLDC100Kinem.100Geom.Kinem.+Geom.100.0001NLDKinem.+Geom.+NLD100PCA Kinem.+Geom.+NLD 1011000.001γ0.0010.00010.0010.00010.00010.0010.010.010.001SVMAcc (%)87.030.786.752.086.789.370.462.053.5Spec0.870.740.890.730.890.890.700.620.75Sens0.870.690.870.520.870.890.700.620.53F10.870.720.870.640.870.890.700.620.68K Acc (%)33575375786.753.381.358.780.081.373.263.478.9KNNSpec0.870.530.840.590.810.810.730.630.80Sens0.860.530.810.590.800.810.730.630.79F10.860.530.810.590.800.810.730.630.79N1051551050155020D1111151015RFAcc (%)85.357.384.056.084.081.078.960.673.2Spec0.850.580.840.580.840.810.790.610.73Sens0.850.580.840.560.840.810.790.610.73F10.850.590.840.580.840.810.790.610.73periments. These curves allow the comparison among resultsobtained in the classification of PD patients and the two groupsof HC subjects. Only results from kinematic and geometricalfeatures extracted from the Archimedean spiral are included. Itcan be observed that the three classifiers provide similar resultsin both experiments. The results when classifying PD vs. eHCconfirm the negative impact of aging in the classification pro-cess. Histograms and the corresponding fitted probability den-Figure 8: ROC curves for the classification of PD patients vs. young HC sub-jects (left) and for PD patients vs. elderly HC subjects (right).sity distribution are shown in Figure 9. The figure illustrates thedistribution of the SVM scores, i.e., the distance of data sam-ples to the separating hyperplane. The statistical significance ofthe results was assessed with a Welch t-test to evaluate the dif-ference in the scores obtained for PD patients and HC subjects.The null hypothesis was rejected for PD vs. yHC (t = −9.043,p (cid:28) 0.005), and for PD vs. eHC (t = −12.817, p (cid:28) 0.005).4.3. Relevance analysisApart from the typical classification between groups of sub-jects, we want to perform a relevance analysis such that al-7Figure 9: Histograms and the corresponding probability density distributionsof the scores obtained from PD patients and yHC subjects (left), and for PDpatients and eHC subjects (right).lows the identification of the most relevant/discriminant fea-tures. This analysis help in finding features that could be po-tentially used in clinical practice not only to make informeddecisions but to provide additional information to the clinicianabout the health state of a patient. In this paper the process isbased on the Principal Component Analysis (PCA) algorithm.The original feature matrix X ∈ Rm×p is reduced to a ma-trix Xr ∈ Rm×q, (q < p) according to a relevance vector ρ =(cid:12)(cid:12)(cid:12), where λ j[ρ1, ρ2, · · · , ρq, · · · , ρp] computed as ρ = (cid:80)pj=1and v j are the eigenvalues and the eigenvectors of the originalfeature matrix [30]. The values of ρ for each feature are relatedwith the contribution of the feature to each principal compo-nent. The original features with higher ρ are the most correlatedwith the principal components and are included to form the re-duced feature space. This approach has been successfully usedin previous studies and its main advantage over other existingfeature selection methods is its low computational cost [31, 32].In this work the relevance analysis is performed upon the fea-ture space formed with kinematic, geometrical and NLD fea-tures extracted from the Archimedian spiral. 90% of the total(cid:12)(cid:12)(cid:12)λ jv jSVM (AUC=0.97)KNN (AUC=0.97)RF (AUC=0.96)SVM (AUC=0.94)KNN (AUC=0.96)RF (AUC=0.94)True positive rateFalse positive rateFalse positive rateTrue positive rate0.00.20.40.60.81.00.00.20.40.60.81.00.00.20.40.60.81.00.00.20.40.60.81.0yHCPDeHCPDDecision threshold-1.5-0.50.00.51.0-1.01.52.02.5-1.5-0.50.00.51.0-1.01.52.0Decision threshold0.20.40.60.81.01.20.00.20.40.60.81.00.0variance is kept in the reduced feature space which is formedwith a total of 18 features for the case of PD vs. yHC, 19 fea-tures for PC vs. eHC, and 16 features for yHC vs. eHC. Table5 indicates the top 10 of the selected features on each case.Table 5: Top 10 of selected features from the Archimedian spiral. ∆ and ∆∆indicate the first and second derivative, respectively.PD vs. eHCa1 of (cid:98)r(t)Skewness of accelerationKurtosis of accelerationMSE between r(t) and (cid:98)r(t)Average accelerationStd. of ∆z(t)2nd spectral component of r(t)Max. accelerationMin. accelerationLZCPD vs. yHCMin. ∆∆pressureAverage speedAverage pressureKurtosis of speedMin. speedSkewness of r(t)Skewness of ∆∆pressureMax. speedMin. ∆z(t)Std. of ∆z(t)The results indicate that the best features to classify PD pa-tients and yHC subjects are those based on the kinematic analy-sis. When considering the case of PD patients vs. eHC, some ofthe geometrical and spectral features appear in the top ten of theselected features. Particularly, the first coefficient of the third-order polynomial (a1) used to model the amplitude of the tra-jectory (cid:98)r(t) appears in the first place of the top ten. Finally, notethat the features selected in the case of eHC vs. yHC are mostlydifferent compared to those selected in the previous cases.The selected features were used to perform two classifica-tion experiments: PD vs. yHC and PD vs. eHC. Results areindicated in Tables 3 and 4, respectively. The aim is to eval-uate the contribution of each selected feature in these classi-fication tasks. Each feature was sequentially added accordingto the order given by the relevance factor ρ. The classificationstep is performed using a SVM. The results are shown in Fig-ure 10A for PD vs. yHC, and in Figure 10B for PD vs. eHC.The bars indicate the relevance factor of each feature and theblack lines indicate the obtained incremental accuracy. Notethat when classifying PD vs. yHC about 90% of accuracy isobtained already with the first two relevant features, indicatingthat the problem is relatively simple and it can be solved witha low dimensional (less complex) feature space. Conversely,when classifying PD vs. eHC at least the first 16 features arerequired to reach accuracies of around 90%. This fact confirmsthe increased complexity of that problem due to the impact ofaging in the handwriting process. We performed additional ex-periments (not reported here) using only those features that pro-vide an incremental improvement in the accuracy, however, theresults were not satisfactory, indicating that all of the selectedfeatures are relevant for the classification process.4.4. Classification using a separate validation setThis experiment is performed with the aim of evaluating theproposed approach in a more realistic scenario. Given that thisset of additional subjects was recorded in sessions different thanthose of the other groups, it is possible to say that this additionalvalidation set represents a group of subjects who arrived in theclinics and performed a handwriting test to decide whether tocontinue with further screenings to validate their neurologicalcondition. The results are shown in Table 6. Note that the pa-rameters of the classifiers are the same as those used in Ta-ble 4, which means that no further optimization was performedover the system, i.e., the patients in the separated validation setnever participated in the configuration/optimization of the clas-sifiers. The accuracy obtained with the KNN and RF classifiersare above 83% in several cases with different feature sets ex-tracted from the Arquimedian spiral. These results are compa-rable to those obtained in the PD vs. eHC experiments, whichconfirms the generalization capability of the proposed approachwhen using the KNN and RF classifiers. The results with theSVM are not as high as with the other classifiers perhaps be-cause the optimization of the two meta-parameters needs a finetunning which was not performed in our experiments to avoidbiased results due to over-fitting. Further experiments will beperformed in the near future with data from more subjects inorder to improve the stability and robustness of this classifier.4.5. Classification of PD patients in different stages of the dis-easeFour-class classification experiments were performed con-sidering four groups: (1) HC subjects; (2) PD patients withMDS-UPDRS-III scores below 20 (initial stage–PD1); (3) PDpatients with MDS-UPDRS-III scores between 20 and 40 (in-termediate stage–PD2); and (4) PD patients with MDS-UPDRS-III scores above 40 (advance stage–PD3). Classification wasperformed with a multi-class SVM following a one vs. all strat-egy. Confusion matrices with the results are reported in Table 7.Results are presented in terms of accuracy (Acc), F1 score (F1),and the Cohen-Kappa index (κ).In this case only drawings of the Archimedean spiral wereconsidered and only the feature sets that exhibited the best re-sults in the experiments with the separate validation set wereextracted: kinematic; kinematic + geometrical; and kinematic+ geometrical + NLD (see Table 6). Additionally, we exploredthe suitability of the feature set selected with PCA which waspreviously used to classify between HC and eHC subjects (Sec-tion 4.3). The results indicate that HC subjects can be accu-rately classified, while the patients in advance stage (PD3) arethe most difficult to be discriminated. The results with kine-matic + geometrical features are similar to those obtained withkinematic + geometrical + NLD features, which likely indi-cates that the nonlinear features are not complimentary to thekinematic and geometrical ones, at least to discriminate dif-ferent stages of PD. The confusion matrix also indicates thatdimensionality reduction does not have positive impact in theresults, conversely increases the false positive rate making thesystem to confuse HC subjects with patients in initial (PD1) orintermediate (PD2) stages of the disease.5. DiscussionKinematic features seem to be the most suitable to performthe automatic discrimination between PD patients and HC sub-8ABFigure 10: Classification of PD vs. yHC subjects (left) and PD vs. eHC subjects (right) when the selected features are sequentially added.Table 6: Classification of PD patients vs. HC subjects using the separate validation set. Kinem: kinematic features, Geom: Geometrical features, NLD: NLDfeatures, Acc: Accuracy, Spec. Specificity, Sens. Sensitivity, F1: F1 scoreFeature setTaskSpiralSpiralSpiralSpiralSpiralSpiralSentence Kinem.Sentence NLDSentence Kinem.+NLDC100Kinem.100Geom.Kinem.+Geom.100.0001NLDKinem.+Geom.+NLD100PCA Kinem.+Geom.+NLD 1011000.001γ0.0010.00010.0010.00010.00010.0010.010.010.001SVMAcc (%)50.058.366.650.058.366.675.058.350.0Spec0.500.230.690.750.580.660.760.590.75Sens0.500.410.670.500.580.660.750.590.50F10.500.290.660.660.580.660.750.590.66K Acc (%)33575375783.358.381.358.483.366.658.359.050.0KNNSpec0.830.590.840.590.830.660.610.590.50Sens0.830.580.810.580.830.660,420.590.50F10.830.580.810.590.830.660.720.610.67N1051551050155020RFD Acc (%)111115101566.658.383.364.372.050.058.451.251.3Spec0.690.610.930.650.710.500.500.510.51Sens0.660.580.920.650.710.500.500.510.51F10.660.550.920.650.710.520.500.510.51Table 7: Confusion matrices with results of classifying HC subjects and PD patients in different stages of the disease. PD1: patients with MDS-UPDRS-III scoresbetween 0 and 20. PD2: patients with MDS-UPDRS-III scores between 21 and 40. PD3: patients with MDS-UPDRS-III scores above 40. Spiral PCA indicates theresults obtained with the set of 19 features that results after the feature selection process when classifying PD vs. eHC (see Figure 10). The results are expressed in(%). F1: F1 score. κ: Cohen-kappa index.Spiral Kinem.Acc=61.3, F1=0.58, κ=0.40PD3HC0.097.238.515.414.321.416.733.3PD22.815.435.716.7PD10.030.828.633.3HCPD1PD2PD3Spiral Kinem.+Geom.Acc=64.0, F1=0.62, κ=0.44PD3HC0.097.238.515.435.721.433.333.3PD10.038.514.316.7PD22.87.728.616.7Spiral Kinem+Geom+NLDAcc=64.0, F1=0.62, κ=0.44PD3HC0.097.230.815.428.621.433.333.3PD10.038.521.416.7PD22.815.428.616.7Spiral PCAAcc=57.3, F1=0.55, κ=0.36PD3HC0.091.730.815.414.328.68.30.0PD25.515.428.641.7PD12.838.528.650.0jects (young or elderly). The combination of the three featuresets in the same space also exhibited good classification results.Besides the binary classification, a relevance analysis was per-formed. According to the results, the most discriminative fea-tures are geometrical and kinematic. Most of the selected fea-tures as relevant are related to speed, pressure, and accelerationof the strokes, which is related to the deficits exhibited by pa-tients when performing motor activities like handwriting. Pa-tients in different stages of the disease were also classified andκ indexes between 0.36 and 0.44 were obtained. The resultsindicate that, at least in the experiments performed here, thenonlinear features do not contribute to improve the classifica-tion of different stages of the disease. An additional experimentwith a separate validation set with PD and HC subjects was per-formed. This validation set was built during recording sessions9different than those performed to collect the signals consideredin the other experiments. Thus this additional experiment al-lows the evaluation of the proposed approach in real conditions.The results show that it is possible to discriminate between PDand HC subjects (in the separate validation set) with accuraciesof up to 83.3%. To the best of our knowledge, this is the firstwork that considers experiments with separate and independentvalidation samples. Further research should be performed bycombining the proposed model with novel approaches based ondeep learning methods [16, 14]. In addition, longitudinal stud-ies should be performed to understand and track the progress ofthe disease in the PD patients through time.min. press.mean vel.mean press.kurtosis vel.min. vel.skew. r(t)skew. press.''max. vel.min. z'std z'kurtosis press.'kurtosis press.skew. zmin. accel.skew. vel.max. press.kurtosis r(t)kurtosis accel.Accuracy (%) 6065707580859095a1skew. accel.kurtosis accel.MSEmean accel.std z'H2max. accel.min. accel.LZCkurtosis press.skew. press.'mean z'max. r(t)kurtosis press.''max. press.std press.'skew. r(t)mean zAccuracy (%) 6570758085906. ConclusionThis paper explored and evaluated the suitability of threedifferent feature sets (kinematic, geometrical and NLD) to modelhandwriting impairments exhibited by PD patients. We providean accurate method to classify between Parkinson’s patientsand healthy subjects. The model was validated in a differentdataset, and high accuracies were obtained (83.3%). The clas-sification of Parkinson’s patients in several stages of the diseaseis promising. We are aware of the fact that more research anda larger sample of patients is necessary to lead to more conclu-sive results; however, we think that the results presented hereare a step forward to the development of non-intrusive methods,useful in clinical practice, to diagnose and monitor Parkinson’spatients.Future studies will include the comparison of the proposedapproach with recent studies based on deep learning strategies,which have shown to be also accurate to model the handwritingdeficits of PD patients.AcknowledgmentsThe authors thank to the patients of Fundalianza ParkinsonColombia for their invaluable support of this study. This workwas financed by CODI from UdeA grants PRG2015–7683 andPRV16-2-01, and from the European Unions Horizon 2020 re-search and innovation programme under the Marie Sklodowska-Curie Grant Agreement No. 766287.Ethical Approval and informed consent: Informed consentwas obtained from all participants of the study. All procedureswere in accordance with the ethical standards of the institu-tional research committee and with the 1964 Helsinki declara-tion and its later amendments. The procedures were approvedby the Ethical Research Committee of the University of Antio-quia.ReferencesReferences[1] O. Hornykiewicz, Biochemical aspects of Parkinson’s disease, Neurology51 (2 Suppl 2) (1998) S2–S9.[2] R. F. Pfeiffer, Z. K. Wszolek, Parkinson’s disease, CRC Press, 2004.[3] A. Letanneux, J. Danna, J. Velay, F. Viallet, S. Pinto, From micrographiato parkinson’s disease dysgraphia, Movement Disorders 29 (12) (2014)1467–1475.[4] C. G. Goetz, et al., Movement Disorder Society-sponsored revision of theUnified Parkinson’s Disease Rating Scale (MDS-UPDRS): Scale presen-tation and clinimetric testing results, Movement Disorders 23 (15) (2008)2129–2170.[5] R. Pahwa, K. E. Lyons, Handbook of Parkinson’s disease, CRC Press,2013.[6] A. Schrag, Y. B. Ben-Shlomo, N. Quinn, How valid is the clinical diag-nosis of Parkinson’s disease in the community?, Journal of Neurology,Neurosurgery & Psychiatry 73 (5) (2002) 529–534.[7] S. J. Johnson, M. D. Diener, A. Kaltenboeck, H. G. Birnbaum, A. D.Siderowf, An economic model of Parkinson’s disease: implications forslowing progression in the United States, Movement Disorders 28 (3)(2013) 319–326.[8] Y. Sarbaz, F. Towhidkhah, V. Mosavari, A. Janani, A. Soltanzadeh, Sepa-rating parkinsonian patients from normal persons using handwriting fea-tures, Journal of Mechanics in Medicine and Biology 13 (03) (2013)1350030.[9] S. Rosenblum, M. Samuel, S. Zlotnik, I. Erikh, I. Schlesinger, Handwrit-ing as an objective tool for Parkinson’s disease diagnosis, Journal of Neu-rology 260 (9) (2013) 2357–2361.[10] P. Drot´ar, J. Mekyska, I. Rektorov´a, L. Masarov´a, Z. Sm´ekal, M. Faundez-Zanuy, Analysis of in-air movement in handwriting: A novel marker forparkinson’s disease, Computer Methods and Programs in Biomedicine117 (3) (2014) 405–411.[11] P. Drot´ar, J. Mekyska, I. Rektorov´a, L. Masarov´a, Z. Sm´ekal, M. Faundez-Zanuy, Evaluation of handwriting kinematics and pressure for differentialdiagnosis of Parkinson’s disease, Artificial intelligence in Medicine 67(2016) 39–46.[12] J. C. V´asquez-Correa, J. R. Orozco-Arroyave, et al., Multi-view represen-tation learning via GCCA for multimodal analysis of Parkinson’s disease,in: 42nd IEEE International Conference on Acoustics, Speech, and SignalProcessing (ICASSP), 2017, pp. 2966–2970.[13] K. L´opez-de Ipi˜na, A. Bergareche, P. De La Riva, M. Faundez-Zanuy,P. M. Calvo, J. Roure, E. Sesa-Nogueras, Automatic non-linear analysisof non-invasive writing signals, applied to essential tremor, Journal ofApplied Logic 16 (2016) 50–59.[14] C. R. Pereira, D. R. Pereira, G. H. Rosa, V. H. Albuquerque, S. A. Weber,C. Hook, J. Papa, Handwritten dynamics assessment through convolu-tional neural networks: An application to parkinson’s disease identifica-tion, Artificial intelligence in medicine 87 (2018) 67–77.[15] C. Gallicchio, A. Micheli, L. Pedrelli, Deep echo state networks for diag-nosis of parkinson’s disease, arXiv preprint arXiv:1802.06708.[16] J. C. Vasquez-Correa, T. Arias-Vergara, J. R. Orozco-Arroyave, B. Es-kofier, J. Klucken, E. N¨oth, Multimodal assessment of parkinson’s dis-ease: a deep learning approach, IEEE journal of biomedical and healthinformatics (In press).[17] C. De Boor, A practical guide to splines, Vol. 27, Springer-Verlag NewYork, 1978.[18] M. G. Longstaff, R. A. Heath, A nonlinear analysis of the temporal char-acteristics of handwriting, Human Movement Science 18 (4) (1999) 485–524.[19] F. Takens, et al., Detecting strange attractors in turbulence, Lecture notesin mathematics 898 (1) (1981) 366–381.[20] M. B. Kennel, R. Brown, H. D. Abarbanel, Determining embedding di-mension for phase-space reconstruction using a geometrical construction,Physical review A 45 (6) (1992) 3403.[21] S. Pincus, Approximate entropy (ApEn) as a complexity measure, Chaos:An Interdisciplinary Journal of Nonlinear Science 5 (1) (1995) 110–117.[22] J. S. Richman, J. R. Moorman, Physiological time-series analysis us-ing approximate entropy and sample entropy, American Journal ofPhysiology-Heart and Circulatory Physiology 278 (6) (2000) H2039–H2049.[23] L. S. Xu, K. Q. Wang, L. Wang, Gaussian kernel approximate entropy al-gorithm for analyzing irregularity of time-series, in: International Confer-ence on Machine Learning and Cybernetics, Vol. 9, 2005, pp. 5605–5608.[24] P. Grassberger, I. Procaccia, Measuring the strangeness of strange attrac-tors, in: The Theory of Chaotic Attractors, Springer, 2004, pp. 170–189.[25] H. E. Hurst, Long term storage: An experimental study, Constable, Lon-don, 1965.[26] M. T. Rosenstein, J. J. Collins, C. J. De Luca, A practical method forcalculating largest lyapunov exponents from small data sets, Physica D:Nonlinear Phenomena 65 (1-2) (1993) 117–134.[27] A. Lempel, J. Ziv, On the complexity of finite sequences, IEEE Transac-tions on information theory 22 (1) (1976) 75–81.[28] F. Kaspar, H. G. Schuster, Easily calculable measure for the complexityof spatiotemporal patterns, Physical review A 36 (2) (1987) 842–848.[29] C. Travieso, J. Alonso, J. R. Orozco-Arroyave, J. Vargas-Bonilla, E. N¨oth,R.-G. A.G., Detection of different voice diseases based on the nonlin-ear characterization of speech signals, Expert Systems With Applica-tions (82) (2017) 184–195.[30] G. Daza-Santacoloma, J. D. Arias-Londo˜no, J. I. Godino-Llorente,N. S´aenz-Lech´on, V. Osma-Ru´ız, G. Castellanos-Dom´ınguez, Dynamicfeature extraction: an application to voice pathology detection, IntelligentAutomation & Soft Computing 15 (4) (2009) 667–682.10[31] J. R. Orozco-Arroyave, S. Murillo-Rend´on, et al., Automatic selection ofacoustic and non-linear dynamic features in voice signals for hypernasal-ity detection, in: 12th International Conference of the Speech Communi-cation Association (INTERSPEECH), 2011, pp. 529–532.[32] T. Arias-Vergara, J. C. V´asquez-Correa, J. R. Orozco-Arroyave, Parkin-son’s Disease and Aging: Analysis of Their Effect in Phonation and Ar-ticulation of Speech, Cognitive Computation 9 (6) (2017) 731–748.11