Nonconvulsive Epileptic Seizure Monitoring with IncrementalLearningYissel Rodr´ıguez Aldana1,2, Enrique J. Mara ˜n ´on Reyes1, Frank Sanabria Macias3, Valia Rodr´ıguezRodr´ıguez4,5,6, Lilia Morales Chac ´on7, Sabine Van Huffel2, and Borb´ala Hunyadi2,81Universidad de Oriente, Center of Neuroscience and Signals and Image Processing. Santiago de Cuba, Cuba. email:yraldana@gmail.com2KU Leuven, Department of Electrical Engineering (ESAT), Stadius Center for Dynamical Systems, Signal Processing and Data Analytics.3Escuela Polit´ecnica Superior, Universidad de Alcal´a, Alcal´a de Henares, SpainLeuven, Belgium.4Aston University. Birmingham, United Kingdom.5Cuban Neuroscience Center. Havana, Cuba.6Clinical-Surgical Hospital “Hermanos Almeijeiras”. Havana, Cuba7International Center of Neurological Restoration. Havana, Cuba.8Department of microelectronics, Delft University of Technology. Delft, NetherlandsSeptember 2, 20191 AbstractNonconvulsive epileptic seizures (NCSz) and nonconvulsive status epilepticus (NCSE) are two neurological entitiesassociated with increment in morbidity and mortality in critically ill patients. In a previous work, we introduced amethod which accurately detected NCSz in EEG data (referred here as ‘Batch method’). However, this approach wasless effective when the EEG features identified at the beginning of the recording changed over time. Such patterndrift is an issue that causes failures of automated seizure detection methods. This paper presents a support vectormachine (SVM)-based incremental learning method for NCSz detection that for the first time addresses the seizureevolution in EEG records from patients with epileptic disorders and from ICU having NCSz. To implement the in-cremental learning SVM, three methodologies are tested. These approaches differ in the way they reduce the set ofThis work has been supported by the Belgian foreign Affairs-Development Cooperation through VLIR-UOS (2013-2019) (Flemish Interuniver-sity Council-University Cooperation for Development) in the context of the Institutional University Cooperation program with Universidad deOriente.The research leading to these results has received funding from imec funds 2017 and the European Research Council under the European Union’sSeventh Framework Programme (FP7/2007-2013) / ERC Advanced Grant: BIOTENSORS (no.339804). This paper reflects only the authors’ viewsand the Union is not liable for any use that may be made of the contained information.1potentially available support vectors that are used to build the decision function of the classifier. To evaluate thesuitability of the three incremental learning approaches proposed here for NCSz detection, first, a comparative studybetween the three methods is performed. Secondly, the incremental learning approach with the best performance iscompared with the Batch method and three other batch methods from the literature. From this comparison, the incre-mental learning method based on maximum relevance minimum redundancy (MRMR IL) obtained the best results.MRMR IL method proved to be an effective tool for NCSz detection in a real-time setting, achieving sensitivity andaccuracy values above 99%.Keywords Nonconvulsive epileptic seizures, Hilbert Huang Transform, Multiway Data Analysis, IncrementalLearning.2IntroductionNonconvulsive epileptic seizures (NCSz) and nonconvulsive status epilepticus (NCSE) are two related neurologicalentities that are frequently found in critically ill patients [1, 2]. Despite the nonconvulsive nature, they are associatedwith increment in morbidity and mortality in the intensive care unit (ICU). Since NCSz/NCSE present subtle or noovert clinical signs, it is not uncommon that in patients with altered mental status or coma they remain unnoticed anduntreated for long periods of time. Studies carried out in this population have reported though that NCSE lastingmore than 10 hrs are associated with permanent disabilities, while mortality is very high in NCSE lasting more than20 hrs [3].When suspected, NCSz/NCSE diagnosis is carried out using continuous EEG (cEEG) monitoring. However,several studies have reported that the likelihood to detect the first NCSz increases in patients at risk (i.e.: comatosepatients and children) when EEG is recorded for more than 24 hours [4]. Hence, seizure detection in ICU couldbe an exhausting and time-consuming process. To assist on the visual identification of changes, quantitative trendssummarizing EEG amplitude and frequency composition as well as annotating the presence of seizures have beenrecently introduced to the continuous EEG monitoring technique.Previous algorithms developed for NCSz detection combined wavelet analysis [5, 6, 7, 8], entropy [9, 10], nonlinearparameters [6, 9, 11], statistical and spectral features of the EEG [9, 10, 11, 12, 13, 14] with various machine learningtechniques [8, 9, 10, 11, 13, 15] or thresholds [6, 7, 12, 14] to detect the NCSzs. These algorithms obtained a reasonablesensitivity (over 90% in most cases) during the test process [16]. Among the methods with better results in the contextof NCSz detection in patients with epileptic etiology are those proposed by Kollialil at al (2013) [9], Sharma et al (2014)[8] and Fatma et al (2016) [14].Figures 1, 2 and 3 display the block diagrams of Kollialil’s, Sharma’s and Fatma’s methods respectively. As canbe appreciated, the cited methods iterate over the EEG channels at least until the feature extraction step. This meansthe features are extracted from a single channel without considering important characteristics of the seizure as thesynchronization and spread out/in of the seizure activity over the EEG channels [17]. These methods intended toexploit the possible cross information of the channels by combining the features computed individually into oneclassifier, as in Kollialil’s method, or imposing hard thresholds, as in Sharma’s and Fatma’s methods.Kollialil et al. proposed a patient independent training for a linear SVM. The NCSz characteristics vary enor-mously across patients. This implies that the number of patterns used to train a patient independent classifier must2Figure 1: Block diagram of the method proposed by Kollialil et al.[9] absence seizure detection. The proposaluses a multiclass SVM and a single feature vector computed from the fifth detail wavelet coefficients. Features asenergy, mean energy, entropy, mean cross-correlation, mean curve length, the coefficient of variation, interquartilerange (IQR) and median absolute deviation (MAD) are compared to obtain an optimal single feature. The data forthis experiment consisted of normal, epileptic and interictal EEG data from 100 subjects, from a reputed NeurologyClinic. The best performances were found for the energy, entropy, MAD, and IQR with an accuracy above 95%. Thebest feature was the IQR with an accuracy value of 99.66 %.be quite large. Given the nonconvulsive nature of NCSz the existent databases are small. With such databases it is notlikely to successfully train a classifier capable to generalize the acquired knowledge to other NCSz data, especiallyin case the data originate from ICU patients. Taking into account this characteristic of the NCSz, Sharma et al. andFatma et al. proposed patient specific methods. However, their approaches ignore the fact that the EEG patternspresent in a specific record could also differ. Having this in mind, the methods proposed by Sharma et al. and Fatmaet al. cannot guarantee to maintain their performance in longer records where these changes are more likely to occur.There are two main drawbacks in the methods proposed in the literature for NCSz detection. First, they employ apatient independent training of the classifiers and, second, thresholds for the detection are arbitrarily set. In general,the duration of the seizure and the number of channels displaying seizure activity are the most popular thresholdingcriteria [7, 15, 13, 8]. If the seizure is too short in time or affects just a few channels it is not detected. Furthermore,NCSz characteristics vary across patients. EEG patterns present in a specific record could also differ depending on thepatient disease’s etiology. Therefore, a threshold or classifier which works for one patient will not necessarily workfor another. Additionally, a more meaningful description of the seizure’s spatial localization should be considered,for instance its whole head topography instead of its distribution in a limited number of channels.In [18] we proposed a patient-specific method that mitigates the need of thresholds to detect the NCSz. Thismethod identifies the NCSz by exploiting the similarity between the first NCSz detected by the physician on theEEG and the rest of the NCSz in the recording [19].The method expands the EEG using the Hilbert Huang Transform(HHT) into a third-order tensor. This multiway representation of the data exploits the EEG high-dimensional struc-ture by analyzing its spectral, temporal and spatial properties simultaneously. This is a fundamental difference com-pared to the methods of Sharma [8] and Fatma [14] : in our approach, multichannel information is integrated at the3Figure 2: Block diagram of the patient specific method proposed by Sharma et al. [8] for nonconvulsive epilepticseizures detection ((cid:93) denotes “number of ”). The proposed algorithm analyzed the EEG in epochs of 1-second du-ration. Each epoch was denoised using wavelet analysis applying cubic thresholding. The extracted features arethe IQR, the MAD, and the Normalized Covariance, normalized by the median of their background EEG features.The dataset used for testing consisted of 24 seizures recorded from the EEG of 9 subjects in the All India Institute ofMedical Sciences. This method requires the seizure activity to be present in at least 50% of the channels. Otherwise,the seizures will be missed. The method reported 100% of sensitivity and 99.3% of specificity.Figure 3: Block diagram of the patient specific method proposed by Fatma et al. [11] for nonconvulsive epilepticseizures detection ((cid:93) denotes “number of ”). The algorithm analyzes the EEG in epochs of 1-second duration fromwhich the mean absolute difference is computed. To differentiate seizure from normal EEG, the method uses thresh-olds over the computed parameter. The method reported sensitivity and specificity of 100% and 99.21% respectively.4Figure 4: . General block diagram of the patient specific method proposed by Rodr´ıguez et al. [18] for nonconvulsiveepileptic seizures. This method identifies the NCSz by exploiting the similarity between the first NCSz detectedby the physician on the EEG and the rest of the NCSz in the recording. The explored features are obtained bymeans of a multiway analysis of the EEG signal represented as a third-order tensor X ∈ R(F ×T ×Ch) with modesf requency × time × channels. The tensors are computed by expanding EEG segments of 3 s duration using HilbertHuang Transform (HHT). The tensor decomposition is performed with Canonical Polyadic Decomposition (CPD).The method uses the spatial component from the CPD as features of a SVM to discriminate between seizure andnon-seizure segments.level of feature extraction via a tensor decomposition, as opposed to performing separate feature extraction per chan-nel. There is evidence that exploiting the (multi)-linear structure inherently present in multichannel EEG achievessuperior performance compared to methods that ignore such structure [20, 21].The spatial component extracted fromthis multiway EEG representation with canonical polyadic decomposition (CPD) accurately characterized the seizurepattern. The algorithm achieved average sensitivity and specificity values over 98%. Figure 4 shows the block dia-gram of the method proposed in [18]. However, this approach also disregarded the seizure pattern changes withinan EEG record. It showed to be less accurate for records where the EEG morphology evolved over time and themorphological characteristics varied with respect to the beginning of the record.Nonconvulsive epileptic seizures and status in epileptic and critically ill patients present a different temporal andmorphological evolution. It is common, for instance, that seizures in a critically ill patient develop from an ictal-interictal continuum composed of periodic discharges or rhythmic activity, waxing and waning over long periodsof time, or fluctuations from low amplitude and/or low frequency seizures. These phenomena are the reason whyseizure detection algorithms developed for epilepsy studies fail in the critical care context [22, 23, 24]. Trained andexperienced medical specialists are able to identify epileptic seizure EEG patterns in complex scenarios, e.g. when thebackground EEG resembles ictal activity. Similarly, automatic seizure detection methods need appropriate trainingto solve a complex signal processing and pattern recognition task.Several authors addressed this phenomenon in methods proposed for convulsive epileptic seizure detection al-lowing the user to control the classification process using thresholds or tuning some parameters [25, 26, 27]. However,these algorithms are not able to learn new seizure patterns that may appear on the EEG. Other authors [28, 29] usedonline learning techniques in their proposals to incorporate novel patterns to be added to the already known ones bythe classifier. None of the methods proposed for NCSz addressed this issue.5The most commonly used training strategy for a machine learning algorithm is the batch method [18, 8, 9, 14, 30].In the batch method, the algorithm has a fixed number of samples that are used to train a classifier. The trainedclassifier is then applied to new samples without further updating. Most classifiers are trained with batches of datacoming from several patients. However, patient-specific solutions are expected to perform much better. In a bettersolution, the patients’ EEG should be recorded for some time to train the classifier. As new information is continu-ously becoming available, and the patients’ seizures may evolve in morphology, the classifier must be updated onlineusing the latest EEG data. However, simply including all new incoming data is not practical as it would continuouslyincrease memory and computational requirements.This paper presents an SVM-based incremental learning method for NCSz detection that for the first time ad-dresses the seizure evolution in EEG records from patients with epileptic disorders and from ICU having NCSz. Themethod proposed here, provides improved performance compared to the method introduced in [18] (referred here as‘Batch method’), while maintaining similar memory requirements. To introduce the incremental learning step in theBatch method, three methodologies are tested. These approaches differ in the way they reduce the set of potentiallyavailable support vectors (i.e. training samples) that are used to build the decision function of the classifier: 1) Discarda fixed number of support vectors after the classifier retraining, based on a predefined threshold. From now referredas ‘Hard IL’, 2) Select an optimal support vector subset using cross-validation. From now referred as ‘Cross IL’, and3) Select an optimal support vector subset using an approximate technique for incremental SVM proposed by Yang[31] based on the maximum relevance minimum redundancy (MRMR) feature selection method [32]. From now re-ferred as ‘MRMR IL’. To our knowledge this is the first time Yang’s algorithm is used for a practical implementation.The MRMR IL approach provides an algorithm to select appropriately the patterns to update the classifier, avoidingto incorporate random patterns as done in [28] and not requiring the user intervention in the updating process as in[29]. To evaluate the suitability of the three incremental learning approaches proposed here for NCSz detection, first,a comparative study between the three methods is performed. Secondly, the incremental learning approach with thebest performance is compared with the Batch method and three other batch methods from the literature [8, 9, 14] thatreported better performance than the Batch method in some sense (for the results of this comparison, see [18]).3 Materials and methods3.1 EEG dataThe EEG data were collected at the Epilepsy Unit of the Cuban International Neurological Restoration Center (CIREN)and the ICU of the Clinical Surgical Hospital “Hermanos Ameijeiras ”, both in Havana City. A video-telemetry EEG(vEEG) study was performed on all patients. For clarity of exposition, we will denote the patients recorded at theEpilepsy Unit as vEEG, and the ones recorded at the ICU, as ICU. The dataset comprised EEG clips of about 14minto more than 21h (mean 280min 21s) of 14 patients with ages between 18 and 57 years and different brain disordersleading to NCSz. The visual inspection and seizure labeling were performed by two pairs of neurophysiologists(including the authors VRR and LMC). All recordings were re-analyzed for the purpose of this study. Each pair ofneurophysiologists independently labeled the ICU or vEEG seizures. In case of disagreement it was resolved bydiscussion. A total of 117 NCSz were identified (55/117 were associated to coma or other acute brain dysfunction).6Table 1 presents a more detailed description of the dataset. The data were anonymized before their use in this study.All procedures were reviewed and approved by the Ethical Committees of the CIREN and “Hermanos Ameijeiras”Hospital respectively.Table 1: Description of the EEG Database. In the table ’x’ and ’o’ indicate whether the signal was recorded or nottogether with the EEG for each patient. vEEG stands for video-telemetry EEG. ICU stands for continuous EEGrecorded in the intensive care unit.Patient dataRecordingProtocolPatient GenderDiagnosisTypeSeizuresChannelsEKG EOG EMG Video1234567891011121314MMMFFFFFMFMFFFTemporal lobe epilepsyTemporal lobe epilepsyTemporal lobe epilepsyTemporal lobe epilepsyLennox-Gastaut syndromeTemporal lobe epilepsyTemporal lobe epilepsyJuvenil myoclonic epilepsyFrontal lobe epilepsyComa /Subaracnoid HaemorrhageMyoclonic Seizures /Brain TumorComa/ Systemic VasculitisSeizures/Brain Tumor /SepsisGeneralized Tonic-Clonic SeizuresvEEGvEEGvEEGvEEGvEEGvEEGvEEGvEEGvEEGICUICUICUICUICU631352212634402653191919191919171717191381914ooooooxxxxxxxxooooooxxxxoxxxooooooxxxxxxxoxxxxxxxxxxxxxx3.2 Batch methodThe Batch method in [18] analyses the EEG data in non-overlapping segments (epochs) of 3 seconds long. All epochsare expanded in the time-frequency domain using an Hilbert Huang Transform (HHT). A 3rd order tensor is builtfrom every epoch with modes f requency × time × channels.The tensors built in this way are decomposed using a canonical polyadic decomposition (CPD) [33] with rank one.In other words, we model the EEG data as the outer product of three vectors, that describe the signature of the EEG intime, frequency and across channels. The values of these signature vectors can be used as features for classification,as we will describe below. From now on, we will refer to the channel mode vector as ’spatial signature’. In [18] wehave shown that the spatial signature is a powerful feature to discriminate between NCSz and NCSz-free (n-NCSz)epochs. Therefore, we will use only the spatial signature in this study.To discriminate between the two classes NCSz and n-NCSz (seizure and seizure free) a support vector machines=1 , xs ∈ RCh×1 (Ch is the number of channels) withs=1 ∈ {±1} (seizure or seizure-free), the SVM attempts to infer a model M0 that correctly estimates the(SVM) classifier is used. Given a set of S training data {xs}Slabels {ys}S7labels ˆynew of a new test vector xnew based on a function of the formˆynew = sign[wT φ(xnew) + w0](1)where w, a set of weights and φ is a nonlinear transformation that maps the input data to a higher dimensionalfeature space. The objective of the SVM formulation is to construct a separating hyperplane in the feature space withmaximal margin. This can be translated to a convex optimization problem. In the dual space, the classifier takes theformˆynew = signS(cid:88)s=1αsysk(xs, xnew) + b(2)where k(xs, xnew) = φ(xnew)φ(xs) is a symmetric and positive definite kernel function that defines the innerproduct of xnew and xs in the higher dimensional space. Here, we use a Gaussian kernel. The xs input vectorscorresponding to non-zero αk values are called support vectors.As described in [18], we propose to start the NCSz monitoring after the clinicians identify the first epileptic seizure.The duration of the first seizure determines the number of NCSz epochs used for the training. The same numberof n-NCSz epochs are selected as non-seizure training points, starting from the beginning of the first seizure andgoing back towards the beginning of the recording. In other words, if the first seizure is of length L ‘epochs’, thenS = 2(cid:98)L/3(cid:99).3.3Incremental learning3.3.1 Training roundsThe batch method uses a fixed model M0 throughout the whole duration of the monitoring, that is trained based onthe data up to the first seizure. As opposed to this, the purpose of incremental learning is to regularly update themodel in order to ensure adaptability to the evoling EEG morphology within the same patient. We propose to updatethe model after regular time intervals of duration t using the EEG data collected during this time period. The value oft is selected arbitrarily as t = 10min for short EEG recordings (< 2h) and t = 2h for longer recordings (> 2h). Thesevalues were chosen based on evaluating the real chance of observing morphology changes in the EEG. The cliniciansestablish the recording time for a patient by considering how long it would take to register an epileptic event giventhe patient etiology or clinical state. It is assumed in this approach that the duration of the EEG will depend on whenthe clinician is expecting to see the EEG changes. That is, in short recordings we expect that EEG changes will developsooner than in longer recordings. In practice, the parameter t can be specified by the specialist at the start of the EEGmonitoring. The data collected during this time is defined as a training round.3.3.2 Double labeling of training dataAfter t time has elapsed since the last seizure, it is time to obtain the new model Mt including the newly collecteddatapoints xnnew and their corresponding labels ynnew in the existing training dataset. However, in a practical setting,no expert is available to provide labels to the new datapoints. To overcome this problem and obtain training labelsfor computing the new model Mt, we will use the labels that are predicted by Mt−1 (see Fig. 5 for the definition of8the notation used). However, the labels estimated by Mt−1 could be erroneous. If this is the case, the error could bepropagated into the classifier during the updating process, leading to a so-called concept drift [34]. Concept driftsare problematic since they lead to conflicts in the classification. The classifier performance will decrease until themodel can be updated appropriately. To reduce the chances of generating a concept drift with the labels provided bythe model Mt−1, a double set of labels are predicted, one provided by Mt−1, and additionally, another set using thepartial least squares method (PLS) [35].The PLS prediction model is trained with the same xs samples used to estimate the model Mt−1 and their cor-responding ys labels provided by the neurophysiologist. Then, the trained PLS model is used to predict the y[P LS]nnewlabels of the xnnew samples. In order to verify the suitability of the PLS method within this context, we first tested itsperformance using a batch approach, prior to applying it for the double labeling in the incremental learning setting.The PLS model was tested on a set of 14 EEG recordings and showed a positive predictive value (PPV) of 98.9% anda sensitivity of 97.6%. We describe the details of this study in [36].Due to the double labeling, two sets of labels are available for xnnew : ynnew provided by the model Mt−1 andnnew provided by PLS. The samples xnsel for which both methods estimate the same label ( ynnew = y[P LS]y[P LS]selected for estimating Mt.nnew ) are3.3.3 Conservative updatingThe selected samples xnsel are split into training and validation sets. The updating is then performed in two steps.First, a temporary model Mtemp is estimated only using the selected training samples. Secondly, the support vectors(SV) from Mt−1 and Mtemp are combined together. An optimal subset of the combined SVs are used to build themodel Mop, that is tested on the validation set (An explanation on why and how to choose the optimal subset willfollow below in section 3.3.4). Then, the model Mt−1 is also tested on the validation set. Finally, after comparing Mt−1and Mop, the one with the better performance is assigned to be the new Mt model. The same updating procedure isperformed after every training round.3.3.4 Controlling model growthFollowing the procedure above without the selection of an optimal subset of SVs, the size of the model, defined bythe number of support vectors (SVs), would grow with the number of new training samples after each update.Therefore, it is necessary to take some actions to limit the number of SVs in the solution. A regularization factor/Nsv is introduced to limit the growth of the number of SVs, φ ∈ R : 0 < φ ≤ 1. NsvMt denotes the numberφ = NsvMtof SVs from the model Mt, while Nsv denotes the sum of the SV from Mtemp and Mt−1. Finally, the size of the SVsubset is computed as SVsub = φNsv.The three methodologies, defined in the introduction as Hard IL, Cross IL, and MRMR IL, are tested, to selectthe optimal subset of SV. For all methodologies the new samples are divided into training and test set. A new modelMtemp is trained with the training set. The SV from the models Mt−1 and Mtemp will become candidate SVs for thenew model Mop.To control the model growth, Hard IL accumulates the SV of a number of training rounds, tr (user-specifiedparameter). Then, after tr training rounds, at every new training round, the oldest Nsv − φNsv SV are discarded to9obtain the SV subset for the model Mop. For this implementation, tr = 2 was selected. For tr > 2 the execution timeincreases without significant improvements in the algorithm accuracy. Fig. 5 (B) describes the Hard IL algorithm.For Cross IL given the SV from the models Mt−1 and Mtemp a 5-fold (of length φNsv) cross-validation is appliedto find the optimal subset of SVs. This means that the set of all available SV is shuffled into five different subsets ofsize φNsv. Hence, the performance of the five subsets is tested, and the subset with the best performance will becomeMop. Fig. 5 (C) illustrates the diagram of the Cross IL algorithm.The MRMR IL approach implements the incremental SVM algorithm proposed in [31] to estimate the optimalsubset of SVs. In [31] the selection of the subset of SVs is formulated as equivalent to a feature selection problem. Theequivalence can be observed if the SVM decision function in the dual space is written asf (x) = ωT K + ω0T(3)where ω = [α1y1, α2y2 . . . , αNsv yNsv ] is the weight vector, K ∈ RNsv×Nsv is the kernel matrix, with the element inthe ith row and jth column Ki,j = k(xi, xj). Nsv is the number of SVs and ω0 ∈ R1×NSV , is a bias vector containingthe bias term ω0 in each element. The decisions are made according to sign(f (x)). This equation is very similar to thedecision function of a simple linear classifierg(x) = βT X + βT0(4)where X ∈ RL×M is a data matrix with L number of features describing M data samples, β ∈ RL×1 the corre-sponding weight vector and β0 ∈ RM ×1 is the vector containing the bias term β0 in each element.In the context of feature selection, the aim is to drop some of the features (i.e. the rows of the data matrix X) andthe corresponding weights, but at the same time achieving correct decisions using g(x).By exploiting the similarities between (3) and (4) the kernel matrix K ∈ RNsv×Nsv can be interpreted as a datamatrix in the feature selection context where each column of K corresponds to a data sample and each row of K (i.e.support vector) corresponds to a feature. Hence, the number of SVs can be reduced by dropping rows in the kernelmatrix K, while keeping the number of columns unchanged [31]. To select the best subset of SVs, Yang proposed thefeature selection technique MRMR introduced in [32].Following the MRMR scheme to find the optimal subset of support vectors the first step is to select the row of Kwith the highest F-statistic Fi defined as [31],c=1 nc( ¯K cσ2where Ki. denotes the ith row of the feature matrix K, nc is the number of samples from the cth class. ¯Ki. is thei. is the mean value of Ki. within the cth class. σ2 is the pooled variance defined asmean value of the row Ki. and ¯K ci. − ¯Ki.)]Fi =(5)[(cid:80)2[31],where σ2c is the variance of Ki. within the class c.σ2 =[(cid:80)c(nc − 1)σ2c ]ˆNsv − 2(6)10The row with the highest Fi is the first element of the final subset. At each iteration, the rest of the unselectedsupport vectors are evaluated with (5), and the one with the largest Fi is added to the subset. The subset is evaluatedaccording to the relevance and the redundancy defined as [31],andmaxRFcwith RF =1| ˆNsv|2(cid:88)iF (i, c)minRcof fK∈ ˆNsvwith Rcof f =1| ˆNsv|2(cid:88)C(i, j)i,j∈ ˆNsv(7)(8)respectively.ˆNsv denotes the size of the desired feature subset (i.e.φNsv ). c is the target class and F (i, c) is the F-statisticbetween the feature i and the class c. C(i, j) is the correlation between the ith and jth rows of K.Then, the algorithm selects the subset that maximizes the relation,The MRMR algorithm receives as input the kernel matrix K ∈ RNsv×Nsv , a vector of length Nsv with the SVpositions, and φ to compute the length of the desired SV subset. The subset of SV selected by the MRMR algorithmmaxRK∈ ˆNsvwith R =RFRcof f(9)are then the SV of the model Mop.Finally, similarly as Hard IL and Cross IL, the MRMR IL method compares the performance of the models Mt−1and Mop on the validation set. The model with better performance is selected to become the updated classifier Mt.Fig.5 (D) illustrates the algorithmic flow.1112Figure 5: Flow chart of the NCSz detection method with incremental learning. Section (A) describes the Batch method. The three implementations ofincremental learning approaches tested: HardIL, Cross IL, and MRMR IL are described in sections (B),(C), and (D) of the diagram. For the graph simplicity,{x1, y1}, {x2, y2}, . . . , {xt, yt} refers to the samples resulting from the double labeling. SV stands for support vector.3.4 Alternative batch approachesThe three methods, [9],[8] and [14], were implemented and tested on our data. For each implementation, we tunethe parameters to maximize the classification performance. We included some minimal variations in the trainingto tune the methods to the available dataset. First, the training set was composed of the first NCSz and the samenumber of epochs of n-NCSz EEG prior to it. For the methods of Sharma and Fatma, the EEG was segmented usingnon-overlapping epoch of 1 s duration (length defined by the authors). In the case of Kollialil’s method, two waysof training were implemented. First, the classifier was trained with all data from 7 of the 14 available cases, and theunseen cases were used to test the classifier. The cases were selected in such a way that each set included vEEG aswell as ICU cases. Second, given that this method is not patient-specific, the training set assembled all training setsof all cases, i.e. the first NCSz and the same number of epochs of n-NCSz EEG prior to it.3.5 Performance metricsThe performance for all methods was assessed by means of the sensitivity, specificity and positive predictive value(PPV) defined as,Sen =T PT P + F N∗ 100%Spec =T NT N + F P∗ 100%P P V =T PT P + F P∗ 100%(10)(11)(12)respectively.TP (true positives) is the number of samples identified as seizure by the algorithm and the human expert. FN(false negative) is the number of samples identified as nonseizure by the algorithm marked as seizure by the humanexpert. FP (false positive) is the number of samples identified as seizure by the algorithm marked as nonseizure bythe human expert, and TN (true negative) is the number of samples classified as negative by the algorithm which areconfirmed by the human expert.To assess the significance of the improvement introduced by incremental learning, the different methods werestatistically compared using a paired t-test.4 Results and DiscussionThe performance of Hard IL, Cross IL, and MRMR IL was first mutually compared, to establish the best methodto select the subset of support vectors to update the classifier. The method with the best performance was thencompared with the Batch method and the batch methods proposed in [9],[8] and [14] (from now referred in the textas ‘Koliallil’, ‘Sharma’ and ‘Fatma’ respectively). Since the Batch method is the basis for all incremental learningmethods proposed here, it is logical to compare their performances to assess the achieved improvement, if there isany.13To present the results, the recordings are subdivided in two groups taking into account the origin of the NCSz.The first group comprised all patients with an underlying epilepsy (Group I, recordings from 1 to 9 in Table 1). Thesecond group comprised all patients that develop NCSz as a consequence of an acute brain dysfunction (Group II,recordings from 10 to 14 Table 1).4.1 Comparison of Incremental Learning ApproachesAll incremental learning approaches, as can be appreciated in Table 2, outperformed the Batch method in at least oneof the metrics assessed.The average performance of the Hard IL approach showed an increase in specificity, PPV, and a lower numberof false detections per hour compared to the Batch method. However, the method experiences a drop in sensitivityand specificity for Group I and II respectively. The arbitrary removal of support vectors seems to cause the forgettingof relevant information for the NCSz classification. It is possible that for more extended recordings, the catastrophicforgetting phenomenon [37] could appear if the EEG morphology changes too fast.Table 2: Performance of the Batch Method, Hard IL, Cross IL and MRMR IL in Group I and II. Group I + Group II isthe performance when both groups are considered together. Spec: specificity, Sen: Sensitivity, PPV:positive predictivevalue, FP/h: false positive detected per hour.Group IGroup IIGroup I + Group IIMethodSpecSenPPV FP/hSpecSenPPV FP/hSpecSenPPV FP/hBatch Method98.798.284.6Hard IL99.196.088.2Cross IL99.794.893.3MRMR IL99.499.292.35.94.11.43.399.499.9877.799.199.699.710010010080.985.686.14.93.41.80.899.098.882.199.197.485.699.796.790.599.599.590.15.53.81.62.4The sensitivity values obtained by Cross IL for Group I are lower than the ones obtained by the Batch method.Yet, Cross IL displayed an increase in specificity and PPV for this group. Cross IL outperformed the Batch methodsin all the metrics assessed for Group II. This method achieved the lowest average number of false detections amongthe two groups with only 1.6 false positives per hour. The results obtained with Cross IL demonstrate to be unstablesince they depend on the support vector subset resulting after the cross-validation process (not always the same, andnot always better). The performed tests show that the winning subset does not always show the best performancefor new samples.The MRMR IL displayed values of specificity, sensitivity above 99% for the two groups assessed, and a PPV of92.3 % and 86.1% for Group I and II respectively. The low average PPV value obtained for both groups, despitethe high sensitivity and specificity values, may be caused by the unbalanced test sets in some cases. The MRMR ILgenerates an average of 2.4 false detections per hour for both groups, 3.1 less than the Batch method. The MRMR ILyields the best results among the compared methods, showing the highest average performances for all metrics.Regarding the errors made by the MRMR IL algorithm during the classification, it was found that the epochs14misclassified as false positives in Group I corresponded to preictal activity occurring just before a seizure. However,the preictal activity that appeared several seconds before the seizure onset (say 4 − 6s), was not marked by theneurophysiologist as seizure activity. On the other hand, the end of the seizure is marked by the doctors immediatelyafter the postictal activity. As can be seen in Fig. 6, the patterns of the preictal and postictal activity are very similar.Postictal activity was always labeled as part of the seizure by the doctors. Hence, if the patterns of the postictalactivity (similar to preictal) are added to the training set, the algorithm recognizes the preictal activity as a seizure.In Group II the false positives are found in cases 10 and 11. The false positives detected in these cases are givenby similarity between the background EEG and the seizure activity, making it difficult to detect the beginning of theseizure. False negative detections were found for recordings 1 and 9 (Group I). The false negatives identified occurredbefore the first updating of the classifier where the occurrence of errors will affect the performance of the incrementallearning approach.The execution time for the MRMR IL approach is expected to be the same as the Batch method since the model up-dating is performed in the background while monitoring and seizure detection are running. Therefore, the executiontime of this algorithm is assumed to be in the same time range as the Batch method (0.37s to 3s for the classificationtask). The classifier retraining execution time ranged from 0.03s to 14.36s for t = 10min and from 0.94s to 1.79minfor t = 2h. This means that the highest delay in the classifier updating was approximately 14.36s and 1.79min for atime window of 10min and 2h respectively. The maximum detection delay found was 12.42s and occurred after thealgorithm failed to detect the first three 3-seconds epochs of a seizure (3s × 4) and took 0.42s to detect the fourth one.All tests were performed on a computer with an Intel Core-i3 processor at 1.70GHz with 8GB of RAM.We have also considered other state-of-the-art incremental learning approaches to improve the Batch method[37, 38, 39]. However, we discarded them after some analysis. Specifically, the method proposed in [37] performswell when the classifier is trained with balanced training sets which happens in the initial training of most cases.However, in the retraining step this cannot be guaranteed; the upcoming samples during the retraining window tcould be all from one class, negative samples in most of cases. After the retraining step this incremental learningmethod does not recognize properly the positive samples. The method introduced in [38] is proposed for a linearSVM. The linear SVM was excluded as possible classifier in our methodology in a previous work [30]. Finally, themethod proposed in [39] was also evaluated, and the implementation cost was found too high.4.2 MRMR IL and Batch methods ComparisonTable 3 lists the classification results of the Batch, MRMR IL, Kollialil, Sharma and Fatma methods for Group I andII. The MRMR IL clearly outperformed the Batch method in all metrics for both groups. It should be noted that theperformance of the Batch method for this database was already high before including incremental learning, whichdoes not leave much room for improvement. In general, the MRMR IL shows the same performance as the Batchmethod in the 5 cases for which the classification outcome was perfect, and improved the classification results forthe other nine. However, the short duration of some EEG clips hindered the assessment of the real capabilities of theMRMR IL approach for NCSz detection in comparison with the Batch method. MRMR IL should be tested in longerEEG to assess the statistical significance of the improvement achieved with the addition of the incremental learningto the Batch method.15According to the paired t-test performed, the MRMR IL improvement was statistically significant compared toKollialil, Sharma, and Fatma methods. From the two training processes performed for Kollialil, the first one (using7 cases for training and the rest for testing) (Kollialil 1), achieved specificity and sensitivity values of 43.2% and63.1% respectively for Group I. For Group II, Kollialil 1 obtained specificity and sensitivity values of 65.9% and 74%respectively. This method obtained the lowest PPV among all the methods evaluated 10.6% (7.7% for Group I and15.8% for Group II). The second way of training using the Kollialil method (assembling for all cases the first NCSz andthe same number of epochs of n-NCSz EEG prior to it) (Kollialil 2), increased the performance significantly comparedto Kollialil 1. For Group I, specificity value of 77.6%, a sensitivity of 72.2% and a PPV of 23.3% were obtained.1617Figure 6: Epoch from Case 6 misclassified by the Incremental Learning approach. The red box indicates seizure activity. The blue boxes highlight the preictaland postictal EEG patterns. As can be observed the patterns from both preictal and postictal activities are very similar. Since the postictal was included in theclassifier as seizure, its morphological similarity with the preictal activity induced this error.For Group II, the specificity, sensitivity and PPV, using Kollialil 2 was respectively 94.8%, 58.1% and 26%. Theoverall performance of the Kollialil method was poor (average specificity and sensitivity values under 85%). Theseresults, could be due to two possible causes. First, the training set was not big enough for classifier learning therebydeteriorating the classification performance. Second, the classifier was not able to recognize patterns that were notused during training, when using the Inter-quartile Range (IQR) as feature.Table 3: Performance of MRMR IL, Kollialil(1 and 2), Sharma, and Fatma for Groups I and II. Group I + Group II isthe performance when both groups are considered together. Spec: specificity, Sen: Sensitivity, PPV:positive predictivevalue.Group IGroup IIGroup I + Group IIMethodSpecSenPPV SpecSenPPV SpecSenPPVBatch Method98.7MRMR ILKollialil 1Kollialil 299.443.277.698.299.263.172.284.692.399.499.710010077.786.17.765.974.015.823.394.858.126.899.099.551.383.898.899.567.067.282.190.110.624.5Sharma55.4100.028.793.610047.969.0100.035.6Fatma91.973.237.896.243.347.593.462.641.3Sharma method showed its best performance for Group II with specificity, sensitivity and PPV of 93.6%, 100%and 47.9% respectively. For Group I, a decrease in specificity and PPV was observed, 55.4% and 28.7% respectively.The performance of the Sharma method decayed for patients in which the training set was extremely unbalanced(case 3) or too small (cases 7, 8 and 9). The method obtained the lowest specificity values and PPV for these cases.The MRMR IL outperformed the Sharma method in all metrics assessed except for the sensitivity, where Sharmadisplayed a 100% average value.Fatma method achieved similar results in specificity (values over 90%) for the two groups analyzed. Regardingthe sensitivity, a decrease was observed for Group II. Since this method does not use classifiers, the only plausiblereason for the low sensitivity outcome is that the threshold defined for the seizure detection needs to be individuallyadjusted for each group. The method of Fatma was inferior to MRMR IL for all the metrics evaluated, achieving anaverage specificity of 93.4% with a PPV of 41.3%. This algorithm displayed the lowest average sensitivity over alltested methods (around 62%).Concerning the execution time, the MRMR IL was only compared with Kollialil method in this regard sinceSharma’s and Fatma’s methods uses a different lenght of analysis epochs. The algorithm from Kollialil executedthe classification process of the 3 s epochs in 0.28s to 0.19s. An outlier of 25.25s was observed for one of the epochsof Case 10 which was disregarded for the time performance analysis. The superiority of Kollialil could be due tothe fact that the tensorization and the tensor decomposition processes are more time consuming than the IQR rangecomputation. Nevertheless, based on our results, we believe that both, MRMR IL and the Batch method will performproperly in a real-time monitoring setting.185 ConclusionThis paper proposed a method that uses incremental learning to improve the nonconvulsive epileptic seizures (NCSz)detection during continuous and long-term EEG monitoring. The proposed algorithm, namely MRMR IL, is based onour previously proposed tensor-based batch solution [18]. The MRMR IL retrains the original classifier periodicallyto improve the seizure recognition in case of changes in the EEG morphology over time. The obtained results showthat the MRMR IL outperforms the original method.Three detection methods proposed in the literature [9],[8] and [14] were evaluated on the available database andcompared to MRMR IL. MRMR IL was shown to outperform the three methods in all measured metrics.In summary the MRMR IL method proved to be an effective tool for NCSz detection in a real-time setting. Theproposed method detected the NCSz caused by an epileptic disorder and those that appear as a consequence of anacute brain dysfunction with specificity and sensitivity values over 99%. For further application, it is necessary totest the method using EEG of longer duration (more than 12 hours).References[1] Ikuko Laccheo, Hasan Sonmezturk, Amar B Bhatt, Luke Tomycz, Yaping Shi, Marianna Ringel, Gina DiCarlo, DeAngelo Har-ris, John Barwise, Bassel Abou-Khalil, et al. Non-convulsive status epilepticus and non-convulsive seizures in neurologicalicu patients. Neurocritical care, 22(2):202–211, 2015.[2] J Jirsch and LJ Hirsch. Nonconvulsive seizures: developing a rational approach to the diagnosis and management in thecritically ill population. Clinical Neurophysiology, 118(8):1660–1670, 2007.[3] Bryan G Young, Kenneth G Jordan, and Gordon S Doig. An assessment of nonconvulsive seizures in the intensive care unitusing continuous eeg monitoring: an investigation of variables associated with mortality. Neurology, 47(1):83–89, 1996.[4] J Claassen, SA Mayer, RG Kowalski, RG Emerson, and LJ Hirsch. Detection of electrographic seizures with continuous eegmonitoring in critically ill patients. Neurology, 62(10):1743–1748, 2004.[5] Hojjat Adeli, Ziqin Zhou, and Nahid Dadmehr. Analysis of eeg records in an epileptic patient using wavelet transform.Journal of neuroscience methods, 123(1):69–87, 2003.[6] Arnaud Jacquin, Elvir Causevic, and E Roy John. Automatic identification of spike-wave events and non-convulsive seizureswith a reduced set of electrodes. In Engineering in Medicine and Biology Society, 2007. EMBS 2007. 29th Annual InternationalConference of the IEEE, pages 1928–1931. IEEE, 2007.[7] Petros Xanthopoulos, Steffen Rebennack, Chang-Chia Liu, Jicong Zhang, Gregory L Holmes, Basim M Uthman, and Panos MPardalos. A novel wavelet based algorithm for spike and wave detection in absence epilepsy. In BioInformatics and BioEngi-neering (BIBE), 2010 IEEE International Conference on, pages 14–19. IEEE, 2010.[8] Priyanka Sharma, Yusuf Uzzaman Khan, Omar Farooq, Manjari Tripathi, and Hojjat Adeli. A wavelet-statistical featuresapproach for nonconvulsive seizure detection. Clinical EEG and neuroscience, 45(4):274–284, 2014.[9] Eldho S Kollialil, Gopika K Gopan, A Harsha, and Liza Annie Joseph. Single feature-based non-convulsive epileptic seizuredetection using multi-class svm.In Emerging Trends in Communication, Control, Signal Processing & Computing Applications(C2SPCA), 2013 International Conference on, pages 1–6. IEEE, 2013.19[10] Sheng-Fu Liang, Wan-Lin Chang, and Herming Chiueh. Eeg-based absence seizure detection methods. In Neural Networks(IJCNN), The 2010 International Joint Conference on, pages 1–4. IEEE, 2010.[11] Georgiy R Minasyan, John B Chatten, and Richard N Harner. Detection of epileptiform activity in unresponsive patientsusing ann. In Neural Networks, 2009. IJCNN 2009. International Joint Conference on, pages 2117–2124. IEEE, 2009.[12] J Chris Sackellares, Deng-Shan Shiau, Jonathon J Halford, Suzette M LaRoche, and Kevin M Kelly. Quantitative eeg analysisfor automated detection of nonconvulsive seizures in intensive care units. Epilepsy & Behavior, 22:S69–S73, 2011.[13] Swati Varshney, Yusuf U Khan, Omar Farooq, Priyanka Sharma, and Manjari Tripathi. Latency study of non-convulsiveseizures. In Multimedia, Signal Processing and Communication Technologies (IMPACT), 2013 International Conference on, pages108–111. IEEE, 2013.[14] T. Fatma, O. Farooq, M. Khan, Y. U. Tripathi, and P. Sharma. Automatic detection of non-convulsive seizures: A reducedcomplexity approach. Journal of King Saud University-Computer and Information Sciences, 28(4):407–415, 2016.[15] Yusuf U Khan, Omar Farooq, Manjari Tripathi, Priyanka Sharma, and Parvez Alam. Automatic detection of non-convulsiveseizures using ar modeling. In Power, Control and Embedded Systems (ICPCES), 2012 2nd International Conference on, pages 1–4.IEEE, 2012.[16] Abdul Quaiyum Ansari and Priyanka Sharma. A review on automated detection of non-convulsive seizures using eeg. InComputational Intelligence & Communication Technology (CICT), 2016 Second International Conference on, pages 283–286. IEEE,2016.[17] Eugen Trinka and Markus Leitinger. Which eeg patterns in coma are nonconvulsive status epilepticus? Epilepsy & Behavior,49:203–222, 2015.[18] Y. Rodr´ıguez Aldana, B. Hunyadi, E.J. Mara ˜n ´on Reyes, V. Rodr´ıguez Rodr´ıguez, and S. Van Huffel. Nonconvulsive epilepticseizure detection in scalp eeg using multiway data analysis. IEEE Journal of Biomedical and Health Informatics, 23(2):660–671,2019.[19] Scott B Wilson. Algorithm architectures for patient dependent seizure detection. Clinical Neurophysiology, 117(6):1204–1216,2006.[20] Borb´ala Hunyadi, Marco Signoretto, Wim Van Paesschen, Johan AK Suykens, Sabine Van Huffel, and Maarten De Vos. Incor-porating structural information from the multichannel eeg improves patient-specific seizure detection. Clinical Neurophysiol-ogy, 123(12):2352–2361, 2012.[21] E Acar, C Schenker, Y Levin-Schwartz, VD Calhoun, and T Adali. Unraveling diagnostic biomarkers of schizophrenia throughstructure-revealing fusion of multi-modal neuroimaging data. Clinical Neurophysiology, 13(416), 2019.[22] Mark L Scheuer and Scott B Wilson. Data analysis for continuous eeg monitoring in the icu: seeing the forest and the trees.Journal of clinical neurophysiology, 21(5):353–378, 2004.[23] LD Iasemidis, D-S Shiau, Panos M Pardalos, Wanpracha Chaovalitwongse, K Narayanan, Awadhesh Prasad, KonstantinosTsakalis, Paul R Carney, and J Chris Sackellares. Long-term prospective on-line real-time seizure prediction. Clinical Neuro-physiology, 116(3):532–544, 2005.[24] Stephen Faul, Geraldine Boylan, Sean Connolly, Liam Marnane, and Gordon Lightbody. An evaluation of automated neonatalseizure detection methods. Clinical Neurophysiology, 116(7):1533–1541, 2005.20[25] Gotman J. Automatic seizure detection: improvements and evaluation. Electroencephalogr Clin Neurophysiol, 76:317–324, 1990.[26] Gabor AJ. Seizure detection using a self-organizing neural network: validation and comparison with other detection strate-gies. Electroencephalogr Clin Neurophysiol, 107:27–32, 1998.[27] Wilson SB, Scheuer ML, Emerson RG, and Gabor AJ. Seizure detection: evaluation of the reveal algorithm. Clin Neurophysiol,115(10):2280–2291, 2004.[28] Scott B Wilson. A neural network method for automatic and incremental learning applied to patient-dependent seizuredetection. Clinical Neurophysiology, 116(8):1785–1795, 2005.[29] Thomas De Cooman, Anouk Van de Vel, Berten Ceulemans, Lieven Lagae, Bart Vanrumste, and Sabine Van Huffel. Onlinedetection of tonic-clonic seizures in pediatric patients using ecg and low-complexity incremental novelty detection. In 201537th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), pages 5597–5600. IEEE,2015.[30] Y. Rodr´ıguez Aldana, B. Hunyadi, E.J. Mara ˜n ´on Reyes, V. Rodr´ıguez Rodr´ıguez, and S. Van Huffel. Nonconvulsive epilepticseizures detection using multiway data analysis. In Proc. of the 25th European Signal Processing Conference, Kos, Grece, Aug 2017,pages 2344–2348. IEEE, 2017.[31] Xiaoxing Yang, Ke Tang, and Xin Yao. The minimum redundancy–maximum relevance approach to building sparse supportvector machines. In International Conference on Intelligent Data Engineering and Automated Learning, pages 184–190. Springer,2009.[32] Chris Ding and Hanchuan Peng. Minimum redundancy feature selection from microarray gene expression data. Journal ofbioinformatics and computational biology, 3(02):185–205, 2005.[33] Mikael Sørensen and Lieven De Lathauwer. Tensor decompositions with block-toeplitz structure and applications in signalprocessing. In Signals, Systems and Computers (ASILOMAR), 2011 Conference Record of the Forty Fifth Asilomar Conference on,pages 454–458. IEEE, 2011.[34] Alexander Gepperth and Barbara Hammer.Incremental learning algorithms and applications.In European Sympo-sium on Artificial Neural Networks (ESANN), pages 1–13. ESANN, 2016, Bruges, Belgium, 2016. URL https://hal.archives-ouvertes.fr/hal-01418129.[35] Richard G Brereton and Gavin R Lloyd. Partial least squares discriminant analysis: taking the magic away. Journal of Chemo-metrics, 28(4):213–225, 2014.[36] Yissel Rodr´ıguez Aldana, Frank Sanabria Mac´ıas, Enrique J Mara ˜n ´on Reyes, Valia Rodr´ıguez Rodr´ıguez, Sabine Van Huffel,and Borb´ala Hunyadi. Using partial least squares for nonconvulsive epileptic seizure detection. Revista Cubana de CienciasInform´aticas, 13(1):1–13, 2019.[37] Gert Cauwenberghs and Tomaso Poggio.Incremental and decremental support vector machine learning.In Advances inneural information processing systems, pages 409–415, 2001.[38] Cheng-Hao Tsai, Chieh-Yen Lin, and Chih-Jen Lin. Incremental and decremental training for linear classification. In Proceed-ings of the 20th ACM SIGKDD international conference on Knowledge discovery and data mining, pages 343–352. ACM, 2014.[39] Bin Gu, Victor S Sheng, Keng Yeow Tay, Walter Romano, and Shuo Li.Incremental support vector learning for ordinalregression. IEEE Transactions on Neural networks and learning systems, 26(7):1403–1416, 2015.21