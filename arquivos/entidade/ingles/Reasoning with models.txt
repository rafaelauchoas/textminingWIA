ELSEVIER Artificial Intelligence 87 ( 1996) 187-2 13 Artificial Intelligence Reasoning with models * Roni Khardon *, Dan Roth ’ Aiken Computation Laboratory, Harvard University, 33 Oxford Street, Cambridge, MA 02138, LISA Received August 1994; revised January 1996 Abstract We develop a model-based approach to reasoning, in which the knowledge base is represented as a set of models (satisfying assignments) rather than a logical formula, and the set of queries is restricted. We show that for every propositional knowledge base (KB) there exists a set of characteristic models with the property that a query is true in KB if and only if it is satisfied by the models in this set. We characterize a set of functions for which the model-based representation is compact and provides efficient reasoning. These include cases where the formula-based repre- sentation does not support efficient reasoning. In addition, we consider the model-based approach to abductive reasoning and show that for any propositional KB, reasoning with its model-based representation yields an abductive explanation in time that is polynomial in its size. Some of our technical results make use of the monotone theory, a new characterization of Boolean functions recently introduced. The notion of restricted queries is inherent in our approach. This is a wide class of queries for which reasoning is efficient and exact, even when the model-based representation KB provides only an approximate representation of the domain in question. Moreover, we show that the theory developed here generalizes the model-based approach to reasoning with Horn expressions and captures even the notion of reasoning with Horn approxi- mations. Keywords: Knowledge representation; Common-sense reasoning; Automated reasoning *An earlier version of the paper appears in the Proceedings of the National Conference on Artificial Intelligence, AAAI-94. * Corresponding author. Research supported by AR0 grant DAAL03-92-G-0115 (Center for Intelligent Control Systems). E-mail: roni@das.harvard.edu. L Research supported by NSF grant CCR-92-00884 and by DARPA AFOSR-F4962-92-J-0466. Current address: Department of Applied Mathematics & CS, Weizmann Institute of Science, Rehovot 76100, Israel. E-mail: danr@wisdom.weizmann.ac.il. 0004-3702/96/$15.00 Copyright @ 1996 Elsevier Science B.V. All rights reserved. PII SOOO4-3702(96)00006-9 188 R. Khurdorr. 0. Rorh/Arrific~~ul huelligence R7 (1996) 187-213 1. Introduction systems framework in intelligent for reasoning is the knowledge- in some representation A widely accepted [ 261. The idea is to keep the knowledge based system approach are assigned language with a well-defined meaning stored in a knowledge base (KB) which is combined with a reasoning mechanism, used reasoning to determine what can be inferred to capture our is usually abstracted as follows: Given that about the domain knowledge is assumed at hand, decide whether KB implies LY (denoted to capture W + a). This can be understood as the question: “Is cr consistent with the current state of knowledge?’ to those sentences. The sentences the knowledge base KB, assumed and a sentence LY, a query in the KB. Deductive from the sentences (the “world”), the situation in question Solving the question KB /= u, even in the propositional theoretic beliefs requires exponential cast, is co-NP-hard and under time. Many other forms the current complexity of reasoning which have been developed difficulties, were also shown to be hard to compute [ 30,3 1 1. at least partly to avoid these computational and theory reasoning [23 J who argued that common-sense is influenced by convincing amount of recent work on reasoning that we should give a computational A significant ments of Levesque of reasoning its speed and flexibility. Most of the work in this direction kind of theorem proving process, and is based on the belief sources of the computational capture common-sense line of research aims at identifying can perform the strong meets see [ 351 ), even though to be implausible argued argu- is a distinct mode for both that accounts still views reasoning as a that a careful study of the to for efficient reasoning. Thus, this classes of limited expressiveness, with which one 11. None of these works, however, (e.g. reasoning for common-sense there has been of classes discussed the limited expressiveness [ 71. difficulties may lead to a formalism expressive enough knowledge, while still allowing theorem proving efficiently [ 3.24.30,3 required requirements tractability Levesque argues [23,24] that reasoning with a more direct representation is easier the knowledge base to the real world. This the truth value of the to represent reasoning. He suggests and better suits common-sense KB in a vivid form, which bears a strong and direct relationship might be just a model of KB [ 8,281 on which one can evaluate query LY. It is not clear, however, how one might derive a vivid form of the knowledge likely model of the real world, base. Moreover, under various reasonable criteria, in order to achieve an efficient solution the the problem KB /= a. problem: inference problem but rather a different problem. whose exact relation depends on the method selected hard [ 28,321. Most importantly, this approach modifies reasoning with a vivid representation to the reasoning problem the knowledge base. no longer solves is computationally a model which to the original is the most to simplify selecting A model-based approach to reasotzitzg In this work we embark on the development of a model-based approach to common- sense reasoning. It is not hard to motivate a model-based cognitive point of view and indeed, many of the proponents of this approach approach to reasoning to reasoning from a R. Khardon, D. Roth/Art@cial intelligence 87 (1996) 187-213 189 have been cognitive psychologists be seen as an example of Levesque’s notion of “vivid” studied [ 12,13,22]. in [ 141. In the AI community reasoning this approach can and has already been The deduction problem KB b cy can be approached using the following model-based strategy: Test set: A set S of possible assignments. Test: If there is an element x E S which satisfies KB, but does not satisfy CY, deduce that KB p LY; Otherwise, KB + a. Since, by the model theoretic definition of implication, KB k cr if and only model of KB is a model of LY, the suggested (satisfying is the set of all models approach becomes useful A model-based fairly small set of models as the test set, and still perform under some criterion. assignments) strategy solves the inference problem if every if S of KB. But, this set might be too large. to use a if one can show that it is possible reasonably good inference, We define a set of models, the characteristic models of the knowledge to deduce the model-based test with it suffices small, and thus the model-based set of queries. We prove that for a fairly wide class of representations, show that performing a restricted set is sufficiently restricted queries is inherent common-sense all possible queries. For a wide class of queries we show that exact reasoning done efficiently, of the “world”. We show in formalizing reasoning, we take the view that a reasoner need not answer efficiently the reasoner keeps in KB an “approximate” that the theory developed here generalizes since we are interested in our approach; the model-based representation even when approach approach base, and that KB b a, for this is feasible. The notion of can be theory approximations reasoning with Horn expressions, reasoning with Horn expressions phenomena sentation expressive the model-based families of propositional for which there, observed and the approach regarding suggested [33]. representation expressions, to in [ 141, and captures even the notion of the In particular, our results characterize the in [ 141 is useful and explain repre- of KB. We also give other examples of formula suggested the relative sizes of the logical for which our approach in independently is useful. the relational We note that characteristic models were studied database community definite Horn expressions. The results domain (e.g., bounding (where in this paper have immediate [ 2,251, for the special case of in this implications relations), which are described elsewhere they are called “generators”) the size of Armstrong [171. In addition, we consider and show the problem of performing abduction using a model-based base, using a model-based that for any propositional explanation Some of our technical knowledge in time yields an abductive representation. that is polynomial in the size results make use of a new recently of Boolean functions, called the monotone theory, introduced [4]. some more results on reasoning with models have been derived, exhibiting repre- include algorithms logic as well as some cases of to handle some fragments of Reiter’s default the usefulness of this approach. These sentations that use model-based approach representation of the model-based characterization by Bshouty Recently, [ 201. A theory of reasoning with partial models and the learnability of circuit diagnosis in [ 2 I 1. The question of translating between characteris- such representations tic models and propositional theory as well) (which has also been studied. Some results on the complexity of this and related questions are described in database expressions is relevant in [ I7 1. is studied Most of the work on reasoning that the knowledge base is given assumes the question of how this knowledge might be acquired in this paper we also take this point of view, we are interested form. and While entire process of le~lnzirrg a knowledge base representation particular, Bshouty representation we consider here when given access to a membership oracle and an equivalence oracle. In [ 191 we discuss the importance of the model-based in some is not considered. in studying the and reasoning with it. In the issue of “learning for this problem. to reason” and illustrate [4l gives an algorithm the model-based that learns approach Sutntnclt~ of results We now brielly describe the main contributions oped in this paper. Our results can be grouped described as follows: ( I ) WC define respect correct deduction and abduction. to a class of queries) of the model-based approach devel- that can be informally into three categories the set of characteristic models of a propositional and prove (with that reasoning with this set supports expression (2) We characterize the least upper bound of a function, with respect to a class C of functions. using a set of characteristic models. We then show that reasoning with this approximation is correct for queries in the class C. (3) We characterize classes of propositional set of characteristic models domain. is polynomial formulas for which in the number of variables the size of the in the As a result, we show that in many cases where reasoning with the traditional resentation reasoning with log n-CNF queries, Horn queries, and quasi-Horn queries. is NP-hard we can perform efficient reasoning with models. This Clearly, our algorithms for reasoning efficiently results reasoning efficiency of model-based In Section 7 we discuss representations assume that KB since we represent reasoning this issue to CNF and DNF representations. do not solve NP-complete is given the knowledge as a CNF problems. While most hardness formula, we can perform form. The in a more accessible strongly depends on the size of the representation. compare model-based in detail. and in particular, The rest of this paper is organized as follows: We start with some technical preliminary and then, in Section 3, WC give an example in definitions tool in the rest of the paper. Section 4 reviews the deduction problem. We introduce developing our results. and efficiency of model- the set of characteristic models, and analyze based deduction with this set. In Section 6 we show that in the case of Horn expressions our theory the size of model-based Section 8 describes applications of our theory to particular propositional representations. to the work in [ 14). Section 7 discusses theory, which is the main In Section 5 we consider the correctness that motivates the discussion the monotone reduces rep- includes R. Khardon, D. Roth/Arti$cial Intelligence 87 (1996) I87-2I3 191 languages. conclude with some reference In Section 9 we consider to future work. the abduction problem, and in Section 10 we 2. Preliminaries We consider problems of reasoning where the “world” as a Boolean modeled KB would consist of some specially chosen models) function f representation : (0, 1)” -+ (0, 1). Similarly, (either a propositional for a Boolean function. (the domain in question) is the knowledge base formula or a set of . . ,xn} be a set of variables, where each variable is associated with the associated is true or false in the world. Assignments, denoted by x, y, z, are mappings the natural map- Let X = {xi,. a world’s attribute attribute from X to (0, 1}, and we treat ping. the value 1 or 0 to indicate whether them as elements in (0, I}” with and can take An assignment x E (0, 1)” satisfies f if f(x) = 1. An assignment f is also called a model of f. If f is a theory of the “world”, a satisfying of f is sometimes called a possible world. x which satisfies assignment For x E (0, I}“, weight(x) denotes is either a variable xi (called a positive the number of variables assigned 1 in the as- literal) or its negation (a negative x. A literal signment literal). A clause x conjunction of clauses. For example two clauses. A term is a conjunction terms. For example formula k-quasi-Horn log n-CNF is Horn if every clause if every clause if every clause is a disjunction of literals, and a CNF formula is a (xi V F) A (x3 V Ifi V x4) is a CNF formula with of of literals, and a DNF formula (xi AZ) V (x3 AC A x4) is a DNF formula with two terms. A CNF is is in in it has at most one positive literal. A CNF formula is a disjunction in it has at most k positive in it has at most log n literals literals. A CNF formula (of arbitrary polarity). Every Boolean CNF representation the minimum we mean call a DNF expression of f. Similarly, of clauses has 1 CNF( f) ) clauses. function has many possible representations and a DNF representation. By the DNF size of f, denoted possible number of terms in any DNF representation and, in particular, both a (DNF( f) 1, of f. We the CNF size of f, denoted for f which has IDNF( f) 1 terms, a minimal DNF representation ICNF( f) 1, is the minimum possible number for f if it of f, and a CNF expression is minimal in any CNF representation It is important to distinguish between (0, 1)” -+ (0, I}, and a representation represented in many ways. standard way to represent Boolean CNF and DNF expressions, of propositional expressions. a Boolean namely for the function. Every Boolean function, (In particular, a truth table is one such representation.) functions is using propositional expressions as discussed above. A propositional language is a collection f a mapping : function can be A such as Some of our results hold for any Boolean of such functions. Other results have restrictions functions; namely, representation as a class of Boolean they hold for functions functions. (That is clear from the context we sometimes function, that relate to the representation and are therefore stated in terms of the the language that can be represented refer to a propositional language. When in a certain propositional is, all those functions 192 K. Klrtrrdon. 0. Rorh/ArnJiciul lrmlligence 87 (1996) 187-213 using expressions and functions by .f, g. in the language.) We denote classes of Boolean functions by 3, 6, By “,f’ entails g:“, denoted function and “logical g. We also refer to the connective Since “entailment” Boolean or as the set of its models, namely can arise. we identify that the connective connective if f C g. Throughout “implies” “subset or equal” number of variables plexity which are polynomial short, or an algorithm e@ient, ,f /== ‘4. WC mean that every model of f is also a model of /= by its equivalent, proof theoretic name, “implies”. (usually, using a propositional implication” are equivalent, we can treat f either as a that represents expression ,f-’ ( 1). Throughout the function), the paper, when no confusion the Boolean function f with the set of its models, f -' ( 1). Observe to the (/=) used between Boolean (2) used for subsets of (0, 1)“. That is, f b g if and only is equivalent functions this paper we measure size and time complexity with respect in the domain. Naturally, we are interested to n, the in time and size com- is small or in K Sometimes. we say that a representation and mean that they are polynomial in II. 3. A motivating example We start by giving an example which will serve to motivate oped in the rest of the paper and explain their relation that the world is described as a set of rules Assume the abstract to the problem of reasoning. ideas devel- f= {qA--xj,IQA&T 'X2,.x-] A_QAXj -+Xj}, and that we would is, given a class Q of queries, we would like to know, for each LY E Q, whether f /= a. For example, assume like to perform deductive reasoning with respect to this world. That that &={~A~-+xj,Zi/\x2 -+X3AX‘$). First, notice it can be represented in a CNF representation as that since f is interpreted as the world in which all the above rules hold, .f‘= (XI vx2 VX3) A (X, vx2 VXd) A (Yj-Vx2VXj Vxq). Similarly, & can be represented as a set of disjunctions In order to simplify the example, we make the assumption that is, when represented (as in Q). The function f has 12 (out of the 16 possible) that all the queries we as CNF or DNF, they contain only satisfying care about are monotone; positive literals assignments. These are: 2 {0011,0100,0101,0110,0111,1000,1001,1010,1011,1100,1110,1111}. 2 An element of {0, I }” denotes an assignment to the variables XI, , x,, (i.e., 0011 means XI = x2 = 0, and XX = -1-1 = 1 ). R. Khardon, D. Roth/Artificial Intelligence 87 (1996) 187-213 193 Given a query LY, since f k cy if and only if f 5 whether LY satisfies all these assignments. However, as the following since we consider here only monotone queries, models. it is sufficient (Y, it is sufficient to check argument shows, to test only some of these First notice that a query (Y, being a monotone Boolean If (u( y ) = I, and y < x, then also a(x) function, has the following property: the usual bitwise order relation on (0, l}“, that is, y < x iff for every index i such that yi = 1 we also have Xi = I.) Now, if f p is a model x of f such that (Y(X) = 0. If y is another model of f and y f x, then since (Y is monotone, that f must have a minimal model z, which does not satisfy cy. Therefore, when all the queries are monotone, Instead, it is sufficient (Y on all the satisfying assignments of f. to consider only the minimal there is no need to evaluate (Y(Y) = 0. This implies = 1. (Here < denotes assignments satisfying (Y, then there off. In the current example, for f: { 1000,0100,0011}. crt ( 1000) = 0 and xi V x2 V (x3 A x4), therefore f b (~2. it is easy to see that there are only three minimal assignments When considering f k LYE. On therefore the other hand, when considering it is easy to see to all three minimal models of f satisfy at = x2 V x3 V x4, we can see that LYZ = (~2 and The example shows that sometimes it is not necessary f in order to answer deduction queries with respect to f. Moreover, models we have used, seems to be considerably smaller than the set of all models. to consider all the models of the set of “special” in the example, This example motivates at least two important questions of this paper. First, can one define a set of “special” models, for a wider set of queries ? Secondly, used advantageous when the set of “special” models is significantly models. Can one quantify later in this paper. Finally, we note that we consider in the rest like the minimal models the method presented is than the set of all smaller that in the example presented, no assumptions were made on the f. The set of special models depends only on the class of queries we want f b a, even “world” to answer correctly. Notice also, that the traditional in which f is represented when the set of queries as a propositional CNF expression, to be a set of monotone to the problem remains co-NP-hard functions. is restricted approach the size of this set? Both questions are answered affirmatively 4. Monotone theory In this section we introduce theory of Boolean functions, the notation, definitions [4]. introduced by Bshouty and results of the monotone (0, l}“, Definition 4.1 (Order). We denote by < the usual partial order on the lattice if the one induced by the order 0 < 1. That b E (0, I}” we define x <h y if and only if x @ b 6 y @ 6, Vi, xi 6 y,. For an assignment where @ denotes (bitwise addition modulo 2). As with other order relations, x <b y can also be written as y >b x, and if x <b y and x # y we write is, for x,y E (0, l}“, x < y if and only the XOR operation x <b y. 194 R. Khtrrdorr. .!I. Roth/Art@rctl lrttelligrnce X7 (I 996) /X7-213 Intuitively, if bi = 0 then the order relation on the ith bit is the normal order; if bj = 1, the order relation is reversed and we have that 1 Q, 0. The n~~~~tone extension of ; E (0. I }” with respect to b is: N/,(Z) = {.K ! x3/, L}. The morlotone extension of ,f with respect to II is: ,fVtj,( ,f) = {I ! x 2/, ;, Itir some z t ,f } The set of minimal assignments of .f’ with respect to b is: min,,(f) = {: / ,i t .f’, such that V.Y t .f; : +,, ?I}. The following claim lists some properties of MI,. ail are immediate from the definitions: Claim 4.2. Ler f, g : { 0, I }” - the jiillo~~ing properries: (0. I } he Boolean ,functions. The operator MI> satisjes (I ) If f C g therz M,,(f) (2) M/,(fr\g) (3) M/,(f (4) .f C A4d.f). V g) = Mh(.f) G M/,(g). C Mh(J‘) AM~,(KI. V M/,(R). Claim 4.3. Let z t f. Then, jtir evrty b t (0. 1 I”, rhere exists IA E minh( f) such that M/~(Z) C M/,(u). Proof. II‘ ; $ min/,(.f‘) f with this property. Then, needed. 0 then 3.~ E f such that v </, :. Let u be a minimal element in II t minh(f) and clearly {X / x >,, z} C {x / x >,, u}, as Using Claims 4.3 and 4.2 we get a characterization of the monotone extension of f: Claim 4.4. The monotone extension of ,f‘ with respect to b is: Clearly, b $! Mb (.f) for every assignment then (since b is the smallest assignment with respect to the order Q,). Therefore: IJ C: {O. I }“, ,/ g _M,?( ,f). Moreover, if b &’ f, .f = A Mh(.f) = /j Mll(f’i /&{0,1}” @I The question is whether we can tind a small set of negative examples b, and use it to represent f as above. Definition 4.5 (Basis). A set B is a basisfilr a class of functions .F if it is a basis for all the functions in _F. J’ if f = AhEB Mb(f). B is a basis for R. Khardon. D. Rorh/Arrijcial Intelligence 87 (1996) 187-213 19s Using this definition, the representation .f= &W,(f)= A v Mb(z) bEB bEB zEmindf) necessary and sufficient condition describing when x E (0, 1)" (1) the following yields satisfies f: Corollary 4.6. Let B be a basis for f, and let n E (0, 1)“. Then, f(x) = 1 if and only if for every basis element b E B there exists z E minb( f) such that x >b z. The following claim bounds the size of the basis of a function f: Claim 4.7. Let f = Cl A C2 A . ’ . A Ck be a CNF representation for f and let B be a set of assignments in (0, 1)“. If every clause Ci is falsified by some b E B then B is a basis for f. In particular, f has a basis of size < k. Proof. Let B = (6' , b2, . . . , bk} be a collection of assignments Ci. We show such that b’ falsifies that using Claim 4.2(4) we get to show f 2 AbEB hfb( f) we show that for all y $ f that f = fjhEB h’!b( f > . First observe In order f c: AbEB Mb(f). there exists b E B such that y $ Mb(f), and therefore y @- /jbEB Mb(f) Consider y E (0, I}” such that y $Z f and assume, w.l.o.g., in B, and assume, by way of contradiction = 1. Then, element b = 6’ be the corresponding &(f)(y) there is an assignment z <b y. We therefore have that b <b z <b y. Let 3ci be a variable clause Cl. Since Cl (y) = Cl (b) = 0, we must have yi = zi = bi. Since all variables that z E f. Cl that Cl ( z ) = 0 and contradicts in Cl, it implies z E minb(Mb( that appear . that Cl(y) = 0. Let that f)) = minb( f) such that in the the appears this holds for the assumption The set of joor assignments of an assignment X, with respect to the order relation z <b x such that there does not exist y for from to b and is different than x relative [Xjb, is the set of all elements b, denoted which z <b y <b x (i.e., z is strictly smaller x in exactly one bit). The set of local minimal assignments off with respect to b is: mini(f) = {x ( x E f, and VY E [x_tb, Y # f}. The following claims bound the size of minb( f): Claim 4.8. Let f = D1 V D2 V . . . V Dk be a DNF representation for f. Then for every b E (0, I}“, [mini( < k. Proof. Let D be one of the terms of literals minb( D) = mini(D) and z; = bi if Xi does not appear in D. Further, for any two functions gl, g2, contains a single element, z, defined by Zi = Ci if Xi appears let p be the number the set in D (here x1 = x and x0 = X). Clearly, in the representation, is D = r\T=, x; in D. That and mini(gl Ug2) C minl(gl) Um;n(~~) and therefore lminl(f)l < 1 i)min;(D;) /=I / < k. ;_-I Corollary 4.9. Let f = D1 V t)z V < k. eve);)’ 0 E (0, l}“, / min,,(,f)l ;/ L)k be a DNF represerztation fbr ,f. Then for Proof. This follows from Claim 4.8, observing that by definition minb( f’) C: minz(f’). ci (continued). We go back Example that we want to reason with respect lion to the example to the function introduced in Section 3. Recall f, which has the CNF representa- function The satisfying the set B = (0000, I lOI} is a basis for ,f. J’ has 12 (out of the 16 possible) The non- of J’ are {OOOO,OOOl .OOlO, 1101). Using Claim 4.7 we get that assignments. satisfying assignments The sets of minimal assignments with respect to this basis are: minmc(f) = { 1000,0100,001 I}, min ttct(f‘) = jllO0. I I Il. 1001.0101~. These can be easily of the satisfying represented found by drawing the corresponding assignments of f are minimal. It is also easy to check lattices and checking which that j’ can be as in Eq. (1) using the minimal elements identified. 5. Deduction with models We consider the deduction problem KB /== a. KB is the knowledge base, which is taken and function), that if some model expression. The assertion KB /= cr means to be a propositional 0 is also a propositional x E (0, I}” satisfies KB, then it must also satisfy N. (i.e., a representation for some Boolean expression Let r C KB 2 (0, 1)” be a set of models. To decide whether KB f= a we consider for all the models z E f check the straightforward model-based approach whether a(z) = 1. If for some z, cu( ; ) = 0, say “no”; otherwise say “yes”. to deduction: By definition, if f = KB this approach yields correct deduction, but representing KB holding all by explicitly approach becomes small subset of models. feasible the possible models of KB is not plausible. A model-based if one can make correct inferences when working with a R. Khardon, D. Roth/Artificial Intelligence 87 (1996) 187-213 197 In this section we define a special collection of models, called the characteristic test on r yields correct deduction, models of KB, and denoted based necessary in order optimal set with this property. to guarantee l$!s ( or r for short). We show that performing the model- that all the characteristic models are is an reasoning with models. Therefore, correct this and 5.1. Exact deduction Definition 5.1. Let F be a class of functions, knowledge base KB E 3 we define set of all minimal of KB with respect assignments the set r = r& and let B be a basis for T. For a of characteristic models to be the to the basis B. Formally, I$, = U{z E minb(KB)}. bEB Theorem 5.2. Let KB, (Y E 3 and let B be a basis for 3. Then KB /= (Y if and only if for every u E r;,, a(u) = I. r = rg, S: KB and therefore, if there is z E r such that a( z ) = 0 then Proof. Clearly, KB F a. For the other direction that for all u E r, a(u) = 1. We will show that if y E KB, then a(y) = 1. From Corollary 4.6, since B is a basis for cy, and for all u E r, cu( U) = 1, we have that assume trU E r, Vb E B, %,,b E minb(ff) such that u ab r&b. Consider now a model y E KB. Again, Corollary 4.6 implies that V’b E B, 32 E min b(KB) such that y ab z. (2) (3) By the assumption, LY and therefore, as in Eq. (2) we have that since minb(KB) G r, all the elements z identified in Eq. (3) satisfy VZ, E min b( KB), 3u,,b E min b( a) such that Z >‘b u,,b. (4) Substituting Eq. (4) into Eq. (3) gives the required condition on y E KB: Vb E B, 3v (z),b E minb(a) such that Y ab u(z),b which implies, by Corollary 4.6, that a(y) = 1. Cl The above This requirement theorem requires is somewhat that KB and a can be described by the same basis B. theorem. relaxed in the following Theorem 5.3. Let KB be a propositional expression with basis B and let LY be a query with basis B’. Then rgiB’ is a model-based representation for the inference problem KB k (Y. That is, KB k cx ifand only iffor every u E TggB’, a(u) = 1. Proof. It is clear, from Eq. (1) and Claim 4.2(4), and cy. Therefore, Theorem 5.2 implies the result. q that B U B’ is a basis both for KB The set 1’ relative that Note to B = (0000, IlOl} is: r = {iOOO,OlOO, it includes only 7 out of the 12 satisfying (continued). Example 0011,1100,1111,1001,0101}. assignments are implied by f. we concentrate of f. Since model-based deduction does not make mistakes on queries in our examples on queries that that are not implied by f. the query UY] = _ A fi + x4. This is equivalent to .I-? V X.J V x4 which is falsified by 0000 so B is a basis for (~1. Reasoning with r will find the counterexample To exemplify Theorem 5.2 consider IO00 and will therefore conclude f F CYI. The query LYE = ~‘1 A.x~ _-a x2 is equivalent to fiV._y:! Vz which is not falsified by the basis B. Therefore B is not a basis for cy:! and model-based deduction might be wrong. Indeed /= cy2 (it is wrong since the assignments reasoning with r will not find a counterexample 1010, 101 I satisfy and will conclude ,f but not cyz). f Next, to exemplify Theorem 5.3 consider adding a basis element be either 1010, or 101 1. Choosing { lOlO}. and reasoning with /’ would bc correct on CYJ. 1010, the set of additional minimal elements for cuz. This could is in r We have shown in the discussion above how to perform deduction with the set of characteristic models I-&. where B is a basis for the knowledge base KB. In this section we consider the set of characteristic models of KB knowledge base KB. to a basis B that is not a basis is constructed with respect the natural generalization to the case in which for the We show that even in this case we can perform exact deduction. As we show, reasoning to reasoning [ 331 of KB in the class of functions with basis in Theorem 5.6, is that for queries with basis B with characteristic models of KB with respect with the B. The significance reasoning with models yields correct deduction. to a basis B is equivalent least upper bound of this, as proved (LUB) expression the original A theory of knowledge compilation in a series of papers the original expression man and Kautz by replacing plies bound). While reasoning with the approximations not always guarantee inference problems. Of course. computing problem, problems of computing Horn approximations in [5.10,30]. (a lower bound) reasoning, correct using Horn approximation was developed by Sel- [ IS, 16,331. Their goal is to speed up inference of it, one that im- by two Horn approximations and one that is implied by it (an upper instead of the original expression does to the it sometimes provides a quick answer is a hard computational and this is why it is suggested as a compilation process. The computational the approximations and reasoning with them are studied also To facilitate the notion of an approximation the presentation we first define We then show that representing KB with a set of characteristic models with respect a basis B yields a function which basis B). We proceed with models yields correct deduction particular, we can construct a Horn LUB and reason with it, generalizing discussed of KB. to is the LLJB of KB (in the class of functions with In this case, reasoning In language. (see Claim 6.2) the concept defined and for all queries is a small fixed basis for all Horn expressions in the approximation in [ 1.5, 16,331. the implication to reasoning. to show there since R. Khardon, D. Roth/Arttjkial Intelligence 87 (1996) 187-213 199 Definition 5.4 (Least upper bound). Let F, G be families of propositional Given and there is no f’ E E such that f C f’ C fiuh. f E _F we say that flub E 6 is a G-least upper bound of f if and only if f c flub languages. These bounds theorem characterizes are called G-approximations of the original function f. The next the $LUI3 of a function and shows that it is unique. Theorem 5.5. Let f be any propositional expression and G the class of all propositional expressions with basis B. Then flub = A J%(f). bEB Proof. Define g = AbEB Mb(f). We need to prove (3) prove (2) we need to show that B is a basis for g. Indeed, there is no f’ E G such that f c f’ C g. that (1) is immediate (1) f C g, (2) g E G and from Claim 4.2(4). To A Mb(g) bEB = /j Mb 668 A bivb,EBxb,+bj J”b,Mb, (f) ) =gA s g. Using Claim 4.2(4) is g E 6. Finally, again we get g 2 AMb(g) = g, that and therefore AbEB Mb(g) that there exists f’ E 0 such that f C f’. Then, to prove (3) assume g = A Mb(f) hEB c A Mb(f’) = f’, bEB where the last equality results from the fact that f’ E G. Therefore, g = flub. 0 The following theorem can be seen as a generalization of Theorem 5.2, in which we do not require that the basis B is the basis of KB. Theorem 5.6. Let KB E 3, LY E $7 and let B be a basis for B. Then KB k LY if and only iffor every u E r&, a(u) = 1. Proof. We have shown in Theorem 5.5 that 200 R. Khanion. D. Rn~l~/Artijicurl inrelii~ence 87 (I 996) 187-213 Assume a(u) = I for every u t I&. By Theorem 5.2, we have that KBlub /= LY and a(u) = 0, therefore KB /== a. On the other hand, since rfB C_ KB, if for some u E I’!,, then KB k cx. G A result similar Horn expressions, to the corollary is discussed in [ 5,6,15]. that follows, for the case in which G is the class of Corollary 5.7. Model-based in G. correct for all queries reasoning with KBlub (with respect to the language G) is Example (continued). The Horn basis for our example is: B~=(IIiI,1ll0,lIOI.IOII.O1ll) (see Claim 6.2). The minimal elements with respect to 1101 were given before. Each of the models 1 I II,01 11, 101 1, 1 110 satisfies J‘ and therefore for each of these, minb( f) = b and together we get that 1’~“={1111,0111,101I.1100.1001.0101.1110}. For the query “3 = XI A 2-3 + (x2 V’ .TJ ). which is not Horn, reasoning with rfBll will f but not cy). For the Horn query cr2 = XI A ~3 -+ x2, (since 1010 satisfies be wrong reasoning with 1’;” will find the counterexample 101 1 and therefore be correct. 5.3. All models are necessar?, So far we have seen that characteristic models can support correct is whether one really needs all these models question mance. We next show that this is indeed correct reasoning with models teristic models (with respect to this class). for all queries reasoning. The such perfor- in order to guarantee the case. Any set of models, which guarantees in a class G, must include all the charac- In the following theorem, we say that a set R supports correct reasoning for G, if for all LY E 6. KB /= LY if and only if for every II 6 R. a(u) = 1. Theorem 5.8. Let B C all Boolean R C KB & (0, 1 }‘I. If R supports correct reasoning for G then I‘& 2 R. (0, I }” be a xt of mssignments, and let G be the class of that can be represented using B as a basis. Let KB t _F and functions there exists a set R that satisfies Proof. Suppose I$$ g R, and consider x E I$, for all II E R, a*(u) = I, but still KB k a*, yielding a contradiction. that \ R. We show that there is a function LY* E G such that the above property and such are exactly is. the LLJB with respect Indeed, let LY* = RL,,. (That satisfying assignments R C a*, that is, all the elements that since x E rB KB, .X is a minimal mode1 with respect this element 6, we get that for all z E KB, and in particular is x @’ M,,(R). Using Theorem 5.5 we get that x @ cy*. 0 to B of the function whose a* E G, and in R satisfy (Y*. However, KB k CY*. To see that, notice to for all z E R, x s,, z, that the elements of R.) Then, by definition, to some b E B. With respect R. Khardon, D. Roth/Artificial Intelligence 87 (1996) 187-213 201 Note the difference in the premises of Theorem 5.8 and the previous two theorems, Theorems 5.2 and 5.6. Theorem 5.8 shows that every element of the set r is necessary in order to get correct deduction. What the proof shows is that there is a function cy* in the class represented by B, which necessitates the use of each element x in r. Note that, in general, if B is a basis for 9 it does not mean that all functions in the class represented by B are in the class E, and therefore the premises of the previous theorems are not enough to yield this result. (We discuss this point further in Section 8.) In the next section we discuss with some details the basis BH of the class of Horn expressions. We note that in this case, as well as in the case of the basis BH~ of k- quasi-Horn functions, the bases represent those classes exactly. That is, a function is k-quasi-Horn if and only if it can be represented using BH~. Therefore, Theorem 5.8 holds for these cases. 6. Horn expressions In this section we consider in detail the case of Horn formulas and show that in this case our notion of characteristic models coincides with the notion introduced in [ 141. (Characteristic models for Horn expressions also coincide with the notion of generators in relational database theory [2,18] .) We then discuss the issue of using a&ed model- based representation for answering unrestricted queries. We show that this extension, discussed in [ 141, relies on a special property of Horn formulas and does not generalize to other propositional languages. An example that explains this phenomenon is given. We start by showing that Horn formulas have a small basis. Definition 6.1. Let BH = {u E (0, I}” 1 weight(u) 2 n-l}. denote the element with the ith bit set to zero and all the others set to one, and by b(O) the element with weight n. In BH, let b(‘) (1 f i < n) Claim 6.2. The set BH = {u E (0, 1)” 1 weight(u) >/ n - 1) is a basis for any function that can be represented using a Horn CNF expression. Proof. Let KB be any Horn function. By Claim 4.7 it is enough to show that if C is a clause in the CNF representation of KB then it is falsified by one of the basis elements in B. Indeed, if C is a clause in which all the literals are negative, then it is falsified by b(O). If xk is the only variable that appears un-negated in C then C is falsified by b’@. 0 6.1. Characteristic models In order to relate to the results from [ 141 we need a few definitions presented there. For u, u E (0, l}“, we define the intersection of u and u to be the assignment z E (0, 1)” such that zi = 1 if and only if ui = 1 and 0; = 1 (i.e., the bitwise logical-and of u and u). For any set S C (0, l}“, we denote by intersect(S) the assignment resulting from bitwise intersection of all models in S. Proof. A proof given are closed under a Horn clause 6’~ such expression. c in C.) Let c‘ be any clause m Horn strengthening of c’. and the ith positive and c; /= c. The claim 202 R. Klrurdon. D. Rorh/Artijuul It~telligence 87 (I 996) 187-213 The closure of S i (0, 1 }‘I, denoted rlosure( S), is defined as the smallest set con- taining S that is closed under intersection. Let KB be a Horn expression. The set of the Horn characteristic models of KB, de- noted here char-H (KB) of other models of KB. Formally, is defined as the set of models of KB that are not the intersection charH(KB) = {u E KB j II @ closure(KB \ {[4})}. (5) The following claim is due to McKinsey in [ 271 is given in the context of first order equational expressions, different. To facilitate 1271, and has also been discussed by Horn and the discussion, we give an for (A different proof of this property, terminology. [ 11 1, The claim the notation used there is substantially adaption of the proof to the current the propositional domain, appears in [ 6 1.) Claim 6.3 (see 1 ,271 ) A Booleatr,~ur~~~tion ~LIII be represented using a Horn expression if atld orlly ij’ irs .set of models is closed utrder intersection. in [ 371. For the other direction, intersection. We claim that the models of Horn expressions intersection let C be a CNF expression are closed under is such that its models that every clause c in C can be replaced with as a Horn is over all the clauses that C ,/= (‘I/ /= c. Therefore, C can be re-written (Since C /= A CII /= jj c = C, w h ere the intersection implied by C, and assume [ 141 clauses of c. as follows: c; includes all the negative literals. Define literals literal of’ c. Thus, each of the clauses ci is a Horn dis.junction, that it has m positive is that one of the clauses c, can serve as CI~ above. Assume, by way of contradiction, that this is not the case. Then, for all i, there is a model x’ such that C( x’) = 1 and c, (.v’ ) = 0. Let 5’ = {.I+‘}, and let .v be the assignment defined by x = intersect(S). falsified y. Similarly, Therefore. the literals literals of c; are I ), and therefore are also falsified in in x’ (that is, the variable has value 0). that all Cl literal in the intersection y this positive in c are falsified in v, and therefore c(y) = 0 and C k c, a contradiction. Then since s’ falsifies c,. all the negative in xi (that is, all the variables have value literal is also falsified. We conclude in ci is falsified the positive Based on this characterization of Horn expressions, expression KB. In [ 141 it is shown and M C KB any subset of its models, that if we take M = charH( KB), then we get it is clear that if KB is a Horn = 5 closure(KB) then closure(M) closure(charH( KB) ) = c?o.vureC KB) = KH implies that chur,~( KB) In particular, Eq. (5) property. Based on this it is then shown In the following we show that with respect to the basis BH from yields correct deduction. Claim 6.2, and for any Horn expression KB, chat-H (KB) = I$:. Therefore charH (KB) is an instance of the theory developed in Section 5. and we can reason with it according to Theorem 5.2. deduction using charH(KB) subset of KB with that that model-based is the smallest R. Khardon, D. Roth/Artificial Intelligence 87 (1996) 187-213 203 Theorem 6.4. Let KB be a Horn expression and BH = (1.4 E (0, 1)” 1 weight(u) 2 n - 1). Then, charH( KB) = I$& Proof. Denote that KB = closure(r) that property. Consider E rnit+,c,l (f) r = r$j. In order to show that charH (KB) C r, it is sufficient to prove is the smallest subset of KB with . This is true since char” (KB) .K E KB, Corollary such that x >b(,j u(~). We claim that implies 4.6 that for all b(j) E B, there exists nci) x = intersect( {UCk) 1 xk = 0)) E cfosure( r). To see that, consider first the zero bits of x. Let Xj = 0, this implies that u(j) is in the intersection and that it satisfies x >bc,l &). Since X,i = 0 and b(” = 0 the fact Xj >h~,) u,ij) implies U$j) = 0, and the intersection on this bit is also 0. ’ Consider now the case Xj = 1. Since all the rick) in the intersection are such that Xk = 0, the order relation on the jth bit is always the reversed order, 61. That is, all the that for all the uCk) in the rick) in the intersection satisfy 1 = xj 21 u, (k) This implies . intersection of charH(KBj C r. c4!k) = 1 and the intersection on this bit is also 1. This completes the proof To prove r C charH( KB) , we show that if x E r, x cannot be represented as x = intersect( {y, z}) where y, z E KB and x $ y, z. Since ChUrH in KB (from Eq. (5) ) , we get the result. of all those elements (KB) is the collection Consider x E minbrtj (KB) C r, and suppose by way of contradiction that 3y, z E KB such that x = intersect( {y, z}) and x $ y, z. Fix the order relation bck) and consider the indices of x. First consider an index i $ k. Since bi (k) = 1 the order relation of the ith is the reversed one. NOW, if yi = zi then xi = yi = zi, and if vi $ zi then Xi = 0. index in both cases we get that for all i # k, Xi ~QU yi and Xi >b~~~ zi. For the Therefore, case k = 0, the indices and since x E rninbch, (KB), proves the claim. i $ k include all the bits. This implies x >b~k) y and x >b~k~ z that x # y, z, and therefore this contradicts the assumption Otherwise, when k # 0 we consider also the order relation of the kth index, which if yk = zk then xk = yk = zk and if yi # zi then Xi = 0. This is the usual order. Again, implies that Xk 2b~k) yk or xk >~kj zk. Together with the case i # k Ge get that x ab,~I z or x >b~j y (depends on whether that this contradicts the assumption Zk = 0 or yk = 0). But since x E rninh,kj (KB), x $ y, z, and completes the proof. 0 6.2. General queries In [ 141 it is shown can answer any CNF query without have shown that our general model-based that when the “world” can be described as a Horn expression one the characteristic models. While we coincides with that of [ 141 for representation re-computing 204 R. Kharhn. D. Rotll/Art~~ml Intelligence 87 (I 996) 187-213 the case of Horn expressions, a special property of Horn expressions, languages. We next give a counterexample it turns out that the ability to answer any query relies on and does not generalize this. that exemplifies to other propositional The deduction scheme in [ 141 when cy is a general CNF expression, utilizes the following observations: C 1 ) Every disjunction LY can be represented as LY = Bt V . V & where the ,Bi are Horn disjunctions. ( 2) KB /= LYI(Y~ if and only if KB /= cul and KB b cuz. and cy any disjunction. (3) Let KB be a Horn expression ,B such that KB k p and B /== cy. Horn disjunction If KB b cy then there is a Notice that observation (3) uses McKinsey’s derived in a different way, using a completeness proof of Claim 6.3. (In 1 141 it is theorem for resolution given in 1361.) Observation (2) implies that it is enough to consider queries that are disjunctions, in [ 141 decomposes Given LY, the deduction tests deduction against observations (3) does not hold in more general cases. In particular, even expressions have minimal scheme pi and the B,. By (3) at least one of the Bi is implied by KB. While as in ( I ) and (2) are true even for non-Horn expressions, conclusions which arc not 2-quasi-Horn. it into the Horn disjunctions a decomposition in 2-quasi-Horn Example.Let:K~=(x~V.v~‘~~~x;l~~~(.r-~v.~~~Xg),~=x~~~~~~~~~~~. The knowledge base is a 2-quasi-Horn However. there is no disjunction B such that KB /= /3 /= a. expression, and it is easy to check that KB k LY. 7. The size of model-based representations representation It is therefore In the previous of the same function. reasoning important The complexity of model-based is directly related to compare to the number of models this size with the size of other that our is Horn. In is the same as that in [ 141 when the function are given for large Horn expressions with a small set of characteristic in the representation. representations model-based [ 141 examples models and vice versa, but it was not yet understood when and why it happens. Our results if the that the set of characteristic models of a Horn expression is small. As we show, the other direction size of a DNF description is not true. That is, there are Horn expressions with a small set of characteristic models but an exponential size DNF. WC start with a bound on the size of the model-based representation. section we have shown for the same function is small imply Lemma 7.1. Let B be a basis ,for the knowledge base KB. Then, model-based representation of KB is the size of the im G Cl minh(KB)I hEB < JBi. IDNF(KB)(. Proof. The lemma follows from Corollary 4.9. 0 R. Khardon. D. Roth/Artificial Intelligence 87 (1996) 187-213 205 As the following claim shows, this bound is actually achieved for some functions. For the next claim, we need the following function of f and the conjunction f, if t /= f. A term t is a prime implicanr of a function f, if t is an implicant of any proper subset of the literals in t is not an implicant. terminology. A term t is an implicant of a Claim 7.2. For any b-monotone function f, 1 minb( f> 1 = JDNF( f) I. there function functions and consider It is well known (i.e., On-monotone). element. Moreover, implicant. Let f be a monotone is a unique DNF representation function that in which each term is for this representation Proof. We first consider monotone for a monotone a prime f. As in Claim 4.8 we can map every is On, minimal (otherwise one of the each of these minimal elements there is a one to one terms in the representation correspondence of f with respect to b = On, and ( rninott ( f) 1 = IDNF( f) (. The same arguments hold for any b-monotone function with respect therefore 1 minb( f) 1 = IDNF( f) I. q is indeed a minimal element off implicant). Therefore, and minimal to the order relation b (one can simply rename is not a prime implicants since the terms are monotone term in the representation and the order relation to its corresponding between prime the variables) assignments and Claim 7.2 explains the two examples one has a small DNF and the function consider functions, particular, in [ 14). Both examples are l”-monotone Horn large DNF. In the other has an exponentially f= A xiE{P,.Y,} (YclV?qV..-VTig =v (EATi’) {pi, qi}gl defined on the 2n variables propositional CNF expression that when multiplying out the CNF expression, and the size of the set of characteristic models function in (see details [ 141. The function there), but its DNF size is O(n) f does not have a short (observe every term contains E A q for some i) [ 141, the is O(n2). On the other hand size CNF expression, but its DNF, and therefore the set of characteristic has a linear models are of size 0(2”). We note that exponential in b-monotone a conjunction DNF size has to be exponential to happen representations functions. One can easily construct such functions by using, for example, the of several each b-monotone with a different b (of course here too). The following claim shows that DNF size is are not restricted size model-based functions, not a lower bound on the size of the model-based for which the DNF size is exponential and therefore, the complexity of model-based but the size of the model-based is polynomial. reasoning, representation. There are expressions representation, Proof. For each II WC exhibit a lormula .f’ with the required property. The function to observe by renaming in which each term formula A _______ A ( x,,_ ,,q+ , 'J .Y,,_. fi/;;+ z ? V :G 'd A-,, ) is clearly in Horn form. The siLe of its DNF representation is V”?‘. This is easy literal as its negation. This yields a monotone each negative we get, by multiplying one variable The set I‘ is of size < 2~. Recall from each clause, that b (” G Bt, denotes is a prime implicant. the basis element assignment h (j) is not a satisfying the variable X, is assigned 0, and that /I”” = I”, First observe of ,f and therefore has only one minimal element is a satisfying assignment itself). For i = kfi, one clause, C’. not satisfied by l)(I), the clause which since each variable appears only once a satisfying (Flipping O(“.) One assignments, is that each of these b”’ would have it only once. and count ( fi is minimal. This contributes in j’. each of the variables so WC riced to count assignment which of f. There fi minimal last note includes (that that for i + kfi, in which b”) is. is however only the variable xi. Now, in C’ we flip yields assignments. variables not in C’ does not contribute minimal assignments with respect to I” as one of the minimal I ) for each of the b(j). G minimalelements. - Altogethertherearc (n-,/n)+fi(q’~~I)-+I =2(n-&+I We note that while the previous examples were constructed as Horn functions, it is clear that the same can be done for any class of functions with known basis. function indicates representation the following representations. that in some sense, the DNF representation The previous discussion and the characteristic models of a Boolean introduced here are in- comparable. While we do not consider here the question of how to get this knowledge representation, model-based sentation. representation characteristic models of this function. Thcreforc. data and cannot be built using DNF. Considering model-based to one more advantage of size DNF repre- learn a DNF the set of from then reasons using characteristic models can be built, while such a system f&t. shown Let f b c a function with a polynomial there that while we do not know how to efficiently representations, Claim 7.2 implies to efficiently system that for every basis there learn that learns in ( 191, points of the function it is possible It is shown from data, a complete is a function which has an exponential one might hope that there is a basis for which the least upper bound will always have form that admits fast reasoning. Kautz and small representations number of characteristic models. Nevertheless, in some (maybe other) R. Khardon, D. Roth/Artificial Intelligence 87 (1996) 187-213 207 [ 161 show that for Horn representations Selman show that unless NP C non-uniform have a short representation using essentially Horn, log n-CNF, and monotone they P there is a function whose Horn LUB does not that allows for efficient reasoning. This can be generalized, 3 the same proof, to hold for every fixed basis and in particular, k-quasi- this is not the case. In particular, functions. We therefore have the following theorem: Theorem 7.4. Unless NP C non-uniform P, for every fixed basis B there exists a func- tion whose LUB does not have a short representation which admits efJicient reasoning. 8. Applications In Section 5 we developed section we discuss applications the general of this theory theory for model-based deduction. In this to specific propositional languages. Our basic result (Theorem 5.2) assumed that the knowledge base and the query share the same basis. We give such queries a special status. Definition 8.1. Let L? be a basis for KB. A query (Y is relevant to KB (and B), if B is a basis for CY. The notion of relevant queries depends on therefore hard to characterize tions where KB has some special properties Moreover, important is in situa- length). the language used for representing KB may indicate which queries are more in a particular domain. the particular in general. However, relevant queries are useful (e.g., all the rules are of bounded choice of basis, and Theorem 5.3 suggests one way in which to overcome the difficulty (Y. This can be done by: to the knowledge base basis, and (2) computing the basis B of KB is not a basis for the query the basis B’ of the query characteristic models based on the new basis. Claim 4.7 suggests a simple way for the problem of computing computing that we do not in an on-line process address here. Neither do we consider computing performed in the form of its set of characteristic models. A second and preferred way of using in (1). However, is in general a hard problem additional models for a given query, as required characteristic models in the case where (1) adding additional for each query. At this point we assume that the knowledge base is given the basis additional the model-based representation 5.6 shows in Section 5.2. Theorem unrestricted KB, as long as it is represented to the basis of the query respect fact that wide classes of query of functions which have fixed polynomial reversed Horn CNF formulas (3) k-quasi-Horn most k positive in each clause), (a generalization formulas literals that one can reason correctly with respect language. The power of this method languages have small bases. Some is suggested to an as a set of characteristic models with from the classes (2) at most one negative literal), results important size bases are: ( 1) Horn CNF formulas, (CNF with clauses containing of Horn expressions (4) k-quasi-reversed Horn formulas in which there are at and (5) 3 This issue has been brought to our attention by Henry Kautz and Bart Selman. 208 R. Khtrrdon. 0. Koth/Art&w_~l Jnrelligence X7 (1996) 187-213 log n-CNF fact is captured by the following definition formulas (CNF for common queries. in which the clauses contain at most O(logn) literals). This Definition 8.2. A iunction from one of the above classes. The union of the bases for these classes for all common functions. We refer to this class as the class of common queries Cc. if every clause in its CNF representation is taken is a basis, Bc, is common Notice that we could add to Cc, any additional class with a fixed polynomial size basis which may fit a particular number of such classes In Claim 6.2 we have shown application. However, we can only add a polynomial (since otherwise the cumulative basis size will be too large). that Horn formulas have a short basis. A similar con- formulas, and k-quasi- struction yields a basis for reversed Horn formulas, k-quasi-Horn reversed Horn formulas. Claim 8.3. There is a polynomial .siz,e basis,fix formulas. and k-quasi-reversed Horn .formulas. reversed Horn formulas, k-quasi-Horn is very similar the polarity of Proof. The analysis all bits in BH WC can get a basis for reversed Horn. Similarly, using the set Bfft = {u E (0, I }‘I j bveighr(u) > n - k) we gel ;i basis for k-quasi-Horn, of all bits in BH* we get a basis for k-quasi-reversed Horn formulas. to the one in Claim 6.2. By flipping and flipping the polarity cl Next we consider the expressive class of logn-CNF formulas, in which there are up to O(log~) variables An (n. k)-universal in a clause, and show that it has a polynomial set is a set of assignments {dl, size basis. subset of k variables assumes all of its 2” possible assignments [I] that for k = logn one can construct (n, k)-universal sets of polynomial size. d,} C (0, 1)” such that every in the d;. It is known Claim 8.4 (see [4] ). Let B he an (n, k)-universal k-CNF KB. set. Then B is a Oasis for any to show that if C is a clause Proof. By Claim 4.7 it is enough tation of KB then it is falsified by one of the basis elements be a clause an assignment. Then an (n, k)-universal in the k-CNF represen- . . V Ii, of KB, where l;, E {Xik,q}. Let a E (0, 1)” be . ,alt and since B is is determined only by ai,, in the CNF representation the value C(a) set, there must be an element 0 E B for which C(b) = 0. in B. Let C = li, V (cid:144)i the fact that B is a basis for the class of functions F does that all functions with basis B are in 3. For example, given a particular functions, outside of log n-CNF, have B is in fact wider than stated.) Thus, in set B, many other Boolean is, the class of common queries set, is not equivalent to B, an (n, logn) to the least upper bound in the richer class of functions but rather it is the least upper bound We note that in general not mean (II, log n) -universal as their basis. (That fill,, with respect the class logn-CNF with basis B. It is easy to observe and BHk. In these cases, exactly the classes of Boolean that this does not happen when using the bases BH functions described by the bases are the classes of Horn expressions and k-quasi-Horn expressions, respectively. R. Khardon, D. Roth/Artificial Intelligence 87 (1996) 187-213 209 8.1, Main applications reduces or relevant queries formula on a polynomial Reasoning with common propositional and easily parallelizable with common queries, we do not need to use the basis of KB at all, and it is enough represent KB by the set of characteristic models with respect language. Lemma 7.1 together with Theorems 5.2, 5.3, 5.5 and 5.6 imply general applications of a is a very simple number of assignments. This procedure. Moreover, Theorem 5.6 shows that in order to reason to to the basis of the query the following to a simple evaluation of our theory: : (0, 1)” -+ (0, 1) that has a polynomial size repre- Theorem 8.5. Any function f sentation in both DNF and CNF form can be described with a polynomial size set of characteristic models. Theorem 8.6. Any function f : (0, 1)” -+ (0, 1) in T E CC which has a polynomial size DNF representation can be described with a polynomial size set of characteristic models. Theorem 8.7. Let KB be a knowledge base (on n variables) that can be described with a polynomial size set r of characteristic models. Then, for any relevant or common query, model-based deduction using r is both correct and eficient. Theorem 8.8. Let KB be a knowledge base (on n variables) that can be described with a polynomial size DNE Then there exists a fixed, polynomial size set of models r, such that for any common query, model-based deduction using r is both correct and eficient. is function The results use first order logic as their main tool, some applications into a finite propositional the full power of first order logic. It is quite easy in this paper are concerned mainly with propositional many AI formalizations not need formalization which be mapped propositional ample, languages. While do that any such free and has a fixed and finite number of objects can a language. This can be done by introducing of predicates and objects. For ex- instantiation if the objects are a, b, c, . . ., then a predicate p (x, y) would be represented using is the a with the number of predicate symbols, n, the predicates. Furthermore, arity in Horn p(a,~),p(6,c),p(a,c),. for every possible of such variables variables. The ( nO)a, where (or any other the maximum to observe sentence function variable denotes denotes . . by of objects, and free fixed basis) imply remains that vations Horn form4 the new domain. These results hold for these first order logic 4 We note that the CNF formula size grows exponentially with the number of quantifiers. This, does not affect our results which depend on the size of the basis and the size of the DNF formula. however, 9. Abduction with models In this section we consider [ 141 it is shown representation. In in polynomial done that using formula-based show that the algorithm presented representation the question of performing abduction using a model-based that for a Horn expression KB, abduction time using characteristic models. This the problem is NP-hard in 1 14) works for non-Horn can be is contrasted with the fact [ 341. In this section we expressions as well. Abduction is the task of finding a minimal explanation for some observation. Formally is given a knowledge base KB (the background letters’ A (the ~rs.su~~@orr .set). and a query a set of theory), letter y. An explanation of [ 291. the reasoner propositional q is a minimal (I) KBA(&,,x) (2) KB/\ Thus, abduction for an explanation from subset E c A such that kqand $a. (/&r) involves tests for entailment (2), but also a search that passes both tests. We now show how one can use the algorithm ( I ) and consistency [ 141 for any propositional expression KB. theory with a basis B, ler A be Theorem 9.1. Let KB be a but~kgroutzd pmpositional 3 tl - I}. Then, set and q be a quety Ler BH = (x E (0, 1)” j weight(x) an assumption using the set of characteristic models I’ = l$FB” one can find an abductive explanation of cl in time polytlomial in /I’] md IA 1. Proof. We use the algorithm Explain suggested in [ 14 1 for the case of a Horn knowledge base. For a Horn expression KB the algorithm uses the set charH( KB) = Z$$ defined in Section 6. We show that adding characteristic for it to work in the general models case. the Horn basis BH and the additional to a general model-based representation is sufficient The abduction algorithm Explain starts by enumerating in which the query holds it finds a model of all When conjunction strongest set of assumptions the variables in A that are set to 1 in that model. that are valid in this model.) all the characteristic models. (i.e., y = 1) it sets E to be the is the (This The algorithm then performs the entailment check whether E is a valid explanation. This test is equivalent KB /= (YV (VrEE i)), According to Theorem 5.3, this can be done efficiently with f$“‘. that is, a deductive test (( 1) in the definition above) the deduction inference with a Horn clause as the query. to testing to If the test succeeds, the assumption set is minimized variables outputs explanation, from E and using a minimal assumption the entailment set E (in test again. the sense not necessarily of smallest cardinality) in a greedy fashion by eliminating It is clear that if the algorithm that no subset of E is a valid is it is correct. Minimality then s The task of abduction is normally defined with arbitrary liter& for explanations. For Horn expressions explanations turn out to be composed of positive literals (this can be concluded from 129. Corollary 41). Here we restrict ourselves to explanations composed of positive literals (by allowing only positive literals in the assumption set) when using general expressions. One may therefore talk about “positive explanations” instead of explanations. We nevertheless continue with the term explanation. R. Khardon, D. Roth/Art@cial Intelligence 87 (1996) 187-213 211 guaranteed by the greedy algorithm, requirement It remains (2) by the existence of the original model to show that if an explanation the requirement (I) by the deductive test, and the that produced the explanation. to show that in such a case there is a model x E r exists, the algorithm will find one. To prove in which both this, it is sufficient the bit 9 and a superset of E are set to 1. The existence of x is a direct consequence the basis. This is true as relative a model y which satisfies some explanation E, either it is a minimal assignment to b, or 3x <b y and x is in r. In the first case x = y is the required assignment, that yi = 1 implies xi = 1 which is what we need. Cl second case we observe to b we have 1 <b 0 for each bit. Therefore the base assignment b = 1” in if there is relative in the of including It is quite easy to see that the above theorem can be generalized set A to have up to k negative in several ways. First, for some constant instead of B H. Secondly, we can allow the query literals the assumption we can allow k and use the basis for k-quasi-Horn 4 to be any Horn expression instead of just one positive literal. 10. Conclusions and further work needed theory of model-based This paper develops a formal a simple model-based an exponentially identifying all the information for a fairly allow efficient provides efficient The restricted approach can support exact deduction reasoning. We have shown and abduction large class of propositional reasoning, that even when small portion of the model space is tested. Our approach builds on ( 1) a set of characteristic models of the knowledge base that together capture to reason with (2) a restricted set of queries. We prove that that do not including is compact and formula-based reasoning. set of queries, which we call relevant queries and common queries, for example, languages that language in the for both the speed and flexibility of include, or from the same propositional approach from a wide class of propositional expressions the “world”. We argue expressions, the model-based can come quasi-Horn represents effort to give a computational common-sense and logn-CNF), is a reasonable that accounts representation expressions reasoning. that this to take theory (and The usefulness of the approach developed here is exemplified generalizes investigations, and unifies many previous explains, fundamental works on reasoning with Horn models [ l&16,33]. Recently, been obtained, rithms for reasoning within context and for default reasoning have been developed An extension of the theory presented here, that applies assignments for reasoning with characteristic models have efficient algo- of this approach. [ 201. in the case where only partial are given in the knowledge base, is described results the usefulness [ 141 and Horn approximations some more positive In particular, exhibiting and by the fact that in particular it the in [21]. framework which views learning as an integral in constructing that some of the difficulties This work is part of a more general part of the reasoning an adequate computational process. We believe theory to reasoning result from the fact that these two tasks ?I? R. Khurdo~~ Il. Roth/Art~f~ficxtl Inrelli,gence 87 (I 996) I X7-2 13 are viewed as separate. The “learning view, is developed and investigated importance of the model-based to reason” in [ 191. In particular, framework, which emphasizes the results there illustrate this the approach research are possible. As mentioned to reasoning. in order to apply embedded logic, where Several directions the size of models is bounded. However, in the first order formalization. this problem. On the positive side, we note that Fagin for future hold for restricted cases of first order in the paper, our the number of objects, and this, one has to In the general case, the size of the models may be infinite and it is not clear how one can [ 91 has shown that for (infinite) model the of planning were in the form of to several deduction queries. The in a way that the queries can be for finite implications, is more results therefore lose all the structure though, even overcome a certain class of (Horn related) suffices problem of planning. Since formalizations deduction queries, one can reduce a planning problem can be done question here is whether this reduction answered efficiently using a model-based approach. Some simple pre-fixed domains, demanding. immediate. However. solving first order logic expressions. in the language. Another line of research concerns to answer all queries the general question the original are quite a single Acknowledgements We wish to thank Les Valiant for helpful discussions and comments. References [ I 1 N. Alon, J. Bruck. J. Naor. M. Naor and R. Roth. Construction of asymptotically good low-rate error- correcting codes through pseudo-random gmphh. /&YE Trc~n.~. /~@uYu. &or?_ 38 ( 1992) 509-5 16. 12 I C. Beeri, M. Dowd, R. Fagin and R. Statman, On the structure of Armstrong relations for functional dependencies, J. ACM 31 ( 1984) 30-46 13 I R. Brachtnan and H. Levesque, The tractability of \ubsumption in frame based description languages, in: Proceedings AAAI-84, Austin. TX ( 1984) 3437 14 1 N.H. Bshouty, Exact learning via the monotone q/ Computer Science, Palo Alto. CA ( I993 ) 302-3 theory. I I in: Proceedings IEEE Sympo.~ium ON Founduth 15 1 M. Cadoli, Semantical and computational (1993) 39-44. C’hambery aspects of Horn approximations, in: Proceedings /JCAI-93, (6) R. Dechter and J. Pearl, Structure 171 J. Doyle and R. Patil, Two identificatton in relational data. Ar/g: lntell. 58 ( 1992) 237-270. theses of knowledge representation: language restrictions, taxonomic and the utility of representation services. Artif: he/l. 48 ( 199 1 ) 26 I-297. A. Borgida. R. Brachman and H. Kautz. Vivid knowledge and tractable reasoning: classification. 18 1 I>. Etherington, Preliminary report, in: Pn,cee&q~ IJCAI-RY, Detroit, MI ( 1989). 19) R. Fagin. Horn clauses and database dependencies, J. ACM 29 ( 1982) 952-985. 1 10) R. Greiner fntermrrional useful Horn approximations, of Knowledge Represen/ation Co+fkrence on Principles and D. Schuurmans. Learning in: PmcredinRs Third and Rcusoning, Cambridge, MA (1992) 383-392. 1 I I 1 A. Horn, On sentences which are true on direct unions of algebras, J. Symbolic Lqic‘ 16 ( I95 I ) 14-2 I. 1 12 ] PN. Johnson-Laird, Mental Model.7 (Harvard University Press, Cambridge, MA, 1983). ( 13 ( P.N. Johnson-Laird (Lawrence Erlbaum, London, 1991 ). [ 141 H. Kautz, M. Keams and B. Selman. Reasoning with characteristic models. and R.M.J. Byrne, Deduc/ion in: PmceedinRs AAAI-93. Washington, DC ( 1993) 34-39 R. Khardon, D. Roth/Artijicial Intelligence 87 (1996) 187-213 213 [ 15 1 H. Kautz and B. Selman, A general framework for knowledge compilation, in: Proceedings InternaGonal Workshop on Processing Declarative Knowledge, Kaiserlautem for fast inference, [ 161 H. Kautz and B. Selman, Forming concepts ( 1991). in: Proceedings AAAI-92, San Jose, CA (1992) 786-793. [ 17 I R. Khardon, Translating Res. 3 (1995) 349-372. between Horn representations and their characteristic models, J. Arrij fare/l. [ 18 I R. Khardon, H. Mannila and D. Roth, Reasoning with examples: propositional formulae and database Tech. Rept. TR-15-95, Aiken Computation Laboratory, Harvard University, Cambridge, dependencies, MA (1995). [ 191 R. Khardon and D. Roth, Learning to reason, in: Proceedings AAAI-94, Seattle, WA (1994) 682-687; full version: TR-02-94, Aiken Computation Laboratory, Harvard University, Cambridge, MA ( 1994). 1201 R. Khardon and D. Roth, Default-reasoning with models, in: Proceedings IJCAI-95, Montreal, Que. (1995) 319-325. (21 I R. Khardon and D. Roth, Learning to reason with a restricted view, in: Proceedings Workshop on Compurational Learning Theory (1995) 301-310. Image and Mind (Harvard University Press, Cambridge, MA, 1983). I22 1 S.M. Kosslyn, [ 23 I H. Levesque, Making believers out of computers, Artif. Inrell. 30 ( 1986) 81-108. [ 24 I H. Levesque, [ 25 1 H. Mannila and K.J. Raiha, Design by example: an application of Armstrong Is reasoning in: Proceeding 3rd NEC Research Symposium ( 1992). too hard?, relations, J. Cornput Syst. Sci. 33 (1986) 126-141. 1261 I. McCarthy, Programs with common sense, Thought Processes, National Physical Laboratory Semantic Information Processing (MIT Press, Cambridge, MA, 1968) 403-409; and H. Levesque, eds., Readings in Knowledge Representation ( 1985). in: Proceedings Symposium on the Mechanization of in: M. Minsky, ed., ( 1958) Vol. I. 77-84; reprinted also in: R. Brachman [27] J.C.C. McKinsey, The decision problem for some classes of sentences without quantifiers, J. Symbolic Logic 8 (1943) 61-76. [28 I C.H. Papadimitriou, On selecting a satisfying truth assignment, in: Proceedings 32nd Annual IEEE Symposium on Foundarions of Computer Science ( 1991) 163-169. I29 ] R. Reiter and J. De Kleer, Foundations of assumption-based truth maintenance systems, in: Proceedings AAAI-87, Seattle, WA (1987) 183-188. [ 301 D. Roth, On 613-618; the hardness of approximate also: Artif: Intell. 82 (1996) 273-302. reasoning, in: Proceedings IJCAI-93, Chambery ( 1993) 13 I ] B. Selman, Tractable default reasoning, PhD thesis, Department of Computer Science, University of Toronto, Toronto, Ont. ( 1990). [ 32J B. Selman and H. Kautz. Model-preference [ 331 B. Selman and H. Kautz, Knowledge Anaheim, CA ( 1991) 904-909. default theories, Artif: Infell. 45 ( 1990) 287-322. compilation using Horn approximations, in: Proceedings AAAI-91, [ 34 I B. Selman and H. Levesque, Abductive AAAI-90, Boston, MA ( 1990) 343-348. and default reasoning: a computational core, in: Proceedings [35] L. Shastri, A computational model of reasoning-taking inspiration from cognition, in: Proceedings IJCAI-93, Chambery tractable ( 1993) 202-207. [ 36 1 J. Slage, C. Chang and R. Lee, Completeness theorems for semantic resolution in consequence finding. in: Proceedings IJCAI-69, Washington, DC ( 1969) 281-285. 137) M.H. Van Emden and R.A. Kowalski, The semantics of predicate logic as a programming language, J. ACM 23 ( 1976) 733-742. 