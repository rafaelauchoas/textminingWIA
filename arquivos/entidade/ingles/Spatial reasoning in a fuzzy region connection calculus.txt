Artificial Intelligence 173 (2009) 258–298Contents lists available at ScienceDirectArtificial Intelligencewww.elsevier.com/locate/artintSpatial reasoning in a fuzzy region connection calculusSteven Schockaert∗,1, Martine De Cock, Etienne E. KerreGhent University, Department of Applied Mathematics and Computer Science, Krijgslaan 281 – S9, 9000 Gent, Belgiuma r t i c l ei n f oa b s t r a c tArticle history:Received 31 March 2008Received in revised form 18 August 2008Accepted 29 October 2008Available online 6 November 2008Keywords:Spatial reasoningRegion connection calculusFuzzy set theoryAlthough the region connection calculus (RCC) offers an appealing framework for modellingtopological relations,its application in real-world scenarios is hampered when spatialphenomena are affected by vagueness. To cope with this, we present a generalization ofthe RCC based on fuzzy set theory, and discuss how reasoning tasks such as satisfiabilityand entailment checking can be cast into linear programming problems. We furthermorereveal that reasoning in our fuzzy RCC is NP-complete, thus preserving the computationalcomplexity of reasoning in the RCC, and we identify an important tractable subfragment.Moreover, we show how reasoning tasks in our fuzzy RCC can also be reduced to reasoningtasks in the original RCC. While this link with the RCC could be exploited in practicalreasoning algorithms, we mainly focus on the theoretical consequences. In particular, usingthis link we establish a close relationship with the Egg–Yolk calculus, and we demonstratethat satisfiable knowledge bases can be realized by fuzzy regions in any dimension.© 2008 Elsevier B.V. All rights reserved.1. IntroductionTopological relations constitute an important facet of how humans perceive spatial configurations. Consequently, a largeproportion of the spatial information conveyed in natural language discourse is related to topology: we may find, for in-stance, that a certain geographic region is adjacent to, contained in or overlapping with another. The region connectioncalculus (RCC; [39]) has been proposed as a means to model such topological relations, and to reason about available topo-logical information (e.g., if a is adjacent to b, and b is a part of c, then c cannot be a part of a, regardless of how the regionsa, b and c are defined). A core feature of this calculus, discriminating it from related approaches such as the 9-intersectionmodel [12], is its generality. Starting from an arbitrary universe U of regions, topological relations are defined in terms ofan arbitrary reflexive and symmetric relation C in U , called connection (see Table 1 in Section 2). The intuitive meaning ofsome of the RCC relations from Table 1 is illustrated in Fig. 1. In particular, note that EC (externally connected) models adja-cency, while containment is modelled by TPP (tangential proper part), NTPP (non-tangential proper part) and EQ (equality).In different applications, regions can be modelled in different ways, and connection can be defined accordingly. Typically,regions are regular closed subsets of R2 or R3 and two regions a and b are called connected iff a ∩ b (cid:4)= ∅, although, forinstance, Z2 and Z3 are often of interest as well [29]. Furthermore, due to its generality, the RCC can also be applied incontexts where space is used in a metaphorical way (e.g., [38]). Note that frequently, the RCC is restricted to eight baserelations, which have the property of being jointly exhaustive and pairwise disjoint: DC (disconnected), EC, PO (partially−1. The RCC restricted to (unions of) these eight relations is referred to as RCC-8.overlaps), EQ , TPP, NTPP, TPPWhen using the RCC in applications, it is usually assumed that regions are well-defined entities, e.g., characterizedby precise boundaries. On the other hand, many geographical regions, for instance, are inherently ill-defined. For example,−1 and NTPP* Corresponding author.E-mail addresses: Steven.Schockaert@UGent.be (S. Schockaert), Martine.DeCock@UGent.be (M. De Cock), Etienne.Kerre@UGent.be (E.E. Kerre).1 Postdoctoral Fellow of the Research Foundation – Flanders.0004-3702/$ – see front matter © 2008 Elsevier B.V. All rights reserved.doi:10.1016/j.artint.2008.10.009S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298259Fig. 1. Intuitive meaning of some RCC relations.Fig. 2. Are the regions B, C , and D contained in region A?although political regions, such as countries, states, and provinces, have officially defined—and therefore precise—boundaries,many of the places people refer to in everyday communication (i.e., vernacular places), do not (e.g., [1,2,13,15,33,57,58]).Even the names of political regions are often used in a way that is not in perfect accordance with their official definitions;a typical example are city neighborhoods, whose official boundaries, if they exist, are merely intended for administrativepurposes (e.g., electoral divisions). Vague regions occur at very different scales (Ghent’s city center, the Highlands, theMiddle East), and a variety of techniques can be used to capture their spatial semantics. Approaches based on supervaluationsemantics (e.g., [1,27,57]), for instance, associate a set of possible crisp precisifications with a vague language concept, andreason about assertions that are true in every precisification, in some precisification, etc., typically using first-order logic.They are mainly motivated by philosophical considerations about the nature of vagueness, and tend to be less suitableas workable, computational models. Particularly popular are techniques which represent a vague region as a pair of crispsets (e.g., [2,4,5]). Their main idea is that a vague region can be approximated by defining a set of locations a which aredefinitely in the vague region, as well as a set of locations a which are in the vague region to some extent (where a ⊆ a);the complement of a is then the set of locations which are definitely not in the vague region. The resulting models are veryefficient, and theoretical results (e.g., reasoning procedures) can usually be obtained relatively easily from existing resultsfor crisp regions. Note that vague regions are in this case formally equivalent to ensembles flous [18] of locations. Finally,fuzzy set theory is frequently employed to model vague regions (e.g., [15,19,22,30,31]). In this case, the spatial extent of avague region is modelled by a mapping A from locations (points) to the unit interval [0, 1], such that for any location l,A(l) reflects the degree to which l belongs to the vague region. Although the resulting models may be somewhat lessefficient than models based on pairs of crisp regions, their increased flexibility is often needed to accurately capture vagueboundaries. Moreover, a pair (a, a) of crisp regions with a ⊆ a can be seen as a special case of a fuzzy set, e.g., by assigningall points in a membership degree 1, all points in a \ a membership degree 0.5, and all other points membership degree 0.The existence of vague regions does not, as such, present any difficulties, as the RCC makes no assumptions on therepresentation of regions. However, when some of the regions involved are vague, topological relations can be vague as well.For instance, it is not entirely clear whether the Alps are included in, overlapping with, or disjoint from Southern Europe,as each of these relations seems defensible to some extent. This observation stands in contrast with the assumption thattopological relations are defined in terms of first-order logic and a crisp relation C . Moreover, even if the regions involved arecrisp, it may be desirable to define topological relations as fuzzy relations. In particular, the traditional, strict interpretationof topological relations (e.g., using point-set topology) does not always correspond very well to the way topological relationsare used in natural language. For example, it is commonplace to say that a cabinet is located against a wall even if thereis a gap of a few millimeters between the cabinet and the wall. In traditional frameworks, the cabinet and the wall wouldbe considered disjoint, irrespective of the size of the gap. A more natural solution would be to define topological relationsas fuzzy relations in which the cabinet and the wall are considered adjacent if they are actually touching, or located veryclose to each other. Note that adjacency then becomes a vague concept because it relies on nearness. A similar observationcan be made for containment; consider, for instance, the regions depicted in Fig. 2. Clearly, B is contained in A and D isnot. However, while C is in principle not a part of A, we could intuitively think of C as being a part of A to a large extent,because C is almost contained in A.Our solution is to define C as a fuzzy relation, i.e., for each pair (u, v) of regions, C(u, v) is a degree in [0, 1] reflectingto what extent u and v are connected. Keeping the generality of the RCC, other topological relations are still defined interms of C , using fuzzy logic connectives, however, instead of classical first-order logic. Note that in this way, we make nocommitment at all of why topological relations are vague (e.g., to define relations between vague regions, to model tolerant260S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298natural language relations, etc.). The central aim of this paper is to investigate how this fuzzification of the RCC affectsspatial reasoning. First, Section 2 presents the relevant details of our fuzzification of the RCC. Among others, we illustratehow fuzzy RCC relations can be interpreted in terms of nearness between fuzzy sets. Next, in Section 3, we provide anumber of use cases to further motivate the need for a fuzzy RCC, as well as the need for spatial reasoning in this context.Subsequently, we review some related work in Section 4, discussing shortcomings of existing approaches to handle fuzzytopological information. In Section 5, the main reasoning tasks in the fuzzy RCC are studied: satisfiability and entailmentchecking, calculating the best truth-value bound, and repairing inconsistencies. In Section 6, we show how satisfiability inthe fuzzy RCC can alternatively be decided by reducing it to satisfiability checking in the original RCC. Using this reduction,we establish a close relationship with the Egg–Yolk calculus in Section 7 and we show in Section 8 that satisfiable knowledgebases in the fuzzy RCC can be realized by interpreting regions as fuzzy sets in Rn, for an arbitrary dimension n.2. Fuzzy topological relationsBefore we discuss the problem of fuzzy spatial reasoning, this section familiarizes the reader with some necessary pre-liminaries. First, Section 2.1 recalls some basic concepts from fuzzy set theory and fuzzy relational calculus, which are usedthroughout the paper. Consequently, in Section 2.2, we summarize the most important results related to the fuzzy RCCpresented in [50,51], and we introduce a number of definitions that are used below.2.1. Preliminaries from fuzzy set theoryA fuzzy set [60] in a universe X is a mapping A from X to [0, 1]. For x in X , A(x) typically expresses the degree towhich x exhibits some vague property. If A(x) = 1 for some x in X , the fuzzy set A is called normalised. The support of Ais the set of elements x from X for which A(x) > 0. Similarly, for every α in ]0, 1], the α-level set Aα of A is the (crisp)subset of X defined by(cid:2)Aα =x | x ∈ X and A(x) (cid:2) α(cid:3)The complement of A is the fuzzy set coA in X defined by coA(x) = 1 − A(x) for all x in X . Throughout this paper, wewill mainly be concerned with fuzzy sets in Rn representing vague regions. For p in Rn, A(p) then reflects to what extentpoint p belongs to the vague region. A fuzzy set R in X × X is called a fuzzy relation in X . For x and y in X , R(x, y) isthe degree to which a given vague relationship is satisfied between x and y. A fuzzy relation R in X is called reflexive if−1R(x, x) = 1 for all x in X , and symmetric if R(x, y) = R( y, x) for all x and y in X . The inverse of R is the fuzzy relation Rin X defined by R−1(x, y) = R( y, x) for all x and y in X .As explained in the introduction, to define fuzzy topological relations, we start from a fuzzy relation C in a universe Uof regions, modelling connection. In other words, for u and v in U , C(u, v) reflects the degree in [0, 1] to which regions uand v could be considered connected. In analogy with the RCC, we furthermore require that C is a reflexive and symmetricfuzzy relation. By generalizing logical conjunction and implication to fuzzy logic connectives, and universal and existentialquantification to the infima and suprema of truth degrees, definitions of RCC relations can be generalized to define fuzzytopological relations. Specifically, to generalize logical conjunction, a t-norm is typically used, i.e., an [0, 1]2 − [0, 1] mappingT which is symmetric, associative, increasing and which satisfies the boundary condition T (a, 1) = a for all a in [0, 1]. It canbe shown that such mappings intuitively behave as a conjunction operator. In this paper, we will mostly use the Łukasiewiczt-norm T W , defined for a and b in [0, 1] asT W (a, b) = max(0, a + b − 1)Other popular t-norms are the minimum T M and product T P defined by T M (a, b) = min(a, b) and T P (a, b) = a · b for all aand b in [0, 1]. Usually, only left-continuous or continuous t-norms are considered [25,35]. Accordingly, we let T be a left-continuous t-norm throughout this paper. Next, fuzzy implication is typically defined in terms of the t-norm of interest. Inparticular, the residual implicator I T corresponding to a t-norm T is defined for a and b in [0, 1] as(cid:3)I T (a, b) = sup(cid:2)λ | λ ∈ [0, 1] and T (a, λ) (cid:3) bResidual implicators are known to satisfy many interesting properties, e.g. [56]:I T (a, b) = 1 ⇔ a (cid:3) bfor all a and b in [0, 1].The resulting definitions of the fuzzy RCC relations are presented in Table 1. It can be shown that when C is a crisprelation, i.e., C(u, v) = 1 or C(u, v) = 0 for all u and v in U , the fuzzy topological relations from Table 1 coincide with theoriginal RCC relations [51].Fuzzy logic connectives such as t-norms can also be used to define operations between fuzzy sets. For example, given at-norm T , the degree of inclusion incl( A, B) and the degree of overlap overl( A, B) of two fuzzy sets A and B in a universeX is defined as [11]S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298261Table 1Definition of topological relations in the original RCC and the fuzzy RCC for regions a and b [51].RelationDCPPPEQODRPOECNTPTPPNTPPRCC definition¬C(a, b)(∀c ∈ U )(C(c, a) ⇒ C(c, b))P (a, b) ∧ ¬P (b, a)P (a, b) ∧ P (b, a)(∃c ∈ U )(P (c, a) ∧ P (c, b))¬O (a, b)O (a, b) ∧ ¬P (a, b) ∧ ¬P (b, a)C(a, b) ∧ ¬O (a, b)(∀c ∈ U )(C(c, a) ⇒ O (c, b))PP(a, b) ∧ ¬NTP(a, b)PP(a, b) ∧ NTP(a, b)Fuzzy RCC definition1 − C(a, b)infc∈U I T (C(c, a), C(c, b))min(P (a, b), 1 − P (b, a))min(P (a, b), P (b, a))supc∈U T (P (c, a), P (c, b))1 − O (a, b)min(O (a, b), 1 − P (a, b), 1 − P (b, a))min(C(a, b), 1 − O (a, b))infc∈U I T (C(c, a), O (c, b))min(P P (a, b), 1 − NTP(a, b))min(1 − P (b, a), NTP(a, b))NameDisconnectedPartProper PartEqualsOverlapsDiscretePartially OverlapsExternally ConnectedNon-Tangential PartTangential PPNon-Tangential PPincl( A, B) = infx∈ XI Toverl( A, B) = supx∈ XT(cid:4)(cid:5)A(x), B(x)(cid:4)(cid:5)A(x), B(x)In other words, incl( A, B) is the degree to which every x which belongs to the fuzzy set A also belongs to the fuzzy set B,while overl( A, B) is the degree to which some x belongs to both A and B. Finally, given a fuzzy set A in X and a symmetricfuzzy relation R in X , the upper approximation R↑ A and lower approximation R↓ A of A under R are defined by(R↑ A)(x) = supy∈ X(R↓ A)(x) = infy∈ X(cid:4)(cid:5)R(x, y), A( y)(cid:4)(cid:5)R(x, y), A( y)TI Tfor all x in X . Below, we will use these operators for the specific case where A is a vague region and R models nearnessbetween locations. In this specific case, (R↑ A)(x) is the degree to which x is located close to some point in vague region A,whereas (R↓ A)(x) is the degree to which all points near x are located in A. For notational convenience, we will useexpressions such as R↓↑ A as an abbreviation for R↓(R↑ A). The following two lemmas will be useful in the discussionbelow.Lemma 1. (See [3].) Let R be a symmetric fuzzy relation in X , A a fuzzy set in X and T a left-continuous t-norm. It holds thatR↑↓↑ A = R↑ AR↓↑↓↑ A = R↓↑ A(1)(2)Lemma 2. (See [3].) Let R be a reflexive and symmetric fuzzy relation in X , A a fuzzy set in X and T a left-continuous t-norm. It holdsthatR↓ A ⊆ R↑↓ A ⊆ A ⊆ R↓↑ A ⊆ R↑ A2.2. Fuzzy region connection calculus(3)In [51], the properties of the fuzzy topological relations from Table 1 are examined in detail. Note that, from a theo-retical perspective, C , O , P and NTP are the most important fuzzy topological relations; all the others can be expressed interms of C , O , P and NTP without quantifying over the universe of regions U , using only the minimum and complementoperations. We briefly recall some basic properties that will be of interest below.Lemma 3 (Reflexivity). (See [51].) For all u in U , it holds thatC(u, u) = O (u, u) = P (u, u) = 1Lemma 4 (Symmetry). (See [51].) For all u and v in U , it holds thatC(u, v) = C(v, u)O (u, v) = O (v, u)Lemma 5 (Ordering). (See [51].) For all u and v in U , it holds thatNTP(u, v) (cid:3) P (u, v) (cid:3) O (u, v) (cid:3) C(u, v)262S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298Table 2Transitivity table for the generalized RCC relations (assuming that the t-norm T that is used in the definition of the fuzzy RCC relations satisfies T W (a, b) (cid:2)T (a, b) for all a and b in [0, 1]) [51].C−11coP1C111coNTP1O11−1DCcoP1DCcoP11coP1DCcoP11P−1P−1−1CcoPPO1coPOcoPNTPO1coNTP−1−1−11DC1PcoP11DR1NTPcoNTP1−1coP111coP11111coP11−1coP−1−111coP11111coP111−1−1O1coP1O111coP1O11DRcoNTP1DRcoP11coP1DCcoP11−1−1CDCPPcoPcoPODRNTPNTPcoNTPcoNTP−1−1NTP−1NTP−1−1−1OcoPNTPO1coPOcoPNTPO1coP−11DC1NTPcoP11DC1NTPcoP1−1−1coNTP111coNTP11111coP11−1coNTP−111coNTP11111coP111−1Perhaps the most important properties of the fuzzy topological relations are transitivity properties. Table 2 summarizesthe fuzzy transitivity rules involving C , O , P , NTP, as well as their complements and inverses. The entries in this tableshould be interpreted as follows. Let K be the fuzzy relation on the row corresponding to fuzzy relation R and the columncorresponding to fuzzy relation S; it then holds that [51](cid:4)(cid:5)R(u, v), S(v, w)T W(cid:3) K (u, w)for all u, v and w in U . For example, the entry on the first row, third column should be interpreted as(cid:4)(cid:5)C(u, v), P (v, w)T W(cid:3) C(u, w)which intuitively means that u is connected to w, at least to the degree that for some v, u is connected to v and v is a partof w. We refer to [51] for a detailed discussion on the equivalence between Table 2 and the classical RCC-8 compositiontable in the case that C is a crisp relation. Note that these transitivity rules are only valid if the t-norm T that is usedsatisfies the requirement T W (a, b) (cid:3) T (a, b) for all a and b in [0, 1]. Among others, this is the case for T M , T P and T W .IIIIII, c, b, Pin D such that all formulas in Θ hold, i.e., such that NTPPGiven the fuzzy topological relations from Table 1, the main reasoning task of interest is checking the satisfiability ofa knowledge base such as Θ = {NTPP(a, b) (cid:2) 0.7, P (b, c) (cid:3) 0.4, EC(a, c) (cid:3) 0.5}. An important question here is what exactlywe mean by satisfiability. Clearly, for Θ to be satisfiable, it should be possible to map the variables a, b, c to particularfrom some interpretation domain D, and the relation C to some reflexive and symmetric fuzzy relationobjects aI ) (cid:3) 0.5,I , cI , bC(see below). However, should we impose additional restrictions onwhere NTPPthis interpretation domain D? For instance, we might require that variables be mapped to regions in some fuzzy topologicalspace, or normalised sets in Rn for some n, possibly constrained by additional requirements like upper semi-continuity. Ifwe choose to interpret variables as fuzzy sets in some universe, we may furthermore require that all the α-level sets beregular closed or regular open sets in some related topological space. As we will see below, however, all these definitionsof satisfiability are equivalent. Although suitable restrictions on what objects can constitute a (fuzzy) region are definitelyneeded in applications, we will not impose such restrictions here. Formally, we are interested in the satisfiability of sets offuzzy RCC formulas, defined as follows.are defined in terms of CI ) (cid:3) 0.4 and ECI ) (cid:2) 0.7, Pand ECI , cI (bI (aI (aIIDefinition 1 (Atomic fuzzy RCC formula). An atomic fuzzy RCC formula is a formula of the form R(a, b) (cid:3) λ or R(a, b) (cid:2) λ,where R is either C or one of the fuzzy topological relations from Table 1 (DC, P , . . . , NTPP), λ ∈ [0, 1], and a and b areelements from the universe of regions U .Definition 2 (Fuzzy RCC formula). A fuzzy RCC formula is a formula of the form f 1 ∨ f 2 ∨ · · · ∨ fm, where f i is an atomicfuzzy RCC formula (1 (cid:3) i (cid:3) m).In analogy, we will also refer to expressions such as NTPP(a, b) ∨ ¬PO(b, d) as (crisp) RCC formulas. Note that NTP isusually not considered in the RCC, we introduced it mainly as a shorthand to define and generalize the RCC-8 relationsNTPP and TPP. In contrast to other coarse spatial relations such as P , O and C , for example, NTP does not have an intuitivemeaning other than that of NTPP. In applications, we will typically start from a set Θ of fuzzy RCC formulas which doesnot involve any (disjuncts of) fuzzy RCC formulas of the form NTP(u, v) (cid:2) λ or NTP(u, v) (cid:3) λ at all. Rather, formulas suchas NTPP(u, v) (cid:2) λ or TPP(u, v) (cid:2) λ would occur. This observation leads to the definition of a standard set of fuzzy RCCformulas.Definition 3 (Standard). A set of fuzzy RCC formulas is called standard if it does not contain (a disjunct of) a fuzzy RCCformula of the form NTP(u, v) (cid:2) λ or NTP(u, v) (cid:3) λ (u, v ∈ U and λ ∈ [0, 1]). Similarly, a set of crisp RCC formulas is calledstandard if it does not contain (a disjunct of) an RCC formula of the form NTP(u, v) or ¬NTP(u, v).S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298263Definition 4 (Interpretation). An interpretation I is a mapping from the universe of regions U to some interpretation do-main D, and from C to a reflexive and symmetric fuzzy relation Cin D.ISince all fuzzy topological relations are defined in terms of C , we can extend the interpretation of C to interpretationsof the other fuzzy topological relations; e.g., for all u and v in U , we defineI (cid:5)I (cid:5)(cid:5)I (cid:4)I (cid:5)I (cid:4)I (cid:4)(cid:4)IIIPu, v= infw∈UI TCw, u, Cw, vLet D be the universe of all normalised fuzzy sets in Rn with a bounded support. A particularly interesting interpretationof connection between such fuzzy sets is based on nearness. Specifically, let R(α,β) be the fuzzy relation in Rn defined forall p and q in Rn by (α, β (cid:2) 0)⎧⎨R(α,β)(p, q) =⎩10α+β−d(p,q)βif d(p, q) (cid:3) αif d(p, q) > α + βotherwise (β (cid:4)= 0)(4)where d is the Euclidean distance in Rn. For two points p and q in Rn, as well as suitable values of the parameters α andβ, R(α,β)(p, q) expresses the degree to which p is located near q. Note that if d(p, q) (cid:3) α, p and q are considered perfectlynear, while for d(p, q) > α + β, p and q are considered not near at all. In between there is a gradual, linear transition. Forexample, if d(p, q) = α + β2 , p is considered near q to degree 0.5. Using this concept of nearness between points, we candefine an interpretation in which connection is defined in terms of nearness between vague regions. In particular, let A andB be normalised fuzzy sets in Rn with a bounded support. The degree C(α,β)( A, B) to which A is near B is defined as [50]C(α,β)( A, B) = supp∈RnTA(p), supq∈RnTR(α,β)(p, q), B(q)(cid:9)(cid:4)(cid:5)(cid:10)This is the degree to which some point in A is near some point in B. The reflexivity of C(α,β) follows from the fact thatonly normalised fuzzy sets are considered. Indeed, let m in Rn be such that A(m) = 1, it holds thatC(α,β)( A, B) (cid:2) TA(m), TR(α,β)(m, m), B(m)(cid:4)(cid:4)(cid:5)(cid:5)(cid:4)(cid:5)1, T (1, 1)= T= 1The symmetry of C(α,β) follows from the symmetry of R(α,β), the symmetry and associativity of T and the fact thatsupx∈ X T (x, y) = T (supx∈ X x, y) for every X ⊆ [0, 1] and every y in [0, 1] (since T is a left-continuous t-norm; [56]). Wefind:C(α,β)( A, B) = supp∈Rn= supp∈Rn= supp∈Rn(cid:4)TA(p), supq∈Rn(cid:4)T(cid:4)(cid:4)Tsupq∈RnA(p), T(cid:4)(cid:4)(cid:5)(cid:5)R(α,β)(p, q), B(q)R(α,β)(p, q), B(q)(cid:5)(cid:5)(cid:5)(cid:5)TB(q), TR(α,β)(p, q), A(p)B(q), supp∈RnT(cid:5)(cid:10)R(α,β)(p, q), A(p)(cid:5)(cid:10)(cid:4)(cid:4)B(q), supp∈RnTR(α,β)(q, p), A(p)supq∈Rn(cid:9)= supq∈Rn= supq∈RnTT(cid:9)= C(α,β)(B, A)Furthermore let P (α,β), O (α,β) and NTP(α,β) be defined asP (α,β)( A, B) = incl(R(α,β)↓↑ A, R(α,β)↓↑B)O (α,β)( A, B) = overl(R(α,β)↓↑ A, R(α,β)↓↑B)NTP(α,β)( A, B) = incl(R(α,β)↑ A, R(α,β)↓↑B)for all normalised fuzzy sets A and B with a bounded support. The fuzzy set R(α,β)↓↑ A is called the R(α,β)-closure of A. Itcan be shown that the concept of R-closure, for an arbitrary symmetric fuzzy relation R, bears close similarity to the notionof closure from mathematical topology [3]. Intuitively, in the context of vague regions, using R(α,β)-closures leverages theflexibility of using nearness in the definition of C , to a certain flexibility regarding the (vague) boundaries of regions whenit comes to evaluating other fuzzy topological relations. Thus, for example, A is considered to be a part of B to the extentthat the R(α,β)-closure of A is included in the R(α,β)-closure of B. As a second example, NTP(α,β)( A, B) reflects the degreeto which all points near A occur in the R(α,β)-closure of B. For a more detailed explanation about the intuition behind thesedefinitions, we refer to [50]. For convenience, we will sometimes use expressions such as Rα , Cα and P α to denote the fuzzyrelations R(α,0), C(α,0) and P (α,0) respectively. The following lemma reveals that P (α,β), O (α,β) and NTP(α,β) correspond tointerpretations of fuzzy RCC relations when connection is interpreted in terms of nearness.264S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298Fig. 3. An (1; 10, 0)-interpretation I of fuzzy RCC formulas involving the variables a, b and d, where aI = A, bI = B and dI = D.I = C(α,β), it holds thatLemma 6. (See [50].) If CI = P (α,β)I = O (α,β)OPNTPI = NTP(α,β)We will refer to interpretations of this type as (n; α, β)-interpretations, n being the dimension of the Euclidean spaceunder consideration and (α, β) the parameters used to define nearness.Example 1. An example of an (1; 10, 0)-interpretation I is illustrated in Fig. 3. Assuming T = T W , we find thatI (cid:4)aIC, bI (cid:5)= C(α,β)( A, B) = T W(cid:5)(cid:4)= T W1, T W (1, 1)= 1(cid:4)(cid:4)(cid:5)(cid:5)A(40), T WR(10,0)(40, 50), B(50)Similarly, we have thatI (cid:4)I= CbI (cid:4)aI (cid:5), dCI (cid:5)I, d= 0.25I (aI , dand hence, for example, also DCR(10,0)↓↑D = D, i.e., A, B and D are R(10,0)-closed. This leads toI (cid:4)aOI, bI (cid:5)= overl( A, B) = T W(cid:4)(cid:5)A(50), B(50)= T W (0.5, 1) = 0.5I ) = 0.75. Furthermore, it can be shown that R(10,0)↓↑ A = A, R(10,0)↓↑B = B andand similarlyII (cid:4)aOI (cid:5)I (cid:4)bI, dI (cid:5)= O, d= 0.25We also haveII (cid:4)bP, aI (cid:5)= incl(B, A) = I W(cid:4)(cid:5)B(60), A(60)= I W (1, 0.5) = 0.5andPPI (cid:4)bI (cid:4)aIII (cid:5)I (cid:5), d, b= 0.25I (cid:4)= PaI (cid:5)I (cid:4)dI, aI (cid:5)I (cid:4)dI, bI (cid:5)= P= PI, d= 0Finally, we can show that in this exampleI (cid:4)bI (cid:4)bIINTPNTPI (cid:5)I (cid:5), a, dI (cid:4)bI (cid:4)bII= P= PI (cid:5)I (cid:5), a, d= 0.5= 0.25Note that while the definition of fuzzy topological relations in terms of nearness may be appropriate in some domains(e.g., treatment of vernacular regions in geographic information retrieval), it may be counterintuitive to use these definitionsin other domains. For example, using the definitions above, the fuzzy topological relation O holds (to degree 1) betweentwo regions, as soon as there is one point that belongs to both regions (to degree 1). In Section 7, we will therefore focus onanother type of interpretations, which are based on the Egg–Yolk calculus. In these interpretations, regions are interpreted asfuzzy sets that only take a finite number of membership degrees. As a consequence, regions are completely determined bya finite number of α-level sets. Fuzzy topological relations can then be defined in terms of classical RCC relations betweenthe α-level sets of these regions.S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298265I (aI , bI ) (cid:3) λ (resp. RDefinition 5 (Satisfiability). An interpretation I satisfies an atomic fuzzy RCC formula of the form R(a, b) (cid:3) λ (resp.I ) (cid:2) λ) holds. Furthermore, I satisfies a fuzzy RCC formula f 1 ∨ f 2 ∨ · · · ∨ fmR(a, b) (cid:2) λ) iff Riff it satisfies at least one of the atomic fuzzy RCC formulas f 1, f 2, . . . , fm. Finally, I satisfies a set of fuzzy RCC formulas Θ ,written I |(cid:16) Θ , iff it satisfies every fuzzy RCC formula in Θ . If such an interpretation I satisfying Θ exists, Θ is called satis-fiable (or consistent) and I is called a model of Θ . An (n; α, β)-interpretation which satisfies Θ is called an (n; α, β)-modelof Θ .I , bI (aFor example, let Θ = {P (b, a) (cid:2) 0.5, O (b, d) (cid:2) 0.25, DC(a, d) (cid:2) 0.75}. Intuitively, it might not be immediately clearwhether or not Θ is satisfiable. In the original RCC, for example, {P (b, a), O (b, d), DC(a, d)} is not satisfiable. However, the(1; 10, 0)-interpretation from Example 1 is a (1; 10, 0)-model of Θ , and Θ is therefore satisfiable.Below, we will also talk about interpretations and models of sets of crisp RCC formulas. When there is cause for confu-sion, we will talk about F-satisfiability, F-interpretations and F-models to refer to the concepts introduced above, and aboutC-satisfiability, C-interpretations and C-models to refer to the corresponding concepts for crisp RCC formulas. The standardway to define C-interpretations is to map variables to regular closed subsets in Rn and to interpret C such that two regularclosed subsets A and B are connected iff A ∩ B (cid:4)= ∅. Below we will refer to such C-interpretations as standard interpretations,and denote the corresponding topological relations in Rn by C n, P n, O n, etc. Note that P n corresponds to the subset relation,and O n( A, B) holds iff i( A) ∩ i(B) (cid:4)= ∅, where i( A) and i(B) are the interiors of A and B w.r.t. the Euclidean topology on Rn.While it can be convenient in applications to use fuzzy RCC formulas such as EC(a, b) (cid:2) 0.5, every set Θ of fuzzy RCCformulas can equivalently be written as a set Θ (cid:17)of fuzzy RCC formulas which only involve the fuzzy topological relations C ,P , O and NTP. This observation follows from the fact that every fuzzy topological relation can be expressed in termsof C , P , O and NTP using only the minimum and complement operations. As an example, consider the fuzzy RCC formulaEC(a, b) (cid:2) 0.4 ∨ DC(a, b) (cid:3) 0.3. Using the definitions from Table 1, we findEC(a, b) (cid:2) 0.4 ∨ DC(a, b) (cid:3) 0.3(cid:4)(cid:4)(cid:4)⇔⇔⇔∧(cid:5)C(a, b) (cid:2) 0.4 ∧ 1 − O (a, b) (cid:2) 0.4(cid:5)C(a, b) (cid:2) 0.4 ∧ O (a, b) (cid:3) 0.6(cid:5)C(a, b) (cid:2) 0.4 ∨ C(a, b) (cid:2) 0.7(cid:5)(cid:4)O (a, b) (cid:3) 0.6 ∨ C(a, b) (cid:2) 0.7(cid:4)⇔ C(a, b) (cid:2) 0.4 ∧(cid:5)O (a, b) (cid:3) 0.6 ∨ C(a, b) (cid:2) 0.7∨ 1 − C(a, b) (cid:3) 0.3∨ C(a, b) (cid:2) 0.7Thus, if EC(a, b) (cid:2) 0.4 ∨ DC(a, b) (cid:3) 0.3 occurs in Θ , we could replace it by {C(a, b) (cid:2) 0.4, O (a, b) (cid:3) 0.6 ∨ C(a, b) (cid:2) 0.7}. Forthis reason, the following discussion will predominantly be restricted to sets of fuzzy RCC formulas involving only C , P , Oand NTP.Note that in general, such a set Θ does not completely specify, for every pair of variables, the degree to which each ofthe fuzzy topological relations C , P , O and NTP should hold. For example, consider the set Θ = {C(a, b) (cid:2) 0.5, O (b, a) (cid:3) 0.7},I (aI ) =which is satisfied by an interpretation I if CI ) = 0.6. Formally, we have that every model of, for instance, Θ1 = {C(a, b) (cid:2)I , aO0.6, C(b, a) (cid:3) 0.6, O (a, b) (cid:2) 0.6, O (b, a) (cid:3) 0.6} is also a model of Θ , hence Θ1 could be regarded as a refinement of theinformation in Θ .I ) = 0.6, but also, among others, if CI ) = 0.5 and OI ) = 0.5 or CI ) = OI , bI , bI , bI , aI , aI (bI (bI (bI (aI (aDefinition 6 (Refinement). Let Θ1 and Θ2 be sets of fuzzy RCC formulas. Θ2 is called a refinement of Θ1 iff every modelof Θ2 is also a model of Θ1. If both Θ1 is a refinement of Θ2 and Θ2 is a refinement of Θ1, Θ1 and Θ2 are calledequivalent.A set of fuzzy RCC formulas Θ can always be refined such that the exact degree to which C , O , P and NTP shouldhold between every pair of variables is specified. If Θ is not satisfiable, this is trivial, as every set of fuzzy RCC formulas isthen a refinement of Θ . On the other hand, if Θ is satisfiable, there exists some model I and we can specify a refinementI ),of Θ by adding the formulas C(u, v) (cid:2) CI ), for every pair ofI , vP (u, v) (cid:2) Pvariables (u, v) occurring in Θ .I , vI ) and NTP(u, v) (cid:3) NTPI (uI ), NTP(u, v) (cid:2) NTPI ), C(u, v) (cid:3) CI (uI ), O (u, v) (cid:2) OI ), O (u, v) (cid:3) OI ), P (u, v) (cid:3) PI (uI , vI , vI , vI , vI , vI , vI (uI (uI (uI (uI (uWe will refer to such sets as normalised sets of fuzzy RCC relations.Definition 7 (Normalised). Let Θ be a set of fuzzy RCC formulas, and let V be the subset of regions that are used in theformulas from Θ (V ⊆ U ). Θ is called normalised iff(1) for each fuzzy topological relation R in {C, P , O , NTP} and all regions a and b in V , Θ contains a formula of the formR(a, b) (cid:3) 0 or R(a, b) (cid:2) 1, or both formulas of the form R(a, b) (cid:3) λ and R(a, b) (cid:2) λ for a given λ in ]0, 1[;(2) Θ contains no other formulas.266S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298Fig. 4. Locations in region A (circles) and region B (triangles), and some possible resulting boundaries for A.The first condition in the definition above guarantees that the membership degree of each of the fuzzy topological rela-tions is uniquely determined for each pair of regions in V , while the second condition prevents the inclusion of superfluousadditional information. Clearly, every satisfiable set of fuzzy RCC formulas Θ can be refined to a normalised set. Further-more, Θ is satisfiable iff there exists at least one refinement which is satisfiable.3. Motivating examplesBelow we present a number of motivating examples to illustrate how reasoning about fuzzy topological relations mightbe useful in practice.Use case 1: building quantitative geographical modelsIn addition to qualitative spatial relations, often an abundance of quan-titative information is available as well. Assume, for example, that we want to model the spatial extent of vague geographicregions such as city neighborhoods. From web documents, we may extract the addresses of places in these regions, whichcan subsequently be converted to their geographical coordinates through a process called geocoding. This is illustrated inFig. 4(a), where a number of locations in a vague region A are shown (circles), as well as a number of locations in a vagueregion B (triangles). While, at first glance, the availability of this kind of quantitative information may seem to make anyprocessing of topological spatial information redundant, the opposite is in fact true, i.e., topological information is oftenrequired to convert given quantitative information into reliable geographical models [48]. Given only the quantitative in-formation from Fig. 4(a), what exactly would be a plausible boundary of region A? Knowing that A and B are adjacent,the boundary in Fig. 4(b) would be a good candidate. On the other hand, if A were overlapping with B, the boundary inFig. 4(c) is more likely to be (approximately) correct. Hence, the actual boundaries that result from quantitative informationabout the location of a region depend on its topological relation with other regions. Note that qualitative relations are usedin this case to help build quantitative models, rather than as a surrogate for them.An additional level of difficulty arises when the topological relations between regions are only vaguely defined. Consider,for example, the following statements about the location of the Chiado and Baixa neighborhoods in Lisbon, Portugal:(1) The Elevador de Santa Justa is an impressive steel lift built in 1900 to link the Baixa district to the Chiado.2(2) Shops in the Baixa tend to be pricier than elsewhere, though. Chiado, the adjacent neighborhood, has . . . 3(3) Baixa, or downtown Lisbon, is the heart of the city.4(4) Located in the heart of the historic Chiado quarter, in downtown Lisbon, Chiado Residence . . . 5In the RCC, we can encode the topological information from these statements as2 http://www.telegraph.co.uk/travel/main.jhtml?xml=/travel/2006/03/01/etmykind01.xml, accessed April 13, 2007.3 http://www.thisistravel.co.uk/travel/guides/city.htmlLisbon-what-to-buy_article.html?in_article_id=17537&in_page_id=1, accessed April 20, 2007.4 http://www.golisbon.com/sight-seeing/baixa.html, accessed April 13, 2007.5 http://www.chiadoresidence.com/location.htm, accessed April 13, 2007.S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298DC(Baixa, Chiado)EC(Baixa, Chiado)EQ(downtown Lisbon, Baixa)O (Chiado, downtown Lisbon)267(5)(6)(7)(8)Note that this encoding into the RCC was done manually here. Automating this process is definitely not trivial, but it isoutside the scope of the current discussion. While all four statements are true to some extent, the resulting description inthe RCC is inconsistent. For example, since Baixa and Chiado are located very close to each other, but not actually touching,both the relations DC and EC are intuitively justified to some extent. As can be seen from (5) and (6), natural languagestatements expressing EC(Baixa, Chiado) and DC(Baixa, Chiado) are indeed both found in web documents. Another causefor the inconsistency of (5)–(8) is the fact that downtown Lisbon is a vague region. At least two of the four statements haveto be discarded to make the resulting description in the RCC consistent. As we will see below, when using fuzzy topologicalrelations, none of the four statements has to be fully rejected. We only need to weaken our interpretation by expressingthat some of the topological relations only hold to some extent, e.g.DC(Baixa, Chiado) (cid:2) 0.5EC(Baixa, Chiado) (cid:2) 0.5EQ(downtown Lisbon, Baixa) = 1O (Chiado, downtown Lisbon) (cid:2) 0.5(9)(10)(11)(12)The reasoning tasks we solve below can be used to determine whether such a fuzzy interpretation of the natural languagestatements is satisfiable, whether there are stronger satisfiable fuzzy interpretations possible (i.e., higher lower bounds), etc.Returning to the example from Fig. 4, we may, for example, want to obtain a vague boundary for region A if it is known(or assumed) that EC( A, B) = 0.5 and PO( A, B) = 0.5. An example of such a vague boundary is given in Fig. 4(d), where thedark-gray points are points that belong to A to degree 1 and the light-gray points are points that belong to A to degree 0.5.Use case 2: building qualitative geographical modelsIn some situations, qualitative descriptions are all that is available. Forexample, when the region to be modelled is not a city neighborhood, but a park, forest, cultural heritage site or universitycampus, we will probably not find many addresses contained in it. As a consequence, we cannot rely on geocoding toacquire quantitative information. To illustrate this point, assume we want to acquire a spatial model of Stanley Park inVancouver, B.C., Canada. Such a model may, for instance, be of interest in geographical information retrieval systems andquestion answering systems to help people locate tourist attractions such as the Vancouver Aquarium, Second Beach orCeperley Meadows. Information about the spatial configuration of Stanley Park attractions and landmarks can be obtainedby extracting spatial relations from texts:(1) Second Beach Pool is appropriately located at Second Beach, which is the large waterfront park at the south-westernentrance to Stanley Park . . . You can easily access the pool by walking down along the seawall towards Stanley Park . . . 6(2) English Bay is awesome, and all the beaches around Stanley Park are nice too (I really like Second Beach).7(3) There are two beaches (called Third and Second) right in Stanley Park . . . 8(4) Second Beach is technically in Stanley Park.9(5) An 8.8 kilometre (5.5 mile) seawall path circles the park, which is used . . . 10(6) The seawall in Vancouver, Canada is a stone wall that was constructed around the perimeter of Stanley Park . . . 11The spatial information conveyed in these statements can be translated into RCC formulas and, as before, the resultingdescription is inconsistent. In particular, the first statement suggests that Second Beach is either disconnected from oradjacent to Stanley Park. The second statement seems to indicate that Second Beach is adjacent to Stanley Park, whereasthe third expresses that Second Beach is in fact contained in Stanley Park. Hence, there seems to be some vagueness aboutthe exact boundaries of Stanley Park, i.e., about whether the boundaries encompass Second Beach or not. This is furtherexemplified in the fourth statement which conveys that Second Beach is located in Stanley Park, but, at the same time, notreally considered to be a part of it. Similarly, it is unclear whether the Seawall is adjacent to or contained in Stanley Park,6 http://www.virtualtourist.com/travel/North_America/Canada/Province_of_British_Columbia/Vancouver-903183/Things_To_Do-Vancouver-Second_Beach-BR-1.html,accessed December 18, 2007.7 http://www.nextbody.com/forums/archive/index.php/t-4178.html, accessed December 18, 2007.8 http://www.whyvancouver.com/beaches.html, accessed December 18, 2007.9 http://members.virtualtourist.com/m/tt/8079/, accessed December 18, 2007.10 http://en.wikipedia.org/wiki/Stanley_Park, accessed December 18, 2007.11 http://en.wikipedia.org/wiki/Seawall_%28Vancouver%29, accessed December 18, 2007.268S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298i.e., both TPP and EC hold between the Seawall and Stanley Park to some extent. Again, the fuzzy topological reasoningalgorithms introduced below could be applied to find a satisfiable fuzzy interpretation of the natural language statements.Use case 3: building non-geographical spatial models Spatial reasoning and information processing do not only occur in geog-raphy. For example, a significant fraction of the information in biomedical ontologies is topological [6,52,53]. Along similarlines, spatial relations occur in descriptions of various spatial scenes, e.g., specifications of multimedia documents [32], eyewitness reports of a traffic accident, textual descriptions about the rooms’ arrangement in a house, etc. Usually, spatial re-lations are initially expressed in a crisp way, but vagueness is introduced when descriptions of the same scene, either instructured form (e.g., ontologies) or textual form, from various sources are merged [59]. In this case, fuzzy spatial reasoningcould be used to integrate conflicting spatial descriptions of a given scene. It is important to note here that this processdoes not only apply to the three-dimensional physical scenes found in reality or their two-dimensional abstractions, whichwe have used in our examples so far, but also to conceptual spaces of arbitrary dimension.Conceptual spaces have been developed in [16] as a powerful means to define the semantics of concepts. As opposedto symbolic approaches such as description logics, concepts are given precise definitions as convex regions in a (typically)Euclidean space, whose dimensions correspond to qualities of the objects under consideration. In [17], it is proposed to usethe RCC for reasoning about concept definitions (i.e., regions in the conceptual space of interest). By generalizing this ideato regions with fuzzy boundaries, reasoning in our fuzzy RCC could be used to address challenging problems related to themodelling of vague concepts. Consider, for example, the well-known Wine Ontology.12 In this ontology, many wine-relatedconcepts are defined, e.g., Dry Wine, Table Wine, Late Harvest Wine, etc., as well as relations between these concepts. Whenthinking of concepts as regions in a conceptual space, such relations typically correspond to topological spatial relations.For example, the information that Wine is a subclass of Potable Liquid implies a relation PP between the correspondingregions, whereas the constraint that the properties Dry, Off-Dry and Sweet are mutually exclusive implies DR(Dry, Off-Dry),DR(Dry, Sweet) and DR(Off-Dry, Sweet). Moreover, assuming that some prototypes are available for each concept, the actualregion boundaries could be approximated using techniques from computational geometry such as Voronoi tessellations [17].From these boundaries, relations such as TPP, NTPP and EC could be derived. However, whereas the wine ontology in itselfis consistent, it is well-known that merging it with other wine-related knowledge bases easily leads to inconsistencies [36].For example, many subclass relations are, in fact, not valid for certain particular cases: Port is defined as a subclass of RedWine, while in reality there are some white port wines as well; the Wine Ontology claims that wines are made from at leastone type of grape, which is clearly not the case for apple wine or rice wine; concepts such as Dry Wine are to some extentsubjective, and different ontologies might use slightly different definitions (e.g., based on sugar content only, based on sugarcontent relative to acidity, based on taste, etc.). Using fuzzy topological reasoning, we may obtain consistent interpretationsclaiming that, for example, Apple Wine is a subclass of Wine to degree 0.3, meaning that although apple wine is a specialkind of wine to some extent, it is not a prototypical wine, and that Wine is a subclass of MadeFromGrapes to degree 0.7,meaning that typical wines are made from grapes, but there might be borderline cases which are not.4. Related workReasoning about topological information encoded in RCC-8 has been well studied. Most reasoning tasks of interest areNP-complete [42]. In consequence, and inspired by results about reasoning in the IA (interval algebra), considerable workhas been devoted to finding tractable subfragments of RCC-8, i.e., subsets of the 28 relations that can be expressed in RCC-8for which reasoning is tractable [20,34,40,42]. In [34], it was shown that reasoning in RCC-8 is tractable, provided only baserelations are used (i.e., no disjunctive information such as (TPP ∪ EC)(a, b)). Of special interest are subsets of RCC-8 rela-tions that are maximally tractable, i.e., such that every proper superset of RCC-8 relations would result in NP-completeness.A first maximal tractable subfragment, containing 146 relations, was identified in [42]. Two additional maximal tractablesubfragments were identified in [40], containing 158 and 160 relations. In [40] it was moreover shown that these threesubfragments are the only maximal tractable subfragments of RCC-8 that contain all eight base relations. In all three sub-fragments of RCC-8, satisfiability can be decided using an O (n3) path-consistency algorithm. Experimental results in [43]indicate that using these maximal tractable subfragments for reasoning in RCC-8 has a significant impact on computationtime: almost all problem instances up to 500 regions could be solved in a very efficient way (mostly less than 1 minute ona Sun Ultra 1 machine with 128 MB of internal memory).Usually, a knowledge base of RCC-8 relations is called satisfiable (or consistent) if it can be realized in some topologicalspace, i.e., if all variables can be interpreted by regions in some topological space such that all imposed relations hold [42].In practice, however, it might be interesting to know whether a set of RCC-8 formulas can be realized by (regular closed)subsets of, for example, R2 or Z2 and, if so, which additional constraints on these subsets might be imposed (e.g., convexity,internal connectedness, etc.). In [41], it was shown that any satisfiable set of RCC-8 formulas can be realized in Rn forevery n in N \ {0}. In other words, satisfiability and realizability in Rn are equivalent. For n (cid:2) 3, this result also holds whenregions are constrained to be internally connected, and even if they are constrained to be polytopes. Unfortunately, for n = 2and n = 1 this result does not hold in general. Furthermore, until recently, it was not even known if the problem of checking12 http://www.w3.org/TR/owl-guide/wine.rdf.S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298269the realizability of a knowledge base of RCC-8 relations by internally connected two-dimensional regions is in NP, or evendecidable. In particular, this problem can be related to the problem of recognizing a special class of graphs called stringgraphs [20,26]. In [45], it was shown that recognizing string graphs, and therefore deciding whether an RCC-8 knowledgebase is realizable by internally connected regions in R2, is indeed in NP. Note that checking whether a knowledge base ofRCC-8 relations can be realized by internally connected one-dimensional regions essentially corresponds to an undirectedvariant of the satisfiability problem in the IA, and is therefore in NP. In [28], it was shown that any satisfiable set of RCC-8formulas can also be realized by subsets of Z2 (i.e., the digital plane).Considerable work has been done on generalizing topological relations to cope with vague regions. Most models oftopological relations between vague regions extend either the RCC or the 9-intersection model by treating a vague region aas a pair of two crisp regions a and a such that a ⊆ a. A well-known example is the Egg–Yolk calculus [5], which is based onthe RCC. In [4], a similar approach, based on the notion of a thick boundary, is proposed as an extension of the 9-intersectionmodel. Both models cause a significant increase in the number of possible relations: 46 and 44 relations respectively. Forexample, instead of specifying that two regions a and b overlap, we may specify that a and b overlap (but not a and b), orthat a and b overlap, or that a and b overlap, etc. Another possibility, which is adopted in [44], is to stay with the spatialrelations of the RCC, but to use three-valued relations instead of classical two-valued relations.Other approaches have been concerned with defining (fuzzy) spatial relations between vague regions represented asfuzzy sets. For example, in [61] and [46], generalizations of the 9-intersection model based on α-levels of fuzzy sets aresuggested. In [55], a generalization of the 9-intersection model is introduced using concepts from fuzzy topology, yielding aset of 44 crisp spatial relations. Another generalization of the 9-intersection model, using similar fuzzy topological concepts,is proposed in [31], again obtaining 44 relations between fuzzy sets. On the other hand, [30] uses the RCC as a startingpoint to define crisp spatial relations between fuzzy sets. However, this approach can only be used when the membershipvalues of the fuzzy sets are taken from a finite universe. The total number of relations is dependent on the cardinality ofthe finite set of membership values. In [21] degrees of appropriateness are assigned to RCC relations. These degrees couldbe interpreted as encoding, for instance, preferences or possibilistic uncertainty. In [37], definitions of fuzzy topologicalrelations between vague regions in a discrete space (e.g., fuzzy sets of grid cells) are provided. Finally, [7] and [8] discussfuzzy topological relations with the goal of modelling position uncertainty of region boundaries.All of the aforementioned approaches have in common that certain assumptions are made on how vague regions arerepresented. Moreover, they are mainly applicable to geographical contexts, and can usually not be used in situations where,for example, RCC relations are used in a metaphorical way. The generality and much of the elegance of the RCC is lost inthis way. A different possibility is to generalize the RCC relations directly, without making any assumptions on how regionsshould be represented. This idea has already been pursued, to some extent, in [14], where the starting point was to defineconnection as an arbitrary symmetric fuzzy relation C in the universe U of regions, satisfying a weak reflexivity property,namely C(a, a) > 0.5 for every region a in U . The fuzzy relation P (part of), for example, is defined byP (a, b) = infz∈Umax(cid:5)(cid:4)1 − C(z, a), C(z, b)(13)where a and b are regions in U . However, many properties of the original RCC relations are lost in this approach. Forexample, in correspondence with the reflexivity of P in the RCC, it would be desirable that P (a, a) = 1 for any region ain U . Unfortunately, this is, in general, not the case when (13) is used to define P , due to the particular way in whichlogical implication has been generalized. Similarly, many interesting transitivity properties are also lost, which makes thesefuzzy relations unsuitable for spatial reasoning.Note that the aforementioned approaches for incorporating vagueness in topological relations have largely neglectedissues of reasoning. They are mainly concerned with calculating to what degree a topological relation is fulfilled, given therepresentations of all regions of interest (e.g., as fuzzy sets of locations). Finally, note that some of the results in this paperhave already been summarized in [49].5. Reasoning in the fuzzy RCCTo investigate the main reasoning properties of the fuzzy RCC, we proceed in two steps. First, in Section 5.1, we look atthe satisfiability problem for normalised sets. In other words, we first solve the satisfiability problem for the special casewhere the exact fuzzy spatial relationship between each pair of regions is given. Next, we generalize the satisfiability check-ing procedure to arbitrary (standard) sets of fuzzy RCC formulas, relying heavily on the notion of refinement. In particular,we will start from the observation that a standard set of fuzzy RCC formulas is satisfiable iff it can be refined to a nor-malised set which is satisfiable. Subsequently, the computational complexity of the proposed procedures is investigated inmore detail in Section 5.3. Finally, in Section 5.4, we illustrate how a number of additional reasoning tasks (e.g., entailmentchecking) can be solved in a similar way.5.1. Satisfiability of normalised setsFirst, we show how the satisfiability of a normalised set of fuzzy RCC formulas can be checked. A normalised set of fuzzyRCC formulas is completely characterized by four matrices, containing the membership degrees of the fuzzy topologicalrelations C , P , O and NTP for each pair of regions in V . For example (V = {a, b, c}):270S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298⎛⎜⎜⎝a1bc0.6 0.80.610.6⎞⎟⎟⎠P =a1⎛⎜⎜⎝0.8 0.61cb0.6 0.80.610.40.8 0.41⎞⎟⎟⎠NTP =⎛⎜⎜⎝a10bc0.6 010⎞⎟⎟⎠0.8 0.4 1⎛⎜⎜⎝a00b0.60c00⎞⎟⎟⎠0.4 0.4 0.6abcabc(14)(15)C =O =abcabcThere are a number of necessary conditions for satisfiability that follow straightforwardly from elementary properties of thefuzzy topological relations. For instance, from Lemma 5, we have thatNTP(u, v) (cid:3) P (u, v) (cid:3) O (u, v) (cid:3) C(u, v)(16)for every u and v in V . For normalised sets, (16) translates into restrictions on the corresponding matrix representation. Inparticular, this implies that the elements of the matrix for NTP should be smaller than the corresponding elements of thematrix for P , which should in turn be smaller than the elements of the matrix for O , which should be smaller than theelements of the matrix for C . It is easy to verify that this is indeed the case in the example (14)–(15). From Lemma 4, weknow that for every u and v in VC(u, v) = C(v, u)O (u, v) = O (v, u)(17)(18)In terms of the matrix representation, this means that the matrices for C and O should be symmetric. By Lemma 3, wehave for every u in VP (u, u) = O (u, u) = C(u, u) = 1(19)implying that the elements on the diagonal of the matrices for C , O and P should all be 1. The requirements (16)–(19) caneasily be checked by performing O (|V |2) simple arithmetic comparisons. Clearly, if any of these requirements is violated,the corresponding set of fuzzy RCC formulas is not satisfiable. Finally, a set of additional requirements follows from thetransitivity rules in Table 2. For example, consider the transitivity rule(cid:4)(cid:5)P (u, v), P (v, w)T W(cid:3) P (u, w)(20)generalizing the fact that in the original RCC, P (u, v) and P (v, w) together imply P (u, w). From the matrices above, wefind for u = c, v = a and w = bP (c, a) = 0.8P (a, b) = 0.6P (c, b) = 0.4We obtain T W (P (c, a), P (a, b)) = T W (0.8, 0.6) = 0.4, hence (20) is satisfied. In total, the transitivity table summarizes 144generalized transitivity rules. However, 84 of these rules are trivially satisfied because their right-hand side is 1 (e.g.,T W (C(u, v), O (v, w)) (cid:3) 1). This means that at most 60 transitivity rules need to be checked. Moreover, most of thesetransitivity rules are the dual of another rule. For example, the transitivity table contains both of the following rules(cid:4)(cid:4)T WT W(cid:5)P (u, v), P (v, w)−1(u, v), P(cid:3) P (u, w)(cid:5)−1(v, w)(cid:3) PP−1(u, w)(21)(22)Clearly, if (21) holds for all u, v and w in V , then (22) will be satisfied as well. In consequence, the number of remainingtransitivity rules can almost be halved: only the following 31 rules need to be checked.(cid:5)C(u, v), DC(v, w)(cid:5)(cid:4)C(u, v), P (v, w)(cid:4)T WT W(cid:4)T WT W(cid:4)(cid:5)C(u, v), DR(v, w)(cid:5)C(u, v), NTP(v, w)(cid:5)(cid:4)DC(u, v), P (v, w)(cid:5)−1(v, w)(cid:4)(cid:5)DC(u, v), O (v, w)T W(cid:4)DC(u, v), PT W(cid:5)(cid:4)DC(u, v), NTP(v, w)T WT W(cid:3) coP(u, w)(cid:3) C(u, w)(cid:3) coNTP(u, w)(cid:3) O (u, w)(cid:3) coP−1(u, w)(cid:3) DC(u, w)(cid:3) coP−1(u, w)−1(u, w)(cid:3) coP(23)(24)(25)(26)(27)(28)(29)(30)T WT WT WT W(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)(cid:4)PPT WT W(cid:4)T W(cid:4)T WT W(cid:4)T W(cid:4)P (u, v), coPP (u, v), coNTP(cid:4)DC(u, v), NTPT W−1(u, v), NTP(cid:4)(cid:5)−1(v, w)(cid:5)P (u, v), P (v, w)(cid:5)−1(v, w)(cid:5)P (u, v), DR(v, w)(cid:5)−1(v, w)(cid:5)P (u, v), NTP(v, w)(cid:5)−1(v, w)(cid:5)−1(u, v), NTP(v, w)P(cid:5)−1(u, v), coNTP(v, w)(cid:5)−1(u, v), P (v, w)P(cid:5)−1(u, v), DR(v, w)P(cid:5)−1(u, v), coP(v, w)(cid:5)−1(u, v), O (v, w)P(cid:5)−1(u, v), NTP(v, w)(cid:5)−1(v, w)(cid:5)O (u, v), DR(v, w)(cid:5)O (u, v), NTP(v, w)(cid:5)−1(v, w)(cid:5)(cid:4)DR(u, v), NTP(v, w)T W(cid:5)(cid:4)NTP(u, v), NTP(v, w)(cid:5)−1(v, w)(cid:5)−1(u, v), coNTP(v, w)(cid:5)−1(u, v), NTP(v, w)T W(cid:4)DR(u, v), NTPcoP(u, v), NTPT W(cid:4)T W(cid:4)coP(cid:4)NTP(u, v), coNTP(cid:4)NTP(cid:4)NTPT WT WP(cid:4)(cid:4)(cid:4)T WT WT WT WT WT WS. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298(cid:3) DC(u, w)(cid:3) P (u, w)(cid:3) coP−1(u, w)(cid:3) DR(u, w)(cid:3) coNTP−1(u, w)(cid:3) NTP(u, w)(cid:3) NTP−1(u, w)(cid:3) O (u, w)(cid:3) coNTP(u, w)(cid:3) O (u, w)(cid:3) coP(u, w)(cid:3) coP(u, w)(cid:3) O (u, w)(cid:3) coP−1(u, w)(cid:3) coP(u, w)(cid:3) coP(u, w)(cid:3) O (u, w)(cid:3) DC(u, w)(cid:3) coP−1(u, w)(cid:3) NTP(u, w)(cid:3) coP−1(u, w)(cid:3) coP(u, w)(cid:3) O (u, w)271(31)(32)(33)(34)(35)(36)(37)(38)(39)(40)(41)(42)(43)(44)(45)(46)(47)(48)(49)(50)(51)(52)(53)Each of these transitivity rules has to be checked for all |V |3 triples of variables from Θ . In summary, we have a numberof necessary conditions for satisfiability, which can be checked in O (|V |3) time. As the next proposition reveals, thesenecessary conditions are also sufficient, provided Θ does not contain a fuzzy RCC formula of the form NTP(v, v) (cid:2) 1.Proposition 1. Let Θ be a normalised, finite set of fuzzy RCC formulas, T = T W and let V be the set of variables occurring in Θ(|V | = n). Assume, moreover, that Θ does not contain fuzzy RCC formulas of the form NTP(v, v) (cid:2) 1. If Θ satisfies (16)–(19), as wellas the transitivity rules (23)–(53), for all u, v and w in V , it holds that Θ has an (n; α, 0)-model for every α > 0.Proof. A sketch of the proof is provided in Appendix A. (cid:2)Corollary 1. Under the assumptions of Proposition 1, it holds that Θ is satisfiable iff (16)–(19) and the transitivity rules (23)–(53) aresatisfied for all u, v and w in V .Below, we will extend this result to (n; α, 0)-models (Section 8) for an arbitrary dimension n (rather than one particulardimension), as well as other types of models, including models from the Egg–Yolk calculus (Section 7). From the constructionprocess in Appendix A, it follows furthermore that, if Θ is satisfiable, an (n; α, 0)-model can always be found in which thefuzzy sets satisfy a number of additional, natural requirements. For example, in this construction process, all α-level setsof the fuzzy sets are regular closed regions in the natural topology on Rn. This is important, as it ensures that there areno normalised sets of fuzzy RCC formulas that can only be satisfied in counterintuitive models (e.g., where variables aremapped to points or lines). Thus, we also have that Proposition 1 remains valid if such additional restrictions are imposedon allowed interpretations.The following proposition reveals that the additional constraint from Proposition 1 that formulas of the formNTP(v, v) (cid:2) 1 do not occur, does not have to be considered in satisfiability checking procedures, provided only standardsets are allowed. In other words, to check the satisfiability of a standard set of fuzzy RCC formulas Θ , we only need tocheck whether the necessary conditions we identified above are satisfied in at least one refinement of Θ .272S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298Proposition 2. Let Θ0 be a standard, finite set of fuzzy RCC formulas and let T = T W . If Θ0 can be refined to a normalised set of fuzzyRCC formulas Θ1 which satisfies (16)–(19), as well as the transitivity rules (23)–(53), it holds that Θ0 has an (n; α, 0)-model for everyα > 0.Proof. The proof is presented in Appendix B. (cid:2)Corollary 2. Let T = T W . It holds that a standard, finite set of fuzzy RCC formulas Θ is satisfiable iff it can be refined to a normalisedset Θ (cid:17)which does not violate the transitivity rules (23)–(53) nor the requirements (16)–(19).5.2. Satisfiability of standard sets. Clearly, Θ (cid:17)is equivalent to Θ , hence every refinement of Θ (cid:17)Let Θ be a standard set of fuzzy RCC formulas involving variables from a set V = {v 1, . . . , vn}. As explained above, wecan rewrite the fuzzy RCC formulas in Θ such that only disjunctions of fuzzy RCC formulas involving C , P , O , and NTPoccur, thus obtaining a set Θ (cid:17)is also a refinement of Θ . Notethat although Θ (cid:17)is not a standard set of fuzzy RCC formulas, we can still apply Proposition 2 and Corollary 2, because Θ (cid:17)is equivalent to a standard set.To decide whether Θ (cid:17), and therefore Θ , is satisfiable, we need to find membership degrees for C(v i, v j), P (v i, v j),O (v i, v j), and NTP(v i, v j), for each pair of regions (v i, v j) in V 2, such that the transitivity rules and the requirements (16)–(19) are satisfied, as well as the inequalities imposed by the fuzzy RCC formulas in Θ (cid:17); or show that no such membershipdegrees exist. As we will show next, these requirements on the membership degrees can be formulated as a system of(disjunctions of) linear inequalities Σ , where both the number of variables and the number of inequalities is polynomial inthe size of Θ . This means that the satisfiability of Θ (cid:17)can be decided using a linear programming solver and backtracking(if Θ (cid:17)i j , xOi j , xPbe variables, corresponding to the values of C(v i, v j),P (v i, v j), O (v i, v j), and NTP(v i, v j) respectively. For every variable xRi j (where R is C , P , O or NTP), we add to Σ theconstraintcontains disjunctions). In the following, let xCi j and xNTPi j0 (cid:3) xRi j(cid:3) 1This ensures that every solution of Σ can be interpreted as a normalised set of fuzzy RCC formulas Θ Σ , containing theformulasR(v i, v j) (cid:2) xRi jR(v i, v j) (cid:3) xRi jassuming for simplicity xRi jinvolving these variables. For example, if Θ (cid:17)the following constraint to Σ∈ ]0, 1[. Next, the fuzzy RCC formulas in Θ (cid:17)can all be written as disjunctions of linear inequalitiescontains the fuzzy RCC formula NTP(v 1, v 2) (cid:2) 0.4 ∨ O (v 3, v 4) (cid:3) 0.7, we addxNTP12(cid:2) 0.4 ∨ xO34(cid:3) 0.7This ensures that if Σ has a solution, Θ Σ is a refinement of Θ (cid:17)corresponding to (16)–(19):xNTPi j(cid:3) xPi j(cid:3) xOi j(cid:3) xCi jxCi j= xCjixOi j= xOjixPii(cid:2) 1. To ensure that Θ Σ is satisfiable, we add linear inequalitiesFinally, to guarantee that solutions of Σ do not violate the transitivity rules, we add an additional inequality for each of the31 transitivity rules identified above and each triplet (v i, v j, vk) in V 3. For example, because of the first of these transitivityrules, we know that(cid:4)(cid:5)C(v i, v j), DC(v j, vk)T W(cid:3) coP(v i, vk)which is equivalent to(cid:4)(cid:5)C(v i, v j) + 1 − C(v j, vk) − 1 (cid:3) 1 − P (v i, vk)(cid:5)(cid:4)0 (cid:3) 1 − P (v i, vk)∧or(cid:4)(cid:5)C(v i, v j) − C(v j, vk) (cid:3) 1 − P (v i, vk)(cid:4)(cid:5)P (v i, vk) (cid:3) 1∧Hence, we add the following inequality to ΣxCi j− xCjk(cid:3) 1 − xPikNote that xPik(cid:3) 1 is already in Σ and does, therefore, not have to be considered here anymore.Thus we have constructed a system Σ of disjunctions of linear inequalities such that, if Σ has a solution, the corre-sponding normalised set of fuzzy RCC formulas Θ Σ satisfies the assumptions from Proposition 2, implying that Θ and Θ (cid:17)are satisfiable. If Σ does not contain any disjunctions, deciding whether Σ has a solution can be done in polynomial timeS. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298273using a linear programming solver [24] (assuming that the number of bits required to represent each of the lower andupper bounds in Θ is bounded by a constant). For example, let Θ (cid:17)be defined as(cid:2)(cid:17) =ΘC(b, c) (cid:2) 0.6, P (c, a) (cid:2) 0.8, O (a, c) (cid:2) 0.4,(cid:3)O (b, a) (cid:3) 0.6, O (b, c) (cid:3) 0.5, NTP(a, b) (cid:2) 0.6, NTP(c, c) (cid:2) 0.6(54)Solving the corresponding system of linear inequalities Σ using the lp_solve13 linear programming solver yields the con-sistent, normalised set of fuzzy RCC formulas defined by (14)–(15). If Θ (cid:17)contains disjunctions, we can use a backtrackingalgorithm to determine whether any choice of the disjuncts leads to a system of linear inequalities that has a solution.5.3. Computational complexityThe construction above entails that the problem of checking the satisfiability of a set of fuzzy RCC formulas is in NP.We show that this problem is also NP-hard. Note that by restricting the fuzzy relations Cα , O α , P α and NTPα to crispsubsets of Rn, crisp spatial relations are obtained. The next lemma reveals that these crisp spatial relations correspond tointerpretations of the RCC.Lemma 7. Let I be defined such that for every u in U , uthatIis a crisp, non-empty, bounded subset of Rn for some n in N \ {0}. It holdsP αO αI (cid:5)I (cid:5)(cid:4)Iu(cid:4), vIu(cid:4), vINTPαu, v(cid:4)≡ (∀w ∈ U )≡ (∃w ∈ U )I (cid:5)P α(cid:4)≡ (∀w ∈ U )Cα(cid:4)(cid:4)(cid:4)w(cid:4)I (cid:5)I (cid:5)I, uIw(cid:4), uICαw, uIwIw(cid:4)⇒ Cα(cid:4)∧ P αI (cid:5)⇒ O, v, vIw, vI (cid:5)(cid:5)I (cid:5)(cid:5)I (cid:5)(cid:5)Proof. From Lemma 6 we know that(cid:4)(cid:4)I (cid:5)I (cid:5)P α(cid:4)u(cid:4)O αI, v, vIu(cid:4)NTPαuI, vI T= infw∈U= supw∈UI (cid:5)= infw∈UT(cid:4)CαwI (cid:5)I, u, CαI (cid:5), u(cid:4)Iw(cid:4)P α(cid:4), P αI (cid:5)I (cid:5)(cid:5)I (cid:5)(cid:5)(cid:4)(cid:4)Iw, v, vIw(cid:4)I TCαwI, u, O αwI (cid:5)(cid:5)I, vIare crisp sets, by assumption, for example, also Cα(wI , uI ) and Cα(wI , vI ) take crisp values.IISince uTherefore, we have thatand w, v(cid:4)(cid:4)infw∈UI TCαwI, uI (cid:5)(cid:4)Iw, vI (cid:5)(cid:5)= 1, Cαholds iff(∀w ∈ U )(cid:4)(cid:4)CαwIand infw∈U I T (Cα(wthe same manner. (cid:2)I (cid:5)(cid:4)II (cid:5)(cid:5)⇒ Cα, uI ), Cα(wI , v, vwI )) = 0 otherwise. The expressions for O α(uI , uI , vI ) and NTPα(uI , vI ) follow in entirelyIt follows from Proposition 2 that every standard, C-satisfiable set Θ of RCC formulas can be interpreted by an (n; α, 0)-model. Indeed, crisp RCC formulas such as NTPP(v 1, v 2) ∨ ¬EC(v 1, v 3) can be interpreted as fuzzy RCC formulas with upperand lower bounds in {0, 1}, i.e., NTPP(v 1, v 2) (cid:2) 1 ∨ EC(v 1, v 3) (cid:3) 0. Moreover, since all upper and lower bounds come from{0, 1}, it follows from the construction process in the proof of Proposition 1 that the fuzzy RCC formulas can be interpretedby crisp sets. This leads to the following corollary.Corollary 3. Every finite, standard, C-satisfiable set of RCC formulas can be interpreted by an (n; α, 0)-model in which every variableis interpreted as a crisp, non-empty, bounded subset of Rn.Note that, from [41] we know that every C-satisfiable set of RCC formulas can be interpreted by a standard RCC modelin any dimension. Thus, we also have the following corollary.Corollary 4. Let Θ be a set of RCC formulas. If Θ has an (n; α, 0)-model, Θ also has a standard model in Rm for every m in N \ {0}.13 http://sourceforge.net/projects/lpsolve.274S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298In particular, we have that checking the C-satisfiability of a set of RCC formulas can be reduced to checking the F-satisfiability of a set of fuzzy RCC formulas. Since the former problem is known to be NP-hard [42], we thus find that alsothe latter problem is NP-hard. Hence, we have the following proposition.Proposition 3. Checking the F-satisfiability of a set of fuzzy RCC formulas is NP-complete (T = T W ).Note that the F-satisfiability problem for fuzzy RCC formulas is in the same complexity class as the C-satisfiability prob-lem in RCC-8. Furthermore, note that notwithstanding this NP-hardness result, reasoning about fuzzy topological relationsis often tractable in practice. In particular, if a knowledge base Θ can be written in terms of fuzzy RCC formulas involvingonly C , P , O and NTP, such that no disjunctions occur, the procedure outlined in Section 5.2 only takes polynomial time.5.4. Other reasoning tasksBesides satisfiability checking, also other interesting reasoning tasks, such as entailment checking, finding the best truth-value bound, and inconsistency repairing, can be cast into systems of linear inequalities.5.4.1. EntailmentDefinition 8. Let Θ be a set of fuzzy RCC formulas and γ a fuzzy RCC formula; Θ is said to entail γ , written Θ |(cid:16) γ , if γis satisfied in every model of Θ .Without loss of generality, we can assume that Θ only contains (disjunctions of) formulas involving C , O , P and NTP.Furthermore, note thatΘ ∪ { f 1 ∨ f 2 ∨ · · · ∨ fm} |(cid:16) γ ⇔(cid:4)Θ ∪ { f 1} |(cid:16) γ(cid:5)∧ · · · ∧(cid:4)Θ ∪ { fm} |(cid:16) γ(cid:5)(55)As a consequence, it is sufficient to show how Θ |(cid:16) γ can be checked for the case where Θ does not contain any disjunc-tions. In other words, we can assume that all formulas in Θ are of the form R(u, v) (cid:2) λ or R(u, v) (cid:3) λ where R can be C ,O , P or NTP. Let Σ furthermore be the corresponding system of linear inequalities, having a solution iff Θ is satisfiable.We can now extend Σ to a system of linear inequalities Σγ such that Σγ does not have a solution iff Θ |(cid:16) γ . First assumethat γ does not contain disjunctions, e.g., γ ≡ P (u, v) (cid:2) 0.7. Clearly, it holds that Θ |(cid:16) γ iff Θ ∪ {¬γ } is not satisfiable, i.e.,iff Θγ = Θ ∪ {P (v i, v j) < 0.7} is not satisfiable. If v i or v j do not occur in Θ , then Θγ is satisfiable iff Θ is satisfiable, i.e.,we can take Σγ = Σ . Typically, v i and v j will already occur in Θ however. In that case, we can takeΣγ = Σ ∪(cid:2)(cid:3)xPi j < 0.7As before, we can show that Σγ has a solution iff Θγ is satisfiable. Note that we do not have to add additional inequalitiescorresponding to (16)–(19) and the transitivity rules, since these are already contained in Σ (as v i and v j occur in Θ aswell).Note that Σγ contains a strict inequality, and can therefore not directly be solved using a linear programming solver.However, we can equivalently write Σγ as Σ (cid:17)(cid:4)= 0.7}. In [23], techniques for solving systems of linear(cid:3) 0.7, xPγi j(cid:3) 0.7} does not have a solution, then neitherinequalities with additional disequalities are introduced. Clearly, if Σ ∪ {xPi jhas Σ (cid:17)γ has a solution, we can makeuse of the fact that linear programming solvers can find the solution of a system of linear inequalities which minimizesor maximizes a given objective function. In particular, we can thus find the minimal and maximal values of the objectivefunction xPγ does not have a solution iff both this minimaland maximal value is 0.7.(cid:3) 0.7} does have a solution. To find whether also Σ (cid:17)i j , given the system of inequalities Σ ∪ {xPγ . Therefore, assume that Σ ∪ {xP(cid:3) 0.7}. It holds that Σ (cid:17)= Σ ∪ {xPi ji ji jExample 2. As an example, consider again the set Θ (cid:17)γ ≡ C(a, c) (cid:2) 0.9. We have(cid:2)(cid:17)Σγ= Σ ∪xCac(cid:3) 0.9, xCac(cid:3)(cid:4)= 0.9from (54), and suppose we want to check whether Θ (cid:17) |(cid:16) γ forwhere xCconstraints in Σ ∪ {xCachave that Σ (cid:17)ac is the variable in Σ corresponding to the value of C(a, c). Maximizing the objective function xC= 0.9, whereas we obtain xCac= 0.8 when minimizing xCγ has a solution, and therefore, that Θ (cid:17) (cid:4)|(cid:16) C(a, c) (cid:2) 0.9. For γ ≡ C(a, c) (cid:2) 0.8, we obtain(cid:3) 0.9}, we obtain xCacac subject to theac . Since 0.8 (cid:4)= 0.9, we(cid:2)(cid:17)Σγ= Σ ∪xCac(cid:3) 0.8, xCac(cid:3)(cid:4)= 0.8Both when minimizing xCa solution, and Θ (cid:17) |(cid:16) C(a, c) (cid:2) 0.8.ac and maximizing xCac , subject to Σ ∪ {xCac(cid:3) 0.8}, we obtain xCac= 0.8. Therefore Σ (cid:17)γ does not haveS. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298275If γ is the disjunction of more than one atomic fuzzy RCC formula, we can proceed in a similar way. For example, letγ ≡ NTP(v 1, v 2) (cid:3) 0.7 ∨ P (v 3, v 4) (cid:2) 0.5 ∨ O (v 1, v 4) (cid:2) 0.9. For each disjunct, we now have to add a strict inequality to Σ ,corresponding to its negation. We obtainΣγ = Σ ∪12 > 0.7, xPxNTP34 < 0.5, xO(cid:3)14 < 0.9(cid:2)(cid:2)or, using disequalities(cid:17)ΣγTo solve, Σ (cid:17)= Σ ∪xNTP12(cid:2) 0.7, xP34(cid:3) 0.5, xO14(cid:3) 0.9, xNTP12(cid:4)= 0.7, xP34(cid:4)= 0.5, xO14(cid:3)(cid:4)= 0.9γ , we can apply the following lemma.Lemma 8. Let Σ be a system of linear inequalities, and let {γ1, . . . , γk} be a set of linear disequalities. It holds that Σ ∪ {γ1, . . . , γk}has a solution iff Σ ∪ {γ1}, Σ ∪ {γ2}, . . . , Σ ∪ {γk} all have a solution.Proof. This lemma follows straightforwardly from Lemma 17 in [23]. (cid:2)5.4.2. Best truth-value boundThe notion of the best truth value bound was originally introduced in [54] in the context of fuzzy description logics. Hereit consists of finding the strongest possible lower and upper bound for the values of C(a, b), P (a, b), O (a, b), or NTP(a, b),given that a set Θ of fuzzy RCC formulas is satisfied. Formally, we want to find the values of lubR (a, b; Θ) and glbR (a, b; Θ)for R either C , P , O , or NTP:Definition 9. Let R be one of the fuzzy topological relations C , P , O , or NTP. Moreover, let Θ be a set of fuzzy RCC formulas.For regions a and b, lubR (a, b; Θ) and glbR (a, b; Θ) are defined as(cid:2)(cid:3)lubR (a, b; Θ) = infglbR (a, b; Θ) = supλ | λ ∈ [0, 1] ∧ Θ |(cid:16) R(a, b) (cid:3) λ(cid:2)λ | λ ∈ [0, 1] ∧ Θ |(cid:16) R(a, b) (cid:2) λ(cid:3)Finding the best truth-value bounds can be done very analogously to entailment checking. Let Θ be a set of fuzzy RCCformulas. Moreover, let V , Θ and Σ be defined as before, i.e., Σ is a system of linear inequalities which has a solution iffΘ is consistent and V is the set of variables occurring in Θ . If a /∈ V or b /∈ V , we immediately find that lubC (a, b; Θ) = 1,as the possible values of C(a, b) are not constrained by the formulas in Θ . Therefore, assume that a, b ∈ V . A linear pro-gramming solver can be used to find a solution of Σ that maximizes C(a, b). This maximal value of C(a, b) is equal tolubC (a, b; Θ). In the same way, the solution of Σ which minimizes C(a, b) yields the value of glbC (a, b; Θ). For R equalto P , O , or NTP, the values of lubR (a, b; Θ) and glbR (a, b; Θ) can be found in entirely the same way.defined by (54), we obtain that lubC (a, c; Θ (cid:17)) = 0.9 and glbC (a, c; Θ (cid:17)) = 0.8.For example, again considering the set Θ (cid:17)This means that for any model I of Θ (cid:17), it holds thatI (cid:4)aCI, cI (cid:5)∈ [0.8, 0.9]5.4.3. Inconsistency repairingIn real-world applications, available topological information is often inconsistent. For example, although none of thefour assertions (5)–(8) is clearly wrong, the resulting set is inconsistent because some assertions are only partially true. Toremedy such inconsistencies, we weaken the interpretation of the available topological information. For example, (5)–(8)could be interpreted asDC(Baixa, Chiado) (cid:2) λ1EC(Baixa, Chiado) (cid:2) λ2EQ(downtown Lisbon, Baixa) (cid:2) λ3O (Chiado, downtown Lisbon) (cid:2) λ4(56)(57)(58)(59)where λ1, λ2, λ3, λ4 ∈ [0, 1]. Usually, we want the interpretation to be as strong as possible, i.e., we want to chooseλ1, λ2, λ3, and λ4 such that increasing one of these values leads to inconsistency (i.e., Pareto optimality). This can againbe formulated as a linear programming problem. First, we rewrite (56)–(59) as a set Θ (cid:17)of fuzzy RCC formulas containingonly (disjunctions of) atomic fuzzy RCC formulas involving C , P , O , or NTP:C(Baixa, Chiado) (cid:3) 1 − λ1C(Baixa, Chiado) (cid:2) λ2O (Baixa, Chiado) (cid:3) 1 − λ2(60)(61)(62)276S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298P (downtown Lisbon, Baixa) (cid:2) λ3P (Baixa, downtown Lisbon) (cid:2) λ3O (Chiado, downtown Lisbon) (cid:2) λ4(63)(64)(65)We now consider the corresponding system of inequalities Σ . As before, each solution of Σ corresponds to a model of(56)–(59). Unlike before, however, the membership degrees λ1, λ2, λ3 and λ4 are additional variables, rather than constants.By specifying λ1 + λ2 + λ3 + λ4 as the objective function (to be maximized), we obtain an interpretation that cannotbe strengthened without introducing inconsistencies. Using lp_solve, we find λ1 = λ2 = λ3 = 0.5 and λ4 = 1. If a prioriinformation is available about the reliability of each of the statements, this idea can be further extended by using weightsin the objective function. For example, if the first and last statement are assumed to be somewhat less reliable, 0.5λ1 +0.8λ2 + 0.8λ3 + 0.5λ4 could be used as the objective function, yielding λ1 = λ2 = λ4 = 0.5 and λ3 = 1.Another possibility is to first establish the minimal degree to which all statements can be satisfied. In this case, we firstconsider the fuzzy RCC formulasDC(Baixa, Chiado) (cid:2) λEC(Baixa, Chiado) (cid:2) λEQ(downtown Lisbon, Baixa) (cid:2) λO (Chiado, downtown Lisbon) (cid:2) λ(66)(67)(68)(69)In solving the corresponding system of linear inequalities Σ , we can now look for a solution that maximizes λ. This maximalvalue of λ is given by λ = 0.5. Next, within the set of solutions that satisfy Σ with λ = 0.5, we can try to find the best one,according to some application-dependent criterium. Note that this way of working is very similar to how fuzzy constraintsatisfaction problems are solved [9]. In general, there are a large number of alternative strategies that may be pursued todefine such optimal solutions; see, for example, Section 2.3 of [10]. For instance, assuming that the last two statements aremore reliable (or more important) than the former two, we may be interested to find solutions that maximize λ(cid:17)in thesystem of linear inequalities defined byDC(Baixa, Chiado) (cid:2) 0.5EC(Baixa, Chiado) (cid:2) 0.5EQ(downtown Lisbon, Baixa) (cid:2) 0.5O (Chiado, downtown Lisbon) (cid:2) 0.5EQ(downtown Lisbon, Baixa) (cid:2) λO (Chiado, downtown Lisbon) (cid:2) λ(cid:17)(cid:17)where the first four fuzzy RCC formulas correspond to (66)–(69), with λ instantiated by its optimal value 0.5. The maximalvalue of λ(cid:17)for which these fuzzy RCC formulas are satisfiable is given by λ(cid:17) = 0.75, which can again be found using a linearprogramming solver. Thus we obtain a solution in which the first two statements are true to degree 0.5 and the last twostatements are true to degree 0.75. It is easy to verify (using a linear programming solver) that this solution can not bestrengthened anymore without introducing inconsistency.6. Reduction to the RCCIn the remainder of this paper, we provide a number of additional, important properties of our approach to fuzzytopological reasoning. We start by demonstrating how reasoning in the fuzzy RCC can be reduced to reasoning in theoriginal RCC. On one hand, this allows to use optimized RCC reasoners for reasoning in the fuzzy RCC, adopting for examplethe heuristic strategies introduced in [43]. On the other hand, this reduction is particularly useful to leverage theoreticalproperties of the RCC to corresponding properties of the fuzzy RCC. Illustrating this point, we reveal a relationship betweenour framework and the Egg–Yolk calculus in Section 7. Finally, in Section 8 we use this relationship with the RCC to provethat any standard, satisfiable set Θ of fuzzy RCC formulas can be interpreted using fuzzy sets and nearness in any dimension,thus generalizing the observation from Proposition 2 that Θ can be realized in one particular dimension n. In particular,this implies that we can always find models in two-dimensional and three-dimensional Euclidean space.The cornerstone in the reduction to the RCC is the observation that a satisfiable set of fuzzy RCC formulas can alwaysρ for a certain ρ inbe satisfied by models taking only finitely different membership degrees. Let Δ ∈ ]0, 1[ such that Δ = 1N \ {0}. Furthermore let MΔ and M Δbe defined as2MΔ = {0, Δ, 2Δ, . . . , 1 − Δ, 1}(cid:18)(cid:17)=0,M Δ2Δ2, Δ, . . . , 1 − Δ2, 1S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298277Henceforth, we will always assume that all the upper and lower bounds in the set of fuzzy RCC formulas Θ are takenfrom MΔ. While being a theoretical restriction, this has no practical consequences as computers only deal with finiteprecision anyway. Below, we state that if Θ is satisfiable, it has an (n; α, 0)-model in which only membership degreesfrom M Δ2are used.Proposition 4. Let T = T W and let Θ be a standard, satisfiable set of fuzzy RCC formulas whose upper and lower bounds are all in MΔ.Furthermore, let V be the set of variables occurring in Θ and |V | = n. There exists a model of Θ mapping every variable v occurringin Θ to a normalised, bounded fuzzy set in Rn which only takes membership degrees from M Δ.2Proof. The proof is presented in Appendix C. (cid:2)Note that from the construction process in the proof of Proposition 1, we know that when Θ is a normalised set inwhich all bounds are taken from MΔ, Θ has a model in which all membership degrees are taken from MΔ, which is astronger result than what is expressed in the proposition above. From Proposition 4, we have that an arbitrary set of fuzzyRCC formulas Θ can be refined to a normalised set in which all bounds come from M Δ, which implies that a model can be2found in which all membership degrees are taken from M Δ2. Whether or not a model can always be found involving onlymembership degrees from MΔ is currently still an open problem.As Proposition 5 below shows, when the fuzzy topological relations Cα , O α , P α and NTPα are applied to fuzzy setswhich only take membership degrees from a finite set, their value can be found by checking whether a finite number ofcrisp spatial relations are satisfied.Proposition 5. Let A and B be normalised, bounded fuzzy sets in Rn which only take membership degrees from M Δ\ {0} and let λ(cid:17)M Δ2be in M Δ2\ {1}. It holds that (α > 0)142222Cα( A, B) (cid:2) λ ⇔ Cα( A1, Bλ) ∨ Cα( A1− Δ, Bλ+ Δ(cid:17) ⇔ DCα( A1, Bλ(cid:17)+ Δ) ∧ DCα( A1− ΔCα( A, B) (cid:3) λO α( A, B) (cid:2) λ ⇔ O α( A1, Bλ) ∨ O α( A1− Δ, Bλ+ Δ) ∧ DRα( A1− ΔO α( A, B) (cid:3) λP α( A, B) (cid:2) λ ⇔ P α( A1, Bλ) ∧ P α( A1− Δ, Bλ− Δ(cid:17) ⇔ ¬P α( A1, Bλ(cid:17)+ ΔP α( A, B) (cid:3) λ) ∨ ¬P α( A1− ΔNTPα( A, B) (cid:2) λ ⇔ NTPPα( A1, Bλ) ∧ NTPPα( A1− ΔNTPα( A, B) (cid:3) λ(cid:17) ⇔ DRα( A1, Bλ(cid:17)+ Δ(cid:17) ⇔ ¬NTPPα( A1, Bλ(cid:17)+ Δ222222222) ∨ · · · ∨ Cα( Aλ, B1), Bλ(cid:17)+Δ) ∧ · · · ∧ DCα( Aλ(cid:17)+ Δ) ∨ · · · ∨ O α( Aλ, B1), Bλ(cid:17)+Δ) ∧ · · · ∧ DRα( Aλ(cid:17)+ Δ2) ∧ · · · ∧ P α( A1−λ+ Δ), Bλ(cid:17) ) ∨ · · · ∨ ¬P α( A1−λ(cid:17) , B Δ, B Δ22, B1), B1))2, Bλ− Δ) ∨ ¬NTPPα( A1− Δ2222) ∧ · · · ∧ NTPPα( A1−λ+ Δ, Bλ(cid:17) ) ∨ · · · ∨ ¬NTPPα( A1−λ(cid:17) , B Δ, B Δ2)2)2Proof. The proof is given in Appendix D. (cid:2)Recall from Lemma 7 that Cα , O α , P α and NTPα can be used to define C-interpretations of RCC formulas. This observationsuggests how we can reason about fuzzy RCC formulas by translating them first to crisp RCC formulas, thereby applyingProposition 5. In particular, we can relate the regions from the crisp RCC formulas to α-level sets of the regions from thefuzzy RCC formulas. Let Θ be a standard set of fuzzy RCC formulas, and let V be the set of variables (regions) occurringin Θ . We construct a set of RCC formulas Γ over the set of variables V, vΔ,. . . , v 1. In particular, we add the following RCC formulas to Γ , for each v in V, containing for each v in V , the variables v Δ2(cid:17)(cid:2)P (v Δ2, vΔ), P (vΔ, vΔ+ Δ2), . . . , P (v 1− Δ2(cid:3), v 1)This ensures that we can always associate F–interpretations of Θ with C-interpretations of Γ and vice versa. In particular,given a C-interpretation I(cid:17)(cid:17)to a non-empty, bounded region in Rn, we can define anF-interpretation I of Θ asof Γ which maps every v in V(cid:19)Iv(p) =max{λ | λ ∈ M Δ2\ {0} ∧ p ∈ vI(cid:17)λ}0if p ∈ vI(cid:17)Δ2otherwise(79)14 Note that an expression such as Cα ( A1, Bλ) denotes a value in {0, 1}. Slightly abusing notation, we therefore use Cα ( A1, Bλ) as a shorthand forCα ( A1, Bλ) = 1, thus identifying 0 and 1 with the classical notions of false and true.2, let λ be in(70)(71)(72)(73)(74)(75)(76)(77)(78)278S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–2982for all v in V and p in Rn. Conversely, we can define a C-interpretation I(cid:17)maps every variable to a normalised, bounded fuzzy set in Rn taking only membership degrees from M Δof Γ , given an F-interpretation I of Θ which:I(cid:17)λ(cid:2)q | q ∈ Rn ∧ vI(cid:3)≡ p ∈p ∈ v(80)for λ ∈ M Δ\ {0}. In addition to (78), we also add (sets of) RCC formulas to Γ corresponding with each of the fuzzyRCC formulas in Θ . For example, if Θ contains the fuzzy RCC formula EC(a, b) (cid:2) 0.5 ∨ P (c, d) (cid:3) 0, being equivalent to(C(a, b) (cid:2) 0.5 ∧ O (a, b) (cid:3) 0.5) ∨ P (c, d) (cid:3) 0, we obtain the following expression by Proposition 5 (assuming Δ = 0.5)(q) (cid:2) λ2(cid:4)(cid:4)(cid:5)C(a1, b0.5) ∨ C(a0.75, b0.75) ∨ C(a0.5, b1)∨ ¬P (c1, d0.25) ∨ ¬P (c0.75, d0.5) ∨ ¬P (c0.5, d0.75) ∨ ¬P (c0.25, d1)(cid:5)∧ ¬O (a1, b0.75) ∧ ¬O (a0.75, b1)which corresponds to the following set of RCC formulas(cid:2)C(a1, b0.5) ∨ C(a0.75, b0.75) ∨ C(a0.5, b1) ∨ ¬P (c1, d0.25) ∨ ¬P (c0.75, d0.5) ∨ ¬P (c0.5, d0.75) ∨ ¬P (c0.25, d1),¬O (a1, b0.75) ∨ ¬P (c1, d0.25) ∨ ¬P (c0.75, d0.5) ∨ ¬P (c0.5, d0.75) ∨ ¬P (c0.25, d1),(cid:3)¬O (a0.75, b1) ∨ ¬P (c1, d0.25) ∨ ¬P (c0.75, d0.5) ∨ ¬P (c0.5, d0.75) ∨ ¬P (c0.25, d1)If I(cid:17)is a C-model of Γ and I is the F–interpretation of Θ defined by (79), we know from Proposition 5 that I will be anF-model of Θ , and vice versa, if I is an F-model of Θ , we know that the C-interpretation I(cid:17)of Γ , defined by (80), will bea C-model of Γ . Note that if Θ is F-satisfiable, there always exists an F-model of Θ which maps variables to normalised,bounded fuzzy sets in Rn (Proposition 2), and if Γ is C-satisfiable, there always exists a C-model of Γ which maps variablesto non-empty, bounded sets in Rn [41]. We thus have the following corollary of Proposition 5.Corollary 5. Let Θ be a standard set of fuzzy RCC formulas whose upper and lower bounds are all in MΔ, and let Γ be the corre-sponding set of (crisp) RCC formulas, obtained through the construction process outlined above. It holds that Θ is F-satisfiable iff Γ isC-satisfiable.7. Relationship with the Egg–Yolk calculusUntil now, we have mainly considered interpretations of fuzzy topological relations in terms of fuzzy sets and nearness,i.e., (n; α, β)-interpretations. On the other hand, as our generalization of the RCC is not explicitly tied to this type ofinterpretations, it seems that it should also encompass other models of vague topological information. In this section, wedemonstrate that this is indeed the case by revealing a relationship between our approach and the Egg–Yolk calculus, thelatter being neither based on nearness nor on fuzzy sets.In the most generalform of the Egg–Yolk calculus, a vague region A is represented as k nested (crisp) sets( A1, A2, . . . , Ak), where A1 contains the points that definitely belong to the vague region, and co( Ak) contains the pointsthat definitely do not ( A1 ⊆ A2 ⊆ · · · ⊆ Ak). In other words, the sets A1, A2, A3, . . . , Ak are increasingly more tolerant bound-aries for the vague region. Without loss of generality, we can assume that Ai is a non-empty, bounded, regular closed subsetof Rn, for some n in N \ {0}. Note that typically k = 2, in which case A1 is called the yolk and A2 is called the white ofvague region A. We will refer to k nested sets that represent a vague region, as an Egg–Yolk region. Egg–Yolk relations, i.e.,topological relations between two Egg–Yolk regions A and B, are defined by expressing which are the possible RCC relationsthat may hold between the corresponding nested sets ( A1, A2, . . . , Ak) and (B1, B2, . . . , Bk). For example, to express that Ais a part of B, we may require(cid:5)(cid:4)(cid:4)(cid:4)(cid:5)(cid:5)PA1, B1∧ PA2, B2∧ · · · ∧ PAk, Bkor, adopting a stricter interpretation, that P ( Ak, B1). On the other hand, we may also define fuzzy topological relationsbetween Egg–Yolk regions, imposing, for instance, that A and B are connected to degree 1 if A1 and B1 are connected, andto some lower degree if A1 and B1 are not connected but Ai and B j are connected for some i and j in {1, 2, . . . , k}.The k nested sets ( A1, A2, . . . , Ak) can naturally be regarded as the α-level sets of a fuzzy set A, i.e., A1 = A1, A2 = A k−1,. Thus, given an (n; α, 0)-interpretation I0 of a set of fuzzy RCC formulas Θ taking only membership degrees, we can straightforwardly construct a new interpretation I in which each variable v is interpreted as an Egg–YolkI = (v 1, . . . , vk), where. . . , Ak = A 1from M 1kregion vkk(cid:4)(cid:5)v i =I0vk−i+1kI (cid:4)IMoreover, if we define CI (cid:4)(cid:4)u1, . . . , uk(cid:17)k + 1 − ik= max= CI (cid:5), vuCIsuch that (assuming max ∅ = 0)(cid:4)(cid:5)(cid:5)v 1, . . . , vk(cid:5),(cid:20)(cid:20)(cid:20) i ∈ {1, . . . , k} ∧(cid:4)(cid:4)Cαu1, v i(cid:5)∨ Cα(cid:4)u2, v i−1(cid:5)∨ · · · ∨ Cα(cid:18)(cid:5)(cid:5)(cid:4)ui, v 1(81)(82)(83)S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298it holds by Proposition 5 that for all regions u and vI (cid:4)I (cid:5)(cid:5)(cid:4)II0CI0 , vuI0= Cu, v279(84)CI0 ) = Cα(uIndeed, since uI0 , vI0 (uelement λ from M 1k(cid:4)(cid:4)(cid:4)I0 and vI0 , vI0 are, by assumption, fuzzy sets taking only membership degrees from M 1I0 , vI0 ) ∈ M 1. Assuming CI0 , vI0 ) > 0, this means that the value of CI0 ) (cid:2) λ holds, or equivalently by Proposition 5, such that(cid:4)(cid:4)I0 , vI0 (uI0 (u(cid:4)(cid:4)(cid:5)(cid:5)(cid:5)kksuch that C(cid:4)(cid:4)(cid:5)(cid:5)I0(cid:5)1,CαuI0v∨ CαλI0,v(cid:5)λ+ 1k∨ · · · ∨ CαI0u(cid:5)λ,I0v1I0 (u(cid:5)1− 1kI0u, we know thatI0 ) is the largestfor some i in {1, . . . , k}. Thus we find that CI0 (uI0 , vI0 ) = k−i+1k where i is the smallestk, it holds that λ = k−i+1For λ ∈ M 1element in {1, . . . , k} satisfying(cid:5)1,∨ CαCαI0I0(cid:4)(cid:4)uv(cid:5)(cid:5)(cid:4)kk−i+1k(cid:4)(cid:4)I0u(cid:5)1− 1k(cid:5)(cid:4),I0vk−i+2k(cid:5)∨ · · · ∨ Cα(cid:4)(cid:4)(cid:5)I0u(cid:4)I0v(cid:5)(cid:5)1,k−i+1kI0 (uI0 , vI0 ) = k−i+1k, where i is the smallest value in {1, . . . , k} suchBy the correspondence (82), we therefore have that Cthat(cid:4)(cid:5)(cid:4)Cαu1, v i∨ Cα(cid:5)(cid:4)(cid:5)∨ · · · ∨ Cαui, v 1I0 , vin other words (84). If Cand we therefore find (84) again.u2, v i−1I0 (uI0 ) = 0, then DCα(u1, v i), DCα(u2, v i−1), . . . , DCα(ui, v 1) will hold for all i in {1, . . . , k},Note that (84) entails that I0 is an F-model of Θ iff I is an F-model of Θ , and, moreover, that(cid:4)u(cid:4)I0 , vI0 , vu(cid:4)I0I0PI0ONTP(cid:5)I0(cid:5)I0II (cid:4)uI (cid:4)u= P= O(cid:5)I (cid:5)I (cid:5), vI, vI (cid:4)uI (cid:5)I, vI0 , vuI0= NTPI, we thus obtain from Proposition 5 that (assuming max ∅ = 0)Following a similar line of reasoning as for CI (cid:4)(cid:4)I (cid:4)(cid:4)I(cid:5)(cid:5)(cid:5),PuI (cid:5), v(cid:17)= maxI (cid:4)IOuI (cid:5), v(cid:17)= maxI (cid:4)NTPuI, v(cid:17)= max(cid:4)(cid:4)v 1, . . . , vku1, . . . , uk(cid:20)(cid:20)(cid:20) i ∈ {1, . . . , k} ∧ P α(cid:5),= Pk + 1 − ikI (cid:4)(cid:4)= Ou1, . . . , uk(cid:20)k + 1 − i(cid:20)(cid:20) i ∈ {1, . . . , k} ∧k(cid:5)I (cid:4)(cid:4)= NTP,(cid:20)(cid:20)(cid:20) i ∈ {1, . . . , k} ∧ NTPPαv 1, . . . , vk(cid:4)u1, . . . , ukk + 1 − ikI (cid:5)O α(cid:4)(cid:4)u1, v i(cid:5)(cid:5)v 1, . . . , vk(cid:4)(cid:5)(cid:4)∧ P αu2, v i+1(cid:5)∧ · · · ∧ P α(cid:4)uk+1−i, vk(cid:18)(cid:5)u1, v i(cid:5)u2, v i−1∨ · · · ∨ O α(cid:18)(cid:5)(cid:5)(cid:4)ui, v 1(cid:4)(cid:5)∨ O α(cid:5)(cid:5)(cid:5)∧ · · · ∧ NTPPα(cid:18)(cid:5)(cid:4)uk+1−i, vku1, v iAlthough I maps variables to Egg–Yolk regions, the fuzzy topological relations between them are still defined using near-ness, in contrast to typical Egg–Yolk interpretations, where spatial relations are defined in terms of standard RCC relationssuch as C n, O n, P n and NTPn. Recall, for example, that for A and B two subsets of Rn, C n( A, B) ≡ A ∩ B (cid:4)= ∅.Definition 10. Let Θ be a set of fuzzy RCC formulas and let V be the set of regions used. An F-interpretation I of Θ iscalled an Egg–Yolk interpretation of Θ w.r.t. (k, n) if it maps every v in V to an Egg–Yolk region, and C is interpreted forEgg–Yolk regions (u1, . . . , uk) and (v 1, . . . , vk) by (k, n ∈ N \ {0}, max ∅ = 0):(cid:5)(cid:5)v 1, . . . , vkI (cid:4)(cid:4)Cu1, . . . , uk(cid:17)(cid:4)(cid:5),k + 1 − ik= max(cid:20)(cid:20)(cid:20) i ∈ {1, . . . , k} ∧(cid:4)(cid:4)C nu1, v i(cid:5)∨ C n(cid:4)u2, v i−1(cid:5)∨ · · · ∨ C n(cid:18)(cid:5)(cid:5)(cid:4)ui, v 1(85)An Egg–Yolk interpretation which is also a model of Θ is called an Egg–Yolk model of Θ .Let I be defined as in (83). If I is an F-model of a standard set of fuzzy RCC formulas Θ , then Θ must also have an Egg–Yolk model I(cid:17). Indeed, identifying Egg–Yolk regions with their corresponding fuzzy sets, we can use the construction processfrom Corollary 5 to obtain a set of RCC formulas Γ which is C-satisfiable iff Θ is F-satisfiable. The variables occurring in Γcorrespond to the different nested sets of the Egg–Yolk regions (or equivalently, to the α-level sets of the correspondingfuzzy sets), and I naturally corresponds to an (n; α, 0)-model of Γ . Specifically, the variables occurring in Γ are mapped280S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298to the crisp regions u1, u2, . . . , uk, where (u1, . . . , uk) is the Egg–Yolk region corresponding to the interpretation of region uI = (u1, . . . , uk). From Corollary 4, we know that Γ must also have a standard model. In this standard model,under I, i.e., uthe variables from Γ are mapped to crisp regions, which can again be interpreted as the nested sets of Egg–Yolk regions.(cid:17) k), i.e., the variable from Γ which wasSpecifically, this leads to an Egg–Yolk interpretation I(cid:17)where uinitially mapped to crisp region ui is in the new interpretation mapped to another crisp region umoreover(cid:17) j) ≡ Cα(ui, v j) for all regions u and v occurring in Θ andcorresponds to a standard model of Γ , we have that C n(uall i and j in {1, 2, . . . , k}. In other words, interpreting connection as in (85), I(cid:17)corresponds to an Egg–Yolk model of Θ .Together with Proposition 4, this leads to the following proposition.(cid:17) i . Because I(cid:17)(cid:17) 1, . . . , uI(cid:17) = (u(cid:17) i, vProposition 6. Let Θ be an F-satisfiable standard set of fuzzy RCC formulas in which all upper and lower bounds are taken from{0, 2k , . . . , 1} for some k ∈ N \ {0} (T = T W ). It holds that Θ has an Egg–Yolk model w.r.t. (k, n) for every n in N \ {0}.k , 4Note that because of the construction process above, it holds that(cid:4)CαP αO αui, v j(cid:4)ui, v j(cid:4)ui, v j(cid:4)(cid:5)(cid:5)(cid:5)(cid:5)(cid:5)(cid:4)(cid:17) j(cid:17) ju(cid:4)u(cid:4)(cid:17) i, v(cid:17) i, v(cid:17) i, v(cid:4)u≡ C n≡ P n≡ O n(cid:5)NTPαui, v j≡ NTPnu(cid:5)(cid:17) j(cid:5)(cid:17) i, v(cid:17) jfor all variables u and v occurring in Θ , and all i and j in {1, 2, . . . , k}. Since, moreover, Cregions u and v, it holds that (max ∅ = 0)I (uI , vI ) = CI(cid:17)I(cid:17)(u, vI(cid:17)) for allI(cid:17) (cid:4)(cid:4)uP(cid:4)(cid:17) k(cid:17) 1, . . . , u(cid:17)(cid:5),k + 1 − ik(cid:17) 1, . . . , uk(cid:17)(cid:5),k + 1 − ik(cid:17) 1, . . . , uu(cid:17)k + 1 − ik(cid:17) k= maxI(cid:17) (cid:4)(cid:4)uO= maxI(cid:17) (cid:4)(cid:4)NTP= max(cid:4)(cid:5)(cid:5)(cid:17) k(cid:17) 1, . . . , vv(cid:20)(cid:20)(cid:20) i ∈ {1, . . . , k} ∧ P n(cid:4)(cid:17) 1, vu(cid:17) i(cid:5)(cid:4)∧ P n(cid:17) 2, vu(cid:17) i+1(cid:5)∧ · · · ∧ P n(cid:4)(cid:17) k+1−i, vu(cid:17) k(cid:18)(cid:5)(cid:5)(cid:5)(cid:17) k(cid:17) 1, . . . , v(cid:4)(cid:4)O nv(cid:20)(cid:20)(cid:20) i ∈ {1, . . . , k} ∧(cid:5)(cid:5)(cid:4)(cid:5),(cid:20)(cid:20)(cid:20) i ∈ {1, . . . , k} ∧ NTPPn(cid:17) 1, . . . , v(cid:17) kvu(cid:5)(cid:17) 1, v(cid:17) i∨ O n(cid:4)(cid:17) 2, vu(cid:17) i−1(cid:5)∨ · · · ∨ O n(cid:18)(cid:5)(cid:5)(cid:4)(cid:17) i, vu(cid:17) 1(cid:4)(cid:17) 1, vu(cid:17) i(cid:5)∧ · · · ∧ NTPPn(cid:4)(cid:17) k+1−i, vu(cid:17) k(cid:18)(cid:5)I(cid:17)I(cid:17)I(cid:17)I(cid:17)I(cid:17), v) = iI(cid:17)(u, v) = 1 corresponds to the notion of containment between Egg–Yolk regions expressed in (81). ForNote that Pi < k, P(uk corresponds to a more flexible notion of containment. In other words, a fuzzy topological relation Rcorresponds to a list of Egg–Yolk relations (R1, R2, . . . , Rk), where R i(u, v) corresponds to R(u, v) (cid:2) k+1−i. For example, ifk = 2, O (u, v) = 1 means that the yolk of u overlaps with the yolk of v, while O (u, v) (cid:2) 0.5 means that either the yolkof u overlaps with the white of v, or the white of u overlaps with the yolk of v. Similarly, P (u, v) = 1 means that the yolkof u is contained in the yolk of v, and the white of u is contained in the white of v, whereas P (u, v) (cid:2) 0.5 means that theyolk of u is contained in the white of v. We conclude this section with an example illustrating the relationship between(n; α, 0)-interpretations and Egg–Yolk interpretations.kExample 3. Let Θ be the normalised set of fuzzy RCC formulas, defined by the following four matrices:(cid:21) a1b(cid:22)0.750.751(cid:21) a1b(cid:22)0.50.51C =abO =ab(cid:21) a1(cid:22)b00.5 1(cid:21) a1(cid:22)b00.25 1ababP =NTP =This set Θ is satisfied by the (1; 20, 0)-interpretation I which maps the variables a and b to the fuzzy sets A and BI = B. Since Θ is normalised and contains only upper and lower bounds fromin R from Fig. 5(a), i.e., aM0.25 = {0, 0.25, 0.5, 0.75, 1}, there also exists an (n; α, 0)-model which only uses membership degrees from M0.25. Such amodel is shown in Fig. 5(b) for n = 1 and α = 20. Furthermore, this model is closely related to a model I(cid:17)in which regionsare interpreted as Egg–Yolk regions and Cis given by (83):I = A and bI(cid:17)S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298281Fig. 5. An (n; α, 0)-model can naturally be linked to an Egg–Yolk model.I(cid:17) =aI(cid:17) =b(cid:4)[5, 30], [5, 40], [5, 100], [5, 120](cid:4)[60, 90], [60, 90], [60, 90], [60, 90](cid:5)(cid:5)Note that under interpretation I(cid:17), for example, [5, 40] and [60, 90] are connected, because d(40, 60) = |60 − 40| (cid:3) 20. Inother words, because connection is interpreted in terms of nearness, the intervals need not actually have a point in commonto be connected.Finally, it is also possible to construct an Egg–Yolk model I(cid:17)(cid:17)in which C is interpreted as in (85); for exampleI(cid:17)(cid:17) =aI(cid:17)(cid:17) =b(cid:4)[100, 120], [90, 130], [60, 140], [50, 150](cid:4)[60, 90], [60, 90], [60, 90], [60, 90](cid:5)(cid:5)As Egg–Yolk models are not interpreted in terms of nearness, two intervals need to have a point in common to be connected,e.g., [60, 90] and [90, 130]. Note that Proposition 6 guarantees the existence of an Egg–Yolk model in any dimension. InFig. 5(c), for instance, a model is depicted in R2.282S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–2988. Realizability in any dimensionFrom the previous discussion, we already know that standard, satisfiable sets of fuzzy RCC formulas Θ have an Egg–Yolkmodel in any dimension (provided the upper and lower bounds are finitely representable), and an (n; α, 0)-model in at leastone particular dimension n. In this section, we prove that an (m; α, 0)-model of Θ can be found in any dimension m aswell. Specifically, we show that an (1; α, 0)-model can always be found, and, subsequently, that this (1; α, 0)-model can beconverted into an (m; α, 0)-model for any m in N \ {0}.Proposition 7. Let Θ be an F-satisfiable standard set of fuzzy RCC formulas whose upper and lower bounds are finitely representable.It holds that Θ has an (1; α, 0)-model for some α > 0.Proof. The proof is presented in Appendix E. (cid:2)Note that the (1; α, 0)-model I(cid:17)bership degrees from M 1kconstructed in the proof above maps every variable v to a fuzzy set taking only mem-. This fuzzy set is characterized by the k corresponding α-level sets which are all the union of afinite number of closed, non-degenerate intervals. In particular, let the ik -level set of the fuzzy set vI(cid:17)be given by(cid:23)−i1, v+i1v(cid:24)(cid:23)∪−i2, v+i2v(cid:24)(cid:23)∪(cid:24)v−ini, v+iniv−+(cid:26)(cid:25)We now define a new interpretation I(cid:17)(cid:17)whose ik -level set is given by(cid:25)−i2α(cid:17)i1α(cid:17)i1α(cid:17)ααα−α(cid:17)iniαNote that for p and q in R, it holds that d( pα(cid:17)α , qα(cid:17)). Hence, as I(cid:17)) implies Cα(cid:17) (uCα(utherefore have the following corollary.i2α(cid:17)α, v, vI(cid:17)(cid:17)I(cid:17)(cid:17)∪∪I(cid:17)I(cid:17)(cid:26)(cid:25)+vvvv,,in which v is mapped to the fuzzy set taking only membership degrees from M 1k,(cid:26),v+α(cid:17)iniαα ) = | pα(cid:17)| = α(cid:17)αis an (1; α, 0)-model of Θ , it holds that I(cid:17)(cid:17)|p − q| = α(cid:17)− qα(cid:17)ααα d(p, q). Therefore, for all regions u and v,is an (1; α(cid:17), 0)-model of Θ . WeCorollary 6. Let Θ be an F-satisfiable standard set of fuzzy RCC formulas whose upper and lower bounds are finitely representable. Itholds that Θ has an (1; α, 0)-model for every α > 0.Intuitively, it seems obvious that when a set of fuzzy RCC formulas can be realized in one dimension, it can be realized inall higher dimensions as well. The next proposition reveals that this is indeed the case. The key observation is that the roleof closed, non-degenerate intervals in R can be generalized by m-dimensional hypercubes. In particular, given an interval[a, b] (a < b), we define the associated hypercube as the hypercube with center ( a+b2 , 0, 0, . . . , 0) whose edges have lengthb − a and are all parallel to one of the axes. As an example, the hypercubes H and G corresponding to the intervals [80, 120]and [80, 200] are depicted in Fig. 6 for m = 3.Proposition 8. Let Θ be an F-satisfiable standard set of fuzzy RCC formulas whose upper and lower bounds are finitely representable.It holds that Θ has an (m; α, 0)-model for every α > 0 and every m in N \ {0}.Proof. The proof is presented in Appendix F. (cid:2)Let Θ be a finite, standard set of fuzzy RCC formulas whose upper and lower bounds are finitely representable. We haveestablished that the following statements are all equivalent (Γ being the set of crisp RCC formulas from Corollary 5).(1) Θ is F-satisfiable;(2) Γ is C-satisfiable;(3) Θ can be refined to a normalised set of fuzzy RCC formulas satisfying (16)–(19), as well as the transitivity rules forfuzzy topological relations;(4) Θ has an Egg–Yolk model in at least one dimension;(5) Θ has an Egg–Yolk model in any dimension;(6) Θ has an (m; α, 0)-model for at least one α > 0 and one m in N \ {0};(7) Θ has an (m; α, 0)-model for any α > 0 and any m in N \ {0}.9. ConclusionsIn this paper, we have discussed reasoning tasks in a fuzzy region connection calculus. One of our most importantresults is that satisfiability checking in this fuzzy RCC essentially corresponds to verifying that no transitivity, reflexivityS. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298283Fig. 6. Hypercubes H and G corresponding to the intervals [80, 120] and [80, 200].and symmetry rules are violated (Proposition 2). We furthermore proved that any satisfiable knowledge base of fuzzy RCCrelations can be realized by interpreting regions as fuzzy sets in Rn, for an arbitrary n in N \ {0}, and by interpretingconnection in terms of nearness. For practical reasoning, we showed how satisfiability checking can be reduced to solvingsystems of linear inequalities and backtracking. Each system of linear inequalities can be solved in polynomial time using alinear programming solver, leading to an overall NP-complete time complexity. Related reasoning tasks such as entailmentchecking and inconsistency repairing can moreover be solved in a similar way. Thus we find that adding vagueness doesnot alter the computational complexity of topological reasoning. Next, we proved how reasoning in the fuzzy RCC can bereduced to reasoning in the original RCC. The cornerstone in this reduction was the observation that an interpretation isguaranteed to exist which only involves fuzzy sets taking a finite number of different membership degrees (Proposition 4).By this reduction, important theoretical results from the RCC can be leveraged to our fuzzy RCC. As an important example,it allowed us to show the aforementioned result of realizability in any dimension n. The reduction to the RCC furthermoreallowed us to establish a close relationship with the Egg–Yolk calculus for topological reasoning under vagueness. Amongothers, this led to an alternative interpretation of connection as a fuzzy relation, supporting our claim of generality.Appendix A. Proof of Proposition 1 (sketch)Here we only provide a sketch; the complete details of the proof can be found in [47]. In the following, we assume α > 0and α0 > 0, where α0 is a sufficiently large constant (α (cid:20) α0). Moreover, let Θ be a normalised set of RCC formulas overa set of variables V satisfying requirements (16)–(19) and the transitivity rules for fuzzy topological relations. For everyI , aI , aI ) are then identical in anyI ), Ppair of variables (a, b) in V 2, the values of Cmodel I of Θ . Below, we will refer to these values as λCab, λOab . In other words, we assume that for every (a, b)in V 2, Θ contains the fuzzy RCC formulasI ), OI (aab and λNTPI (aab, λPI ) and NTPI , aI , aI (aI (aC(a, b) (cid:2) λCabO (a, b) (cid:2) λOabC(a, b) (cid:3) λCabO (a, b) (cid:3) λOabP (a, b) (cid:2) λPabNTP(a, b) (cid:2) λNTPabP (a, b) (cid:3) λPabNTP(a, b) (cid:3) λNTPabwhere, by assumption, λNTPbounded fuzzy sets in Rn such thataa < 1 for every a in V . We will prove that there exists a mapping ffrom V to normalised,CαO α(cid:4)P α(cid:4)(cid:5)f (a), f (b)(cid:4)= λCab(cid:5)= λOf (a), f (b)ab(cid:5)= λPf (a), f (b)ab(cid:5)(cid:4)= λNTPf (a), f (b)abNTPα(A.1)(A.2)(A.3)(A.4)for all (a, b) in V 2, in other words, that f defines an (n; α, 0)-interpretation which satisfies Θ . In particular, we choosen = |V |, i.e., the dimension of the Euclidean space is the same as the number of different variables in Θ . Furthermore, wecan always define a total ordering on the elements of V ; we write V = {v 1, v 2, . . . , vn}. For the ease of presentation, we284S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298i j instead of λCwill write λC, etc. Rather than constructing the function f at once, we first constructa function f C from V to the class of fuzzy sets in Rn, satisfying (A.1) but not necessarily (A.2)–(A.4). Subsequently, we willdefine a function f O satisfying (A.1) and (A.2), but not necessarily (A.3) and (A.4), etc.instead of λO, λOi jv i v jv i v jFor each point a in Rn, we let P a and La be the fuzzy sets in Rn defined as(cid:27)P a(p) =La(p) =(cid:27)1 if R(a, p) (cid:2) α00 otherwise1 if R(a, p) (cid:2) α0 otherwisefor all p in Rn. Note that P a and La are n-dimensional spheres in Rn with center a and radius α0 and α respectively.Moreover, for λ in [0, 1], we let Lλ(cid:4)a be the fuzzy sets in Rn defined asa and P λLλa (p) = TP λa (p) = T(cid:5)λ, La(p)(cid:5)(cid:4)λ, P a(p)for all p in Rn. Let ρ be a sufficiently large, positive real number (α0 (cid:20) ρ) and let f I be the function from V to normalised,bounded fuzzy sets in Rn, defined for each v i in V byf I (v i) = P aiis the point in Rn whose coordinates are all 0, except for the ith coordinate which is ρ. For example,where aif I (v 1) = (ρ, 0, 0, . . . , 0). Note that in this way, an n-dimensional sphere with radius α0 is considered. As ρ is sufficientlylarge, each sphere f I (v i) is far apart from all the other spheres f I (v j) with j (cid:4)= i. To achieve the required degree of con-nectedness, the regions corresponding to variables v i and v j should be connected to degree λCi j (see (A.1)). We thereforeenlarge region f I (v i) by adding fuzzy sets in Rn that are sufficiently close to the centers of f I (v j) with j (cid:4)= i. Specifically,from f I , we define the function f C for each v i in V and p in Rn asf C (v i)(p) = max(cid:9)f I (v i)(p), max1(cid:2) j(cid:2)nj(cid:4)=i(cid:4)T(cid:5)(cid:10)λCi j, Lbi j (p)(A.5)−−→a jaiwhere bi j = a j + (2α + α0)a jai (cid:22) . The construction of the points ai and bi j for the case n = 3 is depicted in Fig. A.1. In(cid:22)−−→particular, bi j is on the line from ai to a j at a distance of 2α + α0 from a j . Hence, the sphere Lbi j with radius α has a centerthat is relatively close to a j . We can show that [47](cid:5)f C (v i), f C (v j)(cid:4)Cα= λCi jfor all v i and v j in V .Fig. A.1. Construction of the points ai and bi j (1 (cid:2) i, j (cid:2) 3, i (cid:4)= j).S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298285Fig. A.2. Construction of the points ai , bi j and ci j (1 (cid:2) i, j (cid:2) 3, i (cid:4)= j).Next, we define a function f O satisfying both (A.1) and (A.2) in a similar way. Specifically, for each v i in V and p in Rn,we definef O (v i)(p) = max(cid:9)f C (v i)(p), max1(cid:2) j(cid:2)nj(cid:4)=i(cid:4)T(cid:5)(cid:10)λOi j , Lci j (p)(A.6)where ci j = a j + (α0 + α)that [47]−−→a jaia jai (cid:22) . The construction of the points ci j for the case n = 3 is depicted in Fig. A.2. We can show(cid:22)−−→(cid:4)(cid:5)f O (v i), f O (v j)(cid:4)= λCi j(cid:5)= λOf O (v i), f O (v j)i jCαO αfor all v i and v j in V .We define the function f P for each v i in V and p in Rn asf P (v i)(p) = nmaxl=1T(cid:4)(cid:5)li , f O (vl)(p)λP(A.7)In other words, the points of the fuzzy set f O (vl) are added to the new interpretation f P (v i) of v i to a given extent whichli , i.e., the degree to which vl should be a part of v i . Note that f P (v i) ⊇ f O (v i) for all v i in V . Indeed, fromdepends on λPthe fact that Θ satisfies (19), we know that λPii= 1 for all i in {1, 2, . . . , n}. We can show that [47]Cα(cid:4)(cid:5)f P (v i), f P (v j)(cid:4)= λCi j(cid:5)= λOf P (v i), f P (v j)i j(cid:5)= λPf P (v i), f P (v j)i jO α(cid:4)P αfor all v i and v j in V .Finally, for m in N \ {0}, the function f m is defined asf m(v i)(p) = max(cid:9)f m−1(v i)(p),(cid:4)(cid:4)λNTPli,nmaxl=1T(cid:5)Rα↑ f m−1(vl)(p)(cid:5)(cid:10)for all p in Rn and v i in V . Note that to obtain f m(v i)(p), not only points are added from f m−1(vl) (to some extent), butalso points which are within distance α of the support of f m−1(vl).Furthermore, we define f 0 = f P . We can show that there exists an m0 in N such that f m0 = f l for every l (cid:2) m0. For thisparticular m0, we can moreover show that [47]286S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298CαO α(cid:4)P α(cid:4)(cid:5)= λCf m0 (v i), f m0 (v j)i j(cid:5)(cid:4)= λOf m0 (v i), f m0 (v j)i j(cid:5)= λPf m0 (v i), f m0 (v j)i j(cid:5)(cid:4)= λNTPf m0 (v i), f m0 (v j)i jNTPαfor all v i and v j in V . In other words, we have constructed an (n; α, 0)-interpretation of Θ .Appendix B. Proof of Proposition 2Because only standard sets are considered, occurrences in Θ1 of formulas involving NTP have been introduced as arefinement of formulas involving NTPP or TPP from Θ0. We use this observation to generate an alternative refinement Θof Θ0 in which formulas of the form NTP(u, v) (cid:2) 1 are replaced by formulas of the form NTP(u, v) (cid:2) 1 − δ for a sufficientlysmall δ. Subsequently, we show that this refinement Θ satisfies all the conditions of Proposition 1, provided that Θ1 satisfies(16)–(19) and (23)–(53).Let V = {v 1, v 2, . . . , vk} be the set of variables occurring in Θ0 and let Θ1 be defined for every v i and v j in V byC(v i, v j) (cid:2) λCi jP (v i, v j) (cid:2) λPi jO (v i, v j) (cid:2) λOi jNTP(v i, v j) (cid:2) λNTPi jC(v i, v j) (cid:3) λCi jP (v i, v j) (cid:3) λPi jO (v i, v j) (cid:3) λOi jNTP(v i, v j) (cid:3) λNTPi jfor some λCi j , λOi j , λPi j and λNTP(cid:28)(cid:2)i j(cid:3)M =i j, λPλCi j, λOi j , λNTPi jin [0, 1]. Let M be the set of all these membership degrees, i.e.1(cid:2)i, j(cid:2)kand let δ > 0 be such thatδ < min(cid:2)(cid:4)minT W (λ1, λ2), 1 − T W (λ1, λ2)(cid:5) (cid:20)(cid:3)(cid:20) λ1, λ2 ∈ M and 0 < T W (λ1, λ2) < 1provided M ⊃ {0, 1}; if M = {0, 1}, on the other hand, δ can be an arbitrary value from ]0, 1[. Note that a suitable δ can= 1 foralways be found, since Θ0, and therefore also Θ1 and M are finite. Furthermore, by assumption, we have that λPiiall i in {1, 2, . . . , k}, hence it holds that 1 ∈ M. This implies that for every m in M \ {0, 1}δ < min(m, 1 − m)(B.1)To prove this proposition, we will construct a normalised set of fuzzy RCC formulas Θ which satisfies the assumptions ofProposition 1, and is, moreover, a refinement of Θ0. In particular, Θ contains the following formulasC(v i, v j) (cid:2) λCi jP (v i, v j) (cid:2) λPi jO (v i, v j) (cid:2) λOi jNTP(v i, v j) (cid:2) γ NTPi jC(v i, v j) (cid:3) λCi jP (v i, v j) (cid:3) λPi jO (v i, v j) (cid:3) λOi jNTP(v i, v j) (cid:3) γ NTPi jfor every v i and v j in V , where(cid:19)γ NTPi j=1 − δλNTPi jif λNTPi j= 1 and λPji= 1otherwiseNote that γ NTPis a refinement of Θ0, and that Θ satisfies (16)–(19) as well as the transitivity rules for fuzzy topological relations.always holds. To complete the proof, we need to show that γ NTPii < 1 for all i in {1, 2, . . . , k}, that Θ(cid:3) λNTPi ji jBy assumption, we know that λPiiλNTPii < 1, we have γ NTPiiformula in Θ0 of one of the following forms= λNTP= 1 for all i in {1, 2, . . . , k}. If λNTP= 1 − δ < 1 and ifii < 1. Next, if Θ were not a refinement of Θ0, there would have to be a (disjunct of a)= 1, we therefore have γ NTPiiiiNTPP(v i, v j) (cid:2) λNTPP(v i, v j) (cid:3) λTPP(v i, v j) (cid:2) λTPP(v i, v j) (cid:3) λ(B.2)(B.3)(B.4)(B.5)S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298287i jI (vIi , vinstead of λNTPIj ) is γ NTPwhich is violated in models of Θ . Indeed, there would have to exist a model I of Θ which is not a model of Θ0. Sinceevery model of Θ1 is a model of Θ0, this means that some fuzzy RCC formula in Θ0 is violated because of the fact thatfor some i and j in {1, 2, . . . , k}. However, (B.3) can certainly not be violated by INTPi jI (vIIj ) is not greater in models of Θ than in models of Θ1. Neither can (B.4) bei , vas for all v i and v j , the value of NTPPviolated, for the same reason. Furthermore, (B.2) could only be violated by I if γ NTP= 1 and, but this implies λPjiI (vIIIi ) = 1, and hence NTPPj ) is not greateri , vtherefore PI (vIIj ) = 0. Hence, as the value of NTPPj ) is thein models of Θ than in models of Θ1, this implies that NTPPsame in models of Θ1 and in models of Θ , (B.2) cannot be violated. In entirely the same way, we have that (B.5) can neverbe violated.Ij ) = 0, in any model of Θ1. As the value of NTPP(cid:4)= λNTPi jIj , vIi , vIi , vIi , vI (vI (vI (vi jAs Θ1 satisfies requirements (16)–(19), we immediately find that Θ satisfies requirements (17)–(19) and, moreoverλNTPi j(cid:3) λPi j(cid:3) λOi jfor all i and j in {1, 2, . . . , k}. Since γ NTP(cid:3) λCi ji j(cid:3) λNTPi j, we also have γ NTPi j(cid:3) λPi j . In other words, Θ also satisfies (16).Finally, we show that Θ satisfies each of the transitivity rules for fuzzy topological relations, and in particular, each ofthe 31 transitivity rules introduced above. Note that we only need to check the transitivity rules involving NTP; we knowthat the others are satisfied from the fact that Θ1 satisfies all transitivity rules. Moreover, most of the remaining transitivityrules are satisfied because γ NTP. For this reason, we only need to show that Θ satisfies the following transitivityrules.(cid:3) λNTPi ji j(B.6)(B.7)(B.8)(B.9)(B.10)(B.11)(B.12)(B.13)(cid:4)(cid:4)P(cid:5)P (v i, v j), NTP(v j, vl)(cid:3) NTP(v i, vl)(cid:5)(cid:4)(cid:3) NTP(v i, vl)NTP(v i, v j), NTP(v j, vl)(cid:5)(cid:4)−1(v i, v j), NTP−1(v j, vl)(cid:3) NTP(cid:5)−1(v j, vl)P (v i, v j), coNTP(cid:5)−1(v i, v j), coNTP(v j, vl)(cid:4)NTP(v i, v j), coNTP(cid:4)NTP(cid:3) coNTP(cid:3) coNTP(v i, vl)(cid:5)−1(v j, vl)(cid:5)−1(v i, v j), coNTP(v j, vl)(cid:3) coP(cid:3) coP(v i, vl)−1(v i, vl)−1(v i, vl)−1(v i, vl)P(cid:4)T WT WT WT WT WT WT WSince T W (λPof δ, γ NTPλNTPjl(cid:5)il(cid:2) γ NTPjl(cid:4)(cid:2) T Wli , λPλPλPi jlj= 1 and λNTPFrom λPlj(cid:3) λP(cid:3) λNTPγ NTPi ji jcan never be violated by Θ .= 1Next, assume that (B.9) were violated, i.e.(cid:5)(cid:4)i j, 1 − γ NTPλPljT W> 1 − γ NTPliT W(cid:5)(cid:4)i j, λPλP= 1, we therefore have λPil(cid:3) λPiljl= λPjlAs λPi jfor (B.10) is entirely analogous.First, assume that (B.6) were violated, i.e.(cid:5)T Wjl(cid:4)i j, γ NTPλPi j, λNTP, this is only possible if γ NTP= 1 − δ entails, together with assumption (B.13), that T W (λP> γ NTPil) (cid:3) λNTPil < λNTPililjl, we furthermore establish λNTPjl, which implies λNTPi j, γ NTPjl= 1. Since Θ1 satisfies all transitivity rules, we know that) = 1 and, in other words, λPi j= 1 and γ NTP= λPliilil= 1 − δ. By definition= 1. From= γ NTPjljl= 1, we finally obtain γ NTP= 1 − δ, a contradiction. Hence (B.6) is always satisfied. Moreover, sincei j , this implies that (B.7) is always satisfied as well. In entirely the same fashion, we can show that (B.8)jlThis is only possible if γ NTPγ NTPljagain using (B.1). Because Θ1 satisfies all transitivity rules, we know that, in other words, if λNTPlj= 1 by (B.1), and thus λNTP) (cid:3) δ, which implies γ NTPlj < λNTPljlili= λPjl= 1 and γ NTP= 1. This yields T W (λPlj= 1−δ. Hence, we have 1−γ NTPli < T W (λPi j, δ) > 0, which, in turn, entails λPi j, 1−= 1,i j= 1. As moreover λNTPli= 1, we find that γ NTPli= 1 − δ, a contradiction. The proofFinally, assume that (B.11) were violated, i.e.(cid:5)(cid:4)γ NTPi jT W, 1 − γ NTPlj> 1 − λPliNote that this can only be the case if γ NTPwe find γ NTPagain using (B.1). However, from λPjlcontradiction. The proof of (B.12) is entirely analogous.= 1 using (B.1), and thus λNTPi j= 1 and λPlilj < λNTPi jlj, or, in other words, λNTP= λPjl= 1 and γ NTPljlj= 1. Furthermore, we have from 1 − λPli < T W (γ NTP= 1, which together with λNTPi j= 1, we find λPji= 1 − δ. From T W (γ NTP, 1 − γ NTP= 1 implies γ NTP, δ) > 0,i j) = δ that λP= 1,li= 1 − δ, alji ji j288S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298Appendix C. Proof of Proposition 4First we show the following lemma.Lemma 9. Let a, a(cid:17)and b in [0, 1], and ε in ]0, 1] such that a < a(cid:17) + ε. It holds thatT W (a, b) < T W (a(cid:17), b) + εProof. If T W (a, b) > 0, we haveT W (a, b) = a + b − 1 < a(cid:17), b) = 0, we haveT W (a, b) = 0 < ε (cid:3) T W (aIf T W (a(cid:17), b) + ε(cid:2)(cid:17) + b − 1 + ε (cid:3) max(a(cid:17) + b − 1, 0) + ε = T W (a(cid:17), b) + εFrom Proposition 1 and Proposition 2, we already know that Θ has an (n; α, 0)-model I(cid:17). To prove the proposition, weto an (n; α, 0)-model I which satisfies the additional requirement that all membership degreesshow how we can modify I(cid:17)belong to M Δ2. In particular for v in V and p in Rn, I is defined as(cid:19)Iv(p) =vI(cid:17)(p)if vI(cid:17)\ MΔ(p) ∈ M Δ2I(cid:17)(p) < kΔ + Δ2 < vif kΔ − Δ2 , for a given k in NkΔI (p) < vI(cid:17)(p) + Δ2 always holds. Clearly, we have that I is an (n; α, 0)-interpretation mapping every variableNote that vfrom v to a normalised bounded fuzzy set taking only membership degrees from M Δ. Hence, we only need to show that2I satisfies all formulas from Θ . In particular, we will show that every atomic fuzzy RCC formula with an upper or lowerbound in MΔ that is satisfied by I(cid:17), is also satisfied by I. This implies that also disjunctive fuzzy RCC formulas remainsatisfied; indeed, it follows that all disjuncts that are satisfied by I(cid:17)are satisfied by I.Consider atomic fuzzy RCC formulas of the form C(a, b) (cid:3) λ and C(a, b) (cid:2) λ. We will first show that for each (p0, q0) inRn × Rn and each λ0 in MΔ, it holds thatT WI(cid:17)(p0), Rα(p0, q0), b(cid:4)a(cid:4)aI(cid:17)I(cid:17)I(cid:17)(cid:5)(q0)(cid:5)(q0)(cid:3) λ0 ⇒ T W(cid:2) λ0 ⇒ T W(cid:4)a(cid:4)aII(p0), Rα(p0, q0), b(p0), Rα(p0, q0), bII(cid:5)(q0)(cid:5)(q0)(cid:3) λ0(cid:2) λ0(C.1)(C.2)(p0), Rα(p0, q0), bT WI (p0) and bSince aI (q0) are in M Δ(cid:4)aIT W(p0), Rα(p0, q0), bI2, we also have(cid:5)(q0)∈ M Δ2First assume that also the stronger statement(p0), Rα(p0, q0), bI (p0) < aI(cid:17)is satisfied. As a(cid:4)aIT W(cid:4)aIT WI(cid:5)(q0)∈ MΔII(cid:17)< T W(p0) + Δ2 and b(cid:5)(q0)I (q0) < b(cid:4)a(cid:4)aI (p0), Rα(p0, q0), b(cid:5)(q0)I< T WI(cid:17)I(cid:17)Using the assumption T W (aT WI(cid:17)(cid:4)a⇒ T W⇒ T WI(p0), Rα(p0, q0), b(cid:4)a(cid:4)aI(p0), Rα(p0, q0), b(p0), Rα(p0, q0), bI(cid:3) λ0(cid:5)(q0)(cid:5)(q0)− Δ < λ0(cid:3) λ0(p0), Rα(p0, q0), b(p0), Rα(p0, q0), bI(cid:17)(q0) + ΔI2 , we find using Lemma 9+ Δ2(cid:5)+ Δ(q0)(cid:5)(q0)I(cid:17)(p0), Rα(p0, q0), bI (q0)) ∈ MΔ, and the fact that Δ and λ0 are in MΔ, we findshowing (C.1). In entirely the same fashion, we find that(cid:4)aT WI(p0), Rα(p0, q0), bI(cid:5)(q0)> T W(cid:4)aI(cid:17)(p0), Rα(p0, q0), bI(cid:17)(cid:5)(q0)− Δfrom which we obtain (C.2).Next, assume T W (aI (p0) ∈ MΔ and bor aanalogous). From ausing Lemma 9I (p0) ∈ M Δ22I (p0), Rα(p0, q0), bI (q0) ∈ M ΔI (q0) ∈ MΔ,\ MΔ. Assume, for instance, the former case (the proof for the latter case is entirely\ MΔ. This means that either aI (q0)) ∈ M ΔI (p0) ∈ M Δ\ MΔ and b22\ MΔ, we have by construction aI (p0) = aI(cid:17)(p0). From bI (q0) < bI(cid:17)(q0) + Δ2 , we obtainS. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298289(cid:4)aIT W(p0), Rα(p0, q0), bI(cid:5)(q0)= T W< T W(cid:4)a(cid:4)aI(cid:17)I(cid:17)(p0), Rα(p0, q0), b(p0), Rα(p0, q0), bI(cid:5)(q0)I(cid:17)(cid:5)(q0)+ Δ2, this leads toI (p0), Rα(p0, q0), bUsing T W (a(cid:4)aT WI(cid:17)I (q0)) ∈ M Δ(cid:5)(q0)I(cid:17)2I(p0), Rα(p0, q0), b(cid:4)a(cid:4)aI(p0), Rα(p0, q0), b(p0), Rα(p0, q0), bII(cid:3) λ0(cid:5)(q0)(cid:5)(q0)− Δ2(cid:3) λ0⇒ T W⇒ T W< λ0showing (C.1). In entirely the same fashion, we find that(cid:4)aIT W(p0), Rα(p0, q0), bI(cid:5)(q0)> T W(cid:4)aI(cid:17)(p0), Rα(p0, q0), bI(cid:17)(cid:5)(q0)− Δ2from which we obtain (C.2).Hence, we have that (C.1) and (C.2) are always satisfied. To complete the proof, we show that this implies for every λin MΔ(cid:4)a(cid:4)aI(cid:17)I(cid:17), b, bI(cid:17) (cid:5)I(cid:17) (cid:5)CαCα(cid:3) λ ⇒ Cα(cid:2) λ ⇒ Cα(cid:4)a(cid:4)aII, b, bI (cid:5)I (cid:5)(cid:3) λ(cid:2) λ(C.3)(C.4)I(cid:17)If Cα(aI(cid:17), b(cid:4)a) (cid:3) λ, we have for every (p, q) in Rn × Rn(cid:5)I(cid:17)(q)(p), Rα(p, q), b(cid:3) λI(cid:17)T Wwhich implies by (C.1)(cid:4)aIT W(p), Rα(p, q), bI(cid:5)(q)(cid:3) λFrom the monotonicity of the supremum we have (C.3), i.e.(cid:4)a(p), Rα(p, q), b(cid:5)(q)(cid:3) λ(cid:4)aI (cid:5)T WCα, bIII= supp,q∈RnFinally, assume Cα(aI(cid:17)mum in Cα(aI(cid:17), bI(cid:17)(cid:4)aT W(p0), Rα(p0, q0), bI(cid:17)(cid:5)(q0)(cid:2) λI(cid:17), b) (cid:2) λ. Because aI(cid:17)I(cid:17)) is attained in some (p0, q0) in Rn × Rn implyingand bI(cid:17)only take a finite number of different membership degrees, the supre-or, by (C.2)(cid:4)aT WI(p0), Rα(p0, q0), bI(cid:5)(q0)(cid:2) λWe conclude(cid:4)aI, bCαI (cid:5)= supp,q∈RnT W(cid:4)aI(p), Rα(p, q), bI(cid:5)(q)(cid:4)aI(cid:2) T W(p0), Rα(p0, q0), bI(cid:5)(q0)(cid:2) λThe proof for fuzzy RCC formulas involving P , O or NTP is analogous.Appendix D. Proof of Proposition 5First we show three technical lemmas.Lemma 10. Let λ be in ]0, 1], T = T W , and let A be a fuzzy set in Rn. It holds that(Rα↓ A)λ = Rα↓( Aλ)Proof. Assume p ∈ (Rα↓ A)λ, i.e.(cid:2) λ(cid:5)Rα(p, q), A(q)I W(cid:4)infq∈RnThis means that for every q satisfying (p, q) ∈ Rα , it holds that A(q) (cid:2) λ, or equivalently q ∈ Aλ, i.e.(p, q) ∈ Rα ⇒ q ∈ Aλ(D.1)290S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298which entailsp ∈ Rα↓( Aλ)Conversely, assume p ∈ Rα↓( Aλ). This implies for every q in Rn(p, q) ∈ Rα ⇒ q ∈ Aλor(p, q) ∈ Rα ⇒ A(q) (cid:2) λimplyingI W(cid:4)(cid:5)Rα(p, q), Aλ(q)(cid:2) λHence, by definition of the infimum as greatest lower bound, we have(cid:4)(cid:5)Rα(p, q), Aλ(q)(cid:2) λinfq∈RnI Wwhich means p ∈ (Rα↓ A)λ. (cid:2)Lemma 11. Let λ be in ]0, 1], T = T W and let A be a fuzzy set in Rn which only takes a finite number of different membership degrees.It holds that(Rα↑ A)λ = Rα↑( Aλ)Proof. Assume p ∈ (Rα↑ A)λ, i.e.(cid:4)(cid:5)Rα(p, q), A(q)(cid:2) λT Wsupq∈RnSince A only takes a finite number of different membership degrees, this supremum is attained. Hence, there is a q0 suchthat d(p, q0) (cid:3) α and A(q0) (cid:2) λ. In other words(cid:4)∃q ∈ Rn(cid:5)(cid:4)(p, q) ∈ Rα ∧ q ∈ Aλ(cid:5)or p ∈ Rα↑( Aλ). Conversely, assume p ∈ Rα↑( Aλ). This means that for some q0, d(p, q0) (cid:3) α and A(q0) (cid:2) λ, hence,T W (Rα(p, q0), A(q0)) (cid:2) λ. In particular, this entails(cid:4)(cid:5)Rα(p, q), A(q)(cid:2) λT Wsupq∈Rnor p ∈ (Rα↑ A)λ. (cid:2)Note that the condition that A only takes a finite number of different membership degrees is not redundant. For example,assume n = 1 and let A be defined for q in R by(cid:17)A(q) =λqα0if q ∈ [0, α[otherwisefor a given λ in ]0, 1] and α > 0. Then A(q) < λ for all q in R and therefore limq −→α A(q) = λ. This means>(Rα↑ A)(0) = supq∈RT W(cid:4)(cid:5)Rα(0, q), A(q)= sup(cid:17)λqα(cid:18)(cid:20)(cid:20)(cid:20) q ∈ [0, α[= λand 0 ∈ (Rα↑ A)λ. On the other hand, we have Aλ = ∅, implying Rα↑( Aλ) = ∅ and in particular 0 /∈ Rα↑( Aλ).Lemma 12. Let A and B be crisp, non-empty, bounded subsets of Rn. It holds that NTPα( A, B) ≡ NTPPα( A, B) (α > 0).Proof. We need to show that NTPα( A, B) ⇒ ¬P α(B, A). Assume that both NTPα( A, B) and P α(B, A) hold. From NTPα( A, B)we know Rα↑ A ⊆ Rα↓↑B, while P α(B, A) entails Rα↓↑B ⊆ Rα↓↑ A. Together, this yields Rα↑ A ⊆ Rα↓↑ A. Since α > 0, thisis only possible if A = ∅ or A = Rn, which have both been excluded by assumption. (cid:2)To show equivalence (70), we findCα( A, B) (cid:2) λ ⇔ supp,q∈RnT W(cid:4)(cid:5)A(p), Rα(p, q), B(q)(cid:2) λSince A and B only take a finite number of different membership degrees the supremum is attained andS. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298291Cα( A, B) (cid:2) λ ⇔⇔⇔(cid:4)∃p, q ∈ Rn(cid:4)∃p, q ∈ Rn(cid:4)∃p, q ∈ Rn(cid:5)(cid:4)(cid:5)(cid:4)T Wd(p, q) (cid:3) α ∧ T Wd(p, q) (cid:3) α ∧ T W(cid:5)(cid:4)(cid:4)(cid:5)A(p), Rα(p, q), B(q)(cid:5)(cid:2) λ(cid:4)(cid:4)(cid:5)A(p), Rα(p, q), B(q)(cid:5)A(p), B(q)(cid:2) λ(cid:5)(cid:5)(cid:2) λSince A and B only take membership degrees from M Δ2T W ( A(p), B(q)) (cid:2) λ:, we can enumerate the possible values of A(p) and B(q) for which(cid:4)∃p, q ∈ Rn⇔(cid:29)(cid:5)d(p, q) (cid:3) α ∧(cid:29)(cid:4)A(p) (cid:2) 1 ∧ B(q) (cid:2) λ(cid:30)(cid:30)(cid:29)(cid:5)∨A(p) (cid:2) 1 − Δ2∧ B(q) (cid:2) λ + Δ2(cid:30)(cid:4)∨ · · · ∨(cid:5)A(p) (cid:2) λ ∧ B(q) (cid:2) 1(cid:5)(cid:4)(cid:4)(p ∈ A1 ∧ q ∈ Bλ) ∨ (p ∈ A1− Δ(cid:5)(cid:5)(cid:4)(cid:4)d(p, q) (cid:3) α ∧(cid:4)∃p, q ∈ Rn(cid:4)∃p, q ∈ Rn(cid:4)d(p, q) (cid:3) α ∧ p ∈ Aλ ∧ q ∈ B1(cid:5)(cid:4)d(p, q) (cid:3) α ∧ p ∈ A1 ∧ q ∈ Bλ∨ · · · ∨(cid:5)(cid:5)d(p, q) (cid:3) α ∧ p ∈ A1 ∧ q ∈ Bλ⇔⇔⇔(cid:4)∃p, q ∈ Rn(cid:4)∃p, q ∈ Rn∨ · · · ∨(cid:5)(cid:4)d(p, q) (cid:3) α ∧ p ∈ Aλ ∧ q ∈ B1) ∨ · · · ∨ Cα( Aλ, B1), Bλ+ Δ22⇔ Cα( A1, Bλ) ∨ Cα( A1− Δ∧ q ∈ Bλ+ Δ(cid:4)d(p, q) (cid:3) α ∧ p ∈ A1− Δ) ∨ · · · ∨ (p ∈ Aλ ∧ q ∈ B1)(cid:5)∧ q ∈ Bλ+ Δ22∨22(cid:5)(cid:5)(cid:5)∨(cid:5)(cid:4)(cid:4)∃p, q ∈ Rn(cid:5)d(p, q) (cid:3) α ∧ p ∈ A1− Δ(cid:5)∧ q ∈ Bλ+ Δ22Next, (71) follows easily from (70):Cα( A, B) (cid:3) λ(cid:17) ⇔ ¬Cα( A, B) > λ(cid:5)(cid:17)(cid:4)(cid:29)Cα( A, B) (cid:3) λ(cid:17) ⇔ ¬Cα( A, B) (cid:2) λ(cid:30)(cid:17) + Δ2Since A and B only take values from M Δ2, Cα( A, B) can only take values from M Δeither. Hence2and by (70)Cα( A, B) (cid:3) λ(cid:4)(cid:17) ⇔ ¬Cα( A1, Bλ(cid:17)+ Δ⇔ DCα( A1, Bλ(cid:17)+ Δ2) ∨ Cα( A1− Δ) ∧ DCα( A1− Δ2, Bλ(cid:17)+Δ) ∨ · · · ∨ Cα( Aλ(cid:17)+ Δ, Bλ(cid:17)+Δ) ∧ · · · ∧ DCα( Aλ(cid:17)+ Δ222(cid:5), B1), B1)2To show (72), we find using Lemma 10 and Lemma 11(cid:5)Rα↓↑ A(p), Rα↓↑B(p)(cid:5)(cid:4)T W(cid:4)(cid:4)(cid:2) λO α( A, B) (cid:2) λ ⇔ supp∈Rn(cid:4)∃p ∈ Rn(cid:4)∃p ∈ Rn⇔⇔T W(cid:29)(cid:4)(cid:5)(cid:5)Rα↓↑ A(p), Rα↓↑B(p)(cid:5)(cid:2) λRα↓↑ A(p) (cid:2) 1 ∧ Rα↓↑B(p) (cid:2) λ(cid:30)(cid:5)Rα↓↑ A(p) (cid:2) λ ∧ Rα↓↑B(p) (cid:2) 1(cid:5)(cid:4)(cid:4)(cid:5)p ∈ (Rα↓↑ A)1 ∧ p ∈ (Rα↓↑B)λ(cid:5)(cid:5)p ∈ (Rα↓↑ A)λ ∧ p ∈ (Rα↓↑B)1(cid:5)(cid:4)(cid:4)(cid:5)p ∈ (Rα↓↑ A1) ∧ p ∈ (Rα↓↑Bλ)(cid:5)(cid:5)(cid:4)∨ · · · ∨(cid:4)∃p ∈ Rn(cid:4)∨ · · · ∨(cid:4)∃p ∈ Rn(cid:4)∨ · · · ∨(cid:4)∃p ∈ Rn(cid:4)∃p ∈ Rnp ∈ (Rα↓↑ Aλ) ∧ p ∈ (Rα↓↑B1)(cid:5)(cid:4)(cid:5)p ∈ (Rα↓↑ A1) ∧ p ∈ (Rα↓↑Bλ)(cid:4)∃p ∈ Rn(cid:5)p ∈ (Rα↓↑ Aλ) ∧ p ∈ (Rα↓↑B1)∨ · · · ∨(cid:5)(cid:4)∨⇔⇔⇔(cid:29)(cid:5)∨Rα↓↑ A(p) (cid:2) 1 − Δ2∧ Rα↓↑B(p) (cid:2) λ + Δ2∨∨(cid:4)(cid:4)p ∈ (Rα↓↑ A)1− Δ2∧ p ∈ (Rα↓↑B)λ+ Δ2(cid:5)p ∈ (Rα↓↑ A1− Δ2) ∧ p ∈ (Rα↓↑Bλ+ Δ2(cid:5))(cid:5)(cid:4)p ∈ (Rα↓↑ A1− Δ2) ∧ p ∈ (Rα↓↑Bλ+ Δ2(cid:30)(cid:5))⇔ O α( A1, Bλ) ∨ O α( A1− Δ2, Bλ+ Δ2) ∨ · · · ∨ O α( Aλ, B1)Furthermore, (73) follows from (72) in the same way that (71) follows from (70). Next, to show (75), we obtain, againemploying Lemma 10 and Lemma 11292S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298(cid:29)(cid:5)(cid:17)∨Rα↓↑ A(p) (cid:2) 1 − Δ2∧ Rα↓↑B(p) (cid:3) λ(cid:30)(cid:17) − Δ2(cid:4)Rα↓↑B(p) > λ(cid:29)(cid:5)(cid:5)(cid:17)∨Rα↓↑ A(p) (cid:2) 1 − Δ2(cid:4)∧ ¬Rα↓↑B(p) > λ(cid:30)(cid:5)(cid:17) − Δ2(cid:30)(cid:30)(cid:29)∨Rα↓↑ A(p) (cid:2) 1 − Δ2(cid:4)∧ ¬(cid:30)(cid:5)(cid:17)Rα↓↑B(p) (cid:2) λ(cid:5)Rα↓↑ A(p), Rα↓↑B(p)(cid:5)(cid:4)(cid:4)(cid:17)(cid:3) λ(cid:5)Rα↓↑ A(p), Rα↓↑B(p)(cid:5)(cid:17)(cid:3) λI W(cid:29)(cid:4)(cid:5)Rα↓↑ A(p) (cid:2) 1 ∧ Rα↓↑B(p) (cid:3) λ(cid:30)(cid:5)(cid:17) ∧ Rα↓↑B(p) (cid:3) 0Rα↓↑ A(p) (cid:2) 1 − λ(cid:29)(cid:5)(cid:4)Rα↓↑ A(p) (cid:2) 1 ∧ ¬Rα↓↑ A(p) (cid:2) 1 − λ(cid:29)(cid:29)(cid:5)Rα↓↑ A(p) (cid:2) 1 ∧ ¬(cid:4)(cid:17) ∧ ¬(cid:29)(cid:30)(cid:5)(cid:5)Rα↓↑B(p) > 0Rα↓↑B(p) (cid:2) λ(cid:29)(cid:17) + Δ2(cid:30)(cid:30)(cid:30)Rα↓↑B(p) (cid:2) Δ2(cid:4)(cid:5)∨ · · · ∨Rα↓↑ A(p) (cid:2) 1 − λ(cid:17) ∧ ¬I W(cid:17)P α( A, B) (cid:3) λ(cid:4)⇔ infp∈Rn(cid:4)∃p ∈ Rn(cid:4)∃p ∈ Rn⇔⇔∨ · · · ∨(cid:4)∃p ∈ Rn⇔∨ · · · ∨(cid:4)∃p ∈ Rn⇔(cid:4)(cid:4)(cid:29)(cid:5)(cid:4)(cid:4)(cid:4)∃p ∈ Rn⇔∨ · · · ∨(cid:4)∃p ∈ Rn⇔∨ · · · ∨(cid:4)∃p ∈ Rn⇔(cid:4)p ∈ (Rα↓↑ A)1 ∧ p /∈ (Rα↓↑B)λ(cid:17)+ Δ2(cid:5)(cid:5)p ∈ (Rα↓↑ A)1−λ(cid:17) ∧ p /∈ (Rα↓↑B) Δ(cid:5)(cid:5)(cid:4)(cid:4)p ∈ (Rα↓↑ A1) ∧ p /∈ (Rα↓↑Bλ(cid:17)+ Δ)2(cid:5)(cid:5))2(cid:4)∨p ∈ (Rα↓↑ A)1− Δ2∧ p /∈ (Rα↓↑B)λ(cid:17)(cid:5)(cid:4)∨p ∈ (Rα↓↑ A1− Δ2(cid:5)) ∧ p /∈ (Rα↓↑Bλ(cid:17) )22∨(cid:5)(cid:4)(cid:5)(cid:4)(cid:5))p ∈ (Rα↓↑ A1−λ(cid:17) ) ∧ p /∈ (Rα↓↑B Δ(cid:5)(cid:4)p ∈ (Rα↓↑ A1) ∧ p /∈ (Rα↓↑Bλ(cid:17)+ Δ(cid:4)∃p ∈ Rn(cid:5)(cid:4)(cid:4)∃p ∈ Rn(cid:5)p ∈ (Rα↓↑ A1−λ(cid:17) ) ∧ p /∈ (Rα↓↑B Δ)2(cid:4)∀p ∈ Rn∨ ¬(cid:5))∨ · · · ∨(cid:4)∀p ∈ Rnp /∈ (Rα↓↑ A1) ∨ p ∈ (Rα↓↑Bλ(cid:17)+ Δ(cid:4)∀p ∈ Rn(cid:5)(cid:4)∨ · · · ∨ ¬(cid:4)∀p ∈ Rnp ∈ (Rα↓↑ A1) ⇒ p ∈ (Rα↓↑Bλ(cid:17)+ Δ(cid:4)∀p ∈ Rnp /∈ (Rα↓↑ A1−λ(cid:17) ) ∨ p ∈ (Rα↓↑B Δ2(cid:4)∀p ∈ Rn∨ ¬(cid:5))p ∈ (Rα↓↑ A1−λ(cid:17) ) ⇒ p ∈ (Rα↓↑B Δ∨ · · · ∨ ¬(cid:5))(cid:5))(cid:5)(cid:4)(cid:5)(cid:4)222⇔ ¬⇔ ¬p ∈ (Rα↓↑ A1− Δ2(cid:5)) ∧ p /∈ (Rα↓↑Bλ(cid:17) )(cid:5)(cid:4)p /∈ (Rα↓↑ A1− Δ2(cid:5)) ∨ p ∈ (Rα↓↑Bλ(cid:17) )(cid:5)(cid:4)p ∈ (Rα↓↑ A1− Δ2(cid:5)) ⇒ p ∈ (Rα↓↑Bλ(cid:17) )⇔ ¬P α( A1, Bλ(cid:17)+ Δ2) ∨ ¬P α( A1− Δ2, Bλ(cid:17) ) ∨ · · · ∨ ¬P α( A1−λ(cid:17) , B Δ2)and (74) follows from (75) in the same way that (71) follows from (70). To show (77) we find entirely analogously as for (75)thatNTPα( A, B) (cid:3) λ(cid:17) ⇔ ¬NTPα( A1, Bλ(cid:17)+ Δ2) ∨ ¬NTPα( A1− Δ2, Bλ(cid:17) ) ∨ · · · ∨ ¬NTPα( A1−λ(cid:17) , B Δ2)from which (77) follows by Lemma 12. Finally, (76) follows from (77) in the same way that (71) follows from (70).Appendix E. Proof of Proposition 7Lemma 13. Let A = [a1, a2] ∪ [a3, a4] ∪ · · · ∪ [a2n−1, a2n] such that a1 < a2 < a3 < · · · < a2n. For sufficiently small γ > 0, it holdsthat Rγ ↓ A = [a1 + γ , a2 − γ ] ∪ [a3 + γ , a4 − γ ] ∪ · · · ∪ [a2n−1 + γ , a2n − γ ].Proof. Let γ > 0 be chosen such thatγ <nmini=1a2i − a2i−12We then find for each p in R(cid:4)(p, q) ∈ Rγ ⇒ q ∈ Ap ∈ Rγ ↓ A ≡ (∀q ∈ R)(cid:4)d(p, q) (cid:3) γ ⇒ q ∈ A≡ (∀q ∈ R)(cid:5)(cid:5)≡ p ∈ [a1 + γ , a2 − γ ] ∪ [a3 + γ , a4 − γ ] ∪ · · · ∪ [a2n−1 + γ , a2n − γ ](cid:2)S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298293Lemma 14. Let A = [a1, a2] ∪ [a3, a4] ∪ · · · ∪ [a2n−1, a2n] such that a1 < a2 < a3 < · · · < a2n. For sufficiently small γ > 0, it holdsthat Rγ ↑ A = [a1 − γ , a2 + γ ] ∪ [a3 − γ , a4 + γ ] ∪ · · · ∪ [a2n−1 − γ , a2n + γ ] and a1 − γ < a2 + γ < a3 − γ < · · · < a2n + γ .Proof. Let γ > 0 be chosen such thatγ <nmini=2a2i−1 − a2i−22We then find for each p in R(cid:4)Rγ (p, q) ∧ q ∈ Ap ∈ Rγ ↑ A ≡ (∃q ∈ R)(cid:4)d(p, q) (cid:3) γ ∧ q ∈ A≡ (∃q ∈ R)(cid:5)(cid:5)≡ p ∈ [a1 − γ , a2 + γ ] ∪ [a3 − γ , a4 + γ ] ∪ · · · ∪ [a2n−1 − γ , a2n + γ ](cid:2)Corollary 7. If A is the union of a finite number of closed, non-degenerate intervals, it holds that Rγ ↓↑ A = A for any sufficiently smallγ > 0.Since Θ is satisfiable, there exists an Egg–Yolk model in any dimension, and, in particular, an Egg–Yolk model I in R.Icorresponds to an Egg–Yolk region (v 1, v 2, . . . , vk) whoseLet V be the set of variables used in Θ . For every v in V , vk nested sets each are the union of a finite number of closed, non-degenerate intervals in R. Next, we show that thereexists a model I(cid:17)which also maps variables to Egg–Yolk regions, but which interprets C as in (83). From Section 7, wethen know that I(cid:17)corresponds to an (1; α, 0)-model in which each variable v in V is interpreted as a fuzzy set taking onlymembership degrees from M 1. In particular,kwe define I(cid:17), its α-level sets corresponding to the k nested sets of the Egg–Yolk region vfor v in V as the Egg–Yolk region whose ith component v(cid:17) i is given byI(cid:17)(cid:17) i = Rγ ↓v ivfor a given γ > 0. We show that I(cid:17)is a model of Θ , provided γ and the parameter α > 0 from (83) are taken sufficientlysmall. In particular, we show that when A and B are the union of a finite number of closed, non-degenerate intervals in R,it holds thatC 1( A, B) ⇔ Cα(Rγ ↓ A, Rγ ↓B)P 1( A, B) ⇔ P α(Rγ ↓ A, Rγ ↓B)O 1( A, B) ⇔ O α(Rγ ↓ A, Rγ ↓B)NTP1( A, B) ⇔ NTPα(Rγ ↓ A, Rγ ↓B)from which the proposition follows. Note that when γ is sufficiently small, Rγ ↓ A and Rγ ↓B are the union of a finitenumber of closed, non-degenerate intervals in R by Lemma 13. First, considerC 1( A, B) ⇒ Cα(Rγ ↓ A, Rγ ↓B)(E.1)If C 1( A, B) holds, we know that there is some p in A ∩ B. From Lemma 13 we furthermore know that there is some q1in Rγ ↓ A and some q2 in Rγ ↓B such that d(p, q1) (cid:3) γ and d(p, q2) (cid:3) γ , and d(q1, q2) (cid:3) 2γ . Hence, (E.1) holds as soon asγ (cid:3) α2 . We show the implication in the opposite direction by contraposition, i.e.:DC1( A, B) ⇒ DCα(Rγ ↓ A, Rγ ↓B)(E.2)If DC1( A, B), we know that d = infp∈ A,q∈B d(p, q) > 0. Therefore, it suffices to choose α < d to have DCα( A, B), which entailsDCα(Rγ ↓ A, Rγ ↓B) since Rγ ↓ A ⊆ A and Rγ ↓B ⊆ B.Next, we considerO 1( A, B) ⇒ O α(Rγ ↓ A, Rγ ↓B)(E.3)From O 1( A, B) we know that there is some p in i( A) ∩ i(B). Since p ∈ i( A) ∩ i(B) we know that all points in a sufficientlysmall neighborhood of p are also located in A and in B, in other words, that for sufficiently small γ , we have p ∈ Rγ ↓ A ∩Rγ ↓B, which implies p ∈ Rα↓↑(Rγ ↓ A) ∩ Rα↓↑(Rγ ↓B) and (E.3). Again, we show the implication in the opposite directionby contraposition:DR1( A, B) ⇒ DRα(Rγ ↓ A, Rγ ↓B)(E.4)From DR1( A, B), we know that for any p in R either p /∈ i( A) or p /∈ i(B). We obtain294S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298(cid:4)(∀p ∈ R)(cid:5)p /∈ i( A) ∨ p /∈ i(B)(cid:4)⇔ (∀p ∈ R)(cid:4)d(p, q) (cid:3) ε ⇒ q ∈ A¬(∃ε > 0)(∀q ∈ R)(cid:4)∨ ¬(∃ε > 0)(∀q ∈ R)d(p, q) (cid:3) ε ⇒ q ∈ B(cid:5)(cid:4)⇔ (∀p ∈ R)(∀ε > 0)(p /∈ Rε↓ A) ∨ (∀ε > 0)(p /∈ Rε↓B)⇒ (∀p ∈ R)(p /∈ Rγ ↓ A ∨ p /∈ Rγ ↓B)(cid:5)(cid:5)(cid:5)By Corollary 7, we can assume that Rγ ↓ A = Rα↓↑(Rγ ↓ A) and Rγ ↓B = Rα↓↑(Rγ ↓B). Furthermore, note that this does notimply that the value of α depends on the value of γ . Indeed, from the proof of Lemma 13 and 14, it is clear that any valueof α for which A = Rα↓↑ A also satisfies Rγ ↓ A = Rα↓↑(Rγ ↓ A), the former expression being independent of γ . Hence, wehave(cid:4)(∀p ∈ R)(cid:5)p /∈ Rα↓↑(Rγ ↓ A) ∨ p /∈ Rα↓↑(Rγ ↓B)or, in other words, DRα(Rγ ↓ A, Rγ ↓B).To showP 1( A, B) ⇒ P α(Rγ ↓ A, Rγ ↓B)(E.5)we find from P 1( A, B) that A ⊆ B, and therefore also that Rα↓↑(Rγ ↓ A) ⊆ Rα↓↑(Rγ ↓B), or, P α(Rγ ↓ A, Rγ ↓B). To showthe implication in the opposite direction, we find from ¬P 1( A, B) that there is a p in R such that p ∈ i( A) and p /∈ B. Thisimplies that all points in a sufficiently small neighborhood of p are in A, or, p ∈ Rγ ↓ A, provided γ is sufficiently small. Fromp /∈ B we also have p /∈ Rγ ↓B. Finally, from Corollary 7, we can assume Rγ ↓ A = Rα↓↑(Rγ ↓ A) and Rγ ↓B = Rα↓↑(Rγ ↓B),and thus ¬P α(Rγ ↓ A, Rγ ↓B).Finally, we consider NTP:NTP1( A, B) ⇒ NTPα(Rγ ↓ A, Rγ ↓B)(E.6)+i+j−i , a−j , b] ⊆ ]b+−i , ai−[. This implies that for sufficiently small γ , we also have [aiFrom NTP1( A, B), we know that A ⊆ i(B). Furthermore, as A (resp. B), is the union of a finite number of closed, non-+] such thatdegenerate intervals A1, A2, . . . , As (resp. B1, B2, . . . , Bt ), for each Ai = [aj− γ [, which[ain turn implies that [a− γ ) =−+j ). Using Lemma 13, this implies in particular that Rα↑(Rγ ↓ A) ⊆ Rγ ↓B. Finally, from Corollary 7,i , amin(bwe know that for sufficiently small α, Rγ ↓B = Rα↓↑(Rγ ↓B), and thus NTPα(Rγ ↓ A, Rγ ↓B). To show the implicationin the opposite direction, we find from ¬NTP1(a, b) that ¬( A ⊆ i(B)), which for sufficiently small α and γ implies¬(Rα↑(Rγ ↓ A) ⊆ i(Rα↑(Rγ ↓B))) by Lemma 13 and Lemma 14. In other words, there must exist a p in R such thatp ∈ Rα↑(Rγ ↓ A) and p /∈ i(Rα↑(Rγ ↓B)). This means that] there exists a B j = [b− γ ] ⊆ ]b+ γ , a++ij−j , b++ γ , bj−+ γ − bi− γ ] if α < min(b−j+ γ , a− γ + α] ⊆ [b+ γ − α, a− γ − a+ γ , b− b− a+j−i−i+i+i+j−j−j(cid:5)(cid:4)d(p, q) (cid:3) ε ∧ q /∈ Rα↑(Rγ ↓B)(∀ε > 0)(∃q ∈ R)and in particular(cid:5)(cid:4)d(p, q) (cid:3) α ∧ q /∈ Rα↑(Rγ ↓B)(∃q ∈ R)or(cid:5)(cid:4)d(p, q) (cid:3) α ⇒ q ∈ Rα↑(Rγ ↓B)¬(∀q ∈ R)and therefore p /∈ Rα↓↑(Rγ ↓B), while p ∈ Rα↑(Rγ ↓ A), which means that ¬NTPα(Rγ ↓ A, Rγ ↓B).Appendix F. Proof of Proposition 8Lemma 15. Let a < b, c < d and let H and G be the m-dimensional hypercubes associated with [a, b] and [c, d]. It holds thatinfp∈[a,b], q∈[c,d]d(p, q) = infp∈H, q∈Qd(p, q)where the notation d is both used to refer to the Euclidean distance in R and Rm.Proof. Clearly, for every p in [a, b] and q in [c, d], it holds thatd(p, q) = d(cid:5)(cid:4)(p, 0, 0, . . . , 0), (q, 0, 0, . . . , 0)and moreover (p, 0, 0, . . . , 0) ∈ H and (q, 0, 0, . . . , 0) ∈ G. Hence, we already haveinfp∈[a,b], q∈[c,d]d(p, q) (cid:2) infp∈H, q∈Qd(p, q)S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298295On the other hand, let (p1, p2, . . . , pm) ∈ H and (q1, q2, . . . , qm) ∈ G. We have that(cid:4)(cid:5)(p1, p2, . . . , pm), (q1, q2, . . . , qm)d(p1, q1)2 + d(p2, q2)2 + · · · + d(pm, qm)2(cid:31)=d(cid:2) d(p1, q1)and moreover p1 ∈ [a, b] and q1 ∈ [c, d], henceinfp∈[a,b], q∈[c,d]d(p, q) (cid:3) infp∈H, q∈Qd(p, q)(cid:2)Lemma 16. Let I be an (m; α, 0)-model of a set of fuzzy RCC formulas Θ (α > 0) and let V be the set of variables occurring in Θ .Furthermore, let I(cid:17)be the (m; α, 0)-interpretation defined for v in V asIvThen I(cid:17)I(cid:17) = Rα↓↑vis a model of Θ .Proof. First note that for all fuzzy sets A and B in Rm, it holds thatCα( A, B) = Cα(Rα↓↑ A, Rα↓↑B)Since T W is a continuous operation, it holds that supi∈I T W (ai, b) = T W (supi∈I ai, b) for every family (ai)i∈Ievery b in [0, 1]. Together with (1), this yieldsin [0, 1] andCα(Rα↓↑ A, Rα↓↑B) = supp,q∈RmT W(cid:9)(cid:5)(cid:4)(Rα↓↑ A)(p), Rα(p, q), (Rα↓↑B)(q)(cid:5)(cid:4)(Rα↓↑ A)(p), Rα(p, q)(cid:10), (Rα↓↑B)(q)= supq∈Rm= supq∈Rm= supq∈RmT WT WT W= supq∈RmT WT Wsupp∈Rm(cid:4)(cid:5)(Rα↑↓↑ A)(q), (Rα↓↑B)(q)(cid:5)(cid:4)(Rα↑ A)(q), (Rα↓↑B)(q)(cid:9)(cid:4)(cid:5)Rα(p, q), A(p)T Wsupp∈Rm(cid:9)(cid:4)= supp∈Rm= supp∈Rm= supp∈RmT WT W(cid:4)T WA(p), supq∈Rm(cid:5)A(p), (Rα↑↓↑B)(p)T W(cid:4)(cid:5)A(p), (Rα↑B)(p)(cid:9)(cid:4)A(p), supq∈RmT WRα(p, q), B(q)(cid:5)(cid:10)T W= supp∈Rm= Cα( A, B)(cid:10), (Rα↓↑B)(q)(cid:5)(cid:10)Rα(p, q), (Rα↓↑B)(q)From (2), we immediately findO α( A, B) = O α(Rα↓↑ A, Rα↓↑B)P α( A, B) = P α(Rα↓↑ A, Rα↓↑B)Finally, from (1) and (2), we haveNTPα( A, B) = NTPα(Rα↓↑ A, Rα↓↑B)(cid:2)Lemma 17. Let H be an m-dimensional hypercube and α > 0. It holds thatRα↓↑H = HProof. From Lemma 2, we already knowRα↓↑H ⊇ HIf Rα↓↑H ⊃ H , there would be a p in Rm such that p ∈ Rα↓↑H but p /∈ H . From p /∈ H we derive that there is a q in Rmsuch that d(p, q) = α and d(q, h) > α for every h in H . However, since p ∈ Rα↓↑H we have q ∈ Rα↑H , or d(q, h) (cid:3) α forsome h in H , a contradiction. (cid:2)296S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298Lemma 18. Let α > 0, a < b, c < d and let H and G be the m-dimensional hypercubes associated with [a, b] and [c, d]. It holds that[a − α, b + α] ⊆ [c, d] ⇔ Rα↑H ⊆ GProof. First, we show[a − α, b + α] ⊆ [c, d] ⇒ Rα↑H ⊆ GAssume that [a − α, b + α] ⊆ [c, d] and that for some p = (p1, . . . , pm) in Rm, it holds that p ∈ Rα↑H . From p ∈ Rα↑H , weknow that for some h = (h1, . . . , hm) in H , it holds that d(p, h) (cid:3) α, and therefore |p1 − h1| (cid:3) α, implying p1 ∈ [a − α, b + α](cid:17) = (p1, 0, 0, . . . , 0). Furthermore, fromand in particular p1 ∈ [c, d]. From p ∈ Rα↑H we derive d(p, p[a − α, b + α] ⊆ [c, d], we have b−a+ α = b+α−(a−α)+ α, where p(cid:17)) (cid:3) b−a(cid:3) d−cThe implication in the opposite direction follows trivially from the fact that for every p in [a − α, b + α], it holds that(p, 0, 0, . . . , 0) is in Rα↑H and therefore in G, if Rα↑H ⊆ G, and that for every point in G, the first coordinate is in [c, d]. (cid:2)2 , which entails p ∈ G.222For an arbitrary α > 0, we know from the discussion above that Θ has an (1; α, 0)-model I in which each variable v. Moreover, this fuzzy set is characterized by kis mapped to a fuzzy set in R, taking only membership degrees from M 1α-level sets, which are all the union of a finite number of closed, non-degenerate intervals. In particular, let the iof vk -level setIkbe given by(cid:23)(cid:23)(cid:24)−i1, v+i1v∪−i2, v+i2v(cid:24)(cid:23)∪(cid:24)v−ini, v+niWithout loss of generality, we can assume that Rα↓↑vLemma 16, yielding Rα↓↑vI = vWe can now define an (m, α, 0)-interpretation I(cid:17)by (2).Ibership degrees from M 1kH i1∪ H i2∪ . . . , H iniand whose ik -level set is defined by the union of a finite number of m-dimensional hypercubesmapping the variable v to the fuzzy set in Rm which takes only mem-I = vI. Indeed, if this were not the case, we could transform I as inj is the hypercube associated with [v]. First, we show Cα(v, we know that there is a p and q in R such that d(p, q) (cid:3) α andI ) = Cα(vI , u−i j , v+i j, uI(cid:17)I(cid:17)). Since vwhere H imembership degrees from M 1kI (cid:5)(cid:4)(cid:4)IICαv, u= Tv(p), uI(cid:5)(q)II(cid:4)(cid:4)vT(p), uFrom Lemma 15, we know that there are p(cid:5)(cid:5))(q)(p), u(qI ) (cid:3) Cα(vWe also have the converse: there are p(cid:4)which already implies Cα(vI , u= TI(cid:17)(cid:17)I(cid:17)I(cid:17)v(cid:4)(cid:17)(cid:17)= TI(cid:17)v(cid:17)(p), uI(cid:17)(q(cid:17)(cid:5))CαvI(cid:17), uI(cid:17) (cid:5)(cid:17)(cid:17)and qin Rm such that d(p(cid:17), q(cid:17)) (cid:3) α andI(cid:17))., uand q(cid:17)in Rm satisfying d(p(cid:17), q(cid:17)) (cid:3) α andand by Lemma 15 we know that there are p and q in R satisfying (F.1). We can conclude(cid:4)CαvI, uI (cid:5)= Cα(cid:4)I(cid:17)v, uI(cid:17) (cid:5)IIand uonly take(F.1)(F.2)I(cid:17) = vI(cid:17)using Lemma 17. This leads toI = vNote that from Rα↓↑v(cid:4)= overl, uv(cid:4)IIO α(cid:4)I(cid:17)O αv, uI ) = O α(vI , uv(cid:4)= overlv, uI(cid:17), uI(cid:17)I(cid:17)I (cid:5)I(cid:17) (cid:5)I, we easily find Rα↓↑vI (cid:5)I(cid:17) (cid:5)and O α(v) follows from thefact that [a, b] ⊆ [c, d] iff H ⊆ G, where H and G are the associated hypercubes of [a, b] and [c, d] respectively. Finally,NTPα(v) follows in the same way as (F.2). Furthermore, P α(v) follows from Lemma 18.I ) = NTPα(vI , u, u, u, uI(cid:17)I(cid:17)I , uI ) = P α(vI(cid:17)I(cid:17)References[1] B. Bennett, What is a forest? On the vagueness of certain geographic concepts, Topoi 20 (2) (2001) 189–201.[2] T. Bittner, J. Stell, Vagueness and rough location, Geoinformatica 6 (2) (2002) 99–121.[3] U. Bodenhofer, A unified framework of opening and closure operators with respect to arbitrary fuzzy relations, Soft Computing 7 (4) (2003) 220–227.[4] E. Clementini, P. Di Felice, Approximate topological relations, International Journal of Approximate Reasoning 16 (2) (1997) 173–204.[5] A. Cohn, N. Gotts, The ‘egg–yolk’ representation of regions with indeterminate boundaries, in: P.A. Burrough, A.U. Frank (Eds.), Geographic Objects withIndeterminate Boundaries, Taylor and Francis Ltd., 1996.[6] M. Donnelly, T. Bittner, C. Rosse, A formal theory for spatial representations and reasoning in biomedical ontologies, ArtificialIntelligence inMedicine 36 (2006) 1–27.S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298297[7] S. Du, Q. Qin, Q. Wang, B. Li, Fuzzy description of topological relations I: a unified fuzzy 9-intersection model, in: Advances in Natural Computation,in: LNCS, vol. 3612, 2005.[8] S. Du, Q. Wang, Q. Qin, Y. Yang, Fuzzy description of topological relations II: computation methods and examples, in: Advances in Natural Computation,in: LNCS, vol. 3612, 2005.[9] D. Dubois, H. Fargier, H. Prade, Possibility theory in constraint satisfaction problems: handling priority, preference and uncertainty, Applied Intelli-gence 6 (1996) 287–309.[10] D. Dubois, P. Fortemps, Computing improved optimal solutions to max–min flexible constraint satisfaction problems, European Journal of OperationalResearch 118 (1999) 95–126.[11] D. Dubois, H. Prade, Fuzzy Sets and Systems: Theory and Applications, Academic Press, New York, 1980.[12] M. Egenhofer, R. Franzosa, Point-set topological spatial relations, International Journal of Geographical Information Systems 5 (2) (1991) 161–174.[13] M. Erwig, M. Schneider, Vague regions, in: Proceedings of the 5th International Symposium on Advances in Spatial Databases, 1997.[14] A. Esterline, G. Dozier, A. Homaifar, Fuzzy spatial reasoning, in: Proceedings of the 1997 International Fuzzy Systems Association Conference, 1997.[15] P. Fisher, Sorites paradox and vague geographies, Fuzzy Sets and Systems 113 (1) (2000) 7–18.[16] P. Gärdenfors, Conceptual Spaces: The Geometry of Thought, MIT Press, 2000.[17] P. Gärdenfors, M.-A. Williams, Reasoning about categories in conceptual spaces, in: Proceedings of the Fourteenth International Joint Conference onArtificial Intelligence, 2001.[18] Y. Gentilhomme, Les ensembles flous en linguistique, Cahiers de Linguistique Théorique et Appliquée 5 (1968) 47–65.[19] M. Goodchild, D. Montello, P. Fohl, J. Gottsegen, Fuzzy spatial queries in digital spatial data libraries, in: Proceedings of the IEEE World Congress onComputational Intelligence, 1998.[20] M. Grigni, D. Papadias, C. Papadimitriou, Topological inference, in: Proceedings of the 14th International Joint Conference on Artificial Intelligence,1995.[21] H. Guesgen, From the egg–yolk to the scrambled-egg theory, in: Proceedings of the 15th International FLAIRS Conference, 2002.[22] L. Hill, J. Frew, Q. Zheng, Geographic names: the implementation of a gazetteer in a georeferenced digital library, D-Lib Magazine 5 (1).[23] P. Jonsson, C. Bäckström, A unifying approach to temporal constraint reasoning, Artificial Intelligence 102 (1) (1998) 143–155.[24] N. Karmarkar, A new polynomial-time algorithm for linear programming, Combinatorica 4 (4) (1984) 373–395.[25] E. Klement, R. Mesiar, E. Pap, Triangular Norms, Kluwer Academic Publishers, 2002.[26] J. Kratochvíl, String graphs II: Recognizing string graphs is NP-hard, Journal of Combinatorial Theory, Series B 52 (1) (1991) 67–78.[27] L. Kulik, A geometric theory of vague boundaries based on supervaluation, in: Proceedings of the International Conference on Spatial InformationTheory: Foundations of Geographic Information Science, 2001.[28] S. Li, On topological consistency and realization, Constraints 11 (1) (2006) 31–51.[29] S. Li, M. Ying, Generalized region connection calculus, Artificial Intelligence 160 (1–2) (2004) 1–34.[30] Y. Li, S. Li, A fuzzy sets theoretic approach to approximate spatial reasoning, IEEE Transactions on Fuzzy Systems 12 (6) (2004) 745–754.[31] K. Liu, W. Shi, Computing the fuzzy topological relations of spatial objects based on induced fuzzy topology, International Journal of GeographicalInformation Science 20 (8) (2006) 857–883.[32] T.S.M. Vazirgiannis, Y. Theodoridis, Spatio-temporal composition and indexing for large multimedia applications, Multimedia Systems 6 (4) (1998)284–298.[33] D. Montello, M. Goodchild, J. Gottsegen, P. Fohl, Where’s downtown?: behavioral methods for determining referents of vague spatial queries, SpatialCognition and Computation 3 (2-3) (2003) 185–204.[34] B. Nebel, Computational properties of qualitative spatial reasoning: first results, in: Proceedings of the 19th German Conference on Artificial Intelli-gence, 1994.[35] V. Novák, I. Perfilieva, J. Moˇckoˇr, Mathematical Principles of Fuzzy Logic, Kluwer Academic Publishers, 1999.[36] E. Ovchinnikova, T. Wandmacher, K.-U. Kühnberger, Solving terminological inconsistency problems in ontology design, International Journal of Interop-erability in Business Information Systems 4 (2007) 65–80.[37] G. Palshikar, Fuzzy region connection calculus in finite discrete space domains, Applied Soft Computing 4 (2004) 13–23.[38] C. Ralha, J. Ralha, Intelligent mapping of hyperspace, in: Proceedings of the IEEE/WIC International Conference on Web Intelligence, 2003.[39] D. Randell, Z. Cui, A. Cohn, A spatial logic based on regions and connection, in: Proceedings of the 3rd International Conference on KnowledgeRepresentation and Reasoning, 1992.[40] J. Renz, Maximal tractable fragments of the Region Connection Calculus: A complete analysis, in: Proceedings of the 16th International Joint Conferenceon Artificial Intelligence, 1999.[41] J. Renz, A canonical model of the region connection calculus, Journal of Applied Non-Classical Logics 12 (3–4) (2002) 469–494.[42] J. Renz, B. Nebel, On the complexity of qualitative spatial reasoning: A maximal tractable fragment of the region connection calculus, Artificial Intelli-gence 108 (1–2) (1999) 69–123.[43] J. Renz, B. Nebel, Efficient methods for qualitative spatial reasoning, Journal of Artificial Intelligence Research 15 (2001) 289–318.[44] A. Roy, J. Stell, Spatial relations between indeterminate regions, International Journal of Approximate Reasoning 27 (3) (2001) 205–234.[45] M. Schaefer, E. Sedgwick, D. Stefankovic, Recognizing string graphs in NP, Journal of Computer and System Sciences 67 (2003) 365–380.[46] M. Schneider, A design of topological predicates for complex crisp and fuzzy regions, in: Proceedings of the 20th International Conference on Concep-tual Modeling, in: LNCS, vol. 2224, 2001.[47] S. Schockaert, Reasoning about fuzzy temporal and spatial information from the web, Ph.D. thesis, Ghent University, 2008.[48] S. Schockaert, M. De Cock, Neighborhood restrictions in geographic IR, in: Proceedings of the 30th Annual International ACM SIGIR Conference onResearch and Development in Information Retrieval, 2007.[49] S. Schockaert, M. De Cock, Reasoning about vague topological information, in: Proceedings of the ACM Conference on Information and KnowledgeManagement, 2007.[50] S. Schockaert, M. De Cock, C. Cornelis, E. Kerre, Fuzzy region connection calculus: an interpretation based on closeness, International Journal of Ap-proximate Reasoning 48 (2008) 332–347.[51] S. Schockaert, M. De Cock, C. Cornelis, E. Kerre, Fuzzy region connection calculus: representing vague topological information, International Journal ofApproximate Reasoning 48 (2008) 314–331.[52] S. Schulz, A. Kumar, T. Bittner, Biomedical ontologies: What part-of is and isn’t, Journal of Biomedical Informatics 39 (2006) 350–361.[53] B. Smith, W. Ceusters, B. Klagges, J. Köhler, A. Kumar, J. Lomax, C. Mungall, F. Neuhaus, A. Rector, C. Rosse, Relations in biomedical ontologies, GenomeBiology 6 (5) (2005) R46.[54] U. Straccia, Reasoning within fuzzy description logics, Journal of Artificial Intelligence Research 4 (2001) 137–166.[55] X. Tang, W. Kainz, Analysis of topological relations between fuzzy regions in a general fuzzy topological space, in: Proceedings of the Symposium onGeospatial Theory, Processing and Applications, 2002.[56] E. Turunen, Mathematics Behind Fuzzy Logic, Physica-Verlag Heidelberg, 1999.[57] A. Varzi, Vagueness in geography, Philosophy & Geography 4 (1) (2001) 49–65.298S. Schockaert et al. / Artificial Intelligence 173 (2009) 258–298[58] T. Waters, A. Evans, Tools for web-based GIS mapping of a “fuzzy” vernacular geography, in: Proceedings of the 7th International Conference onGeoComputation, 2003.[59] M. Worboys, E. Clementini, Integration of imperfect spatial information, Journal of Visual Languages and Computing 12 (2001) 61–80.[60] L. Zadeh, Fuzzy sets, Information and Control 8 (3) (1965) 338–353.[61] F. Zhan, Approximate analysis of binary topological relations between geographic regions with indeterminate boundaries, Soft Computing 2 (2) (1998)28–34.