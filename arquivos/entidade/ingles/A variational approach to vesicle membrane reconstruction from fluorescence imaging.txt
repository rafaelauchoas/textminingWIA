Pattern Recognition 00 (2011) 1–21Procedia ComputerScienceA Variational Approach to Vesicle Membrane Reconstructionfrom Fluorescence ImagingKalin Kolev1, Norbert Kirchgeßner2,5, Sebatian Houben2, Agnes Csisz´ar2,Wolfgang Rubner2, Christoph Palm4, Bj¨orn Eiben3, Rudolf Merkel2, Daniel Cremers1AbstractBiological applications like vesicle membrane analysis involve the precise segmentation of 3D structures in noisyvolumetric data, obtained by techniques like magnetic resonance imaging (MRI) or laser scanning microscopy (LSM).Dealing with such data is a challenging task and requires robust and accurate segmentation methods. In this article,we propose a novel energy model for 3D segmentation fusing various cues like regional intensity subdivision, edgealignment and orientation information. The uniqueness of the approach consists in the definition of a new anisotropicregularizer, which accounts for the unbalanced slicing of the measured volume data, and the generalization of anefficient numerical scheme for solving the arising minimization problem, based on linearization and fixed-point it-eration. We show how the proposed energy model can be optimized globally by making use of recent continuousconvex relaxation techniques. The accuracy and robustness of the presented approach are demonstrated by evaluatingit on multiple real data sets and comparing it to alternative segmentation methods based on level sets. Although theproposed model is designed with focus on the particular application at hand, it is general enough to be applied to avariety of different segmentation tasks.Keywords:3D segmentation, convex optimization, vesicle membrane analysis, fluorescence imaging.1. Introduction1.1. Model system for cell membrane deformation processesCellular membranes permanently sense their environment. They generate, stabilize or destabilize local regions ofmembrane curvature depending on changes of environmental conditions like temperature, ionic strength, and osmoticor mechanical stress [1]. To cope with environmental osmotic stress, prokaryotes have a wide repertoire of mech-anisms like ion pumping or accumulation of mechanosensitive proteins on the cell surface. For example, s-layersformed by two dimensional crystals of certain proteins on the surface of the membrane serve as structural osmopro-tectant proteins [2]. They increase the membrane rigidity under hyperosmotic conditions. Under these conditions the1Department of Computer Science, TU M¨unchen, Boltzmannstraße 3, 85748 Garching, Germany2Institute of Bio- and Nanosystems, IBN-4, Biomechanics, Forschungszentrum J¨ulich GmbH, 52425 J¨ulich, Germany3Institute of Neuroscience and Medicine (INM-1), Forschungszentrum J¨ulich GmbH, Germany4Department of Computer Science, Regensburg University of Applied Sciences, Regensburg, Germany5present address: Institute of Agricultural Sciences, ETH Zurich, LFW A4, Universittsstrasse 2, CH-8092 ZrichK. Kolev er al. / Pattern Recognition 00 (2011) 1–212Figure 1: a ) Streptavidin coated giant unilamellar vesicle under isoosmotic conditions and b ) under hyperosmotic conditions. In the latter case,the solute concentration outside of the vesicle was higher than in the vesicle lumen. To reduce this concentration difference, water flowed out of thevesicle, i. e. its volume decreased while its surface remained constant. Due to this excess surface after osmotic shrinkage, the vesicle underwentshape deformation and folding processes.rigid crystal layer resists higher mechanical stress and the cell membrane undergoes reversible weak surface wrin-kling inhibiting an irreversible membrane budding or fission. However, the importance of this mechanical protectionagainst osmotic stress compared to molecular signaling processes is not yet elucidated. The pressure range which canbe compensated just by mechanical osmoprotection is also unknown.Since the separation of the molecular signalling and the mechanical properties is difficult to realize in living cells,it is more promising to investigate model membrane systems. To mimic a rigid cell membrane under hyperosmoticpressures, Ratanabanangkoon et al. [3] and recently Csisz´ar et al. [4] used a model system consisting of phospholipidvesicles and a two-dimensional crystalline protein layer of streptavidin on the vesicle surfaces. Like cell membranes,the phospholipid molecules built spherically closed bilayers, while streptavidin simulated the role of surface proteinslike s-layers [2], spam [5] or COPI [6] (see Fig. 1). Under hyperosmotic conditions, the solute concentration outsideof the vesicle membrane was higher than in the vesicle lumen. To reduce this concentration difference, water streamedout of the vesicle and its volume decreased while its surface remained constant. Due to this excess of surface afterosmotic shrinkage, the vesicle underwent shape deformation and folding processes. The amount of deformationdepended on the material parameters of the vesicle shell. From the physical point of view, condensation of bendingand stretching energy in the folds of a crumpled surface structure depending on material parameters has been of highinterest [7]. Such deformation energies can be calculated from the 3-dimensional shape of the coated vesicle whenexposed to osmotic pressure [8].Among the major computational challenges regarding the understanding of these vesicle membrane deformationprocesses is therefore the precise and robust estimation of the vesicle membrane over time. To this end, one can relyon the fluorescence properties of materials as observed in volumetric image data, in our case collected by confocallaser scanning microscopy [9]. Since typical measurements are quite noisy (see Fig. 2) the reliable segmentation is amajor challenge.1.2. Variational Estimation of the Membrane ShapeInspired by recent advances in shape optimization [10, 11], we propose a novel variational approach for 3Dsegmentation which is aimed at exploiting the properties of fluorescence images obtained by confocal laser scanningmicroscopy of vesicle membranes. The model combines regional intensity subdivision, edge alignment and orientationinformation and can be globally minimized by means of convex relaxation techniques. Starting with a specified userinput in the form of roughly marked interior and exterior regions in one of the volume slices, corresponding intensityK. Kolev er al. / Pattern Recognition 00 (2011) 1–213slice 5slice 15slice 25slice 35slice 45Figure 2: Several slices of a typical volumetric data set, obtained by microscopic imaging of a fluorescently labeled vesicle membrane. Whileinterior and exterior regions exhibit similar intensity characteristics, the membrane surface is identified by bright areas due to its fluorescenceproperties.histograms are estimated and used to derive regional statistics. Secondly, the model encourages the extracted surfaceto pass through locations of high intensity with correspondingly high probability of the presence of the fluorescentvesicle membrane. And, thirdly, the proposed anisotropic formulation allows to impose local surface orientations toalign with the local image gradient. Due to the variety of considered image features and the robust regularizationscheme, the proposed approach enjoys remarkable resilience to noise and deviations from the primary assumptionswhich are frequently encountered in real environments. The contributions of the current work can be summarized asfollows:• We unify various established image cues like regional statistics, edge attraction and orientation information intoa continuous convex energy model.• We propose an anisotropic generalization of the classical isotropic minimal surface model, which accounts forthe sparse slicing of the measured volume data in the z-direction, e. g. inherent in confocal microscopy. Weshow that the generalized model retains convexity and thus all globality guarantees of its isotropic counterpart.• We adopt an efficient numerical scheme for solving the arising optimization problem, based on linearizationand fixed-point iteration.Although the proposed approach is designed with a focus on the particular application scenario of vesicle membraneestimation in fluorescence imaging, the proposed concepts are easily adapted to other segmentation tasks. Finally, thecurvature of the extracted surface is computed in order to facilitate further analysis of the membrane deformations.In the next section, we present and discuss related work. In Section 3 we introduce a variational model integratingregional intensity statistics, edge attraction and orientation fitting. Section 4 is devoted to the optimization of theproposed model. Section 5 briefly sketches an algorithm for estimating the curvature of the segmented surface, usedfor further analysis. In Section 6, we show experimental results on challenging real data sets, demonstrating the effectof each individual component of the energy on the quality of computed solutions and showing a clear superiority overlevel set based solutions. We conclude with a brief summary.2. Related WorkImage segmentation is one of the fundamental problems in Computer Vision and has been extensively studiedfor decades. Among the myriad of existing techniques variational methods prevail due to their accuracy, robustnessand mathematical elegance. Since the pioneering work of Kass et al. [12] considerable efforts have been made onexploring different energy models relying on various image cues. Three paradigms have proven to be particularlyuseful: regional statistics, edge terms and orientation information. In [13] the segmentation problem is posed in termsof a piecewise smooth or piecewise constant image approximation with minimal boundary length. This methodologyis generalized in [14] and [15], where regional intensity of color statistics are estimated to achieve an optimal regionassignment. The segmentation is obtained by alternatingly minimizing the underlying energy functional with respectto the contour and the parameters of the probability models. In [16] and [17] the region parameters are estimatedinteractively, which allows for globally optimal segmentations according to the specified user input. Although theK. Kolev er al. / Pattern Recognition 00 (2011) 1–214reliance on regional image criteria entails considerable robustness, it often results in imprecise or oversmoothedIn order to account for this drawback and increase the accuracy of the segmentation, researcherssegmentations.suggested edge terms attracting the curve (in 2D) or the surface (in 3D) towards the locations of sudden brightnesschanges that commonly arise at object boundaries. Geodesic active contours [18, 19] pose the segmentation problemas a weighted minimal surface model, where the weights reflect a local Riemannian metric based on the magnitude ofthe image gradient and therefore account for the presence of edges. While the incorporation of edge terms can resultin substantial improvements of object boundary alignment, it is still unable to handle thin or small-scale geometricdetails. To this end, Vasilevskiy and Siddiqi [20] demonstrated the potential of using orientation information tosegment narrow elongated structures like blood vessels. The curve (or surface) orientation is provided in the formof a dense vector field defined on the image domain. A typical choice for the normal field is the normalized orunnormalized image gradient. In this work, we propose a unified framework integrating regions, edges and orientationwith the goal of combining the advantages of all utilized paradigms to achieve robust and accurate 3D segmentationsregardless of the available geometric structure. Although the presented model is built upon established concepts, itdiffers from previous methods in their concrete realization. In particular, it relies on a novel anisotropic generalizationof the classical weighted minimal surface model and a new edge attraction term.It should be noted that there are some efforts to combine local and global shape retrieval criteria, e. g. [21] inthe context of image segmentation and [22] in the context of video interpolation. In contrast, the proposed modelcompletely relies on global image features. While the integration of local characteristics is straightforward, we didn’tfind it to be necessary for the particular application under consideration.Along with the underlying energy model, a crucial issue regarding the design of a segmentation approach is thechoice of contour/surface representation and the choice of optimization method. A simple and straightforward wayto represent the subdividing interface is as a set of line segments (in 2D) or triangles (in 3D), where the derivedevolution equations are applied to its vertices [12]. A major limitation of such explicit schemes is that numericalinstabilities can occur during the evolution process, especially in case of topological changes like merging or splitting.In order to address this weakness, level set methods have been proposed [23]. The key idea is to switch to an implicitrepresentation of the contour/surface by assigning each point within the domain a value that encodes its membershipto the interior or exterior region. Hence, the evolution of the subdividing interface is replaced by the evolution of animplicit function. Various energy models have been adopted to the level set framework including regional statistics[24], edge terms [18] and orientation integration via flux maximization [20]. Unfortunately, level sets are susceptible tolocal minima, which could result in unexpected and undesired segmentations. Since respective energies are generallynon-convex in the space of level set functions, solutions rely on an appropriate initialization and do not come withany optimality guarantee. In contrast, combinatorial methods like graph cuts [25, 26, 27, 28] do guarantee globaloptimality of the reconstruction. The key idea is to pose the segmentation problem as a mincut/maxflow problem of agraph reflecting the specific image content. Subsequently, the globally optimal solution (corresponding to the minimalcut) can be computed in polynomial time by determining the maximal flow in the corresponding graph. Unfortunately,the global minimum is obtained in a spatially discrete setting. As a consequence, respective solutions typically exhibitmetrication errors. In particular, it is not a trivial task to represent arbitrary surface orientations on a fixed grid and forthat reason relying on a discrete framework often leads to the introduction of an orientation bias in the shape retrievalprocess. Recent investigations led to the development of convex optimization techniques [10, 29], which combine theadvantages of spatially continuous formulations like the level set methods with the guaranteed optimality of spatiallydiscrete methods like graph cuts. A discussion of these differences with an experimental evaluation can be found in[30]. Yet, more research is needed to precisely specify the range of energy models amenable to continuous convexoptimization. The current work exhibits a step in this direction. In particular, we show that established concepts likeregional probability estimation, edge attraction and orientation integration can be unified in a single cost functionalthat can be optimized globally in a spatially continuous setting by means of convex relaxation techniques.3. Anisotropic Energy Model Integrating Regions, Edges and OrientationThis paragraph introduces the underlying energy functional accounting for various complementary informationsources encoded in the data. In particular, the proposed model imposes regional intensity subdivision, edge alignmentand orientation integration.K. Kolev er al. / Pattern Recognition 00 (2011) 1–215inputsliceforegroundregionbackgroundregionPob jPbgFigure 3: Regional subdivision via interactive user input. The user is required to roughly segment one of the slices of the volume data. Basedon the provided segmentation, foreground/background histograms are built, which are in turn used to assign intensity likelihoods to each voxelconditioned on being inside or outside the membrane surface. An example is illustrated for one of the slices in Fig. 2. Note that due to the noisyinput data and the similarity in the intensity characteristics of both regions, these likelihoods alone do not allow a reliable separation of object andbackground.We start with some notations. Let I : V ⊂ R3 → [0, 1] denote the measured volumetric data (see Fig. 2 for anexample). The goal is to partition the volume into two subsets by identifying the vesicle membrane surface S ⊂ V.ob j and the exterior one as RSWe will indicate the interior region according to a certain surface estimate S as RSbg,respectively.As previously mentioned, the user is required to specify a rough identification of both regions by marking them inone of the input volume slices (Fig. 3). This user input is used to build initial foreground/background histograms whichare adaptively refined during the evolution process. To this end, precise segmentation is not needed. Alternatively,strokes or scribbles specifying both regions could be provided. After smoothing and normalization derived histogramsare used to define probabilities Pob j, Pbg : V → [0, 1] for observing a certain intensity, given that the respective voxelis inside or outside the membrane surface. However, due to the noisy input data and the similarity in the intensitycharacteristics of both regions these intensity likelihoods do not permit a reliable separation of object and background.Based on the probabilistic volume subdivision a surface estimate is desired which separates voxels with high valuesfor Pob j and low values for Pbg from voxels with opposite property. Simultaneously, favorable shape characteristicslike smoothness should be imposed. These observations naturally lead to the following energy modelE(S ) = −µ(cid:90)RSob jlog Pob j(x) dx +(cid:90)RSbglog Pbg(x) dx(cid:90)+Sds,(1)where µ ∈ R≥0 is a parameter controlling the weighting of data term and regularization and ds denotes an Euclideanarea element. Here, for the sake of simplicity we assume a given parametrization of the surface S : Ω → R3. In thenext paragraph we will get rid of this assumption and switch over to an implicit representation. For a good surfaceestimate Pob j is expected to be close to 1 within the interior region RSob j and Pbg close to 1 within the exterior regionRSbg. Hence, the overall energy costs will be low. Analogously, for inaccurate estimates the corresponding probabilityvalues will generally vary, which after applying the logarithm would result in high data fidelity costs. In effect, mini-mization of the functional in (1) specifies a shape with the desired properties. Recall that both foreground/backgroundhistograms are updated permanently by reinitializing them with the voxel values within the current regions RSob j andRSbg. This adaptive procedure allows to adjust the histograms to the input data rather than relying on the specified userinput.Unfortunately, regional intensity statistics is not sufficient to achieve the required precision of the extracted surfacedue to the noise in the estimated probability maps (see Fig. 3). Yet, a closer inspection of the volume data reveals thatthe boundary of the interior region can be identified as areas, where the intensity changes from dark to bright. Thisrequirement can be imposed by encouraging the shape normal at each point to align with the local intensity gradient.Taking this into account we come up with the following energy modelE(S ) = −µ1(cid:90)RSob jlog Pob j(x) dx +(cid:90)RSbglog Pbg(x) dx− µ2(cid:90)S(cid:104)NS (s), ∇I(s)(cid:105) ds +(cid:90)Sds,(2)K. Kolev er al. / Pattern Recognition 00 (2011) 1–216Figure 4: Edge attraction function. Plotted is the proposed function g(z) = 12−)atan( z−β1β2πwith parameters β1 = 0.2 and β2 = 0.025.where NS denotes the (normalized) outward surface normal at s. Again, µ1, µ2 ∈ R≥0 are constant weighting parame-ters. The second term in (2), referred in the literature as flux [20], favors the alignment of the surface orientation withthe vector field defined by ∇I. In the ideal case when shape normals exactly coincide with the intensity gradient, thecorresponding costs will be negative and maximal in magnitude. On the other hand, surface normals pointing in theopposite direction will cause positive energy costs scaled by the respective deviation. It is important to note that abruptintensity changes in the input data, i. e. areas of high gradient, can be observed not only at the boundary betweenvesicle membrane and interior region but also at the boundary between membrane and exterior region. However, theestimated region statistics are additionally used to remove this ambiguity. In fact, regional information and flux areexploited as complementary cues. The balancing between them via the weighting parameters µ1 and µ2 should beestablished based on the confidence in both information sources in the particular situation.The energy model in (2) allows further extensions by exploiting the fact that the vesicle membrane can be identifiedin the input volume data by locations of relatively high intensity due to its fluorescence properties. A simple but veryeffective way to take this observation into account is to replace the Euclidean metric used by the regularization termin (2) by a more general Riemannian measure based on the local data content. This yields the following functionalE(S ) = −µ1(cid:90)RSob jlog Pob j(x) dx +(cid:90)RSbglog Pbg(x) dx− µ2(cid:90)S(cid:104)NS (s), ∇I(s)(cid:105) ds +(cid:90)Sg(I(s)) ds,(3)where g : [0, 1] → R≥0 is a non-negative, monotonically decreasing function. The new weighted minimal surfaceterm alleviates the smoothing and encourages the shape to pass through locations of low costs according to g. To thisend, the function should be monotonically decreasing in order to assign low costs to bright locations which vote forthe presence of membrane edges and to penalize dark regions specifying interior and exterior. Yet, this is not the onlyrequirement that should be followed when designing the function g. When conducting different measurements, theparticular intensity distribution of the volume data, including the brightness characteristics of the vesicle membrane,may vary. Hence, from a practical point of view it is preferable to provide the user with the flexibility to specify theparticular complexion of the weighting function g. We propose the following definitiong(z) := 12−atan( z−β1β2π),(4)where β1 ∈ [0, 1], β2 ∈ (0, 1] are constant parameters. The parameter β1 determines the location of the inflection pointof the function, while β2 controls the smoothness of the falling edge (see Fig. 4). In effect, the value of β1 indicatesthe lower limit of the range in which a pixel is categorized as “bright”. Large values will restrict the range and classifyonly high intensities as vesicle membrane. The parameter β2 can be interpreted as a kind of tolerance of the estimated00.10.20.30.40.50.60.70.80.9100.10.20.30.40.50.60.70.80.91zg(z)K. Kolev er al. / Pattern Recognition 00 (2011) 1–217input slicewithout edgeswithout fluxwithout anisotropyfull modelFigure 5: Contribution of different data features. Results of various energy models obtained by combining different cues applied to the 3D data setin Fig. 2. The segmentation is visualized for slice #38 and superimposed on the input data. Note that only the complete model (5) – shown on theright – yields tight and accurate segmentation results.intensity splitting. Large values will give a smooth function and will smear the boundary, while small values willsharpen the splitting.Although the energy functional in (3) incorporates a broad variety of data features, it still does not address onerelevant point. The applied scanning technique produces distorted volume data in a sense that the spacing in differentdirections is not equal. In fact, the resolution and, as a consequence the sampling in the z-direction is significantlycoarser than along the other two spatial dimensions. As a consequence, the isotropic weighted minimal surface term(cid:82)S g(I(s)) ds, which imposes the shape regularity, treats the slicing direction with the same priority as the other two,which leads to a different amount of smoothing due to the unequal spacing. Hence, different scaling is needed alongthis particular direction, which is achieved by the following anisotropic generalization(cid:90)RSob jlog Pob j(x) dx +(cid:113)g(I(s))NTS (s)D(s)NS (s) dsE(S ) = −µ1+(cid:90)S(cid:111)log Pbg(x) dx(cid:90)RSbg(cid:90)− µ2(cid:104)NS (s), ∇I(s)(cid:105) dsS(5)(cid:110)D(x) ∈ R3×3 | x ∈ Vwheredenotes a family of positive semidefinite symmetric tensors tolerating certain directionalselectivity. In addition to encouraging the surface to pass through preselected locations according to the edge map g,the anisotropic energy model favors certain shape orientations while suppressing others. This can be achieved with theappropriate design of the tensors D(x). Note that D is defined pointwise. However, in the remainder of this paragraphS (s)D(s)NS (s) ds can still be interpretedwe will omit the argument for the sake of simplicity. The termas a minimal surface formulation according to the metric induced by D ( i. e. ||v||D =vT Dv ). The isotropic metricused in (3) appears as a special case with D = I, where I ∈ R3×3 denotes the identity matrix. Our intention is to defineD in a way that allows for different scaling in the z-direction. This can be achieved by settingS g(I(s))NT(cid:113)√(cid:82)D :=100,00010 γ(6)where γ ∈ [0, 1] is a constant parameter. Ideally, γ should be set to the squared ratio between the sampling in thez-direction and the x/y-direction, respectively. Note again that for γ = 1 we obtain the original isotropic model.Now, the final model defined in (5) contains all constructs necessary to achieve our primary goal. The relevanceof the various features used in the model depends on the particular input data.In cases, where one of the cuesprevails, the corresponding energy term will play a dominant role, which should be reflected by an adequate parametersetting. However, in a typical practical situation all utilized paradigms will have a certain contribution to the finalsegmentation result. An example demonstrating the contribution of the different data features is illustrated in Fig. 5.Superimposed segmentation results for one of the slices with different models, obtained by omitting one of the cues,are visualized. The regional terms alone, which are based on the specified user input, are not sufficient to produceaccurate segmentations, even in combination with a flux term. This is due to the blurred membrane measurementsK. Kolev er al. / Pattern Recognition 00 (2011) 1–218resulting in high intensity characteristics in the vicinity of the surface (see Fig. 3). Note that a more accurate userinput will not drastically improve the segmentations, since more bright pixels will enter the foreground histogram anddiminish the discriminative power of the regional terms. Substantial increase of the accuracy of segmentation can beobserved by adding the edge attraction term to the model. Yet, the absence of a flux term is still noticeable, especiallyat small-scale contour structures. Finally, the effect of the anisotropic generalization is investigated by comparing it tothe original isotropic model (i. e. for γ = 1). As expected, the isotropic regularizer produces significant oversmoothingat areas of abrupt slice-to-slice changes. This can be suppressed by reducing the overall regularization but only at thecost of degrading the contour alignment along the slice-plane. In summary, regional terms and edge term seem to bedecisive for the overall quality of the segmentation results but the flux term and the anisotropic scaling also contributesignificantly to the precision of the estimated boundary.4. Variational Minimization via Partial Differential EquationsThis paragraph deals with the minimization of the energy functional proposed in (5). Here, we focus on continuousoptimization methods due to their numerical accuracy, memory efficiency and parallelizability. We refer to [30] for adetailed comparison to discrete approaches.First, we observe that the flux term in (5) can be rewritten as a regional term over the surface interior via thedivergence theorem. Now, we end up with the following energy functional, equivalent to (5)E(S ) = −(cid:90)+(cid:90)RSob jg(I(s))S(cid:17)(cid:16)µ1 log Pob j(x) + µ2 ∆I(x)dx − µ1(cid:113)NTS (s)D(s)NS (s) ds.(cid:90)RSbglog Pbg(x) dx(7)Note that div(∇I) = ∆I. Basically, the above formulation states that a flux term can be incorporated by adequatelyadopting the interior region statistics. This observation will considerably facilitate further optimization.4.1. Solution I: Minimization by Level SetsThe level set method [31, 23] is an established technique for minimizing energy functionals for shape estimationlike (7). The key idea is to represent the surface implicitly by a function φ : V → R, whose values reflect the signeddistance from it, where negative values indicate the interior region and non-negative values - the exterior, respectively.The formulation proposed in this section is based on the framework of [24]. Note, however, that the model in (7)surpasses the one in [24] in its completeness. In particular, the anisotropic regularization scheme poses the mainchallenge when developing a valid generalization.The construction of an implicit surface representation implies that both interior/exterior regions can easily beaccessed by means of the Heaviside functionH(z) =(cid:40)1,0,if z ≥ 0otherwise.(8)In the level set framework a surface deformation equation is converted to an evolution equation with respect to theimplicit function φ. Hence, topological changes are handled automatically without additional efforts. By means of theHeaviside function, we can rewrite the functional in (7) as a functional over the set of implicit functions, which yieldsE(φ) = −(cid:90)(cid:16)Vµ1 log Pob j(x) + µ2 ∆I(x)(cid:17)(1 − (H ◦ φ)(x)) dx − µ1log Pbg(x)(H ◦ φ)(x) dxV(cid:90)+(cid:90)V(cid:112)g(I(x))∇(H ◦ φ)(x)T D(x)∇(H ◦ φ)(x) dx.(9)The terms 1 − (H ◦ φ)(x) and (H ◦ φ)(x) in the above formulation act as filtering functions by specifying interior andexterior voxels, respectively. Note that the composite function H ◦ φ is a binary labeling function identifying bothregions. More precisely H ◦ φ ≡ 1RSdenotes the indicator function of the exterior region. Note also therelations NS (x) = ∇(H◦φ)(x)||∇(H◦φ)(x)|| and ds = ||∇(H ◦ φ)(x)|| dx which give rise to the last term in (9)., where 1RSbgbgK. Kolev er al. / Pattern Recognition 00 (2011) 1–219The first step towards minimizing the functional in (9) is to compute its Euler-Lagrange equations. We obtain (theargument x is omitted for simplicity)(cid:16)µ1 log Pob j + µ2 ∆I − µ1 log Pbg(cid:17) + δ(cid:48)(φ)g(I)(cid:112)∇φT D∇φ∂E∂φ= δ(φ)− div= δ(φ)D∇φδ(φ)g(I)∇φT D∇φµ1 log Pob j + µ2 ∆I − µ1 log Pbg(cid:112)(cid:16)− δ(cid:48)(φ)g(I)∇φT D∇φ(cid:112)∇φT D∇φ− δ(φ)divg(I)(cid:112)(cid:16)= δ(φ)µ1 log Pob j + µ2 ∆I − µ1 log Pbg(cid:17)− δ(φ)div(cid:17) + δ(cid:48)(φ)g(I)D∇φ∇φT D∇φg(I)D∇φ∇φT D∇φ(cid:112) .(cid:112)∇φT D∇φ(10)Thereby, δ(.), which denotes the Dirac delta function, appears as the derivative of the Heaviside function, i. e. δ(z) =H(cid:48)(z).It is not surprising that all terms in the above expression are scaled by δ(φ), since only the 0-level of φrepresenting the surface is of interest. In practice, δ(φ) is replaced by a smoothed version δ(cid:15)(φ) for numerical reasons.The functional in (9) can be minimized via gradient descent by solving the following partial differential equation(PDE)φt = −∂E∂φ.(11)The above equation describes an evolution process with respect to an artificial time variable t. Updating the implicitfunction φ accordingly gradually decreases the energy and leads to a (local) minimum of the functional, identified asa steady state of (11). Numerically, the above equation can be solved by applying classical discretization schemes likethe forward Euler method. It should be noted that after each update, φ will no longer reflect the exact distance to thesurface. For that reason, the function should permanently be reinitialized in order to circumvent numerical difficulties.Although the level set method leads to a tractable numerical scheme and avoids the need for explicit handling oftopological changes, it suffers from one important limitation. Due to the binary nature of the representation, whereasthe localization of the surface is implicitly encoded by the sign of a distance map φ, this technique always involvesoptimization over a set of binary labeling configurations. As a consequence, due to the minimization over a non-convex domain any iterative procedure can get stuck in an undesired local minimum that may be far from the expectedsolution. In effect, the final result strongly depends on the initialization. This issue will be discussed in more detail inthe next section.4.2. Solution II: Minimization by Convex RelaxationIn [10] it has been proven that a simple generalization of the level set method based on convex relaxation allows forglobal optimization in certain cases. We build upon this work and show that the class of energy functionals amenableto convex relaxation techniques can be extended to include our primary model given in (5).First, we observe that the implicit function φ in (9) always appears in concatenation with the binary Heavisidefunction H. Hence, an equivalent formulation can be obtained by replacing u := H ◦ φ. This leads to the followingminimization problemE(u) = −(cid:90)+(cid:90)(cid:16)Vµ1 log Pob j(x) + µ2 ∆I(x)(cid:17)(1 − u(x)) dx − µ1(cid:90)Vlog Pbg(x)u(x) dx(cid:112)g(I(x))∇u(x)T D(x)∇u(x) dx → min,(12)Vs. t. u : V → {0, 1} .Now, one can notice that the above functional is convex. The convexity of the first two terms follows trivially fromtheir linearity. The last anisotropic regularization term is also convex, since it represents the weighted total variationK. Kolev er al. / Pattern Recognition 00 (2011) 1–2110of u in the norm induced by g and D. However, the minimization is carried out over the set of all binary labelingfunctions which is not convex. As a result, we have a constrained non-convex optimization problem and obtaining anexact solution is not straightforward. A simple and effective remedy to this problem is to relax the domain of feasiblefunctions and to allow also intermediate values in the interval [0, 1]. Thus, we obtain a more tractable constrainedconvex optimization problemE(u) = −(cid:90)+(cid:90)(cid:16)Vµ1 log Pob j(x) + µ2 ∆I(x)(cid:17)(1 − u(x)) dx − µ1(cid:90)Vlog Pbg(x)u(x) dx(cid:112)g(I(x))∇u(x)T D(x)∇u(x) dx → min,(13)Vs. t. u : V → [0, 1] .Now, we have a convex functional, optimized over a convex domain. Hence, a global minimum can be obtained byany iterative local optimization procedure like gradient descent. However, recall that we are interested in solving theoriginal “binary” problem (12). Similar to [10], we can infer that thresholding the solution of (13) will give us a globalminimum of (12) due to favorable properties of the particular variational model at hand. In [10] this has been shownonly for a certain class of functionals including regional subdivision terms and weighted isotropic regularization.In a recent work [32] it has been proven that the thresholding property is still fulfilled when the minimal surfaceformulation is generalized to anisotropic Finsler metrics. Building upon these works we state the following theorem:Theorem 1. If u∗ : V → [0, 1] is a minimizer of the functional in (13), then for almost any threshold ν ∈ (0, 1) thebinary function 1Σν,u∗ (x) : V → {0, 1} with Σν,u := {x | u(x) > ν} is also a (global) minimizer of (13).Proof. The proof is given in the Appendix.Any thresholded (global) minimizer of (13) is binary and fulfills the constraints in (12). Trivially, it is also a globalsolution of the non-convex optimization problem in (12), since the set of binary labeling functions is a subset of thedomain of relaxed functions.In summary, we obtain the following approach for globally optimizing (12):1. Find a minimizer urel of (13).2. Threshold the result ubin(x) =(cid:40)1,0,if urel(x) > νotherwiseto obtain a minimizer of (12).In our experiments we chose ν = 0.5 but we obtained virtually the same results with ν ∈ [0.1, 0.9].We have seen that solving the non-convex problem (12) globally reduces to solving a more tractable convexproblem (13). As mentioned previously, due to the convexity the applied optimization procedure will not affect thefinal result but only the speed of convergence. Here, we propose a generalization of a fixed-point iteration schemebased on Successive Overrelaxation (SOR). Similar techniques have been successfully applied for solving relatedproblems like image denoising [33] and multiview 3D reconstruction [11]. The first step is to set up the Euler-Lagrangeequation which states a necessary condition for a minimum of (13) (the argument x is omitted for simplicity):0 = µ1(cid:16)log Pob j − log Pbg(cid:17) + µ2∆I − div(cid:32)g(I)√(cid:33).D∇u∇uT D∇u(14)The key idea is to solve the above equation directly instead of deriving an evolution PDE like (11). Yet, (14) exhibitsa non-linear differential equation which is not trivial to be solved directly. The source of non-linearity is given bythe diffusivity ρ :=. Thus, a straightforward way to address this difficulty is to apply a linearization scheme.Starting with an initialization u0 = 0.5, we can compute ρ and keep it constant. For constant ρ, (14) is linear and spatialdiscretization yields a sparse linear system of equations which can be solved efficiently with iterative approaches likeSOR. This means, we iteratively compute the k-th update of u at voxel i byg(I)∇uT D∇u√ul,k+1i= (1 − ω)ul,ki+ ωj(cid:80)i∼ jul,k+1ρlj∈N(i), j<i(cid:80)j∈N(i)+ (cid:80)i∼ jul,kρlj∈N(i), j>iρli∼ jj − di,(15)K. Kolev er al. / Pattern Recognition 00 (2011) 1–2111where ω ∈ (0, 2) is a fixed relaxation parameter. Thereby, the index l counts the updates in the diffusivity terms, N(i)(cid:17) + µ2∆Ii summarizes the constant part of (14) thatdenotes the 6-neighborhood of i and di := µ1i∼ j denotes the diffusivity between voxeldoes not depend on u, i. e. the righthand side of the linear system. Finally, ρli and its neighbor j while distinguishing between different spatial directions according to the anisotropic tensor D. Itis defined aslog Pob j,i − log Pbg,i(cid:16)ρli∼ j=γρliρli+ ρlj2+ ρlj2,,if voxels i and j are neighbors in the z-direction(16)otherwise.Thus, diffusivities between neighboring voxels are estimated by averaging the corresponding values, which are in turncomputed asi :=ρl(cid:113)g(I)ii D∇uli∇ul T,+ (cid:15)2(17)where (cid:15) := 0.001 is a small constant that prevents the diffusivity to become infinite when ∇ul T= 0 and ∇uliis approximated by standard central differences. The over-relaxation parameter ω has to be chosen in the interval(0, 2) for the method to converge. The optimal value depends on the linear system to be solved. Empirically, for thesystem at hand we obtained the fastest convergence rate for ω = 1.85. Recall that for ω = 1 the SOR method isequivalent to the Gauss-Seidel method. After the linear solver yields a sufficiently good approximation (we iteratedfor k = 1, ..., 10), one can update the diffusivities ρli and solve the next linear system. Iterations are stopped as soon asthe energy decay in one iteration is in the range of number precision.i D∇uli5. Curvature EstimationFor further processing steps we extracted the surface of the segmented volume data to a Delaunay-like triangulationusing the CGAL library [34]. This enabled us to easily estimate the volume and the surface area of the vesicle andadditionally to exclude segmented regions that were not connected to the main vesicle.To estimate the curvature on the vesicle surface we used a method proposed by Rusinkiewicz [35] which provedboth stable and accurate. This procedure works on triangulations of arbitrary vertex distributions and topology fol-lowing a finite-differences approach to approximate the second fundamental tensor of every facet, a 2 × 2 matrix inour case. Recall that the eigenvalues of the second fundamental tensor can be used to derive the mean and Gaussiancurvature. To get a vertex-wise curvature measure the fundamental tensors of all aligning facets are averaged by aweight considering the Voronoi area of each vertex, i. e. the area of each facet that lies closest to the vertex.To receive the normal vectors for the finite-differences approach we used the gradient of the segmented volumeachieving stability by both the smooth triangulation and the continuity of the volume gradients.6. ExperimentsThis paragraph presents an experimental validation of the proposed approach. Since the segmentation methodwas developed with focus on a particular application, we give some details on the data acquisition process beforedemonstrating its performance on generated real-world data sets.6.1. Experimental Setup6.1.1. MaterialsTo mimic mechanical properties of cell membranes, 1,2-dioleoyl-sn-glycero-3- phosphocholine (DOPC) was cho-sen as main lipid component. The addition of 1,2-dipalmitoyl-sn-glycero-3-phosphoethanolamine-N-(cap Biotinyl)(capBioDPPE) gave rise to a drastically increased rigidity of the coupling of streptavidin to the lipid membrane.Lipid components were dissolved in chloroform and mixed to 1 mg/ml total lipid concentration in a molar ratio ofDOPC/capBioDPPE = 10/1. All lipids were purchased from Avanti Polar Lipids Inc. (AL, USA) in a purity of atleast 99.9%.K. Kolev er al. / Pattern Recognition 00 (2011) 1–2112Figure 6: Experimental setup. Dialysis through flow chamber for fluorescence microscopy observation of vesicle folding under continuouslyincreasing hyperosmotic pressures was used. Vesicles were deposited in the lower chamber in glucose solution with a concentration of clow. Thischamber part was separated from the upper one by a semi-permeable membrane, which allowed a water flow and simultaneously excluded anyother transport between the two chamber parts. The upper chamber had a constantly higher glucose concentration (cupp) than the lower chamber.The concentration difference was reduced by water flow from the lower chamber (see small arrows), including vesicle volumes, into the upperchamber. The changed osmolarity induced vesicle volume loss at constant surface area thereby giving rise to vesicle folding. The process wasobserved by a laser scanning microscope.6.1.2. Vesicle preparationVesicles were prepared by the electroswelling technique [36]. 10 µl of the lipid mixture were carefully depositedon indium tin oxide (ITO) coated glass slides (Praezisionsglas & Optik GmbH, Iserlohn, Germany). The lipid filmswere then dried under vacuum for at least 1 h. For the electroswelling step, the plates were placed in a chambercontaining 2 ml of 130 mM sucrose solution (130 mosm/L) in pure water and separated by a 1 mm teflon spacer.Vesicles were swollen by applying an altering electric field of 1.5 V and 10 Hz for 2 h. After electroswelling, vesicleswere incubated in 70 µg/ml protein solution for at least 2 h at pH 5.5 under isoosmotic conditions.6.1.3. Experimental environmentIncreasing osmotic pressure was generated in a special microscopic chamber designed for experiments usinggradual osmotic pressure change (see Fig. 6). It consisted of two parts. The lower chamber part was filled with 2ml of 130 mM glucose solution (130 mosm/L) and 50 µl of isoosmotic vesicles suspension. To visualize the modelmembranes in fluorescence microscopy, fluorescently labeled polymer (dextran-TRITC from Sigma Aldrich Inc., St.Louis, MO, USA) was added to the glucose solution in a final concentration of 1 µg/ml while the vesicle lumenremained unlabeled. The fluorescently labeled polymer was uniformly dispersed in the glucose solution emitting lowbackground intensity, which was bleached during the experiments. Streptavidin coated vesicle membranes are slightlynegatively charged at pH 5.5. The electrostatical interaction between protein coating and fluorescently labeled polymerresulted in enrichment of polymer molecules on the protein surface increasing the fluorescence intensity on the vesiclemembranes. This process occurred until the accumulation of polymers on the vesicle surfaces was saturated. As lipidbilayers were impermeable to polymers, vesicle lumens remained completely without fluorescent and appeared darkin the fluorescent channel, correspondingly.The upper chamber part was a flow chamber. Isoosmolar glucose solution streamed through it with a flow rateof approximately 20 mL/min. The two parts were separated and simultaneously contacted with each other by asemi-permeable membrane (Reichelt Chemietechnik GmbH Co, Heidelberg, Germany). This membrane enabled thediffusion of water molecules between the two chamber parts simultaneously but retained the other dissolved compo-nents. Under isoosmotic conditions (cupp = clow), the two sides were equilibrated. Subsequently, high concentratedglucose solution (400 mosm/L) flowed through the upper chamber part (cupp (cid:29) clow) disturbing the equilibrium state.K. Kolev er al. / Pattern Recognition 00 (2011) 1–2113segmentation of original datasegmentation of interpolated dataFigure 7: Data set #1, vesicle under isoosmotic conditions. First row: Segmentation of raw microscopic data. Second row: Segmentation ofinterpolated data. From left to right: Superimposed segmentation for one of the volume slices, rendered view of the extracted shape, cross-sectionsthrough the volume with superimposed wireframe segmentation result and color-coded curvature of the surface [µm−1]. The figure is best viewed incolor. This experiment demonstrates that upsampling the resolution in the z-direction does not improve the segmentation result, but rather increasesthe computation time by about a factor of 4.To compensate the new concentration difference between the two sides, water flowed from the lower chamber into theupper flow-chamber until the equilibrium state was reached again. Consequently, the osmolarity in the lower chamberwas continuously changed by 0 to 140 mosm/L in 1.5 h. The osmolarities of glucose and vesicle solutions weredetermined using a freezing point depression osmometer (Osmomat 030, Gonotec, Berlin, Germany).6.1.4. Microscopic ImagingThree dimensional membrane curvatures of streptavidin coated giant vesicles were imaged with a laser scanningmicroscope (LSM 510, Carl Zeiss MicroImaging GmbH, Jena, Germany) equipped with a helium-neon laser (543nm). To detect the fluorescent signal of dextran-TRITC, a long pass filter LP600 nm was used. The microscope wasfocused on the vesicles using a C-Apochromate 40 × /1.20 water immersion objective (Carl Zeiss). Images wererecorded with a typical resolution of 512 × 512 pixels in x-y-plane (pixel size 154 nm) and 60 slices in the z-direction(pixel size 390 nm).6.2. Evaluation on Real Data SetsWe demonstrate the performance of the proposed approach on four challenging real data sets generated with thedescribed laser scanning methodology. Additionally, we present a comparison to alternative segmentation techniquesbased on level sets.6.2.1. PerformanceThe data sets used in our experiments and the corresponding segmentation results are illustrated in Fig. 7, 8, 9 and10. The data sets, acquired under different osmotic pressures, capture various deformations of the imaged vesicle. TheK. Kolev er al. / Pattern Recognition 00 (2011) 1–2114segmentation of original dataFigure 8: Data set #2. See text in Fig. 7 for reference. The slight differences in the reconstruction are most likely due to ghosting artefactsintroduced in the interpolation process.segmentation of interpolated datasegmentation of original datasegmentation of interpolated dataFigure 9: Data set #3. See text in Fig. 7 for reference. Again the interpolation gives rise to ghosting artefacts.K. Kolev er al. / Pattern Recognition 00 (2011) 1–2115segmentation of original datasegmentation of interpolated dataFigure 10: Data set #4. See text in Fig. 7 for reference.cross-sectioninput sliceregional mapmodel-basedregional mapproposededge mapproposedFigure 11: Comparison of the data terms utilized by the model-based approach in [37] and the presented method for slice 104 of the interpolatedversion of data set #4 (see Fig. 10). Although the proposed regional term exhibits lower separability of object and background than the model-basedone, it offers higher precision due to the underlying global scheme and the integration of shape orientation. Note that the model-based approachdoesn’t use explicit edge information in contrast to the proposed one. See Fig. 12 for comparison of the segmentation results.γresolutionβ1β2µ1data set267 × 274 × 59 10−40.2 0.025 0.05#1 orig.#1 interp. 267 × 274 × 256 10−40.2 0.025 1.0258 × 257 × 56 10−40.2 0.025 0.05#2 orig.#2 interp. 258 × 257 × 243 10−40.2 0.025 1.01.0 10−6 0.05345 × 342 × 80 10−4#3 orig.1.0 10−6#3 interp. 345 × 342 × 305 10−41.0283 × 275 × 60 10−4 3 · 10−4 0.2 0.025 0.05#4 orig.#4 interp. 283 × 275 × 205 10−4 3 · 10−4 0.2 0.025 1.0µ210−410−410−410−410−410−4Table 1: Parameter setting of the proposed approach for all demonstrated experiments.K. Kolev er al. / Pattern Recognition 00 (2011) 1–2116superimposed segmentation for one representative slicevolume cross-sections and superimposed segmentationcolor-coded curvatureFigure 12: Comparison between the proposed approach and alternative segmentation techniques based on level sets. First row: Segmentation forone of the volume slices. Second row: Cross-sections through the volume with superimposed wireframe segmentation result. Third row: Color-coded curvature of the surface. From left to right: A variant of the model-based approach in [37], a level set implementation of the proposed energymodel, as described in Section 4.1, by using a box-shaped and spherical initialization, respectively, and convex relaxation, as described in Section4.2. Note that while the formulation in [37] involves only local data term estimation and requires a specific initialization, the presented method isgeneral and based on global computations.figures depict a superimposed segmentation for one of the volume slices, rendered view of the extracted 3D shape,cross-sections through the volume with superimposed wireframe segmentation result and color-coded curvature ofthe surface. In some cases intensity variations within the membrane regions caused high gradients, which lead toundesired structures within the membrane. We could overcome this problem by limiting the gray values to an adequaterange. For all test cases we show segmentation results for both the original raw volumetric data as obtained with thedescribed laser scanning microscopy technique and an interpolated version of the data on an approximate cubic grid.The parameter setting used in our experiments is specified in Table 1. As can be expected, the anisotropy parameterγ has been adapted appropriately so as to compensate for the sparse volume slicing in the z-direction of the originalraw data. Yet, none of the other parameters has been changed. This allows to assess the effect of the interpolationprocess on the quality of the segmentation results. As can be observed, in both cases the segmentations are quiteaccurate (see the selected slices). However, they possess different degrees of smoothness, which is confirmed by thecurvature measurements. This phenomenon can be explained with the appearance of small-scale ghost structures inthe interpolation process. As for the runtimes, on a PC with 2.83 GHz and 8 GB of main memory we measuredcomputational times in the range 10 − 15 minutes for the original raw data sets and in the range 40 − 60 minutes forthe interpolated data sets.The demonstrated experiments cover a wide range of test scenarios. While some of the data sets (#1 and #3) exhibitlittle deformation of the imaged vesicle membrane, others (#2 and #4) capture substantial bending and stretching.Furthermore, data set #3 is characterized by completely missing edge information, whereas data set #4 features lackingK. Kolev er al. / Pattern Recognition 00 (2011) 1–2117foreground/background intensity discrimination. The remarkable accuracy of all segmentation results emphasizes thehigh practical value of the proposed approach.6.2.2. Comparison to Alternative ApproachesIn order to demonstrate the accuracy and robustness of the proposed approach, we present a twofold comparativeevaluation (see Fig. 12). Firstly, we explore the viability of the energy model by comparing it to a state-of-the-artmethod. In particular, we implemented a variant of [37] tailored to the application at hand. Secondly, we compare animplementation of the proposed energy model with level sets, as described in Section 4.1, and convex relaxation, asdescribed in Section 4.2.Next, we will briefly overview the approach in [37]. Similar to the proposed formulation, it is based on a variationalframework. Concretely, the following energy functional is being minimized:(cid:90)E(u) =S (u) u(x) dx +(cid:90)|∇u(x)| dxVs. t. u : V → {0, 1} ,Vwhere the speed function S : V → R is defined as followsS (x) := ImaxImin− T.(18)(19)Thereby, the function is evaluated only in a tight vicinity around the evolving interface by considering lines of certainlength along its local normals. In practice, S is updated only on the surface and at voxels in direct contact with it.Imax and Imin denote the maximum and minimum intensity along the current line. T ∈ R≥0 is a parameter specifiedby the user, that controls the desired intensity contrast and is used to stop the evolution process. Note that due to itsgreedy nature the described procedure requires a specific initialization. It relies on the assumption that the surface canbe identified by locations of high edge contrast, while the propagation scheme is initialized within a homogeneousregion. Usually, the initial estimate is placed within the object interior and evolved outwards until the speed functionreaches values close to zero. In our implementation, the initialization was fixed to a sphere centered in the middle ofthe volume with radius 10 voxels. Although the above method is able to handle data of weak foreground/backgrounddiscrimination effortlessly, its precision may suffer. The utilized local update procedure could lead to prematuretermination and oversmoothing effects (see Fig. 12).In the following, we summarize the main conceptual differences between the approach in [37] and the proposedone. They are revealed by a direct comparison between both variational models, given in (12) and (18).• While the method in [37] uses a regional term based on the local intensity contrast, the proposed formulationrelies on a more sophisticated computation involving foreground/background distribution modeling and surfaceorientation alignment. As a result, the estimated regional map is imprecise, susceptible to noise and only locallydefined in the first case and offers a global range and a high degree of accuracy in the latter case, see Fig. 11.It is important to note that while the model-based approach in [37] requires a specific initialization due to thelocal nature of its evolution scheme, the proposed model is global and does not depend on initialization.• The method in [37] relies on a classical Euclidean regularizer to impose smoothness of the surface. In contrast,the proposed model uses explicit edge information to avoid oversmoothing effects and increase the accuracy ofthe segmentation results. See Fig. 11 for an example edge map.• We even take a further step and develop an anisotropic generalization which allows to adequately guide thesmoothing along particular directions, taking into account the density of the slicing produced by the utilizedimaging technology. As a consequence, the proposed approach can be applied to the measured raw volume datawithout any modifications, while the model in [37] is restricted to cubic voxels and requires interpolation as apreprocessing step.• While [37] is based on the level set framework to solve the underlying minimization problem, we propose theuse of convex relaxation which allows for global optimization. However, this is not a crucial issue for themethod in [37], since only local data term updates are performed.K. Kolev er al. / Pattern Recognition 00 (2011) 1–2118Figure 13: Quantitative evaluation of the segmentation results in Fig. 12. The accuracy of the computed segmentations is measured in terms oftheir deviation from a manually obtained ground truth for a couple of representative slices. Note that the proposed model optimized with level setsexhibits a quite jumpy behavior due to the local minimization scheme in combination with the globally estimated data terms. Yet, the proposedapproach based on convex optimization proves superior to all other methods.Fig. 12 compares the segmentations obtained with both methods on data set #4. We used this data, since it seemsto exhibit the most challenging scenario due to the lack of foreground/background intensity discrimination. It can beobserved that the method in [37] gives a relatively good segmentation result for this challenging data set, although it isa portent of a clear shrinking bias limiting the precise localization of the vesicle membrane. In contrast, the proposedapproach demonstrates clear superiority and provides a quite accurate segmentation.In order to emphasize the importance of a robust optimization scheme, we compare an implementation of theproposed energy model with level sets, as described in Section 4.1, and convex relaxation, as described in Section 4.2.Note that the level set method leads to a local minimum, which makes it highly susceptible to initialization. To this end,we provide segmentation results with two different initializations - a box centered in the middle of the volume withside length equal to half of the resolution along the corresponding dimension and a sphere centered in the middle of thevolume with radius 100 voxels. In contrast, the convex relaxation technique always converges to a global minimumof the underlying energy functional and is completely independent of initialization. Expectedly, both initializationprocedures for the level set implementation lead to fairly different segmentations. Note that the optimization scheme iscoupled with the process of updating the foreground/background histograms. The box-shaped initialization producesa quite poor segmentation result. In particular, due to the weak foreground/background intensity discrimination andthe dominance of the flux term, the generated surface consists of multiple components situated around the vesicleboundary. The spherical initialization provides a closer capturing of the imaged shape and leads to a more accuratesegmentation result. The elongated structures at the top and the bottom of the surface may seem surprising at firstbut not after a more extensive inspection of the input data set (see the visualization of the cross-sections). And still,some oversmoothing effects of the resulting boundary can be observed. Hence, the convex relaxation technique provesessential for the precision of the final segmentation result. Recall that the proposed approach relies on a global dataterm computation.The discussed conclusions are additionally confirmed by a quantitative evaluation of the above segmentationresults, shown in Fig. 13. To this end, a few equidistantly spaced slices out of the volume interior have been manuallysegmented by an expert and used as a ground truth. Note that the slices close to the boundary are quite unclear and: V → {0, 1} denotes an implicit labeling representing thisa ground truth segmentation is hard to obtain.ground truth surface (being 0 within the interior region and 1 within the exterior) and u : V → {0, 1} the obtained 3DIf ugt12345678900.020.040.060.080.10.12slice numberdeviation from ground truth model−based approachproposed approach (LS box)proposed approach (LS sphere)proposed approach (convex orig.)proposed approach (convex interp.)K. Kolev er al. / Pattern Recognition 00 (2011) 1–21segmentation, we measure the misalignment between them as(cid:90)|ugt(x) − u(x)| dx(cid:90)Vugt(x) dx +u(x) dxV.(cid:15) =(cid:90)V19(20)In particular, we have (cid:15) ∈ [0, 1] with (cid:15) = 0 if and only if both segmentations are identical and (cid:15) = 1 if u is the emptyset or if both labelings are complementary to each other. As evident from the plot, the proposed model optimized withlevel sets exhibits a jumpy behavior for both a box-shaped and a spherical initialization due to the local minimizationscheme in combination with the globally estimated data terms. In contrast, the model-based method in [37] as well asthe proposed approach based on convex relaxation demonstrate a stable behavior, whereas the latter offers substantiallyincreased accuracy. This clear superiority over all other methods validates both the derived energy model and theutilized optimization technique. Note that applying the method to the original volume data without interpolation,which is not possible with the formulation in [37], entails additional accuracy gains.In addition to the improved accuracy, the proposed approach is substantially faster than the method in [37]. Forthe interpolated data set, the measured computational time was about an hour for the proposed algorithm as opposedto more than 6 hours for the model-based one. The relatively high computational costs of [37] are mainly due to thetime-consuming data term updates within an entire vicinity around the current surface estimate as well as the processof reinitialization of the underlying implicit function, inherent to the level set framework. The level set implementationof the proposed model took about 1.5 hours, also due to the permanently performed reinitialization.7. ConclusionWe proposed a new robust and accurate approach for volumetric 3D segmentation with applications to vesiclemembrane analysis. The method is designed to operate adequately with noisy data sets with a specific focus on bi-ological applications like vesicle and cell segmentation. Despite this emphasis on the particular application area theapproach is general and can be easily adapted to other segmentation tasks. The key idea is to tackle the segmentationproblem as the minimization of an appropriate energy functional integrating various features that can be extractedfrom the input volume data like regional statistics, edge identification and surface orientation. Moreover, the proposedmodel replaces the traditionally used isotropic regularizer by an anisotropic one in order to address the non-uniformresolution and therefore also sampling of the measurements along different spatial directions. We showed that the re-sulting energy functional can be optimized globally in a continuous setting by means of convex relaxation. In particu-lar, our work extends the class of functionals which can be globally minimized by convex relaxation and thresholding.Experiments on challenging fluorescence imaging data demonstrate that the proposed approach allows to accuratelyreconstruct the vesicle membranes despite the limited discriminative characteristics of intensity distributions and de-spite blurred and noisy surface boundaries. Furthermore, the reconstruction results are systematically improved byincorporating the different energy terms. Experimental results also confirm the superiority of the proposed convexrelaxation approach over state-of-the-art level set methods, since it gives rise to robust and highly accurate membranereconstructions, independent of initialization.Appendix A.Here, the technical details on the proof of Theorem 1 in Section 4.2 are given.Theorem 1.If u∗ : V → [0, 1] is a minimizer of the functional in (13), then for almost any threshold ν ∈ (0, 1)the binary function 1Σν,u∗ (x) : V → {0, 1} with Σν,u := {x | u(x) > ν} is also a (global) minimizer of (13).Proof. We observe that the first term of E(u∗) according to (13) is of the form−(cid:17)(cid:16)µ1 log Pob j(x) + µ2 ∆I(x). Using the layer cake representation of the function u∗ : V → [0, 1] (see [10])V b(x) (1 − u∗(x)), where b(x) :=(cid:82)u∗(x) =(cid:90) 101Σν,u∗(x) dνK. Kolev er al. / Pattern Recognition 00 (2011) 1–2120we obtain===(cid:90)V(cid:90)V(cid:90)b(x) (1 − u∗(x)) dxb(x)(cid:32)1 −(cid:32)(cid:90) 1(cid:90) 11Σν,u∗ (x) dν(cid:90) 10(cid:33)dx(cid:33)b(x)(cid:90)V(cid:90) 1b(x)0Vdν −001Σν,u∗ (x) dνdx(cid:16)1 − 1Σν,u∗ (x)(cid:17)dx dν.Analogously, we can rewrite the second term of E(u∗) which is of the formas(cid:82)V c(x)u∗(x) dx with c(x) := −µ1 log Pbg(x)(cid:90)(cid:90) 1(cid:90)c(x)u∗(x) dx =V0Vc(x)1Σν,u∗ (x) dx dν.Furthermore, the anisotropic coarea formula [38] can be used to express the last total variation term of E(u∗) as anintegral over the length of all level lines of u∗, measured in the norm induced by both the weighting map g and theanisotropic tensor D, i. e.(cid:90)V=g(I(x))(cid:90)(cid:90) 1(cid:113)g(I(x))0V(cid:112)∇u∗(x)T D(x)∇u∗(x) dx =(cid:90) 10|∂Σν,u∗|g,D dν∇1Σν,u∗ (x)T D(x)∇1Σν,u∗ (x) dx dν,where ∂Σν,u∗ denotes the boundary of Σν,u∗. Finally, plugging all together yieldsE(u∗) =(cid:90) 10E(1Σν,u∗ ) dν.Clearly, the functional is now merely an integral over the binary characteristic functions of the upper level sets of u∗.Now, we can deduce(cid:90) 1E(u∗) =E(1Σν,u∗ )dν ≥ minν∈(0,1)E(1Σν,u∗ ).0Since u∗ is assumed to be a global minimizer of E, this implies that the equality holds in the above expression and1Σν0 ,u∗ is also a global minimizer whereν0 := argminν∈(0,1)E(1Σν,u∗ ).Now, we can conclude that up to a null set the function E(1Σν,u∗ ) is constant with respect to ν, i. e. 1Σν,u∗ is a globalminimizer of (13) for almost any ν ∈ (0, 1).References[1] H. T. McMahon, J. L. Gallop, Membrane curvature and mechanisms of dynamic cell membrane remodelling, Nature 438 (2005) 590–596.[2] H. Engelhardt, Are s-layers exoskeletons? the basic function of protein surface layers revisited., Journal of structural biology 160 (2007)115–124.[3] P. Ratanabanangkoon, M. Gropper, R. Merkel, E. Sackmann, A. P. Gast, Two-dimensional streptavidin crystals on giant lipid bilayer vesicles,Langmuir 18 (2002) 4270–4276.[4] A. Csisz´ar, B. Hoffmann, R. Merkel, Double-shell giant vesicles mimicking gram-negative cell wall behavior during dehydration., Langmuir25 (2009) 5753–61.[5] W. B. M. B. Cook, R. W. Hardy, C. S. Zuker, Preserving cell shape under environmental stress, Nature 452 (2008) 361–364.[6] J. B. Manneville, J. F. Casella, E. Ambroggio, P. Gounon, J. Bertherat, P. Bassereau, J. Cartaud, B. Antonny, B. Goud, COPI coat assemblyoccurs on liquid-disordered domains and the associated membrane deformations are limited by membrane tension, PNAS 105 (2008) 16946–16951.[7] G. A. Vliegenthart, G. Gompper, Forced crumpling of self-avoiding elastic sheets, Nature Materials 5 (2006) 216–221.K. Kolev er al. / Pattern Recognition 00 (2011) 1–2121[8] T. Kosawada, K. Inoue, G. W. Schmid-Sch¨onbein, Mechanics of curved plasma membrane vesicles: Resting shapes, membrane curvature,and in-plane shear elasticity, Journal of Biomechanical Engineering 127 (2005) 229–236.[9] J. B. Pawley, Handbook of biological confocal microscopy, 2nd Edition, Plenum Press, New York, 1995.[10] T. Chan, S. Esedo¯glu, M. Nikolova, Algorithms for finding global minimizers of image segmentation and denoising models, SIAM Journalon Applied Mathematics 66 (5) (2006) 1632–1648.[11] K. Kolev, M. Klodt, T. Brox, D. Cremers, Continuous global optimization in multiview 3D reconstruction, International Journal of ComputerVision 84 (1) (2009) 80–96.[12] M. Kass, A. Witkin, D. Terzopoulos, Snakes: Active contour models, International Journal of Computer Vision 1 (1988) 321–331.[13] D. Mumford, J. Shah, Optimal approximations by piecewise smooth functions and associated variational problems, Communications on Pureand Applied Mathematics 42 (1989) 577–685.[14] S.-C. Zhu, A. Yuille, Region competition: unifying snakes, region growing, and Bayes/MDL for multiband image segmentation, IEEETransactions on Pattern Analysis and Machine Intelligence 18 (9) (1996) 884–900.[15] J. Kim, J. Fisher, A. Yezzi, M. Cetin, A. Willsky, Nonparametric methods for image segmentation using information theory and curveevolution, in: IEEE International Conference on Image Processing, Vol. 3, Rochester, NY, 2002, pp. 797–800.[16] C. Rother, V. Kolmogorov, A. Blake, GrabCut: interactive foreground extraction using iterated graph cuts, ACM Transactions on Graphics23 (3) (2004) 309–314.[17] M. Unger, T. Pock, W. Trobin, D. Cremers, H. Bischof, TVSeg - interactive total variation based image segmentation, in: British MachineVision Conference 2008, Leeds, UK, 2008.[18] V. Caselles, R. Kimmel, G. Sapiro, Geodesic active contours, in: Proc. Fifth International Conference on Computer Vision, IEEE ComputerSociety Press, Cambridge, MA, 1995, pp. 694–699.[19] S. Kichenassamy, A. Kumar, P. Olver, A. Tannenbaum, A. Yezzi, Gradient flows and geometric active contour models, in: Proc. FifthInternational Conference on Computer Vision, IEEE Computer Society Press, Cambridge, MA, 1995, pp. 810–815.[20] A. Vasilevskiy, K. Siddiqi, Flux maximizing geometric flows, IEEE Transactions on Pattern Analysis and Machine Intelligence 24 (2002)1565–1578.[21] X. Ren, J. Malik, Learning a classification model for segmentation, in: Proc. International Conference on Computer Vision and PatternRecognition, 2003, pp. 10–17.[22] A. Karargyris, N. Bourbakis, An elastic video interpolation methodology for wireless capsule endoscopy videos, in: Proceedings of the 2010IEEE International Conference on Bioinformatics and Bioengineering, BIBE ’10, IEEE Computer Society, Washington, DC, USA, 2010, pp.38–43.[23] S. Osher, J. A. Sethian, Fronts propagating with curvature-dependent speed: Algorithms based on Hamilton–Jacobi formulations, Journal ofComputational Physics 79 (1988) 12–49.[24] T. Chan, L. Vese, Active contours without edges, IEEE Transactions on Image Processing 10 (2) (2001) 266–277.[25] D. Greig, B. Porteous, A. Seheult, Exact maximum a posteriori estimation for binary images, Journal of the Royal Statistical Society B 51 (2)(1989) 271–279.[26] Y. Boykov, O. Veksler, R. Zabih, Fast approximate energy minimization via graph cuts, IEEE Transactions on Pattern Analysis and MachineIntelligence 23 (11) (2001) 1222–1239.[27] V. Kolmogorov, R. Zabih, What energy functions can be minimized via graph cuts?, in: Proc. European Conference on Computer Vision,London, UK, 2002, pp. 65–81.[28] Y. Boykov, V. Kolmogorov, Computing geodesics and minimal surfaces via graph cuts, in: Proc. International Conference on ComputerVision, IEEE Computer Society, Washington, DC, USA, 2003, p. 26.[29] B. Appleton, H. Talbot, Globally optimal geodesic active contours, J. Math. Imaging Vis. 23 (1) (2005) 67–86.[30] M. Klodt, T. Schoenemann, K. Kolev, M. Schikora, D. Cremers, An experimental comparison of discrete and continuous shape optimizationmethods, in: European Conference on Computer Vision (ECCV), Marseille, France, 2008.[31] A. Dervieux, F. Thomasset, A finite element method for the simulation of Rayleigh–Taylor instability, in: R. Rautman (Ed.), ApproximationMethods for Navier–Stokes Problems, Vol. 771 of Lecture Notes in Mathematics, Springer, Berlin, 1979, pp. 145–158.[32] C. Zach, M. Niethammer, J. M. Frahm, Continuous maximal flows and Wulff shapes: Application to MRFs, in: Proc. International Conferenceon Computer Vision and Pattern Recognition, Miami, FL, 2009.[33] C. R. Vogel, M. E. Oman, Fast, robust total variation-based reconstruction of noisy, blurred images, IEEE Transactions on Image Processing7 (1998) 813–824.[34] Computational geometry algorithms library, http://www.cgal.org.[35] S. Rusinkiewicz, Estimating curvatures and their derivatives on triangle meshes, in: Symposium on 3D Data Processing, Visualization, andTransmission, 2004.[36] M. I. Angelova, S. Sol´eau, P. M´el´eard, J. F. Faucon, P. Bothorel, Preparation of giant vesicles by external AC electric field. kinetics andapplications., in: Progress in Colloid & Polymer Science, Vol. 89, 1992, pp. 127–131.[37] A. H. Zhuang, D. J. Valentino, A. W. Toga, Skull-stripping magnetic resonance brain images using a model-based level set., Neuroimage32 (1) (2006) 79–92.[38] C. Olsson, M. Byr¨od, N. C. Overgaard, F. Kahl, Extending continuous cuts: Anisotropic metrics and expansion moves, in: InternationalConference on Computer Vision, 2009.