Artificial Intelligence 173 (2009) 982–1013Contents lists available at ScienceDirectArtificial Intelligencewww.elsevier.com/locate/artintQuantified epistemic logics for reasoning about knowledgein multi-agent systemsF. Belardinelli a, A. Lomuscio b,∗a Scuola Normale Superiore, Pisa, Italyb Department of Computing, Imperial College London, UKa r t i c l ei n f oa b s t r a c tArticle history:Received 23 April 2008Received in revised form 17 December 2008Accepted 17 February 2009Available online 24 February 2009Keywords:Knowledge representation and Logic:knowledge representation, distributedknowledgeMathematical Logic: first-order modal logic,epistemic logicMulti-agent systems: distributed systems,message passing systemsWe introduce quantified interpreted systems, a semantics to reason about knowledge inmulti-agent systems in a first-order setting. Quantified interpreted systems may be used tointerpret a variety of first-order modal epistemic languages with global and local terms,quantifiers, and individual and distributed knowledge operators for the agents in thesystem. We define first-order modal axiomatisations for different settings, and show thatthey are sound and complete with respect to the corresponding semantical classes.The expressibility potential of the formalism is explored by analysing two MAS scenarios:an infinite version of the muddy children problem, a typical epistemic puzzle, and a versionof the battlefield game. Furthermore, we apply the theoretical results here presented tothe analysis of message passing systems [R. Fagin, J. Halpern, Y. Moses, M. Vardi, Reasoningabout Knowledge, MIT Press, 1995; L. Lamport, Time, clocks, and the ordering of events ina distributed system, Communication of the ACM 21 (7) (1978) 558–565], and comparethe results obtained to their propositional counterparts. By doing so we find that keyknown meta-theorems of the propositional case can be expressed as validities on thecorresponding class of quantified interpreted systems.© 2009 Elsevier B.V. All rights reserved.1. IntroductionModal logics for reasoning about knowledge, or modal epistemic logics, have been widely studied in the artificial intel-ligence community for several years. The interest in this area is directed both towards fundamental theoretical research,covering topics such as axiomatisability, completeness, decidability, and complexity of these formalisms [3–5], as well as tothe application of modal epistemic languages to the specification and verification of multi-agent systems [20,53,64].The typical epistemic language extends propositional logic by adding n modalities K i representing the knowledge ofagent i in a group A = {1, . . . , n} of agents. The use of these formalisms as specification languages is nowadays so main-stream as to require little justification: these are rather expressive languages, well-understood from a theoretical point ofview [14,49].For expressiveness purposes epistemic logic has been extended in several directions. In one line of research modalities fordistributed and common knowledge have been added to the basic formalism [14,15]. In another one, the epistemic languagehas been enriched with temporal operators under the assumption of a given model of time, e.g., linear or branching, discreteor continuous [29,48,70]. In yet another direction, epistemic logic has been studied at the predicate level [36,43,51], thusallowing for richer specifications.* Corresponding author.E-mail addresses: f.belardinelli@sns.it (F. Belardinelli), A.Lomuscio@imperial.ac.uk (A. Lomuscio).0004-3702/$ – see front matter © 2009 Elsevier B.V. All rights reserved.doi:10.1016/j.artint.2009.02.003F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013983This paper takes inspiration from this last line of research, and is intended to contribute to the subject of first-orderepistemic logic for the specification of multi-agent systems (MAS). Specifically, we provide first-order epistemic languageswith a computationally grounded semantics [65] given in terms of quantified interpreted systems (QIS). We believe that QISare a natural extension to first-order of interpreted systems, the typical semantical framework for epistemic logics in MAS[14,53]. Further, we analyse from an epistemic perspective the theoretical implications of different first-order extensions:quantification domains indexed to agents and to computational states, domains of intensional objects, etc. One of the mainresults of this paper consists in showing that all the semantical classes introduced are finitely axiomatisable. This is ob-tained by adapting standard techniques in quantified modal logic [1,16,19,30] to the epistemic frameworks here analysed.We also show that the techniques in [15] for proving completeness of epistemic languages with distributed knowledge canbe extended to first-order. Finally, the formalisms presented allow to study in a first-order setting message passing sys-tems, a typical framework in distributed systems [38,52], revealing that meta-theorems on message passing systems can beexpressed as validities in the corresponding class of quantified interpreted systems.1.1. First-order epistemic logic in knowledge representationAlthough quantified modal logic (QML) has a reputation for being a source of incompleteness [10,19,57], quantificationis an expressive feature that has often been considered in the literature on knowledge representation and AI. For instance,when specifying the behaviour of MAS, quantification is so natural and convenient that one feels compelled to bring itexplicitly into the syntax. As it is maintained in [39]:“the power of FOL [first-order logic] is used not so much to deal with infinities but to deal with incomplete knowledge.” ([39], p. 81)Moreover, in knowledge representation the power of first-order logic is welcome every time agents reason about:• relational statements, as in “agent i knows that message μ was sent by agent a to agent b”, or formally,K iSent(a, b, μ)• functional dependencies and identity, as in “agent i knows that message μ is the encryption of message μ(cid:3)with key k”,or formally,K i(μ = enc(k, μ(cid:3)))• infinite domains of individuals, or finite domains whose cardinality cannot be bounded in advance: “agent i has to read anye-mail before deleting it”,∀μ(Delete(i, μ) → Read(i, μ))• quantification on agents: “the child of any process knows who launched it”∀i Kchild(i)Launched(i, child(i))Furthermore, in the context of logics for knowledge it is well known that epistemic modalities can be combined withquantifiers to formalise de re/de dicto knowledge [16,30], expressing concepts not expressible at the propositional level. Forinstance, agent i might know that every computation produces an output, thus having the de dicto knowledge expressed inthe following specification:∀comp K i ∃ y Output(comp, y)but he might not know the actual output of every computation. Therefore, the following de re specification would not besatisfied:∀comp ∃ y K i Output(comp, y)However, the use of first-order modal logic in MAS specifications is sometimes frowned upon: why should we use anundecidable language when a decidable one does the job reasonably well already? Is the price that quantification brings injustified? While these objections are certainly sensible, we believe that their strength has been increasingly weakened byrecent progress in MAS verification by model checking [13,18,44,54] and advances in the theory of QML.In the model checking approach [6,31,47] the decision problem is tackled not by checking validity, but simply by con-sidering model satisfaction. In other words, we do not check whether a formula representing a specification is satisfiable insome model, but whether it is true on the model representing all possible evolutions of a given system. While the formerproblem is undecidable for QML, the latter might be decidable at least for many interesting fragments, further investigationsbeing required.In addition, recent contributions on axiomatisability [58,63] and decidability [25,27,62] of quantified modal logic, includ-ing both positive [11,23,24,56] and negative results [12,26,59,61] have shown that useful QML fragments are axiomatisableand even decidable, raising hopes that some quantified MAS logic may also be axiomatisable and decidable.984F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013Our motivation for the present contribution comes from an interest in reasoning about multi-agent systems, whose high-level properties may usefully be modelled by epistemic formalisms suitably extended to predicate logic. Before turning tothe formal machinery, we review the main approaches to first-order epistemic formalisms in knowledge representation andartificial intelligence.1.2. State of the artThe study of epistemic logic in a first-order setting has a long and established tradition in AI. Among the early con-tributions we highlight [17,22], where some semantical and philosophical issues about identity in epistemic contexts areexplored. More recent works focus on the computational and planning abilities of agents [39,50], where first-order epis-temic logic (FOEL) is used as a specification language for agents. In [51] a theory of action is presented, which takes intoaccount the knowledge prerequisites to action and the effects of action on knowledge.First-order logic has also been extensively applied to the deductive machinery of knowledge bases. In [36,37] a logic ofbelief on a decidable form of first-order entailment is presented, and in [41,42] these investigations are further pursued byconsidering restricted forms of first-order doxastic logic. FOEL is also briefly discussed in classic textbooks [14,49], alongwith its Kripke semantics and some significant validities, even though there is no attempt to extend interpreted systemsto first-order, nor completeness issues are tackled. Also, [32,33] introduces applications of FOEL to game theory, while [2,7]discusses epistemic formalisms in the context of security protocol. In an orthogonal dimension to the above, [21] presentsan analysis of common knowledge in multi-agent systems with infinitely many agents.First-order epistemic logics for MAS specification are used in [67–69], where they are studied mostly in relation to theMAPLE programming language for agents. In [67] the quantified epistemic temporal logic QUETL is presented in order todevelop a verification methodology for multi-agent systems. First-order logic appears as the base of a number of other agenttheories, such as BDI logics [55], the KQML framework [8], and the LORA framework [66], together with modalities formental attitudes (knowledge, belief, intention, desire), as well as temporal and dynamic operators. However, most of thecurrent literature on agent theories have so far fallen short of a systematic analysis of the formal machinery underlyingthese frameworks. Often the theoretical properties (axiomatisability, decidability, complexity) of these MAS formalisms arenot the main focus of these investigations. Indeed, certain frameworks are so rich that it is extremely unlikely to devise anyfinite axiomatisation. Still, these references are relevant for the present investigations as they are among the few to haveexplicitly addressed the subject of first-order modal languages in a MAS setting.From a purely theoretical perspective, quantified modal logic has received much attention with a wealth of contributionson axiomatisability [11,58,63], decidability [12,25,62], and complexity [24,27] of fragments of QML. In [62] the monodicfragment of quantified modal logic, where at most one free variable appears in the scope of modal operators, is introduced,and decidability of various subfragments is proved. In [23,25] similar results are obtained for monodic fragments of first-order temporal logic, while the complexity of some of these formalisms is analysed in [24,27]. Further, [63] provides acomplete axiomatisation of monodic first-order validities on the natural numbers. Also the monodic fragment of FOEL hasbeen explored. In [61] monodic fist-order epistemic logic with common knowledge is proved to be decidable, and in [58,59]this fragment is axiomatised.The lines of work above constitute the theoretical and applied background against which this research is set.1.3. The present contributionThis paper extends the current state of the art in first-order epistemic logic by introducing a family of provably completefirst-order epistemic logics with global and local terms. While the denotation of the former is rigid, i.e., it is the samein every computational state, the latter’s depends on the state in which these expressions are interpreted. The quantifiedepistemic languages here introduced are non-trivial extensions of the propositional modal languages in [16,30]. The useof flexible terms is inspired by [19], which also presents a completeness proof for such languages. The relevance of thedistinction between global and local terms has since long been recognised, see, e.g., [16,46].From a semantical viewpoint the key contribution of the paper is the extension of interpreted systems to first-order,obtained by endowing these structures with quantification domains. In quantified interpreted systems we allow each agentto reason about a possibly different set of objects. This choice is motivated by the fact that, as agents are autonomous, theymay be aware of only a subset of all existing individuals, possibly different from those of other agents. We do not aimto provide a theory of awareness about agents’ knowledge, but simply observe that most universally quantified statementsreferring to an agent i, such as “all boxes are red”, are really universal only if i is assumed to consider a proper subset ofthe domain of all possible individuals: the set of boxes considered by i. Interpreted systems are the typical formalism forepistemic logic in MAS [20,53], but to our knowledge there has been no attempt to extend these structures to first-order,even in references such as [14] where FOEL and interpreted systems are explicitly considered. We deem this extensionpotentially of note as these structures represent a computationally grounded semantics in the sense of [65], suitable for thedefinition of protocols and programs for agents, and for the development of model checking techniques.Furthermore, provably sound and complete axiomatisations are presented for all classes of QIS here considered. The com-pleteness proofs make use of standard techniques in QML [9,60] suitably extended to deal with the semantical frameworkof quantified interpreted systems and a richer language with local terms, indexed quantifiers, and distributed knowledge.F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013985The completeness proof for FOEL with distributed knowledge extends to first-order the techniques in [15]. Note that anindependent completeness proof for these propositional languages appeared in [28].Finally, we apply the formal machinery to the analysis of MAS scenarios. The muddy children puzzle and message passingsystems belong to the folklore of AI and distributed systems [14,38], but their first-order formalisations here provided areoriginal.Scheme of the paper. In Section 2 we present two classes of first-order structures: systems of global states and Kripkeframes, as well as several subclasses of these. In Section 3 we introduce a group of first-order modal languages, whichare interpreted on quantified interpreted systems, a valued version of systems of global states. In Section 4 we introducea class of first-order modal axiomatisations, and prove their soundness and completeness with respect to the structures inSection 2. In Section 5 we exemplify the use of the syntax and semantics by describing some formal models for multi-agentsystems and discuss some specification patterns. Section 6 is devoted to the analysis of message passing systems. Finally,Section 7 presents related work and draws some conclusions.2. Systems of global states and Kripke framesIn this section we introduce systems of global states and Kripke frames in a first-order setting. While the first ones areused in computer science to model the behaviour of MAS [14,20,49,53], Kripke frames are typically employed to acquire adeeper understanding of the formal properties of these systems [3–5].Technically, we extend the corresponding propositional structures to first-order by considering a distinct domain of quan-tification for each agent. This choice is motivated by the fact that, as agents are autonomous, they might consider distinctdomains of individuals. Then we define two maps between these classes of structures, and prove that the composition ofthese maps is an isomorphism. These results will be used for translating the completeness results from Kripke semantics tosystems of global states. In what follows we assume a set of agents A = {1, . . . , n}.2.1. Systems of global statesThis paper is primarily concerned with the representation of knowledge in MAS, not their temporal evolution. Given this,we adopt the “static” perspective on the systems of global states [45], rather than their “dynamic” version [14]. So, whilewe assume that the states of the system result from the evolution given by protocols and transitions, we do not consider(cid:3)i, . . . , for each agent i ∈ A, and a set Le containing thethese explicitly. More formally, consider a set Li of local states li, llocal states of the environment le, l(cid:3)e, . . . . We define a system of global states as follows:Definition 1 (Systems of global states). A system of global states, or SGS, is a tuple S = (cid:8)S, D, {D i}i∈ A, F , {F i}i∈ A(cid:9) such thatS ⊆ Le × L1 × · · · × Ln is a non-empty set of global states; D is a non-empty set of individuals, and for i ∈ A, D i is a subsetof D; F ⊆ { f | f : S → D} is a non-empty set of functions from S to D, and for i ∈ A, F i is a subset of F .We denote the class of all systems of global states as SGS.Intuitively, S is the set of possible configurations of the system corresponding to the set of reachable states obtained byconsidering the temporal evolution of the system. Given that we do not consider the temporal dimension, we simply takeS as a subset of the set of all possible states.(cid:3)(cid:3)(cid:3).The domain D contains the individuals for interpreting global terms, and F is the interpretation domain for local terms.We assign a fixed meaning to global terms like “π ” by including the corresponding real number in the domain D ofindividuals. On the contrary, expressions such as “the value stored in the register”, which identifies possibly different valuesrespectively, will be modelled as a function f ∈ F , also called intensional object,a and asuch that f (s) = a and f (sat different global states s and s(cid:3)) = aIn systems of global states we have possibly different quantification domains D i and F i for each agent i ∈ A. Thisfeature is motivated by the fact that, as each agent i is autonomous and may have only a partial view of the surroundingenvironment, she could have access only to subsets D i and F i of the domains D and F of individuals, possibly differentfrom the domains D j and F j of another agent j.Note that in general D i and F i are independent from global states, i.e., for s, s(cid:3) ∈ S, the domains D i and F i of agent i in sare the same as the domains D i and F i in s. This means that individuals neither appear nor disappear during the evolutionof the system. We deem this assumption consistent with the external account of knowledge usually adopted in the frameworkof epistemic logic. In this line of research knowledge is ascribed to agents by an external observer (in our case the systemspecifier), rather than explicitly possessed by them. This means that a formula like K i∀i yφ does not express that agent iexplicitly knows that all y are φ, i.e., that ∀i yφ is the case. Instead, it suffices that for every y, i knows that φ is the case,i.e., ∀i y K iφ. In other words, agent i needs not to be aware of all the individuals in his domain of quantification. In thisrespect the individuals in D i and F i can be thought of as persisting in the various global states from the viewpoint of theexternal observer.(cid:3)In the next section we consider various classes of systems of global states.986F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10132.2. Further systems of global statesWe remarked that in systems of global states individuals neither appear nor disappear. A different scenario we may wishto consider consists of quantification domains changing at run-time. For this purpose we introduce varying systems of globalstates:Definition 2 (Varying SGS). A varying system of global states, or varying SGS, is a tuple S = (cid:8)S, D, {D i}i∈ A, F , {F i}i∈ A(cid:9) such(cid:3) |that S, D, and F are defined as in Definition 1, and for each i ∈ A, D i is a function from S to the power set ℘ (D) = {DD(cid:3) ⊆ D}, and F i is a function from S to the power set ℘ (F ) = {FWe denote the class of all varying systems of global states as SGS var.(cid:3) ⊆ F }.(cid:3) | F(cid:3)In a varying SGS the domains of quantification depend not only on the agent, but also on her computational state, that(cid:3))).is, for s (cid:11)= sTherefore, varying SGS are useful to model systems in which individuals might appear and disappear during the systemruns., the quantification domain D i(s) (respectively F i(s)) can possibly be different from D i(s(cid:3)) (respectively F i(sObserve that the domains D i(s) and F i(s) do not contribute to the definition of the local state of agent i in a state s. This(cid:3)). The quantificationimplies that there can be states s and sdomains of i depend also on the local states of the other agents. While it is instructive to look at this general setting, itis also of interest to consider the case where the same quantification domain is available to one agent when she is in thesame local state. Thus, we introduce regular systems of global states:(cid:3)), and yet D i(s) (cid:11)= D i(ssuch that li(s) = li(s(cid:3)) or F i(s) (cid:11)= F i(s(cid:3)Definition 3 (Regular SGS). A regular system of global states, or regular SGS, is a varying SGS such that:for all s, s(cid:3) ∈ S, li(s) = li(s) and F i(s) = F i(sWe denote the class of all regular systems of global states as SGS reg .) implies D i(s) = D i(s(cid:3)(cid:3)(cid:3))(1)In other words, in regular SGS the quantification domains of agent i are part of her local state.Further, note that in a system of global states the individuals in D can be seen as constant functions from S to D itself,i.e., for every a ∈ D consider the function a : S → D returning a for every s ∈ S. Hence, we can take D itself as the domainF of intensional objects, thus obtaining a peculiar class of systems of global states:Definition 4 (Objectual SGS). An objectual system of global states, or objectual SGS, is an SGS S = (cid:8)S, D, {D i}i∈ A, F , {F i}i∈ A(cid:9)such that D = F , and for i ∈ A, D i = F i .We denote the class of all objectual SGS as SGSobj .Objectual SGS, which can be seen as triples S = (cid:8)S, D, {D i}i∈ A(cid:9), are particular instances of SGS, easier to handle and yetsuitable for modelling useful applications, as we will show in Section 5. In fact, objectual SGS are sufficient for interpretingfirst-order epistemic languages with global terms only, the typical formalism for quantified modal logic [16,19,30]. Thus, thepresent semantical framework encompasses many of the formal accounts available in the literature on QML.For the present investigations it is of particular interest to explore the relationship among individuals in the various D iand F i , for i ∈ A. In general system of global states the domain F i can be any set of function from S to D, but we may findconvenient to define some constraints on the functions in F i .In the rest of the paper we will consider the following constraints:for all s, s(cid:3)(cid:3) ∈ S, li(s) = li(s(cid:3) ∈ S, f ∈ F i, li(s) = li(s) and f (s) ∈ D i implies f (s) ∈ D i) and f (s) ∈ D i implies f (s(cid:3)(cid:3)(cid:3)) ∈ D ifor all s, sfor all s ∈ S, f ∈ F i, f (s) ∈ D ifor all s, sfor all s, s(cid:3) ∈ S, f ∈ F i and li(s) = li(s(cid:3) ∈ S, f ∈ F i and li(s) = li(s(cid:3)(cid:3)) implies f (s) = f (s) implies f (s) = f (s(cid:3)(cid:3))) ∈ D i(2)(3)(4)(5)(6)Intuitively, formula (2) expresses the fact that if the intensional object f chooses an existing individual at global state s,then agent i knows this fact. Formula (3) restricts formula (2) to the intensional objects in the domain F i , while formula(4) is a strengthening of (3) urging that F i is a set of functions with domain S and codomain D i ⊆ D. Further, by formula(5) the functions in F i have as domain the set Li of agent i’s local state, while formula (6) is the conjunction of (4) and (5),and it implies that the functions in F i have domain Li and codomain D i .Given the above, we introduce five further classes of systems of global states.Definition 5. For every k, 2 (cid:2) k (cid:2) 6, SGSk ⊆ SGS is the class of the system of global states satisfying formula (k).F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013987In Section 4 we will prove that the results available for the systems of global states in SGS, notably the soundness andcompleteness theorems, also apply to the other classes of SGS with minor changes. The following table summarises theclasses of SGS we will analyse in the rest of the paper, for 2 (cid:2) k (cid:2) 6.Systems of global statesSGSSGS varSGS objSGS regSGSkallvaryingobjectualregularSGS in SGS satisfying formula (k)Finally, note that we allow for the possibility that A ⊆ D. This implies that agents can reason about themselves, their prop-erties, and relationships: some examples of the expressiveness possibilities of the present formalism are given in Section 3.2.2.3. Kripke framesWhile Kripke frames are less intuitive than interpreted systems to model MAS, they are more convenient for the pur-pose of formal analysis, notably completeness investigations. As customarily in epistemic logic, we work with frames withequivalence relations ∼i , that is, for a non-empty set W ,for every w in W ,for every w, wfor every w, win W ,(cid:3)(cid:3), w(cid:3)(cid:3)w ∼i ww ∼i win W , w ∼i w(cid:3)(cid:3)implies wand w(cid:3) ∼i w(cid:3) ∼i w(cid:3)(cid:3)implies w ∼i wreflexivitysymmetrytransitivity(cid:3)(cid:3)so we take the following definition:Definition 6 (Frames). A Kripke frame, or frame, is a tuple F = (cid:8)W , {∼i}i∈ A, D, {D i}i∈ A, F , {F i}i∈ A(cid:9) such that W is a non-empty set; for i ∈ A, ∼i is an equivalence relation on W ; D is a non-empty set of individuals, and for i ∈ A, D i is a subsetof D; F ⊆ { f | f : W → D} is a non-empty set of functions from W to D, and for i ∈ A, F i is a subset of F .The class of all Kripke frames is denoted by K.In the model theory of modal logic W is usually referred to as the set of possible worlds, while each ∼i is the accessi-bility relation between worlds [34]. The intuitive meaning of the elements D and F in a Kripke frame is similar to that in asystem of global states: they represent the domains of interpretation for global and local terms respectively.In contrast with interpreted systems, Kripke frames are static structures with no obvious relation to the temporal evo-lution of a system. However, given that also our approach to QIS is static and we will focus on purely epistemic languages,the present definition of Kripke frames is adequate with our purposes of theoretical investigations.In the next section we consider some specialisations of the notion of frame.2.4. Further Kripke framesIn order to investigate varying, regular and objectual SGS, we introduce varying, regular and objectual Kripke frames asfollows:Definition 7 (Varying frames). A varying frame is a tuple F = (cid:8)W , {∼i}i∈ A, D, {D i}i∈ A, F , {F i}i∈ A(cid:9) such that W , ∼i , D, and Fare defined as in Definition 6, and for each i ∈ A, D i is a function from W to the power set ℘ (D), and F i is a function fromW to the power set ℘ (F ).We denote the class of all varying Kripke frames as Kvar.In analogy with regular SGS we have also regular Kripke frames.Definition 8 (Regular frames). A regular frame is a varying frame such that:for all w, w(cid:3) ∈ W , w ∼i w(cid:3)implies D i(w) = D i(w(cid:3)) and F i(w) = F i(w(cid:3))We denote the class of all regular frames as Kreg.We now introduce the objectual frames.(7)Definition 9 (Objectual frames). An objectual frame is a frame F = (cid:8)W , {∼i}i∈ A, D, {D i}i∈ A, F , {F i}i∈ A(cid:9) such that D = F , andfor i ∈ A, D i = F i .We denote the class of all objectual frames as Kobj.988F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013Objectual frames can be seen as tuples F = (cid:8)W , {∼i}i∈ A, D, {D i}i∈ A(cid:9).Finally, for 2 (cid:2) k (cid:2) 6 we introduce the class Kk of Kripke frames corresponding to SGSk in a sense which will be madeprecise in the following section. First, consider the following constraints on Kripke frames.(cid:3)for all w, w(cid:3) ∈ W , w ∼i w(cid:3) ∈ W , f ∈ F i, w ∼i wfor all w, wfor all w ∈ W , f ∈ F i, f (w) ∈ D iand f (w) ∈ D i implies f (w) ∈ D iand f (w) ∈ D i implies f (w(cid:3)(cid:3)(cid:3)) ∈ D ifor all w, wfor all w, w(cid:3) ∈ W , f ∈ F i and w ∼i w(cid:3) ∈ W , f ∈ F i and w ∼i w(cid:3)(cid:3)implies f (w) = f (wimplies f (w) = f (w(cid:3)(cid:3))) ∈ D i(8)(9)(10)(11)(12)The meaning of formulas (8)–(12) is similar to that of formulas (2)–(6). We now introduce 5 more classes of Kripke frames.Definition 10. For every k, 2 (cid:2) k (cid:2) 6, Kk ⊆ K is the class of the system of global states satisfying formula (k + 6).All the classes of Kripke frames introduced so far are summarised in the following table, for 2 (cid:2) k (cid:2) 6.Kripke framesKKvarKobjKregKkallvaryingobjectualregularframes in K satisfying formula (k + 6)We will use SGS to model concrete systems and protocols, but we rely on Kripke frames for technical results, notably thecompleteness proofs.2.5. Maps between systems of global states and Kripke framesWe explore the relationship between systems of global states and Kripke frames by means of the maps f : SGS → Kand g : K → SGS. By Lemma 14 below and Theorem 41 we will show that the axiomatisation of Kripke framesin Section 4 is sound and complete for the class of all SGS. Specifically, Lemma 14 states that every frame F =(cid:8)W , {∼i}i∈ A, D, {D i}i∈ A, F , {F i}i∈ A(cid:9) is isomorphic to f (g(F )) = (cid:8)W}i∈ A(cid:9), that is, there are bijec-(cid:3)(cid:3)tions between W and Wi . In addition,(cid:3)). As a consequence, every sound and complete axiomatisation ofwe can show that w ∼i wKripke frames is also an axiomatisation of the systems of global states.(cid:3)(cid:3), {F}i∈ A, Di(cid:3)i , and the corresponding F i and F(cid:3), F and Fiff ( f ◦ g)(w) ∼(cid:3)(cid:3)i ( f ◦ g)(w, the corresponding D i and D, D and D}i∈ A, F(cid:3), {∼(cid:3)i(cid:3), {D(cid:3)i(cid:3)In order to prove this result we start by introducing the map f : SGS → K.Definition 11. Let S = (cid:8)S, D, {D i}i∈ A, F , {F i}i∈ A(cid:9) be a system of global states, define f (S) as the tuple (cid:8)S, {∼i}i∈ A, D, {D i}i∈ A,F , {F i}i∈ A(cid:9) where for i ∈ A, each relation ∼i on S is defined by (cid:8)le, l1, . . . , ln(cid:9) ∼i (cid:8)l(cid:9) iff li = l(cid:3)e, l(cid:3)(cid:3)1, . . . , ln(cid:3)i .It is easy to check that ∼i is an equivalence relation and that f (S) is a frame.To define the converse map g : K → SGS, let F = (cid:8)W , {∼i}i∈ A, D, {D i}i∈ A, F , {F i}i∈ A(cid:9) be a frame. For every equivalence(cid:3)} to be a local state for agent i, and w the= {w(cid:3) | w ∼i wrelation ∼i , for w ∈ W , we define the equivalence class [w]∼ilocal state for the environment.Definition 12. Given a frame F = (cid:8)W , {∼i}i∈ A, D, {D i}i∈ A, F , {F i}i∈ A(cid:9), let g(F ) be the tuple (cid:8)S, D, {D i}i∈ A, F(cid:9); FS contains all the n + 1-tuples (cid:8)w, [w]∼1 , . . . , [w]∼n(cid:3)((cid:8)w, [w]∼1 , . . . , [w]∼nf (w), for f ∈ F ; and for i ∈ A, F i = { f(cid:9)) = f (w), for f ∈ F i}.is the set of functions fsuch that f(cid:3) | f(cid:3)(cid:3)(cid:3), {F(cid:3)((cid:8)w, [w]∼1 , . . . , [w]∼n}i∈ A(cid:9) where(cid:9)) =(cid:3)iBy construction the structure g(F ) is a system of global states.We now prove that the compositions f ◦ g and g ◦ f are isomorphisms on the respective structures. Only Lemma 14below is actually needed to prove completeness with respect to SGS (see Section 4), but we also present Lemma 13 to stateprecisely the correspondence between systems of global states and Kripke frames. In what follows πi((cid:8)a1, . . . , am(cid:9)) = ai , fori (cid:2) m.Lemma 13. Every system of global states S is isomorphic to g( f (S)).Proof. If S = (cid:8)S, D, {D i}i∈ A, F , {F i}i∈ A(cid:9) is an SGS, then g( f (S)) = (cid:8)S(cid:3)Sis the set of n + 1-tuples (cid:8)s, [s]∼1 , . . . , [s]∼n(cid:9), for s ∈ S. The function h(s) = (cid:8)s, [s]∼1 , . . . , [s]∼n}i∈ A(cid:9) is an SGS as well such that(cid:9) is a bijection between(cid:3), D, {D i}i∈ A, F(cid:3), {F(cid:3)iF. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013989(cid:3): it is one-to-one as if s, s(cid:3) ∈ SS and Ssuch that h(π1(s)) = s. Identity is trivially a bijection on D, and for f ∈ F ,. (cid:2)f (s) = f(cid:9)), for s ∈ S, is a bijection between F and F(cid:3)((cid:8)s, [s]∼1 , . . . , [s]∼nand s = s, then in particular π1(s) = π1(s(cid:3) ∈ Ff(cid:3)(cid:3)(cid:3)(cid:3)(cid:3)). It is onto as for s ∈ S(cid:3), the function hsuch that h(cid:3), π1(s) ∈ S is(cid:3)( f ) = fiff(cid:3)Lemma 14. Every Kripke frame F is isomorphic to f (g(F )).(cid:3)is the set of n + 1-tuples (cid:8)w, [w]∼1 , . . . , [w]∼nProof. If F = (cid:8)W , {∼i}i∈ A, D, {D i}i∈ A, F , {F i}i∈ A(cid:9) is a Kripke frame, then f (g(F )) = (cid:8)Wsuch that Wbijection between W and W(cid:3)as for w ∈ W(cid:3) ∈ F(cid:3), the function hf(cid:3)(cid:3). Moreover, w ∼i wF}i∈ A(cid:9) is(cid:9) is a(cid:3)). It is onto, π1(w) ∈ W is such that h(π1(w)) = w. Also in this case the identity on D is a bijection, and for f ∈ F ,(cid:3)((cid:8)w, [w]∼1 , . . . , [w]∼n(cid:9)), for w ∈ W , is a bijection between F and(cid:9) ∼(cid:3)i(cid:3), {∼(cid:3)i(cid:9), for w ∈ W . The function h(w) = (cid:8)w, [w]∼1 , . . . , [w]∼niff f (w) = f(cid:3)]∼i iff (cid:8)w, [w]∼1 , . . . , [w]∼n, then in particular π1(w) = π1(w: it is one-to-one as if w, wsuch that hiff [w]∼i}i∈ A, D, {D i}i∈ A, F(cid:3)]∼1 , . . . , [wand w = w(cid:3)( f ) = f(cid:3) ∈ W(cid:9). (cid:2)= [w(cid:3), [w(cid:3)]∼n(cid:3), {F(cid:8)w(cid:3)i(cid:3)(cid:3)(cid:3)(cid:3)(cid:3)By Lemma 14 and Theorem 41 we will show that the axiomatisation of Kripke frames presented in Section 4 is adequatealso for the systems of global states.2.6. Further mapsIt is straightforward to extend the maps f and g to deal also with the other classes of SGS and Kripke frames. As regardsvarying SGS and frames, define map f var : SGS var → Kvar as f , and define map gvar : Kvar → SGS var to be the same as g(cid:3)),except that for s = (cid:8)w, [w]∼1 , . . . , [w]∼n(cid:3) = π1(sfor f ∈ F i(w), w(cid:3)i(s) is defined as D i(w) and F(cid:3)i (s) is defined as { f(cid:9) ∈ gvar(F ), D(cid:3)) = f (w(cid:3) | f(cid:3))}.(cid:3)(sWe state the following isomorphism result, the proof follows those in Lemmas 13 and 14 with little modifications.Corollary 15. Every varying SGS S is isomorphic to gvar( f var(S)).Every varying frame F is isomorphic to f var(gvar(F )).Further, it can be shown that f var(S) is a regular frame, whenever S is a regular SGS. Also, gvar(F ) is a regular SGS,whenever F is a regular frame. Therefore, we have the following:Corollary 16. Every regular SGS S is isomorphic to gvar( f var(S)).Every regular frame F is isomorphic to f var(gvar(F )).The map f obj : SGS obj → Kobj from objectual systems of global states to Kripke frames is defined as the restric-is similarly defined as the restrictions of g to (cid:8)W ,tion of{∼i}i∈ A, D, {D i}i∈ A(cid:9). By considerations similar to those for Lemmas 13 and 14 it is easy to show the following:to (cid:8)S, D, {D i}i∈ A(cid:9); while the map gobj : Kobj → SGS objfCorollary 17. Every objectual SGS S is isomorphic to gobj( f obj(S)).Every objectual frame F is isomorphic to f obj(gobj(F )).Finally, for 2 (cid:2) k (cid:2) 6, we can show that the frame f (S) satisfies the formula (k + 6) whenever S satisfies (k). Also, theSGS g(F ) satisfies the formula (k) whenever F satisfies (k + 6). Therefore, the following holds:Corollary 18. Let 2 (cid:2) k (cid:2) 6. Every SGS S ∈ SGSk is isomorphic to g( f (S)).Every frame F ∈ Kk is isomorphic to f (g(F )).In the following table we summarise the correspondences between systems of global states and Kripke frames, for2 (cid:2) k (cid:2) 6.Systems of global statesKripke framesSGSSGS varSGS objSGS regSGSkKKvarKobjKregKkIn Section 4, Corollaries 15–18 will be used for proving completeness with respect to all classes of systems of global states,once obtained completeness for the corresponding class of Kripke frames.990F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10133. Syntax and semanticsIn this section we introduce a family of first-order epistemic languages containing local and global terms, quantifiers,epistemic operators, as well as the identity symbol. These languages are interpreted on models based on Kripke frames.Finally, we present quantified interpreted systems, a valued version of the systems of global states.3.1. SyntaxThe first-order epistemic language Ln contains global variables x1, x2, . . . , local variables z1, z2, . . . , global constants, . . . , and n-ary pred-2, . . . , for n ∈ N, the identity symbol =, the boolean connectives ¬ and →, and for every i ∈ A, thec1, c2, . . . , and local constants d1, d2, . . . . Moreover, we have n + 1-ary function symbols f n+1icative constants P nindexed quantifier ∀i , the epistemic operator K i , and the unary predicative constant Admi ., f n+11, P n21Definition 19 (Ln). Terms and formulas in Ln are defined as follows:t ::= x | z | c | d | f k(t1, . . . , tk)φ ::= P k(t1, . . . , tk) | t = t(cid:3) | Admi(t) | ¬φ | φ → φ(cid:3) | K iφ | ∀i xφ | ∀i zφThe operator K i , for i ∈ A, is the standard epistemic modality [14]. The formula K iφ intuitively means that “agent i knowsthat φ is the case”. The formula ∀i xφ (respectively ∀i zφ) states that “φ is the case for all individuals in D i ” (respectivelyF i ); whereas Admi(t) means that the individual denoted by term t is among the admissible individuals considered by agenti, that is, the individuals in D i and F i . The symbols ⊥, ∧, ∨, ↔, ∃i are defined from the other logical constants as standard,while metavariables y, y(cid:3), . . . refer to the (local and global) variables in Ln.A global term s is defined as:s ::= x | c | f k(s1, . . . , sk)A term not complying with the above is said to be local. The metavariables s, sterms respectively; while v, v“s” may represent either a state or a global term, the context will disambiguate.(cid:3), . . . refer to global and local(cid:3), . . . refer to closed global and local terms, where no variable appears. The symbol(cid:3), . . . and u, u(cid:3), . . . and r, rMoreover, t[(cid:18)y] (resp. φ[(cid:18)y]) means that (cid:18)y = y1, . . . , yn are all the (local and global) free variables in t (resp. φ); whilet[(cid:18)y/(cid:18)t] (resp. φ[(cid:18)y/(cid:18)t]) denotes the term (resp. formula) obtained by substituting simultaneously some, possibly all, the freeoccurrences of y1, . . . , yn in t (resp. φ) with t1, . . . , tn, renaming bounded variables if necessary. We assume that localvariables are to be substituted by local terms only, the same holds for global variables and terms.We write GVar, LVar, GCon and LCon to denote the sets of global and local variables, and the sets of global and localconstants in Ln respectively.In this paper we consider two further languages, Lobjnand LDn , for describing the objectual structures introduced inSection 2.Definition 20 (Lobjfollows:n ). The language Lobjnis the restriction of Ln to global terms. Terms and formulas in Lobjnare defined ast ::= x | c | f k(t1, . . . , tk)φ ::= P k(t1, . . . , tk) | t = t(cid:3) | Admi(t) | ¬φ | φ → φ(cid:3) | K iφ | ∀i xφDefinition 21 (LDsubset G of A. Terms and formulas in LDn ). The language LDn extends Lobjn are defined as follows:n by adding the distributed knowledge operator D G , for every non-emptyt ::= x | c | f k(t1, . . . , tk)φ ::= P k(t1, . . . , tk) | t = t(cid:3) | Admi(t) | ¬φ | φ → φ(cid:3) | K iφ | D G φ | ∀i xφThe formula D G φ intuitively means that “φ is distributed knowledge among the agents in the subset G of A” (see [15]for details). We will show that the language Lobjn isnuseful for the application to distributed systems in Section 5. The notions defined in this subsection for language Ln can beextended to LDis expressive enough for the specification of objectual SGS, while LDn with the obvious changes. In this paper we do not consider extensions to common knowledge.n and LobjF. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10139913.2. ExpressivenessThis section provides some examples of the expressiveness of the first-order epistemic languages introduced in Sec-tion 3.1. First of all, in Ln we can express the agents’ knowledge regarding properties and relationships among individuals.For instance, consider the following specifications:(1) Agent i knows that for every process x, agent j knows that there exists a precondition x(cid:3)considered by i, which has tobe fulfilled in order for x to be executed.(2) Agent i knows that among the inputs considered by agent j there exists an x for which agent j does not know that(cid:3)every computation xon input x fails.(3) Every successful transmission x returns a code z, but agent i does not know this code (maybe because the return codeis encrypted).These statements can be intuitively formalised as follows:(cid:3)) ∧ (Executed(x) → Fulfil(x(1) K i∀i x(Process(x) → K j∃i x(cid:3))))(2) K i∃ j x(Input(x) ∧ ¬K j∀ j x(3) ∀i x∃i z(z = return-code(x) ∧ ¬K i(z = return-code(x))(cid:3)(Precond(x(cid:3)(Comp(x(cid:3)) → Fails(x, x(cid:3)))))We note the rich expressiveness of the language obtained by combining epistemic modalities with quantifiers, and theinterplay between local and global terms in the third specification (but see also Section 5.1 below).Also, observe that in this framework we can model the knowledge agents have about themselves, as pointed out in theintroduction. In addition, and not discussed above, we obviously retain all the expressive power of propositional epistemiclogic.Further, in the framework of first-order epistemic logic we can express the de re/de dicto distinction, i.e., the differencebetween knowing of something as being so-and-so, and knowing that something is so-and-so. For instance, when we usean informal specification to say that,as far as the security controller is concerned, every user is authorised to access the site,one could interpret this (hence implement it!) as either de dicto, i.e., descriptively:(1) the security controller knows that every user is authorised to access the site,or de re, i.e., prescriptively:(2) for every user, the security controller knows that he is authorised to access the site.These two readings express different concepts. While these cannot be easily separated by means of a propositional language,in Ln this is promptly done as follows:(1) KSecCon∀SecConx(Authorised(x) → Access(x))(2) ∀SecConx(Authorised(x) → KSecConAccess(x))The difference in meaning between the two specifications is clear. For instance, the security controller not granting accessto an authorised user a is a violation of (2), but not of (1), if he does not regard a as an authorised user.3.3. Kripke models and quantified interpreted systemsWe now proceed to interpret our first-order epistemic languages on the classes of Kripke frames defined in Section 2.Then we introduce quantified interpreted systems, a valued version of the systems of global states.Definition 22 (Kripke model). A Kripke model based on a frame F , or model, is a pair M = (cid:8)F , I(cid:9) where the interpretationI is such that:• if c is a global constant, then I(c) ∈ D;• if d is a local constant, then I(d) ∈ F ;• if(I( f k)((cid:18)g))(w) = I( f k)(g1(w), . . . , gk(w));f k is a k-ary function symbol, then I( f k) is a k-ary function from F k to F such that for (cid:18)g ∈ F k, we have• for w ∈ W , I(P k, w) is a k-ary relation on D, I(Admi, w) = D i ∪ F i , and I(=, w) is the equality relation on D.992F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013In a Kripke model global constants are interpreted rigidly, while local constants are not, so it can be the case that I(d)(w)(cid:3)) /∈ D i . This case modelsis different from I(d)(wthe scenario in which agent i does not know whether the denotation of term d is among the individuals in her domain ofquantification. Shortly we will see how to deal with this situation.. In particular, it can be the case that I(d)(w) ∈ D i but I(d)(w(cid:3)), for w (cid:11)= w(cid:3)Each I( f k) is a function from F k to F , but if the arguments are constant functions, i.e., elements in D, then I( f k) is afunction from Dk to D. The condition on I( f k) guarantees that identical terms can be substituted, that is, if the denotationsof terms tare identical, then the denotation of substituted term t[ y/t(cid:3)] is identical to t[ y/tand t(cid:3)(cid:3)].(cid:3)(cid:3)(cid:3)Finally, we remark that Admi is an intensional predicate, i.e., its interpretation is D i ∪ F i , not just a subset of D; this isbecause we consider domains of intensional objects as well as domains of individuals.We will consider also varying, regular, and objectual models, based on varying, regular, and objectual frames.Now let σ be an assignment, i.e., any function from GVar to D and from LVar to F .Definition 23 (Valuation). The valuation Iσ (t, w) ∈ D of a term t at a world w is inductively defined as follows:Iσ (x, w) = Iσ (x) = σ (x)Iσ (z, w) = Iσ (z)(w) = σ (z)(w)Iσ (c, w) = Iσ (c) = I(c)Iσ (d, w) = Iσ (d)(w) = I(d)(w)Iσ ( f k(t1, . . . , tk), w) = I( f k)(Iσ (t1, w), . . . , Iσ (tk, w))= (I( f k)(Iσ (t1), . . . , Iσ (tk)))(w), by the constraint on I( f k)The definition of Iσ (t) ∈ D ∪ F can be derived from Definition 23. Note that if t is a global term, then Iσ (t) = Iσ (t, w),for every w ∈ W . On the other hand, if t is a local term, then Iσ (t) is an intensional object belonging to F . The valuationof terms in LobjnThe variant σ(cid:2)zfof an assignment σ assigns a ∈ D to x ∈ GVar and coincides with σ on all the other variables; thefor f ∈ F , z ∈ LVar is similarly defined.is restricted to global terms.(cid:2)variant σxa(cid:3)(cid:3)Definition 24 (Satisfaction). The satisfaction relation |(cid:20) for φ ∈ Ln, w ∈ W , and an assignment σ is inductively defined asfollows:(cid:3)(Mσ , w) |(cid:20) P k(t1, . . . , tk)(Mσ , w) |(cid:20) t = t(Mσ , w) |(cid:20) Admi(t)(Mσ , w) |(cid:20) ¬ψ(Mσ , w) |(cid:20) ψ → ψ (cid:3)(Mσ , w) |(cid:20) K iψ(Mσ , w) |(cid:20) ∀i xψ(Mσ , w) |(cid:20) ∀i zψiffiffiffiffiffiffiffiff(cid:8)Iσ (t1, w), . . . , Iσ (tk, w)(cid:9) ∈ I(P k, w)(cid:3), w)Iσ (t, w) = Iσ (tIσ (t) ∈ D i ∪ F i(Mσ , w) (cid:11)|(cid:20) ψ(Mσ , w) (cid:11)|(cid:20) ψ or (Mσ , w) |(cid:20) ψ (cid:3)(cid:3) ∈ W , w ∼i wfor all wfor all a ∈ D i, (Mσ (xfor all f ∈ F i, (Mσ ( za), w) |(cid:20) ψf ), w) |(cid:20) ψ(cid:3)implies (Mσ , w(cid:3)) |(cid:20) ψThe truth conditions for formulas containing ⊥, ∧, ∨, ↔, ∃i can be defined from those above. The formula Admi(t)means that the individual Iσ (t) ∈ D i ∪ F i is among those admissible for agent i. In particular, if t is a global term thenIσ (t) = Iσ (t, w) ∈ D i . On the other hand, if t is a local term then Iσ (t) is an intensional object in F i .If we consider varying models, the definition of satisfaction is as above but for the following clauses:Definition 25. The satisfaction relation |(cid:20) for φ ∈ Ln, w ∈ W , and an assignment σ is inductively defined as follows:(Mσ , w) |(cid:20) Admi(t)(Mσ , w) |(cid:20) ∀i xψ(Mσ , w) |(cid:20) ∀i zψiffiffiffIσ (t) ∈ D i(w) ∪ F i(w)for all a ∈ D i(w), (Mσ (xfor all f ∈ F i(w), (Mσ ( za), w) |(cid:20) ψf ), w) |(cid:20) ψThe meaning of a formula φ ∈ LobjnFurther, the truth conditions for D G φ ∈ LDin an objectual model M is defined by restricting Definition 24 to global terms.n in objectual models are specified as follows:(Mσ , w) |(cid:20) D G ψ ifffor w(cid:3) ∈ W , (w, w(cid:3)) ∈∼iimplies (Mσ , w(cid:3)) |(cid:20) ψ(cid:4)i∈GF. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013993As customary, we say that a formula φ is true at a world w iff it is satisfied at w by every assignment σ ; φ is valid on amodel M iff it is true at every world in M; φ is valid on a frame F iff it is valid on every model based on F ; φ is valid on aclass C of frames iff it is valid on every frame in C.Let (cid:7) be a set of formulas, M is a model for (cid:7), or M |(cid:20) (cid:7), iff every formula in (cid:7) is valid on M, and F is a framefor (cid:7), or F |(cid:20) (cid:7), iff every model based on F is a model for (cid:7). A frame F for (cid:7) will also be called (cid:7)-frame, by (cid:7)-K wedenote the class of (cid:7)-frames.We have now the formal machinery to introduce quantified interpreted systems as follows.Definition 26 (Quantified interpreted systems). Given an SGS S, a quantified interpreted systems (QIS) is a pair P = (cid:8)S, I(cid:9)such that I is an interpretation of Ln in f (S).The notions of satisfaction, truth and validity on QIS can be defined as above. Let P f = (cid:8) f (S), I(cid:9) be the Kripke modelassociated with the quantified interpreted system P = (cid:8)S, I(cid:9), then(P σ , s) |(cid:20) φ iff(P σf , s) |(cid:20) φIn particular, we can show that the truth conditions for epistemic modalities in interpreted systems are preserved, that is,the definition above via Kripke models boils down to the usual truth conditions in interpreted systems:(P σ , s) |(cid:20) K iψ iff(P σ , s) |(cid:20) D G ψ ifffor sfor s(cid:3) ∈ S, li(s) = li(s(cid:3)) implies (P σ , s(cid:3) ∈ S, if for all i ∈ G, li(s) = li(s(cid:3)) |(cid:20) ψ(cid:3)), then (P σ , s(cid:3)) |(cid:20) ψWe say that a formula φ ∈ Ln is valid on a quantified interpreted systems P iff φ is valid on P f .Definition 26 applies also to the other classes of SGS.Definition 27.(varying QIS) Given a varying SGS S, a varying QIS is a pair P = (cid:8)S, I(cid:9) such that I is an interpretation of Ln in f var(S).(regular QIS) Given a regular SGS S, a regular QIS is a pair P = (cid:8)S, I(cid:9) such that I is an interpretation of Ln in f var(S).(objectual QIS) Given an objectual SGS S, an objectual QIS is a pair P = (cid:8)S, I(cid:9) such that I is an interpretation of Lobjnin f obj(S).(QISk) Let 2 (cid:2) k (cid:2) 6. Given an SGS S ∈ SGSk, a QISk is a pair P = (cid:8)S, I(cid:9) such that I is an interpretation of Ln in f (S).Quantified interpreted systems will be used in Sections 5 and 6 to model various instances of multi-agent systems. Butfirst we discuss some important validities in these structures.3.4. ValiditiesIn Section 2 we remarked that in systems of global states the domains of quantification D i and F i are independent fromglobal states. Therefore, both the Barcan formula and its converse [16] are valid in their indexed form on the class of allSGS:SGS |(cid:20) ∀i y K jφ → K j∀i yφSGS |(cid:20) K j∀i yφ → ∀i y K jφBFi− jCBFi− jThese validities state that each agent knows which are the individuals she and the other agents reason about. By BFi− j inall agent j’s epistemic alternatives there are no more individuals in agent i’s domains than j presently considers, so agentj can generalise her knowledge. Similarly, by CBFi− j in all agent j’s epistemic alternatives there are no fewer individualsin agent i’s domains, so agent j can particularise her knowledge. When an agent can generalise and particularise herknowledge on a domain of objects, we say that she has knowledge of that domain, at least implicitly.For the same reasons we have also that:SGS |(cid:20) Adm j(t) → K iAdm j(t)SGS |(cid:20) ¬Adm j(t) → K i¬Adm j(t)NecAdmNec¬AdmBy these validities every agent knows whether any individual belongs to the domain of admissible individuals of any otheragent. In the language LDn the Barcan formulas hold also for the distributed knowledge operator D G :994F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013SGS |(cid:20) ∀i y D G φ → D G ∀i yφSGS |(cid:20) D G ∀i yφ → ∀i y D G φSGS |(cid:20) Adm j(t) → D G Adm j(t)SGS |(cid:20) ¬Adm j(t) → D G ¬Adm j(t)These principles are rather strong even for an external account of knowledge, in which knowledge is not explicitly possessedby agents, but rather attributed to them by an external observer. After all, we introduced different domains of quantificationfor expressing that each agent has only a limited access to the totality of individuals. If they know all other agents’ domainsas well as theirs, the whole construction seems questionable. Given this, we could turn to varying SGS, where all formulasabove are not valid, as quantification domains change according to global states. But this would undermine the agents’knowledge of their own domains, something equally unwelcomed.Our solution consists in admitting BFi− j and CBFi− j only for i = j. In fact, these formulas hold on the class of regularSGS:BFi−iSGS reg |(cid:20) ∀i y K iφ → K i∀i yφSGS reg |(cid:20) K i∀i yφ → ∀i y K iφCBFi−iIn this way we solve the problem of having quantification domains D i(s) and F i(s), for i ∈ A, depending also on the localstates of agents other than i: in regular SGS quantification domains can be considered part of each agent’s local state. Byrestricting our attention to regular SGS satisfying the restricted versions BFi−i and CBFi−i of the Barcan formulas, we modelthe scenario in which agents know their respective domains of quantification, but not necessarily the other agents’.Finally, we remark that in the present semantical framework we admit possibilia, i.e., objects in D and F which donot appear in quantification domains D i or F i , for some agent i ∈ A. Moreover, agents may have knowledge about thesepossible entities, that is, there are models in which K i P (t) is true at some world w, for some Iσ (t, w) belonging to D, butIσ (t, w) /∈ D i . The existence of something like possible objects is a rather debated topic in the philosophy of modal logic,see [40] and [35] for a review of classic possibilist and actualist accounts. However, in AI the introduction of possibilia can beuseful to model specific scenarios. For instance, an agent i may know that no horse flies, i.e., ∀i xK i¬(Horse(x) ∧ Fly(x)), andyet she studied the Greek classics and knows that Pegasus is a flying horse, i.e., K i(Horse(Pegasus) ∧ Fly(Pegasus)). A solutionto this puzzle consists in considering Pegasus a possible object in D \ D i .3.5. Individual terms and identityAs regards identity, observe that the following formulas hold for global terms on every system of global states:SGS |(cid:20) (s = sSGS |(cid:20) (s = sSGS |(cid:20) (s (cid:11)= s(cid:3)(cid:3)(cid:3)) → (φ[x/s] → φ[x/s) → K i(s = s) → K i(s (cid:11)= s))(cid:3)(cid:3)(cid:3)])SubstK iIdK iDifbut not for local terms:SGS (cid:11)|(cid:20) (u = uSGS (cid:11)|(cid:20) (u = uSGS (cid:11)|(cid:20) (u (cid:11)= u(cid:3)(cid:3)(cid:3)) → (φ[z/u] → φ[z/u) → K i(u = u) → K i(u (cid:11)= u))(cid:3)(cid:3)(cid:3)])These (in)validities motivate the names of flexible and rigid terms given in [46]. Identical global terms can be substituted inany formula, in particular in epistemic contexts; whereas for local terms we have only:(cid:3)]),) → (φ[z/u] → φ[z/uSGS |(cid:20) (u = ufor atomic φ(cid:3)but φ has to be different from Admi(u):(cid:3)SGS (cid:11)|(cid:20) (u = u) → (Admi(u) → Admi(u(cid:3)))as Admi is an intensional predicate and it can be that the individuals Iσ (u, w), Iσ (uobject Iσ (u) belongs to F i but Iσ (u(cid:3)) /∈ F i .(cid:3), w) ∈ D are identical, the intensionalThe relationship between local and global terms is particularly relevant for the present investigations. We remarked that, and yet we may have that Iσ (u)(s) ∈ D i andit can be the case that agent i cannot distinguish between states s and s(cid:3)) /∈ D i , for some local term u. This means that in state s agent i is aware of the object being denoted by u, but sheIσ (u)(sdoes not know that she is. This feature of the semantics can be considered unsatisfactory, but one should note that agentsdo not always explicitly know their domains of quantification, as it is the case in varying QIS. However, it is possible to(cid:3)) ∈ D i .address the point above by assuming formula (2): for every i ∈ A, for f ∈ F , if li(s) = li(sWe can capture this constraint by means of the following formula:(cid:3)) and f (s) ∈ D i , then f (s(cid:3)∃i x(d = x) → K i∃i x(d = x)(13)F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013995We can easily check that the following correspondence holds:S |(cid:20) ∃i x(d = x) → K i∃i x(d = x)iff S satisfies formula (2)Further, we can restrict this principle to only the intensional objects contained in each F i . According to formula (3), an agenti knows the denotation of only the intensional objects in his domain of quantification. Similarly to the above, this formulacan by captured by means of a formula in Ln:∀i z(∃i x(z = x) → K i∃i x(z = x))(14)The following correspondence can be promptly proved:S |(cid:20) ∀i z(∃i x(z = x) → K i∃i x(z = x))iff S satisfies formula (3)Finally, we strengthen formula (14) by requiring that the denotation of every local term in the domain of agent i is un-conditionally an individual belonging to agent i’s domain of individuals, that is, formula (4) holds. Also in this case we canprovide a formal counterpart to this formula in Ln,∀i zK i∃i x(z = x)by noting that the following correspondence holds:S |(cid:20) ∀i zK i∃i x(z = x)iff S satisfies formula (4)(15)Moreover, we can require that each agent i knows at least the denotation of the local terms in her domain of quantifi-cation. This is tantamount to formula (5), which can be captured by the following formula in Ln:∀i z((z = u) → K i(z = u))(16)similarly to the above, we can prove that the following correspondence holds:S |(cid:20) ∀i z((z = u) → K i(z = u))iff S satisfies formula (5)We can combine formulas (16) and (15) in order to express formula (6), i.e., the fact each agent i knows the denotationof local terms, which is an individual in her domain of quantification. We express formula (6) by means of the followingformula in Ln:∀i z∃i xK i(z = x)and the respective correspondence holds:S |(cid:20) ∀i z∃i xK i(z = x)iff S satisfies formula (6)(17)Note that formula (17) is the de re version of (15). According to (17) for every local term u, there is exactly one individualwhich is known by agent i to be the denotation of u.In the next section we will consider formulas (13)–(17) and we will prove completeness of the semantical classes intro-duced with respect to the relevant axiomatisations. As a summary, in the next lemma we list formulas and correspondingclasses of systems of global states and Kripke frames.Lemma 28. In the table below, for every row, the formula in the first column is valid on all and only the SGS in the second column, andit is valid in all and only frames in the third column.FormulasSGSFrames∀i y K i φ ↔ K i ∀i yφ(13) ∃i x(d = x) → K i ∃i x(d = x)(14) ∀i z(∃i x(z = x) → K i ∃i x(z = x))(15) ∀i zK i ∃i x(z = x)(16) ∀i z((z = u) → K i (z = u))(17) ∀i z∃i xK i (z = x)SGS regSGS 2SGS 3SGS 4SGS 5SGS 6KregK2K3K4K5K6Proof. We do not provide the details of the proof, but just note that the validity of formulas on the corresponding classes ofSGS follows by the remarks earlier in this section, while the validity on Kripke frames follows by corollaries (15)–(18). (cid:2)We remark that classes SGS 6 of systems of global states and K6 of Kripke frames are tantamount to the intersectionsSGS 4 ∩ SGS 5 and K4 ∩ K5 respectively.996F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10134. AxiomatisationsIn this section we introduce sound and complete axiomatisations for all the classes of SGS presented in Sections 2 and 3.We start by considering the first-order epistemic system Q .S5n, then we tune this calculus to cover also varying, objectual,and regular SGS, as well as the structures satisfying formulas (2)–(12). While resolution and natural deduction calculi aremore suitable when dealing with automated reasoning, for the purpose of the completeness proof Hilbert-style systems areeasier to handle.4.1. System Q .S5nThe system Q .S5n on the language Ln is a first-order multi-modal version of the propositional system S5. Hereafter welist the axioms and inference rules. We use ⇒ to denote the inference relation between formulas.Definition 29 ( Q .S5n). The system Q .S5n on Ln contains the following schemes of axioms and inference rules:TautKT45MPNecExGenBFi− jCBFi− jIdFuncSubstK i IdK i Difevery instance of classic propositional tautologiesK i (φ → ψ) → (K i φ → K i ψ)K i φ → φK i φ → K i K i φ¬K i φ → K i ¬K i φφ → ψ, φ ⇒ ψφ ⇒ K i φ∀i yφ → (Admi (t) → φ[ y/t])φ → (Admi (t) → ψ[ y/t]) ⇒ φ → ∀i yψ, for y not free in φ∀i y K j φ → K j ∀i yφK j ∀i yφ → ∀i y K j φt = tt = tt = ts = ss (cid:11)= s(cid:3) → (t(cid:3)(cid:3)[ y/t(cid:3)(cid:3)[ y/t] = t(cid:3) → (φ[ y/t] → φ[ y/t(cid:3) → K i (s = s(cid:3) → K i (s (cid:11)= s(cid:3)])(cid:3)]), for atomic φ(cid:3))(cid:3))The first group of postulates axiomatises the multi-modal system S5n. Following this, we have the free logic postulatesfor quantification for both global and local terms. The Barcan formulas guarantee that the domains of admissible individualsare independent from global states, as shown below. Finally, we have axioms Id, Func and Subst for all terms, while K iIdand K iDif hold only for global terms. We note without proof that the axioms Subst and K iId are sufficient for deriving thesubstitution of identical global terms in any first-order modal formula φ.We define proofs and theorems as standard: (cid:23)Q .S5n φ means that φ ∈ Ln is a theorem in Q .S5n. Moreover, we say thatφ ∈ Ln is derivable in Q .S5n from the set (cid:7) of formulas in Ln, and write (cid:7) (cid:23)Q .S5n φ, iff there are φ1, . . . , φm ∈ (cid:7) such that(cid:23)Q .S5n φ1 ∧ · · · ∧ φm → φ.Lemma 30. Among the theorems of Q .S5n we have:NecAdmNec¬Adm(cid:23)Q .S5n Admi (t) → K j Admi (t)(cid:23)Q .S5n¬Admi (t) → K j ¬Admi (t)Knowledge of AdmissibilityKnowledge of InadmissibilityProof. The proof for NecAdm goes as follows:a. (cid:23)Q .S5n Admi(t) → Admi(t)b. (cid:23)Q .S5n∀i yAdmi( y)c. (cid:23)Q .S5n K j∀i yAdmi( y)d. (cid:23)Q .S5ne. (cid:23)Q .S5n K j∀i yAdmi( y) → (Admi(t) → K jAdmi(t))f. (cid:23)Q .S5n Admi(t) → K jAdmi(t)∀i y K jAdmi( y) → (Admi(t) → K jAdmi(t)) axiom Exfrom d by CBFi− jfrom c, e by MPpropositional tautologyfrom a by Genfrom b by NecThe proof for Nec¬Adm can be obtained similarly. (cid:2)4.2. Further systemsBy suitably tuning the systems Q .S5n we can obtain provably sound and complete axiomatisations for all classes ofSGS in Sections 2 and 3. For instance, by dropping BFi− j and CBFi− j , and by restricting these postulates to i = j, we canaxiomatise varying and regular SGS respectively. Further, we can axiomatise objectual SGS by restricting Q .S5n to formulasF. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013997where only global terms appear. Finally, we add the axioms for distributed knowledge to Q .S5n in order to axiomatise theset of validities on the language LDn . Hereafter we list the relevant systems.Definition 31.(Q.S5varn ) The system Q .S5varn on the language Ln is obtained from Q .S5n by eliminating the axioms BFi− j and CBFi− j .(Q.S5(Q.S5regn ) The systems Q .S5regn on the language Ln is obtained from Q .S5n by restricting BFi− j and CBFi− j to i = j.objn ) The system Q .S5objnis obtained by restricting Q .S5n to the language Lobjn .n ) The system Q .S5D(Q.S5Ddistributed knowledge:n on the language LDn is obtained by extending Q .S5objn with the following postulates forKT45D1D2NecD G (φ → ψ) → (D G φ → D G ψ)D G φ → φD G φ → D G D G φ¬D G φ → D G ¬D G φD{i}φ ↔ K i φD G φ → D G(cid:3) , for G ⊆ Gφ ⇒ D G φ(cid:3)(Q.S5kn) For 2 (cid:2) k (cid:2) 6, the system Q .S5kn is obtained by adding formula (k + 11) to Q .S5n.Note that formulas NecAdm and Nec¬Adm are not provable in Q .S5varn , while for system Q .S5regn we have only restrictedversions of NecAdm and Nec¬Adm, for i = j.4.3. Correspondence theoryIn this section we define a correspondence theory between properties of frames and validity of formulas at first-order.In what follows a systems S is identified with the set of its theorems.Lemma 32. Let 2 (cid:2) k (cid:2) 6. In the following table, for each row, F is an S-frame, i.e., F |(cid:20) S, iff F belongs to the class of frames in thesecond column.QML systemsKripke framesQ .S5nQ .S5varnQ .S5regnQ .S5objnQ .S5DnQ .S5knKKvarKregKobjKobjKkProof. We provide an outline of the proof by showing the right to left implications for some systems. We show that (cid:23)S φimplies F |(cid:20) φ, where F belongs to the relevant class of frames. The proof is by induction on the length of the proof of φin S, axioms are the base case and inference rules are the inductive step.Q.S5n. We can easily check that the axioms of Q .S5n hold on every Kripke model and the inference rules preservevalidity. We provide detailed proofs only for axioms BFi− j , and K iId. As regards BFi− j , assume that (Mσ , w) |(cid:20) ∀i zK jφ.f ∈ F i ,This means that for allimplies (Mσ ( zw ∼ j w(cid:3)) |(cid:20) φ. Therefore, for all wimplies (Mσ ( z(cid:3) ∈ W , w ∼ j w(cid:3) ∈ W , for allf ), w(cid:3)(cid:3)f ∈ F i , for all wf ), wAs to K iId, suppose that (Mσ , w) |(cid:20) s = s(cid:3)) because s and s(cid:3)(cid:3), wn . Proving that the axioms of Q .S5varQ.S5varvalidity can be done similarly as in the previous case.(cid:3)) |(cid:20) φ, that is, (Mσ , w) |(cid:20) K j∀i zφ.(cid:3)are global terms. Therefore (Mσ , wand w ∼ j wIσ (s(cid:3). By the first hypothesis Iσ (s, w) = Iσ (s(cid:3)).and (Mσ , w) |(cid:20) K i(s = s(cid:3)) |(cid:20) s = s(cid:3)(cid:3), w), and Iσ (s, w(cid:3)) =n hold on every varying Kripke model, and that the inference rules preserveQ.S5regn . We show that axiom CBFi−i holds on every regular Kripke model; the rest may be done similarly to the case(cid:3)), we haveQ .S5n. Assume that (Mσ , w) |(cid:20) K i∀i xφ. This means that for any w(Mσ (ximplies (Mσ (xQ.S5(cid:3)). So, (Mσ , w) |(cid:20) ∀i K i xφ.a), w(cid:3)objn . We show that axiom D2 holds in every objectual Kripke model. Assume that (Mσ , w) |(cid:20) D G φ and G ⊆ G.(cid:5)i∈G(cid:3) ∼i implies(cid:3)(cid:3)) |(cid:20) φ for any a ∈ D(w(cid:3)) |(cid:20) φ. But since D i(w) = D i(w(cid:3) ∈ W , w ∼i wa), wimplies that for a ∈ D i(w(cid:3)), w ∼i w(cid:5)∼i implies (Mσ , w(cid:3)) |(cid:20) φ. But G ⊆ G, so (w, w(cid:3)) ∈(cid:3)) ∈i∈G(cid:3)(cid:3)This means that for any w, w(Mσ , w(cid:3) ∈ W , (w, w(cid:3)) |(cid:20) φ. Therefore, (Mσ , w) |(cid:20) D G(cid:3) φ.998F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013Q.S56n. We show that formula (17) holds in SGS 6 = SGS 4 ∩ SGS 5. Assume that f ∈ F i , by the constraint on SGS 4 we(cid:3)) = a ∈ D i by the constraint on SGS 5. Thus,(cid:3)) then f (s) = f (sknow that there exists an a = f (s) ∈ D i . Further, if li(s) = li(s∀i z∃i xK i(z = x) holds.As regards the left to right implication, we consider the cases for Q .S51Q.S51n. Assume that F |(cid:20) ∃i x(d = x) → K i∃i x(d = x), w ∼i w(cid:3)n and Q .S53n .I(d) = f . This means that (M, w) |(cid:20) ∃i x(d = x), therefore (M, w) |(cid:20) K i∃i x(d = x). Hence, (M, wtantamount to f (w(cid:3)) ∈ D i .and f (w) ∈ D i . Define a model M based on F such that(cid:3)) |(cid:20) ∃i x(d = x), which isQ.S53n. Assume that F |(cid:20) ∀i zK i∃i x(z = x), w ∈ W , and f ∈ F i . Let M be a model based on F , we have that (M, w) |(cid:20)∀i zK i∃i x(z = x), in particular (Mσ , w) |(cid:20) ∃i x(z = x), for σ (z) = f . Thus, there exists a ∈ D i such that a = f (w) ∈ D i . (cid:2)We note that a result similar to Lemma 32 can be obtained also for systems of global states by means of the maps inSection 2.5. We say that P is a QIS for a system S iff every theorem of S is valid on P , and S is an SGS for S, or S-SGS, iffevery model based on S is a model for S. We write S-SGS for denoting the class of S-SGS.Lemma 33. Let 2 (cid:2) k (cid:2) 6. The following identities between classes of SGS hold:Q .S5n-SGS = SGSQ .S5varQ .S5regQ .S5objn -SGS = SGS varn -SGS = SGS regn -SGS = SGS objn -SGS = SGS objn-SGS = SGSkQ .S5DQ .S5kProof. The identities above follow from Lemma 32 and the maps in Section 2.5 (cid:2)4.4. SoundnessIn showing that our QML systems are sound and complete axiomatisations of the corresponding classes of system ofglobal states we first prove soundness.Lemma 34 (Soundness). Every QML system S is sound with respect to the class of frames for S, therefore S is sound also with respectto the class of SGS for S.Proof. We observe that by the right to left implication of Lemma 32 if (cid:23)S φ then F |(cid:20) φ, where F belongs to the class ofS-frames. By the definition of validity on systems of global states, we obtain that (cid:23)S φ implies S |(cid:20) φ, where S belongs tothe class of S-SGS. (cid:2)We summarise the soundness results in the following table. Let 2 (cid:2) k (cid:2) 6, for any row, the QML system in the firstcolumn is sound with respect to the corresponding class of frames in the second column, and therefore it is sound for thecorresponding class of SGS in the third column.QML systemsKripke framesSystems of global statesQ .S5nQ .S5varnQ .S5regnQ .S5objnQ .S5DnQ .S5knKKvarKregKobjKobjKkSGSSGS varSGS regSGS objSGS objSGSk4.5. Completeness of Q .S5nThis section is devoted to showing completeness for the QML systems introduced above with respect to the correspond-ing classes of Kripke frames. The completeness of Q .S5n is proved by means of standard techniques in quantified modallogic [16,19,30] suitably extended to fit in the present framework with indexed quantifiers and modalities, local terms,identity. Specifically, we adopt the particular version of canonical models given by Thomason in [60] for languages withan existence predicate. As standard, we show that if (cid:2)Q .S5n φ then there exists a Kripke model M such that M (cid:11)|(cid:20) φ. Inparticular, we show that the canonical model MQ .S5n for Q .S5n to be defined below is a model according to Definition 22,it is based on a frame for Q .S5n and MQ .S5n (cid:11)|(cid:20) φ. Therefore, the following is a sufficient condition to prove completeness.F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013999Proposition 35. If Q .S5n does not prove a formula φ ∈ Ln, then the canonical model MQ .S5n for Q .S5n does not validate φ.This result relies on two lemmas: the saturation lemma and the truth lemma. Their proofs need the following definitions,where Liφ is defined as ¬K i¬φ and Λ is any set of formulas in Ln:Λ is consistentΛ is maximalΛ is max-consΛ is richΛ is L j-richΛ is saturated⊥;for every φ ∈ Ln, either φ ∈ Λ or ¬φ ∈ Λ;iff Λ (cid:2)Q .S5niffiff Λ is consistent and maximal;iff ∃i yφ ∈ Λ implies that there is a term t ∈ Lnsuch that Admi(t) ∧ φ[ y/t] ∈ Λ;iff φ0 ∧ L j(φ1 ∧ · · · ∧ L j(φk ∧ L j∃i yφk+1) . . .) ∈ Λfor y not free in φ0, . . . , φk implies there is t ∈ Ln such thatφ0 ∧ L j(φ1 ∧ · · · ∧ L j(φk ∧ L j(Admi(t) ∧ φk+1[ y/t])) . . .) ∈ Λ,iff Λ is max-cons, rich and L j-rich, for every j ∈ AThe constraint on L j -richness, which is due to Thomason [60], is needed in order to guarantee that the canonical model forQ .S5n has a single outer domain D. We briefly sketch the proof of the saturation lemma and refer to [30] for details; theextension to the multi-modal case is straightforward.Lemma 36 (Saturation lemma). If (cid:7) is a consistent set of the formulas in Ln, then it can be extended to a saturated set Π on someexpansion L+n obtained by adding to Ln an infinite set of new local constants and an infinite set of new global constants.Proof. Let θ0, θ1, . . . be an enumeration of the formulas in L+constants m0, m1, . . . . We define by recursion a chain of sets of formulas in L+n as follows:n , and let there be enumerations of the new global and localΓ0 = (cid:7)Γ2n+1 =Γ2n+2 =(cid:6)⎧⎪⎨⎪⎩Γ2n ∪ {Admi(m2n) ∧ θn[ y/m2n]}if Γ2n ∪ {∃ yθn} is consistent andm2n /∈ Γ2n ∪ {θn} is the first new constant;otherwiseΓ2nΓ2n+1 ∪ {φ0 ∧ L j(φ1 ∧ · · · ∧ L j(φk ∧ L j(Admi(m2n+1) ∧ φk+1[ y/m2n+1])) . . .)}if Γ2n+1 ∪ {φ0 ∧ L j(φ1 ∧ · · · ∧ L j(φk ∧ L j∃i yφk+1) . . .)} is consistentand m2n+1 is the first variable not in Γ2n+1, φ1, . . . , φk+1;Γ2n+1 otherwiseBy induction we can prove that every Γn is consistent. Thus, by the chain lemma Γ =n∈N Γn is a consistent, rich andn , for every j ∈ A. By Lindenbaum’s lemma Γ can be extended to a saturated set Π ⊇ (cid:7) inL j -rich set of formulas in L+L+n . (cid:2)(cid:11)As a result, if (cid:2)Q .S5n φ then the set {¬φ} is consistent and by the saturation lemma we obtain a saturated set Π ⊇ {¬φ}.In order to introduce the canonical model MQ .S5n for Q .S5n we need a few more definitions. For closed global terms(cid:3)} to be the equivalence(cid:3), define v ∼w v(cid:3)) ∈ w. This is an equivalence relation and we take [v]w = {v(cid:3) | v ∼w viff (v = v(cid:3)v, vclass of v in w.The accessibility relation in MQ .S5n is defined so that w R i w(cid:3)iff {φ | K iφ ∈ w} ⊆ w(cid:3): by axioms T , 4 and 5 we can showthat R i is an equivalence relation.Further, by axioms K i Id and K iDif the definition of [v]w is provably independent from the choice of w and v – i.e.,implies [v]w = [v]w(cid:3) – so we simply write [v]. We define each D i(w) as the set {[v] | Admi(v) ∈ w}. By NecAdm andw R i wNec¬Adm we can show that also this definition is independent from the choice of w, therefore we simply write D i .(cid:3)Moreover, for every closed local term r we introduce a function fr such that:(cid:12)fr(w) =[v]{r(cid:3) | (rif there is a v such that (r = v) ∈ w;(cid:3) = r) ∈ w} otherwiseEach F i(w) is the set { fr | Admi(r) ∈ w}: by NecAdm and Nec¬Adm also this definition is provably independent from thechoice of w, so we simply write F i .Given these definitions, we present the canonical model for Q .S5n as follows:Definition 37. The canonical model for Q .S5n on the language Ln, with an expansion L+n ,(cid:8)W , {R i}i∈ A, D, {D i}i∈ A, F , {F i}i∈ A, I(cid:9) such that:is the tuple MQ .S5n =• W is the set of all saturated sets of formulas in L+n ;(cid:3)• for i ∈ A, w, w;iff {φ | K iφ ∈ w} ⊆ w(cid:3) ∈ W , w R i w(cid:3)1000F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013• the domain D of individuals is the set {[v] | v ∈ L+n} ∪ { fr(w) | r ∈ L+n , w ∈ W }, and for each i ∈ A, D i = {[v] | Admi(v) ∈w};• the domain F of intensional objects is the set { fr | r ∈ L+• I is an interpretation of L+◦ I(c) = [c] and I(d) = fd;◦ for a1, . . . , ak ∈ D ∪ F , I( f k)((cid:18)a) is a function such thatn such that:n(cid:12)I( f k)((cid:18)a)(w) =[ f k((cid:18)v)]f f k((cid:18)e)(w)if every ai = [v i];for ei = v i if ai = [v i], or ei = ri if ai = fri}, and for each i ∈ A, F i = { fr | Admi(r) ∈ w};◦ for a1, . . . , ak ∈ D, (cid:8)(cid:18)a(cid:9) ∈ I(P k, w) iff P k((cid:18)e) ∈ w, for ei = v i and ai = [v i], or ei = ri and ai = fri (w).Note that the interpretation of functions and predicates is well defined by axioms F unc and Subst. The following propo-sition holds by the remarks above.Proposition 38. The canonical model MQ .S5n for Q .S5n satisfies the constraints in Definition 22, so MQ .S5n is a Kripke model.Proof. Assume that (cid:2)Q .S5n φ, then the set {¬φ} is consistent, so by Lemma 36 it can be extended to a saturated set offormulas in L+n . Therefore, the set W of possible worlds is non-empty. We remarked that by axioms T , 4 and 5, eachrelation R i is reflexive, transitive and euclidean, i.e., it is an equivalence relation. Further, the domains D and F are non-empty by definition of L+n , and each D i (respectively F i ) is trivially a subset of D (respectively F ). Finally, the interpretationI is well-defined and satisfies the constraints on Kripke models by the remarks above. (cid:2)Now let σ be an assignment for local and global variables into D and F respectively, we can show the following:Lemma 39. For every w ∈ M, t ∈ L+n , for σ ( yi) = I(ei),Iσ (t[(cid:18)y], w) = I(t[(cid:18)y/(cid:18)e])(w)Proof. This can be shown by induction on the length of t. We give the proof for t = f (t1, . . . , tk), y = z, and e = d:Iσ (t[z], w) = Iσ ( f (t1[z], . . . , tk[z]), w) = I( f )(Iσ (t1[z], w), . . . , Iσ (tk[z], w))= I( f )(I(t1[z/d])(w), . . . , I(tk[z/d])(w))= I( f )(I(t1[z/d]), . . . , I(tk[z/d]))(w)= I( f (t1[z/d], . . . , tk[z/d]))(w)= I( f (t1, . . . , tk)[z/d])(w)= I(t[z/d)(w)(cid:2)By Lemma 39 the base case of the truth lemma below follows. In the rest of this section we simply write M for MQ .S5n .Lemma 40 (Truth lemma). For every w ∈ M, φ ∈ L+n , for σ ( yi) = I(ei),(Mσ , w) |(cid:20) φ[(cid:18)y]iff φ[(cid:18)y/(cid:18)e] ∈ wProof. The proof is by induction on the structure of φ ∈ L+n .φ = P k(t1, . . . , tk). By the definition of satisfaction and Lemma 39:(Mσ , w) |(cid:20) P k(t1, . . . , tk)[(cid:18)y]iffiffiff(cid:8)Iσ (t1[(cid:18)y], w), . . . , Iσ (tk[(cid:18)y], w)(cid:9) ∈ I(P k, w)(cid:8)I(t1[(cid:18)y/(cid:18)e])(w), . . . , I(tk[(cid:18)y/(cid:18)e])(w)(cid:9) ∈ I(P k, w)P k(t1[(cid:18)y/(cid:18)e], . . . , tk[(cid:18)y/(cid:18)e]) ∈ w. Similar to the previous case.(cid:3)φ = t = tφ = ¬ψ, ψ → ψ (cid:3)the canonical model.. The cases for the propositional connectives follow by the maximality and consistency of the worlds inφ = ∀i zψ . ⇐ Assume that ∀i zψ[z, (cid:18)y/(cid:18)e] ∈ w and fAdmi(r), then ψ[r, (cid:18)y/(cid:18)e] ∈ w by Ex. By the induction hypothesis (Mσ , w) |(cid:20) ψ[r, (cid:18)y], therefore (Mσ ( zthe arbitrariness of the variant σwe obtain (Mσ , w) |(cid:20) ∀i zψ[z, (cid:18)y].(cid:2)(cid:3)is an individual in F i . This means that f = fr , for some r such thatfr), w) |(cid:20) ψ[z, (cid:18)y]. ByzfrF. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10131001⇒ Assume that ∀i zψ[z, (cid:18)y/(cid:18)e] /∈ w. Since w is max-cons, ∃i z¬ψ[z, (cid:18)y/(cid:18)e] ∈ w. But w is rich, so there exists d ∈ LCon suchthat Admi(d) ∧ ¬ψ[d, (cid:18)y/(cid:18)e] ∈ w. This means that fd ∈ F i and by induction hypothesis (Mσ , w) (cid:11)|(cid:20) ψ[d, (cid:18)y]. Thus, there isfd ∈ F i such that (Mσ ( z, w) (cid:11)|(cid:20) ψ[z, (cid:18)y], i.e., (Mσ , w) (cid:11)|(cid:20) ∀i zψ[z, (cid:18)y].)fdφ = ∀i xψ . The proof goes as in the previous case.φ = K iψ . ⇐ Assume that K iψ[(cid:18)y/(cid:18)e] ∈ w and w R i w(Mσ , w(cid:3)) |(cid:20) ψ[(cid:18)y]. Thus, (Mσ , w) |(cid:20) K iψ[(cid:18)y].(cid:13)⇒ Assume that K iψ[(cid:18)y/(cid:18)e] /∈ w. Note that the set {φ | K iφ ∈ w} ∪ {¬ψ[(cid:18)y/(cid:18)e]} is consistent: if not, there would beK iφ ∈ w, alsoφ1, . . . , φm ∈ {φ | K iφ ∈ w} such that (cid:23)K iψ[(cid:18)y/(cid:18)e] ∈ w against hypothesis. Since {φ | K iφ ∈ w} ∪ {¬ψ[(cid:18)y/(cid:18)e]} is consistent, we can extend it to a saturated set(cid:3)) |(cid:20) ¬ψ[(cid:18)y] by induction hypothesis. Hence,(cid:3)w(Mσ , w) (cid:11)|(cid:20) K iψ[(cid:18)y]. (cid:2)(see [60] for further details) such that w R i wφ → ψ[(cid:18)y/(cid:18)e]. By axiom K , (cid:23)K iφ → K iψ[(cid:18)y/(cid:18)e] and sinceand (Mσ , won L+n(cid:13)(cid:13)(cid:3)(cid:3). By definition of R i , ψ[(cid:18)y/(cid:18)e] ∈ w(cid:3)and by induction hypothesisBy the truth lemma we conclude that the canonical model M is a model for Q .S5n, based on a Kripke frame, falsifyingany unprovable formula φ. Thus, we state the following completeness result.Theorem 41 (Completeness). The system Q .S5n is complete with respect to the class K of Kripke frames, i.e., K |(cid:20) φ implies (cid:23)Q .S5n φ.Further, we have completeness also with respect to systems of global states. In fact, if (cid:2)Q .S5n φ then by Theorem 41there exists a model M = (cid:8)F , I(cid:9) based on a frame F , which falsifies φ. Define the quantified interpreted system P as(cid:8)g(F ), I(cid:9): by definition P |(cid:20) φ iff P f = (cid:8) f (g(F )), I(cid:9) models φ, but by Lemma 14 the frame f (g(F )) is isomorphic to F .Hence, P (cid:11)|(cid:20) φ. As a consequence, the following implications hold:SGS |(cid:20) φ ⇒ K |(cid:20) φ ⇒ (cid:23)Q .S5n φand we have a further completeness result.Corollary 42 (Completeness). The system Q .S5n is complete with respect to the class SGS of systems of global states, i.e., SGS |(cid:20) φimplies (cid:23)Q .S5n φ.By combining together the soundness and completeness theorems we obtain the main result of this section.Corollary 43 (Soundness and completeness). For every φ ∈ Ln,SGS |(cid:20) φ iff (cid:23)Q .S5n φWe conclude that Q .S5n is a sound and complete axiomatisation of the validities on the general class of systems ofglobal states.4.6. Completeness for other axiomatisationsWe now show how to modify the techniques applied in the previous subsection to obtain completeness also for theother classes of Kripke frames and systems of global states considered. We start with varying and regular frames.Theorem 44 (Completeness). The system Q .S5varnis complete with respect to the class Kvar of varying frames.Proof. If a formula φ ∈ Ln is not provable in Q .S5varas inDefinition 37. Note that neither NecAdm nor Nec¬Adm are theorems in Q .S5varn , so we cannot show that the various D i(w) ={[v] | Admi(v) ∈ w} and F i(w) = { fr | Admi(r) ∈ w} are independent from the choice of w. However, we can prove that thecanonical model is based on a varying Kripke frame. Also, Proposition 38 and Lemmas 39, 40 hold also for MQ .S5varn , as theirproofs do not require the Barcan formulas. Therefore, the canonical model MQ .S5varsatisfies ¬φ and we have completenessfor varying frames. (cid:2)n , then we define the canonical model MQ .S5varfor Q .S5varnnnTheorem 45 (Completeness). The system Q .S5regnis complete with respect to the class Kreg of regular frames.Proof. As regards Q .S5regon regular frames, i.e.,n , we show that the canonical model MQ .S5regn defined as in Definition 37 satisfies constraint (7)• for all w, w(cid:3) ∈ W , w R i w(cid:3)implies D i(w) = D i(w(cid:3)) and F i(w) = F i(w(cid:3)).1002F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013(cid:3)Assume that w R i wthat Admi(v) → K iAdmi(v) ∈ w, and by definition of R i also Admi(v) ∈ wthe inclusion follows by symmetry of R i . The proof of F i(w) = F i(whold also for MQ .S5and Admi(v) ∈ w. By the restricted version CBFi−i of the converse of the Barcan formula we can show(cid:3)). The other direction of(cid:3)) is similar. Further, Proposition 38 and Lemmas 39, 40n , therefore we have completeness for regular frames. (cid:2). Thus, D i(w) ⊆ D i(wreg(cid:3)By axiomatising the class of regular SGS we showed that the restricted versions of the Barcan formulas considered arepowerful enough to characterise the idea of quantification domains as part of agents’ local state.We now consider the completeness results for systems Q .S5objnand Q .S5Dbe a formula not provable in Q .S5objterms.n , we define the canonical model for Q .S5objnn with respect to objectual frames. Let φ ∈ Lobjas the restriction of MQ .S5n to constantnDefinition 46. The canonical model for Q .S5objn(cid:8)W , {R i}i∈ A, D, {D i}i∈ A, I(cid:9) such that:on the language Lobjn , with an expansion Lobj+n, is the tuple MQ .S5objn =• W is the set of all saturated sets of formulas in Lobj+n• for i ∈ A, R i and D i are defined as in Definition 37;• D = {[v] | v ∈ Lobj+• I is an interpretation of Lobj+such that:};n;n◦ I(c) = [c];◦ for a1, . . . , ak ∈ D, I( f k)((cid:18)a) = [ f k((cid:18)v)], for ai = [v i];◦ for a1, . . . , ak ∈ D, (cid:8)(cid:18)a(cid:9) ∈ I(P k, w) iff P k((cid:18)v) ∈ w, for ai = [v i].Proposition 38 and Lemmas 39 and 40 hold also for MQ .S5objn : the proof is similar to those presented earlier. It followsthat the canonical model MQ .S5objnsatisfies ¬φ, so we have completeness for objectual frames:Theorem 47 (Completeness). The system Q .S5objnis complete with respect to the class Kobj of objectual frames.As regards the system Q .S5Dn , we extend to first-order the completeness proof in [15] for proposional systems withdistributed knowledge consisting in unravelling the canonical model to obtain a model which is a tree. Note that an inde-pendent completeness proof for these systems appeared in [28].First, we consider the following definition of canonical model, where ℘+( A) is the set of non-empty subsets of A:Definition 48. The canonical model for Q .S5D(cid:8)W , {Rl}l∈ A∪℘+( A), D, {D i}i∈ A, I(cid:9) such that:n on the language LDn , with an expansion LD+n, is the tuple MQ .S5Dn =• W is the set of saturated sets of formulas in LD+• for i ∈ A, R i , D i , and D, I are defined as in Definition 46;• for G ∈ ℘+( A), w R G wiff {φ | D G φ ∈ w} ⊆ w;n.(cid:3)(cid:3)Lemma 36 holds also for the system Q .S5Dn . Therefore, if (cid:11)(cid:23)φ there exists a saturated set w ⊇ {¬φ}, so the set WQ .S5Dnof possible worlds in MQ .S5Drelations. Moreover, by axioms D1 and D2 it follows that R{i} is equal to R i and R G ⊆(cid:5)n is non-empty. By using axioms T , 4 and 5 we can show that the various R G are equivalencei∈G R i . However, in general R G (cid:11)=i∈G R i [15]. This remark gives the rationale for introducing the pseudo-satisfaction relation |(cid:20)p , defined as |(cid:20) but for the(cid:5)distributed knowledge operator D G (in what follows we simply write M for MQ .S5Dn ):(Mσ , w) |(cid:20)p D G ψ ifffor every w(cid:3) ∈ W , w R G w(cid:3)implies (Mσ , w(cid:3)) |(cid:20)p ψWe state the truth lemma for the pseudo-satisfaction relation |(cid:20)p . The proof follows the one for Lemma 40, the distributedknowledge operator D G being treated as the epistemic operator K i .Lemma 49 (Truth lemma). For w ∈ M, ψ ∈ LD+n, for σ (xi) = [v i],(Mσ , w) |(cid:20)p ψ[(cid:18)x]iff ψ[(cid:18)x/(cid:18)v] ∈ wM(cid:3)We now show that the techniques in [15] can be extended to first-order so that M can be unwound into a structuresatisfying the same formulas.In order to introduce M(cid:3)we need a few more definitions. Let w, wbe worlds in W , a path from w to wis a sequence(cid:3)(cid:3)(cid:8)w 1, l1, w 2, l2, . . . , lk−1, wk(cid:9) such that:F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10131003(cid:3) = wk;(1) w = w 1 and w(2) w 1, . . . , wk ∈ W ;(3) each l j is either an agent or a set of agents;(4) (cid:8)w j, w j+1(cid:9) ∈ Rl j .The reduction of a path (cid:8)w 1, i1, w 2, i2, . . . , ik−1, wk(cid:9) is obtained by replacing each maximal consecutive subsequence(cid:8)wq, iq, wq+1, iq+1, . . . , ir−1, wr(cid:9) where iq = iq+1 = · · · = ir−1 by (cid:8)wq, iq, wr(cid:9). A path is said to be reduced is it is equalto its reduction.l∈ A∪℘+( A), D, {D i}i∈ A, I(cid:9) we define a structure M∗ = (cid:8)Wis a tree, that is, for all w, w(cid:3)); (iii) w R(cid:3)∗G wimplies h(w)R G h(w(cid:3) ∈ W∗l∗, {R∗∗,}l∈ A∪℘+( A), D, there is at most(cid:3)); (iv) (cid:8)a1, . . . , ak(cid:9) ∈(cid:3)IGiven the canonical model M = (cid:8)W , {Rl}∗}i∈ A, Ii∗ → W such that (i) M∗∗(cid:9) and a surjective function h : W∗implies h(w)R ih(w; (ii) w Ri w{Done reduced path from w to w∗(P k, w) iff (cid:8)a1, . . . , ak(cid:9) ∈ I(P k, h(w)).The set of possible worlds W∗(cid:3) ∈ W and l is an agent or group of agents. Let Wsuch that w ∈ Wk , w∗h(w) = w, for w ∈ W, for w ∈ W1 and h(v w,l,w(cid:3) ) = w(cid:3) = v w,l,w(cid:3)(cid:3) , for some w∗relation defined for w, wrefer to [15] for a proof that M∗is defined by induction. Let W∗k . Further, R(cid:3) ∈ W∗l∗(cid:3)(cid:3)∗ =∗1 be W , and define W(cid:11)∗k+1 as the set of worlds v w,l,w(cid:3)∗∗ → W by lettingk , then define h : Wis the reflexive, symmetric and transitive closure of the∗(P k, w) = I(P k, h(w)). We(cid:3)). Finally, Ik∈N Wif wand h satisfy (i)–(iv) above. In particular, we can show what follows:(cid:3)(cid:3) ∈ W , and h(w)Rlh(wLemma 50. For w ∈ W∗, ψ ∈ LD+n, we have(M∗σ , w) |(cid:20)p ψ iff(Mσ , h(w)) |(cid:20)p ψFinally, we make use of the structure M∗to define a Kripke model M(cid:3)that falsifies the unprovable formula φ.Definition 51. The model M(cid:3) = (cid:8)W(cid:3), {R(cid:3)i}i∈ A, D(cid:3), {D(cid:3)i}i∈ A, I(cid:3)(cid:9) is defined as follows:∗(cid:3) = D(cid:3) = W• W(cid:3)• Ri is the transitive closure of R∗i , and I∗∪i= D, D, D(cid:3)i∗∗(cid:3) = I(cid:11);i∈G R∗G .Since the various Rresult about M(cid:3)and refer to [15] for further details.∗i and R∗G are reflexive, transitive and symmetric, R(cid:3)i is an equivalence relation. We state the followingLemma 52. For w ∈ W(cid:3), ψ ∈ LD+n, the following holds(M(cid:3)σ , w) |(cid:20) ψ iff(M∗σ , w) |(cid:20)p ψIn conclusion, if φ ∈ LDBy Lemma 50 also M∗completeness result.n is not provable in Q .S5Dpseudo-satisfies ¬φ, and by the result above M(cid:3)n , then the canonical model MQ .S5Dn pseudo-satisfies ¬φ by Lemma 49.does not validate φ. Hence, we have the followingTheorem 53 (Completeness). The system Q .S5Dn is complete with respect to the class of objectual frames.Finally, we show that formulas (13)–(17) are sufficient to guarantee that the canonical models for the systems Q .S5kn, for2 (cid:2) k (cid:2) 6, defined as in Definition 37, satisfy the corresponding constraints.Theorem 54 (Completeness). For 2 (cid:2) k (cid:2) 6, the system Q .S5kn is complete with respect to the class Kk of Kripke frames.Proof. We show that the canonical models for the systems Q .S5kclasses Kk of Kripke frames.n, for 2 (cid:2) k (cid:2) 6, satisfy the respective constraint on the(cid:3)(cid:3)(cid:3)Q.S51there exists vand f (w) ∈ D i . Ifn. Assume that w ∼i wfr(w) = [v], for some v such that Admi(v) ∈ w. This means that (r = v) ∈ w, therefore ∃xi(r = x) ∈ w(cid:3)) ∈ wrichness of wQ.S52Q.S53n. This can be shown as above, but this time f = fr , for some closed local term r, belongs to F i .n. Assume that f = fr ∈ F i for some closed local term r, then K i∃i x(r = x) ∈ w by formula (15), and in particular∃i x(r = x) ∈ w. By the richness of w there exists v such that Admi(v) ∈ w and (r = v) ∈ w. Therefore, there exists [v] ∈ D isuch that fr(w) = [v].f ∈ F then f = fr for some closed local term r, and by hypothesisby formula (13). Bysuch that Admi(vn. Assume that f = fr for some closed local term r belongs to F i ,. By hypothesis there(cid:3)exists a closed term t such that I(t) = a ∈ D and (r = t) ∈ w. By formula (16) this implies that K i(r = t) ∈ w and (r = t) ∈ w.Thus fr(w) = fr(wfr(w) = a ∈ D, and w ∼ w. Thus, fr(wand (r = v(cid:3)) ∈ D i .(cid:3)) ∈ wQ.S54(cid:3)).(cid:3)(cid:3)(cid:3)(cid:3)1004F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013n. Since formula (17) is equivalent to the conjunction of formulas (15) and (16), we can prove that for f ∈ F i ,Q.S55(cid:3)implies f (w) = f (ww ∼i w(cid:3)) ∈ D i .As a result, we have completeness with respect to all the relevant classes of frames. (cid:2)As for system Q .S5n, for every QML system S from completeness with respect to Kripke frames we can derive com-pleteness for systems of global state. In fact, if (cid:2)S φ then by Kripke completeness there exists a model M = (cid:8)F , I(cid:9) basedon a S-frame F , which falsifies φ. Define the quantified interpreted system P as (cid:8)γ (F ), I(cid:9), where γ is the relevant mapfrom S-frames to SGS for S. By definition P |(cid:20) φ iff Pϕ = (cid:8)ϕ(γ (F )), I(cid:9) models φ, where ϕ is the relevant map from SGSfor S to S-frames. By the results in Section 2.6, the frame ϕ(γ (F )) is isomorphic to F . Hence, P (cid:11)|(cid:20) φ. Thus, the followingimplications hold:S-SGS |(cid:20) φ ⇒ S-K |(cid:20) φ ⇒ (cid:23)S φand we have a further completeness result.Corollary 55 (Completeness). Every QML system S is complete with respect to the class S-SGS of the systems of global states for S,that is, S-SGS |(cid:20) φ implies (cid:23)S φ.By combining together the soundness and completeness theorems we obtain the main result of this section.Corollary 56 (Soundness and Completeness). For every formula φ in the language of S,S-SGS |(cid:20) φ iff (cid:23)S φWe conclude that our QML systems are sound and complete axiomatisations of the validities on the corresponding classesof systems of global states. The corollary below summarises the main formal results of this paper.Corollary 57. Let 2 (cid:2) k (cid:2) 6, for every row, the QML system in the first column of the following table is a sound and complete axioma-tisation with respect to the corresponding class of Kripke frames and systems of global states:QML systemsKripke framesSystems of global statesQ .S5nQ .S5varnQ .S5regnQ .S5objnQ .S5DnQ .S5knKKvarKregKobjKobjKkSGSSGS varSGS regSGS objSGS objSGSk5. Applications to multi-agent systemsIn this section we show how simple MAS scenarios can be modelled by means of quantified interpreted systems. Specif-ically, in Section 5.1 we analyse the scenario of battlefield, and in Section 5.2 we consider an infinite version of the muddychildren puzzle. Section 6 deals with a more complex application: a formal analysis of message passing systems. We main-tain that these investigations show some of the advantages of first-order formalisms.5.1. BattlefieldIn this subsection we model the popular game of battlefield as a quantified interpreted system, then we describe it bymeans of the language Ln, for n = 4. We start by considering a set of agents A = {1, 2, 3, 4}, and we assume that each agentis assigned a quadrant in the region Z × Z as domain of quantification:D4 = {(x, y) | x ∈ Z−, y ∈ Z+}D3 = {(x, y) | x, y ∈ Z−}D1 = {(x, y) | x, y ∈ Z+}D2 = {(x, y) | x ∈ Z+, y ∈ Z−}Intuitively, the set D i represents the country of agent i. Note that, even though in the battlefield game only a finite subsetof Z × Z is considered, in several scenarios either we are not able, or do not want, to bound in advance the size of thegame board. Thus, it can be useful to introduce a potentially infinite playing board, even though at each step only a finiteportion is considered.We assume that each agent has 5 military units, whose positions are recorded in his local state. Further, we considercouples (x, y) ∈ D i and triples (k, x, y), for 1 (cid:2) k (cid:2) 5, to express that there is a military unit at (x, y) and that the k-thmilitary unit is at (x, y) respectively.The local state li of agent i is defined as a 4-tuple (cid:8)α1, α2, α3, α4(cid:9) such that:F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10131005• αi is a 5-tuple (cid:8)(1, x1, y1), . . . , (5, x5, y5)(cid:9) recording the positions of agent i’s units.• for j (cid:11)= i, α j is a possibly empty sequence of triples (k, x, y) and couples (x, y) recording the positions and identities ofagent i’s enemies’ units.Also, le is the local state of the environment recording the positions and identities of all units in similar fashion.The set S contains the global states s = (cid:8)le, l1, l2, l3, l4(cid:9) such that if either (x, y) ∈ α j(li) or (k, x, y) ∈ α j(li), then (k, x, y) ∈αi(li). So, an agent may not know the position or the identity of an enemy unit, but if she does, then she cannot be wrong.Each domain F i of intensional objects contains the military units mui.k, for 1 (cid:2) k (cid:2) 5, such that mui.k(s) = (x, y) iff thetriple (k, x, y) belongs to the component αi of the local state li(s). Moreover, we assume that our language has global andlocal constants for denoting the individuals in the various D i and F i . We use the same notation for syntactic and semanticelements as the former mirror the latter, the context will disambiguate. Finally, let D contain the real numbers, i.e., D ⊇ R.The quantified interpreted system P contains all the global states consistent with the definitions above. In particular,suppose that the initial state s = (cid:8)le, l1, l2, l3, l4(cid:9), describing the position of the military units at the beginning, is defined asfollows:l1(s) = (cid:8)(cid:8)(1, 2, 2), (2, 6, 5), (3, 2, 7), (4, 4, 12), (5, 7, 9)(cid:9), (cid:8)(cid:9), (cid:8)(cid:9), (cid:8)(cid:9)(cid:9)l2(s) = (cid:8)(cid:8)(cid:9), (cid:8)(1, 3, −3), (2, 7, −2), (3, 6, −5), (4, 3, −6), (5, 8, −9)(cid:9), (cid:8)(cid:9), (cid:8)(cid:9)(cid:9)l3(s) = (cid:8)(cid:8)(cid:9), (cid:8)(cid:9), (cid:8)(1, −3, −3), (2, −3, −6), (3, −6, −3), (4, −6, −8), (5, −8, −5)(cid:9), (cid:8)(cid:9)(cid:9)l4(s) = (cid:8)(cid:8)(cid:9), (cid:8)(cid:9), (cid:8)(cid:9), (cid:8)(1, −4, 4), (2, −3, 9), (3, −7, 7), (4, −5, 12), (5, −8, 11)(cid:9)(cid:9)The QIS P containing s describes a situation in which the first military unit of agent 1 is positioned at (2, 2). In particular,agent 1 knows this fact:(P, s) |(cid:20) K1∃1z(z = (2, 2)) and also (P, s) |(cid:20) ∃1zK1(z = (2, 2))while agent 3 does not know this:(P, s) |(cid:20) ¬∃1zK3(z = (2, 2)) and also (P, s) |(cid:20) ¬K3∃1z(z = (2, 2))Thus, agent 1 has not only de dicto knowledge that one of his military units is at (2, 2), but he also has de re knowledge ofthe first of his units being at (2, 2).Consider now a function dist returning the distance between two points in Z × Z as a real number:(cid:14)(cid:3)I(dist)((x, y), (x, y(cid:3))) =(x − x(cid:3))2 + ( y − y(cid:3))2We can check that agent 2 starts with all his military units within a distance of less than 8. Further, he knows this fact, butagent 4 does not. To express this, we introduce a relation symbol < with the obvious interpretation “less than”.(P, s) |(cid:20) ∀2z, z(cid:3)K2(dist(z, z(cid:3)) < 8) but(P, s) (cid:11)|(cid:20) ∀2z, z(cid:3)K4(dist(z, z(cid:3)) < 8)The latter formula fails as agent 4’s local state is consistent with a different state sunits at a distance greater than 8, that is, l4(s(cid:3)(cid:3)(cid:3)) = l4(s) but for instance(cid:3)(cid:3)(cid:3)such that l2(s(cid:3)(cid:3)(cid:3)) contains two military(cid:3)(cid:3)(cid:3)l2(sNote that s) = (cid:8)(cid:8)(cid:9), (cid:8)(1, 30, −30), (2, 7, −2), (3, 6, −5), (4, 3, −6), (5, 8, −9)(cid:9), (cid:8)(cid:9), (cid:8)(cid:9)(cid:9)(cid:3)(cid:3)(cid:3) ∈ P by definition of P .Further, consider a global constant firedist representing the maximum range of fire of the military units and set it to 8,i.e., I(firedist) = 8. We can express the fact that the units z and z(cid:3)are within fire range by the following formula:FDist(z, z(cid:3)) ::= dist(z, z(cid:3)) < firedistThe following expression specifies that in the present QIS every agent has at least one unit which is not within the firerange of any other enemy unit:(P σ , s) |(cid:20) ∃i z∀ j z(cid:3)¬FDist(z, zfor j (cid:11)= i),(cid:3)Now suppose that hostilities break out in our scenario and agent 3 somehow acquires the knowledge that one of agent 1’smilitary units is at (2, 2). The resulting state sdiffers from s only for the local state of agent 3:(cid:3)(cid:3)l3(s) = (cid:8)(cid:8)(2, 2)(cid:9), (cid:8)(cid:9), (cid:8)(1, −3, −3), (2, −3, −6), (3, −6, −3), (4, −6, −8), (5, −8, −5)(cid:9), (cid:8)(cid:9)(cid:9)As a consequence, agent 3 acquires de dicto knowledge that the first of his units is within the range of enemy fire, even ifshe does not know this fact de re, that is, she does not know which of agent 1’s units actually threatens agent 3’s first unit.(cid:3)(P, s) |(cid:20) ∃3zK3∃1z(cid:3)FDist(z, z(cid:3)) but(cid:3)(P, s) (cid:11)|(cid:20) ∃3z∃1z(cid:3)K3FDist(z, z(cid:3))1006F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013This is because the following local states for agent 1 is consistent with agent 3’s local state in ssuch that l3(s(cid:3)(cid:3)(cid:3)(cid:3)) = l3(s(cid:3)) and(cid:3), i.e., there is a state s(cid:3)(cid:3)(cid:3)(cid:3)(cid:3)(cid:3)(cid:3)(cid:3)l1(s) = (cid:8)(cid:8)(2, 2, 2), (1, 6, 5), (3, 2, 7), (4, 4, 12), (5, 7, 9)(cid:9), (cid:8)(cid:9), (cid:8)(cid:9), (cid:8)(cid:9)(cid:9)Now suppose that agent 1 discovers unit mu3.1’s position. The change in his local state is recorded in the global state sdiffering from s(cid:3)as to l1:(cid:3)(cid:3)(cid:3)(cid:3)l1(s) = (cid:8)(cid:8)(1, 2, 2), (2, 6, 5), (3, 2, 7), (4, 4, 12), (5, 7, 9)(cid:9), (cid:8)(cid:9), (cid:8)(1, −3, −3)(cid:9), (cid:8)(cid:9)(cid:9)Then, agent 1 too knows that one of his units is within the range of enemy fire. In particular, she has de re knowledge ofthis fact, i.e., she knows the identity of agent 3’s unit:(cid:3)(cid:3)(P, s) |(cid:20) ∃1zK1∃3z(cid:3)FDist(z, z(cid:3)) and also (P, s(cid:3)(cid:3)) |(cid:20) ∃1z∃3z(cid:3)K1FDist(z, z(cid:3))Given that one of agent i’s units is within the range of enemy fire, agent i is in a dangerous situation. For expressingthis, we introduce a predicate Danger, whose meaning is left underspecified through a caeteris paribus clause θ . We assumethat our QIS validates the following de dicto specification on Danger:∀i z(K i∃ j z(cid:3)FDist(z, z(cid:3)) ∧ θ ↔ Danger(z)),for j (cid:11)= iThe specification above is weaker than the following de re formula for specifying the Danger(cid:3)predicate on danger:∀i z(∃ j z(cid:3)K iFDist(z, z(cid:3)(cid:3)) ∧ θ ↔ Danger(cid:3)(z)),for j (cid:11)= iIn fact, the notion of Dangerimplies that of Danger, and agent 1 knows herself to be both in Danger and in Danger(cid:3),while agent 3 only knows herself to be in Danger:(cid:3)(cid:3)(cid:3)(cid:3)(P, s(P, s) |(cid:20) ∃1zK1Danger(z) and (P, s(cid:3)(cid:3)(P, s) |(cid:20) ∃3zK3Danger(z) but(cid:3)(cid:3)(cid:3)) |(cid:20) ∃1zK1Danger(cid:3)) (cid:11)|(cid:20) ∃3zK3Danger(z)(z)Agents can try to find a way out of this situation either by attacking or by withdrawing. In order to analyse these alterna-(cid:3)))tives, we introduce a knowledge based protocol [14]. First of all, we define a predicate Access such that Access((x, y)(x(cid:3))} contains the points reachable from p in a single(cid:3) | Access(p, piff |x − xmove. Moreover, we consider two actions: ATTACK and MOVE. The protocol for agent i (cid:11)= j can be written in pseudo-code asfollows:(cid:3)| (cid:2) 1. Intuitively, the set {p(cid:3)| (cid:2) 1 and | y − y(cid:3), yif K iDanger(z) thenif ∃i x(Access(z, x) ∧ ∀ j zMOVE(z, x)else if ∃ j z(cid:3)K iFDist(z, z(cid:3)) then(cid:3)K i(¬FDist(x, z(cid:3)))) thenATTACK(z’)This protocol says that if agent i knows that a unit z is in danger, then she has to move it to an area known to be out ofthe enemy fire range. If this is not possible, then she has to attack the enemy unit threatening her own unit. Note that thisprotocol is extremely strict, as it requires knowledge of safety conditions before moving. In the present case, we have:(cid:3)(cid:3)(P, s) |(cid:20) ∃1z(K1Danger(z) ∧ ∀1x(Access(z, x) → K1∃3z(cid:3)FDist(x, z(cid:3))) ∧ ∃3z(cid:3)K1FDist(z, z(cid:3)))Therefore agent 1, by following the knowledge-based protocol above, will attack the first unit of agent 3.By suitably extending our language, we could express interesting topological relationships on the various D i , like thepresence of obstacles. Moreover, we could introduce intensional predicates to describe in detail the characteristics of themilitary units. The system above is simply an example, but we deem it persuading enough to let us conclude that QIS aresufficiently expressive to represent a number of concrete MAS scenarios.5.2. Infinitely many muddy childrenIn this subsection we use the language Lobjnto present an infinite version of the muddy children puzzle [14], a well-known scenario in epistemic logic. We observe that the solution to this puzzle depends only on the number k of muddychildren, not on the total number m (cid:3) k of children. In other words, at the end of the k-th round every child knows whetherhis forehead is muddy or not, independently from the total number m of children.This remark suggests that there is no need to fix in advance the size of the set D of children in the muddy childrenpuzzle. Given this, we take D as containing an infinite number of children and we introduce an infinite version of thispuzzle.F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10131007However, the language Lobjnin Section 3.1 contains only a finite number n of epistemic operators, so in the presentformalism we can reason about the knowledge of just a finite subset of D. This is a limitation of the present setting, whichcan be overcome by introducing a language with infinite denumerable epistemic operators. Such an extension is beyond ourinterest in this paper, so we leave it for further work.We take the local state li of child i (cid:2) n to be either 1 or 0 depending on whether his forehead is muddy or not, whilethe local state of the environment remains unspecified as it does not influence the present analysis. So we take it to be theempty sequence. We define a muddy children quantified interpreted system as follows:Definition 58. A muddy children QIS, or MCQIS, is any pair (cid:8)S, D(cid:9), where S ⊆ Le × L1 × · · · × Ln, and D is an infinite set ofchildren.Note that we have a single quantification domain D for all children, this implies that we can omit the subscript i fromquantifiers, and consider in Lobjn unique quantifiers ∀, ∃ for all agents.Instead of using, as in the propositional case, propositions pi for 1 (cid:2) i (cid:2) n, representing the fact that “child i’s foreheadis muddy”, we use a unary predicative constant M and infinitely many constants such that M(ai) intuitively means that“child i’s forehead is muddy”. Hereafter we present our analysis of this infinite version of the muddy children puzzle.After the father’s announcement that at least one child has a muddy forehead, the children have common knowledge ofthis fact. The language Lobj∃xM(x)holds at step 1, for every i1, . . . , i j (cid:2) n. This formula does not hold in every muddy children QIS, but it is valid on the MCQISwhere S does not contain the global state with only 0s.n has no common knowledge operator: we approximate this by assuming that K i1 . . . K i jFurther, every child knows whether any other child is muddy or not, and this can be expressed in Lobjnas the followingspecification:∀x(x (cid:11)= a jk→ (K j1 . . . K jk M(x) ∨ K j1 . . . K jk¬M(x)))but he does not know whether he is muddy or not, that is, also the following specification holds at the beginning:¬K j M(a j) ∧ ¬K j¬M(a j)(18)(19)By induction on the number k of muddy children, it is provable that at the k-th round of answers every child knows whetherhis forehead is muddy or not. Moreover, this result is independent from the actual number of children, and it holds alsofor an infinite number of children. In what follows we refer to principles and rules of inference of the system Q .S5objnSection 4, we do not provide all the details of proofs, the interested reader should nonetheless be able to fill the gaps.inFor k = 1, assume that child j knows that (20) at least one child has a muddy forehead, and that (21) he cannot see anyother child with a muddy forehead:K j∃xM(x)K j∀ y( y (cid:11)= a j → ¬M( y))(20)(21)These formulas hold in the muddy children QIS where at least one and only one child has a muddy forehead. In thefirst-order modal system Q .S5objn we can show that child j deduces that his own forehead is muddy as follows:a. K j(∃xM(x) ∧ ∀ y( y (cid:11)= a j → ¬M( y)))b. K j∃x(M(x) ∧ (x (cid:11)= a j → ¬M(x)))c. K j∃x(M(x) ∧ x = a j)from (20), (21) by modal calculusfrom a by predicate calculusfrom b by propositional calculusSo child j acquires the knowledge that his own forehead is muddy, i.e., K j M(a j) holds, and he will answer positively in thefirst round when asked.For k = 2, after the first round of negatively answered questions, every child i knows that there are at least two childrenwith muddy foreheads. We can represent this situation by means of the following de dicto formula:K i∃x, y(x (cid:11)= y ∧ M(x) ∧ M( y))(22)Note that if child i has not a muddy forehead, it is trivial to check that (22) holds, as child i can see two other childrenwith muddy foreheads. On the other hand, if child i is one of the muddy children, then he can derive (22) in Q .S5objnthe principles (20), (21), (c) above.fromIn order to see this, assume that j is the muddy child other than i, who has negatively answered the first question. Thismeans that (c) K j M(a j) fails, so either (20) or (21) does not hold. But it is the case that (20) K j∃xM(x), so ¬K j∀ y( y (cid:11)=a j → ¬M( y)), that is, (21) is not valid.Further, we can show that if child j does not know that he is the only muddy child, then there is some other child, whois known to be muddy by j:¬K j∀ y( y (cid:11)= a j → ¬M( y)) → ∃ y( y (cid:11)= a j ∧ K j M( y))(23)1008F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013In fact, formula (23) can be proved in the system Q .S5objnas follows1:a. ¬K j∀ y( y (cid:11)= a j → ¬M( y)) by assumptionb. ¬∀ y( y (cid:11)= a j → K j¬M( y))c. ∃ y( y (cid:11)= a j ∧ ¬K j¬M( y))d. ∃ y( y (cid:11)= a j ∧ K j M( y))from c by (18)from a by (see footnote)from b by predicate calculusAs a result, (23) holds in the muddy children QIS. Therefore, by (23) and the negation of (21) we derive ∃ y( y (cid:11)= a j ∧ K j M( y)).Finally, by axioms T and Nec the muddy child i acquires the knowledge that there is a muddy child different from j, i.e.,K i∃ y( y (cid:11)= a j ∧ M( y)). We also assumed that i knows that j has a muddy forehead, K i M(a j), so we can easily derive (22) inQ .S5objn by first-order calculus.Up to now we showed that after the first round of questions every child, muddy or not, knows that there are at leasttwo muddy children. Now, suppose that child j can see only another child z with a muddy forehead. This situation validatesthe following de re specification, i.e., child j knows that every child other than him and z is clean:∃zK j∀k(k (cid:11)= a j ∧ k (cid:11)= z → ¬M(k))(24)We can show that from the de dicto knowledge of the existence of two muddy children expressed in (22), and formula (24)above, in Q .S5objnchild j deduces the de re knowledge that he is the other muddy child as follows:a. K j∃x, y (x (cid:11)= y ∧ M(x) ∧ M( y))∧ ∃zK j∀k (k (cid:11)= a j ∧ k (cid:11)= z → ¬M(k))b. ∃zK j∃x, y (x (cid:11)= y ∧ M(x) ∧ M( y)∧ ∀k(k (cid:11)= a j ∧ k (cid:11)= z → ¬M(k)))c. ∃zK j∃x, y (x (cid:11)= y ∧ M(x) ∧ M( y)∧ (x = a j ∨ x = z) ∧ ( y = a j ∨ y = z))d. ∃zK j∃x, y (x (cid:11)= y ∧ M(x) ∧ M( y)from (22), (24)from a by predicate calculusfrom b by Ex∧ ((x = a j ∧ y = z) ∨ ( y = a j ∧ x = z)))e. ∃zK j (a j (cid:11)= z ∧ M(a j) ∧ M(z))from c by distributivityfrom d by predicate calculusAs a result, child j acquires de re knowledge that he is the other muddy child and replies positively on the second round ofquestions.It is an easy induction step to show that if there are k muddy children, then there are formal proofs in the systemQ .S5objthat they will know within the k-th round whether their foreheads are muddy. Since we are reasoning about anninfinite set D of children, none of the formulas above can be translated into the propositional language of [14] for example.Given the above, the infinite version of the muddy children puzzle has a natural and intelligible formal proof in first-orderepistemic logic6. Message-passing QISThis section is devoted to modelling message-passing systems (MPS) [14,52] in the framework of objectual QIS. An MPSis a multi-agent system where agents communicate by exchanging messages, so the most relevant actions performed byagents are the sending and receiving of messages. The formalism of message passing systems is useful to model a widerange of multi-agent systems. For instance, a network of computers, such as the Internet, can be seen as an MPS. In general,any multi-agent system is an MPS if the message transmission delay is not negligible. In MPS the local state of each agentcontains information about the initial state, the messages it has sent or received, as well as the internal actions it hastaken. One of the first references dealing with MPS is [38], since then they have been extensively investigated both in theirsynchronous and asynchronous formulations [14,52].In what follows we show that MPS can be defined as a particular class of objectual SGS satisfying a finite number ofspecifications in the first-order modal language LDn , where n is the number of agents in the MPS. Our main result consistsin showing that Proposition 4.4.3 in [14], concerning the knowledge of the ordering of events in MPS, can be restated as avalidity on the class of QIS modelling MPS. Thus, the formalism of objectual QIS is powerful enough to deal with the theoryof message passing systems. Throughout this section we refer to [14], par. 4.4.5-6, for details on MPS.More formally, we introduce a set Act of actions α1, α2, . . . , and a set Msg of messages μ1, μ2, . . . For each agent i ∈ A,we consider a set Σi of initial events init(i, α), and a set Inti of internal events int(i, α). We define the local state li foragent i as a history over Σi , Inti and Msg, that is, a sequence of events whose first element is in Σi , and whose followingelements either belong to Inti or are events of the form send(i, j, μ), rec(i, j, μ) for j ∈ A, μ ∈ Msg. Intuitively, init(i, α)1 Note that (t (cid:11)= t(cid:3) → K j φ) → K j (t (cid:11)= t(cid:3) → φ) is a validity in all muddy children QIS, because of the interpretation of terms.F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10131009represents the event where agent i performs the initial action α, send(i, j, μ) represents the event where agent i sends messageμ to j, while the intended meaning of rec(i, j, μ) is that agent i receives message μ from j. Finally, int(i, α) means that agenti performs the internal action α.A global state s is a tuple (cid:8)le, l1, . . . , ln(cid:9), where l1, . . . , ln are local states as above and le contains all the events in l1, . . . , ln.(cid:3)We define a reflexive, transitive and anti-symmetric relation (cid:2) on the set of local states of any agent i such that li (cid:2) liiff li is a prefix of l(cid:3)i . This order extends to global states, so that s (cid:2) s(cid:3)iff li (cid:2) l(cid:3)i for every i ∈ A.We define message passing QIS (MPQIS) as objectual quantified interpreted systems P = (cid:8)S, D, I(cid:9) where S is a non-empty set of global states, the domain D of individuals includes all agents in A, the messages in Msg, the actions in Act, theevents e1, e2, . . . , and I is an interpretation for language LDn .Intuitively, each MPQIS models the temporal evolution of a message passing system, which can be represented as asequence s0, s1, . . . of global states such that s0 = (cid:8)init(e, αe), init(1, α1), . . . , init(n, αn)(cid:9), and for every n ∈ N, either sn+1 isidentical to sn or there is i ∈ A such that li(sn) (cid:2) li(sn+1) but li(sn) (cid:11)= li(sn+1). Note that a single MPQIS can model severaltemporal evolutions of the same MPS.We assume that our language has terms and predicative letters for representing the objects in the domain D and therelations among them. In particular, e1, e2, . . . are metaterms ranging over events: for instance, we introduce ∀eφ[e] as ashorthand for∀i, j, μ, α φ[send(i, j, μ)] ∧ φ[rec(i, j, μ)] ∧ φ[init(i, α)] ∧ φ[int(i, α)]In fact, every event is either a send event, a receive event, an initial action, or an internal action. We use the same notationfor the objects in the model and the syntactic elements, the distinction will be made clear by the context. We observe thatwe can express event specifications by using formulas in LDn , which are provably valid on every MPQIS (the existence of aunique individual ∃! can be defined by means of =). For example, we can state:∀e∃!i, j, μ, α (i (cid:11)= j) ∧ (e = send(i, j, μ) ∨ e = rec(i, j, μ) ∨ e = init(i, α) ∨ e = int(i, α))∀i, j, μ, α ∃!e1, e2, e3, e4(send(i, j, μ) = e1 ∧ rec(i, j, μ) = e2 ∧ init(i, α) = e3∧ int(i, α) = e4 ∧ e1 (cid:11)= e2 ∧ e1 (cid:11)= e3 ∧ e1 (cid:11)= e4 ∧ e2 (cid:11)= e3 ∧ e2 (cid:11)= e4 ∧ e3 (cid:11)= e4)The first specification expresses the fact that every event is either a send event or a receive event, where the sender isdifferent from the receiver, an initial action, or an internal action. Thus, it cannot be the case that e = send(i, j, μ) =(cid:3), μ(cid:3)) for distinct agents and messages. The second specification states that every send or receive event, initialsend(i(cid:3), μ(cid:3)). It is easy to check thataction, and internal action are distinct events. Thus, we cannot have send(i, j, μ) = e = rec(iour definition of MPQIS validates both specifications.(cid:3), j(cid:3), jIn [14], p. 132 the authors list three key constraints on MPS, the third one involves the notion of run on a SGS, i.e., atemporal evolution of global states. Nonetheless, we can restate the first two without introducing runs:MP1 a local state li for agent i is a history over Σi , Inti and Msg;MP2 for every event rec(i, j, μ) in li(s) there exists an event send( j, i, μ) in l j(s).Further, the following simplifying assumption is considered:* all events in a given agent’s local state are distinct, an agent can never perform the same action twice.We show how to formalise these specifications in the present formalism. First, we introduce a predicate H for happenedsuch that (P σ , s) |(cid:20) H(e, i) iff e is an event in the local state li(s) of agent i. The formula H(e) is a shorthand for ∃i H(e, i).By definition of MPS we can show that (P σ , s) |(cid:20) H(e) iff e is an event in s. Further, we define an order Prec on events asfollows:(P σ , s) |(cid:20) Prec(e, e(cid:3), i)iff(P σ , s) |(cid:20) H(e, i) ∧ H(efor all s(cid:3) (cid:2) s, (P σ , s(cid:3), i) and(cid:3)) |(cid:20) H(e(cid:3), i) → H(e, i)(cid:3)) can be obtained from the one above by disregarding the i component:The definition of Prec(e, e(cid:3))(P σ , s) |(cid:20) Prec(e, eiff(P σ , s) |(cid:20) H(e) ∧ H(efor all s(cid:3) (cid:2) s, (P σ , s(cid:3)) and(cid:3)) |(cid:20) H(e(cid:3)) → H(e)We can insist on the events in a global state s to be partially ordered by specifying that Prec(e, etransitive relation on the set of past events:(cid:3)) is a reflexive andH(e) → Prec(e, e)(cid:3)) ∧ Prec(ePrec(e, e(cid:3)(cid:3)(cid:3), e) → Prec(e, e(cid:3)(cid:3))(25)(26)Moreover, Prec(e, e(cid:3), i) can be defined as a linear order on the events in li , i.e., it is also anti-symmetric and total:1010F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013Prec(e, e(cid:3)(cid:3), i) ∧ Prec(e(cid:3), e, i) → (e = e(cid:3)(cid:3))H(e, i) ∧ H(e, i) → Prec(e, e, i) ∨ Prec(e(cid:3), e, i)We define Linear(Prec(e, elinear. Also, we define the first event as the minimal one with respect to Prec(e, e(cid:3), i)) as the conjunction of (25)–(28) above, expressing the fact that the relation Prec(e, e(cid:3), i), that is,(27)(28)(cid:3), i) isFst(e, i) ::= ∀e(cid:3)(cid:3)(H(e, i) → Prec(e, e(cid:3), i))Finally, the formulas Sent(i, j, μ), Recd(i, j, μ), Init(i, α), and Int(i, α) are shorthands for H(send(i, j, μ)), H(rec(i, j, μ)),H(init(i, α)), and H(int(i, α)) respectively. We can now formalise the specifications MP1-2 and * as follows:MP1*Linear(Prec(e, e(cid:3), i)) ∧ ∃!e(F st(e, i) ∧ ∃α(e = init(i, α)))∧ ∀e(¬F st(e, i) → ∃ j, α, μ(e = int(i, α) ∨ e = send(i, j, μ) ∨ e = rec(i, j, μ)))MP2(cid:3) ∀i, j, μ(Recd(i, j, μ) → Sent( j, i, μ))The validity of MP1* on MPQIS forces the local state of any agent i to satisfy specifications MP1 and *; while by MP2specification MP2 is satisfied.(cid:3)Formulas MP1* and MP2are the basic specifications for MPQIS, but we can consider further key constraints on messagepassing system. A property often required in the framework of MPS is channel reliability. Modified from [14], an MPS isreliable if every sent message is eventually received, or more formally:(cid:3)MP4 if send(i, j, μ) is in li(s), then there exists a global state s(cid:3)such that rec( j, i, μ) is in l j(s(cid:3)).In the language LDn we can formalise this specification as follows:MP4(cid:3) ∀ j, μ(Sent(i, j, μ) → ¬K i¬Recd( j, i, μ)).In fact, if send(i, j, μ) is in li(s), by M4’ (P σ , s) |(cid:20) ¬K i¬Recd( j, i, μ), this means that there exists a global state s(cid:3)) |(cid:20) Recd( j, i, μ), that is, rec( j, i, μ) ∈ l j(s(P σ , sformer requires that the local states of agent i in s and s(cid:3)). Thus, MP4 holds. Note that MP4such thatis actually stronger than MP4 as theare identical.(cid:3)(cid:3)(cid:3)Further, a relevant property of MPS concerns authentication: if agent i receives a message μ from agent j, then i knowsthat μ was actually sent by j. This specification can be expressed as∀ j, μ(Recd(i, j, μ) → K iSent( j, i, μ))Finally, we may require that agents have perfect recall, i.e., to know everything that has happened to them:∀e(H(e, i) → K i H(e, i))It is easy to show that MPQIS satisfy authentication and perfect recall but not channel reliability. Of course, we could addthis formula in any specification should channel reliability be required. We remark that all the specifications introduced sofar are defined by means of only the predicative constants H(e, i) and Prec(e, e(cid:3), i).We now prove the main result of this section: Proposition 4.4.3 in [14] can be restated as a validity on the class ofMPQIS satisfying MP1, MP2, and *. We do not provide the full statement here, but we note that this metatheoretical resultcan be cast as a formula in the first-order epistemic language LDn . First, we introduce a relation (cid:26)→G of potential causalitybetween events, as discussed in [38,52]. This relation is intended to capture the intuition that event e might have causedappear inevent es, and. Fix a non-empty subset G of A, the relation (cid:26)→G holds between events e, eat a state s iff both e and e(cid:3)(cid:3)(cid:3)1. for some i, j ∈ G, e2. for some i ∈ G, events e, e3. for some event e(cid:3)(cid:3)(cid:3)(cid:3)is a receive event and e is the corresponding send event;, we have that e (cid:26)→G eare both in li(s), and either e = eand e(cid:3)(cid:3) (cid:26)→G e(cid:3)(cid:3)(cid:3)hold at s.(cid:3), or e comes earlier than e(cid:3)in li(s);Note that (cid:26)→G is a partial order on events. We say that (P σ , s) |(cid:20) e (cid:26)→G efor syntax and semantics).(cid:3)if e (cid:26)→G e(cid:3)hold at s (we use the same notationNow we prove that the potential causality relation (cid:26)→G respects the order Prec of events by showing that the following, then it is distributed knowledgevalidity holds in the class of MPQIS. This means that if event e is the cause of event e(cid:3)among the agents that e happened before e. Note that this is the right to left implication of Proposition 4.4.3 in [14]:(cid:3)Proposition 59. MPQIS |(cid:20) ∀e, e(cid:3)((e (cid:26)→G e(cid:3)) → D G Prec(e, e(cid:3))).F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10131011(cid:3)(cid:3)Proof. Assume that (P σ , s) |(cid:20) e (cid:26)→G e(cid:3)) |(cid:20) H(e) ∧ H(eall i ∈ G implies (P σ , s(cid:3)).D G Prec(e, e(cid:3)are both in li(s) and either e = eIf e, e(cid:3)), and for s(cid:3)(cid:3)) |(cid:20) H(e(cid:3)H(e) ∧ H(e(cid:3)).(P σ , s) |(cid:20) D G Prec(e, eFinally, if there exists some event e, (P σ , s(cid:3)(cid:3) (cid:2) s(cid:3)(cid:3)(cid:3). If e(cid:3)), and for sis a receive event and e is the corresponding send event, then li(s) = li(s(cid:3)(cid:3) (cid:2) s(cid:3), (P σ , s(cid:3)(cid:3)) |(cid:20) Recd(i, j, μ) → Sent( j, i, μ) by MP2(cid:3)(cid:3)) for. Thus, (P σ , s) |(cid:20)or e comes earlier than e(cid:3)) → H(e). It follows that (P σ , s) |(cid:20) K iPrec(e, ein li(s), then li(s) = li(s(cid:3)) |(cid:20)(cid:3)) implies that (P σ , s(cid:3)), and by axioms D1 and D2,(cid:3)that we are either in the first or second case above. In both cases (P σ , s) |(cid:20) D G Prec(e, eevery sBy transitivity, (P σ , s(cid:3)) → H(e). Thus, (P σ , s) |(cid:20) D G Prec(e, e(cid:3)) for all i ∈ G implies (P σ , s(cid:3)), and for s(cid:3)). (cid:2)(cid:3)) |(cid:20) H(e) ∧ H(e, li(s) = li(s(cid:3)(cid:3)) |(cid:20) H(e(cid:3)(cid:3) (cid:2) s(cid:3)such that e (cid:26)→G e(cid:3)(cid:3)and e(cid:3)(cid:3) (cid:26)→G e(cid:3), then we can assume without loss of generality(cid:3)). Therefore, for(cid:3)(cid:3)).(cid:3)) → H(e(cid:3)(cid:3), e(cid:3)(cid:3)) → H(e) ∧ H(e(cid:3)(cid:3)) ∧ D G Prec(e(cid:3)(cid:3)) |(cid:20) H(e, (P σ , s(cid:3)The analysis of message-passing systems carried out in this section shows the advantages in terms of expressivity offirst-order epistemic formalisms in comparison with propositional ones. By means of language LDn we are able to formalisevarious constraints on MPS, thereby validating the suitability of the approach. Most importantly, an encoding of the right toleft implication of Proposition 4.4.3 in [14] can be shown to be a validity on the class of QIS modelling MPS.7. ConclusionsFirst-order epistemic logic allows for greater expressiveness in comparison to propositional formalisms. In specific ap-plications this advantage can be critical for modelling agent systems in a more intuitive and effective way. Because of this,FOEL has successfully been applied to reasoning about knowledge in artificial intelligence [39,42,51]. However, the litera-ture on this subject in the MAS area have so far fallen short of a deep and systematic analysis of the formal machinery(axiomatisability, decidability, completeness), even in the case of static epistemic logic.In this paper we showed that the semantics of interpreted systems may naturally be extended to first-order, and weprovided complete axiomatisations for several classes of structures, which is noteworthy given the known difficulties ofthese formalisms [19,57]. Specifically, we considered different assumptions on quantification domains, their relationshipwith the agents’ local states, and the impact these assumptions make in terms of axiomatisations. We exemplified the use ofthese formalisms by investigating two examples. The puzzle of muddy children in Section 5 is part of the folklore of multi-agent systems in AI [14]; while the formalisation of the battlefield game as a quantified interpreted system is an originalexample of the expressive features of the present semantical framework. As regards message passing systems, the topic ofSection 6, they have been extensively investigated in computer science both in their synchronous and asynchronous version.In [38] the relation (cid:26)→G between events is introduced, and in [52] it is used to defined a notion of common knowledgewhich is attainable also in asynchronous message passing systems. In Section 6 we followed [14] in the presentation ofMPS, and proved that Proposition 4.4.3 can be cast as a validity on the class of MPQIS. This reassures us that the analysis isadequate.We see this paper as a first contribution in the development of computationally grounded semantics for quantifiedepistemic logics. Indeed, extensions of the present framework seem worth pursuing. It may be of interest to explore thecompleteness issues resulting from term-indexing epistemic operators, as in [43]. This would greatly increase the expressivepower of the formalism, so some limitation on index quantification might be introduced to retain a reasonable computa-tional complexity. Another significant extension would be to add temporal operators to the language. This would open theway for axiomatisations of first-order temporal epistemic logics for MAS. However, any work in this area is likely to beaffected by technical problems, especially with respect to axiomatisation and decidability [25,62].AcknowledgementsThe research described in this paper was partly supported by the EC Framework 6 funded project CONTRACT (IST ProjectNumber 034418), by the research project “Logica Modale e Conoscenza” funded by the Scuola Normale Superiore, Pisa, andby the Royal Society through an International Joint Project award to both authors. The authors would like to thank thereviewers for useful comments on an earlier version of this paper. The first author would like to thank his PhD supervisor,Prof Massimo Mugnai, and Prof Giovanna Corsi, Prof Silvio Ghilardi, and Prof Achille Varzi for support and advice. Thesecond author is grateful to Prof Marco Colombetti, Politecnico di Milano, for having introduced him to Quantified ModalLogic in 1994.References[1] F. Belardinelli, Quantified modal logic and the ontology of physical objects, PhD thesis, Scuola Normale Superiore, Pisa, 2006.[2] P. Bieber, A logic of communication in hostile environments, in: Proceedings of the 3rd IEEE Computer Security Foundations Workshop (CSFW’90), IEEEComputer Society, 1990, pp. 14–22.[3] P. Blackburn, M. de Rijke, Y. Venema, Modal Logic, Cambridge University Press, 2001.[4] P. Blackburn, J. van Benthem, F. Wolter (Eds.), Handbook of Modal Logic, Elsevier, 2006.[5] A. Chagrov, M. Zakharyaschev, Modal Logic, Oxford University Press, 1997.[6] E. Clarke, O. Grumberg, D. Peled, Model Checking, MIT Press, 1999.1012F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–1013[7] M. Cohen, M. Dams, A complete axiomatization of knowledge and cryptography, in: Logic in Computer Science (LICS), IEEE Computer Society, 2007,pp. 77–88.[8] P. Cohen, H. Levesque, Communicative actions for artificial agents, in: Proceedings of the First International Conference on Multi-Agent Systems (IC-MAS’95), AAAI Press, 1995, pp. 65–72.[9] G. Corsi, A unified completeness theorem for quantified modal logics, Journal of Symbolic Logic 67 (2002) 1483–1510.[10] G. Corsi, BF, CBF and Lewis semantics, Logique et Analyse (2005) 103–122.[11] A. Degtyarev, M. Fisher, B. Konev, Monodic temporal resolution, ACM Transactions on Computational Logic (TOCL) 7 (1) (2006) 108–150.[12] A. Degtyarev, M. Fisher, A. Lisitsa, Equality and monodic first-order temporal logic, Studia Logica 72 (2002) 147–156.[13] P. Dembi ´nski, et al., Verics: A tool for verifying timed automata and Estelle specifications, in: Proceedings of the 9th International Conference on Toolsand Algorithms for the Construction and Analysis of Systems (TACAS03), Springer-Verlag, 2003, pp. 278–283.[14] R. Fagin, J. Halpern, Y. Moses, M. Vardi, Reasoning about Knowledge, MIT Press, 1995.[15] R. Fagin, J. Halpern, M. Vardi, What can machines know? On the properties of knowledge in distributed systems, Journal of the ACM 39 (2) (1992)328–376.[16] M. Fitting, R. Mendelsohn, First-Order Modal Logic, Kluwer, Dordrecht, 1998.[17] D. Follesdal, Knowledge, identity, and existence, Theoria 23 (1) (1967) 1–27.[18] M. Gammie, R. van der Meyden, MCK: Model checking the logic of knowledge, in: Proceedings of the 16th International Conference on Computer AidedVerification (CAV04), Springer-Verlag, 2004, pp. 479–483.[19] J. Garson, Quantification in modal logic, in: D. Gabbay, F. Guenthner (Eds.), Handbook of Philosophical Logic, vol. 3, Reidel, 2001, pp. 267–323.[20] J. Halpern, R. Fagin, Modelling knowledge and action in distributed systems, Distributed Computing 3 (4) (1989) 159–179.[21] J. Halpern, R. Shore, Reasoning about common knowledge with infinitely many agents, Information and Computation 191 (1) (2004) 1–40.[22] Y. Hintikka, Knowledge, identity, and existence, Nous 1 (1) (1962) 33–62.[23] I. Hodkinson, Monodic packed fragment with equality is decidable, Studia Logica 72 (2002) 185–197.[24] I. Hodkinson, Complexity of monodic guarded fragments over linear and real time, Annals of Pure and Applied Logic 138 (2006) 94–125.[25] I. Hodkinson, F. Wolter, M. Zakharyaschev, Decidable fragment of first-order temporal logics, Annals of Pure and Applied Logic 106 (1–3) (2000)85–134.[26] I. Hodkinson, F. Wolter, M. Zakharyaschev, Decidable and undecidable fragments of first-order branching temporal logics, in: Logic in Computer Sci-ence(LICS), IEEE Computer Society, 2002, pp. 393–402.[27] I. Hodkinson, R. Kontchakov, A. Kurucz, F. Wolter, M. Zakharyaschev, On the computational complexity of decidable fragments of first-order lineartemporal logics, in: Proceedings of the International Symposium on Temporal Representation and Reasoning (TIME), IEEE Press, 2003, pp. 91–98.[28] W. van der Hoek, J.J.Ch. Meyer, Making some issues of implicit knowledge explicit, International Journal of Foundations of Computer Science 3 (2)(1992) 193–223.[29] W. van der Hoek, J.J.Ch. Meyer, J. Treur, Formal semantics of temporal epistemic reflection logic, in: Proceedings of the 4th International Workshopson Meta-Programming in Logic (META’94), Springer-Verlag, 1994, pp. 332–352.[30] G. Hughes, M. Cresswell, A New Introduction to Modal Logic, Routledge, 1996.[31] M. Huth, M. Ryan, Logic in Computer Science: Modelling and Reasoning about Systems, Cambridge University Press, 2004.[32] M. Kaneko, T. Nagashima, Game logic and its applications 1, Studia Logica 57 (1996) 325–354.[33] M. Kaneko, T. Nagashima, Game logic and its applications 2, Studia Logica 58 (1997) 273–303.[34] S. Kripke, A completeness theorem in modal logic, Journal of Symbolic Logic 24 (1959) 1–14.[35] T. Jager, An actualist semantics for quantified modal logic, Notre Dame Journal of Formal Logic 23 (1982) 335–349.[36] G. Lakemeyer, Limited reasoning in first-order knowledge bases, Artificial Intelligence 71 (2) (1994) 213–255.[37] G. Lakemeyer, Limited reasoning in first-order knowledge bases with full introspection, Artificial Intelligence 84 (1–2) (1996) 209–255.[38] L. Lamport, Time, clocks, and the ordering of events in a distributed system, Communication of the ACM 21 (7) (1978) 558–565.[39] H. Levesque, Knowledge representation and reasoning, Annual Reviews Computer Science 30 (1) (1986) 81–108.[40] D. Lewis, On the Plurality of Worlds, Blackwell, 1986.[41] Y. Liu, G. Lakemeyer, H. Levesque, A logic of limited belief for reasoning with disjunctive information, in: Proceedings of the 9th International Confer-ence on Principles of Knowledge Representation and Reasoning (KR04), AAAI Press, 2004, pp. 587–597.[42] Y. Liu, H. Levesque, Tractable reasoning in first-order knowledge bases with disjunctive information, in: Proceedings of the 20th National Conferenceon Artificial Intelligence (AAAI-05), AAAI Press, 2005, pp. 639–644.[43] A. Lomuscio, M. Colombetti, QLB: A quantified logic for belief, in: Proceedings of the 3rd International Workshop on Agent Theories, Architectures, andLanguages (ATAL-96), Springer-Verlag, 1996.[44] A. Lomuscio, F. Raimondi, MCMAS: a tool for verifying multi-agent systems, in: Proceedings of the 12th International Conference on Tools and Algo-rithms for the Construction and Analysis of Systems (TACAS06), Springer, pp. 450-454.[45] A. Lomuscio, M. Ryan, On the relation between interpreted systems and Kripke models, in: Proceedings of the AI97 Workshop on Theoretical andPractical Foundation of Intelligent Agents and Agent-Oriented Systems, Springer, 1997.[46] Z. Manna, A. Pnueli, The Temporal Logic of Reactive and Concurrent Systems, vol. 1, Springer-Verlag, 1992.[47] K. McMillan, Symbolic Model Checking: An Approach to the State Explosion Problem, Kluwer Academic Publishers, 1993.[48] R. Meyden, Axioms for knowledge and time in distributed systems with perfect recall, in: Logic in Computer Science (LICS), IEEE Computer Society,1994, pp. 448–457.[49] J.-J.Ch. Meyer, W. van der Hoek, Epistemic Logic for AI and Computer Science, Cambridge University Press, 1995.[50] R.C. Moore, The role of logic in knowledge representation and commonsense reasoning, in: Proceedings of the 2nd National Conference of the AmericanAssociation for Artificial Intelligence, AAAI Press, 1982, pp. 428–433.[51] R.C. Moore, A formal theory of knowledge and action, in: Formal Theories of the Commonsense World, Ablex Publishing Corp., 1984.[52] P. Panangaden, K. Taylor, Concurrent common knowledge: Defining agreement for asynchronous systems, Distributed Computing 6 (2) (1992) 73–93.[53] R. Parikh, R. Ramanujam, Distributed processes and the logic of knowledge, in: Proceedings of the Conference on Logic of Programs, Springer-Verlag,1985, pp. 256–268.[54] F. Raimondi, A. Lomuscio, Automatic verification of multi-agent systems by model checking via OBDDs, Journal of Applied Logic 5 (2) (2007) 235–251.[55] A. Rao, M. Georgeff, Modeling rational agents within a BDI-architectures, in: Proceedings of the 2nd International Conference on Principles of Knowl-edge Representation and Reasoning (KR’91), Morgan Kaufmann Publishers, 1991, pp. 473–484.[56] M. Reynolds, Axiomatising first-order temporal logic: Until and since over linear time, Studia Logica 57 (2/3) (1996) 279–302.[57] V. Shehtman, Completeness and incompleteness in first-order modal logic: An overview, in: Advances in Modal Logic, College Publications, 2006,pp. 27–30.[58] H. Sturm, F. Wolter, M. Zakharyaschev, Monodic epistemic predicate logic, in: Proceedings of the European Workshop on Logics in Artificial Intelligence,Springer-Verlag, 2000, pp. 329–344.[59] H. Sturm, F. Wolter, M. Zakharyaschev, Common knowledge and quantification, Economic Theory 19 (2002) 157–186.F. Belardinelli, A. Lomuscio / Artificial Intelligence 173 (2009) 982–10131013[60] R. Thomason, Some completeness results for modal predicate calculi, in: Philosophical Problems in Logic, Reidel, 1980, pp. 56–76.[61] F. Wolter, First order common knowledge logics, Studia Logica 65 (2000) 249–271.[62] F. Wolter, M. Zakharyaschev, Decidable fragments of first-order modal logics, Journal of Symbolic Logic 66 (3) (2001) 1415–1438.[63] F. Wolter, M. Zakharyaschev, Axiomatizing the monodic fragment of first-order temporal logic, Annals of Pure and Applied Logic 118 (1–2) (2002)133–145.[64] M. Wooldridge, An Introduction to Multi-Agent Systems, John Wiley, 2002.[65] M. Wooldridge, Computationally grounded theories of agency, in: Proceedings of the International Conference on Multi-Agent Systems (ICMAS), IEEEPress, 2000, pp. 13–22.[66] M. Wooldridge, Reasoning about Rational Agents, MIT Press, 2000.[67] M. Wooldridge, Verifying that agents implement a communication language, in: Proceedings of the 16th National Conference on Artificial Intelligence(AAAI-99), AAAI Press, 1999, pp. 52–57.[68] M. Wooldridge, M. Fisher, M. Huget, S. Parsons, Model checking for multiagent systems: The Mable language and its applications, International Journalon Artificial Intelligence Tools 15 (2) (2006) 195–226.[69] M. Wooldridge, M. Fisher, M. Huget, S. Parsons, Model checking multiagent systems with MABLE, in: Proceedings of the First International Conferenceon Autonomous Agents and Multiagent Systems (AAMAS02), IFAAMAS, 2002, pp. 952–959.[70] B. Wozna, A. Lomuscio, A temporal epistemic logic with a reset operation, in: Proceeding of the 6th International Conference on Autonomous Agentsand Multiagent Systems (AAMAS07), ACM, 2007, pp. 574–581.