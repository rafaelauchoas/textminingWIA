Artificial Intelligence 160 (2004) 1–34www.elsevier.com/locate/artintGeneralized Region Connection Calculus ✩Sanjiang Li ∗, Mingsheng YingState Key Laboratory of Intelligent Technology and Systems, Department of Computer Science and Technology,Tsinghua University, Beijing 100084, P.R. ChinaReceived 7 June 2002; accepted 18 May 2004AbstractThe Region Connection Calculus (RCC) is one of the most widely referenced system of high-level(qualitative) spatial reasoning. RCC assumes a continuous representation of space. This contrastssharply with the fact that spatial information obtained from physical recording devices is nowadaysinvariably digital in form and therefore implicitly uses a discrete representation of space. Recently,Galton developed a theory of discrete space that parallels RCC, but question still lies in that canwe have a theory of qualitative spatial reasoning admitting models of discrete spaces as well ascontinuous spaces? In this paper we aim at establishing a formal theory which accommodates bothdiscrete and continuous spatial information, and a generalization of Region Connection Calculus isintroduced. GRCC, the new theory, takes two primitives: the mereological notion of part and thetopological notion of connection. RCC and Galton’s theory for discrete space are both extensions ofGRCC. The relation between continuous models and discrete ones is also clarified by introducingsome operations on models of GRCC. In particular, we propose a general approach for constructingcountable RCC models as direct limits of collections of finite models. Compared with standard RCCmodels given rise from regular connected spaces, these countable models have the nice property thateach region can be constructed in finite steps from basic regions. Two interesting countable RCCmodels are also given: one is a minimal RCC model, the other is a countable sub-model of thecontinuous space R2. 2004 Elsevier B.V. All rights reserved.✩ This work was partly supported by the National Foundation of Natural Science of China (60305005,60496321, 60321002).* Corresponding author.E-mail addresses: lisanjiang@tsinghua.edu.cn (S. Li), yingmsh@tsinghua.edu.cn (M. Ying).0004-3702/$ – see front matter  2004 Elsevier B.V. All rights reserved.doi:10.1016/j.artint.2004.05.0122S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34Keywords: (Generalized) Region Connection Calculus; Qualitative spatial reasoning; (Generalized) Booleanconnection algebra; Mereology; Mereotopology; Continuous space; Discrete space1. IntroductionQualitative Spatial Reasoning (QSR) is an important subfield of AI which has appli-cations in areas such as Geographical Information Systems(GIS) [4,24,52], spatial querylanguages [10], natural languages [1] and many other fields. We invite the reader to consult[11] for an introduction and an overview of current trends.This paper focus on one of the most important formalism for QSR, viz. the RegionConnection Calculus (RCC). RCC was initially described by Randell, Cohn and Cui in [31,32], which is intended to provide a logical framework for incorporating spatial reasoninginto AI systems.RCC takes regions rather than points as fundamental notion and is based on a singleprimitive (binary relation) C (for connection). Unlike other mereotopologies, RCC makesno distinction between closed, open, and semi-open regions and does not support the notionof boundaries. It is also a well-known result that regular connected topological spacesprovide models of the RCC axioms by taking a region to mean a non-empty regular closedset and saying two regions are connected if they have common points [25]. But since eachregion is infinitely divisible, it has nothing to do with discrete spaces (in the sense that eachregion is a union of atomic regions). Randell, Cui and Cohn [32] suggest ways of atomicversions of RCC, but, as commented by Bennett [3], each of the alternatives seem morecomplex than is desirable and have not been worked out in detail. They also suggest in thatpaper that the problem lies with the definition of P, but a revised definition was not given.On the other hand, discrete spaces are evidently important in implementations of spa-tial information systems, and their mereotopological aspects have only recently begun tobe investigated [22,24,30,39,44]. As noted by Galton in [24], high-level qualitative ap-proaches to handling spatial information are widely perceived as having little relevanceto the domain of low-level quantitative data inhabited by “real-world” applications, andthe congruity between the continuous space models favored by high-level approaches andthe discrete, digital representations used at the lower level is one amongst many possiblereasons for this.Recently, Galton [24] attempts to bridge this gap by developing a high-level qualitativespatial theory of discrete space that parallels RCC, but questions still lie in, e.g., “Can wehave a high-level theory of QSR which admits models of continuous spaces as well as dis-crete spaces?” and “What is the relation between continuous spaces (e.g., R2) and discretespaces (e.g., Z2)?”. In the present paper we try to answer these questions by introducing ageneralized theory of RCC. The new theory, termed Generalized Region Connection Cal-culus (GRCC henceforth), is a subtheory of both RCC1 and Galton’s theory for discretespace.1 We are concerned in this paper with only ‘strict’ RCC [45], i.e., the extensionality of C is an axiom.S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–343The original formulation of RCC is inspired by the earlier work of Whitehead [48] andClarke [7,8]. These systems are all based on a single primitive, namely the concept ofconnection, and notions such as part are defined in terms of connection. This use of a sin-gle primitive relation is seen by Smith as problematic. In [42, p. 288], Smith puts: “Thesystem has a single primitive, that of connection, in terms of which the notion of part isdefined by means of what, intuitively, appears to be a logical trick. This means that themereological and topological components of the resultant theories are difficult or impos-sible to separate formally. The power of the approach is thus reduced, since experimentsin axiom-adjustment at different points in the theory cannot be carried out in controlledfashion”.This possible deficiency of the RCC theory, however, as Stell [45], as well as this pa-per, has shown, can be completely avoided. In [45], Stell introduces Boolean connectionalgebras (BCAs) and proves that these structures are equivalent to models of the RCC ax-ioms.2 Such an algebra is able to provide a neat separation of mereological and topologicalaspects of a set of regions. Moreover, by replacing the Boolean algebra by Łukasiewiczalgebra, Roy and Stell [38] obtain a theory of vague spatial regions. The present paper isalso strongly influenced by Stell’s idea on the treatment of spatial regions.In the GRCC theory proposed in this paper, however, we use two primitive notions: themereological notion of part P and the topological notion of connection C. This treatmentis not novel, the reader may consult for instance the work of Varzi [47] and Mosolo andVieu [30] for more discussion. In [47], Varzi systematically examines three main ways ofcombining mereologies (as theories of parthood) and topologies (as theories of wholeness)to build general mereotopologies, namely unified theories of parts and wholes. Both work,particularly that of Mosolo and Vieu [30], also investigate the possibilities of characterizingatomicity in these mereotopologies.Our mereology of GRCC (as well as the reformulated RCC theory) falls under the firstaccount of Varzi’s classifications, where mereology and topology form two independent(though mutually related) domains. Indeed, the mereological part of GRCC is the sameas the Closed Extensional Mereology (CEM) [47] (with the additional requirement thatthe universe exists). The GRCC theory is then obtained by adding three additional axiomsto the Ground Mereotopology CEMT [47]. The first requires a region a is connected tothe (mereological) sum of two regions b, c if and only if it is connected to either one ofb, c; the second stipulates in essence the universe is self-connected; the third requires thereexist at least two different regions. The original RCC theory is then obtained by adding toGRCC an additional axiom which requires that any region other than the universe cannotbe connected to all regions. Moreover, the theory of Galton for discrete space [24] is also anextension of the (atomistic) GRCC theory. Indeed, Galton’s theory is obtained by addingto GRCC three more axioms. The first two stipulate that the Boolean algebra is atomiccomplete and the third requires two regions are connected if and only if there are twoconnected atoms contained respectively in these two regions.2 The fact that each RCC model leads to a Boolean algebra is also pointed out independently by Düntsch,Wang and McCloskey [17].4S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34Eschenbach [22] also introduces a formal theory of Closed Region Calculus (CRC)based on two primitives: P for mereological notion of part and DC for the topological no-tion of disconnection or separation. CRC is similar to RCC and the 9-intersection calculus[19]. It provides the same terminology and justifies the same composition table, but differswith respect to the ontology. The main difference between CRC and RCC is that a finiteset of regions that is explicitly represented in a spatial information system can be a modelof CRC [22]. Our theory of GRCC is also a generalization of CRC in essence, it differsfrom CRC mainly in two aspects. The first is that GRCC is a first order theory while CRCis second order. The second lies in that the two theories use different topological primitivesand different systems of axioms.The fact that GRCC admits both continuous spaces and discrete spaces as models makesit possible to study the relation between these two kinds of spaces carefully. This is oneof the main intentions of this paper. To reveal the relation between continuous spaces anddiscrete spaces, in particular that between the vector space R2 and the raster space Z2, wepropose several basic operations on models of GRCC. These include the sub-structures,the local-structures, the sums and the direct limits. It is shown that the raster space Z2with either 4-neighbors or 8-neighbors, which is at the same time a model of Galton’stheory, is a sub-structure of the vector space R2. Our notion of sub-structures has intimatelyconnection with the formal framework proposed by Worboys [52] for treating the notionof resolution and multi-resolution in geographic spaces. The operation ‘sum’ on models ofGRCC is in a sense an inverse process of granulation of graphs [44].More importantly, the operation of direct limits can be applied to construct countableRCC models from collections of finite GRCC models. Compared with standard RCCmodels given rise from regular connected spaces [25] and more generally, RCC modelsconstructed from (dual) pseudo-complemented distributive lattices [45], these countablemodels have the nice property that regions in which can be finitely represented as aggre-gations of basic regions. In particular, this approach enables us to construct an RCC modelwhich is minimal in the sense that each RCC model contains it as a sub-model. Combiningwith regular spatial partitioning (of the vector space R2), we also give (as far as spatial rep-resentation is concerned) a computationally tractable RCC model (cid:2)R, C(cid:3).3 This model isa countable sub-model of the vector space R2, and its topological structure coincides withthat of R2, namely, two regions are connected if and only if they have non-empty intersec-tion. With a little adaption, regions in this model can be represented as (binary) quadtrees.This fact, together with the 4-intersection-based method (concerning the RCC5 relations)adopted by Winter in [50], leads to a hierarchical approach for determining RCC8 relationsbetween regions in this model.The present paper has a close relation with the recent GIScience 2002 work of Roy andStell [39], where the authors show how the RCC theory can be modified so as to permit dis-crete spaces. Their work is also based on Stell’s formulation of RCC as Boolean connectionalgebra [45]. They obtain their concept of connection algebra by (1) replacing the Booleanalgebra with a more general kind of lattice, here is the dual pseudo-complemented distrib-3 The phrase “computationally tractable” is in the same sense of Worboys and Bofakos [53], where the authorsdescribe a model regions in which can be uniquely represented as combinations of a finite number of atoms.S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–345utive lattice (dual p-algebra); and (2) abandoning the condition that requires non-universeregion should be disconnected from some other region. Our notion of GBCA that wouldbe given in Section 3.2 is a special case of the connection algebra, and by definition, aconnection algebra is a GBCA if and only if the ground lattice is Boolean.While (non-Boolean) connection algebras allow regions that are boundaries of otherregions, GRCC and RCC make no distinction between closed, open, and semi-open regionsand therefore do not support the notion of boundaries. Moreover, as far as discrete spacesare concerned, it seems to us exactly these non-Boolean connection algebras are what Royand Stell focused on. As a matter of fact, they give concrete examples of these non-Boolean(finite) connection algebras based on abstract cell complexes. Note that an abstract cellcomplexes is in fact a partially ordered set with certain properties. Recall the Alexandrovtopology [26, p. 45] on a partially ordered set (cid:2)P , (cid:1)(cid:3) is just the collection of all uppersets in P . It is worth noting that any connected4 partially ordered set (cid:2)P , (cid:1)(cid:3) also leadsto such a non-Boolean connection algebra (cid:2)A, C(cid:3): taking A as the lattice of closed sets,namely lower sets, of P , then A clearly is a dual p-algebra; for two elements a, b ∈ A,define C(a, b) if and only if a ∩ b (cid:6)= ∅.The structure of the paper is as follows. In Section 2 we present the mereological partof GRCC, which is indeed the Closed Extensional Mereology (CEM) [47] (with the ad-ditional requirement that the universe exists). We also show this mereology is equivalentto the theory of Boolean algebras. The theory of GRCC is then introduced in Section 3,where we also show generalized Boolean connection algebras (GBCAs) provide modelsof GRCC. Similar to Stell’s construction of BCAs [45], we also give an explicit construc-tion of GBCAs. In addition, it is shown that the theory GRCC admits connected spaces(with more than two regular closed sets) as its models. Section 4 considers consistencyof GRCC with atomicity and shows Galton’s theory of discrete space [24] is indeed anextension of (atomistic) GRCC. In Section 5, we introduce some operations on models ofGRCC—sub-structures, sums, local-structures and direct limits. The relationship betweendiscrete models and continuous ones is illustrated by one example. This suggests that someimportant discrete models are sub-structures of continuous ones. We also propose a gen-eral approach for constructing countable RCC models as direct limits of collections offinite models. In particular a minimal RCC model is obtained. In Section 6 we constructa countable computationally tractable RCC model and sketch a hierarchical approach fordetermining RCC8 relations in this model. Section 7 concludes this paper and points outsome problems for further studies.2. Mereology of GRCCIn this section we introduce the mereological part of our GRCC, which is indeed theClosed Extensional Mereology (CEM) [47] (with the additional requirement that the uni-verse exists). We also show this mereology is equivalent to the theory of Boolean algebras.4 In the sense that P with the Alexandrov topology is connected.6S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34Mereology is a theory of the binary ‘part-of’ relation, originally introduced byLe´sniewski (see [27]) as an alternative to set theory. Recently, it has been used both informal ontology, to model the generic part-whole relation, and in QSR, to model spatialinclusion between regions [1,32]. We invite the readers to consult [30,41,47] for detailedexamination of various mereologies and mereotopologies. Our notation is in accord withthat of [47].In the following we assume a standard first-order language with identity supplied witha distinguished binary predicate constant, ‘P’, to be interpreted as the (possibly improper)parthood relation.Recall that Ground Mereology M [47] is the first-order theory defined by the followingthree axioms:P(x, x),(P(x, y) ∧ P(y, x)) → x = y,(P(x, y) ∧ P(y, z)) → P(x, z).(P1)(P2)(P3)Given (P1)–(P3), a number of mereological relations can be introduced. In particular,M supports the following mereological relations of proper part (PP), overlap (O), properor partial overlap (PO), and disjointness (DR),PP(x, y) ⇔def P(x, y) ∧ ¬P(y, x),O(x, y) ⇔def ∃z[P(z, x) ∧ P(z, y)],PO(x, y) ⇔def O(x, y) ∧ ¬P(x, y) ∧ ¬P(y, x),DR(x, y) ⇔def ¬O(x, y).The Extensional Mereology EM [47] is the extension of M obtained by adding theSupplementation Axiom [41]:¬P(x, y) → ∃z(P(z, x) ∧ ¬O(z, y)).It is interesting to note that in EM the binary relation O is extensional:EM (cid:12) ∀z(O(z, x) ↔ O(z, y)) ↔ x = y.(P4)(Oext)The Closed Extensional Mereology CEM is the extension of EM obtained by addingthe following axioms:5∃z∀w(O(w, z) ↔ (O(w, x) ∨ O(w, y))),O(x, y) → ∃z∀w(P(w, z) ↔ (P(w, x) ∧ P(w, y))),∃z(P(z, x) ∧ ¬O(z, y)) → ∃z∀w(P(w, z) ↔ (P(w, x) ∧ ¬O(w, y))),∃z∀xP(x, z).(P5)(P6)(P7)(P8)5 Note that Axiom (P8) is optional in the definition of CEM given by Varzi [47].S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–347Note that in the presence of (P4), the entities whose (conditional) existence is assertedby (P5)–(P7) are unique. Thus, if the language has a description operator ‘ι’, CEM sup-ports the following definitions:x + y =def ιz∀w(O(w, z) ↔ (O(w, x) ∨ O(w, y)))x × y =def ιz∀w(P(w, z) ↔ (P(w, x) ∧ P(w, y)))x − y =def ιz∀w(P(w, z) ↔ (P(w, x) ∧ ¬O(w, y)))∼ x =def ιz∀w(P(w, z) ↔ ¬O(w, x))u =def ιz∀xP(x, z).(sum)(product)(difference)(complement)(universe)(Dsum)(Dprod)(Ddiff)(Dcomp)(Duni)We can also add infinitary closure conditions allowing the existence of sums and prod-ucts of an infinite number of entities with the following ‘fusion’ axiom, where φ is afirst-order formula and x is free in φ:∃xφ(x) → ∃z∀w(O(w, z) ↔ ∃x(φ(x) ∧ O(w, x))).(FUS)The theory of General Extensional Mereology GEM [47] is then the extension of EMobtained by adding the ‘fusion’ axiom. GEM is actually an extension of CEM.The atomistic variant of CEM (GEM) (labelled ACEM (AGEM)) [47] is the extensionof CEM by adding the axiom:∀x∃y(P(y, x) ∧ ∃z¬PP(z, y)).(P9)It is well known that every model of (A)GEM is isomorphic to an (atomic) completequasi-Boolean algebra, i.e., a Boolean algebra with the zero element removed [46]. For(A)CEM, we have a similar result:Theorem 2.1. Every model of (A)CEM is isomorphic to an (atomic) quasi-Boolean alge-bra.Proof. Suppose (cid:2)R, P(cid:3) is a model of CEM and {n} is a singleton set disjoint from R.Define binary operations ∨ and ∧ on the set of R ∪ {n} as follows:x ∨ y =(cid:1)x + yxyif x, y ∈ R,if y = n,if x = n,(cid:2)x ∧ y =x × ynif x, y ∈ R and O(x, y),otherwise.Also, we can define the unary operation (cid:18) on the set R ∪ {n} by x(cid:18) =∼ x for x ∈ R − {u},and by u(cid:18) = n, and n(cid:18) = u. Recall where u is the universe in R.For x, y ∈ R ∪ {n}, we say x (cid:1) y if either P(x, y) or x = n.Now we are going to show that the structure (cid:2)R ∪ {n}; u, n,(cid:18) , ∧, ∨(cid:3) is a Boolean algebra.We first show the structure (cid:2)R ∪ {n}, (cid:1)(cid:3) is a partially ordered set. This is clear by (P1)–(P3).Second, we demonstrate that ∨ and ∧ defined on R ∪ {n} are the supremum and infimumoperations on (cid:2)R ∪ {n}, (cid:1)(cid:3) respectively. To this end, note that we have the following facts:1. ∀x, y, z ∈ R · P(x + y, z) ⇔ P(x, z) ∧ P(y, z),2. ∀x, y, z ∈ R · O(y, z) ∧ P(x, y × z) ⇔ P(x, y) ∧ P(x, z).8S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34Next we prove the distributivity:∀x, y, z ∈ R ∪ {n} · x ∧ (y ∨ z) = (x ∧ y) ∨ (x ∧ z).We need only to show the “(cid:1)”-part. Without any loss of generality, we assume x ∧(y ∨z) (cid:6)=n, i.e., O(x, y +z). Suppose O(m, x ∧(y ∨z)) for some m ∈ R, we show either O(m, x ∧y)or O(m, x ∧ z) holds. By O(m, x ∧ (y ∨ z)), we have some r ∈ R such that r (cid:1) m andr (cid:1) x ∧ (y ∨ z), hence r (cid:1) m, r (cid:1) x and r (cid:1) y ∨ z. Note that by r (cid:1) y ∨ z we haveO(r, y ∨ z), hence either O(r, y) or O(r, z) holds. Then there exists some p ∈ R such thatp (cid:1) r and p (cid:1) y or p (cid:1) r and p (cid:1) z, thereby p (cid:1) m and p (cid:1) x ∧y or p (cid:1) m and p (cid:1) x ∧z.Hence by definition we have either O(m, x ∧ y) or O(m, x ∧ z).Lastly we show x ∧ x(cid:18) = n, x ∨ x(cid:18) = u hold for any x ∈ R ∪ {n}. Note that if x iseither u or n, these two conditions hold by definition. So we suppose x ∈ R − {u}. SinceP(x(cid:18), x(cid:18)) is always true for each x ∈ R − {n}, we have by (Dcomp) and (P7) ¬O(x(cid:18), x),i.e., x ∧ x(cid:18) = n. Moreover, for each r ∈ R, we have either P(r, x(cid:18)) or ¬P(r, x(cid:18)). Note thatthe latter is the same as O(r, x) by (Dcomp) and (P7). Accordingly, by (Dsum) and (P5),we have O(r, x ∨ x(cid:18)) for each r ∈ R, therefore x ∨ x(cid:18) = u.So far we have proved that (cid:2)R ∪ {n}; u, n,(cid:18) , ∧, ∨(cid:3) is a Boolean algebra for each model(cid:2)R, P(cid:3). If (cid:2)R, P(cid:3) satisfies moreover (P9), clearly the Boolean algebra (cid:2)R ∪ {n}; u, n,(cid:18) , ∧, ∨(cid:3)is atomic.On the other hand, for any Boolean algebra A = (cid:2)A; ⊥, (cid:20),(cid:18) , ∧, ∨(cid:3), let R = A − {⊥}.For any two elements x, y ∈ R, write P(x, y) if and only if x (cid:1) y in A. Then it is straight-forward to verify that the structure (cid:2)R, P(cid:3) is a model of CEM. In case that A is atomic,clearly the CEM model (cid:2)R, P(cid:3) satisfies (P9). (cid:1)So models of the CEM axioms are equivalent to quasi-Boolean algebras. Suppose A =(cid:2)A; ⊥, (cid:20),(cid:18) , ∧, ∨(cid:3) is a Boolean algebra. Let R = A − {⊥} and write P(x, y) if x (cid:1) y in Afor any two elements x, y in R. Then we have u = (cid:20), and x × y = x ∧ y, x − y = x ∧ y(cid:18)for all x, y ∈ R, and ∼ x = x(cid:18) for all x ∈ R − {(cid:20)}. Moreover, for all x, y ∈ R, we haveP(x, y)PP(x, y)O(x, y)DR(x, y)PO(x, y)iffiffiffiffiffx (cid:1) y,x < y,x ∧ y > ⊥,x ∧ y = ⊥,x ∧ y > ⊥ and neither x (cid:1) y nor x (cid:2) y.In what follows we shall, for brevity, make no distinction between notations in CEM andthe corresponding notations in Boolean algebras, e.g., the pair P(x, y) and x (cid:1) y for x, y ∈R, or the pair ∼ x and x(cid:18) for x ∈ R − {u}.3. The generalized Region Connection CalculusTheories combining mereological notions and topological ones like those of “being con-nected with” or “being self-connected” have been called mereotopologies. In this section,S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–349we expand our language by adding a second distinguished predicate constant, ‘C’, theconnection. Based on C, we have the following definitions:DC(x, y) ⇔def ¬C(x, y),EC(x, y) ⇔def C(x, y) ∧ ¬O(x, y),TPP(x, y) ⇔def PP(x, y) ∧ ∃z[EC(z, x) ∧ EC(z, y)],NTPP(x, y) ⇔def PP(x, y) ∧ ¬∃z[EC(z, x) ∧ EC(z, y)].3.1. Ground Mereotopology CEMTThe Ground Mereotopology CEMT [47] is the extension of CEM obtained by addingthe following axioms:C(x, x),C(x, y) → C(y, x),P(x, y) → ∀z(C(z, x) → C(z, y)).(C1)(C2)(C3)Since models of the CEM axioms are equivalent to quasi-Boolean algebras, a model ofthe CEMT axioms can be represented as (cid:2)R, P, C(cid:3) or simply (cid:2)R, C(cid:3), where R = A − {⊥}and A = (cid:2)A; ⊥, (cid:20),(cid:18) , ∧, ∨(cid:3) is a Boolean algebra, P(x, y) if and only if x (cid:1) y in R and C isa binary relation on R satisfying (C1)–(C3). Note that in A we have x ∧ y = ⊥ if and onlyif x (cid:1) y(cid:18).Usually CEMT can be extended by adding one or more of the following importantformulae:C(z, x + y) ↔ (C(z, x) ∨ C(z, y)),∃z¬P(z, x) → C(x, ∼ x),∃z¬P(z, x) → (∃z¬C(z, x)).(C4)(C5)(C6)The following theorem shows that, in CEMT, the ‘Complement Axiom’ (C5) is equiv-alent to extensionality for EC.Theorem 3.1. In CEMT, the following formulae are equivalent to (C5):∀z(EC(x, z) ↔ EC(y, z)) → x = y,∀z(EC(x, z) ↔ EC(y, z)) ↔ x = y.(C5(cid:18))(ECext)Proof. Clearly (C5(cid:18)) and (ECext) are equivalent in CEMT. We show (C5)↔(C5(cid:18)) inCEMT.Since CEMT is a first-order theory, we need only to show (C5) ↔ (C5(cid:18)) are true in anyCEMT model. Suppose (cid:2)R, C(cid:3) is a CEMT model, where R = A − {⊥} and A is a Booleanalgebra.Note that ∃z¬P(z, y) if and only if y is not the universe.Suppose (C5) holds in R and x, y are two elements in R satisfying EC(x, z) if and onlyif EC(y, z) for any z ∈ R. We now show x = y. Note that ¬EC(z, u) holds for any z in R.10S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34If one of x, y is the universe, we must have both are the universe. Now suppose neither isthe universe. Since (C5) holds, we have EC(x, x(cid:18)) and EC(y, y(cid:18)). By assumption, we alsohave EC(y, x(cid:18)) and EC(x, y(cid:18)), hence y (cid:1) x and x (cid:1) y hold. Consequently we have x = y.On the other hand, suppose (C5(cid:18)) holds in R and x is an element in R other than theuniverse. Take y = u, the universe. Then by x (cid:6)= y we have some element z in R withEC(x, z). Since z (cid:1) x(cid:18), we must have EC(x, x(cid:18)) by (C3).This ends the proof. (cid:1)The following theorem shows the axiom (C6), which stipulates that each non-universalregion is disconnected from some other region, is equivalent to extensionality for C inCEMT.Theorem 3.2. In CEMT, the following formulae are equivalent to (C6):∀z(C(z, x) → C(z, y)) → P(x, y),∀z(C(z, x) ↔ C(z, y)) ↔ x = y.(C6(cid:18))(Cext)Proof. That (C6(cid:18)) is equivalent to (Cext) is clear. We show (C6) ↔ (C6(cid:18)) is true in eachmodel of CEMT.Let (cid:2)R, C(cid:3) be a CEMT model, where R = A − {⊥} and A is a Boolean algebra.Suppose (C6) holds in R and x, y are two elements in R with x (cid:6)(cid:1) y. Then x − y ∈ Rand (x − y)(cid:18) = x(cid:18) ∨ y (cid:6)= (cid:20). Since (C6) holds in R we have some z ∈ R with DC(z, x(cid:18) ∨ y).Clearly z (cid:1) x and DC(z, y) hold. Therefore we have an element z ∈ R with C(z, x) butDC(z, y). As a result (C6(cid:18)) is true in R.On the other hand, suppose (C6(cid:18)) holds in R and y ∈ R is not the universe. If C(z, y)holds for any z ∈ R, then by (C6(cid:18)) we have x (cid:1) y for any x ∈ R. This cannot be true sincey is not the universe. Therefore we must have some z ∈ R with DC(z, y). As a result, (C6)is true in R. (cid:1)Remark 3.1. In [30, p. 248], Masolo and Vieu note that in GEMT and CEMT, “Without(C4) [ours (C6(cid:18))], one could believe P is not constrained enough (with respect to the topo-logical primitive C) to account for spatial inclusion. Thus, the possibility to add weakeraxioms than (C4) should be explored”. The above Theorem 3.1 shows that in any theorystronger than CEMT + (C5) (for instance the GRCC to be given in next subsection), (C5(cid:18))as well as (ECext) is a theorem. This suggests (C5) or but equivalently (C5(cid:18)) can be used asa weaker axiom for constraining P. Note also that the counter-model given in [30, p. 249,Fig. 4.b] is misinterpreted for the authors only consider the atomic regions while any modelof CEMT is a quasi-Boolean algebra.Note that in CEMT, the axiom (C5) is equivalent to say the universe u is self-connected,namely, for any two regions x, y, we have C(x, y) if x + y = u. The following theoremsuggests that, in any CEMT model with a self-connected universe, the NTPP and TPPrelations can be defined without explicitly using a quantifier.S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3411Theorem 3.3. Let (cid:2)R, C(cid:3) be a CEMT model satisfying moreover (C5), i.e., C(x, x(cid:18)) forany x (cid:6)= (cid:20), where R = A − {⊥} and A is a Boolean algebra. Suppose y ∈ R is not theuniverse. Then we have(1) NTPP(x, y) if and only if DC(x, y(cid:18));(2) TPP(x, y) if and only if EC(x, y(cid:18)) and x (cid:6)= y.Proof. (1) Suppose NTPP(x, y). We show DC(x, y(cid:18)). Since x < y, we have eitherEC(x, y(cid:18)) or DC(x, y(cid:18)). If EC(x, y(cid:18)) holds, then by (C3) and x < y, we shall haveEC(y, y(cid:18)) and EC(x, y(cid:18)). This cannot be true since NTPP(x, y). Therefore DC(x, y(cid:18))holds.On the other hand, suppose DC(x, y(cid:18)) we show NTPP(x, y). We have x (cid:1) y sincex ∧ y(cid:18) = ⊥. Moreover, by (C5), x cannot be equal to y. If there exists some m ∈ R suchthat EC(m, x) and EC(m, y), then m (cid:1) y(cid:18). But by DC(x, y(cid:18)), we also have DC(x, m), acontradiction.(2) Suppose TPP(x, y). Clearly we have x (cid:6)= y and x ∧ y(cid:18) = ⊥ by x < y. Moreover, by(1) and ¬NTPP(x, y), we have C(x, y(cid:18)). Therefore EC(x, y(cid:18)).On the other hand, suppose EC(x, y(cid:18)) holds and x (cid:6)= y. Then x < y and, by (1),¬NTPP(x, y). Therefore TPP(x, y) holds. (cid:1)By above theorems we also have the following theorem which shows, in any theorystronger than CEMT + (C5), the axiom (C6) is also equivalent to a variant of the ‘NTPP’axiom appeared in the original RCC theory [32].Theorem 3.4. In the theory obtained by adding (C5) to CEMT, the following formula(NTPP) is also equivalent to (C6):∃z¬P(z, x) → ∃zNTPP(z, x).(NTPP)Proof. Note that ∃z¬P(z, x) ↔ ∃z¬P(z, ∼ x) and ∼ (∼ x) = x. This follows from Theo-rem 3.2 and Theorem 3.3(1). (cid:1)Note that CEMT has a trivial model (cid:2)R, C(cid:3) where R = A − {⊥} and A = {⊥, (cid:20)} whichalso satisfies (C4)–(C6).3.2. Generalized Boolean connection algebrasOur theory of Generalized Region Connection Calculus (GRCC) is obtained by addingAxioms (C4), (C5) and (C7) to the Ground Mereotopology CEMT induced by CEM:∃xyPP(x, y).(C7)This axiom is added to exclude the trivial model described in the end of above subsection.We now justify that GRCC is indeed a generalization of the theory of Region Con-nection Calculus (RCC). Note that there are several equivalent ways of formulating theoriginal RCC, we now follow the one in terms of Boolean connection algebras proposed12S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34by Stell [45]. BCAs permit a wealth of results from the theory of Boolean algebras to beapplied to RCC. This notion can be adapted to provide models of GRCC.Definition 3.1. Let A = (cid:2)A; ⊥, (cid:20),(cid:18) , ∨, ∧(cid:3) be a Boolean algebra with more than two el-ements, let R denote A − {⊥}, and let R− denote R − {(cid:20)}. If C is a binary relation onR, then the structure (cid:2)A; C(cid:3) is said to be a generalized Boolean connection algebra if itsatisfies the following conditions.A1. C is symmetric and reflexive.A2. ∀x ∈ R− · C(x, x(cid:18)).A3. ∀x, y, z ∈ R · C(x, y ∨ z) iff C(x, y) or C(x, z).A generalized Boolean connection algebra (GBCA henceforth) (cid:2)A, C(cid:3) is called a Booleanconnection algebra (BCA) [45] if C satisfies additionally the following condition:A4. ∀x ∈ R− · ∃y ∈ R · ¬C(x, y).We say two GBCAs (or BCAs) (cid:2)A1, C1(cid:3) and (cid:2)A2, C2(cid:3) are isomorphic if there is aBoolean isomorphism f : A1 → A2 such that for any two elements a, b ∈ A1, C1(a, b)if and only if C2(f (a), f (b)).We have shown in Section 2 quasi-Boolean algebras coincide with models of CEM, themereological part of GRCC. Consequently, the equivalence between GBCAs and modelsof GRCC is clear. In the rest of this paper, we shall make no distinction between a GRCCmodel and its corresponding GBCA structure, and we shall often refer to a GRCC model(or its corresponding GBCA) by its ground set.Note that Stell has shown that BCAs are equivalent to models of the RCC axioms [45].Clearly, since models of CEM are equivalent to quasi-Boolean algebras, BCAs are alsoequivalent to models of GRCC + (C6). In another word, the original theory of RCC can beequivalently formulated as the extension of CEMT obtained by adding axioms (C4)–(C7).Consequently our theory of GRCC is indeed a generalization of RCC.Remark 3.2. In the original formulation of RCC [31,32], the authors use the connection‘C’ as the unique primitive relation. In particular, the parthood relation ‘P’ and the quasi-Boolean operations ‘sum’, ‘difference’, ‘complement’ and the ‘universe’ are defined interms of ‘C’ as follows:6P(x, y) ⇔def ∀z(C(z, x) → C(z, y)),x +(cid:18)x ×(cid:18) y =def ιz∀w(C(w, z) ↔ ∃v(P(v, x) ∧ P(v, y) ∧ C(w, v))),y =def ιz∀w(C(w, z) ↔ (C(w, x) ∨ C(w, y))),6 In [31] and in the earlier work of Clarke, the complement definition is defined so that a region y connectswith the complement of region x if and only if y is not a part of x. This brings the consequence that no region isconnected with its complement. The revised definition of complement given below appeared in [32].S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3413∼(cid:18) x =def ιz∀w((C(w, z) ↔ ¬NTPP(w, x)) ∧ (O(w, z) ↔ ¬P(w, x))),x −(cid:18) y =def ιz∀w(C(w, z) ↔ C(w, x × (∼ y))),(cid:18) =def ιz∀xC(x, z),uwhere we use primes to distinguish the new operators from those defined in terms of ‘P’.This scarcity of primitives is usually recognized as a major attractive feature of the RCCtheory. However, as noted by Smith [42], this formulation makes it difficult to separateformally the mereological and topological parts of the theory. Fortunately, the conceptof Boolean connection algebras proposed by Stell [45], as well as the reformulation ofRCC given above, suggests a clear separation of mereological part of the RCC from thetopological part. It is worth noting that, in the reformulation of RCC given above, the twokinds of definitions of the quasi-Boolean operations are equivalent. Such a separation isvery helpful for modifying the RCC theory to develop formal theories of, for example,discrete space (as this paper and [39] have shown) or vague spatial regions (see [38]).Fig. 1 illustrates the hierarchy of binary relations defined in GRCC which is in accor-dance with the hierarchy of relations in RCC [32], where (cid:1)i denotes the inverse of (cid:1) for(cid:1) ∈ {P, PP, TPP, NTPP}. Relations in {DC, EC, PO, EQ, TPP, NTPP, TPPi, NTPPi}are identified as of particular importance [32]. This set of binary topological relations,known as RCC8 in the literature, has among others the following merits: RCC8 forms aJEPD set of relations and a composition table was derived which provides a basis for qual-itative spatial reasoning [13,19]; RCC8 is one of the smallest sets of relations which makestopological distinctions rather than just mereological ones; The same set of relations hasbeen independently identified as significant in the context of Geographical InformationSystems (GIS) (see [19,20]).It is worth noting that, for RCC8 relations, GRCC justifies the same composition tableas that in RCC by Cui, Cohn and Randell [13]. For details we refer the reader to [28].BCAs have some interesting properties. For example, given an arbitrary a ∈ A − {⊥, (cid:20)}and any Φ ∈ {DC, EC, PO, =, TPP, NTPP, TPPi, NTPPi}, there exists a region a∗ ∈ A −{⊥, (cid:20)} such that (a, a∗) ∈ Φ [28].Fig. 1. Inclusion hierarchy of relations defined in GRCC and RCC.14S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34The connection between BCA and Boolean algebra is an interesting problem. Clearlyeach BCA is an atomless Boolean algebra, however, the following question is still open:7Question. If A is an atomless Boolean algebra, does there exist some connection relationC on A such that (cid:2)A, C(cid:3) is a BCA?Remark 3.3. It is claimed in [14] that if A is an atomless Boolean algebra, then there existssome connection relation C on A such that (cid:2)A, C(cid:3) is a model of the RCC theory. But theproof given there is not correct. Düntsch’s proof relies on the following statement:Let X be a connected regular T0 space. If B is an atomless subalgebra of the regularclosed lattice of X, then B, together with the connection defined for all x, y ∈ B − {∅} as:C(x, y) iff x ∩ y (cid:6)= ∅, is a BCA.Unfortunately, this is not true. Let X be the unit closed disk in the real plane and let B bethe subalgebra generated by all (closed) sectors. Then the connection defined as in abovestatement is a trivial relation. This is since that any two sectors are connected, namely, theirintersection is non-empty.Note that there is only one (up to isomorphism) countable atomless Boolean algebra [6,p. 39, Proposition 1.4.5]. The BCA constructed in [45, Section 6.3], as well as the minimalBCA we shall introduced later, shows this question has affirmative answer for countableBoolean algebras.8But for GBCA, the corresponding question is trivial. Given a Boolean algebra A, letC = (A − {⊥})2, then (cid:2)A, C(cid:3) is a GBCA. We call this relation the trivial connection onA. These trivial GBCAs could be excluded by replacing Axiom (C7) by the followingformulae∃xy¬C(x, y).3.3. A construction for GBCAs(C7(cid:18))In [45], J.G. Stell also gives a construction of BCAs, hence a construction of models ofRCC. This construction is still valid for GBCAs.We recall some definitions and notations from [2,45].A pseudo-complemented distributive lattice A is defined as a distributive lattice, A,equipped with a unary operation ∗ : A → A, such that, for all a ∈ A, a∗ is the pseudo-complement of a, namely, a∗ is the greatest element of {x ∈ A | a ∧ x = ⊥}. The set ofskeletal elements of A is defined by S(A) = {a ∈ A | a∗∗ = a} = {a∗ | a ∈ A}. It is well-known that S(A) is a Boolean algebra where ⊥ and (cid:20) are as in A, the complementationis the restriction of the pseudo-complement to S(A), and where the meet, (cid:21), and the join,7 Recently, Düntsch and Winter [16] have shown that every RCC model is isomorphic to a substructure ofsome (cid:2)X, CX(cid:3) for a connected weakly regular T1 space X.8 The discussion of the case of countable Boolean algebras was suggested to us by one referee.S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3415(cid:22), are defined by x (cid:21) y = x ∧ y, and x (cid:22) y = (x ∨ y)∗∗ [2]. A lattice, A, is connectedif it does not contain elements a (cid:6)= ⊥ and b (cid:6)= ⊥ such that a ∨ b = (cid:20) and a ∧ b = ⊥.A pseudo-complemented distributive lattice A is inexhaustible if for every b ∈ S(A) − {⊥}there is some a ∈ S(A) − {⊥} such that a∗ ∨ b = (cid:20) [45]. (Definition 26 in [45] is clearlymisdefined for that it allows a = ⊥ and therefore each pseudo-complemented distributivelattice will be inexhaustible.)Let (cid:2)A; ⊥, (cid:20),∗ , ∨, ∧(cid:3) be a pseudo-complemented distributive lattice with (cid:2)S(A);⊥, (cid:20),(cid:18) , (cid:22), (cid:21)(cid:3) as the Boolean algebra of its skeletal elements, and let the relation C onS(A) − {⊥} be defined by C(x, y) iff x∗ ∨ y∗ (cid:6)= (cid:20).Stell shows that if A is connected and inexhaustible and if S(A) contains more thantwo elements, then (cid:2)S(A); C(cid:3) is a BCA [45]. Conversely, if S(A) contains more than twoelements and if (cid:2)S(A); C(cid:3) is a BCA, then A must be connected and inexhaustible. In factwe have the followingTheorem 3.5. Let (cid:2)A; ⊥, (cid:20),∗ , ∨, ∧(cid:3) be a pseudo-complemented distributive lattice with(cid:2)S(A); ⊥, (cid:20), (cid:18), (cid:22), (cid:21)(cid:3) as its Boolean algebra of skeletal elements, and let the relation C onS(A) − {⊥} be defined by C(x, y) iff x∗ ∨ y∗ (cid:6)= (cid:20). Suppose that S(A) contains more thantwo elements. Then (cid:2)S(A); C(cid:3) is a GBCA (BCA, respectively) if and only if A is connected(connected and inexhaustible, respectively).Proof. The proof is routine and similar to that given in [45]. (cid:1)A topological space X is said to be inexhaustible if the lattice of its open sets is so. Thenwe have the followingCorollary 3.1 [25,45]. Let X be a topological space, let R be the set of non-empty regularopen sets of X, and assume that R contains more than two elements. Define the relationC on R by C(H, K) iff H ∩ K (cid:6)= ∅. Define H + K to be the interior of H ∪ K, defineH × K to be H ∩ K, and ∼ H to be the interior of X − H . Then (cid:2)R, C(cid:3) is a model ofthe GRCC (RCC, respectively) if and only if X is connected (connected and inexhaustible,respectively).A dual construction of RCC models from a pseudo-supplemented distributive lattice isalso given in [45]. A result dual to that in the above corollary is also valid, which assertsthat a model of RCC can also be obtained from the non-empty regular closed sets of atopological space. This result appeared first in [25] for regular connected spaces. Similarresults are valid for GRCC too.Corollary 3.2 [25,45]. Let X be a connected topological space, let R be the set of non-empty regular closed sets of X, and assume that R contains more than two elements. Definethe relation C on R by C(H, K) iff H ∩ K (cid:6)= ∅. Also define H + K to be H ∪ K, defineH × K to be the closure of the interior of H ∩ K, and ∼ H to be the closure of X − H .Then (cid:2)R, C(cid:3) is a model of the GRCC. If X is moreover regular, then (cid:2)R, C(cid:3) is a model ofthe RCC.16S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34For each connected topological space X, we call the relation defined above (for regularclosed sets) the canonical connection relation on X and denote by (cid:2)X, CX(cid:3) or simply(cid:2)X, C(cid:3), the corresponding GBCA. In particular, we shall refer the standard RCC model onR2 simply by (cid:2)R2, C(cid:3).4. Consistency of GRCC with atomicityThe RCC theory requests each region has a non-tangential proper part, consequently itdoes not support atomic regions. Nevertheless, atomicity is especially important if oneseeks to bridge the gap between high-level qualitative approaches to handling spatialinformation and the domain of low-level quantitative data abounded in the real-world appli-cations. Recently, Masolo and Vieu [30] and Galton [24] investigated the mereotopologicalproperties of discrete spaces. In [30], the authors investigate the possibility of characteriz-ing atomicity in various schemes of mereotopologies classified in [47], in particular theyshow GEMT is consistent with Axioms (P9) (the atomicity axiom) and (C5) (which isequivalent to say the universe is self-connected). In [24], Galton has outlined a theory ofdiscrete space that parallels the RCC theory which is, as we shall show, an extension of theGRCC theory.Since the corresponding BCA of each regular connected topological space X is com-plete, the ‘fusion’ axiom (FUS) is consistent with the RCC theory. However, if we interpretthe ‘fusion’ operation in terms of ‘C’, the resulting formula (FUS(cid:18)) is inconsistent with theRCC theory:∃xφ(x) → ∃z∀w(C(w, z) ↔ ∃x(φ(x) ∧ C(w, x))).(FUS(cid:18))This is because that (NTPP) is a theorem in RCC and each region is the fusion of its non-tangential proper parts. But, as this section shall show, this ‘C’-based ‘fusion’ axiom isalso consistent with the GRCC theory.We now briefly introduce the mereotopology of discrete space developed by Gal-ton [24].Galton’s theory of discrete space is motivated by a desire to bridge the gap betweenhigh-level qualitative approaches to spatial information and lower-level quantitative ones.The fundamental notion for a discrete space is that of adjacency. This is a relation on theminimal elements of the space, called by Galton cells. Two regions, identified as sets ofcells, are connected if some cell in one region is adjacent (or equal) to some cell in theother. It is on this notion of connection that Galton founds his theory of discrete space.In the original formulation of his theory, Galton makes no assumption concerning furtherproperties of the adjacency relation. However, for practical application, it is natural toassume the universe is self-connected, this means for any two regions a, b, we have a + b =u → C(a, b).Suppose X is a nonempty set containing at least two elements and A is a binary reflexivesymmetric relation on X satisfying a ∪ b = X → ∃xy ∈ X(x ∈ a ∧ y ∈ b ∧ A(x, y)) forany two nonempty subsets a, b ⊆ X. This binary relation A is called an adjacency relationon X and the structure (cid:2)X, A(cid:3) is called an adjacency space. Note that a region in (cid:2)X, A(cid:3) isS. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3417just a nonempty subset of X and two regions a, b are related as C(a, b) if and only if thereexist two elements x, y ∈ X with x ∈ a, y ∈ b and A(x, y).Under this natural assumption, we next show Galton’s theory of adjacency spaces isindeed an extension of GRCC.Theorem 4.1. Galton’s theory of adjacency spaces is equivalent to the theory obtained byadding (P9), (FUS), (FUS(cid:18)) and the following axiom to GRCC:C(a, b) → ∃xy(AT(x) ∧ AT(y) ∧ P(x, a) ∧ P(y, b) ∧ C(x, y))(C8)where AT(x) ⇔def ¬∃zPP(z, x).Proof. Suppose (cid:2)X, A(cid:3) is an adjacency space. Then Galton’s model of discrete space isindeed a powerset algebra (2X, C) where two regions a, b, namely two nonempty subsetsof X, are related as C(a, b) if and only if there exist two elements x, y in a, b respectivelywith C({x}, {y}). Roughly speaking, the adjacency relation A is just the restriction of theconnection C on the class of singleton subsets of X. Clearly such a model fulfills theaxioms of GRCC as well as (P9), (C8), (FUS) and (FUS(cid:18)). Moreover, for any nonemptysubset φ of 2X, set zφ = ∪φ. Then zφ satisfies the condition specified in (FUS(cid:18)), i.e., forany region w, w is connected with zφ if and only if there exists some region x ∈ φ such thatw is connected with x. But there may be regions other than zφ satisfying above condition.On the other hand, suppose (cid:2)B, C(cid:3) is a GBCA which satisfies (P9), (C8), (FUS) and(FUS(cid:18)). Then B is an atomic complete Boolean algebra with more than two elements.Note that it is a standard result that an atomic complete Boolean algebra is equivalent to apowerset algebra. Suppose X is a set with at least two elements such that B ∼= 2X. Definea binary relation A on X as A(x, y) if and only if C({x}, {y}) for any two elements x, yin X. Clearly A is an adjacency relation in the sense of Galton. Since (cid:2)B, C(cid:3) satisfies(C8), clearly two regions a, b are related as C(a, b) if and only if there exist two elementsx, y ∈ X with x ∈ a, y ∈ b and A(x, y). Moreover, the universe X is also self-connectedsince (cid:2)B, C(cid:3) is a GBCA. (cid:1)In what follows we shall refer to this mereotopology as Galton’s theory. Note that in thistheory, the ‘C’-based fusion axiom is redundant. In fact, suppose (cid:2)B, C(cid:3) is a GBCA whichsatisfies (P9), (C8) and (FUS) and φ is a nonempty set of regions. Set zφ = ∨φ. Then it isroutine to check zφ satisfies the condition specified in (FUS(cid:18)). But it is not clear whetheror not (C8) is deducible from (P9) + (FUS) + (FUS(cid:18)) in GRCC.In [24], Galton also gives a reformulation of the RCC8 relations, but the definition of‘TPP’ is not right. Galton specifies two regions a, b are related as TPP(a, b) if and onlyif EC(a, X − b). Note that if the universe X is self-connected, this will lead to TPP(a, a)for any proper region a. Thus the definition should be replaced by, for instance, TPP(a, b)if and only if PP(a, b) and EC(a, X − b).The following example shows that (FUS) is independent to (P9) + (C8) + (FUS(cid:18)) inGRCC.Example 4.1 (FUS) is independent to (P9) + (C8) + (FUS(cid:18)) in GRCC. Take X = N andset B as the finite-cofinite subalgebra of 2X, namely a subset a of X is in B if and only if18S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34either a or X − a is finite. For two regions a, b (namely two nonzero elements) in B, defineC(a, b) if and only if there exist x ∈ a and y ∈ b such that x = y or |x − y| (cid:2) 3. ClearlyB is a non-complete atomic Boolean algebra and (cid:2)B, C(cid:3) is a GBCA which satisfies (P9)and (C8). It is routine to check that (cid:2)B, C(cid:3) also satisfies (FUS(cid:18)). Suppose φ is a nonemptycollection of regions, then we can take zφ = ∪φ or zφ = N according to whether ∪φ is finiteor infinite. Now it is straightforward to show zφ satisfies the condition specified prescribedin (FUS(cid:18)). However, since B is non-complete, (cid:2)B, C(cid:3) does not satisfy (FUS).The following example shows (C8) and (FUS(cid:18)) is independent to (P9) + (FUS) inGRCC.Example 4.2 ((C8) and (FUS(cid:18)) is independent to (P9) + (FUS) in GRCC). Take X as aset containing infinitely many elements and set B = 2X. For two regions a, b in B, defineC(a, b) if and only if either a ∩ b (cid:6)= ∅ or a ∪ b is infinite. It is now routine to check that(cid:2)B, C(cid:3) is indeed an atomic complete GBCA. That (cid:2)B, C(cid:3) does not satisfy (C8) is clear bythe definition of C. As for (FUS(cid:18)), take Y ⊂ X such that both Y and X − Y are infinite.Set φ = {{x}: x ∈ Y } and suppose zφ is a region which satisfies the condition specified in(FUS(cid:18)). Clearly zφ cannot be finite since it connects with each element in φ. But if zφ isinfinite, by the definition of C, it will connect with all regions. Note that a singleton set{x} with x /∈ Y is disconnected from any b ∈ φ. {x} is therefore disconnected from zφ , acontradiction. Consequently, such a region zφ cannot exist and hence (FUS(cid:18)) is not true in(cid:2)B, C(cid:3).But for a GBCA (cid:2)B, C(cid:3), if B is finite, it must be a model of the Galton’s theory. This issince any finite Boolean algebra is also atomic complete, and hence a power set algebra.In what follows we describe an important example of discrete space.In practice, the most useful discrete (raster) space is the digital plane Z2, which is de-fined as a rectangular array of points or pixels. Each point is addressed by a pair of integervalued coordinates (x, y). We briefly review here the concepts most relevant. More exten-sive and detailed treatments of digital topology can be found in [37].Given a point in the plane, the neighboring points can be classified as 4-neighbors or 8-neighbors. The 4-neighbors of a point P are the vertically and horizontally adjacent points.Along with the diagonally adjacent points, they form the 8-neighbors (see Fig. 2). Then,in terms of Galton, we have two adjacency A4 and A8 and therefore two connections C4and C8 respectively. The corresponding GBCAs are denoted by9 (cid:2)Z2, C4(cid:3) and (cid:2)Z2, C8(cid:3)respectively.These two GBCAs both can be realized in the vector space R2. In fact, let P4 denote theset of all closed disks centered at each point in Z2 with radium 1/2 and let P8 be the set ofall closed squares centered at each point in Z2 with length 1 (see Fig. 2). The subalgebras of(cid:2)R2, C(cid:3) generated by P4 and P8 are denoted by B4 and B8 respectively. Clearly (cid:2)Bi , C|Bi(cid:3)is isomorphic to (cid:2)Z2, Ci(cid:3) for i = 4 or i = 8.9 Strictly speaking, these GBCAs should be written as (cid:2)2Z2, C4(cid:3) and (cid:2)2Z2, C8(cid:3) respectively. But for simplicitywe refer them as what follows.S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3419Fig. 2. A4 and A8 (left) and P4 and P8 (right).The GBCA B8 deserves a careful analysis. In this model, we interpret the raster ele-ments as fields (instead of lattice points) and the raster is a regular subdivision of spaceinto squares of equal size. Note that B8 has the same topology as R2 in the sense that theconnections are same. The so called hybrid raster representation [51] relates to this modelclosely. Each (bounded) region now is a (finite) union of elements in P8, which is clearly aregular closed set in R2. The well-known 4-intersection or 9-intersection approach now canbe applied to (simple connected) regions in B8 to determine the RCC8 relations betweenthem. This is in essence what has been explored by Winter [49,51]. Winter’s approachcontrasts sharply with the raster representation approach of Egenhofer and Sharma [21],the latter is based on digital topology and topological relations between regions in a rasterrepresentation are not the same as the RCC8 relations.5. Operations on GBCAsFormalisms of qualitative spatial representation such as RCC are mainly concerned witha single model, relation between these models are rarely investigated.10 In this section weintroduce several operations on models of GRCC, or in another word, on GBCAs. Theseconception, especially that of sub-structures and direct limits will shed light on the relationbetween continuous (vector) spaces and discrete (raster) spaces.5.1. Sub-structures of GBCAsGiven a GBCA (cid:2)A, C(cid:3), if B is a subalgebra of A with more than two elements, then wehave a binary relation on B − {⊥} obtained by restricting C on B − {⊥}. Write this binaryrelation as C|B , then it is straightforward to check that (cid:2)B, C|B (cid:3) is also a GBCA.Definition 5.1 (Sub-structure). 11 Given (cid:2)A, C(cid:3) a GBCA, if B is a subalgebra of A withmore than two elements, then the GBCA (cid:2)B, C|B (cid:3) is called a sub-structure, or a sub-GBCAof (cid:2)A, C(cid:3). If B happens to be a BCA, we say B is a sub-BCA of A.10 In [21], Egenhofer and Sharma compared topological relations between regions in R2 and Z2, but relationbetween these models is still left untouched.11 A similar definition is also given by Düntsch for Boolean Contact Algebra [14].20S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34Note that in case (cid:2)A, C(cid:3) is a finite GBCA, we have a corresponding adjacency space(cid:2)X, A(cid:3) where X is the set of atoms of A and two atoms a, b are related as A(a, b) if andonly if C(a, b). Suppose B is a subalgebra of A, then the set of atoms of B is a partitionof X. We call the adjacency space corresponding to (cid:2)B, C|B (cid:3) a sub-adjacency space of(cid:2)X, A(cid:3).The following example shows that the digital plane (with either 4-adjacency or 8-adjacency) can be regarded as a sub-structure of the vector space R2.Example 5.1 (Continuous (vector) space R2 and discrete (raster) space Z2). The continu-ous (vector) space of R2 are without question the most important model of the RCC theory.Recall we write this model simply by (cid:2)R2, C(cid:3) and regions in this model are non-empty reg-ular closed sets and two regions are connected if they have non-empty intersection.On the other hand, the most useful discrete (raster) space is the digital plane Z2, which isdefined as a rectangular array of points or pixels. Recall in Section 4 we have specified twoadjacency A4 and A8 in the digital plane and obtained two GBCAs (cid:2)Z2, C4(cid:3) and (cid:2)Z2, C8(cid:3)respectively. Note that the GBCA (cid:2)Bi , C|Bi(cid:3) (i = 4, 8) (given in Section 4) are two sub-GBCAs of the vector space (cid:2)R2, C(cid:3). Now since (cid:2)Bi , C|Bi(cid:3) is isomorphic to (cid:2)Z2, Ci(cid:3) fori = 4 or i = 8, we conclude that the digital plane with either 4-adjacency or 8-adjacencycan be regarded as a sub-structure of the vector space (cid:2)R2, C(cid:3).Our notion of sub-structures has intimately connection with the formal frameworkproposed by Worboys [52] for treating the notion of resolution and multi-resolution ingeographic spaces. We now recall some basic notions introduced in [52].Let S be a set of locations (which may be, but does not have to be, a connected regionof the Euclidean plane). A resolution R of S is a finite partition of S and an element x ∈ Ris called a resel. Such a resolution is any partition of the underlying set into a finite numberof subsets which may arise from a pixellation of the space and be a regular square grid, orbe formed from a triangulated irregular network (TIN). A resolution object (R-object) isdefined in a similar way to a rough set as the two-stage set (cid:2)L, U (cid:3), where L ⊆ U ⊆ R. LetR be the set of all resolutions of a set S. Define a partial order (cid:1) on R as follows: for R1and R2 belonging to R, R1 (cid:1) R2 if and only if ∀x ∈ R1, ∃y ∈ R2 such that x ⊆ y. Worboysthen shows that (cid:2)R (cid:1)(cid:3) is indeed a lattice and any sublattice of R (not necessarily with thesame top and bottom elements) will be termed a resolution space. Based on these notions,Worboys goes further to develop an approach to reasoning with imprecision about spatialentities and relationships resulting from finite resolution representations.It seems to us that, in conjunction with the Łukasiewicz algebraic approach to spatialindeterminacy proposed by Roy and Stell [38], Worboys’ approach can be fully reformu-lated in terms of our notion of sub-structures. A full working out of this theme will be thesubject of another paper, here we only make some basic comparison.Note that S is assumed to be finite throughout [52]. This restriction should be removedaway if we want S to be a connected region of the Euclidean plane. Indeed, such an as-sumption is not essential. Of course, the structure (cid:2)R (cid:1)(cid:3) then cannot have a bottom, butthis does not affect the definition of other notions, for instance resolution space. Moreover,if S is a finite set of locations, S can be interpreted as a GBCA which is a sub-structure ofS. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3421Table 1A comparison of notions in Worboys (1998) and notions in terms ofsub-GBCANotions in Worboys (1998)set of locations Sresolution RR1 (cid:1) R2glb of R1 and R2lub of R1 and R2R-object (cid:2)L, U (cid:3)Notions in terms of sub-GBCAGBCA S = (cid:2)S, C(cid:3)finite sub-GBCA B of SB2 (cid:2) B1subalgebra generated by B1 and B2subalgebra B1 ∩ B2vague region (L, U ) in B→some BCA arisen from a regular connected space. So, in what follows, we assume S is abounded connected region of the Euclidean plane.Now S, as a regular connected space, is naturally an RCC model. Write also S = (cid:2)S, C(cid:3)the corresponding BCA. Then a resolution R of S is just a finite set of jointly exhaustive(cid:3)nand pairwise disjoint (JEPD) regions in S. Namely, R = {s1, . . . , sn} satisfiesi=1 si =(cid:3)(cid:20) and si ∧ sj = ⊥ for any i (cid:6)= j , where, ∧, (cid:20), ⊥ are interpreted as in the BCA S.There is a natural adjacency relation A on R defined as A(si, sj ) if and only if si andsj are connected in the BCA S, namely, has nonempty intersection as two regular closedsubsets of S. Clearly (cid:2)R, A(cid:3) is an adjacency space in Galton’s sense. Moreover the GBCAinduced by this adjacency space is just a sub-GBCA of S. On the other hand, if B is a finitesubalgebra of the BCA S, then B = 2R for some resolution R of S.Furthermore, the collection of resolutions of S, R, now corresponds to the collection offinite sub-structures of the BCA S, and two resolutions R1, R2 are related as R1 (cid:1) R2 ifand only if their corresponding sub-GBCAs, B1 and B2, are related as B2 (cid:2) B1, read as“B2 is a sub-GBCA (or simply a subalgebra) of B1”. The greatest lower bound of R1 andR2 corresponds to the subalgebra of S generated by B1 and B2; and the least upper boundof R1 and R2 corresponds to B1 ∩ B2.12As for R-objects, note that any Boolean algebra B leads to a Łukasiewicz algebraB→[38]. Then an R-object is just a vague region in B→.Table 1 summarizes some basic correspondences between our theory of sub-GBCAsand the approach of Worboys.5.2. Local structures and sums of GBCAsIn practice often there are demands for investigating the local property and, as a result,the discussion should be restricted on a small (bounded) region. The following definitionof local structure is a proper reflection.Given an element a in a Boolean algebra (cid:2)A; ⊥, (cid:20),(cid:18) , ∨, ∧(cid:3) with a (cid:6)= ⊥. For any x, y (cid:1)a, let x∗ = a ∧ x(cid:18), and let x (cid:22) y = x ∨ y, x (cid:21) y = x ∧ y. Then (cid:2)↓ a; ⊥, a,∗ , (cid:22), (cid:21)(cid:3) is also aBoolean algebra.Given a GBCA (cid:2)A, C(cid:3), a region a in GBCA (cid:2)A, C(cid:3) is said to be connected if a cannotbe divided into two disconnected parts, i.e., ∀ b, c ∈ A − {⊥}, b ∨ c = a → C(b, c). For12 We here should loose the restriction that a GBCA contains more than two elements.22S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34any a (cid:6)= ⊥, we have a binary relation on ↓ a − {⊥} obtained by restricting C on ↓ a − {⊥}.Write this binary relation as C|↓a. If a is also a non-atomic connected region in (cid:2)A, C(cid:3),then it is straightforward to check that (cid:2)↓ a, C|↓a(cid:3) is also a GBCA.Definition 5.2 (Local structure). Given (cid:2)A, C(cid:3) a GBCA, let a ∈ A be a connected non-atomic region other than (cid:20). Then we call the GBCA (cid:2)↓ a, C|↓a(cid:3) the local structure orlocal GBCA of A at a.As is well known, the imprecision resulting from the resolution at which data are repre-sented is an important component of spatial data quality. Worboys [52] introduces a formalframework for treating the notion of resolution and multi-resolution in geographic spaces.However, the cases that the universal region and some of its local parts (which may forma partition of the universe) are represented at different resolutions are rarely investigated.The situation is in a sense an inverse process of granulation for graphs [43].Suppose (cid:2)X, A(cid:3) is an adjacency space and {(cid:2)Ax , Cx(cid:3)}x∈X is a collection of GBCAs.We now show how to aggregate these local information. Set A =X Ai to be the productalgebra of all Ax . Then A is a Boolean algebra and each element a ∈ A has form (ax)x∈X,in particular, ⊥ = (⊥x )x∈X and (cid:20) = ((cid:20)x )x∈X, where ⊥x and (cid:20)x are the bottom and topof the Boolean algebra Ax respectively. There are naturally two ways to associate A witha connection C.(cid:4)For two regions a, b ∈ A, define C1(a, b) if and only if (i) a ∧ b (cid:6)= ⊥ or (ii) there existtwo different x, y ∈ X with A(x, y), ax (cid:6)= ⊥x and by (cid:6)= ⊥y ; define C2(a, b) if and onlyif (i) C1(a, b) or (ii) there exists some x ∈ X such that Cx (ax, bx). A routine check willshow (cid:2)A, C1(cid:3) and (cid:2)A, C2(cid:3) are two GBCAs, we call these, respectively, the weak sum andthe strong sum of {(cid:2)Ax, Cx(cid:3)}x∈X via the adjacency space (cid:2)X, A(cid:3).For each x ∈ X, write x∗ the region in A with (x∗)x = (cid:20)x and (x∗)y = ⊥y for anyy (cid:6)= x. Clearly X∗ = {x∗: x ∈ X} forms a JEPD set of regions in A. This X∗ is, roughlyspeaking, a resolution of A (see Section 5.1). Note that for any two x∗, y∗ ∈ X∗, we haveC1(x∗, y∗) if and only if C2(x∗, y∗). Therefore X∗ inherits an adjacency A∗, from either(cid:2)A, C1(cid:3) or (cid:2)A, C2(cid:3), which is defined as follows: A∗(x∗, y∗) if and only if C1(x∗, y∗).Such an adjacency space (cid:2)X∗, A∗(cid:3) is isomorphic to the one (cid:2)X, A(cid:3) and corresponds to asub-GBCA of both (cid:2)A, C1(cid:3) and (cid:2)A, C2(cid:3). Moreover, in the strong sum (cid:2)A, C2(cid:3), since eachx∗ is clearly a non-atomic connected region other than the top, the local GBCA of (cid:2)A, C2(cid:3)at x∗ is isomorphic to the GBCA (cid:2)Ax, Cx (cid:3).Combining the notion of sum of GBCAs with the notion of resolution will be helpful forconstructing new adjacency spaces from old ones. Suppose (cid:2)X, A(cid:3) is an adjacency spaceand Y = {Y1, . . . , Yn} is a resolution of X and each Yi is a connected region. Then wehave a sub-adjacency space (cid:2)Y, A(cid:3) and a local adjacency space (cid:2)Yi , Ai (cid:3) for each Yi . Nowwe have two new adjacency relations A1 and A2 on X defined as follows: A1(x, y) if andonly if there exist two different resels Yi and Yj in Y such that x ∈ Yi and y ∈ Yj andA(Yi , Yj ); and A2(x, y) if and only if either A1(x, y) or x and y are adjacent in a localadjacency space (cid:2)Yi , Ai (cid:3). We call (cid:2)X, A1(cid:3) and (cid:2)X, A2(cid:3) respectively the weak and strongsum of {(cid:2)Yi , Ai(cid:3): i = 1, . . . , n} via (cid:2)Y, A(cid:3). These two notions are corresponding ones oftheir GBCA counterparts. Both these two spaces have in common with the original space insome but not every respects. These two spaces can be taken as abstractions of the originalS. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3423space. Although we may lost some information, but, from the weak sum we can regain thesub-adjacency space and, from the strong one we can also regain each local space.In above we have shown how to construct new GBCA form old ones by introducingseveral operations. The so constructed GBCA is usually not a Boolean connection algebra.The next subsection, however, introduces an approach to construct a BCA from a sequenceof GBCAs.5.3. Direct limits of GBCAsThe following simple proposition will be useful in the construction of direct limits.Proposition 5.1. Let A be a Boolean algebra. Suppose {Ak: k ∈ N} is a collection ofsubalgebras of A and Ak ⊆ Ak(cid:18) for each pair (k, k(cid:18)) ∈ N2 with k (cid:1) k(cid:18). Thenn∈N Ak isalso a subalgebra of A.(cid:5)Let A be a Boolean algebra. Suppose {(cid:2)Ak, Ck(cid:3)}k∈N is a collection of GBCAs whichsatisfies the following conditions:(1) Ak is a subalgebra of A for k ∈ N;(2) (cid:2)Ak, Ck(cid:3) is a sub-GBCA of (cid:2)Ak(cid:18), Ck(cid:18) (cid:3) for k (cid:1) k(cid:18) ∈ N.k∈N Ak. By Proposition 5.1, it is also a subalgebra of A. Define a binary(cid:5)Write Aω =relation Cω on Aω − {⊥} as follows:∀x, y ∈ Aω, Cω(x, y)(cid:5)In another word, Cω =(cid:2)Aω, Cω(cid:3) the direct limit of {(cid:2)Ak, Ck(cid:3)}k∈N.Cω|Bk , for each k ∈ N.iff ∃k ∈ N s.t. x, y ∈ Ak and Ck(x, y).k∈N Ck. It is routine to check that (cid:2)Aω, Cω(cid:3) is a GBCA. We callThe following proposition shows (cid:2)Ak, Ck(cid:3) is a sub-GBCA of (cid:2)Aω, Cω(cid:3), namely Ck =Proposition 5.2. Suppose (cid:2)Aω, Cω(cid:3) is the direct limit of {(cid:2)Ak, Ck(cid:3)}k∈N. Then, for any twoa, b ∈ Bn, we have Cω(x, y) if and only if Cn(x, y).Proof. We need only to show the ‘necessity’ part. Suppose a, b ∈ Bn and Cω(x, y). Thenby the definition of Cω, we have some m such that a, b ∈ Bm and Cm(x, y). If m < n, thenCn(x, y) holds for Cm = Cn|Bm ; if m (cid:2) n, then Cn(x, y) holds for Cn = Cm|Bn . (cid:1)In another word, this proposition suggests, for any two a, b ∈ Bn, ¬Cω(x, y) if and onlyif ¬Cn(x, y).The following theorem characterizes when does a direct limit be a Boolean connectionalgebra.Theorem 5.1. Let A be a Boolean algebra. Suppose (cid:2)Aω, Cω(cid:3) is the direct limit of{(cid:2)Ak, Ck(cid:3)}k∈N, where {(cid:2)Ak, Ck(cid:3)}k∈N satisfies conditions (1) and (2) given above. Then(cid:2)Aω, Cω(cid:3) is a Boolean connection algebra if and only if for each k ∈ N and eachx ∈ Ak − {⊥, (cid:20)}, there exists some k(cid:18) (cid:2) k and some y ∈ Ak(cid:18) − {⊥, (cid:20)} such that ¬Ck(cid:18)(x, y).24S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34Proof. This is clear since the GBCA (cid:2)Aω, Cω(cid:3) is a BCA if and only if it satisfies Axiom(C6), namely, for each x ∈ Aω − {⊥, (cid:20)}, there exists some y ∈ Aω − {⊥, (cid:20)} such that x isdisconnected from y. (cid:1)Given in advance a Boolean connection algebra (cid:2)A, C(cid:3), this construction can be appliedto obtain a countable sub-BCA of (cid:2)A, C(cid:3). First we take a finite sub-GBCA of (cid:2)A, C(cid:3),noted as (cid:2)A1, C1(cid:3). Then, since (cid:2)A, C(cid:3) is a BCA, for each region a in A1 − {⊥, (cid:20)}, wecan choose some region a ∈ A − {⊥, (cid:20)} such that ¬C(a, a). Set A2 as the sub-Booleanalgebra generated by A1 ∪ {a: a ∈ A1 − {⊥, (cid:20)}}. Then A2 is also finite since A1 is so.Write (cid:2)A2, C2(cid:3) the corresponding sub-GBCA of (cid:2)A, C(cid:3). Continuing this procedure, weshall obtain a collection of finite sub-GBCAs {(cid:2)Ak, Ck(cid:3)}k∈N of (cid:2)A, C(cid:3) which satisfies, inaddition to Conditions (1) and (2) given in the definition of direct limit, the followingcondition:(3) For each k ∈ N and each x ∈ Ak − {⊥, (cid:20)}, there exists some y ∈ Ak+1 − {⊥, (cid:20)} suchthat ¬Ck+1(x, y).Then by Theorem 5.1, the direct limit of {(cid:2)Ak, Ck(cid:3)}k∈N of (cid:2)A, C(cid:3), noted as (cid:2)Aω, Cω(cid:3), is asub-BCA of (cid:2)A, C(cid:3). Clearly Aω is countable.Remark 5.1. Note that the Boolean algebra of regular closed sets of any topological spaceis complete. Each standard model of the RCC theory induced by a regular connected space(for instance the Euclidean plane R2) is an atomless complete BCA. These standard BCAscannot be countable since there exists (up to isomorphism) only one countable atomlessBoolean algebra [6, p. 39, Proposition 1.4.5], which is, however, non-complete. Conse-quently, regions in these standard BCAs cannot be finitely represented as aggregations ofbasic regions in a predefined countable collection (in the case of R2, these basic regionscould be taken from for instance squares, triangles, disks or other semi-algebraic regions).However, in the countable BCAs constructed as above, every region is an aggregationsof atomic regions in a certain finite sub-GBCA. Thus as far as spatial representation isconcerned, these non-standard models are computationally tractable.In next subsection, we shall construct a minimal Boolean connection algebra using theapproach described above.5.4. A minimal BCALet Σ = {0, 1} and let Σ ∗ be the set of finite strings over Σ. We denote by |s| the lengthof a string s ∈ σ ∗. For s, t ∈ Σ ∗, we write s ≺ t if s is an initial segment of t, namely sstarts t.Recall ε is the empty string in Σ ∗. Now for each string s ∈ Σ ∗, we associate a left-closed-and-right-open sub-interval of [0, 1) as follows: Takexε = [0, 1);x0 = [0, 1/2),x1 = [1/2, 1);S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3425Fig. 3. The infinite complete binary tree Tω.x00 = [0, 1/4),x10 = [1/2, 3/4),x01 = [1/4, 1/2),x11 = [3/4, 1);and so on.In general, suppose xs has been defined for a string s ∈ {0, 1}∗, we define xs0 to be the firsthalf left-closed-and-right-open sub-interval of xs , and xs1 the second half.Write Xn = {xs: s ∈ Σ ∗ with |s| = n} for each n (cid:2) 1 and write Xω = {xs: s ∈ Σ ∗}.Denote by Bn the subalgebra of the powerset algebra 2[0,1) generated by Xn and, by Bω,the subalgebra generated by Xω. Clearly Bn contains 2n atoms and Bω is a countableatomless Boolean algebra. Moreover, we have Bn is a subalgebra of Bm for n < m and Bnn−1is a subalgebra of Bω for each n. It is also clear that Bω =i=1 xsi : si ∈Σ ∗, n ∈ N}.n∈N Bn = {(cid:5)nk=1 Xk. Then,for each n ∈ N, Yn (with the ordering of set inclusion) can be visualized as a complete bi-nary tree Tn of height n. Similarly, Xω, with the ordering of set inclusion, can be visualizedas an infinite complete binary tree Tω (see Fig. 3).Denote Yn = {xs: s ∈ Σ ∗ with |s| (cid:1) n} for each n (cid:2) 1, namely Yn =(cid:5)(cid:5)We now define inductively a binary relation Aω on Xω:(i) Aω(xs, xs) for each s ∈ Σ ∗;(ii) Aω(xs0, xs1) and Aω(xs1, xs0) for each s ∈ Σ ∗;(iii) Aω(xs1, xt 1) if Aω(xs, xt ).Fig. 4. An illustration of adjacency relations A1, A2 and A3.26S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34Clearly, Aω is a reflexive and symmetric binary relation on Xω. Recall Xn is the setof atoms of Bn. Denote An = Aω|Xn , then (cid:2)Xn, An(cid:3) is an adjacency space (see Fig. 4 forillustration). Denote by Cn the connection relation induced by An. Then (cid:2)Bn, Cn(cid:3) is afinite GBCA. Consider the direct limit of the collection of finite GBCAs {(cid:2)Bn, Cn(cid:3)}n∈N.Write this countable GBCA by (cid:2)Bω, Cω(cid:3). Recall where Cω =k∈N Ck. Then for any two(cid:5)mnelements S =i=1 xti in Bω − {⊥}, Cω(S, T ) if and only if there existi=1 xsi and T =s, t ∈ Σ ∗ with Aω(xs, xt ) and xs ⊆ S, xt ⊆ T .(cid:5)(cid:5)In what follows we give a characterization of the binary relation Aω:Proposition 5.3. For s (cid:6)= t ∈ Σ ∗, Aω(xs, xt ) if and only if |s| = |t| and there exist somestring s1 ∈ Σ ∗ and some n (cid:2) 0 with {s, t} = {s10 1 · · · 1(cid:6) (cid:7)(cid:8) (cid:9)n}., s11 1 · · · 1(cid:6) (cid:7)(cid:8) (cid:9)nProof. Suppose |s| = |t| and s = s10 1 · · · 1(cid:6) (cid:7)(cid:8) (cid:9)n, t = s11 1 · · · 1(cid:6) (cid:7)(cid:8) (cid:9)n. Then by item (i) in the defini-tion of Aω, we have Aω(s1, s1); by (ii), we have Aω(s10, s11); by (iii), we have Aω(s, t).On the other hand, suppose Aω(s, t). By using induction on n, the larger one of |s| and|t|, we can easily show |s| = |t|.Now using induction on n = |s| = |t|. Suppose the statement holds for any k (cid:1) n. Sup-pose s (cid:6)= t and |s| = |t| = n + 1. Write s1 the longest string which is a common initialsegment of s and t. If the last symbol of either s or t is not 1, then by the definition of Aωwe should have {s, t} = {s10, s11}; and otherwise suppose s2 is the longest string with form1 · · · 1 which is a common final segment of s and t, then |s2| (cid:2) 1 and s, t have form s1s(cid:18)s2,s1t (cid:18)s2 respectively. By Item (iii), we should have Aω(s1s(cid:18), s1t (cid:18)). Note that |s2| (cid:2) 1. By theinduction assumption, we shall have {s1s(cid:18), s1t (cid:18)} = {s10, s11}. This ends the proof. (cid:1)By above proposition we have the following corollary:Corollary 5.1. (i) Suppose Aω(xs, xt ). If s1 and t1 are initial segments of s, t respectivelyand |s1| = |t1|, then Aω(xs1, xt1);(ii) Suppose Aω(xs, xt ). If s1 and t1 are final segments of s, t respectively and |s1| = |t1|,then Aω(xs1, xt1);(iii) Suppose Aω(xs, xt ). Then Aω(xs(cid:18)s, xs(cid:18)t ) for any s(cid:18) ∈ Σ ∗;(iv) Suppose Aω(xs0, xt ). Then t = s0 or t = s1;(v) For any string s with |s| > 1, there exists s(cid:18) with same length such that Aω(s, s(cid:18)) doesnot hold.Proof. The first four items follow directly from Proposition 5.3. As for (v), suppose s =a1 · · · a|s|, let s(cid:18) = (1 − a1) · · · (1 − a|s|). Since |s| > 1, we clearly have ¬Aω(s, s(cid:18)) byProposition 5.3. (cid:1)Next we show (cid:2)Bω, Cω(cid:3) is indeed a Boolean connection algebra.Proposition 5.4. (cid:2)Bω, Cω(cid:3) is a Boolean connection algebra.S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3427Proof. We first show that the collection of finite GBCAs {(cid:2)Bn, Cn(cid:3)}n∈N satisfies the fol-lowing condition: For each k ∈ N and each S ∈ Bk − {⊥, (cid:20)}, there exists some string swith length k such that ¬Ck+1(S, xs0).Note that S (cid:6)= xε and S ∈ Bk. There exists some string s with length k such that xs (cid:6)⊆ S.We claim that xs ∩ S = ∅. This is because that xs is an atom in Bk . By Item (iv) of Corollary5.1 and the definition of Ck+1, xs0 cannot be connected with xt for any string t (cid:6)= s withlength k. Then ¬Ck+1(S, xs0) by Axiom (C4) of GRCC.Next, by Theorem 5.1, (cid:2)Bω, Cω(cid:3), as the direct limit of {(cid:2)Bn, Cn(cid:3)}n∈N, is a countableBCA. (cid:1)In what follows we write NTPPω the non-tangential proper part relation in (cid:2)Bω, Cω(cid:3).Proposition 5.5. (i) For any two strings s, t with same length, Aω(xs, xt ) if and only ifCω(xs, xt );(ii) For each string s, xs is self-connected, namely, for all non-empty S, T ∈ Bω, if S ∪T =xs, then Cω(S, T );(iii) For any two strings s, t with t (cid:6)= ε, NTPPω(xs, xt ) if and only if t ≺ s and s (cid:6)= t 1 · · · 1(cid:6) (cid:7)(cid:8) (cid:9)n−1for any n (cid:2) 1. In particular, we have NTPPω(xs0, xs);(iv) For any nonempty S ∈ Bω and any string s (cid:6)= ε, NTPPω(S, xs) if and only if S ⊆xs − xs 1···1(cid:6)(cid:7)(cid:8)(cid:9)for some n (cid:2) 1;(v) For any string s, NTPPω(xs0, xs0 ∪ xs 1···1(cid:6)(cid:7)(cid:8)(cid:9)n) for any n (cid:2) 1.nProof. (i) Suppose |s| = |t| = k. If Aω(xs, xt ), then Cω(xs, xt ) by the definition of Cω. Onthe other hand, if Cω(xs, xt ), then there exists some k(cid:18) with Ck(cid:18)(xs, xt ). Clearly k(cid:18) (cid:2) k sincexs is an atom of Bk . Note that Ck = Ck(cid:18) |Bk since (cid:2)Bk, Ck(cid:3) is a sub-GBCA of (cid:2)Bk(cid:18) , Ck(cid:18) (cid:3).We also have Ck(xs, xt ), hence Ak(xs, xt ) and Aω(xs, xt ).(ii) Suppose S, T are nonempty and S ∩ T = ∅, S ∪ T = xs . Note that for any n (cid:2) 1,S ∈ Bn if and only if T ∈ Bn. We can take k > |s| with S, T ∈ Bk − Bk−1. Recall Xkis the set of atoms of Bk. Since S, T /∈ Bk−1, there must exist some string t with lengthk − |s| − 1 such that neither xst 0, xst 1 ⊆ S nor xst 0, xst 1 ⊆ T can hold. Therefore eitherxst 0 ⊆ S, xst 1 ⊆ T or xst 0 ⊆ T , xst 1 ⊆ S holds. By Aω(xst 0, xst 1), we have Cω(S, T ).(iii) We first show NTPPω(xs0, xs). Suppose |s| > 0. Note that ¬Aω(xs0, xt a) for anyt other than s with |t| = |s| and any symbol a ∈ {0, 1}. By item (i) of this proposition, wehave ¬Cω(xs0, xt a), hence ¬Cω(xs0, xε − xs). Therefore there cannot exist a region whichis externally connected to both xs0 and xs , namely NTPPω(xs0, xs) holds.for any n (cid:2) 1. Then xs ⊆ xt 1···1(cid:6)(cid:7)(cid:8)(cid:9)0 for some n (cid:2) 1. BySuppose t ≺ s and s (cid:6)= t 1 · · · 1(cid:6) (cid:7)(cid:8) (cid:9)n−1n−1above observation, we have NTPPω(xs, xt ). On the other hand, if NTPPω(xs, xt ), thenclearly t ≺ s and t (cid:6)= s. Suppose s = t 1 · · · 1for some n (cid:2) 1. Note that t (cid:6)= ε. t has form(cid:6) (cid:7)(cid:8) (cid:9)nt1a for some t1 ∈ Σ ∗ and some a ∈ Σ. Set s(cid:18) = t1(1 − a) 1 · · ·1(cid:6) (cid:7)(cid:8) (cid:9)n. Then Aω(xs, xs(cid:18)), hence28S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34Cω(xs, xs(cid:18)). Note that xs(cid:18) ∩ xt = ∅. We have xs(cid:18) is externally connected to both xs and xt .This contradicts with the assumption that NTPPω(xs, xt ).(iv) For s (cid:6)= ε and some n (cid:2) 1, we show NTPPω(xs − xs 1···1(cid:6)(cid:7)(cid:8)(cid:9), xs). Write k = |s| + n.Then for each atom xtin Bk which is contained in xs − xs 1···1(cid:6)(cid:7)(cid:8)(cid:9)n, by (iii), we haveNTPP(xt , xs). Consequently, we also have NTPPω(xs − xs 1···1(cid:6)(cid:7)(cid:8)(cid:9)n, xs).On the other hand, suppose S (cid:6)⊆ xs − xs 1···1(cid:6)(cid:7)(cid:8)(cid:9)for any n (cid:2) 1. Then there exists somenk (cid:2) 1 such that xs 1···1(cid:6)(cid:7)(cid:8)(cid:9)⊆ S. By (iii) again, this shows NTPPω(S, xs) cannot hold.n(v) This follows from the fact that, for any nonempty S ∈ Bω, S is externally connectedkto xs0 if and only if S contains xs 1···1(cid:6)(cid:7)(cid:8)(cid:9)nfor some n (cid:2) 1. (cid:1)By above proposition, NTPPω(xs0, xs) holds and there cannot exist another regionS ∈ Bω such that both NTPPω(xs0, S) and NTPPω(S, xs ) hold. This observation showsthat NTPPω ◦ NTPPω (cid:6)= NTPPω. Hence gives a negative answer to a question raised byDüntsch et al. ([15, p.405]). In general, if we write inductively NTPPn+1= NTPPω ◦NTPPnω, . . . , NTPPnω, . . . , is a strict decreasing chain [29, Theo-rem 4.1].ω, then NTPPω, NTPP2ωWe now show that (cid:2)Bω, Cω(cid:3) is a ‘minimal’ BCA in the sense that each BCA containsBω as a sub-BCA.Theorem 5.2. For each BCA (cid:2)A, C(cid:3), A contains a sub-BCA isomorphic to (cid:2)Bω, Cω(cid:3).Proof. Take x ∈ A − {⊥, (cid:20)}, and write x0 = x, x1 = x(cid:18). For a ∈ {0, 1}, since A is a BCA,there exists xa0 ∈ A − {⊥, (cid:20)} with NTPP(xa0, xa). Write xa1 = xa ∧ (xa0)(cid:18) for a ∈ {0, 1}.Denote by A2 the subalgebra of A generated by {xab: a, b ∈ {0, 1}}, clearly (cid:2)A2, C|A2(cid:3) isisomorphic to (cid:2)B2, C2(cid:3) given above. Continuing this procedure infinitely, for each n (cid:2) 2,we shall get a GBCA, noted by (cid:2)An, C|An(cid:3), which is isomorphic to (cid:2)Bn, Cn(cid:3). By Proposi-tion 5.1, we have Aω =n(cid:1)2 An is also a subalgebra of A, which is isomorphic to Bω. Itis now routine to check that (cid:2)Aω, C|Aω(cid:3) is isomorphic to (cid:2)Bω, Cω(cid:3). (cid:1)(cid:5)6. Regular spatial partitioning and GBCAsIn Section 5.1, we have shown that discrete space (cid:2)Z2, C8(cid:3) is a sub-structure of thecontinuous space (cid:2)R2, C(cid:3). Combining this fact with regular spatial partitioning (of thecontinuous space R2), we now construct a countable RCC model (hence is also a ‘contin-uous’ model) which is a sub-structure of (cid:2)R2, C(cid:3). Combining with Winter’s approach fordetermining RCC5 relations [50], we also propose a hierarchical approach for determiningRCC8 relations between two regions in such a model.Suppose that we have a uniform regular partition of the real plane R2 of level n as Zn ≡2n , i+1{[ i2n ]: i, j ∈ Z} for each n ∈ N. Clearly, Zn is a collection of regular closed2n ]×[ j2n , j +1S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3429(cid:2)R, C(cid:3) is also a sub-structure of (cid:2)R2, C(cid:3). Note that each basic element [ i2n+2 , 4i+3of (cid:2)R, C(cid:3) has an NTPP part [ 4i+12n+2sets in R2. Write Rn = (cid:2)Rn, CRn(cid:3) for the substructure of the BCA (cid:2)R2, C(cid:3) generatedby Zn. It is routine to check that the connection relation C|Rn , the restriction of C onsubalgebra Rn, is the same as that induced by the 8-adjacency A8 on Zn. Write R ≡(cid:5)n∈N Rn and write C for the restriction of C on R. Then by Proposition 5.1, we know2n , j +12n , i+12n ]]. R = (cid:2)R, C(cid:3) is a countable BCA.Note that each Zn is infinite and as a result the construction of R is not computing fea-sible. There are two ways to amend this weakness. The first solution is more direct: Choose2n , i+1Z(cid:18)2n ] × [ j= {[ i2n ]: −n (cid:1) i, j (cid:1) n − 1} ∪ {R2 − [−n, n]2}, then the subalgebra(cid:5)(cid:5)nn∈N Z(cid:18)n∈N Zn, namely, the subalgebragenerated byR.2n , j +1n is the same as that generated by2n+2 , 4j +32n+22n ] ×[ j] × [ 4j +1However, practical applications are always restricted to a finite area. We can also restrictthe universe region to a square S, e.g., [0, 1]2. A similar construction can be done for S.In this case the square S is recursively decomposed into four equal-sized quadrants and ateach construction step only finite basis elements are concerned.We adopt the second modification and assume S = [0, 1]2.Let Σ = {1, 2, 3, 4} and let Σ ∗ be the set of finite strings over Σ. We denote by |s| thelength of a string s ∈ Σ ∗. For each s ∈ Σ ∗, we recursively associate to s a sub-square of[0, 1]2 as follows:xε = [0, 1]2;x1 = [0, 1/2] × [1/2, 1],x4 = [1/2, 1] × [0, 1/2].x2 = [1/2, 1]2,x3 = [0, 1/2]2,(cid:5)(cid:5)In general, if xs has been defined for some string s, we define xs1, xs2, xs3 and xs4 in orderas the top left, top right, bottom left and bottom right sub-square of xs respectively.Write Xn = {xs: s ∈ Σ ∗ with |s| = n} for each n (cid:2) 1 and write Xω = {xs: s ∈ Σ ∗}.Denote by Sn the subalgebra of Ω([0, 1]2), the complete Boolean algebra of regular closedsubsets of [0, 1]2, generated by Xn and, by Sω, the subalgebra generated by Xω. ClearlySn contains 4n atoms and Sω is a countable atomless Boolean algebra. Moreover, we haveSn is a subalgebra of Sm for n < m and Sn is a subalgebra of Sω for each n. It is also clearthat Sω =n−1i=1 xsi : si ∈ Σ ∗, n ∈ N}.Denote Yn = {xs: s ∈ Σ ∗ with |s| (cid:1) n} for each n (cid:2) 1, namely Yn =(cid:5)nk=1 Xk. Then,for each n ∈ N, Yn (with the ordering of set inclusion) can be visualized as a completequadtree Tn of height n. Similarly, Xω, with the ordering of set inclusion, can be visualizedas an infinite complete quadtree Tω. In what follows we refer in a natural way to a node inTω by xs .n∈N Sn = {Recall (cid:2)[0, 1]2, C(cid:3) is the standard BCA associated to the regular connected space [0, 1]2.Consider the substructures of (cid:2)[0, 1]2, C(cid:3) on Sn and Sω. We write also these sub-GBCAsSn and Sω respectively. Then Sω is the direct limit of {Sn}n∈N. Moreover, Sω is indeeda countable BCA for that each basic region has an NTPP part. A region X in Sω can berepresented as a (binary) region quadtree in Morton order (with digits out of {1, . . . , 4})[40]. See Fig. 5 for an illustration, where a node xs is a leaf in X (illustrated as a blackone) if and only if xs ⊆ X and no ancestor of xs is contained in X. Consequently, Sω isjust the Boolean algebra of all region quadtrees.30S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34Fig. 5. A region in Sω (left) and its quadtree representation (right).Note also that each sub-GBCA Sn is equivalent to an adjacency space on Xn, the setof atoms of Sn, where two nodes xs and xt of length |s| = |t| = n are adjacent if andonly if they are connected, namely xs ∩ xt (cid:6)= ∅. Clearly this adjacency relation is the sameas A8. For a node xs , write Ns = {xt : s (cid:6)= t and A8(xs, xt )} for the set of 8-neighborsof xs . Then Ns contains at most 8 nodes, these neighbors are referred in order as, NW-neighbor, N-neighbor, NE-neighbor, W-neighbor, E-neighbor, SW-neighbor, S-neighbor,SE-neighbor. There are algorithms for determining these neighbors. For example, supposes = a1a2 · · · an ∈ Σ ∗. Then xt , the N-neighbor of xs , is determined as follows: if ai (cid:1) 2for all i, then xt does not exist; if otherwise, suppose 1 (cid:1) k (cid:1) n is the largest number suchthat ak > 2, write bi = ai if i < k, bk = ak − 2 and bi = ai + 2 if i > k. Then xt is theN-neighbor of xs , where t = b1b2 · · · bn.We now sketch a hierarchical approach to determine RCC8 relations between regionsin Sω. Our approach is based on the hierarchical approach for determining RCC5 relationsproposed by Winter [50].Using the Egenhofer’s 4-intersection model [18,19], Winter [50] proposed a hierarchicalspatial reasoning method to determine the RCC5 topological relations between two regionquadtrees. The hierarchical approach starts at the root level with total uncertainty about atopological relation and refines the results incrementally level by level. The process stopsimmediately when the refined information is sufficient to answer a given query. Combiningwith the Winter’s approach, we now can determine hierarchically the RCC8 topologicalrelations.We begin with the connection C. In what follows, we say a node xs belonging to aregion X if xs or one of its ancestors xt is a leaf in X.Suppose X and Y are two regions in Sω. We pose the query: “Does X connect withY ?”. We suppose the depth of X, d, is not smaller than that of Y . Recall in Proposition5.2, we have shown X and Y are connected in Sω if and only if they are connected inSd . Consequently, to determine the connectedness of X and Y , considering the adjacencyrelations between two nodes with lengths lesser than d is enough.We examine the two quadtrees level by level. Within each level the tree nodes are re-ferred to in Morton order (with digits out of {1, . . . , 4}), e.g., the rightmost node in level 3of Fig. 5 is noted as x324. For a node xs of level n (cid:1) d, if xs is a node belonging to X andNs ∪ {xs} contains a node belonging to Y , then X is connected with Y . The process stops.Do this for all nodes of level n alphabetically, if the results are all “NO”, turn to level n + 1.The process will stop at some level m (cid:1) d.S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3431Next, combining with Winter’s approach, we can determine the RCC8 relation betweenX and Y as follows. For two region quadtrees X, Y , we first apply Winter’s approach todetermine the RCC5 relation between X, Y , and refine the relation to an RCC8 relation.If PO(X, Y ) or EQ(X, Y ), then this is already an RCC8 relation. If DR(X, Y ), then wepose the query: “Does X connect with Y ?”. Answer “YES” will give EC(X, Y ) and “NO”,DC(X, Y ). If PP(X, Y ), we ask “Does X connect with the complement quadtree of Y ?”.Answer “Yes” will indicate TPP(X, Y ) and “NO”, NTPP(X, Y ) (see Theorem 3.3). Thecase of PP(Y, X) is similar.7. Conclusions and further workThis paper is mainly concerned with a unified treatment of two formal systems of spatialreasoning: the theory of RCC premised on continuous-space models introduced in [32] andthat of Galton premised on discrete-space models [24]. The latter is developed to bridge thegap between high-level qualitative approaches to spatial information and low-level quanti-tative ones. The theory developed in this paper, GRCC, admits continuous models as wellas discrete ones. The relation between continuous models and discrete ones is also clari-fied by introducing some operations on models of GRCC. In particular, we have proposeda general approach for constructing countable RCC models as direct limits of collectionsof finite models. More importantly, we construct two interesting RCC models: one is aminimal RCC model, the other is a countable sub-model of the continuous space R2. Com-pared with standard RCC models given rise from regular connected spaces, these countablemodels have the nice property that each region can be constructed in finite steps from basicregions.To conclude this paper, we would like to mention some interesting problems for thefurther studies:• This paper only describes relation between different models. But relation between rea-soning and representation in different models is still not clear. One may wonder that“Can we use reasoning and representation in a (usually more simple) model to approx-imately solve a corresponding problem in another (usually more complex) model?”.For example, can we approximately deduce a certain property in R2 by reasoning inthe countable sub-model R?• The complexity of reasoning with the RCC theory have been investigated by Renzand Nebel in a series of paper [33,35,36] (see also [34]). In particular, a maximumtractable fragment of the RCC8 theory was identified in [35]. Renz [33] also showedthat any path-consistent atomic network has a canonical model in any n dimensionalEuclidean space. The problem here is “Are these results hold in the countable RCCmodel R?”. Note that, in this model, each region can be constructed in finite stepsfrom basic regions, here are squares.1313 In [29], we have shown any path-consistent atomic network has a realization in any RCC model. This sug-gests the complexity results of Renz and Nebel also hold for countable RCC models.32S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34• The topic of regions with indeterminate boundaries has now become popular in thecontext of GIS as well as in AI (see [5,9,12,38], also see SVUG 2001, the first COSITworkshop on Spatial Vagueness, Uncertainty and Granularity). Roy and Stell [38] de-velop an algebraic framework to spatial indeterminacy using Łukasiewicz algebraswhich provides a generalization of the “egg-yolk” approach of Cohn and Gotts [12].Based on this framework, they extend RCC relations from crisp regions to indeter-minate ones, semantically and syntactically. Similar to RCC, [38] assumes that theindeterminate regions relate to continuous space. Clearly, techniques analogous tothose proposed in this paper can be applied to these Łukasiewicz models. In conjunc-tion with this algebraic approach, it seems that the formal framework of resolution andmulti-resolution developed by Worboys can be fully reformulated in terms of substruc-tures. This will be worked out in another paper.AcknowledgementsWe gratefully thank the two anonymous referees who suggested several improvementsand additional references and pointed out several errors appeared in the previous versionof this paper.References[1] N. Asher, L. Vieu, Toward a geometry of common sense: a semantics and a complete axiomatization ofmereotopology, in: C. Mellish (Ed.), Proceedings of the 14th International Joint Conference on ArtificialIntelligence, IJCAI-95, Montreal, Quebec, 1995, pp. 846–852.[2] R. Balbes, P. Dwinger, Distributive Lattices, University of Missouri Press, 1974.[3] B. Bennett, Logical representations for automated reasoning about spatial relationships, PhD Thesis, Uni-versity of Leeds, UK, 1998.[4] T. Bittner, J.G. Stell, A boundary-sensitive approach to qualitative location, Ann. Math. Artificial Intelli-gence 24 (1998) 93–114.[5] P.A. Burrough, A.U. Frank (Eds.), Geographic Objects with Indeterminate Boundaries, GISDATA Series,vol. 2, Taylor and Francis, 1996.[6] C.C. Chang, H.J. Keisler, Model Theory, North-Holland, Amsterdam, 1973.[7] B.L. Clarke, A calculus of individuals based on ‘connection’, Notre Dame J. Formal Logic 22 (1981) 204–218.[8] B.L. Clarke, Individuals and points, Notre Dame J. Formal Logic 26 (1985) 61–75.[9] E. Clementini, P. Di Felice, An algebraic model for spatial objects with indeterminate boundaries, in [5],pp. 155–169.[10] E. Clementini, J. Sharma, F. Egenhofer, Modelling topological spatial regions: strategies for query process-ing, Computers Graphics 18 (1994) 815–822.[11] A.G. Cohn, Qualitative spatial representation and reasoning techniques, Research Report, University ofLeeds, School of Computer Studies, 1997.[12] A.G. Cohn, N.M. Gotts, The ‘egg-yolk’ representation of regions with indeterminate boundaries, in [5],pp. 171–187.[13] Z. Cui, A.G. Cohn, D.A. Randell, Qualitative and topological relationships in spatial databases, in: D. Abel,B.C. Ooi (Eds.), Advances in Spatial Databases, in: Lecture Notes in Computer Science, vol. 692, Springer,Berlin, 1993, pp. 293–315.[14] I. Düntsch, A tutorial on relation algebras and their application in spatial reasoning, Given at COSIT, August1999. Available from: http://www.cosc.brocku.ca/~duentsch/papers/relspat.html.S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–3433[15] I. Düntsch, G. Schmidt, M. Winter, A necessary relation algebra for mereotopology, Studia Logica 69 (2001)381–409.[16] I. Düntsch, M. Winter, A representation theorem for Boolean contact algebras, Preprint, 2003. Availablefrom: http://www.cosc.brocku.ca/Department/Research/TR/cs0308.pdf.[17] I. Düntsch, H. Wang, S. McCloskey, A relation-algebraic approach to the region connection calculus, Theo-ret. Comput. Sci. 255 (2001) 63–83.[18] M.J. Egenhofer, Spatial query languages, PhD Thesis, University of Maine, 1989.[19] M.J. Egenhofer, Reasoning about binary topological relations, in: O. Günther, H.-J. Schek (Eds.), Advancesin Spatial Databases, in: Lecture Notes in Computer Science, vol. 525, Springer, New York, 1991, pp. 143–160.[20] M.J. Egenhofer, R. Franzosa, Point-set topological spatial relations, Internat. J. Geograph. Inform. Syst. 5(1991) 161–174.[21] M.J. Egenhofer, J. Sharma, Topological relations between regions in R2 and Z2, in: D. Abel, B.C. Ooi(Eds.), Advances in Spatial Databases, Third International Symposium, SSD’93, Singapore, pp. 316–336.[22] C. Eschenbach, A predication calculus for qualitative spatial representations, in [23], pp. 157–172.[23] C. Freksa, D. Mark (Eds.), Spatial Information Theory. Cognitive and Computational Foundations of Ge-ographic information Science, International Conference COSIT’99, Lecture Notes in Computer Science,vol. 1661, Springer, Berlin, 1999.[24] A. Galton, The mereotopology of discrete space, in [23], pp. 251–266.[25] N.M. Gotts, An axiomatic approach to spatial information systems, Research Report 96.25, University ofLeeds, School of Computer Studies, 1996.[26] P.T. Johnstone, Stone Spaces, Cambridge University Press, Cambridge, 1982.[27] S. Le´sniewski, On the foundations of mathematics, Topoi 2 (1983) 7–52.[28] S. Li, M. Ying, Region Connection Calculus: Its models and composition table, Artificial Intelligence 145(2003) 121–146.[29] S. Li, M. Ying, Y. Li, On countable RCC models, Preprint, 2004. Available from: http://www.compscipreprints.com/comp/Preprint/sanjiang/20040321.2/1/.[30] C. Masolo, L. Vieu, Atomicity vs. infinite divisibility of space, in [23], pp. 235–250.[31] D.A. Randell, A.G. Cohn, Modelling topological and metrical properties of physical processes, in: R.J.Brachman, H.J. Levesque, R. Reiter (Eds.), Proceedings of the First International Conference on the Princi-ples of Knowledge Representation and Reasoning, Morgan Kaufmann, Los Altos, CA, 1989, pp. 55–66.[32] D.A. Randell, Z. Cui, A.G. Cohn, A spatial logic based on regions and connection, in: B. Nebel, W. Swartout,C. Rich (Eds.), Proceedings of the Third International Conference on the Principles of Knowledge Repre-sentation and Reasoning, Morgan Kaufmann, Los Altos, CA, 1992, pp. 165–176.[33] J. Renz, A canonical model of the Region Connection Calculus, J. Appl. Non-Classical Logics 12 (3–4)(2002) 469–494.[34] J. Renz, Qualitative Spatial Reasoning with Topological Information, Lecture Notes in Artificial Intelligence,vol. 2293, Springer, Berlin, 2002.[35] J. Renz, B. Nebel, On the complexity of qualitative spatial reasoning: A maximal tractable fragment of theregion connection calculus, Artificial Intelligence 108 (1999) 69–123.[36] J. Renz, B. Nebel, Efficient methods for qualitative spatial reasoning, J. Artificial Intelligence Res. 15 (2001)289–318.[37] A. Rosenfeld, Digital topology, Amer. Math. Monthly 86 (1979) 621–630.[38] A.J. Roy, J.G. Stell, Spatial relations between indeterminate regions, Internat. J. Approx. Reasoning 27(2001) 205–234.[39] A.J. Roy, J.G. Stell, A qualitative account of discrete space, in: M.J. Egenhofer, D.M. Mark (Eds.), Proceed-ings of Second International Conference of Geographic Information Science, GIScience 2002, in: LectureNotes in Computer Science, vol. 2478, Springer, Berlin, 2002, pp. 276–290.[40] H. Samet, The Design and Analysis of Spatial Data Structures, Addison-Wesley, Reading, MA, 1990.[41] P. Simons, Parts, A Study in Ontology, Clarendon Press, Oxford, 1987.[42] B. Smith, Mereotopology—A theory of parts and boundaries, Data Knowledge Engrg. 20 (1996) 287–303.[43] J.G. Stell, Granulations for graphs, in [23], pp. 417–432.[44] J.G. Stell, The representation of discrete multi-resolution spatial knowledge, in: A.G. Cohn, F. Giunchiglia,B. Selman (Eds.), Principles of Knowledge Representation and Reasoning: Proceedings of KR-2000, Mor-gan Kaufmann, San Mateo, CA, 2000, pp. 38–49.34S. Li, M. Ying / Artificial Intelligence 160 (2004) 1–34[45] J.G. Stell, Boolean connection algebras: A new approach to the Region-Connection Calculus, ArtificialIntelligence 122 (2000) 111–136.[46] A. Tarski, On the foundations of Boolean algebra (1935), reprinted in: Logic, Semantics, Meta-Mathematics.Papers from 1923 to 1938, Clarendon Press, Oxford, 1956.[47] A. Varzi, Parts, wholes, and part-whole relations: The prospects of mereotopology, Data Knowledge En-grg. 20 (3) (1996) 259–286.[48] A.N. Whitehead, Process and Reality: An Essay in Cosmology, Cambridge University Press, Cambridge,1929.[49] S. Winter, Topological relations between discrete regions, in: M.J. Egenhofer, J.R. Herring (Eds.), Advancesin Spatial Databases, in: Lecture Notes in Computer Science, vol. 951, Springer, Berlin, 1995, pp. 310–327.[50] S. Winter, Topological relations in hierarchical partitions, in [23], pp. 141–155.[51] S. Winter, Topology in raster and vector representation, GeoInformatica 4 (2000) 35–65.[52] M. Worboys, Imprecision in finite resolution spatial data, GeoInfomatica 2 (1998) 257–279.[53] M. Worboys, P. Bofakos, A canonical model for a class of areal spatial objects, in: D. Abel, B.C. Ooi(Eds.), Third international Symposium on Large Spatial Databases, in: Lecture Notes in Computer Science,vol. 692, Springer, New York, 1993, pp. 36–52.