SmartFABER: Recognizing Fine-grained AbnormalBehaviors for Early Detection of Mild CognitiveImpairmentDaniele Riboni∗ Claudio Bettini∗ Gabriele Civitarese∗Zaffar Haider Janjua∗ Rim Helaoui(cid:5)∗Universit`a degli Studi di Milano, Dept. of Computer Science, EveryWare Lab, Italy(cid:5)Philips Research Personal Health, Eindhoven, The NetherlandsEmail: {daniele.riboni, claudio.bettini, gabriele.civitarese, zaffar.janjua}@unimi.it,rim.helaoui@philips.comAbstractIn an ageing world population more citizens are at risk of cognitive im-pairment, with negative consequences on their ability of independent living,quality of life and sustainability of healthcare systems. Ubiquitous comput-ing and intelligent data analysis can provide innovative methods and toolsfor detecting early symptoms of the onset of cognitive impairment and formonitoring its evolution. In this paper we present SmartFABER, an activityrecognition system integrated with a novel method to detect abnormal activ-ity routines of elderly people living at home. The method relies on medicalmodels, provided by cognitive neuroscience researchers, describing some ofthe anomalies in carrying out daily activities that may indicate the onset ofearly symptoms of mild cognitive impairment. A non-intrusive sensor-basedinfrastructure acquires low-level data about the interaction of the individ-ual with the home environment including objects, appliances and furniture.Based on those data, a novel hybrid statistical and knowledge-based tech-nique is used to detect the abnormal behaviors of the senior, which are storedby the system and presented through a dedicated dashboard to the clinicians.Differently from related works, our method can detect abnormal behaviorsat a fine-grained level, thus providing an important tool to support the med-ical diagnosis. We have fully implemented the system and we evaluated ourmethod with significant datasets, partly generated by performing activities ina smart home laboratory, and partly acquired during several months of moni-toring of the instrumented real home of a senior diagnosed with MCI. We re-port the output of extensive experiments confirming the superiority of Smart-FABER with respect to previously published methods; Qualitative feedbackfrom clinicians also confirms the validity of the approach.11 IntroductionIndependent living and pro-active healthcare are becoming strategic applicationareas for major research programmes all over the world, considering that the seniorpopulation (aged over 65) is projected to double as a percentage over the wholepopulation in the next decades [1]. Among the most frequent threats to independentliving is cognitive decline, whose early symptoms often lead to a Mild CognitiveImpairment (MCI) diagnosis. According to the International Working Group onMCI, there are evidences of subtle differences in performing instrumental activitiesof daily living (IADLs) among MCI patients compared to both healthy older adultsand individuals with dementia [2]. Hence, monitoring of daily living activities andrecognition of abnormal behaviors may help practitioners to early detect the onsetof cognitive impairment.Ubiquitous computing technologies coupled with intelligent data analysis havea recognized potential in the automatic recognition of IADLs. Indeed, several re-search projects, and numerous research papers have tried to detect behavioral mark-ers of MCI onset through ubiquitous computing technologies, obtaining a correla-tion between the predicted and actual cognitive status of the patient. Some of theseapproaches require the execution of ability tests about the performance of IADLsin an instrumented smart home of a medical institution; hence, they incur in highcosts and cannot be applied on a continuous basis. Some of them deploy cam-eras and sensor networks in controlled environments and use video and audio foractivity recognition: these systems are often perceived as too invasive for the el-derly’s privacy. Other works rely on continuous monitoring of low-level behavioralmarkers (steps taken, walking speed, . . . ) and trigger alarms whenever they detectsituations sufficiently distant from the expected (modeled) behavior: they providelittle support to the diagnosis, since they do not report fine-grained descriptionsof the anomalies occurred during the execution of IADLs. Moreover, very fewsystems have been deployed and tested effectively in the elderly’s home. In thefollowing section we provide a short overview of the relevant literature.In this paper we describe SmartFABER, a novel technique for Fine-grainedAbnormal BEhavior Recognition aimed to overcome the limitations of existingtechniques in supporting early detection of mild cognitive impairment (MCI) forelderly people living independently at home. SmartFABER exhibits the followingfeatures: a) it heavily relies on indicator models built by cognitive neuroscience ex-perts, b) it continuously acquires data from non-intrusive sensors deployed in thesenior’s home, c) it features an effective abnormal behavior recognition techniquecoupling state-of-the-art machine learning with knowledge-based inferencing, d)it provides clinicians with a dashboard identifying fine-grained short-term abnor-mal behaviors (e.g., inappropriate timing in assuming food or medicine intake,2improper use of equipment, unnecessary repetitions of actions).Our main contributions can be summarized as follows:• SmartFABER is an innovative hybrid activity and anomaly recognition frame-work. It overcomes the shortcomings of purely statistical methods and it hasmajor improvements over the state-of-the-art hybrid systems [3] in terms ofaccuracy of activity recognition, and enhanced reporting features;• SmartFABER has been experimented on real datasets, including a three monthsdeployment in the house of a senior diagnosed with MCI. The results showthat SmartFABER is able to detect most anomalies that we have targetedwhile producing a small number of false positives;• We show the superiority of SmartFABER with respect to the only other hy-brid system we are aware of through a direct comparison over the samedatasets.The rest of the paper is structured as follows. Section 2 discusses relatedwork. Section 3 reports our model of activities and abnormal behaviors. Sec-tion 4 presents the SmartFABER method. Section 5 reports experimental results.Finally, Section 6 concludes the paper.2 Related workActivity recognition systems proved to be effective for supporting the diagnosisand improving healthy ageing [4, 5]. In the literature, various strategies have beenproposed to devise effective and unobtrusive activity monitoring systems by ex-ploiting pervasive computing technologies [6]. A popular research direction foractivity recognition consists in exploiting audio-visual information recorded bycameras and microphones with the help of sound, image and scene recognitionsoftware. However, those methods are considered too invasive in a home environ-ment, due to the privacy issues that they determine. Hence, in the following werestrict our attention to non-invasive sensor-based techniques.2.1 Recognition of simple activitiesSeveral techniques were proposed to recognize simple activities, which rely ondata acquired from body-worn sensors and on the application of supervised learn-ing methods [7, 8]. Early attempts in this sense were mainly based on the useof data acquired from multiple body-worn accelerometers [9], possibly coupledwith biometrical sensors and integrated in clothes [10], to recognize locomotion3types and simple physical activities. A major limitation of these early systems isthat they did not consider contextual information, such as current location, envi-ronmental conditions, and surrounding objects, that could be usefully exploited toimprove the accuracy of recognition. Hence, other activity recognition approachestake into account the user’s context by acquiring environmental data from severalsensors [11]. For instance, in [12] the authors proposed the use of machine learn-ing and data acquired from body-worn sensors (an ear microphone, sensor collarintegrating electromyogram and microphone, and four upper body accelerometers)to accurately monitor food intake activities (movement, chewing and swallowing).However, being mainly based on body-worn sensors, those methods are not wellsuited to recognize more complex activities, like IADLs executed at home, whichare characterized by the interaction of the individual with several objects and fur-niture.2.2 Recognition of complex activitiesThe recognition of complex activities, like ADLs that we consider in our work,relies on the usage of sensors to detect the interaction of the individual with ob-jects and furniture. However, even when those sensors are available, the recog-nition of complex activities turns out to be challenging using solely supervisedlearning methods. Indeed, complex activities are characterized by large inter- andintra-personal variability of execution, and it is very hard to acquire a sufficientlycomprehensive training set to include most of the possible ways of executing ac-tivities. Hence, different frameworks for knowledge representation and reasoninghave been investigated to appropriately model complex human activities by meansof ontologies.In particular, description logics [13] have emerged among othersymbolic formalisms, mostly because they provide complete reasoning supportedby optimized automatic tools. However, as illustrated in [14], both expressive-ness and efficiency issues strongly limit the feasibility of ontological approaches toactivity recognition. Moreover, the recognition of complex activities through on-tological reasoning has to start from some basic observations (e.g., “the user is in agiven room”, “he is sitting on a chair”, etc.); this task requires the use of statisticalmethods to derive semantic information from raw sensor data.2.3 Hybrid activity recognition techniquesGiven the limitations of both statistical and symbolic approaches, a few hybrid ac-tivity recognition systems have been proposed in the literature, which vary on theadopted reasoning techniques and on their interaction mechanisms. An interestinginstance of those approaches is Markov Logic Networks (MLN) [15], a proba-4bilistic first-order logic. Given a training set, and a set of probabilistic formulas,with MLN it is possible to learn a weight for each grounded formula by iterativelyoptimizing a pseudo-likelihood measure. Those weights represent the confidencevalue of the formula. Deterministic formulas can be added to probabilistic ones toexpress deterministic knowledge about the domain of interest. Different reasoningtasks can be executed to infer additional information based on formulas and facts.MLN has been used in a previous version of our work [3]. A similar approach wasadopted in [16] to model and recognize activities at different levels of complexityusing probabilistic description logic. Hybrid ontological and statistical reasoningis proposed in [17] to continuously assess the fall risk of a senior at home, byintegrating data acquired from different fall detection systems and environmentalsensors. In this work, we propose a hybrid method to recognize the start- and end-time of ADLs based on a combination of supervised learning and knowledge-basedconditions to refine the statistical predictions.2.4 Applications of activity recognition to MCI diagnosisSeveral studies in the neuropsychology research field show that it is possible todistinguish between cognitively healthy adults and cognitively impaired individu-als based on subtle differences in their behavioral patterns [2]. There is a growinginterest in exploiting pervasive computing technologies to automatically captureand measure those differences [5]. For instance, motion sensors and contact sen-sors have been used in [18] to measure low-level activity patterns, such as walk-ing speed and activity level in the home; results have shown that the coefficientof variation in the median walking speed is a statistically significant measure todistinguish MCI subjects from healthy seniors. More recently, a sensor-based in-frastructure has been used to unobtrusively monitor the execution of IADLs byolder adults in a smart-home [19]; the results have shown a significant correlationbetween the cognitive health status of the subject and the level of assistance that heneeds to complete the activities.Based on this line of research, different works have proposed to apply machinelearning techniques on data acquired in sensor-rich environments, for assessing thecognitive health status of an individual performing a set of ADLs. In the work ofDawadi et al. [20], patients were invited to execute a list of routines (e.g., writea letter, prepare lunch) inside a hospital smart-home. Different kinds of sensorswere used to detect movements inside the home and to track the use of furnitureand appliances. Based on data coming from the home sensors, supervised learn-ing methods were used to assign a score to each performed activity; the scoremeasures the ability of the subject to perform the activity correctly. The achievedscores were used to predict the cognitive status of the patient (cognitive health or5dementia). The supervised learning approach has been applied in other works,including [21, 22, 23], using several other learning methods. However, while asignificant correlation exists between the inferred activity scores and the cognitivehealth status of the individual, those methods do not provide a description of theobserved behavioral anomalies. On the contrary, the medical assessment wouldbenefit from detailed knowledge of the abnormal behavior of the patient. For thisreason, in our approach we do not rely on statistical deviations from the “normal”behavior; instead, we aim at recognizing fine-grained anomalies, modeled accord-ing to neuroscience experts as possible indicators of MCI, using a hybrid statisticaland knowledge-based approach. To the best of our knowledge, this work is the firstone (except our preliminary results presented in [3]) that applies this approach tocognitive health assessment.2.5 Long-term analysis of activity dataIn the aforementioned works, the detection of abnormal behaviors is mostly doneon a short-term basis and does not take into account the patient’s personal habits.Other works have proposed methods to model the patient’s usual behavior from theactivities performed in the past and use this model to detect anomalies as changesfrom his/her usual behavior. In [24], a method has been proposed to monitor thecircadian (24-hours) variability of the patient’s activities using location sensorsand statistical calculations were performed regularly on sensors data to recognizepossible deviations in the patient’s behavior. In [25] in-home activities and sleeprestlessness were captured using different sensors and a simple alert system wasimplemented to detect changes in the activity patterns and generate health alertsthat were sent to clinicians to be rated for their clinical relevance. These ratingswere then used as ground truth in developing classifiers to recognize relevant alerts.In [26], the authors propose a technique to detect recurrent ADLs patterns, as wellas their variations, by mining heterogeneous multivariate time-series from sensordata acquired in a smart home. Another approach based on temporal data miningwas presented in [27]. Frequently-occurring temporal relationships between activ-ities were extracted from the observed history of sensor events and used to modelthe probability that a particular event should or should not occur on a given day. Atechnique based on unsupervised learning is proposed in [28] to automatically dis-cover ADL patterns and their variations. That technique is coupled with an activityrecognition module and with visualization tools to allow practitioners inspectingthe trend of activity patterns. Visualization of spatio-temporal data extracted fromthe long-term observation of elderly’s activities at home is used in [29] to identifypotential risk situations. In our work, we also aim at monitoring the elderly’s be-havior on the long term. However, as explained before, we do not rely on statistical6measures about activity patterns, but we consider specific anomalies modeled byneuroscience experts.3 Modeling activities and abnormal behaviorsIn the following, we explain how we model human activities and fine-grained ab-normal behaviors.3.1 Human activitiesIn order to model activities, we adopt the multilevel framework proposed in [16].In particular, each IADL consists of a sequence of simple actions. For instance,a patient could perform the IADL “taking medicines” by executing this sequenceof actions: open the medicine repository, retrieve the medicine box, return themedicine box, and close the medicine repository. Of course, the same activity canbe performed by executing different sequences of actions. For instance, “takingmedicines” can be performed by these actions: open the medicine repository, re-trieve the medicine box, and return the medicine box (leaving the medicine repos-itory open). Since we concentrate on IADLs, we assume that each action cor-responds to a manipulative gesture or other body movement involving an object(e.g., “open the silverware drawer”, “sit on the kitchen chair’).3.2 Fine-grained abnormal behaviorsBy fine-grained abnormal behaviors (also called anomalies for short) we definethose behaviors, observed within a relatively short time period (from a few sec-onds to a day), which diverge from the expected ones, according to a given modelprovided by clinicians. In general, a fine-grained abnormal behavior can be de-tected based on the observation of: the sequence of actions composing a performedactivity; the sequence of performed activities; the duration of individual activitiesand actions; the execution of an improper activity, or the non-execution of someexpected activities.In particular, in this work we consider models of abnormal behaviors that mayindicate the onset of MCI, and more generally of a cognitive decline. In order toacquire those models, we collaborated with cognitive neuroscience experts fromthe Institute Fatebenefratelli1, Lombardy –a leading center in the field of mental1IRCCS (Research and Care Institute) St John of God Clinical Research Centre, Brescia – http://www.irccs-fatebenefratelli.it7health research and research on neurodegenerative disorders– within the SECURE2research project funded by Lombardy region and MIUR Italian ministry. A list offine-grained abnormal behaviors has been identified during different project meet-ings among the technical and medical partners of the project, based on the medicalpractice and relevant literature [30]. For the sake of this work, we have consideredanomalies related to food preparation, food consumption, and compliance to med-ical prescriptions. The anomalies are defined in natural language by the clinicians;e.g., “an anomaly occurs when the patient prepares a meal but forgets to consumeit”.In order to facilitate their analysis, we classified anomalies in the followingcategories:• Non-critical anomaly. An anomaly is considered as non-critical when thepatient skips a relevant action while performing a IADL, or spends too muchtime to perform the activity, but still he is able to complete the activity cor-rectly. For instance, we consider a non-critical anomaly to occur when thepatient forgets to close a repository after taking something from it.• Critical anomaly. A critical anomaly occurs when the patient skips some nec-essary action while performing an activity, forgets to execute a required ac-tivity, or performs the activity more times than expected. Critical anomaliesare stronger indicators of possible MCI onset than non-critical ones. Theseanomalies are further divided into four categories:– Omission: there are some actions in each IADL which are necessaryand it is mandatory for the patient to perform them in order to com-plete the activity correctly: a critical omission occurs when the patientskips any of such actions. For instance, a critical omission related tothe activity “taking medicines” is: “the patient forgets to retrieve theprescribed medicine during the prescribed time’.– Replacement: this anomaly occurs when, during a IADL, a patient re-places a correct action with a wrong one; for instance, “the patient hasplaced the butter inside a non-refrigerated cabinet”.– Improper activity: it occurs when the patient performs an activity thatis not consistent with the model. For instance, this anomaly occurswhen the patient takes a medicine that was not prescribed.– Repetition: this anomaly occurs when the patient repeats the same ac-tivity more times than expected; for instance, when the patient con-sumes the morning breakfast twice in a day.2SECURE: Intelligent System for Early Diagnosis and Follow-up at Home, http://secure.ewlab.di.unimi.it/8Of course, human behaviors are characterized by wide variability; factors suchas contextual conditions, individual habits and personality traits may determinethe execution of various anomalies that are not necessarily due to cognitive im-pairment. This is especially true for non-critical anomalies, as leaving repositoriesopen, which may be normally done by cognitively healthy people for negligenceor hastiness. Hence, while the considered anomalies are indicators of possible ab-normal behaviors, they are not intended to provide an automatic diagnosis of thepatient’s cognitive status. For instance, consider the aforementioned example ofimproper activity: the fact that the patient takes a medicine that was not prescribedis critical if he does it unintentionally (e.g., for a memory disorder). In other casesit may be a normal behavior; e.g., if the patient intentionally takes an over-the-counter drug that does not interfere with his medical prescriptions. Therefore,the frequency of detected anomalies and their temporal trend are used as a meanto trigger alarms to the practitioners for further inspecting the history of detectedanomalies and their fine-grained descriptions.4 The SmartFABER hybrid techniqueIn this section, we illustrate the SmartFABER method to recognize fine-grainedabnormal behaviors. The overall framework is shown in Figure 1. The hybrid rea-soning framework of SmartFABER, shown in Figure 2, exploits both statistical andknowledge-based methods. In particular, knowledge-based methods are used bythe SEMANTIC INTEGRATION LAYER to recognize simple events from raw sensordata; by the SMART AGGREGATION module to identify activity instances; and bythe KNOWLEDGE-BASED INFERENCE ENGINE to detect the anomalies accordingto the clinicians’ models. Statistical reasoning, taking into account temporal fea-tures, is used to classify events into activities and to recognize activity instances.In the following, we describe in detail the main components of SmartFABER.4.1 Sensor data acquisitionA non-invasive sensor network system including environmental, presence, and con-tact sensors is deployed at the elderly’s home. The smart-home monitoring system,running on a mobile device (e.g., a tablet) within the home, collects in real-timethe raw sensed events data from the sensor nodes in order to execute the Smart-FABER recognition algorithms. The SEMANTIC INTEGRATION LAYER moduleis in charge of applying simple inference methods to derive pre-processed eventsfrom raw sensor data. For instance, a rule states that “if the presence sensor de-tects a presence near the kitchen table, and the sensor on the kitchen’s chair de-9Figure 1: The framework to recognize short-term abnormal behaviorstects a weight of more than 40Kg, then the current event is sitting on a chair atthe kitchen table”. We define E as the set of all the considered event types (e.g.E = {Door is opened, Door is closed}). We adopt a simple temporal model forthe events. We denote as T the set of all the possible timestamps. A sequence ofevents is represented as follows:(cid:104) ev(E1, t1), ev(E2, t2), . . . , ev(Em, tm) (cid:105),where ev(Ei, ti) indicates that the event Ei ∈ E occurred at timestamp ti ∈ T. Aunique timestamp is assigned to each event, based on the time at which the relatedraw sensor events are received by the central mobile device. In this way we imposea total order on event timestamps (cid:104) t1, t2, . . . , tm (cid:105). The sequence of high-levelevents is then provided to the SmartFABER recognition algorithms.4.2 Modeling activity classes and instancesWe define A = {A1, A2, . . . , Ak} as the set of k considered high-level activ-ity classes (e.g.: A = {Preparing Meal, Eating Meal, Taking Medicines}). Aninstance a of an activity A ∈ A is an occurrence of A during a timespan. Intu-itively, a timespan is a particular time interval represented by a start time and anend time, where not every timestamp between the boundaries necessarily belongsto the timespan. This representation allows us to consider activities performed inan interleaved fashion. More formally, we define a timespan ts as a non-convex10SMART-HOME MONITORING SYSTEM...PRESENCE SENSORSCONTACT SENSORSENVIRONMENTAL SENSORSCLINICAL KNOWLEDGEBASEdefinitions ofabnormal behaviorsMCI modelsand indicatorse-HealthCare Servicehome-acquired sensor datashort-term anomaliesFINE-GRAINED ABNORMAL BEHAVIOR RECOGNITION (SmartFABER)Figure 2: The SmartFABER technique to recognize short-term abnormal behaviorstime interval characterized by a finite set of non overlapping temporal intervals{[x1, y1], [x2, y2] . . . , [xn, yn]} where ∀i xi, yi ∈ T. Given a timestamp t ∈ Tand a timespan ts, we say that t belongs to the timespan ts if it belongs to one ofits intervals. We denote with aAts an instance of an activity A ∈ A occurred dur-ing a timespan ts. Given a sensor-equipped environment, an activity instance aAtsgenerates a sequence of events that we call “aAts observations”, formally denotedby Obs(aAts) = (cid:104)ev(E1, t1), ev(E2, t2), . . . , ev(Ek, tk)(cid:105), where ∀i Ei ∈ E andti ∈ ts.4.3 Activity recognitionAt each pre-processed event, SmartFABER applies a time-based supervised learn-ing technique to assign the most probable activity class. The classified events are11...SEMANTIC INTEGRATION LAYERPRESENCE SENSORSCONTACT SENSORSENVIRONMENTAL SENSORSpre-processed eventsKNOWLEDGE-BASED INFERENCE ENGINE............ev(E2,t2)ev(E3,t3)ev(E1,t1)...event featuresTIME-BASED FEATURE EXTRACTIONclassification of events into activities (ev(Ei,ti), Aj)raw sensor eventsMACHINE LEARNING ALGORITHMrule-baseddefinitionsof abnormalbehaviorsfine-grained anomaliesactivity instances (ai = <ev(E1,t1), ..., ev(Ek,tk)>)SMART AGGREGATIONthen post-processed in order to identify the most probable activity instances.4.3.1 Classification of eventsThe events produced by the SEMANTIC INTEGRATION LAYER are communicatedto the TIME-BASED FEATURE EXTRACTION module. For each event ev(Ei, ti),this module is in charge of building a feature vector vi representing the n mostrecent events (cid:104) ev(Ei−n+1, ti−n+1), . . . , ev(Ei−1, ti−1), ev(Ei, ti) (cid:105). In particular,we adopt the feature extraction technique proposed in [31], since it takes into ac-count temporal aspects, and proved to be effective in recognizing activities basedon streams of sensor events. The produced feature vectors are given as input to asupervised MACHINE LEARNING ALGORITHM to infer for each vi the most proba-ble class of the activity instance carried out at ti. The algorithm is trained using adataset of activities and generated events.4.3.2 Naive aggregationThe next step is to infer the actual activity instances from the output of the MA-CHINE LEARNING ALGORITHM by grouping together those events which can beconsidered observations generated by the same activity instance. Intuitively, tem-porally close events classified with the same activity class are most likely generatedby the same activity instance. We first discuss the baseline approach, named naiveaggregation. The basic idea of this algorithm is the following: if two consecutiveevents occurred respectively at ti and ti+1 are classified with the same activity classAi = Ai+1, they are considered as observations generated by the same instance ofan activity of class Ai. Otherwise, they are considered observations generated bydifferent activity instances. Consider, for instance, the case illustrated in Table 1.This table illustrates in the first three columns a sequence of events associated withactivity classes predicted by the MACHINE LEARNING ALGORITHM; in the fourthcolumn, the ground truth about activity instances; and in the last column the outputof the naive aggregation method. The algorithm produces 5 different instances ofactivities. However, it is easy to see that this aggregation is not correct. Indeed, theevents E2, E4 and E6 share the same activity class and are temporally close. Withhigh probability, the inferred activity classes for the events E3 and E5 are mis-predictions, since the “Eating meal” and the “Preparing meal” activity instanceswould have a too short duration. Moreover, consider the case where events E1 andE2 correspond respectively with Presence in the kitchen and Open the medicinerepository. These two events alone can not be considered as the only observationsgenerated by an instance of a Taking Medicines activity: the medicine repositorycan possibly contain items not related with medicines and it is also possible that it12may be opened just to check the content. Another issue of this technique is that twoconsecutive events labeled with the same activity class but temporally distant (likeE6 and E7) would be grouped together, while they most likely belong to separateactivity instances. Hence, the particular sequence of events illustrated in Table 1should identify a single instance of “Taking medicines” that generated the eventsfrom E1 to E6.Table 1: An example of naive aggregation based on a sequence of classified eventsPredicted instancesActual instancesEvent typeE1E2E3E4E5E6E7. . .. . .Timestamp08:32:3108:32:4808:32:5508:33:0208:34:1108:34:1311:34:27. . .. . .Predicted activity classTaking medicinesTaking medicinesEating mealTaking medicinesPreparing mealTaking medicinesTaking medicines. . .. . .takingM edicines1takingM edicines2takingM edicines1eatingM eal1takingM edicines2preparingM eal1takingM edicines34.3.3 Smart aggregationTo overcome the problems of the approach illustrated in 4.3.2, we refined ourrecognition method. We introduce for each activity class A ∈ A a set of con-ditions that are necessary for a sequence of events to be considered observationsgenerated by an instance of that class. For example, assuming that the infrastruc-ture includes sensors to detect the stove usage, any instance of the activity Prepar-ing a hot meal should generate some observations related to the usage of the stove.Other examples of conditions may be constraints on the duration of the activityinstance or on the number of generated events. Among those conditions, we con-sider the upper bound about the duration of activity interruptions: the time distancebetween every pair of consecutive events within the observations generated by anactivity instance aAts must be lower than maxGapA. The value of the upper boundmaxGapA depends on the activity class A. Those values are determined statisti-cally; as a result, for example, “Preparing meal” will have a higher maxGap than“Taking medicines”. Formally, let C(A) = {c1, c2, . . . , ck} be a set of necessaryconditions expressed in logic over a sequence of events that are observations of anyinstance of a class A ∈ A (e.g. {”The sequence of events must last more than 3minutes”, “The sequence of events must contain an event regarding the usage of thestove”, . . . }). A sequence of events s = (cid:104)ev(E1, t1), ev(E2, t2), . . . , ev(Ek, tk)(cid:105)can be considered as observations generated by an activity instance aAts if it satisfiesevery condition in C(A). The set of conditions for each class are determined after13a detailed analysis of the semantics of the activity class and on statistics about theavailable observations acquired from the sensor infrastructure. For instance, thepreviously discussed condition about the duration of the interruption of an activityA ∈ A over a sequence of events s can be expressed as:∀i : ev(Ei, ti), ev(Ei+1, ti+1) ∈ s → (ti+1 − ti < maxGapA)We now introduce the SMART AGGREGATION algorithm, a refined activity in-stance recognition method. The pseudo-code is shown in Algorithm 1. The firststep of the algorithm is a segmentation over the output of the MACHINE LEARNINGALGORITHM: all the events associated with the same activity class A and tempo-rally close (according to maxGapA) are grouped together. For each group g ofevents classified with an activity A, it is checked if it satisfies all the conditions inC(A). If all the conditions are satisfied, an activity instance aAts that generated theobservations contained in g is recognized. All the events contained in those groupswhich did not satisfy the conditions of their class are considered as mispredictions.Hence, the algorithm tries to include them in one of the activity instances recog-nized at the previous step. For each misprediction ev(E, t), the algorithm builds aset I of activity instances aAts (that have been recognized in the previous step) suchthat t lies between the boundaries of the timespan ts and {ev(E, t)} (cid:83) Obs(aAts)satisfies all the conditions in C(A). When |I| > 1 we choose the most probable in-stance based on a function f req, which computes the frequency of an event beingan observation of the instances of a particular activity class. The values of f reqfor each possible combination of event type and activity class are computed offlinebased on the annotated dataset. The event ev(E, t) is added to the observations ofthe instance aAts ∈ I, where A is the most frequent activity class. If I is empty,ev(E, t) is considered an observation of an “other activity” instance.4.4 Anomaly detectionWe remind that we denote as “anomalies” the deviations from the “normal” wayof carrying out activities. Anomalies are described in natural language by cog-nitive neuroscience experts. In order to automatically reason with anomalies, werepresent them in propositional logic. Anomalies are represented by the predicateanomaly(Categ, Obj, Time). Categ defines the category of the anomaly. Obj de-fines the objects or activities involved in the anomaly; for example, in case of acritical omission, the missed medicine may be the object related to that anomaly.Time defines the time instant at which the anomaly is detected.Table 2 shows the representation of a few anomalies. The semantics of notis the one of negation as failure [32]. Predicate prescribed(m,t1,t2) states thatthe patient must take medicine m from time t1 to time t2 of the current day.14ALGORITHM 1: Smart aggregationInput: A set S = {(ev(E1, t1), A1), (ev(E2, t2), A2), . . . , (ev(En, tn), An)} ofevents associated with the predicted current activity classes, where ∀iEi ∈ E, ti ∈ T and Ai ∈ A.Output: A set A of activity instances.A ← ∅;mispredictions ← ∅;foreach A ∈ A doX ← the events in S predicted with A;G ← segmentation(X, maxGapA);foreach g ∈ G doif g satisfies all the conditions in C (A) thena ← an activity instance of class A that generated the observations g;A ← A (cid:83){a};mispredictions ← mispredictions (cid:83) g;elseendendendforeach ev(E, t) ∈ mispredictions doI ← ∅;foreach aAts ∈ A doif t lies between the boundaries of ts thenx = Obs(aAif x satisfies all the conditions in C (A) thents) (cid:83){ev(E, t)};I ← I (cid:83){aAts};endendendif I (cid:54)= ∅ thena(cid:48) = argmaxaAts∈If req(E, A);add ev(E, t) to the observations of a(cid:48);elseconsider ev(E, t) as observation of an activity instance of class “otheractivity”;endendreturn A;Medicine(o) (resp. Food(o)) states that object o is a medicine box (resp.fooditem). Action(a, o, o(cid:48), t) states that the patient executed action a on objects o and15ALGORITHM 2: Segmentation of activity instancesInput: A set of events X = {ev(E1, t1), ev(E2, t2), . . . , ev(En, tn)} and thethreshold maxGap.Output: A partition of X according to maxGap.groups ← ∅;currGroup ← {ev(E1, t1)};for i ← 2 to n doif ti − ti−1 < maxGap thencurrGroup ← currGroup (cid:83){ev(Ei, ti)};elseendgroups ← groups (cid:83){currGroup};currGroup ← {ev(Ei, ti)};endreturn groups (cid:83){currGroup};Table 2: Examples of rules modeling abnormal behaviorsNo. Rule1234←anomaly(cr, f ridge, T2)action(return, RF, S, T1)∧action(close, door, S, T2) ∧ Ref F ood(RF ) ∧N onRef Storage(S) ∧ (T1 < T2).←anomaly(nca, prepBF, T1+45 minutes)startActivity(prepBreakf ast, T1)∧endActivity(prepBreakf ast, T2)∧((T2−T1) > 45minutes).anomaly(co, medicine, T2)prescribed(M, T1, T2)not((action(retrieve, M, C, T )M edCabinet(C) ∧ (T1 ≤ T ≤ T2).←anomaly(wa, medicine, T )not(prescribed(M, T1, T2))∧action(retrieve, M, C, T ) ∧ M edCabinet(C) ∧M edicine(M ).←∧∧Anomaly typethe pa-Critical replacement:tient has placed a food item thatneeds refrigeration inside a non-refrigerated cabinet.the pa-Non-critical anomaly:tient spent too much time to pre-pare breakfast.the patientCritical omission:has not retrieved a prescribedmedicine in due time.Wrong activity: the patient hastaken a medicine that was notprescribed.o(cid:48) at time t. Holds(s,o,t1,t2) states that the status of object o has been “s” from t1to t2 (for instance, “the microwave oven has been on from 11:30 to 11:55”). TheHolds predicate allows us to express temporal conditions that are useful in the def-inition of different anomalies. Temporal expressions that we use in our rule-baseddefinitions include the interval of time during which an action is performed, the16temporal distance between two actions, the temporal duration of an activity, thetemporal order among activities.Abnormal behaviors are recognized by the KNOWLEDGE-BASED INFERENCEENGINE, which periodically (e.g., at the end of each day) evaluates the rule-basedanomaly definitions considering the data acquired and inferred during the con-sidered time period: inferred activity instances and preprocessed events, as wellas external knowledge including the medical prescriptions of the patient and theclassification of objects in categories. Those data are represented by the aforemen-tioned predicates, and added to the propositional logic knowledge base.Example 1 Consider an elderly person living independently at home. Supposethat furniture and devices, including food cabinets and the fridge, are equippedwith a magnetic sensor to detect the open and close actions. An RFID tag is at-tached to some food boxes to identify their content (e.g., rice, milk, coffee, sugar).RFID readers in the proximity of the cabinets and fridge are in charge of detectingwhich item has been retrieved or returned. Suppose that at 08:05 AM the patientopens the fridge f and retrieves the milk box m to prepare breakfast. After a fewminutes, he mistakenly puts the milk box in the non-refrigerated food cabinet cand closes its door. Hence, based on the sensed events, the following axioms areautomatically added to the knowledge base:action(open, door, f , 8:05:00 AM).action(retrieve, m, f , 8:05:07 AM).action(return, m, c, 8:12:30 AM).action(close, door, c, 8:12:35 AM).Since the knowledge base contains the axioms RefFood(m) (stating that the milkbox contains a food item that must be kept refrigerated) and NonRefStorage(c)(stating that c is a non-refrigerated storage), Rule 1 in Table 2 fires, recognizingan abnormal behavior.5 Experimental evaluationWe have developed a prototype of SmartFABER, and we have extensively evalu-ated our techniques with two large datasets of both normal and abnormal behaviors:one acquired in a smart home lab with actors simulating the daily routines of 21patients, and one acquired during three months of experimentation in the home ofan elderly diagnosed with MCI.17Figure 3: The SmartFABER app.5.1 Hardware and software implementationA prototype implementation of the whole system has been developed within theactivities of the SECURE project. Since the SmartFABER system is intended torun on a mobile device at the patient’s home, the core software modules have beenimplemented in Java for the Android platform. Figure 3 shows the application run-ning the SmartFABER software. In particular, in order to implement the techniquefor activity recognition we have used the machine learning libraries of Weka3.In order to evaluate the rule-based definitions of anomalies we used the APIs ofTuProlog [33], a lightweight Java implementation of an inference engine for thewell-known Prolog logic programming language.For this prototype, we use sensor motes available on the market, which com-municate using the ZigBee protocol. Since currently there is no standard interfacefor that protocol on most Android devices, we use a gateway installed in the hometo receive ZigBee messages from sensors and forward them via Bluetooth to theAndroid device. Sensor motes have been programmed in the C++ language tocommunicate new data to the gateway at the occurrence of each sensor event. Forinstance, the pressure sensor attached to the kitchen chair seat communicates the3http://www.cs.waikato.ac.nz/ml/weka/18Figure 4: SmartFABER Clinicians’ dashboard.19measured pressure when it exceeds or falls behind given thresholds, to detect whenthe patient stands up or sits down on the chair. Such thresholds have been deter-mined empirically. The sensor event message includes the timestamp of the sensorreading, the sensor ID and the detected value. A C++ application running on thegateway is in charge of: receiving data from sensors, assigning the unique times-tamps, locally storing the data in a PostgreSQL database, and periodically commu-nicating the data to the Android application. At the end of each day, the Androidapp runs the SmartFABER algorithms for activity boundary detection and anomalyrecognition, and communicates the results through the Internet to the backend ofthe hospital center, where the data are stored.We have also developed a Web-based dashboard, shown in Figure 4, to allowpractitioners analyzing the history and trends of IADLs as well as the anomalies’history.5.2 DatasetsWe experimented our method using two datasets; one acquired in a smart homelaboratory, and one acquired in the instrumented home of a senior with an MCIdiagnosis.5.2.1 Smart home lab datasetWe have acquired a dataset of IADLs and anomalies, asking to voluntary actorsto reproduce the daily routine of 21 elderly persons in our smart home lab. Ex-ecuted IADLs and anomalies have been carefully designed in collaboration withneuroscience experts to realistically mimic the behavior of two groups: 7 healthyseniors (group 1), and 14 elderly persons with early symptoms of MCI (group 2).We assume that individuals of both groups live alone and independently in theirrespective homes. During their one-day routine, individuals in group 1 do not ex-ecute any critical anomaly, but may execute a few non-critical ones. Individualsin group 1 are mainly used to evaluate the number of false positives produced byour anomaly recognition method. Group 2 individuals may perform several non-critical and critical anomalies during the day.During the execution of the daily routines, we have acquired the timestampeddata coming from the sensors deployed in the smart home and manually annotatedthe dataset with the start- and end-time of specific activities and anomalies. Thefollowing IADLs have been selected to validate our method:• Preparing food: the patient has to prepare the daily meals (breakfast, lunch,dinner) at appropriate times.20(a) Magnetic sensor attached to a drawer (b) Presence sensor above the kitchen ta-ble(c) RFID reader for medicine boxes and food itemsFigure 5: Some sensors used in the smart home lab.21• Consuming meal: when the patient prepares a meal, he has to consume itwithin a reasonable time period.• Taking medicines: the patient has to take the prescribed medicines in the duetime. We assume that no smart dispenser is used; instead, we assume thatthe patient keeps all the medicines in a dedicated cabinet.We have considered the following anomalies:• Non-critical anomalies. They happen when the individual: (NC1) forgota repository open; (NC2) did not return a medicine to its cabinet; (NC3)retrieved a food item which must be cooked, but did not use the stove burner;(NC4) does not prepare a meal.• Critical anomalies. They happen when the individual: (C1) did not retrieve aprescribed medicine in the due time; (C2) took a medicine that was not pre-scribed; (C3) took a prescribed medicine in the due time but multiple times,resulting in inappropriate dosage; (C4) did not turn off the stove burner afterfinishing to prepare a hot meal; (C5) did not take the silverware before con-suming meal; (C6) did not consume the meal after having prepared it; (C7)turned the stove burner on but did not take any cooking pan.Overall, our dataset contains 21 days of IADLs and anomalies. Group 1 individualsdid 7 non-critical and 0 critical anomalies; group 2 individuals did 24 non-criticalanomalies and 36 critical ones.5.2.2 Real home datasetAs a first step towards the evaluation of our methods in the actual home of elderlypersons, we took advantage of our cooperation with a medical institution and a tele-medicine company as partners of the SECURE project, and deployed our prototypeinside the home of an elderly woman aged 74, with a diagnosis of MCI and medicalco-morbidities, who lives alone. We will call her Mary in the following. Detailsabout the technical implementation of the system in Mary’s home are reportedin [34].We acquired a dataset consisting of 55 days of IADLs performed by Mary. Inthat period of time, we collected data for about 200 instances of activities. Weconsidered the same type of IADLs as for the smart home lab dataset. For thisexperimentation, the clinicians provided us with a set of fine-grained abnormalbehaviors to be detected, together with Mary’s time prescriptions for meals (i.e.,breakfast, lunch, and dinner) and medicines intakes. These anomalies are dividedin three levels of seriousness:22(a) Magnetic contact sensor on the fridge door(b) Passing a tagged medicine boxover the RFID reader(c) A board with temperaturesensor over the stove(d) Passive infrared presence sen-sor over the kitchen tableFigure 6: Part of the sensors deployed at the elderly’s home23(a) MLN-based method (used in FABER)(b) Random forests and naive aggregation (usedin SmartFABER)(c) Random forests and smart aggregation (usedin SmartFABER)Figure 7: Smart home lab dataset. Accuracy of activity boundary detection; n isthe length of the considered temporal sequence of sensor events• Green anomalies (low level). This type of anomalies occur when the in-dividual: prepares (G1) or consumes (G2) a meal at a different time thanprescribed.• Yellow anomalies (medium level). This type of anomalies occur when the in-dividual: misses to consume (Y1) or prepare (Y2) a meal; takes a prescribedmedicine outside the prescribed time (Y3); consumes (Y4) or prepares (Y5)the same meal multiple times during the same day.• Red anomalies (high level). This type of anomalies occur when the individ-ual: does not take a prescribed medicine (R1); takes a medicine that was notprescribed (R2).Totally, 605 anomalies were detected, most of them being green and yellow ones.24 0.7 0.8 0.9 112345accuracynprecisionrecallF1 score 0.7 0.8 0.9 112345678910accuracynprecisionrecallF1 score 0.7 0.8 0.9 112345678910accuracynprecisionrecallF1 score(a) MLN-based method (used in FABER)(b) Random forests and naive aggregation (usedin SmartFABER)(c) Random forests and smart aggregation (usedin SmartFABER)Figure 8: Real home dataset. Accuracy of activity boundary detection; n is thelength of the considered temporal sequence of sensor eventsFor the sake of this project, it was not feasible to directly observe the executionof the activities, except for limited periods of time during the setup of the system,due to obvious privacy reasons. Hence, we manually labeled most of the activi-ties offline, based on the observation of raw sensor data; this was possible sincethe considered activities are relatively easy to distinguish by a human observerbased on the collected sensor readings. We labeled the anomalies by executingtheir respective rule-based definitions on the dataset of sensor events and labeledactivities.5.3 Recognition of activity boundariesRecognizing (possibly approximate) activity boundaries is a prerequisite to detectanomalies. We performed an extensive experimental evaluation to compare Smart-25 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 112345accuracynprecisionrecallF1 score 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 112345678910accuracynprecisionrecallF1 score 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 112345678910accuracynprecisionrecallF1 scoreFABER with the preliminary method –named FABER– that was proposed in [3].For both datasets, we applied those activity recognition techniques:• The method used in FABER, which was based on Markov Logic Network(MLN) [35];• The machine learning algorithm used in SmartFABER with the naive aggre-gation algorithm;• The machine learning algorithm used in SmartFABER with the smart aggre-gation algorithm.For each technique, we performed a leave-one-day-out cross-validation, evalu-ating the prediction’s quality in terms of the standard measures of precision, recalland F1 score (the latter is the harmonic mean of precision and recall). This typeof cross-validation has also been preliminarily performed to select the most appro-priate classifier for the machine learning module of SmartFABER. We selected aRandom Forests classifier [36].Since the anomaly recognition technique relies on detected activity boundaries,we first needed to experimentally choose the value of parameter n, correspondingto the length of the temporal sequence of sensor events to be used by our algo-rithms. The results of activity boundary recognition on the smart home lab and realhome datasets are shown in Figures 7 and 8, respectively. With the smart home labdataset, very positive results have been achieved (with F1 score that exceeds 0.96)with all the three considered methods. With the MLN-based technique used inFABER, the highest recognition rate is achieved with n = 3. This means that, withthis dataset, the temporal sequence of the 3 most recent sensor events is sufficientto reliably detect the start or end of an activity. This is due to the quite repetitiveway in which activities have been executed in the lab; longer sequences of sensorevents may be needed when activities are executed in more variable ways. Valuesof n lower than 3 produce worse results, while larger values strongly increase theexecution times of the learning phase, without increasing recognition rates. Withthe new boundary detection method used in SmartFABER, the highest recognitionrates are achieved using with n = 2 or n = 3. The naive aggregation and thesmart aggregation methods achieve similar recognition rates; however, the formerproduces a larger number of false positives (i.e., detection of activity instances thatdid not actually occur), which may result in the recognition of several anomalies(especially repetitions of activities) that did not actually happen. On the contrary,the smart aggregation method provides more balanced and slightly higher valuesof precision and recall.In general, with the real home dataset we achieve lower recognition rates. Thisis due to the intrinsic variability of activity execution in a real-world situation,26with respect to the relatively stable activity execution patterns reproduced in thesmart home lab. Moreover, the level of sensor noise due to missing or incorrectsensor readings is inevitably larger in a real home environment than in the lab.With the real home dataset, the MLN-based method used in FABER is the leasteffective among the ones that we evaluated. The highest recognition rates withMLN are achieved with n = 5. We were not able to test the performance withlarger values of n, since the execution of the learning algorithm did not terminatein a reasonable amount of time. Independently from the value of n, the FABERmethod achieved particularly low values of recall; this could result in the detectionof several false anomalies related to missed execution of expected activities. Thetechnique used in SmartFABER achieves better results. In particular, the smartaggregation method leads to the highest values of F1 score (slightly above 0.8with n = 4), and very well balanced values of precision and recall. The naiveaggregation method achieves lower recognition rates, producing a large number offalse positives.Summarizing, with both datasets, the smart aggregation algorithm of Smart-FABER reduces the number of false positives with respect to the FABER method,and improves the overall accuracy.5.4 Recognition of fine-grained anomaliesWe performed experiments about anomaly recognition using the activity bound-aries detected by the different techniques with the most effective value of n.Table 3: Smart home lab dataset. Accuracy of abnormal behavior recognition withFABERANOMALYNC1: Repository left openNC2: Medicine not returnedNC3: Food item not cookedNC4: Meal not preparedC1: Missed a prescr. medicineC2: Took a wrong medicineC3: Repeated medicine intakeC4: Stove burner left onC5: Had meal with no silverwareC6: Prepared meal not consumedC7: Burner turned on by mistakeTOTALGROUP 1FP000220000004TP500000000005FN TP182402000100703000701080602GROUP 2FP000100000102FN00000000000027Table 4: Smart home lab dataset. Accuracy of abnormal behavior recognition withSmartFABER and smart aggregationANOMALYNC1: Repository left openNC2: Medicine not returnedNC3: Food item not cookedNC4: Meal not preparedC1: Missed a prescr. medicineC2: Took a wrong medicineC3: Repeated medicine intakeC4: Stove burner left onC5: Had meal with no silverwareC6: Prepared meal not consumedC7: Burner turned on by mistakeTOTALGROUP 1FP000000000000TP700000000007FN TP180402000100703000701080600GROUP 2FP100000000012FN000000000000Table 5: Smart home lab dataset. Results of fine-grained abnormal behavior recog-nition based on different boundary detection methodsTECHNIQUEFABER (MLN)SmartFABER-SmartAggregationPRECISION RECALLF1 SCORE0.9150.9710.9710.9420.985Detailed results with the smart home lab dataset are shown in Tables 3 and 4.The results of SmartFABER with the naive aggregation method are identical to theones obtained with the smart aggregation method; hence, we omit them. Each rowof the table corresponds to a specific anomaly considered in our experiments. TheTP column reports the number of true positives for that anomaly; i.e., the numberof actual occurrences of that anomaly that were recognized by the technique. FPreports the number of false positives; i.e., the number of anomalies reported by thetechnique that did not actually occur. FN reports the number of actual occurrencesof that anomaly that were not recognized by the technique.As anticipated, group 1 individuals performed a few non-critical anomalies(NC) and no critical anomaly (C). FABER correctly recognized 5 NCs out of 7.During the 7 days activities of group 1 individuals, the system did 4 false positives.Two of them regarded NC4 (meal not prepared), while the other two regardedC1 (missed a prescribed medicine). Those errors were due to mispredictions ofthe MLN-based activity boundary detection technique, which in two cases did notrecognize the occurrence of activity “preparing meal” and in two cases did not28recognize the occurrence of “taking medicine”. With SmartFABER we were ableto avoid the occurrence of both false positives and false negatives. This result wasdue to the high accuracy of activity recognition in the smart home lab environment.Group 2 individuals performed a larger number of NCs and several Cs. For thisgroup, FABER correctly recognized all the occurrence of both critical and non-critical anomalies; i.e., no false negatives happened. During the 14-days activitiesof that group, the system reported only 2 false positives: one was related to NC4(meal not prepared) and the other one to C6 (prepared meal not consumed). Evenin these cases, false positives were due to mispredictions of the activity boundarydetection technique. The performance of SmartFABER was comparable: all theanomalies were recognized, and only two false positives occurred.Overall, FABER produced 6 false positives during the 21-days activities, whileSmartFABER produced only 2 false positives. We claim that the number of falsepositives is compliant with the requirements of clinicians, especially consideringthat the individuals totally performed more than 150 instances of activities duringthe experimentation. Table 5 summarizes the results in terms of precision, recalland F1 score.Table 6: Real home dataset. Accuracy of abnormal behavior recognition withFABERANOMALY TP37G136G260Y141Y273Y31Y40Y529R1164R2441TOTALFP10214669432416175FN PREC. REC.0.3520.787680.4140.632510.8960.566710.37300.830.948150.1670.255/0000.6740.879140.9760.91140.7290.716164F1 SCORE0.4870.50.6940.5430.8850.2/00.7630.9430.722Results regarding the real home dataset are shown in Tables 6, 7, and 8, andsummarized in Table 9. The SmartFABER method with smart aggregation achievesthe best results in terms of F1; moreover, the measures of precision and recallare well balanced. Those measures are less balanced using the naive aggregationmethod, which achieves high recall (only a few actual anomalies were not recog-nized) at the price of low precision (several anomalies have been predicted by mis-take). This result depends on the fact that the naive aggregation method producesa relatively large number of false positives, which fire the recognition of several29Table 7: Real home dataset. Accuracy of abnormal behavior recognition withSmartFABER and naive aggregationANOMALY TP81G164G257Y129Y284Y35Y40Y540R1167R2527TOTALFP22549831824013322FN PREC. REC.0.7710.786240.7360.542230.8510.864100.7070.784120.9550.96640.8330.0271/0000.930.97630.9940.98210.8710.62178F1 SCORE0.7790.6240.8570.7440.960.052/00.9520.9880.725Table 8: Real home dataset. Accuracy of abnormal behavior recognition withSmartFABER and smart aggregationANOMALY TP70G147G260Y132Y275Y30Y40Y539R1167R2490TOTALFN PREC. REC.0.6670.543350.540.553400.8960.77970.780.65390.8520.926130/06/0/000.907140.9940.90810.810.761115F1 SCORE0.5980.5470.8330.7110.888/0/00.9510.9490.785FP59381717600017154Table 9: Real home dataset. Results of fine-grained abnormal behavior recognitionbased on different boundary detection methodsTECHNIQUEFABER (MLN)SmartFABER-SimpleAggregationSmartFABER-SmartAggregationPRECISION RECALLF1 SCORE0.7160.620.760.7290.8710.810.7220.7250.785anomalies about repetition of activities (Y4 and Y5). The F1 results with FABERand the MLN-based method are comparable with those of SmartFABER with naiveaggregation, but precision and recall are better balanced with the former.Overall, we can conclude that SmartFABER with smart aggregation achieves30the best results in terms of F1, obtaining a good balance between precision andrecall. A preliminary clinicians’ assessment of our system can be found in [34].6 Conclusions and future workIn this paper, we addressed the challenging issue of unobtrusively recognizing be-haviors exhibited by elderly persons at home that have been identified by cliniciansas relevant for the early diagnosis of MCI. Our SmartFABER hybrid techniqueto recognize abnormal behaviors differs from previous approaches for combiningsupervised learning with knowledge-based reasoning to more precisely recognizespecific anomalies in carrying out daily living activities. We designed the modelsof anomalies collaborating with cognitive neuroscience experts. Hence, instead ofidentifying only generic deviations from normal behavior as most related worksdo, we provide clinicians with a fine-grained description of the recognized abnor-mal behaviors identified as indicators of MCI. We implemented a prototype of thesystem in both a smart home lab and in the real home of an elderly person. Exper-iments with datasets of activities and anomalies show that SmartFABER achieveshigh recall while generating a small number of false positives.The achieved results are promising, but we plan to improve this work in severaldirections. Our current anomaly recognition method is based on logic rules thatstrictly determine the detection of an abnormal behavior based on a user-definedset of observations. We consider extending this rigid system with probabilisticreasoning. We are working on integrating data analysis tools in the dashboardoffered by the system to clinicians to automatise some of the reasoning that theycurrently do by looking at long term activity data. Other future work also includesaddressing the case of multi-inhabitants. Finally, we plan to work closely withclinicians to extend the set of activities and associated significant anomalies to bemonitored, and to extend the experiments to multiple real homes.AcknowledgmentsThis work has been partially supported by the project “SECURE: Intelligent Sys-tem for Early Diagnosis and Follow-up at Home”, funded by a grant of LombardyRegion and Italian Ministry of Education, University and Research.31References[1] B. Rechel, E. Grundy, J.-M. Robine, J. Cylus, J. P. Mackenbach, C. Knai, andM. McKee, “Ageing in the European Union,” The Lancet, vol. 381, no. 9874,pp. 1312–1322, 2013.[2] B. Winblad et Al., “Mild cognitive impairment - beyond controversies, to-wards a consensus,” J Intern Med, vol. 256, no. 3, pp. 240–246, 2004.[3] D. Riboni, C. Bettini, G. Civitarese, Z. H. Janjua, and R. Helaoui, “Fine-grained recognition of abnormal behaviors for early detection of mild cog-nitive impairment,” in Proc. of PerCom’15.IEEE Comp. Soc., 2015, pp.149–154.[4] M. C. A. Klein, N. M. Mogles, and A. van Wissen, “Intelligent mobile supportfor therapy adherence and behavior change,” J Biomed Inform, vol. 51, pp.137–151, 2014.[5] C. Parsey and M. Schmitter-Edgecombe, “Applications of technology in neu-ropsychological assessment,” Clin Neuropsychol, vol. 27, no. 8, pp. 1328–1361, 2013.[6] J. Ye, S. Dobson, and S. McKeever, “Situation identification techniques inpervasive computing: A review,” Pervasive Mob Comput, vol. 8, no. 1, pp.36–66, 2012.[7] O. Aziz, L. Atallah, B. P. L. Lo, E. Gray, T. Athanasiou, A. Darzi, andG. Yang, “Ear-worn body sensor network device: an objective tool for func-tional postoperative home recovery monitoring,” J Am Med Inform Assoc,vol. 18, no. 2, pp. 156–159, 2011.[8] H. Kalantarian, N. Alshurafa, T. Le, and M. Sarrafzadeh, “Monitoring eat-ing habits using a piezoelectric sensor-based necklace,” Comput Biol Med,vol. 58, pp. 46–55, 2015.[9] L. Bao and S. S. Intille, “Activity recognition from user-annotated accelera-tion data,” in Proc. of Pervasive Computing, ser. Lecture Notes in ComputerScience, vol. 3001. Springer, 2004, pp. 1–17.[10] R. Paradiso, G. Loriga, and N. Taccini, “A wearable health care system basedon knitted integrated sensors,” IEEE Trans Inf Technol Biomed, vol. 9, no. 3,pp. 337–344, 2005.32[11] J. Lester, T. Choudhury, N. Kern, G. Borriello, and B. Hannaford, “A hybriddiscriminative/generative approach for modeling human activities,” in Proc.of IJCAI, 2005, pp. 766–772.[12] O. Amft and G. Tr¨oster, “Recognition of dietary activity events using on-bodysensors,” Artif Intell Med, vol. 42, no. 2, pp. 121–136, 2008.[13] F. Baader, D. Calvanese, D. L. McGuinness, D. Nardi, and P. F. Patel-Schneider, Eds., The Description Logic Handbook: Theory, Implementation,and Applications. Cambridge University Press, 2003.[14] A. Agostini, C. Bettini, and D. Riboni, “Experience report: Ontological rea-soning for context-aware internet services,” in Proc. of IEEE PerCom Work-shops.IEEE Comp. Soc., 2006, pp. 8–12.[15] M. Richardson and P. Domingos, “Markov logic networks,” Mach Learn,vol. 62, pp. 107–136, 2006.[16] R. Helaoui, D. Riboni, and H. Stuckenschmidt, “A probabilistic ontologicalframework for the recognition of multilevel human activities,” in Proc. ofUbiComp. ACM, 2013, pp. 345–354.[17] F. D. Backere, F. Ongenae, F. V. D. Abeele, J. Nelis, P. Bonte, E. Clement,M. Philpott, J. Hoebeke, S. Verstichel, A. Ackaert, and F. D. Turck, “Towardsa social and context-aware multi-sensor fall detection and risk assessmentplatform,” Comput Biol Med, vol. to appear.[18] T. L. Hayesa, F. Abendroth, A. Adami, M. Pavel, T. A. Zitzelberger, andJ. A. Kaye, “Unobtrusive assessment of activity patterns associated with mildcognitive impairment,” Alzheimers Dement, vol. 4, no. 6, pp. 395–405, 2008.[19] A. M. Seelye, M. Schmitter-Edgecombe, D. J. Cook, and A. Crandall, “Natu-ralistic assessment of everyday activities and prompting technologies in mildcognitive impairment,” J Int Neuropsychol Soc, vol. 19, no. 4, pp. 442–452,2013.[20] P. N. Dawadi, D. J. Cook, M. Schmitter-Edgecombe, and C. Parsey, “Auto-mated assessment of cognitive health using smart home technologies,” Tech-nol Health Care, vol. 21, no. 4, pp. 323–343, 2013.[21] P. Dawadi, D. J. Cook, and M. Schmitter-Edgecombe, “Automated cogni-tive health assessment using smart home monitoring of complex tasks,” IEEETrans Syst Man Cybern, vol. 43, no. 6, pp. 1302–1313, 2013.33[22] P. Dawadi, D. J. Cook, C. Parsey, M. Schmitter-Edgecombe, and M. Schnei-der, “An approach to cognitive assessment in smart home,” in Proc. of the2011 DMMH Workshop. ACM, 2011.[23] D. J. Cook and M. Schmitter-Edgecombe, “Assessing the quality of activitiesin a smart environment,” Methods Inf Med, vol. 48, no. 5, pp. 480–485, 2009.[24] G. Virone, N. Noury, and J. Demongeot, “A system for automatic measure-ment of circadian activity deviations in telemedicine,” IEEE Trans BiomedEngineering, vol. 49, no. 12, pp. 1463–1469, 2002.[25] M. Skubic, R. D. Guevara, and M. Rantz, “Testing classifiers for embeddedhealth assessment,” in Proceedings of ICOST, ser. Lecture Notes in ComputerScience, vol. 7251. Springer, 2012, pp. 198–205.[26] F. Duchˆene, C. Garbay, and V. Rialle, “Learning recurrent behaviors fromheterogeneous multivariate time-series,” Artif Intell Med, vol. 39, no. 1, pp.25–47, 2007.[27] V. Jakkula and D. J. Cook, “Anomaly detection using temporal data miningin a smart home environment,” Methods Inf Med, vol. 47, no. 1, pp. 70–75,2008.[28] P. Rashidi and D. J. Cook, “COM: A method for mining and monitoring hu-man activity patterns in home-based health monitoring systems,” ACM TransIntell Syst Technol, vol. 4, no. 4, p. 64, 2013.[29] J. M. Juarez, J. M. Ochotorena, M. Campos, and C. Combi, “Spatiotempo-ral data visualisation for homecare monitoringof elderly people,” Artif IntellMed, vol. to appear.[30] A. Burns, B. Lawlor, and S. Craig, “Rating scales in old age psychiatry,” BrJ Psychiatry, vol. 180, pp. 161–7, 2002.[31] N. C. Krishnan and D. J. Cook, “Activity recognition on streaming sensordata,” Pervasive Mob Comput, vol. 10, pp. 138–154, 2014.[32] P. Norvig and S. Russell, Artificial Intelligence. A Modern Approach. Pren-tice Hall Series in Artificial Intelligence, 2003.[33] E. Denti, A. Omicini, and A. Ricci, “Multi-paradigm java-prolog integrationin tuprolog,” Sci Comput Program, vol. 57, no. 2, pp. 217–250, 2005.34[34] D. Riboni, C. Bettini, G. Civitarese, Z. H. Janjua, and V. Bulgari, “From labto life: Fine-grained behavior monitoring in the elderly’s home,” in Proc. ofPerCom Workshops.IEEE Comp. Soc., 2015.[35] M. Richardson and P. Domingos, “Markov logic networks,” Mach Learn,vol. 62, pp. 107–136, 2006.[36] L. Breiman, “Random forests,” Mach Learn, vol. 45, no. 1, pp. 5–32, 2001.35