Joint volumetric extraction and enhancement ofvasculature from low-SNR 3-D fluorescence microscopyimagesSepideh Almasi1,∗, Ayal Ben-Zvi2,3, Baptiste Lacoste4, Chenghua Gu2,Eric L. Miller1, and Xiaoyin Xu51Department of Electrical and Computer Engineering, Tufts University, Medford, MA,USA2 Department of Neurobiology, Harvard Medical School, Boston, MA, USA3 Department of Developmental Biology and Cancer Research, Institute for MedicalResearch IMRIC, Hebrew University of Jerusalem, Israel4 Department of Cellular and Molecular Medicine, University of Ottawa Brain and MindResearch Institute, The Ottawa Hospital Research Institute, Neuroscience Program,Ottawa, ON, Canada5Department of Radiology, Brigham and Women’s Hospital, Boston, MA, USA.*sepideh.almasi@alumni.tufts.eduAbstractTo simultaneously overcome the challenges imposed by the nature of op-tical imaging characterized by a range of artifacts including space-varyingsignal to noise ratio (SNR), scattered light, and non-uniform illumination,we developed a novel method that segments the 3-D vasculature directlyfrom original fluorescence microscopy images eliminating the need for em-ploying pre- and post-processing steps such as noise removal and segmenta-tion refinement as used with the majority of segmentation techniques. Ourmethod comprises two initialization and constrained recovery and enhance-ment stages. The initialization approach is fully automated using featuresderived from bi-scale statistical measures and produces seed points robustto non-uniform illumination, low SNR, and local structural variations. Thisalgorithm achieves the goal of segmentation via design of an iterative ap-proach that extracts the structure through voting of feature vectors formedby distance, local intensity gradient, and median measures. Qualitative andquantitative analysis of the experimental results obtained from synthetic andreal data prove the efficacy of this method in comparison to the state-of-the-art enhancing-segmenting methods. The algorithmic simplicity, freedomPreprint submitted to Pattern RecognitionJune 1, 2016© 2016. This manuscript version is made available under the Elsevier user licensehttp://www.elsevier.com/open-access/userlicense/1.0/from having a priori probabilistic information about the noise, and struc-tural definition gives this algorithm a wide potential range of applicationswhere i.e. structural complexity significantly complicates the segmentationproblem.Keywords:Image enhancement, Three-dimensional vasculature segmentation,Non-uniform illumination, Fluorescence microscopy.1. IntroductionTubular networks are one of the fundamental structures in biological andmedical studies. They are found in the skeletal structures, nerve fibers, sys-tems for propagating gases (intrathoracic airway trees) and fluids (vascularand microvascular networks), and are subject of extended studies [1, 2, 3, 4].When imaging, it is of crucial importance to devise efficient segmentationmethods that deliver an accurate platform for further analysis such as bi-furcation detection, centerline approximation, or shape matching operations.The work in this paper focuses on the volumetric extraction of interconnectedtubular structures from various forms of biological imagery with specific ap-plication to vascular networks.Common to vascular detection methods, an initial stage is necessary to de-noise, enhance, and binarize the raw data [5, 6]. Segmentation of vasculatureis of high importance for quantitative analysis and visualization purposes indiverse fields of study such as neuroscience [7] and tumor monitoring [8]. Thesegmented data set provides a means to extract crucial quantitative informa-tion about the vasculature such as surface areas, diameters, tortuosities, andbranching patterns of vessels. It also can serve as a platform for performingfurther advanced processing [2].Of particular interest to us is the case of cortical microvasculature de-termination in murine models from 3-D fluorescence microscopy data stacksthat manifest vessels of low tortuosity. This data of interest indeed calls forpre-processing as accurate and fast segmentation and volumetric reconstruc-tion of the complex microvasculature networks from fluorescence microscopyimages faces challenges owing to the existence of numerous imaging artifactsshown in Figure 1: uneven illumination, non-homogenous intensity distri-bution inside the vessels, low SNR regions, high spatial density or closenessof vessels, reduced contrast at edges, broken or faint vessels, and low fre-2Figure 1: In this maximum intensity projection of 3-D fluorescence microscopy imageof murine cranial tissue, miscellaneous imaging artifacts are visible: uneven illumination(upper vs. lower parts), non-homogenous intensity distribution inside the vessels (visible inthe larger vessels located at top right corner), low SNR regions (lower areas), high spatialdensity or closeness of vessels (majorly in the center-upper parts), reduced contrast at edges(visible as blurs mostly for the central vessels), broken or faint vessels (lower vessels), andlow frequency background variations caused by scattered light (at higher density regions).quency background variations caused by scattered light [5, 9]. The noisestems from several sources such as stochastic photon counting, thermal andelectrical fluctuation in the imaging device, biological background, and non-uniform fluorophore distribution [9, 10]. Many of these problems are relatedto the photon counting nature of the imaging system. For that matter, theimage quality is directly determined by the number of detected photons thatis in turn controlled by the exposure time which has to be limited to pre-serve the health of the specimen as excessive fluorophore excitation causescell phototoxicity and photobleaching [11]. Thus, lower number of detectedphotons results in an SNR reduction in the obtained images. Also, imagesof poorly stained samples are likely to show structural irregularities such asvessel breakage [12].These issues result in two challenges: (1) identifying the smaller struc-tures along with their connectivity (breakages are prevalent for these cases)and (2) the recovery of larger vessels that tend to be surrounded by heavyimaging artifacts making the boundaries more difficult to perceive (over seg-mentation is an issue). Therefore, developing segmentation algorithms that3can overcome imaging artifacts, are robust to the imaging artifacts and struc-tural variations is of great importance.Several studies have been done on the subject of vascular or in gen-eral term tubular structures segmentation for different imaging modalities[2, 13, 14]. They include methods such as active contours [16, 17], geo-metric model-based techniques [18, 19], or region growing approaches [20],tracking [21], and template-based methods [22]. Tracing-based algorithmswork by following vascular segments starting from some initial seed points.These methods fail at recovering broken vessels and are highly dependent onthe seed point selection. Matched filtering based approaches model the ves-sel structure as the intensity-ridges of a multiscale vesselness function [23].These algorithms are susceptible to outliers and are not robust to noise [24].Active contour approaches are flexible in terms of finding the intricate vesselshapes. However, they are prone to leakage into the background where edgeshave low contrast. This property can drastically undermine the performanceof active contours where the segmented structure is dense and leakage willlead to merging of separate vessels. A popular region accumulation approachis the watershed transform, but this approach can result in over segmentationand requires further processing [25]. The method proposed in [26] that usesa combination of clustering and classification techniques to segment vascu-lature segments vasculature suffers from broken vasculature and requires alinking post processing. Also, its parameters are selected regardless of thestructures size and undermine the performance of segmentation in networksof varying size vasculature. Finally, model-based methods require a priorinformation on the vascular structures [2]. Therefore, developing an efficientalgorithm that can jointly retrieve microvascular volume and remove noisefrom data is necessary.We have developed a new iterative region growing algorithm that is ableto provide precise segmentation directly from the raw data without the pre-processing requirement of denoising or other image enhancing operations.The iteration starts with a robust initialization scheme that is unbiased tothe non-uniform illumination or lower SNR conditions and is based on localstatistical analysis of image intensities. A full segmentation is achieved byiteratively augmenting the seed points through classifying/voting of featurevectors formed by voxels location, local intensity gradient, and non-linearstatistical measures information such as median level.We perform vessel segmentation with the following contributions. First,we remove a priori probabilistic noise model and geometrical (such as cur-4vature or branching pattern about the vessels except for the local diameter)assumptions. Then, a set of features derived from bi-scale statistical mea-sures are defined and used to robustly (invariant to non-uniform illumination,low SNR, and local structural variations) and automatically derive the seedpoints. Finally, the segmentation algorithm is designed to directly restorethe vasculature and simultaneously reject the imaging artifacts for enhance-ment. This method is automatic and does not require manual interaction.Collection of these features allows us to obtain an accurate segmentationfrom the 3-D fluorescence microscopy data. Experimental results obtainedfrom synthetic and real datasets confirm that the proposed algorithm greatlyimproves upon the previous segmentation methods performed on vasculaturedata.The remainder of this paper is organized as follows.In Section 2, wepresent the proposed segmentation technique in two parts of initializationand vessel recovery method. Section 3 presents the segmentation evalua-tion results obtained from synthetic (quantitative in terms of sensitivity andspecificity) and real data (qualitative). The segmentation performance iscompared to state-of-art methods using real fluoroscopic data in this section.Finally, Section 4 concludes the paper and indicates the possible future pathsfor continuing this study.2. MethodologyThis section explains the basics of vessel extraction process given in theAlgorithm 1 and termed as Constrained Region Evolutionary Vessel Enhance-ment and Recovery (CREVER). There are two primary components to thisprocess: initialization and vessel recovery. The basis of the extracted struc-ture is founded in the initialization stage. Then, the full vasculature is builtrecursively in the vessel recovery part. The details of each of these parts areprovided in the following subsections.2.1. NotationThe notations in Table 2 will be used for the rest of paper:2.2. InitializationAs shown in the pipeline of Figure 2 and Algorithm 1, we propose a twoscale kernel-based method to determine a set of seed points. The initializa-tion is based on comparing patch-based statistical measures that have been5Table 1: Notations used for the vessel recovery process.Iρ1ρ2msml∇(cid:3).(cid:3)⊕(cid:5)sph1Grayscale imageSmallest radius of all the vesselsLargest radius of all the vesselsMedian filtered I by small scale kernelsMedian filtered I by large scale kernelsFirst order finite difference approximation to gradient operatorEuclidean distanceMorphological dilationMorphological erosionSpherical structural element of radius 1proved to outperform the higher level features in structural classification ofimages [28]. This approach is similar to the ideas in [27] where signals aredetected by thresholding mean-to-mean ratio of different kernels. However,the complex nature of artifacts in the data of interest calls for a more effec-tive measure. Rank-ordered statistical filters are an efficient choice here fortheir robustness (effectiveness in suppressing Poisson and shot noise [29]) andlow computational cost. The most well-known of this group is the medianfilter that is resilient measure of central tendency to outliers. This propertyallows them to be used directly on the original data as a means for findingthe local dominant intensity. Advantageously, median filters balance noisereduction and over smoothing which is an inevitable by-product of majorityof the denoising methods esp. linear filters that causes blurred edges and low-ered contrast [30]. We have observed that median values of concentric kernels(cubes) of two different scales (side length) differ markedly if the center pointis located on the microvasculatures. Microvasculature is of a spatially sparseBi-scaleBFeatureFExtractionEk-means kClusteringClU U UUMMedian FilteringFMaximum MFilteringFSeed PointsFigure 2: The pipeline of initialization stage.6A. Bright VesselB. Noisy BackgroundC. Faint VesselD. Dark BackgroundNs (p). ms. Nl (p)mlmsml. ms. mlmsmlFigure 3: Four different classes of voxels observed in the original data are indicated here:Bright vessel (A), noisy background (B), faint vessel (C), and dark background (D). His-tograms for the intensity distribution and the median value of the points located in the sand l-scale kernels are shown on the right side. For these histograms, dark values corre-spond to the left edge of the abscissa and light values for the right edge. Diamond toppedbars mark median values on the histograms. Distinguishable comparative situation ofmedian values is used as the basis for detecting relevant structures.structure, thus the median value of the smaller kernel ms even if the vesselsare faint in intensity will be significantly higher than the median value of thelarger kernel ml in which lower intensity background voxels will dominate.Therefore, this feature is robust to non-uniform illumination where medianof kernels are analyzed locally.Four cases of bright vessel (A), noisy background (B), faint vessel (C), anddark background (D) are specified on maximum intensity projection (MIP)of a 3-D image in Figure 3 to illustrate this intuition. Histograms for the in-tensity distribution of the points located in the kernels of scales s (small) andl (large), s < l, are shown on the right side of the figure where median valuesare marked by blue and red diamond topped bars for small and large scalekernels. For background points, these values either do not differ considerablyor the median in the larger neighborhood exceeds the smaller neighborhoodin the proximity of other microvasculature. Therefore, the ratio obtainedfrom the median filtered images using kernels of s × s × s and l × l × lsize, centered on voxels (x, y, z) ∈ I, where ml(x, y, z) (cid:7)= 0 delivers a well-separable set of feature points by clustering of which one can obtain robustseed points Γ0 regardless of the mixed-noise, non-uniform illumination, andother imaging artifacts. One example of this ratio that is calculated for 2-Dslice of the image in Figure 3 is shown in Figure 4. According to this figure,dimmer vessels especially in the lower and upper left corners have receivedlarger mslevels (visualized by larger intensity values). Non-uniformity ofvessel sizes and noise variance over the data gives a range of values to thems(x,y,z)ml(x,y,z) ratio. However, a good selection of s and l ensures the least overlapbetween the clusters. Here, s and l are selected based on the vessel radiusml7240220200180160140120Figure 4: The msmland l × l × l size for pixels with ml (cid:7)= 0.ratio obtained from the median filtered images using kernels of s × s × smeasurements obtained from the image I. The s is set as the smallest vesselradius, ρ1, to ensure the preservation of small structures. In order to balancelocality and inclusiveness, l is chosen as twice the largest vessel diameter,4ρ2. This amount allows for the incorporation of enough background andvasculature in the larger box. The radius at each foreground point in I isestimated by means of the method used in [31]. We first compute the ratiofor all points, run k-means (k = 2) clustering [32], then set the Γ0 as thevoxels in of the larger centroid cluster. Finally, to guarantee the structuralenhancement besides recovery of faint vessels, Γ0 is augmented by inclusionof the points that are located in the brightest regions as they may not passthe 2-means thresholding in the highly noisy regions (where ml is also large):Γ0 = Γ0 ∪ {(x, y, z)|ms(x, y, z) = max(ms)}.(1)2.3. Region growing structure retrievalGiven the detected seed points, we extract the entire volume througha region-growing method that simultaneously rejects imaging imperfections.This method recursively extracts the structure from raw data and eliminatesthe need for pre-processing operations such as enhancement or denoising.This method is based on the observation that local median intensity in cubickernels typically decreases as kernel moves away from the vasculature’s cen-terline. Figure 5 illustrates this claim on the mesh plot of a 2-D grayscale im-age slice of microvasculature. The structured ridges marked by the brightestshades belong to the microvasculature. The brightness decreases smoothly bymoving radially from the vessels centerlines. The intensity drops abruptly atthe blood vessels boundaries where the desirable segmentation stops proceed-ing. Thus, the method as described in Algorithm 1, directs the segmentation8 along the areas with smoothest decreasing local intensity median value untilreaching a sharp intensity drop that is detectable by the gradient feature.This is performed via voting for the voxels in the immediate 3-D neighbor-hood (maximum of 1-voxel distance in every direction) of the retrieved regionthat show similar statistical properties in terms of median value in their cu-bic vicinity, at each iteration.More formally, with ms the median image value in all s × s × s kernels, wefirst form a sequence with monotonically decreasing order from max(ms) tomin(ms) with unit step size. This sequence is shown with δ1 = max(ms), δ2,. . . , δn = δn−1 − 1, . . . , δN = min(ms) in the CREVER pseudocode at line5. The number of iterations, N , is determined by the largest and smallestvalues of ms in the given image such that N = max(ms) − min(ms) + 1.The CREVER starts segmentation at iteration 0 from the seed points, Γ0,obtained from the grayscale image I, and refines Γn until reaching the N thiteration. At the nth iteration, new voxels are classified/voted as part of thestructure when their attributes satisfy three constraints: adjacency to theretrieved regions, having median intensity of equal or greater than the onedetermined by the iteration number (ms ≥ δn), and having a low normalizedabsolute gradient value (Ig = |∇ms|(cid:4)ms(cid:4) < τ ) (line 10) where∇ms = ∂ms∂xˆi + ∂ms∂yThe last criterion prevents leakage across vessel boundaries. Finally, toavoid missed detections caused by imaging artifacts in the microvasculature,retrieved regions are morphologically closed at each step using a sphericalˆj + ∂ms∂z(2)ˆk.Figure 5: Mesh plot of a 2-D slice of a locally median filtered fluorescence microscopyimage. Structured ridges marked by the brightest shades belong to the microvasculature.9Algorithm 1 CREVERInputs: Grayscale image I, ρ1, and ρ2Initialization:1: ms ← Median of I in s × s × s kernels2: ml ← Median of I in l × l × l kernels3: Γ0 ← 2 − means clustered( ms), ml (cid:7)= 0ml4: Γ0 ← Γ0 ∪ {(x, y, z)| ms(x, y, z) = max(ms)}5: Sequence: δ1 = max(ms), δ2, . . . , δi = δi−1 − 1, . . . , δN = min(ms)6: n ← 17: Ig = ∇ms(cid:4)∇ms(cid:4)8: while n < N do9:Γn ← Γn−1 ∪ {(x, y, z)|ms(x, y, z) ≥ δn+1, (cid:3)Γn−1, (x, y, z)(cid:3) ≤√3, |Ig(x, y, z)| < τ }Γn ← (Γn ⊕ sph1) (cid:5) sph1n ← n + 110:11:12: end13: IB ← ΓN −1 > 0Output: Binary Image IBstructuring element of radius one, sph1, (line 11). Finally, the segmented im-age, IB, is obtained by thresholding the retrieved region at the last iteration,ΓN −1, with 0. Selection of τ has an important role in the method’s overallperformance. For a small τ , region growing will be halted prematurely, andsome regions will be missed. On the other hand, for a τ that is too large,many of the noisy background voxels will be included in the retrieved vascu-lature. This parameter is set as the mean of two clusters centroids found bythe 2-means clustering of Ig to avoid either of these deficiencies.Figure 6 shows an example of the microvasculature segmentation via theCREVER method for a 2-D slice of a three dimensional fluorescence mi-croscopy image from iteration 0 (seed points) to the last iteration. Thefinal image demonstrates the accurate recovery of structures from noisy, ar-tifacted, and low contrasted areas. To be specific, the results obtained for thelower left part of the image supports this claim. Inhomogeneous illuminationgreatly lowers the visibility of the vasculature in this part that is the reasonof being missed by other denoising-segmenting methods as it will be shownin Section 3.2. Since the computations are done in cubic kernels, some ofthe structural content from the above and below slices of the current one10are included in the enhancement process, which is the reason for having aslightly more complete structure than the original image in the final result.Processing in the cubic regions is the key feature of CREVER in reducingvessel breakages and improving the accuracy.3. ExperimentsIn this section, efficiency of the proposed method is assessed first by usingthe quantitative performance measures. Next, the vessel enhancement poweris qualitatively shown and compared with those of other combination of meth-ods using 3-D fluorescence microscopy images of murine samples. Finally, weinvestigate the effect of parameter selection on the proposed method’s per-formance.3.1. Quantitative analysisTo conduct the quantitative evaluations, a set of synthetic images aregenerated by corrupting a single structure with varying amounts of noise toOriginal Image 0% 25% 50% 75% 100% Figure 6: A slice of an original 3-D fluorescence microscopy image, seed points, recoveredmicrovasculature at 25, 50, 75, and 100% of the CREVER method’s development.11Figure 7: Left: MIP of synthetic image with PSNR= 5 dB. Right: the segmentationobtained by the CREVER method.simulate different PSNRs. In detail, a synthetic image is formed by devel-oping an interconnected tubular network from a specific ground truth graphsimilar to the approaches discussed in [33] using the same parameter values.This structure is shown on left side of Figure 7. The volume obtained fromCREVER is provided on right side of the Figure 7. Different shades presentin this demonstration of the binary data are resultant of the 3-D renderingapproach. To achieve a target P SN R (peak signal-to-noise ratio), a commonapproach in Poisson noise assessment literature [10, 34] is used that is basedon scaling the maximum intensity of image defined asP SN R = 10 log10(cid:3)(cid:2)I 2maxM SE(db)(3)with MSE being the mean square error between the noisy and noise-free ver-sions. For the following experiments, P SN R levels are changed from 2 to15 dB in ten steps. For each PSNR, experiments are repeated ten times andthe average is reported as final result.The performance of the CREVER is evaluated and compared with threestate-of-the-art EM-based (expectation maximization) [35], graph-cut [36],and level-set [16] segmentation methods. These methods are tuned via ex-haustive searching of optimal parameters to deliver their best performancefor the given data sets.As performance measures, true positive rate (T P R) or sensitivity andfalse positive rate (F P R) or (1-specificity) calculated as belowT P R = Number of correctly detected foreground voxelsNumber of true foreground voxels,F P R = Number of falsely detected foreground voxelsNumber of true background voxels(4)12are used to draw the receiver operating characteristic (ROC) curves of thesemethods, shown in Figure 8, applied to the synthetic data. Results sug-gest that CREVER is superior in performance having the largest area undercurve (AUC). Besides a high level of T P R, this method performs very wellin rejecting background artifacts as measured by low false positive rates.Level-set method provides the next best performance behind CREVER. TheEM-based and graph-cut segmentations perform inferior to the CREVER.To further emphasize the power of the CREVER method, accuracy of theretrieved vascular networks edges has been measured in terms of average dis-placement. Varying P SN R level over the structure in Figure 7 forms the syn-thetic datasets. The obtained edge points are determined as the foregroundvoxels with at least one background voxel in their 8-neighborhood. Then,they are matched to ground truth edge points via the Hungarian bipartitematching algorithm with Euclidean distance-based cost matrix. The averagedisplacement is calculated as the average distance between all the pairs ofcorresponded points in voxel scale and provided in Table 2 for four datasets.The results start from a satisfactory level of 1.63 voxel for P SN R = 2 andincrease as the noise level rises. Given the radius range in testing data (10-20voxels), the results prove the accuracy of the segmentation boundaries andstability of the method against the noise.RPT10.80.60.40.200CREVERLevel-setEMGraph-cut0.20.40.60.81FPRFigure 8: The ROC curves obtained using CREVER (the proposed method), level-set,EM-based, and graph-cut segmentation methods using synthetic images with PSNRs inthe range of 2 to 15 dBs.13Table 2: Accuracy measure for detected edge pointsDatasetPSNR (dB)Average displacement (voxel)181.63261.97343.74425.313.2. Comparative qualitative analysisQualitative validation of the proposed algorithm has been completed byapplying it to three sets of 3-D vascular images from murine nervous tis-sue. Testing datasets were selected such that they show a range of structuraland noise properties. To generate these data, heterozygous Plexin-D1-fGFPtransgenic mice were used to visualize GFP-expressing developing blood ves-sels in the embryonic thalamus. All animals were maintained and treatedwith approved Institutional Review Board protocol according to the NationalInstitutes of Health guidelines and approved by the Institutional Animal Careand Use Committee at Harvard Medical School. Three dimensional vascularimages (z-stacks) were acquired using a Leica LSM 510 META confocal mi-croscope in embryonic thalamus. The SNR of images ranges from 3 to 7 dBroughly.The first image, of size 200 × 450 × 50 voxels, is shown in Figure 9(a) withMIP where the MIP of its segmentation obtained by the CREVER methodis also shown in Figure 9(b). The next data is obtained from a more homoge-nous (in vessel shape and size senses) microvascular network. However, thenoise distribution differs markedly throughout the image as apparent fromFigure 9(c). This image is of size 500 × 500 × 45 voxels. The segmented im-age is shown in Figure 9(d). This image has been collected from a thinly cutlayer of tissue, thus isolated points are formed from recovery of those partialstructures. The last dataset that is of size 400 × 400 × 50 voxels incorporatesa spatially dense microvascular network with high noise content apparent inthe original image shown in Figure 9(e). However, the segmentation pre-sented in Figure 9(f) proves stability of the CREVER in presence of strongnoise and artifact elements. The CREVER method has recovered the vascu-lature regardless of its local statistical variations, noise level, and structuralproperties such as vessel radius measure. Considering all cases, it is obviousthat the proposed method produces an overall high quality segmentations ofmicrovasculature from 3-D fluorescence microscopy images. It well preservesthe structural specifications such as continuity and smoothness of the vesselboundaries while noticeably removing imaging artifacts and noise.14(a) (b) (c) (d) (e) (f) Figure 9: Left side: The MIPs of real data sets. Right side: the segmentations obtainedvia the CREVER method.15(a)(b)(c)(d)Figure 10: Segmentation of Figure 6 obtained via the (a) CREVER applied to the rawdata and (b) EM segmentation, (c) graph-cut, and (d) level-set methods initialized on thebackground subtracted image.Carrying on to the qualitative evaluation of CREVER, it is compared withthe three segmentation algorithms of EM-based (expectation maximization),graph-cut, and level-set methods applied to the back-ground subtracted ver-sion of the image shown in Figure 6(a). Background subtraction is performedthrough the temporal median filtering [37] of the image stacks at the scaleof the largest vessel in each dataset. The results presented in Figure 10suggest the superiority of the CREVER method especially for small or low-resolution structures such as those in the left and lower left parts of theimages marked by a red dashed circle. CREVER recovers the vasculaturein a more non-selective manner regarding illumination uniformity, contrastlevel, and vascular size and is more robust to image artifacts. It also outper-forms the other methods in retrieving the vasculature of low P SN R partssuch as those located in the center of the image. The level-set method per-forms well in this region; however, it shows higher false negative rates forsmaller branches. The EM-based method retrieves more structure comparedto the graph-cut method where the graph-cut method performs with higheraccuracy in terms of false positive rateThe computational complexity of the CREVER method is dominated bythe median filtering’s cost that is in turn dependent on the larger kernel size,O(l3). Since l is dependent on the largest vessel radius in the given data,computational complexity is consequently relative to the imaged tissue’s vas-culature measure. The iterations count in the CREVER part however, is dataindependent and is bounded by the maximum voxel intensity of the data. Fi-nally, this method scales to data of arbitrary size as all the operations areparallelizable for disjoint partitions from an image.16ˆs = 1(= ρmin ), ˆl = 15(≈ 4 ×ρmax )l = 110.80.60.40.2020015l10105sFigure 11: Mesh plot of the ACC obtained from segmentations of the synthetic image inFigure 7(a) vs. s and l.3.3. Parameter analysisIn section 2.2, it was shown that parameters s and l are set by approx-imations of the smallest and largest vessel radii. Here, we show that theseassignments are optimal and show that deviation from these values deterio-rates the performance. Figure 11 shows the mesh plot of the segmentationaccuracy (ACC) metric defined asACC =T P R + T N RT P R + T N R + F P R + F N R(5)where T N R and F N R are true and false negative rates. The ACC is mea-sured over the segmentations obtained from the synthetic image in Figure7(a) vs. varying s and l values where vessel radius ranges from 1(= ρ1)to 4(= ρ2) in the synthetic image. This plot shows that the best ACC isachieved when the parameters are around the same ratio of the vessel radiias discussed in Section 2.2, s = 1(= ρ1) and l = 15(≈ 4 × ρ2).4. ConclusionThis paper addresses the segmentation problem of 3-D vascular networks.Acquiring high quality segmentation of these structures is essential for post-processing operations like centerline extraction and quantitative shape anal-ysis. A novel iterative algorithm is proposed that is based on a bi-scale filter-ing scheme. The proposed method is tested on the fluorescence microscopy17images of the murine cranial microvasculature. These images manifest mis-cellaneous types of noise, varying SNRs, uneven contrast, and structural com-plexity that prove to be challenging for existing segmentation methods evenwhen they process denoised and pre-processed data. Our method iterativelyretrieves the vasculature and robustly builds the structural pattern of inter-est while rejecting the imaging artifacts. The search algorithm uses a greedyapproach which selects the locally optimal voxels that are in compliance withthe structure at each iteration. These voxels are the points for which the ra-dial distance and standard intensity deviation are in the acceptable rangefrom the given retrieved region. Evaluations on real fluorescence microscopyand synthetic data show that the presented method has high specificity andsensitivity while it outperforms state-of-the-art methods. Without loss ofgenerality, this method is applicable to images of two dimension and withless computational complexity. Also, the algorithm can be adapted for dif-ferent imaging modalities with different probabilistic models of noise. Thesegmentation method can generalized to images of other tubular shapes in-cluding neurons and retina’s vasculature with some modifications such asintensity scaling.AcknowledgementsThe authors would like to thank the Enhanced Neuroimaging Core atHarvard NeuroDiscovery Center for helping with confocal imaging. We alsothank Dr. Yutaka Yoshida from Cincinnati Childrens Hospital for provid-ing the Plexin D1-fGFP mouse. This work was supported by the NationalScience Foundation award 0958345 (S.A. and X.X.), the Goldenson post-doctoral fellowship (A.B.-Z.), the Harvard/MIT Joint Research Grants Pro-gram in Basic Neuroscience (X.X., B.L., and C.G.), NIH grant R01LM011415(X.X.), United States.References[1] M. Jackowski, X. Papademetris, L.W. Dobrucki, A.J. Sinusas, L.H.Staib, “Characterizing vascular connectivity from microCT images,”Med. Image Comput. Comput.-Assisted Intervention (MICCAI), ( 2005)701–708.18[2] D. Lesage, E.D. Angelini, I. Bloch, and G. Funka-Lea, “A review of 3Dvessel lumen segmentation techniques: Models, features and extractionschemes,” J. Medical image analysis, 13(6), (2009) 819–845.[3] J. Kim, W.J. Oh, N. Gaiano, Y. Yoshida, C. Gu, “Semaphorin 3E-Plexin-D1 signaling regulates VEGF function in developmental angio-genesis via a feedback mechanism,” Genes Dev 25, (2011) 1399–1411.[4] P. Blinder, P.S. Tsai, J.P. Kaufhold, P.M. Knutsen, H. Suhl, D. Klein-feld, “The cortical angiome: an interconnected vascular network withnoncolumnar patterns of blood flow,” Nat. Neurosci. (16), (2013) 889–897.[5] P. Sarder and A. Nehorai, “Deconvolution methods for 3-D fluorescencemicroscopy images,” IEEE Signal Processing Magazine 23(3), ( 2006)32–45.[6] J.S. Suri, K. Liu, L. Reden, and S. Laxminarayan, “A review on MRvascular image processing algorithms: acquisition and prefiltering: partI,” IEEE Trans. Inform. Technol. Biomed, 6, (2002) 324–337.[7] R. Wang, C. Li, J. Wang, X. Wei, Y. Li, Y. Zhu, and S. Zhang, “Thresh-old segmentation algorithm for automatic extraction of cerebral vesselsfrom brain magnetic resonance angiography images,” J. neurosciencemethods, 241, (2015) 30–36.[8] F. Kording, C. Weidensteiner, S. Zwick, N. Osterberg, A. Weyerbrock,O. Staszewski, D. Elverfeldt, and W. Reichardt, “Simultaneous assess-ment of vessel size index, relative blood volume, and vessel permeabilityin a mouse brain tumor model using a combined spin echo gradient echoecho-planar imaging sequence and viable tumor analysis,” J. MagneticResonance Imaging, 40(6), (2014) 1310–1318.[9] J. Boulanger, C. Kervrann, P. Bouthemy, P. Elbau, J.B. Sibarita, andJ. Salamero, “Patch-based nonlocal functional for denoising fluorescencemicroscopy image sequences,” IEEE Transactions on Medical Imaging29(2), (2010) 442–454.[10] F. Luisier, T. Blu, and M. Unser, “Image denoising in mixed Poisson-Gaussian noise,” IEEE Transactions on Image Processing 20(3), (2011)696–708.19[11] P. M. Carlton, J. Boulanger, C. Kervrann, J.B. Sibarita, J. Salamero,S. Gordon-Messer, D. Bressang, J.E. Haberg, S. Haaseh, L. Shaoa,L. Winotoa, A. Matsudaa, P. Knera, S. Uzawai, M. Gustafssona, Z.Kamj, D.A. Agard, and J. W. Sedat, “Fast live simultaneous multi-wavelength four-dimensional optical microscopy,” Proceedings of theNational Academy of Sciences, 107(37), (2010) 16016–16022.[12] J.G. White, W.B. Amos, and M. Fordham, “An evaluation of confocalversus conventional imaging of biological structures by fluorescence lightmicroscopy,” The Journal of cell biology, 105(1), (1987) 41–48.[13] S.D. Olabarriaga and A.W. Smeulders, “Interaction in the segmentationof medical images: A survey,” J. Medical image analysis 5(2), (2001)127–142.[14] C. Kirbas and F. Quek, “A review of vessel extraction techniques andalgorithms,” ACM Computing Surveys (CSUR) 36(2), (2004) 81–121.[15] S. Olabarriaga, M. Breeuwer, and W. Niessen, “Minimum cost pathalgorithm for coronary artery central axis tracking in CT images,” Med.Image Comput. Comput.-Assisted Intervention (MICCAI), (2003) 687–694.[16] T.F. Chan and L.A. Vese, “Active contours without edges,” IEEE Trans-actions on Image Processing 10(2), (2001) 266–277.[17] P. Yan and A.A. Kassim, “MRA image segmentation with capillaryactive contours,” Med. Image Anal. 10(3), (2006) 317–329.[18] X. Qian, M.P. Brennan, D.P. Dione, W.L. Dobrucki, M.P. Jackowski,C.K., Breuer, A.J. Sinusas, and X. Papademetris, “A non-parametricvessel detection method for complex vascular structures,” Medical imageanalysis 13(1),(2009) 49–61.[19] V. Mahadevan, H. Narasimha-Iyer, B. Roysam, and H.L. Tanenbaum,“Robust model-based vasculature detection in noisy biomedical images,”Information Technology in Biomedicine, IEEE Transactions on 8(3),(2004) 360–375.[20] S. Eiho, H. Sekiguchi, N. Sugimoto, T. Hanakawa, and S. Urayama,“Branch-based region growing method for blood vessel segmentation,”20In Proceedings of International Society for Photogrammetry and RemoteSensing Congress, (2004) 796–801.[21] J. Lee, P. Beighley, E. Ritman, and N. Smith, “Automatic segmenta-tion of 3D micro-CT coronary vascular images,” Medical image analysis,11(6), (2007) 630–647.[22] O. Friman, M. Hindennach, and H.O. Peitgen, “Template-based multiplehypotheses tracking of small vessels,” Proc. IEEE Int. Symp. Biomed.Imaging, (2008) 1047–1050.[23] M. Sofka and C. V. Stewart, “Retinal vessel centerline extraction us-ing multiscale matched filters, confidence and edge measures,” MedicalImaging, IEEE Transactions on, 25(12), (2006) 1531–1546.[24] K. Krissian, G. Malandain, N. Ayache, R. Vaillant, and Y. Trousset,“Model-based detection of tubular structures in 3D images,” Computervision and image understanding, 80(2), (2000) 130–171.[25] E. Meijering, “Cell segmentation: 50 years down the road [life sciences],”IEEE Signal Processing Magazine, 29(5), (2012) 140–145.[26] Y. Zhu, F. Li, T.J. Vadakkan, M. Zhang, J. Landua, W. Wei, J. Ma ,M.E. Dickinson , J.M. Rosen , M.T. Lewis , M. Zhan, and S.T. Wong,“Three-dimensional vasculature reconstruction of tumour microenviron-ment via local clustering and classification,” Interface focus, 3(4), (2013)20130015.[27] T.T.V. Cao, “Nonhomogeneity Detection in CFAR Reference WindowsUsing the Mean-to-Mean Ratio Test (No. DSTO-TR-2608). Defence Sci-ence and Technology Organization, Edinburgh (Australia) (2012).[28] C. Deledalle, L. Denis, and F. Tupin, “How to compare noisy patches?Patch similarity beyond Gaussian noise,” International J. of ComputerVision, Springer Verlag (Germany), 99(1), (2012) 86–102.[29] P. Patidar, M. Gupta, S. Srivastava, and A.K. Nagawat, “Image de-noising by various filters for different noise,” International Journal ofComputer Applications, (2010) 0975–8887.21[30] E. Arias-Castro and D.L. Donoho, “Does median filtering truly preserveedges better than linear filtering?,” The Annals of Statistics, (2009)1172–1206.[31] S.R. Aylward and E. Bullitt, “Initialization, noise, singularities, andscale in height ridge traversal for tubular object centerline extraction,”IEEE Transactions on Medical Imaging 21(2), (2002) 61–75.[32] T. Kanungo, D.M. Mount, N.S. Netanyahu, C.D. Piatko, R. Silverman,and A.Y. Wu, “An efficient k-means clustering algorithm: Analysis andimplementation,” IEEE Transactions on Pattern Analysis and MachineIntelligence, 24(7), (2002) 881–892.[33] S. Almasi, X. Xu, A. Ben-Zvi, B. Lacoste, C. Gu, and E.L. Miller, “Anovel method for identifying a graph-based representation of 3-D mi-crovascular networks from fluorescence microscopy image stacks,” Med-ical image analysis, 20(1), (2015) 208–223.[34] A. Bindilatti and N. Mascarenhas, “A Nonlocal Poisson Denoising Algo-rithm Based on Stochastic Distances,” IEEE Signal Processing Letters20(11), (2013) 1010–1013.[35] C. Carson, S. Belongie, H. Greenspan, and J. Malik, “Blobworld: Im-age segmentation using expectation-maximization and its applicationto image querying,” Pattern Analysis and Machine Intelligence, IEEETransactions on 24(8), (2002) 1026–1038.[36] Y.Y. Boykov and M. Jolly, “Interactive graph cuts for optimal boundaryand region segmentation of objects in ND images,” Eighth IEEE Inter-national Conference on Computer Vision, ICCV, 1, (2001) 105–112.[37] M. Piccardi, “Background subtraction techniques: a review,” IEEE in-ternational conference on Systems, man and cybernetics, (4), (2004)3099–3104.22