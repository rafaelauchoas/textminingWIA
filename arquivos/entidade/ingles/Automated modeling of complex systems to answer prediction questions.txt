Artificial Intelligence 93 ( 1997) 201-260 Artificial lntelli~en~e Automated modeling of complex systems to answer prediction questions Jeff Rickela,* Bruce Porterb a Information Sciences Insrifufe and Depurfment of Computer Science, University of Southern California, 4676 Admiralty Way, Marina de1 Rey, CA 90292, USA h Depuriment of Computer Sciences, Universify of Texas at Austin, Austin, TX 78712-1188, USA Received April 1996; revised November 1996 Abstract A question about the behavior of a complex, physical system can be answered by simulating challenge is building a model of the system that is approp~ate for answering the the system-the question. If the model omits relevant aspects of the system, the predicted behavior may be wrong. If, on the other hand, the model includes many aspects that are irrelevant to the question, it may be difficult to simulate and explain. The leading approach to automated modeling, “compositional modeling”, constructs a simplest adequate model for a question from building blocks (“model that are designed by knowledge engineers. This paper presents a new compositional fragments”) modeling algo~thm that constructs models from simpler building blocks-the individual influences addresses important modeling issues that previous programs left to among system variables-and the knowledge engineer. In the most rigorous test of a modeling algorithm to date, we implemented our algorithm, applied it to a large knowledge base for plant physiology, and asked a domain expert to evaluate the models it produced. @ 1997 Elsevier Science B.V. Keywords: Automated modeling; Reasoning about physical systems: Large knowledge bases 1. Introduction Biologists, ecologists, doctors and engineers of a class of complex physical deep understanding and simulate models of these systems cal conditions. This skill is required to predict for many skill: each has a share an important systems, the system’s response tasks, such as evaluating and each can construct to hypotheti- designs and * Corresponding author. E-mail: rickel@isi.edu. 00043702/97/$17.00 @ 1997 Elsevier Science B.V. All rights reserved. PI1 SOOO4-3702(96)00052-S 202 J. Ricked, 3. I’~rter/Art~~i~ll Intelligence 93 (1997) 20i-260 and teaching. While the effects of trends (e.g., global warming), there are well-developed methods testing diag- for simulating control strategies, predicting nostic hypotheses, models, cause model construction prone, our objective knowledge of how a complex thetical conditions the system interest. that can adequately research on constructing models automatically requires is to automate expertise the modeling and system works) and some variables of interest), predict and explain is still time consuming is often task: given domain knowledge in its early stages. Be- and ergot (i.e., (i.e., hypo- construct the simplest model of the behavior of the variables of and a prediction question shift decisions important modeling Current modeling programs engineer. For example, some early programs useful models of the physical a relatively perform programs model for answering approach build-all combinatorially detail with which each phenomenon is impractical the models task: each question. To answer questions engineer the knowledge (the “graph of models” approach to the knowledge required a knowledge base of all potentially ] I ] >. These the best this alone, for a wide range of questions. The set of models grows levels of about complex systems, cannot anticipate-let they select, but do not generate, with the number of phenomena in the system and the various system easy required because Recent modeling can be modeled. take a more practical [ 121: the domain knowledge provides models of different approach, programs (“model fragments”), to the question. aspects of the and the modeling program uses them as building blocks the the those that modeling” system to construct an appropriate model for each question. To build an appropriate model, faces many difficult decisions. From all the phenomena governing program typically system’s behavior, the program must select, and include are relevant will be unreliable; model might be difficult phenomena, example, or as a complex sequence of more-detailed decomposed). Because compositional modeling programs automatically phenomena anticipate the relevant for each one. For reaction (each of which could be similarly choose relevant engineer need not and understand. the program must choose an appropriate irrelevant phenomenal to selecting can be described as a single chemical In addition level of detail the process of photosynthesis and build all the models the model’s predictions that might be needed. relevant phenomena, if it includes many on the other hand, in the model, only for each question, levels of detail the knowledge to simulate If it omits reactions and called “compositional Although knowledge, engineer, First, must group domain building blocks for making modeling model conditions this is knowledge is not readily available fragment, the compositional modeling approach simplifies current programs still shift important modeling decisions the task of encoding domain to the knowledge bundles indivisible fragments; the model the knowledge facts into coherent, engineer must design that is, he that the program can use as for constructing models. Second, he must supply most of the criteria each the assumptions. Because about constructing models, not about how a physical system works, it represent incompatibilities from among different modeling he must and among ~sumptions, the dependencies the assumptions underlying decisions: and that require choosing from domain experts. This paper describes a new compositional modeling algorithm that does not require such knowledge. Our algorithm constructs models from simple building blocks-the .I. Rickel, B. Porter/Artijicial Intelligence 93 (1997) 201-260 203 them-and is adequate [ 151 among for answering than alternative models. system, and the influences issues that previous programs these issues, our algorithm uses novel, domain-independent variables of the physical the modeling individual left to the knowledge engineer. To addresses that define address it when a model (See Section 3.) With these criteria, a modeler can is simpler that govern make decisions while knowing a physical role of variables and influences system; in every modeling decision. We prove that our modeling algorithm will build a simplest that adequate model one can be built (See Section 4.) the building blocks provided by the domain knowledge. little more than the variables and influences a particular prediction question and when for each prediction question, assuming (as defined by the criteria) the criteria demonstrate the central criteria from We implemented our modeling algorithm we integrated TRIPEL with a qualitative Compiler is to combine questions. simulation [ 14]), which simulates TFUPEL'S models to fully automate the pieces needed in a program called TRIPEL. ' In addition, (the Qualitative Process program to generate predictions. * Our goal prediction the task of answering in constructed in the domain of plant physiology. three ways. First, to encode tested on examples rigorous, that can support a wide range of tasks, not just prediction. We evaluated our algorithm by applying TRIPEL to the task of answering predic- (See Section 5.) While previous by their design- the domain fundamental tion questions have only been modeling programs ers, our evaluation is considerably more knowledge was encoded by a botany expert. His goal was textbook knowledge the same knowledge fact, answering questions description domain knowledge he encoded ical plant and 1500 influences Finally, the questions who judged TRIPEL'S models by comparing the questions. Our goal to answer unanticipated perts. (In tasks, such as the it describes 700 properties of a prototyp- levels of detail. including many different to evaluate TRIPEL were produced by the botany expert, for answering robust ex- to his own models that bases built by domain is to build a modeling using questions base has been used successfully is extensive: them, among and generating English [ 3 I-331 .) Second, large knowledge is sufficiently for other program them used text The evaluation identified the most important that, for some modeling decisions, it showed than TRIPEL uses. TRIPEL is designed for each type of modeling TRIPEL, and each module algorithm. decision are encapsulated can be improved without to easily topics for future research. the expert uses more sophisticated incorporate new criteria: In particular, criteria the criteria in an independent module of to the other changes requiring To lay the groundwork algorithm. modeling for these topics, the next section describes the input to our ’ The name TRIPEL. is an acronym for “Tailoring Relevant Influences for Predictive and Explanatory Lever- age”. It is also a style of strong ale made by Trappist Monks in Belgium. 2 Although TRIPEL has only been used to construct qualitative models algorithm differential equations. (See Section 6.) is equally capable of building numerical models, consisting of algebraic [ 531, we believe that our modeling and ordinary equations 204 J. Rickel, B. P~~~te~/Art~cial intelligence 93 (I 997) 20/-260 2. System descriptions and prediction questions Our modeling algorithm requires form of a prediction physical system works system. The following question, general a plant’s consisting tions variables of interest the example would describe soil. transpirations of a physical (e.g., decreasing (e.g., (the system description), from question: rate ?” A prediction system two inputs: domain knowledge and a prediction “How would decreasing the domain of plant physiology, question about illustrates about how some the the affect scenario, its soil) and some driving condi- and asks for the resulting behavior of specified for transpiration the plant and its rate). The system description question poses a hypotheti~~ soil moisture that govern the variables and influences (e.g., a plant and the plant’s soil moisture), 2.1. System descriptionu A system description represents all available domain knowledge about a particular system a system description system. Although typically generated structure of the particular particular chemical processing be used to generate a system description principles each reactant”) the behavior of the system by the concentration instantiating (e.g., “the rate of any chemical that are instantiated the general knowledge. from general domain knowledge and a description could be provided to the modeler directly, it is of the physical [ 121. For example, given factory, general knowledge of chemical engineering the physical structure of a could for the factory. The general knowledge provides of is influenced by the concentration reaction for the particular (e.g., “the rate of the reaction of nitric acid”). The system description system, yielding rules governing in the reactor tank is influenced is the result of exhaustively thereby generating only those parts of the system description a system description [ 121, called “scenario expansion”, this way. The exhaustively begins. In contrast, we have the system description with constructing that are needed as given, but our modeling algorithm and Forbus are available for generating the system description before model construction that interleaves generating Various methods method of Falkenhainer generates developed a method the model, [ 441. In this paper, we treat the system description is compatible with either approach. In the compositional modeling for model construction. We adopt started by Qualitative Process Theory blocks as building modeling consists primarily of variables and influences representation multiple our language modeling programs. for system descriptions approach, elements of the system description serve (QPT) among the approach to compositional [ 151: the system description them. However, we extend QPT’S to be described at in several ways. Most importantly, we allow systems levels of detail, At the end of this section, we discuss the differences between and the languages used by other compositional 3 Transpiration is the process by which water evaporates from the leaves J. Rickel, B. Porter/Artificial Intelligence 93 (1997) 201-260 205 2.1.1. Properties of entities: variables includes a finite set of variables, which represent to change. Because our work focuses on building those properties lumped- in the system description denotes function of time, such as the amount of water in a plant or its equation models, each variable that are subject A system description of the system parameter, differential a real-valued, rate of transpiration. Each variable continuous in plant physiology variables a pool, or a process. Examples duit (a space), rate (a property) used types”. the amount of transpiration Entities, properties photosynthesis For example, photosynthesis(plant). written as rate(photosynthesis(plant)). variable, a type of substance is defined as a property of some conceptual entity. For example, many are properties of one of three types of entities: a space, of a con- the is also and properties are called “quantity of glucose (a process). This representation include (a property) (a pool), of variables the cross-sectional area (a property) in a plant and in QPT, where variables are called “quantities” and variables are written as ground is a plant, which in The rate of photosynthesis Similarly, in Predicate Calculus. terms entity, an in a plant, which as is the amount of water in a plant, also a that maps is written is a variable, is written as amount(pool(water, plant)), where pool is a function (or energy) and a space to the corresponding pool. 4 2.1.2. Entities at different levels of detail: the encapsulation relation the water In a complex system, entities their details. For example, levels of detail. their properties typically can be described at multiple One entity may represent an aggregation of other entities, summarizing while encapsulating an aggregate pool; or the water ually. Analogously, for photosynthesis in engineering, constructed is ubiquitous scriptions encapsulates it is from other components. These are examples of entity encapsulation, which to create abstract de- entity in the roots, stem and leaves can be treated the chemical processes summarizes a system component individ- formula reactions. Similarly, that hide irrelevant details. In our terminology, the net effects of many chemical can be aggregated. For example, treated as a black box even in a plant can be treated as in science and engineering it allows modelers its underlying an abstract (aggregate) is often because though encapsulation among entities with the details. relationships the entities A system description that represent represents relation. For example, encapsulates encapsulates(pool(water, plant), pool(water, leaves(plant))) that the pool of water in the plant encapsulates specifies that is, these pools are alternative the plant also encapsulates separate pair within levels of description. Of course, the water in the stems and roots; each such relationship the pool of water in the leaves; the pool of water in is a like <; is an ordering relation the relation. The encapsulates relation 4 A pool consists of the substance or energy of a particular type in a particular stuff’ ontology 16, 151. The term “pool” space. In AI, the concept in biology and is common of a pool is the basis of the “contained ecology. 206 J. Rickel, B. Porfer/Arf$cial Intelligence 93 (1997) 201-260 it is irreflexive each other), and transitive. (no entity encapsulates itself), asymmetric (no two entities encapsulate Note that the encapsulates relation not spatial relationships. The relation of description, described as a black box or, alternatively, might form the basis of some such relationships not be the case (as with processes and subprocesses). represents relationships levels among alternative is used whenever an entity can be through its components. While spatial relations this need (as with pools and subpools), InJIuences in QPT [ 151, the phenomena injluences. An and the 2.1.3. As set of the injuencer functional. governing is a causally-directed influence in$uencee. There are two types of influences: relation among a system are represented as a finite two variables, and differential A differential injhence specifies is a function of the influencer that the rate of change (first time derivative) (and perhaps other variables). of In QPT, the effects of processes. For example, are called “direct” influences transports thus, the amount of water in the roots is differentially the rate of water uptake. Of course, a variable may be differentially influences. Typically, differential the process of water uptake influences the roots of a plant; by the influencee differential represent water into influenced influenced by more than one process; also differentially to the leaves. When first-order differential variable vl is the influencer the differential influenced In contrast, a functional injhence is a function of the influencer are called “indirect” influences tive) influences multiple equation. We write a functional influencer functional for example, by the rate at which water influences on a variable are combined, is transported the amount of water in the roots is the roots they form a influence as vl + v2, where the from equation. We write a differential and the variable v2 is the influencee. specifies (and perhaps other variables). that the influencee (rather than its deriva- In QPT, functional influences. As with differential on a variable. When combined, influence as vl -+ v2, where influences, there may be they form an algebraic is the the variable vl functional Typically, and the variable v2 is the influencee. influences the factors is functionally in the leaves. Second, are used to represent of photosynthesis its reactants) example, concentration sucrose the volume occupied by the sap. Finally, a functional static approximation. the process of osmosis adjusts the dynamics of this process over time are irrelevant, level of water as an instantaneous dependence represent one of three types of phenomena. First, they the rate that affect the rate of a process. For example, (one of influenced by the amount of carbon dioxide relations. For of in the sap and by influence may represent a quasi- in a plant cell changes, level over time. If treat the function of the level of solutes, and this functional is defined as amount per unit volume, they are used to represent definitional the cell’s water to a new equilibrium influenced by the amount of sucrose can be represented with a functional in tree sap is functionally the modeler can simply For example, when the level of solutes so the concentration influence. In QPT, each influence has a sign (+ or -), which specifies to the influencer. The sign of an influence the sign of the partial is derivative. of the influencee with respect irrelevant to our modeling algorithm, but it is required for simulation of models. .I. Rickel, B. Porter/Artijicial Intelligence 93 (1997) 201-260 201 2.1.4. Activity preconditions Sometimes, one variable influences another only under certain conditions. For exam- the amount of light energy ple, the amount of carbon dioxide only when preconditions the activity preconditions inequalities of an influence specify in the leaves influences the rate of photosynthesis is greater in the leaves than zero. The activity the conditions under which it is active. As in QPT, set of conjunctive empty) between variables or between variables and constants. ’ of an influence are a (possibly 2.1.5. Signi@ance preconditions Sometimes, the effects of an influence are insignificant for purposes of answering insignificant influences a question. A model can often be greatly simplified when recognized nificance of influences, knowledge of the time scale of different processes important. and omitted. While human modelers use many criteria to determine are the sig- is particularly [ 2,20,40,47,49]. cause significant flow through membranes In a plant, solutes change on widely disparate In complex systems, processes for example, water flows through membranes scales a time scale of seconds, growth requires days, and surrounding of months or years. Given causes significant example, plant’s growth are significant only on a time scale of days or longer, purposes of answering time on on a time scale of minutes, ecological processes may occur on a time scale that [ 24,28,5 11. For soil moisture on a since the effects of for change only on a slower time scale is insignificant the effect of decreasing the question concerning rate, a time scale of hours is most appropriate; the time scale of interest for a question, any influence to answer transpiration they are insignificant the question. To represent coded as an inequality For example, the significance influence question’s preconditions. such knowledge, relating for an influence representing preconditions of an influence the sign$cance the time scale of interest and a specific are en- time scale. the effect of growth on the size of a plant, > days. An if the a given question if and only the inequality in the influence’s significance is signijkant time scale of interest satisfies for purposes of answering preconditions would be encoded as time-scale-of-interest Typically, a differential influence represents an effect of a process, so its significance time scale on which the effect is significant, as the fastest should specify preconditions in the growth example above. If the significance preconditions are empty, functional the time scale of interest, so their significance preconditions the modeler must represent influences treat the influence instantaneous effects, as significant of a differential influence for any question. Since regardless of they are significant are always empty. The modeling methods described in this paper do not depend on this particular for significance. terion discussed many domains, branches of engineering in Section 6.1.1. Still, including biology In the future, we plan time scale [ 19,491, ecology [26,48]. Moreover, empirical is an important cri- to incorporate other criteria as well, as in significance criterion [ 511, and many in Section 5) [ 2,401, economics (described results 5 In QPT, activity preconditions are called “quantity conditions”. 208 J. Rick& 3. P~rfer/A~f~ci~l Intelligence 93 (1997) 201-260 show that this criterion is capable of pruning many irrelevant phenomena from mod- els. 2.1.6. Valid& preconditions influences Many approximations an influence phenomenon preconditions. hence need not be modeled when one particular don’t obviate influence are approximations typically have a limited the conditions of the phenomena these range of validity. The val~di~ precondjtio~s of is a valid model of the they represent, the influence and specify it represents. Contrast validity preconditions with activity and significance under which The latter specify when a phenomenon at all. Validity preconditions, is an invalid approximation is inactive or insignificant, and on the other hand, specify but they of its phenomenon, the need to model that phenomenon. As with significance, human modelers use many criteria is particularly the validity preconditions of an influence to assess important. Therefore, the validity of as with are encoded as an but the time scale of interest preconditions, influences, significance inequality might arise from cases like the following: relating the time scale of interest and a specific time scale. Such a precondition to the behavior is functionally l The behavior of an aggregate pool is often used as an approximation the rate of photosynthesis in the mesophyll of carbon dioxide by the concentration influenced by the concentration of one of its subpools. For example, influenced leaves. As an approximation, functionally an approximation than the time scale of interest throughout the influence of carbon dioxide approximation longer. a modeler might say that the rate of photosynthesis of carbon dioxide cells of the is in the leaves. Such is reasonable when the subpools equilibrate on a time scale faster if diffusion of carbon dioxide on a time scale of minutes, is a valid is minutes or the leaves achieves a uniform concentration in the leaves on the rate of photosynthesis to the true inffuence when the time scale of interest [ 24,5 11. For example, processes representing a quasi-static reach equilibrium l An influence underlying scale of interest changes, On a time scale of minutes or longer, Therefore, scale of minutes or longer. the process of osmosis adjusts the functional [ 24,28,511. For example, when the level of solutes is typically valid only if the approximation on a time scale at least as fast as the time in a plant cell level. the cell’s water to a new equilibrium this process can be treated as instantaneous. influence of solute level on water level is valid on a time An influence is valid for purposes of answering time scale of interest the question’s preconditions. As with signi~cance preconditions, on this particular criterion, but it has proven very effective. the inequality satisfies a given question if validity in the influence’s our modeling methods do not depend if and only 21.7. ~~~~e~ces at di~erent levels of detail: the explanation reLation For complex systems, different influences may represent the same phenomenon different model, a modeler must understand which levels of detail. To choose a suitable influences set of influences represent on a variable independent phenomena at in a J. Rickel, B. Porter/Artificial Intelligence 93 (1997) 201-260 209 and which represent different given variable represent alternative levels of detail for the same phenomenon. Influences on a levels of detail in cases like the following: l The influence of an aggregate process on a pool represents the aggregate effect of on water the light reactions, represents the influence of photosynthesis is due to the influence of one of its subprocesses, its subprocesses on that pool. For example, in the leaves on water in the leaves. In turn, aggregate effect of two of its subprocesses: used to split water molecules to chemical energy and water. Thus, the influence in which light energy of photosynthesis is explained by the influence of the light reactions, which is explained by the influence of the Hill reaction and the influence of photophosphorylation. the influence of the light reactions the Hill reaction, into hydrogen and oxygen, and photophosphorylation, the in which light energy is on water in the leaves is converted l Analogously, the influence of an aggregate pool on a process represents gregate effect of its subpools on that process. For example, influence of carbon dioxide of two subpools: in the leaves on photosynthesis cells and the bundle sheath cells. the mesophyll in many plants, is due to the influences the ag- the type (i.e., differential To generalize such cases, a system description (While influences of the same there may be similar plained by other influences. The explanation other influencee. types or influencees, tation of those relationships.) effect on the influencee of the influences tute the explanation explained and the influences levels of detail. at different our modeling The fully explain in its explanation relationships or functional) among can specify for an influence, that one influence if it has one, relates is ex- it to that have the same influences with different criteria and algorithms do not require a represen- the collective influence being explained that consti- In short, the influence being the same underlying phenomena it, and the influences that explain represents influence. represent the aggregate Such relationships element of this relation influence explain relation, provides irreflexive other). Note that both the explanation aggregation hierarchies: represents a hierarchy of entities. (no influence explains are represented by the explanation i’ is an element of the set of influences relation. The pair (i, i’) is an that if and only if influence i. The transitive closure of the explanation an ordering among in addition influences; itself) and asymmetric it is (no two influences explain each represent the former represents a hierarchy of influences, while the latter relation and the encapsulates transitive. to being relation relation, the explanation* 2.13. Summary In summary, a system description represents domain knowledge about a particular the phenomena by variables and influences, which provide the phenomena includes system. The description physical well as the levels of detail at which represented For each influence, active, valid, and significant; are relevant validity are based on time scale [ 21,22,28], does not depend on any particular criteria. Finally, the system description to answering specifies a given question. Currently, our criteria such information helps the modeler decide which influences and algorithm to help the modeler ensure a coherent although our model construction for significance that govern can be described. Phenomena the system as are the building blocks for models. it is the conditions under which model, the system description the encapsulates using represents and explanation the relationships relations. among different levels of detail description alternatives, lation or explanation 2.1.9. Previous work on system descriptions QPT'S representation for variables and influences provides language. However, because QPT was not designed it does not include a representation for significance preconditions, the basis for our system to represent modeling encapsu- The compositional modeling relationships, or validity preconditions, framework of Falkenhainer fragments”, which provide are “model (e.g., complete to specify different modeling ideas of QPT to represent modeling the models cally, sets of influences ments ~‘assumptions”, level of detail. To represent into “assumption organized incompatible modeling ally esting variants of this compositional modeling same. the relationships classes”; alternatives. symbolic alternatives, that characterize labels Several individual equations). alternatives. The building blocks influences and Forbus or, more To allow different model [ 121 extends for their typi- frag- fragment has associated its are in each class represent mutu- inter- define ideas are the it represents assumptions [23,38,39] and researchers framework, but the basic each model the phenomena among model fragments, the assumptions Our representation differs in two ways. First, the person encoding into model fragments; are the building blocks for models. As will be shown edge need not group in~uences influences modeling decisions arise at the level of influences, not the knowledge rare for two influences ditions each influence are often available. Although our approach-using blocks for models-differs human modelers have taken this approach to face these decisions. Moreover, in models; from other work in automated modeling, in a variety of domains in which only one of the influences to necessarily occur together engineer, is relevant, and alternative rather, in our approach, the domain knowl- individual in Section 3, important and we want the modeling program, in our experience, it is there are typically con- levels of detail for influences as building the idea is not new: [4,18,30,43,46]. Second, Falkenhainer and Forbus for making modeling decisions. require the knowledge In addition engineer to requiring to provide model fragments, assumptions, and assumption classes, to provide more the knowledge they require of the criteria engineer two additional types of knowledge: ( I ) rules that specify dependencies among assumptions (e.g., which ones are mutu- (2) ally incompatible the conditions must choose one of the alternatives). in which each assumption and which ones require each other) and class is relevant (i.e., when the modeler in a form that we believe will be more natural algorithm, and explanation For our model construction cause the encapsulates among alternatives, The second tion algorithm Sections 3 and 4. Our algorithm does require criteria for modeling decisions, namely ditions; however, effectively generates type of knowledge has no counterpart the first type of knowledge relations is unnecessary be- sufficiently describe the relationships for domain experts. in our approach; our mode1 construc- such knowledge automatically, the system description preconditions significance as will be shown in to provide some and validity precon- and hence should these criteria are properties of individual influences, .I. Rickel, B. Pr,rter/Artijcial Intelligence 93 (1997) 201-260 211 be easy for a domain expert such knowledge.) 2.2. Prediction questions to provide. (Our botany expert had no trouble providing 2.2.1. Driving conditions and variables of interest A prediction question poses a hypothetical scenario, specified by one or more driving and asks for the behavior of one or more variables of interest. Driving in specify (or both) of particular variables the behavior or initial condition conditions, conditions the system description. For example, “decreasing in the question “How would decreasing Any variable in the system description can serve as a variable of interest. The goal to predict and explain interest. soil moisture” soil moisture affect a plant’s transpiration is the driving condition rate?’ in the example) rate” a prediction question is on the variables of (such as “transpiration in answering the causal effect of the driving conditions We currently use the same the initial > temperature(soiI). relating a variable and initial conditions). or D(temperature(plant)) (behaviors statement or constant. For example, cisely as temperature(pIant) temperature(plant) specified (using equilibrium) statements they hold throughout be described as increasing or decreasing decreasing for an unspecified methods are not restricted we could allow behaviors well. Our methods would simply description of behavior. language to specify both Each driving condition types of driving conditions is an equality or inequality (or its derivative) (or its derivative) to another variable = 67°F or less precisely as temperature(plant) temperature Its initial of a plant could be specified pre- > 32°F or rate of change could similarly be = zero (thermal is warming up). These same that to value (i.e., increasing or than initial conditions, meaning thereafter). Our modeling for instance, for driving conditions; to a new equilibrium amount of time and constant to this particular to be specified as arbitrary language (e.g., a sine wave) as functions ignore the extra information provided by such a precise the differential operator D) as D(temperature(plant)) > zero (the plant could be specified as behaviors rather the temporal extent of the scenario. We also allow a behavior 2.2.2. Time scale of interest As discussed power in modeling. It allows a modeler to in Section 2.1, a time scale of interest provides an important source of ( 1) treat influences (2) represent (3 ) treat separate pools as a single aggregate when they equilibrate on a faster time that operate on a slower time scale as insignificant, the effects of faster processes using quasi-static approximations, and scale. Thus, a time scale of interest allows many important model simplifications. Although the person posing a question may specify a time scale of interest, often a modeler must determine for choosing an appropriate Whether posing the question, the time scale of interest it automatically. Elsewhere time scale of interest when none is specified [44,45], we describe an algorithm in the question. is chosen by the modeler or provided by the person this paper will treat it as part of the question. 212 J. Rickel, B. Porter/Art$ciul Intelligence 93 (1997) 201-260 ABA transpo~ _ rate 5.. mins x4 guard cell ABA amount ABA synthesis rate /: leaf turgor pressure + leaf -+ mesophyll A mins ABA amount 4 -I mins !+ ,-‘ mms + ’ ABA consumption rate Fig. I. A scenario model. 3. Scenario models Given a system description structs a scenario model following: for answering and a prediction question, our modeling con- the question. A scenario model consists of the algorithm l a set of variables (a subset of the v~iables into exogenous variables, whose behavior the model, and dependent variables, whose behavior and in the system descriptions by influences is determined p~tition~ external to is determined by the model, (a subset of the influences is a dependent variable in the system description), in the model and whose influencer each is acid hormone in its leaves variable; consumed describes in the model the scenario model in response (exogenous or dependent). in Fig. 1 6 shows how a plant regulates in turgor pressure to changes (e.g., when it begins wilting). Leaf turgor pressure (ABA) the abscisic (hydraulic pressure) is the only exogenous and to the guard cells. {Footnote 6 that ABA is synthesized all the others are dependent. The model shows in the leaf mesophyll the conventions As in previous work cells and transported that are used in this and subsequent figures.) a scenario model [ 12,23,34], of the scenario. To make predictions in~uences simulation the simulator must determine which state. For example, drops below a threshold. The activity preconditions that fact. To simulate a turgid the simulator would omit old. A variety of simulators turgor pressure only this influence until (not wilting) is intended from a particular in the scenario model are active influences ABA synthesis when of the influence would turgor pressure plant whose turgor pressure drops below to support the entire state of the scenario, in that the pressure represent is dropping, the thresh- in this way are capable of simulating scenario models l a set of influences influencee of whose another variable For example, 6 This and subsequent figures use the following conventions: Arrows with solid tips represent differen- tial influences, while arrows without solid tips represent functional influences. Exogenous variables (in this example, leaf turgor pressure) are underlined. Differential influences are labeled with the time scale on which they become significant. For example. “mins” is n shorthand for the significance precondition influences are labeled with the sign of their partial derivative. For ex- time-scale-of-interest ample, when leaf turgor pressure decreases, the rate of ABA synthesis increases. Activity preconditions of influences are not shown. 3 minutes. .I. Ricked, B. Porter/Arr$icial imelligence 93 j1997J 201-260 213 this approach, rather the modeler need only build one scenario model than building a different model for different to states of the [ 14.15,17]. Using answer a question, scenario. 3. I. Adequacy is adequate a scenario model two criteria. First, Intuitively, if it satisfies accuracy. Second, description of the physical system. To automate modeling, we must formalize intuitive criteria. We formalize a given prediction question the desired predictions with sufficient the model must be a coherent these two the criteria as a set of adequacy constraints. Each constraint to ensure a comprehensible it must make for answering explanation, icate of three arguments: model. A scenario model and only the key issues and influences variables (Section 3.1.3), modeling lating a system description, is adequate if every adequacy constraint a prediction question, for a given system description is satisfied. Collectively, in model construction, in each issue. The key issues include choosing and they demonstrate (Section 3. I .2), choosing appropriate an appropriate set of system entities the driving conditions of the question to the variables of interest Our objective is to formalize the intuitive criteria the constraints is a pred- and a scenario if and question address the central role of variables exogenous influences on each dependent variable (Section 3.1.4), and re- (Section 3.1 S). that human modelers use to achieve this the results of appropriate accurate, coherent models. For the adequacy constraints we propose, sufficiently section explains why each empirically evaluating is intuitively necessary. Section 5 discusses in the domain of plant physiology. the constraints 3.1.1. Variables in a scenario model A model is only adequate if it can make the desired predictions. This motivates the following constraint. Adequacy Constraint 1. (Include variables of interest) A scenario model only if it includes every variable of interest. is adequate earlier, As discussed the simulator must determine which model are active in each state of the scenario. This requires activity preconditions the model provides enough of influences information to do so. in the model. The following constraint influences the ability in the scenario the to evaluate that ensures Adequacy Constraint 2. (Include variables in activity preconditions) A scenario model is adequate only if it includes every variable appearing of an influence in an activity precondition in the model. 3.1.2. Exogenous variables Once a variable The first decision is included is whether in a model, to model the modeler must determine how to model it. it as exogenous or dependent. 214 .I. Rickel, B. Porter/Artijiciai Intelligence 93 (1997) 201-260 While the phenomena governing a dependent variable are represented the model the phenomena in the model, the model. Conceptually, represent the system bu~~da~~, environment. Thus, by choosing titions the given question, and its environment a complex crucial. the system description system governing an exogenous variable are outside represents by influences the scope of a system, and the exogenous variables the system and its su~ounding the interface between to model some variables as exogenous, into two parts: the subsystem (which is irrelevant). To ensure that is relevant a modeler par- to answering that a model of is is adequate and as simple as possible, a suitable system boundary Despite the importance programs of a well-chosen can choose exogenous system bound~y, variables automatically. Moreover, modeling plained at the end of this subsection, for answering either inadequate or unnecessarily prediction questions; these few programs use criteria their choice of exogenous complex models. few previous automated as ex- that are too weak in variables can result in the model. For example, in a model of a single plant; while treat a variable as exogenous only if it is approximately Human modelers of the other variables as exogenous critically on the rate of precipitation, depend significantly be treated as exogenous, significantly affects another. the rate of precipitation independent can be treated the behavior of the plant depends do not to decide which variables can a tnodeler must be able to determine whether one variable that govern precipitation the phenomena on the behavior of the plant. Thus, The influences in a system description determine which variables affect each other. to from the first variable Clearly, one variable affects another the second. One variable can also affect another by enabling or disabling on it; that is: one variable affects another whose activity preconditions Therefore, we define the first variable. the ~n~uence graph for a system description if there is an influence the influences if there is an influence on the second variable reference nodes of the graph are the variables. There is a directed edge from one variable if and only is the second variable and either if there is an influence whose influencee is the influencer or as follows. The to another in the influence’s activity preconditions. is a path of non-zero length in an influence to the second and every influence in the path is valid and significant if and only if there is an influence path leading graph. One variable from the for these concepts. Part A shows a set of influences, influence graph. If the time scale of interest and part B shows is seconds, only v3 sig- influenced influences v4. However, on a time scale of hours, v4 is significantly above, is approximately the following constraint independent formalizes the intuition that an of all other variables in the model. Adequacy Constraint 3. (Exogenous model in the system description by another variable is adequate only if none of its exogenous independent variables in the model. variables of model) A scenario inffuenced is signi~cantly l the first variable l the first variable appears path An injhence s~gri~~ca~tl~l inj?uences another first variable the given question. Fig. 2 illustrates the corresponding nificantly by v0, vl, v2 and v3. the definitions Given exogenous variable J. Rickel, B. Porter/Artificial Intelligence 93 (1997) 201-260 215 vo => v3 activity preconditions: VI > 0 significance preconditions: time-scale-of-interest >= hours v2 => v3 significance preconditions: time-scale-of-interest >= minutes v4 => V3 significance preconditions: time-scale-of-interest >= seconds Y2 (A) Influences (B) Influence graph Fig. 2. (A) A set of influences, along with their activity and significance preconditions. (ES) The corresponding influence graph. them, that contains the next constraint those variables whose behavior While the previous constraint on exogenous variables ensures on variables of interest. To answer a prediction question, a modeler that they are appropriate that they are appropriate ensures that a prediction question asks for the effects of driving includes the behavior of for the model for the given question. Recall conditions in the model the variables of interest. Therefore, by a driving variable the model should reflect this so in a driving condition), the effects of the driving variable’s behavior on that variable can be determined. Thus, the model from relevant driving to ensure conditions, of the driving variables. that the exogenous variables do not disconnect a variable cannot be exogenous it is approximateIy is significantly in the model to dete~ining if a variable independent (a variable is relevant influenced unless Adequacy Constraint 4. (Exogenous model the system description by a driving variable is adequate only variables if none of its exogenous variables independent of question) A scenario in is significantly influenced (other than itself if it is a driving variable). Together, automatically for this question the turgor pressure these two constraints time scale of interest specify whether a variable time scale can be determined these system boundary criteria, consider in a plant’s guard cells when in a model can be exoge- the question “What happens in its leaves is important because plants send ABA to the guard cells to nous. To illustrate to the amount of ABA decreases?” This question combat dehydration. The appropriate (This of Pig. 3 shows a portion of the system description variable the question. shown In this model, none of the dependent variables could be exogenous, because each one by the driving variable, is significantly leaf 4). Leaf turgor pressure can be turgor pressure 3 and 4; that is, as exogenous (on a time scale of shown in part A, leaf turgor pressure minutes) by any other variable (there are leaf turgor pressure could not be treated no others). On a time scale of hours, however, influenced (thus violating Adequacy Constraint it satisfies Adequacy Constraints influenced in bold. Part B shows the simplest adequate model for answering in the model nor by any other driving variable .) Part A the driving are (on a time scale of minutes) (guard cell ABA amount) for a prototypical plant; and variable of interest in the model because if it is not specified is not signi~cantly turgor pressure) is minutes. [44,45] (leaf 216 .I. Ricked, B, P~jr~er/‘~~i~~ial Itztelligence 93 (1997) 201-260 ABA synthesis rate ..I-, mills leaf mesophyll ABA nmcxmt - A m’“S ABA trnnsporr I Flte m:;s(4 guard cell ABA ---z- amount k+ active + guard _~~ - transport tale - ~~~~ cell carbon dioxide + , mins accessory cells k+ amount 4 +-, mills 4 guard cell k+ amount k+ diffusion rate + _ osmosis rate ‘” I -! mins + ‘+ ’ ABA consumption rate -j leaf turgor pressure + leaf mesophyll writer amount w--- hrs 4 + ml”5 ‘- leaf water uprnke rate I - rnins 1 ‘+ transpiration fate L di + plant temperature ,$; stomata1 opening . xylem water amount 4 +’ hrs a... water uptake rate _ ~_~__._ . ABA synthesis rate t- mins leaf mesophyll ABA Blno”nt leaf turgor pressure 4 -1 mins ‘+ ABA ’ consumption mte (A) System Description - ‘;in;5 ABA transport _ rare ?.. mins ‘& guard cell ABA amount + _ (8) Simplest Adequate Scenario Model in Fig. 3. (A) A portion of the system description in its leaves decreases. ?” The driving variable and variable a plant’s guard cells when the turgor pressure of interest are shown in bid. Ellipses indicate connections to the ~maining variables and inlluences in the system description. Alternative levels of detail are not shown. (B) The simplest adequate scenario model for answering the question. to the amount of ABA “What happens the question for it would be signi~cantly influenced by guard cell ABA amount through guard cell water amount and transpiration. than would otherwise the time scale of interest allows a tighter system boundary as exogenous, because on that time scale via a path passing Thus, be possible. exogenous for choosing Despite its importance, no previous work in automated modeling has provided explicit require either that can be exogenous. For [54] and Iwasaki and Levy 1231 take algorithms of Williams these algorithms can determine which exogenous variables must in the scenario model, neither algorithm can determine exogenous variables criteria the system description or question the modeling instance, this approach, Although be included automatically. variables. Typically, modeling programs those variables this approach is impractical. For complex systems, to specify J. Rickel, B. Porfer/Art~cial Intelligence 93 (1997) 201-260 217 for his modeling [38] can choose exogenous algorithm for doing so. Moreover, his definition of an adequate model variables, but it does not Nayak’s modeling is have explicit criteria suitable a specified causal relation, but is not sufficient for answering prediction questions. For instance, his definition would allow a scenario (in the model system description) 3 prevents our modeling by another variable from making to treat a variable as exogenous even though in the model. Adequacy Constraint it is significantly task, explaining this mistake. influenced algorithm The modeling algorithm of Falkenhainer and Forbus [ 121 largely determines is, each system component that represent to a question, the algorithm That the components that are relevant system boundary by identifying as input, a system decomposition. be a system, and each system can have components identify smallest set of components the variables of interest; interactions covering all relevant the initially relevant component, exogenous. these components the lowest system down components) but is only components. relevant among system”, that must be modeled these components That component are modeled, to include the immediate are marked as relevant. Next, to ensure and its subsystems are relevant. Any variable the algorithm determines a “minimal that subsumes the system decomposition to the level of (down that is a property of a is components, influenced by properties of irrelevant the requires, is also assumed to its subsystems. To the influences on that first identifies relevant system components. Their algorithm algorithm their modeling system boundaries limitations. While and Forbus assume is based on partonomic Their approach has several in natural systems arise from differences system decomposition, edge of the influences. Furthermore, decomposition approximate (i.e., their time scales) and that these boundaries may not correspond in engineered tural decompositions. Even be trusted when considering faults or unintended of influences provides more flexibility priori system decomposition. Additionally, nous variables will be sufficiently of interest. requires a our criteria for choosing a system boundary only require knowl- Falkenhainer that the system structure; however, O’Neill et al. [40] argue that in process rates to standard struc- system boundaries cannot [ 81. Reasoning at the level an a the criteria for choosing exoge- that the chosen system boundary and variables systems, designed interactions in terms of influence paths, we ensure the difficulty of specifying between driving conditions to the connections and overcomes by specifying sensitive 3.1.3. Injuences on a dependent variable Exogenous variables, which lie on the system boundary, are governed by phenomena the scope of the model. In contrast, outside modeler must choose a set of influences four constraints an adequate set of influences. in this subsection ensure for every dependent variable to represent the phenomena that govern that every dependent variable in a model, the it. The in a model has of a model, For simulation the influences on a variable are combined to form an equation. Human modelers use two types of equations: algebraic equations, composed of functional influences. The following that the influences on each dependent variable correspond to one of these two types. and differential equations, composed of differential ensures influences, constraint 218 J. Rickel, B. Pnrter/Art@icial Inrelligence 93 (1997) 201-260 amount( pool( water, guard-cells) ) C= rate( osmosis( accessory-cells, guard-cells) ) amount( pool (water, guard-cells) validity preconditions: ) t amount (pool ( ABA, guard-cells) ) time-scale-of-interest 3 hours amount (pool (water, guard-cells) validity p~onditions: ) t amount (pool (~02, guard-cells) ) time-scale-of-interest 3 hours Fig. 4. Influences on the amount of water in a plant’s guard cells Adequacy Constraint 5. (I~~~e~ces ~~~~ge~e~~s) A scenario model is adequate only if the influences on any given dependent variable are all the same type (i.e., differential or functional). For example, Fig. 4 shows a set of influences on the amount of water in a plant’s the fact that the amount of water is regulated represent in the levels of ABA or carbon dioxide cause to a new equilibrium. The amount of guard cell influences, but guard ceils. The first influence by osmosis quasi-static osmosis water can be modeled by the differential it would be incoherent represents accessory cells. The remaining changes the level of water from neighboring approximations; influence or the two functional two influences to adjust to mix them. A model must also be sufficiently accurate. For this reason, each of its influences must be a valid approximation the validity preconditions in the following specified of the phenomenon is, of each influence must be satisfied for the given question, as constraint. represents. That the influence Adequacy Constraint 6. (ln~~e~zces did) A scenario model is valid for the given question. of its influences is adequate only if each For example, the two functional in Fig. 4, which influences are only valid on a time scale of hours, because operate on a time scale of minutes. Therefore, is less than hours (e.g., seconds or minutes), represent quasi-static the mechanisms that for any question a scenario approximations, restore equilibrium whose model time scale of interest that includes these influences To further ensure that a model is sufficiently accurate, is inadequate. the influences on each dependent variable in~uences of influence follows: should represent is corn~l~te. Given a system description, all the phenomena the variable. Such a set of variable, and a type a dependent or differential), we define a complete set of inJluences as that affect (i.e., functional l The set of all “maximally is complete. A maximally influence aggregate” aggregate (i.e., a maximal element of the explanation influences of the specified influence type on the variable is one that does not explain any other relation). in a complete set with the set of all influences a The result of replacing an influence that explain it (as specified by the explanation relation) is a complete set. J. Rickel. B. Porter/Art@cial Intelligence 93 (1997) 201-260 219 amount (pool (co2, leaves) ) + rate( coz-diffusion (atmosphere, leaves) ) significance preconditions: time-scale-of-interest 3 seconds amount (pool( co2, leaves) ) + rate( photosynthesis( leaves) ) significance preconditions: time-scale-of-interest > minutes amount( pool (~02, leaves) ) + rate( dark-reactions (leaves) > significance preconditions: time-scale-of-interest 3 minutes Explanation( amount( pool( co2, leaves) ) + amount( pool ( CO?, leaves) ) + rate( photosynthesis( rate( dark-reactions( leaves) ), leaves) ) ) Fig. 5. Influences on the amount of carbon dioxide aggregate not by any other influences). influences. The influence of photosynthesis in a plant’s is explained by the influence of the dark reactions leaves. The first two are the maximally (and For example, Fig. 5 shows a set of influences on the amount of carbon dioxide the influence of photosynthesis leaves. As shown, in a (and not by any other influences). The first two influences is explained by the influence in the a complete set because they are the maximally the first and third influences constitute a complete set, since aggregate influences. the photosynthesis is fully explained by the more-detailed influence of the dark reactions. plant’s of the dark reactions figure constitute Also, influence Of course, the model need only be sufficiently accurate for the given question. There- variable need only represent all the significant that affect the variable. For a given question, a set of influences on a variable set of influences fore, the influences on each dependent phenomena is approximately and none of the omitted the first influence seconds. However, on a time scale of minutes or longer, either influence must be additionally Ciiven these definitions, in Fig. 5, set on a time scale of the second or third the following constraint ensures if it is a subset of a complete for the question. For example, that the model represents all an approximately alone constitutes is significant if and only influences complete included. complete phenomena that significantly affect each dependent variable. Adequacy Constraint 7. (InJEuences complete) A scenario model the set of influences on each dependent variable question. is approximately is adequate only if for the given complete Finally, to ensure that the influences on a dependent variable are coherent, a modeler The following levels of detail for the same phenomenon. must avoid mixing different enforces constraint this requirement. Adequacy Constraint 8. (Influences not redundant) A scenario model is adequate only if the influences related by the explanation* on each dependent relation. variable do not include two influences 220 J. Rickel, B. Porter/Artificial Intelligence 93 (1997) 201-260 If a model’s influences on a dependent subsection, we say that the influences must address two issues: accuracy of predictions, complete) valid) and 7 (Influences (Influences of the governing phenomena, representation a sufficiently straints 5 (Influences and 8 (Influences homogeneous) the representation is coherent. accurate variable satisfy are adequate. Recall the four constraints in this that adequacy of a model and coherence. Adequacy Constraints 6 help ensure that the influences provide and Adequacy Con- that help ensure not redundant) Most previous work in automated modeling does not enforce explicit constraints variable. For those modeling programs on a dependent class representation of Falkenhainer fragments combination and the constraints of model like that [ 121, the person among assumptions must ensure fragments yields an adequate set of influ- and Forbus these for the influences use the assumption encoding the model that each compatible ences. Some previous modeling programs is analogous variable and they identify and discard negligible This complete the elements of the equation. set. However, to identifying an approximately are given a complete equation terms in the equation for a dependent [ 11,36,55,57]. these programs do not consider alternative complete set of influences given a levels of detail for 3.1.4. Entities in a model A scenario model is a model of selected entities is a property of an entity, so the entities whose properties important because are represented by the model’s variables. The entities they indicate the model’s view of the system. in a system. Each variable in a model in a scenario model consist of all the entities in a model are To ensure consistent predictions and a comprehensible explanation, coherent. More specifically, while entities can typically be described at multiple of detail, a modeler must avoid mixing different constraint prevents a model from mixing levels of detail are related by the encapsulates levels of detail. In the system description, relation, Thus, levels. that view must be levels at entities the following Adequacy Constraint 9. (Entities does not include two entities related by the encapsulates relation7 coherent) A scenario model is adequate only if it The driving variables of a question also constrain the choice of entities include A scenario model need not necessarily may be irrelevant level of aggregation variables modeler encapsulates information that the model respects the level of detail specified indicate to the variables of interest. However, in the driving variables, in which the user these variables or chooses variables at a lower level of detail, in the driving conditions will be lost. ’ The following constraint the level of aggregation specified in the driving variables. all driving variables, because the model should for two reasons. First, is interested. Second, respect in a model. some the these if the the ensures ’ Recall that the relation x It may be possible is transitive. to infer driving conditions at the abstract or more-detailed levels from the given driving conditions, but we have no general method for making such inferences. J. Rickel, B. Porter/Artificial Intelligence 93 (1997) 201-260 221 is adequate only Adequacy Constraint 10. (Entities model of a driving variable and it does not include an entity of a driving variable. if it does not include compatible with driving an entity that encapsulates variables) A scenario an entity by an entity that is encapsulated Elsewhere [ 441, we formulate additional level of detail. While useful, such constraints adequacy constraints based on the entities for the user’s level of to are tangential is appropriate ensure that the model in a model. The constraints knowledge and desired the focus of this paper. 3.1.5. Influence paths in a model a scenario model A prediction question asks for the causal effect of driving conditions on variables of if the (in the model) by the driving variables. the to the variables of interest interest. Therefore, variables of interest are significantly Additionally, in order initial state, the influence paths relating changes must be capable of predicting the behavior of the variables of interest beyond the driving variables in the variables of interest. influence, one variable can cause change is adequate influenced in another variable in the question only for answering to predict Through an individual two ways: ( I ) with a differential influence, a specified value for the influencer (along with val- (2) ues for other influencing in contrast, a functional changing [ 1.51. variables) provides influence the rate of change of the influencee; can cause change only if the influencer is Thus, a model can predict variable only the driving conditions path of functional influence path is a differential if the influence path connecting the changes specify how the driving variable the change). influences will propagate them contains a differential in a variable of interest caused by a driving influence or (in which case a the is changing If either case is satisfied, For example, injluence path. the question “What happens to the amount of ABA in a plant’s guard is specifies in its leaves decreases?’ so any influence path from turgor pressure cells when the turgor pressure decreasing, influence path, capable of causing change. that turgor pressure growth), an influence path leading influence a differential is a differential if the question only specified the pressure causes cell is differential only if it contains (as is the case with the influence of turgor pressure on cell size). that a model can Motivated by the above discussion, the following constraint ensures the effect of the driving conditions on the variables of interest. from turgor pressure that turgor pressure to another variable the “yield point” (above which In contrast, is above predict Adequacy Constraint 11. (Variables of interest differentially model is adequate only if, for every variable of interest, influence path leading path is valid and significant for the given question. influenced) A scenario the model includes a differential to it from some driving variable such that every influence in the The requirement that a scenario model relate driving variables is not new, although previous work has not required differential to variables of interest influence paths. Nayak 222 J. Rickel, B. Porter/Artificial lniellipmx 93 (1997) 201-260 to provide a causal path linking requires [3] causal) for generating linking an adequate model the driving variable to provide to is every variable of interest [54] a “critical abstraction” paths requires an adequate model [38] to the variable of interest. Amsterdam “interaction” (i.e., not necessarily some driving variable. Williams’ method to ensure designed (in his framework, We only require differential prediction questions; Adequacy Constraint differential) from driving variables that the chosen scenario model causally the exogenous variables of the system) influence paths because the driving variables links to the variables of interest. for answering they are appropriate our model construction 11 only required valid, significant algorithm would work equally well if influence paths (not necessarily to variables of interest. 3.1.6. Other possible adequacy constraints (within the “correct” behavior tasks in which the correct behavior of the variables of interest Some previous modeling programs define a model as adequate only if its predictions either a specified [ 1,521 can the correct in the domains we have studied, so we to match address or they assume be estimated behavior, and error estimates are not available exclude such a constraint. handle such a constraint. [9-l 1,501. However a prediction question does not provide In Section 4.5, we suggest how TRIPEL could be extended These programs is known introduced by different approximations that the approximate tolerance). error 3.2. Simplicity To answer a prediction scenario model, minimizing irrelevant modeler another. requires criteria information question, a modeler irrelevant phenomena to analyze is more difficult should construct the simplest adequate and details, because a model with and explain. Thus, a than is simpler (e.g., simulate) for determining whether one candidate model Human modelers probably use a combination of many criteria to assess the complexity in a model the number of variables of a model. Nevertheless, correlates well with most other measures of complexity, effective heuristic number of variables, understand modelers simpler that to be an to increase with the to used by human techniques in a model. Thus, we define one model as and explain, Furthermore, most simplification and a model with more variables in our experience. Simulation is generally more difficult the number of variables than another as follows: is a simple measure it has proven complexity reduce tends and l For any two scenario models m and m’, m is simpler than m’ if and only if m has fewer variables than m’. In contrast define one scenario model as simpler first, either to our measure of simplicity, Nayak than another that model fragment or a more-detailed [38] and Iwasaki and Levy if, for every model fragment alternative [23] in the is in the second. 9 This ') Actually, lwasaki and Levy’s definition is in terms of “composite model fragments” rather than model fragments, but the distinction is irrelevant to our discussion. J. Rick4 B. Porter/Art$cinl Intelligence 93 (1997) 201-260 223 criterion when a few phenomena), is a reasonable For example, consider representing representing many phenomena, in more detail of the system under their criterion. Thus, although algorithm based on their simplicity model as the simplest adequate model. it holds, but it leaves too many models incomparable. two models, one with only a few variables and influences influences (i.e., (i.e., some in great detail) ; if the first model treats some aspect and one with many variables and than the second model, the first model criterion would be content the two models are incomparable simpler, a modeling is intuitively the second to choose 3.3. Summary In summary, we define a scenario model as adequate for a given prediction question if and only if the model satisfies the following constraints: l Its variables variable appearing straint 2). include every variable of interest in an activity precondition (Adequacy Constraint of its influences 1) and every (Adequacy Con- is adequate l Its system boundary l Its influences on each dependent (Adequacy Constraints 3 and 4). variable are adequate (Adequacy Constraints 5, 6, 7, and 8). l Its entities are coherent (Adequacy Constraint (Adequacy Constraint 9) and appropriate for the question 10). l It relates Constraint the driving variables of the question to the variables of interest (Adequacy 11). Among the adequate scenario models for a question, are the simplest, and the modeler’s objective models. those with the fewest variables is to find one of these simplest adequate 4. Model construction algorithm Together, Sections 2 and 3 define and a prediction question, scription answering subtasks. the question. This section presents algorithms for performing the model construction construct a simplest adequate task: given a system de- for scenario model the task and its 4.1. Extending partial models There are many possible models of a complex system, so finding a simplest adequate is difficult. To find such a model efficiently, TRIPEL searches the space of partial ruling out most models without ever generating model models of the system, them. A partial model satisfies in addition to exogenous tion: After a modeler has chosen has decided whether partial model with free variables the definition of a scenario model with one possible excep- free variables. the modeler is free. Thus, a to include a variable to treat it as exogenous or dependent, and dependent variables, in a model, but before it may contain the variable represents a model still under construction. 224 .I. Rickel, B. Pwter/Artijicial Intelligence 93 (1997) 201-260 Formally, a partial model consists of the following: l a set of variables (a subset of the variables in the system description) partitioned into exogenous variables, dependent variables, and free variables, l a set of influences influencee of whose another variable (a subset of the influences is a dependent variable in the system description), in the model and whose influencer each is in the model (exogenous, dependent or free). Note that a scenario model, as defined model, one with no free variables. in Section 3, is simply a special type of partial a partial model m, Partial models are ordered by an extension is an extension of a partial model m if and only from m by making additional modeling decisions. More precisely, m, is an extension of m if and only if m and m, are not identical and all of the following conditions if m, can be constructed are satisfied: Intuitively, relation. in m and m,. in m is also in m,, l every variable l every exogenous variable l every dependent variable l the set of influences on the dependent variables of m are identical These conditions in m is an exogenous variable in m is a dependent variable in m,, in m,, or dependent, and by adding the amount of leaf mesophyll ABA is a dependent variable, allow a partial model to be extended by adding variables, by deciding to treat a free variable as exogenous influences on free variables or new variables. For example, part A of Fig. 6 shows a partial model in which the amount of leaf mesophyll ABA is a free variable, and Part B shows an extension. In the extension, on it are included, and two new free variables is an ordering relation (the influencers) are included. like <. That is, it is irreflexive (no partial model (no two partial models are extensions of each other), and transitive. The definition of simplicity used for scenario models applies to partial models as well, so a partial model is at least as simple as any of its extensions, because any extension has at least as many variables. is an extension of itself), asymmetric The extension the influences relation One key to efficient model construction that a given partial into an adequate scenario model. The adequacy constraints is the ability to recognize model cannot be extended in Section 3.1, although defined well. A partial model to remedy (Include However, variables of interest), the violation; that violates an adequacy constraint in terms of scenario models, apply to partial models as can sometimes be extended I the variables of interest. if a partial model violates Adequacy Constraint it can be extended to include for example, a partial model can be eliminated constraint. A morzotonic constraint is violated includes mutually for a partial model, monotonic violated a partial model pruning extensions, extension Section 4.3.3 lists those adequacy constraints We illustrate TRIPEL'S model construction such a partial model effectively pruning is transitive, relation it violates a from consideration when is an adequacy constraint which, when for each of its extensions. For instance, when its extensions. By any of its the so will all TRIPEL avoids generating from consideration, a large chunk from the search space. so a single partial model may have many extensions.) (Remember, incoherent entities, that are monotonic. to the amount of ABA in a plant’s guard cells when the turgor pressure algorithm using the familiar question “What in its for this Fig. 3 (p. 216) shows a portion of the system description earlier, the appropriate time scale of interest is minutes. happens leaves decreases?’ question. As mentioned J. Rickel, B. Pmer/Artificiul Intelligence 93 (I 997) 201-260 22s leaf mesophyll ABA amount ABA transport rate + (A) A Partial Model ABA synthesis rate --t-+ mins leaf mesophyll A- ABA amount 4 -1, mins ABA consumption rate ABA transport _ rate mins + + -- N cell ABA guard mins amount + ’ *4 cell ABA guard mms amount - (B) An Extension Fig. 6. (A) A partial model. The variable leaf mesophyll ABA amount is free. (B) An extension of that partial model. The variables ABA synthesis rate and ABA consumption rate are free. extends through algorithm, the possibilities. shown To construct an adequate scenario model, TRIPEL starts with a partial model consisting only of the variables of interest, and it incrementally this model until it satisfies all the adequacy constraints. At each step, there may be alternative ways of extending the model, so it must search The model construction in Fig. 7, can be viewed as graph search. Each node in the search graph is a partial model. The initial node in the search is a partial mode1 consisting only of the variables of interest, each a free variable. For instance, the of one free variable, guard initial node for the example cell ABA amount. As will be described below, a partial model’s successors in the search is to find a simplest graph consist of some of its extensions. The goal of the search adequate scenario model for the question. the path by which a goal node is found A best-first strategy guides the simplicity criterion as the evaluation the simplest partial function. That If the partial model model scenario model; every other partial model on the agenda has as many or more variables, so they is irrelevant.) the search, using (Unlike some graph search problems, the one with the fewest variables) (i.e., is an adequate is a partial model consisting is, TRIPEL always extends from the search agenda. the search by removing as a simplest adequate scenario model, it is returned 226 .I. Rickel, B. Porter/Artificial Intelligence 93 (I 997) 201-260 Find-adequate-model (S, Q) /* S is a system description, agenda +- 0 let initial be a partial model consisting of the variables of interest, each free if initial satisfies all monotonic and Q is a prediction question */ constraints then add initial to agenda is not empty while agenda remove if m is an adequate scenario model the simplest partial model m from agenda then return m else for each partial model m’ in Extend-model(m, S, Q) if m’ satisfies all monotonic then add m’ to agenda constraints return failure Extend-model (m, S, Q) /* m is a partial model, S is a system description, if all free variables then mark all free variables in m can be exogenous in m as exogenous and Q is a prediction question */ return {m} else let v be a free variable in m that must be dependent t 0 models for each m,. in Dv-models(v, S, Q) extend m with m,. m’ t add m’ to models return models Fig. 7. TRIPEL'S model construction algorithm. and their extensions simplest one on the agenda a free variable, cannot be simpler. In the example, (in fact, the only one), so it is removed. Because the initial partial model is the it contains it is not an adequate scenario model. If the partial model it is not a scenario model, hence is not an adequate scenario model, returns it on the successors of a given partial the function extends m with alternative ways of its successors replace the search agenda. The function Extend-model model m. To generate modeling one of m’s free variables. this, Extend-model these successors, To accomplish first asks the System Boundary Selector in Section 4.3) whether all of m’s free variables can be exogenous satisfy Adequacy Constraints as exogenous example, cell ABA specifically, variable the case. The free variable because it is significantly turgor pressure) on the time scale of interest (discussed they 3 and 4). If so, Extend-model marks each free variable In our in the initial partial mode1 (guard 4; it violates Adequacy Constraint influenced by the driving scenario mode1 as the only successor. and returns is not cannot be exogenous in Fig. 3 (p. 216), this amount) (i.e., whether the resulting as shown (minutes). (leaf J. Rickel, B. Porter/Artificial Inte&ence 93 (1997) 201-260 227 When the System Boundary Selector’s response is “no”, it also tells Extend-model (in the example, guard cell ABA amount). asks the function Dv-models of influences on v that might be adequate (described in Section 4.2) for the question 5, 6, 7, and 8). In our example, Dv-models simply In this for those (i.e., satisfy the rate. In returns influence on guard cell ABA amount, the influence of the ABA transport returns a set of new partial models, each the result of extending which variable v must be dependent case, Extend-model combinations Adequacy Constraints only general, Extend-model m with one of these combinations of influences. To extend m with a combination of influences, Extend-model marks v as dependent, adds the influences on v to the model, and adds any new free variables. A free variable is added in the following cases: of a new l If the influencer influence is not already in m, it is added as a free variable. l If a variable in the activity preconditions of a new influence is not already in m, it is added as a free variable Before adding a partial model node in the search or a successor the model violates a monotonic of its extensions not violate any monotonic (to satisfy Adequacy Constraint 2). to the agenda returned by Extend-model), (whether the partial model is the initial TRIPEL checks whether If so, it is pruned from the search, since none in our example does constraint. is an adequate scenario model. The partial model so it is added to the agenda. constraints, The search ends with success when a simplest adequate scenario model is found. In the search ends with failure when the search agenda becomes empty, because contrast, this indicates that no adequate scenario model exists. Fig. 8 illustrates the search graph that TRIPEL generates node from the top has two successors because influences on leaf mesophyll ABA amount: sumption, that exptain it f for simplicity, and the second includes for the example. The third of the influence of ABA con- the influences of ABA binding and ABA degradation there are two adequate combinations the first includes those influences were not shown in Fig. 3). 4.2. Choosing injluences on dependent variables A modeler must choose an adequate set of influences on each dependent variable In TRIPEL, this task arises in the function Extend-model in a and it is performed by to model a variable as dependent, Extend-model set of influences include a system description, on the variable. As illustrated in a prediction question, and model. the function Dv-models. After deciding asks Dv-models Fig. 7, the inputs a variable whose for an adequate to Dv-models influences are desired. than one adequate it may be possible There may be more effects of processes, instance, the dynamic set of influences to use either differential or functional of those processes. Also, one adequate For sent quasi-static the influences leaf mesophyll ABA amount influences tial model for each one, and the function Find-adequate-model by the model constructor. Extend-model that explain an influence in another adequate for consideration approximation set may contain set, as with the variable set of creates a new par- tests each new partial for a dependent influences, which variable. repre- a influences, which represent in Fig. 8. Dv-models must return each alternative 228 J. Rickel, B. Porter/Art&in1 Intelligence 93 (1997) 201-260 Fig. 8. The search graph for the question “What happens the turgor pressure partial model to its successors. The heavy box indicates returned by the model construction to the amount of ABA in a plant’s guard cells when in its leaves decreases. 7” Boxes indicate partial models, and dashed arrows point from a scenario model (the goal node the simplest adequate algorithm). model to see which ones represent a potentially model. adequate extension of the current partial Section 3.1.3 specified the criteria for determining whether a set of influences on a dependent variable is adequate: l The influences must be approximately influencing phenomena complete; all at some level of detail (Adequacy Constraint 7). that is, they must represent significant l The influences must represent valid approximations l The influences must be mutually coherent Because Adequacy Constraint 5 requires (Adequacy Constraints 5 and 8). the influences on a dependent variable (Adequacy Constraint 6). the same type (i.e., differential of functional the adequate influences sets of influences or functional), and sets of differential can separately consider Dv-models influences. After separately generating influences and those that that contain only differential to have sets J. Rickei, B. Porter/Art$cial intelligence 93 (1997) 201-260 229 amount (pool (COz, leaves) ) += rate( CO*-diffusion( atmosphere, leaves) ) significance preconditions: time-scale-of-interest 3 seconds amountf pool ((202, leaves) ) e= rate{ photosynthesis( leaves) ) significance preconditions: time-scale-of-interest 3 minutes amount( pool (CO2, leaves) ) += rate( dark-reactions( leaves) ) significance preconditions: time-scale-of-interest 3 minutes Explanation{ amount(pool( COZ, leaves) ) e= rate{ photosynthesis( (CO2, leaves) ) += rate( dark-reactions( amount(poo1 leaves) > , leaves) ) ) Fig. 9. Influences on the amount of carbon dioxide aggregate not by any other influences. The influence of photosynthesis influences 1. in a plant’s is explained by the influence of the dark reactions leaves. The first two are the maximally (and contain only functional of this section presents influence a given influences, the algorithm type (either one). it returns the union of these two sets. The remainder for generating the adequate sets of influences for Given a system description, a prediction question, and a dependent variable to be mod- eled. Dv-models generates as follows: or functional) the adequate sets of influences of a given type (differential every complete set of influences It generates (i.e., those sets of influences dependent variable that affect the variable). Section 3.1.3 defined l The set of all maximally (i.e., aggregate variable l The result of replacing an influence the specified (of that represent all the phenomena type) on the these as follows: influences of the specified type on the those that do not explain any other influence) is complete. in a complete set with the set of all influ- is a complete relation) set it (as specified by the explanation resulting that explain is approximately these sets, it removes any influences ences set. From question. Each tion 3.1.3), so each satisfies Adequacy Constraint 7. It discards any set that contains an influence tion. Any such set of influences Constraint 6. It discards quacy Constraint relation). two influences is inadequate it includes 8 (i.e., that are insignificant complete (as defined for the given in Sec- that is invalid because for the given ques- it vioiates Adequacy any set that is incoherent. A set is incoherent if it violates Ade- related by the explanation* (1) (2) (3) (4) For example, consider that seconds and assume lows: the influences shown as Fig. 5) in Fig. 9 (previously is the time scale of interest. The algorithm proceeds as fol- shown ( I ) As discussed second influences in Section 3.1.3, and (ii) there are two complete the first and third influences. sets: (i) the first and 230 .I. Ricked, B. Porter/Artificial Intelligence 93 (1997) 201-260 cross-section-~ea( stomates) +- amount (pool (water, guard-cells) ) cross-section-area{ stomates) +- amount (pool ( ABA, guard-cells) ) validity preconditions: time-scale-of-interest 3 hours cross-section-areaf stomates) +- amount(pool(CO2, guard-cells)) validity p~onditions: time-scale-of-interest >, hours Explanation( cross-section-area( cross-section-area( stomates) stomates) c amount (pool (ABA, guard-cells) (water, guard-cells) c- amount(poo1 ) , ) ) Explanation( cross-section-area( cross-section-area{ stomates) +- amount~pool stomates) +-- amount( pool (water, guard-cells) > ) (COz, guard-cells) ), Fig. 10. Influences on the cross sectional area of a plant’s stomates. The second and third influences are each explained by the first influence. (2) In the first set, the photosynthesis of interest, seconds), reactions sets, each of which identical, one is pruned and the other is passed to step (3). so it is removed. This the diffusion is insignificant, includes only so it is removed. Similarly, is insignificant influence influence the time scale in the second set, the dark two identical the sets are influence. Because leaves (on (3) The set does not include an invalid (4) The set is coherent, so it is not discarded. Therefore, As another example, consider the influences influence, shown in Fig. 10 and assume it is returned by Dv-models. that hours so it is not discarded. is the time scale of interest. The algorithm proceeds as follows: four complete sets: the second and third in~~ences the first and third influences influences (since (since the first explains from either of the previous (the the first the two). is insignificant, is invalid, so no set is changed. However, so no set is changed. if the time scale (e.g., seconds or minutes), any set containing (1) (2) (3) (4) aggregate the second), influences), the first and second The algorithm generates maximally explains third), and the first influence alone (generated None of the influences None of the influences of interest were less than hours the second or third influence would be discarded. Two of the four sets are incoherent the one that includes first and third the two surviving sets: the one that includes the one that includes only the first influence. the first and second influences. These (i.e., two sets are discarded, and Dv-models the second and third influences, they violate Adequacy Constraint influences, and the one that includes 8): the returns and Dv-models can recognize when there are no adequate sets of influences on a variable. the first influence in Fig. IO, but suppose is missing). If the time scale no set will survive step (3), Thus, shown that level of detail (e.g., seconds or minutes), the empty set (i.e., no adequate For example, consider is not in the system description of interest so Dv-models will return sets of influences). is less than hours the influences (i.e., J. Rickel, B. Porter/Artificial Intelligence 93 (1997) 201-260 231 Extend-model will return consideration a phenomenon valid way of modeling the empty set (i.e., no successors) cannot be adequately extended. The key is that each influence to be modeled; if the phenomenon is significant, Dv-models must find a ; the partial model under represents it, either with that influence or an alternative level of detail. 4.3. Choosing e.xogenous variables System boundary system description, Extend-model nous. Such decisions be extended by those influences). arise asks the System Boundary Selector whether in the successor function Extend-model. Given a decisions a prediction question, a partial model and one of its free variables, the variable can be exoge- the model must (referenced if the variable must be dependent, (on that variable) and variables are important; influences to include additional The System Boundary Selector’s response nous) or “no” (the variable must be dependent), is either “yes” (the variable can be exoge- as follows: interpreted l If the response is “yes”, then the variable can be exogenous in any extension of the partial model that does not contain additional variables. then the variable must be dependent l If the response is “no”, the partial model. That is, no extension adequate scenario model. in which the variable in every extension of is an is exogenous from Section 4.1 how Extend-model If the response the variable as dependent Recall response. marks it. In contrast, only marks The System Boundary Selector’s the variable as exogenous if the response and extends response is “no” (the variable must be dependent), the partial model the System Boundary Selector’s Extend-model influences on Extend-model if all other free variables can also be exogenous. to include is “yes” (the variable can be exogenous), justifies Extend-model’s uses for choosing exogenous variables were specified actions. in Section 3.1.2: 3-A influenced variable in the system description in a scenario model cannot be exogenous by another variable if in the The criteria l Adequacy Constraint it is significantly model. l Adequacy Constraint 4-A it is significantly than itself if it is a driving variable). are stated these constraints influenced Although in a scenario model cannot be exogenous variable in the system description by a driving variable if (other in terms of scenario models, they apply to that the variable cannot be are monotonic; in any extension of the partial model either. In this case, the System Boundary in a partial model violates one of the constraints, partial models as well. As shown in Appendix A.l, both constraints is, if a variable exogenous Selector can answer “no” variable with the same variables. extension with additional answer “yes” task simply (The variable might not satisfy Adequacy Constraint variables.) (the variable can be exogenous). in a partial model satisfies both constraints, to test these two constraints. 3 in an the System Boundary Selector can selection (the variable cannot be exogenous). On the other hand, the system boundary it can be exogenous in any extension In this case, Thus, if a requires These constraints the ability can be tested by a graph connectivity algorithm. Recall from Sec- is an if and only if there tion 3.1.2 that one variable significantly influences another 232 J. Rickel, B. Porter/Artificial Intelligence 93 (1997) 201-260 in the path is valid and significant leading from the first variable to the second for the given question. Thus, a in a partial model can be exogenous if and only if the graph algorithm influence influence path (in the system description) and every free variable finds no such path leading any other variable in the model. to the variable from any driving variable of the question or However, it would be inefficient to run the graph algorithm anew for each system decision. Each run of the graph algorithm will repeat much of the search runs. To avoid this problem, TRIPEL performs a system bound- the search for an adequate scenario model. The system to the all variables and influences the variables. These the space that would be repeatedly is given boundary performed by previous aq analysis before beginning boundary analysis determines question, and it computes and caches connectivity potentially searched by the graph algorithm. The algorithm in Section 4.3.1. relevant variables and influences constitute for system boundary analysis that might be relevant relations among The result of the system boundary analysis between every pair of potentially influences is a Boolean connectivi@ matrix. This relevant variables. That the the jth variable for purposes of answering matrix records the connectivity is, the ith variable significantly given question if and only if the (i, j) cell of the matrix contains a 1. scenario model as described Once system boundary analysis is complete, TRIPEL begins earlier. Using that arise during model construction adequate boundary decisions partial model must be dependent the variable violates Adequacy Constraint 3 or 4. In this case, the System Boundary Selector returns “no” (the variable cannot be exogenous). Otherwise, its search for the simplest system in a to the connectivity matrix, are trivial. A free variable the connectivity matrix, it returns “yes”. if, according 4.3.1. System boundary analysis The variables they include all variables in the connectivity matrix are called because precisely, construction. might be added to a partial model during model construction. We define the potentially relevant variables and influences the potentially relevant variables the question. More to answering that might be added to a partial model during model that they include any variable that might be relevant the potentially as follows: Similarly, influence injuences relevant include any l The variables of interest are each potentially l If a variable is potentially relevant. (for the given question) relevant, any influence on it that is valid and significant influence. is a potentially relevant l The influencer of every potentially l Any variable appearing in the activity preconditions relevant influence is potentially of a potentially relevant. relevant influ- ence is potentially This definition mirrors during model construction. relevant. the steps that add variables and influences to partial models The System Boundary Selector finds the potentially search using a breadth-first is marked as potentially of the search, a variable fluence on that variable through relevant variables and influences the influence graph. First, each variable of interest relevant and placed on the search agenda. On each iteration in- is removed its the agenda, and each valid, significant relevant. For each such influence, is marked as potentially from J. Rickel, B. Pnrter/Art$cial Intelligence 93 (1997) 201-260 233 in its activity preconditions are marked as potentially is placed on the agenda unless rel- it had previously and the variables influencer evant. Each newly marked variable appeared on it. The search ends when the search are those that are not significantly on time scales slower influenced loops). When been marked. only by variables discovered the search ends, all potentially than the time scale of interest) the agenda is empty; influenced (e.g., the terminal variables in those that are regulated and those that are significantly feedback have influences through (i.e., and earlier in the search relevant variables to the consider To illustrate this algorithm, and water uptake on xylem water “What happens in its leaves decreases?’ for this question. The search relevant variables and influences begins with the influences on guard cell on leaf mesophyll water (middle of left the time the familiar question amount of ABA in a plant’s guard cells when the turgor pressure Part A of Fig. 11 repeats a portion of the system description for potentialIy ABA amount. The influences of transpiration side) scale of interest relevant variables through loop influences. Part B shows the result, the potentiaIly the example. For comparison, part C shows the simplest adequate model for the question (as described these two influences disconnects variables and influences, those other variables relevant variables and influences the potentially the feedback and for (minutes); from transpiration, thus allowing TRIPEL to ignore removing the remaining left) are insignificant in Section 4.1). including (lower on the search for potentially and ecosystems, modularity As illustrated by the example, such as plants, animals, time scales at which processes cause change relevant variables and influ- ences will typically have to traverse only a fraction of the influence graph. In complex the widely systems, disparate The result processes acting within a subsys- is a hierarchy of nearly decomposable cause tem cause significant that change more slowly are signi~cant only on slower time scales, thus isolating in their relevant variables and own nearly decomposable influences from other subsystems are insignificant. change quickly, while processes acting act-us subsystems [ 2,28,40,5 subsystem. The search for potentially the influences 11. The time scale of interest to this subsystem because the variables of interest filters out influences [2,28,40,47,49]. arises from subsystems; is confined relevant variables and influences, the System the subgraph relevant variables and influences. in Section 3.1.2, the nodes of this subgraph are the potentially it constructs if there is a is the second variable and for which the to another in the activity preconditions. The connectivity After determining the graph of potentially relevant the connectivity matrix. First, to the potentially Boundary Seiector constructs of the influence graph corresponding Analogous to the definition relevant variables, and there is a directed edge from one variable potentially influence whose infuencee first variable matrix the subgraph, algorithm relevant variables) As discussed the connectivity matrix can be computed efficiently; time, where it in 0(n3) in the subgraph is the in~uencer or appears is simply computes earlier, [ 71. a partial model can be exogenous connectivity matrix is guaranteed by checking cells to include every variable the System Boundary Selector decides whether a variable in in the connectivity matrix. The for which a system bound- IZ is the number of nodes the Floyd-Warshall (potentially the adjacency matrix for the transitive closure of this subgraph. Given 234 J. Rickel. B. Porter/Art@5ul Intelligence 93 (1997) 201-260 ABA synthesis riltc .ec mins leaf mesophyll ABA >Ull<W”l _ 4 ABA uanspovt m’nS _ I~te guard C min;. cell ABA--L- amount + t‘illc k+ active ,~ansport __. .-c__ @aNI -- cell carbon dioxide leaf turgor pressure 4 -t mins I+ + ’ ABA wnsumpli0n r&c 4 mins niins . accessory cells k+ UnO”“, ), mins + ; guaa.l cdl kt ilmO”nl 1 - mins + Fig. II. (A) A portion of the system description for the question “What happens to the amount of ABA in a plant’s guard cells when the turgor pressure in its leaves decreases. 7” The driving variable and variable of interest are shown in bold. Ellipses indicate connections to the remaining variables and influences. Alternative levels of detail are not shown. (B) The potentially relevant variables and influences for the question. (C) The simplest adequate scenario model for the question. ary decision might be required, because influences mirrors and during model construction. nectivity matrix accurately other. the steps the definition of potentially influences and that add variables Furthe~ore, reflects whether one variable the following theorem ensures significantly relevant variables to partial models that the con- an- influences J. Rickel, B. Porter/Artificial Intelligence 93 (1997) 201-260 235 For a given system description and pre- Theorem 1 (Connectivity matrix diction question, cell (i, j) of the connectivity matrix contains a 1 if and only if the ith variable signi.cantly the jth variable for that question. is correct). in$uences Proof. See Appendix A.2. 0 To determine whether a variable can be exogenous, is not significantly that the variable that every driving variable must ensure (Adequacy Constraint 4). However, not ensure may not appear matrix are only significantly deciding whether a variable can be exogenous, that the variable matrix. is not significantly in the connectivity matrix. Nevertheless, influenced by other variables is potentially the definition of potentially influenced the System Boundary Selector by any driving variable relevant variables does relevant, so some driving variables in the connectivity variables in the matrix. Therefore, when the System Boundary Selector knows that is not in the influenced by any driving variable 4.3.2. Extensibility is an important part of constructing Choosing exogenous variables quate model. Our design encapsulates an independent module of TRIPEL. This allows changes exogenous Similarly, determining whether an influence interest, but other criteria could be used instead or in addition. variables without such decisions requiring changes a simple yet ade- in the System Boundary Selector, for choosing algorithm. in the criteria in the model construction the System Boundary Selector does not depend on the particular criteria for is valid and significant. TRIPEL uses a time scale of For complex systems, in which variables is crucial are highly to achieving interconnected, a suitable influences insignificant is also required recognize to keep the number of potentially This ability hence small. Therefore, System Boundary Selector will improve as more sophisticated incorporated the size of the connectivity matrix) into TRIPEL, as will be discussed in Section 5. to the ability system boundary. (and of the criteria are relevant variables the performance significance 4.3.3. The role of each adequacy constraint The adequacy constraints from Section 3.1 serve different roles in the model construc- is used to construct tion algorithm. Adequacy Constraint the initial partial model on the agenda, and Adequacy Constraint 2 (Include variables for in activity preconditions) is used by Extend-model a partial model being extended. These constraints constraints: that must be added for the when violated constraint to identify new free variables are both propagation I (Include variables of interest) to constraint propagation). in a partial model, to be satisfied the elements they specify (analogous Some monotonic constraints serve as filters. As shown Constraints are both monotonic, influenced) model variables, 9 (Entities coherent) and 10 (Entities and Adequacy Constraint is monotonic when applied to models is added to the search agenda only if it satisfies the first two constraints.) it need only satisfy in Appendix A. 1, Adequacy compatible with driving variables) 11 (Variables of interest differentially that have no free variables. A partial (If it has free these constraints. 236 .I. Ricked, B. Porter/Artijicial Intelligence 93 (1997) 201-260 constraints, The remaining into the subroutines independent are 3 (Exoge- folded nous variables of ques- tion) are tested by the System Boundary Selector, and Adequacy Constraints 5 (Influ- and 8 (Influences ences homogeneous), not redundant) although monotonic of Find-adequate-model. of model) and 4 (Exogenous variables valid), 7 (Influences are enforced by the function Dv-models. Adequacy Constraints in Appendix A.l), 6 (Influences independent (as shown complete), For extensibility, TRIPEL is designed con- so- constraints. This allows TRIPEL to incorporate in its modeling criteria, such as new criteria for determining whether models to easily accommodate new monotonic additional straints and propagation phistication are coherent, without changes in its model construction algorithm. 4.4. Properties of the model construction algorithm To ensure an efficient search for a solution, a search algorithm must avoid redundancy. a record of nodes does not keep a record of partial models Typically, a graph search algorithm avoids redundancy by maintaining it has visited. However, Find-adequate-model that it has visited because of the following theorem. Theorem 2 (Search adequate-model, from the initial partial model. is not redundant). In the search graph constructed a given partial model cannot be reached via more by Find- than one path a different the influences on that model’s dependent (by definition of Extend-model). Each successor successors only when one of its free variables in this case set of influences on that variable. Since an extension of a partial variables, no two suc- if a partial model represent disjoint starts with a single set Proof. A partial model has multiple is chosen as dependent contains model cannot change cessors of a partial model can share a common is viewed as representing subsets of its extensions. Viewed this way, Find-adequate-model (the initial partial model) and repeatedly it is not possible descendant. splits one set into disjoint subsets. Therefore, to have a common extension. Thus, its successors itself and all its extensions, in the search graph two partial models for any q Thus, Find-adequate-model is a version of the well-known algorithm proofs rely on this “split and prune” view of the algorithm. [41], and the search graph it constructs is a tree. Subsequent “split and prune” search theorems and Conceptually, Find-adequate-model operates by repeatedly pruning parts of the search space from consideration. When each iteration of the while loop begins, part of the search space has been pruned the partial are still under consideration. This models on the agenda, along with all their extensions, set of partial models that the theorem ensures that each iteration of the while loop decreases search will always the size of the consideration is the consideration terminate by showing and part remains. Specifically, set. The following from consideration set. Theorem 3. Find-adequate-model always terminates. J. Rick4 B. Porter/Art$icial Intelfigence 93 (I 997) 201-260 231 individual Proof. Every scription For a finite system description, initial consideration partial model on the agenda the while loop must eventually step in the algorithm always terminates because the system de- is finite. Thus, Find-adequate-model will terminate if its while loop terminates. set is finite. Every iteration of the while loop removes there are only a finite set of unique partial models, so the the simplest its size. Therefore, from the consideration set, decreasing terminate. 0 Most importantly, Find-adequate-model is admissible exists algorithm a solution to return a simplest exists. Conceptually, if it is guaranteed [417. Find-ad~uat~model adequate the algorithm is admissible scenario model whenever to return an optimal is an admissible search algorithm. A search solution whenever it is guaranteed scenario model strat- because an adequate the following is admissible because it uses egy : l From its initial consideration set, which includes all adequate scenario models, it l It never prunes a scenario model unless either ( 1) the model repeatedly prunes away models until only a single scenario model (if any) remains. for the there is an adequate scenario model still is inadequate if the model question or (2) in the consideration is adequate, set that is at least as simple. Theorem 4 (Model construction and a prediction question for which some scenario model is adequate, Find-adequate- model wilt return a simplest adequate scenario model. is admissible). Given a system description algorithm Proof. See Appendix A.3. ci 4.5. Previous model construction algorithms and Forbus Falkenhainer tion. Each model terize constraints on the use of assumptions: the phenomena it represents fragment has associated [ 121 take a knowledge-based “~sumptions”, to model construc- that charac- labels and its level of detail. Domain knowledge provides approach symbolic l Assumptions sumption are organized into “assumption classes”. The assumptions in an as- class represent mutually incompatible modeling alternatives. l The domain knowledge provides domain-specific constraints among assumptions, l For each assumption ditions under which alternative such as that one assumption class, it is relevant. An adequate class. terms (e.g., variables) requires another. the domain knowledge must specify from each relevant assumption specifies In their modeling task, a question scenario model must the scenario con- include one of interest. Their that satisfy all the domain constraints is to find a minimal that the model includes set of assumptions algorithm (“dynamic unlike ours, most criteria constant the terms of interest. They accomplish [ 371). satisfaction” for model adequacy they have no counterpart of our function Dv-models, (model into coherent bundles are implicit influences to group this with a in objective and ensure constraint satisfaction In their framework, the domain knowledge. Because they require the domain knowledge 238 J. Rick4 B. Portrr/Art@cial Inrelligence 93 (1997) 20/-21X conditions such “modeling the domain knowledge among modeling or domain-specific knowledge” task. Moreover, to provide alternatives, For- so that it ensures an adequate model could be it is not clear how to encode some constraints, fragments). Also, our algorithm does not require relevance constraints mulating a difficult, error prone such as Adequacy Constraint 11 (Variables of interest differentially language. independent criteria, need for domain-specific modeling knowledge has been a driving motivation work. in their In place of domain-specific modeling knowledge, TIUPEL relies on domain- these the for our that specify when a model is adequate. When a model violates tells TRIPEL how to extend the model. Removing the particular influenced), violation criteria A second approach to model construction it. Wifiiams’ method in three ways: the variables of interest do not causally depend into a scenario model by our algorithm), certain variables for generating is to start with the most detailed model abstraction” influences are never the method removes influences a “critical (such (1) (2) the method algebraically simplify the detailed model intermediate (3) to answer and repeatedly [ 541 simplifies on which introduced eliminates ables of interest, and are not needed fies the detailed model by removing to eliminating simplifies ing one model (typically, fragment ) . this corresponds fragment with another to omitting insignificant the detailed model by (1) eliminating the method algebraically the question. Yip’s modeling terms insignificant influences). Nayak’s modeling if they are neither driving variables nor vari- that abstracts quantitative simpli- algorithm (analogous [ 381 repeatedly replac- of it in the original model or (2) a “causal approximation” irrelevant phenomena some of the influences in the equations that represents algorithm 156,571 details For complex systems, which include many phenomena simplifying the approach of repeatedly that can be described at many is the most detailed model the number of is far greater that would have to be added to an empty model. For this adequate model of a complex the most-detailed model system, from levels of detail, impractical. To find a simplest elements than the number of elements reason, TRIPEL takes the latter approach. Recent work by Nayak and Joskowicz that would have to be removed [ 391 addresses the impracticality of simplifying requires simplify of the driving variables the ways in which different components the most-detailed model. Their method rules that specify (“component 1381 to repeatedly than to provide system can interact a most-detailed model. Their method generates an initial, overly detailed model and then it. Their hope is that the initial applies Nayak’s algorithnl the model will be far simpler domain knowledge of the physical a model consisting constructs system applied initial model, because most aspects of a complex indirectly. To achieve a simpler rules description, criteria and model construction Starting with their algorithm the initial, overly detailed model by repeatedly adding aspects of the physical that can interact with those aspects currently in the model. ~nfortunateIy, when to complex systems such as a plant, their approach will result in a very detailed interact either directly or interaction in the system just as our adequacy they will require component and criteria for determining significance of interactions, and variables of interest, interaction heuristics”). that are sensitive to the question, levels of detail algorithm are. initial model, the available system J. Rickel, B. Porter/Artijicinl Intellijience 93 (1997) 201-260 239 Nayak [38] proves that his model simplification that are inappropriate in Section 3.2, his simplicity some of these models are intuitively much simpler algorithm will reach a simplest ad- in the size of the system description. However, his task we leave many models than search. If as they are under our simplicity this to find a simplest adequate model. Second, his criteria by using a hill-climbing for the modeling criterion, criteria in time polynomial exploits his simplicity equate model results depend on several assumptions address. First, as discussed though even incomparable, others. His algorithm more of the models were comparable, search strategy would not be guaranteed search strategy hill-climbing has its own set of modeling for modeling one phenomenon However, our modeling tity can aggregate influences. Aggregation systems, but they violate Nayak’s assumption. We investigated ing Nayak’s approach level of description every for every related phenomenon; scription that seems use of influences the advantages of using TRIPEL'S algorithm to handle aggregation, for a phenomenon, for model construction are crucial framework hierarchies fragments, influences in model independent that every phenomenon requires alternatives of how the other phenomena in the system description and that the modeler can choose an alternative are modeled. one en- several other entities, and one influence can aggregate several other simple models of complex to achieving the possibility of extend- that, for is built around aggregation of phenomena: require assuming but it would there is a compatible level of description as the building blocks for models. lo is most similar to the one used by Iwasaki [ 231. Their algorithm starts with a partial model consisting of the variables of to include the model the influences on free variables. the two algorithms. First, their algorithm has their algorithm has fragments combination that each compatible the person encoding the model choosing exogenous variables. Second, for automatically of our function Dv-models; and Levy interest, and it repeatedly extends There are three major differences between no method no counterpart and the constraints of model fragments yields an adequate set of influences. Finally, simplicity criteria are intuitively much simpler they are under our simplicity a simplest adequate model. ” differences: than others; criterion, In addition among assumptions must ensure leave many models incomparable, if more of the models were comparable, their search strategy would not necessarily [ 381, their like Nayak even though some of these models as find there are other to these primary differences, this requires a level of completeness impractical. Finally, his proofs currently place restrictions in the system de- on the and these restrictions would seriously diminish l They allow the activity preconditions addition to inequalities extends a model by considering can also extend a model and useful extension of TRIPEL'S approach. to include of a model fragment among variables. Thus, while TRIPEL'S algorithm the influences on a free variable, in always their algorithm influences on these predicates. This is a natural to include predicates believes (personal communication) I” Nayak influences. ” In fact, despite Levy’s proof [ 34 1, their algorithm does not necessarily by their own criteria; adequate model. To repair definition their algorithm adds more elements (Levy, personal communication). they are currently modifying the proof, to models find a simplest adequate model even than are required by their definition of an the algorithm and extending the adequacy that the proofs could be extended to accommodate our use of 240 J. Rickel, 6. Porter/Artificial Intelligence 93 (1997) 201-260 in the system description do not have a causal is complete, to extend the chosen free vari- is only assigned after the model [24]. This requires their algorithm influence” result in larger models with more irrelevant phenomena. should be given a causal direction before model [ 161. However, our approach has worked well in other domains. domain, and we expect similar success l In their representation, influences that could “possibly algorithm to include all variables direction. The direction of causality using a causal ordering models able, which will generally The question of whether construction in the plant physiology Elsewhere given a causal direction before model construction, be extended l Their algorithm influences is still open influences to handle begins [44], we argue that, regardless of the domain, most influences can be and we show how TRIPEL could for which this is not possible. relies on a strong assumption to guarantee assumption”) the system description (the in an adequate (i.e., have the same number of equations as dependent to ensure that the models about that the equations is designed In contrast, our modeling algorithm coherence “library scenario model are complete variables). it constructs l Their algorithm are complete. is guaranteed description the same assumptions [ 341. However, Several people have explored an approach [ 1,3,52]. After constructing against to the model, and the process driven refinement” its predictions finements obtained. We have not used behavior because TRIPEL provides a more sophisticated than these algorithms in these algorithms. to run in time polynomial that result does not apply as the similar result of Nayak in the size of the system to our task since it relies on [38] discussed earlier. the known behavior of the system. Discrepancies is repeated until a suf~~iently this approach because we do not assume to model construction an initial model, called “discrepancy- the modeler compares re- suggest is close match that the correct is known, However, when it is, these algorithms are complementary to TRIPEL, the initial model currently use. Thus, TRIPEL could serve as a valuable subroutine to constructing approach 5. Empirical evaluation issues that must be empirically There are two important returns a simplest adequate mode1 when the quality of the models TRIPEL constructs. Section 4.4 proved concerns always nothing about whether notions of simpiicity complex large. TRIPEL will only be practical describes our empirical evaluation of these two issues. evaluated. The first issue that TRIPEL there is one. Wowever, the proof says the definition of a simplest adequate model matches our intuitive issue concerns TRIPEL'S efficiency. For the space of possible models are very if it can cope with such complexity. This section and adequacy. The second and the system description systems, Previous automated modeling programs were tested on handcrafted is, the program’s designers built a knowledge base and constructed strate examples capabilities. Our goal was a more rigorous evaluation the program’s examples. That to demon- that could textbook knowledge, to support a wide range of tasks besides prediction; .I. Rickel. B. Porter/Artificial Intelligence 93 (1997) 201-260 241 the strengths and weaknesses of our methods. To accomplish and questions constructed independently this goal, we eval- by a domain expose uated TRIPEL using knowledge expert. The knowledge was provided by the Botany Knowledge Base (BKB) [ 421. The BKB is TRIPEL for three reasons. First, its knowledge its use for any single task such as prediction. results on using the BKB to answer other types of facts covering plant anatomy, physiol- expert, developed by a domain of botany knowledge. that of that and the representation representation about 200,000 it was independently to facilitate fundamental, [ 31-331 describe it was developed contains Second, test bed for evaluating the BKB, the domain expert constructed is an ideal extensive. It currently ogy, and development. whose main objective was a faithful and unbiased Finally, is, the BKB encodes knowledge was not chosen (Lester and Porter questions.) Using plant and the description were generated via automated rules) missing erroneous includes 691 variables and 1507 influences (e.g., roots, stems, oxygen processes of gases and solutes. Moreover, cover many different requirement important levels of detail. the variables, levels of detail. Thus, for evaluating from the general principles like photosynthesis (i.e., surrounding its environment in the leaves). and repaired elements leaves) and 172 different pools of substances soil and atmosphere). Most elements of inheritance inference (i.e., the expert manually in the BKB. In addition, elements. The resulting among and inference added system description them. It includes 47 different spaces in those spaces (e.g., It includes 313 processes, covering water regulation, metabolic regulation, and transportation spaces, pools and processes the most at many temperature influences, this system description meets includes many phenomena and respiration, TRIPEL: it a system description for a prototypical Next, we asked the domain expert to construct a large set of prediction questions a prototypical plant. From these, we randomly chose a small subset to use for concerning (model evaluating TFUPEL. For each of these questions, at TRIPEL'S model. ‘* Next, he evaluated TRIPEL'S and predictions) model for each question by comparing it to his own. Finally, after he evaluated TRIPEL'S performance on the entire subset of questions, he presented his assessment and discussed the knowledge he used to reach his conclusions. Appendix B lists the questions used in the evaluation. the expert generated his answer looking before 5.2. Adequacy and simplicity The evaluation results show that TRIPEL is very effective at constructing models. time scale) model. That In every case where TRIPEL was given a question scenario model exists, to the domain expert, each of these models for which an adequate is, according (including it constructed adequate an appropriate an adequate includes all the ‘* One question had to be thrown out, because the expert was not sure how to answer it. Therefore, he could not, with confidence, determine which elements of the system description were relevant. 242 .l. Rickel, B. Porter/Artijicial Intelligence 93 (1997) 201-260 leaf mesophyll ABA concentration leaf mesophyll ABA amount - t ABA inactivation rate x / ABA synthesis rate -1 plant turgor pressure plant water amount ARA transport rate F\; i ,,I, 7 cell ABA amount guard ~~~~~~ion - guard cell K+ - amount guard cell CO7 amount& Fig. 12. The model TRIPEL constructed to answer the question "How does a decrensing amount of water in n plant affect the amount of K+ in its guard eelIs?” needed to generate the right predictions information Fig. 12 shows decreasing The model correctly increased synthesis of the ABA hormone, and how ABA is transported causing potassium the model TRIPEL constructed in a plant affect the mechanisms to answer the amount of K+ in its guard cells?’ by which decreasing plant water causes to the guard cells, amount of water shows and explanations. the question For “How does a ions to leave. instance, The expert also assessed whether the number of variables four shows how many of them I shows three of Table column corresponding variables and 1507 influences), have few if any irrelevant elements. question. In comparison with these models include and irrelevant influences information. Column in each model, and the to answering (691 these models are quite small, and most of the models irrelevant the size of the system description the expert judged The cases where TRIPEL included irrelevant elements because its methods. The raw numbers of irrelevant interesting, are most for improving they suggest oppo~un~ties forces it elements are somewhat misleading; in these models to include many irrelevant were included because TRIPEL overestimated the significance of an influence or influence path. Most of TRIPEL's errors result from three differences between TRIPEL'S criteria for signi~cance elements. Most of the irrelevant elements one error in TRIPEL'S judgement and the expert’s criteria: typically o The expert uses a finer gradation of time scales than those in the system description. the expert (e.g., minutes or hours), For each time scale in the system description considers time scales (e.g., a few minutes versus many a variety of more specific minutes). For example, when the expert chooses “few minutes” as the time scale of interest, he ignores processes operating on a time scale of many minutes. Because the system description does not distinguish these two time scales, TRIPEL treats the slower processes as significant. J. Rickel, B. Porter/Artijcial Intelligence 93 (1997) 201-260 243 elements a question. The first column to Appendix B). The third column shows the number of variables in the simplest adequate model found by TRIPEL. The last column shows the number of these in TRIPEL'S models. Each row represents (corresponding that are not relevant to answering the question TRIPEL'S model h-relevant elements (variables, influences) (variables, influences) 6, 5 6, 7 II, I4 16, 25 l9,28 25,40 25,4l 36, 60 41.70 82, I47 none none 5, 8 6, 9 none none 18, 34 29, 55 64, 121 Table I The number of irrelevant shows the question number and influences variables and influences # 2 3 4 s 6 7 8 9 10 Time scale of interest instantaneous hours minutes hours minutes hours minutes minutes minutes minutes l When assessing an influence’s significance, TRIPEL does not try to anticipate the system behavior of the physical determines conditions limiting conditions influence of oxygen on respiration. that an influence that will not arise for respiration; reactant is insignificant In contrast, in the scenario. it is significant because in the scenario. For example, oxygen therefore, when the expert can see that the driving the limiting, he omits to become the expert sometimes only under is rarely a of a question will not cause oxygen for a given question than TRIPEL’S. As discussed for determining whether an influence path is significant l The expert’s criteria more sophisticated influence path as significant the expert’s reasoning valid and significant on the time scale of interest. However, indicates time scale; that an influence path might be significant only on a slower the expert reasons about extra time lags due to the length of the path or the spatial that the distance expert recognizes In summary, TRIPEL’S in Section 3.1.2, TFUPEL if each inlluence are judges an in the path is performance on these ten questions it covers. Therefore, TRIPEL as insignificant. sometimes feedback includes loops simple, adequate models despite important area for improvement influences significance and influence paths. TRIPEL criteria without requiring indicates that it is capable the complexity of the system descrip- for recognizing criteria is in TRIPEL’S incorporate is designed to easily to the model construction changes al- the criteria. We so the main challenge for future research is in formulating this issue further in Section 6. of constructing tion. The most insignificant additional gorithm, discuss In addition questions can arise to the ten questions tested TFUPEL on four for which the BKB cannot provide an adequate scenario model. This situation of the question may have no in several ways: the driving conditions so far, we also discussed (1) 244 J. Rickel, B. Porler/Artijicinl Intelligence 93 (1997) 201-260 effect on the variables of interest significant system description may be missing the variables of interest (question several phenomena (questions of detail the other cases reflect gaps in the system description. the affect the question may require a model of for which the system description does not provide compatible levels 13 and 14). The first case reflects a property of the question, while the processes by which the driving conditions II), or (3) 12 in Appendix B), (question (2) Ideally, TRIPEL should recognize It did correctly questions. report such a conclusion for the other two, TRIPEL returned what it believed these two cases, TRIPEL found what it identified as a significant the driving conditions insignificant. As discussed TRIPEL'S because he additionally Thus, by extending TRIPEL's criteria ability that no adequate scenario model exists for these four for questions 13 and 14. However, to be an adequate model. In each of influence path relating these paths the expert’s assessment differs from in this section, considers cumulative delays along an influence path. its to include such considerations, we can improve inadequate models as well as irrelevant phenomena. and variables of interest. In contrast, the expert judged to recognize earlier 5.3. The importance of a time scale of interest A time scale of interest is an important Its ability time scale of interest its models. ability to choose appropriate allows TRIPEL to use some (e.g., representing recognize its success. insignificant influences to identify insignificant to identify insignificant exogenous levels of detail quasi-static variables. Finally, allowing influences influences, source of TRIPEL'S power. TRIPEL uses the it to prune them from is also a crucial part of its the time scale of interest time scales to role in Clearly, TRIPEL'S ability plays an important that are not valid on faster approximations). influences and valid approximations To quantify and influences are treated as significant, that are valid only for certain for each question was significantly (forcing TRIPEL to use more-detailed the importance, we ran TRIPEL without a time scale of interest on the for which an adequate model exists. Without a time scale of interest, all time instead). ten questions influences scales are treated as invalid This experiment yielded found more variables two questions it found an adequate model when using a time scale of interest. The reason without using a time scale of interest, TRIPEL is forced to model more phenomena, it is more provide compatible smaller models, but also makes TRIPEL less sensitive two observations. First, the simplest adequate model that TRIPEL included 65 there were that no adequate model exists, even though is simple: so does not in than when TFUPEL exploited a time scale of interest. Second, for which TRIPEL determined levels of detail. Thus, a time scale of interest not only results to gaps in the system description. larger; on average, each model the system description two phenomena for which influences to need likely 5.4. Ejjiciency 5.4. I. Model construction In the theoretical worst case, the model construction has a running time that is exponential algorithm in the size of the system description. ( Find-adequate-model ) In prac- J. Rickel, B. Porter/Arti$cinl Intelligence 93 (1997) 201-260 245 Table 2 The efficiency of model construction. The first column shows the question number. The second column shows the function the amount of time TRIPEL spent during model construction Find-adequate-model). and pruned with monotonic constraints. The fourth column shows how many partial models were left on the agenda when TRIPEL found a simplest adequate model (i.e., the amount of time to execute shows how many partial models TRIPEL generated The third column # 2 3 4 s 6 7 8 9 I 0 Time (seconds) Models pruned Models left on agenda 0.01 0.04 0.1 0.2 0.6 1.3 0.8 II 2 80 I 4 13 I1 14 60 10 120 4s 740 0 0 3 9 18 27 9 49 14 121 tice, however, constructed algorithm our informal experience using TRIPEL. it performs quite efficiently. For the expert’s questions where TRIPEL an adequate model, column 2 of Table 2 shows the took to find a simplest adequate model. ‘s These numbers are consistent with the amount of time To appreciate TRIPEL’S efficiency, consider bination of influences defines a legal scenario model: are the influencees of the influences, are exogenous. Furthermore, clude different includes over 1500 influences, models. influences. Thus, since the search space and all other variables each of these scenario models the system description the size of the search space. Any com- the model’s dependent variables referenced by the influences they in- plant scenario includes over 215** possible for a prototypical is different since TRIPEL avoids generating it avoids generating most of these this space efficiently because a partial model, TRIPEL the efficiency of model construction explicitly generates and considers searches any of its extensions. models. By pruning is to determine one way to measure Therefore, for each question. how many partial models TRIPEL it finds an adequate model, so all the partial Find-adequate-model adequate model, the simplest models left on the agenda at models termination, For each question, columns 3 and 4 of Table 2 show the number of partial that TRIPEL only generates models falling a manageable to the size of the search space. in the latter two classes. The numbers number of partial models, especially that that were pruned by monotonic in one of three classes: indicate compared terminates when and models it generates constraints, fall timing data pertains ” The workstation. to Harlequin Lispworks 3.2 Common Lisp running on a DEC 3000/500 246 J. Rickel, B. Porter/Art@cial Intelligence 93 (1997) 201-260 5.4.2. System boundary analysis Before calling Find-adequate-model, is time (where n is in Section 4.3.1, system boundary search it uses the Floyd-Warshall As described TRIPEL uses a breadth-first influences. Second, a connectivity matrix. The time required dominated by the transitive closure algorithm, which requires O(n’) the number of potentially relevant variables) One of the biggest [ 71. the empirical to perform to identify TRIPEL performs a system boundary analysis. analysis consists of two steps. First, and to compute analysis transitive closure algorithm the system boundary relevant variables the potentially of the question; evaluation was surprises during relevant variables TRIPEL found independent the time scale of interest relevant variables, and system boundary analysis the number of for each of the expert’s questions. The potentially it depends primarily on the time scale number is nearly is seconds or faster, there are one or two of interest. When in less than dozen potentially there are always one second. However, when relevant variables, and there are always about 650 on a time scale about 450 potentially these numbers of hours. Since relevant variables represent makes the transitive closure algorithm expensive; requires about 30 minutes to handle 450 variables and about two hours to handle 650. Even though we could expect significant language, this situation fraction. Such a high number of potentially the time scale of interest includes 691 variables, system description from an optimized in a more efficient is unacceptable. implementation improvements the algorithm a significant is minutes, the entire finishes The root of the problem is TRIPEL'S criteria for determining whether an influence path in a path is in Section 5.2. As long as every influence as already discussed is significant, valid and significant, TRIPEL considers relevant variables and influences, influence the variables of interest paths are insignificant Thus, causes the same problem inefficiency during system boundary analysis. that this criterion causes TRIPEL to include variables through very long paths. The expert can tell that these influence paths. in models delays along irrelevant elements cumulative that causes TRIPEL to include because he considers the path significant. When identifying potentially from to this problem the same system description; is a simple solution There questions can be answered guished by different driving conditions all the expert’s questions concerning chemical processing tion, TRIPEL can generate a complete connectivity matrix for each possible ply selects this strategy, and it allows plant physiology questions for some cases. Often, a wide variety of is distin- is the case with a prototypical plant. It would also be the case for a the human body, or an ecosystem. Given a system descrip- all variables) to answer a question, system boundary analysis sim- to the time scale of interest. We have implemented time scale. Then, the matrix corresponding and variables of interest. This to be answered very quickly. (i.e., including each question facility, Nevertheless, this strategy has limitations. It does not allow TRIPEL to efficiently an- this strategy swer questions until all necessary connectivity matrices are built. Moreover, only requires a complete [44]. TO make those parts of the system description system boundary analysis efficient, as well as to improve other areas of TRIPEL'S per- formance, we must improve TRIPEL'S criteria for determining whether an influence path is significant. for model construction system description, the possibility of generating preventing needed J. Rickel, B. Porter/Art$icial Intelligence 93 (1997) 201-260 241 6. Future work 6. I. Modehg criteria The empirical models of complex proved. results show that TFUPEL is effective at building systems. Nonetheless, its criteria for making decisions simple, adequate can be im- 6.1.1. SigaiJicance criteria The ability to recognize influences insignificant modeling. Currentiy, TRIPEL uses a time scale of interest influence this particular evaluation reduce in to determine whether an algorithm does not depend on to include other criteria as well. The criteria would make TRIPEL more efficient and would criterion; TRIPEL can be extended the number of irrelevant elements is significant. However, its model construction source of power is an important that additional in its models. suggests In addition to time scale, human modeIers use other criteria to recognize insignificant influences. For example, of a chemical if the reactant will not become be ignored. question, account dominance apply the concentration reaction only if the reactant of a reactant signi~cantly is limiting limiting in the context of the question, In other cases, one influence can he ignored because, it will be dominated by other influences. Ultimately, TRIPEL should in~uences the rate (i.e., not available in abundance); the influence can in the context of the take into range of behavior, and are significant. Similar comments the time scale of interest, desired accuracy, expected relations to determine which to the problem of determining whether an influence influences is valid. (albeit heuristic) methods formal in equations first “scales” the considerations mentioned have developed influences) (i.e., the equations; to put the equations Applied mathematicians terms insignificant they combine because for recog- [25,35]. These methods are nizing above. In these meth- interesting (e.g., a ods, the modeler form so that the order time scale of interest) of magnitude of each term is apparent. Next, the modeler drops terms whose order of and checks whether magnitude the modeler solves terms are in fact negligible. Yip [ .56,57] has automated the discarded this procedure. However, Yip’s program starts with a complete, detailed set of equations and repeatedly to construct an initial model simplifies that could use such methods would be even more valuable. Ling’s MSG program start in this direction. that is, he uses scales of interest in nondimensional is very small. Finally, them. A program is a promising the equations [36] As discussed if every influence suggests in Section 5, TRIPEL could also benefit from more sophisticated for determining whether an innuendo path is significant. Currently, path as significant of interest. The evaluation to the length of the path or the spatial distance searching Lloyd-W~shall However, semirings) criteria it treats an influence in the path is valid and significant on the time scale that TFUPEL should also consider extra time lags due it covers. To maintain efficiency while (such as the to another. (closed framework the properties of paths from that do not record each path from one variable are based on a very general algebraic them to efficiently algorithm) these algorithms that allows influence paths, TRIPEL uses graph algorithms for significant summarize [7] to another. Like the expert that evaluated TRIPEL, one variable properties of paths such as length and spatial distance sign~~cantly assessment is an important area for future work. another. ~ete~ining influences these algorithms can use in assessing whether one variable how these factors should be used in the 6.12. Coherence criteria the explanation (roughly, sufficient Although and encapsulates coherence of models, relations are typically they are not, by themselves, for de- in general. For termining into example, a plant can be decomposed apoplast the network of living parts of the plant). The pool of water in the roots and the pool of water in the symplast are not comparable by the encapsulates relation, since neither en- incoherent. A similar problem arises with capsulates influences; yet neither explains the other. into roots, stems, and leaves or, alternatively, (roughly, the other, yet they seem mutually two influences may represent overlapping the network of dead parts of the plant) and symplast phenomena, sufficient One solution and in a model come from incompatible is to extend inffuences. Given a method for recognizing two relations these to represent multiple decompositions that two entities or two to prune such models. As stated earlier, constraints without any other changes, decompositions, monotonic ‘IWPEL so the main challenge constraints can incorporate is simply of entities influences can be implemented new monotonic to formalize the coherence criteria. 6.2. Simulation 6.2.1. Qualitative simulation TRLPEL has been integrated with a qualitative simulation to generate predictions. Given a question, TRIPEL the model to a set of qualitative differential to the Qualitative Process Compiler [ 27,291, to generate equations, the desired predictions. We chose to use a and it simulates rather than a numerical simulator because the BKB does not include program, which simulates constructs a model [ 14f. QPC converts the equations, (QPC) TRIPEL’s models and passes the model using the QSIM program qualitative quantitative simulator details. We have run QPC on many of TRIPEL’S models, including those models simple judged (i.e., 15 or fewer variables), QPC predicts a unique behavior, adequate. that the expert evaluation is relatively one predicted by the expert. I4 However, more complicated models result sible behaviors; info~ation ior. provided by the BKB include all relevant is not sufficient these models to uniquely determine In all our experiments, when inlluences, although from the the model the in many pos- the qualitative the behav- I4 There are two extensions completions of the initial stare, we modified QPC to automatically (i.e., the state with the most steady variables), This is the most natural in most cases. Second, we allowed QPC to use a QSIM extension developed by Clancy and Kuipers abstracts to QPC that help it predict a unique behavior. First, while there may be multiple choose the initial state closest to equiIib~um interpretation of our prediction questions [ 5 ] that the behavior of chattering variables. Typically, chatter to answering our questions. is irrelevant .i. Rickel, B. Porter/Artificial intelligence 93 (1997j 201-260 249 information information quantitative The ambiguity is to incorporate for the larger models can be eliminated without modifying TRIPEL. One solution into the BKB. QPC and QSIM can exploit quantitative an alternative approach: that typically to reduce dominate other influences, ambiguity. We believe such information will be easy to obtain and encode, and that it will allow QPC to generate from the plant physiology models TRlPEL constructs, but more work remains. to reduce ambiguity. We have been pursuing to specify those influences and QPC could be extended the BKB could be extended the desired predictions to use this information 62.2. Numerical simulation described The algorithms in this paper should provide nulnerical models as well as qualitative models. The issues addressed in both cases. However, while TRIPEL has been used to generate qualitative models, has not been used to generate numerical models. a foundation for building in this paper arise it There are two possible ways to generate numerical equations from influences. First, equation can provide a numerical the domain knowledge of influences on a variable. Forbus and Falkenhainer approach. Second, each such as whether model is constructed, [ 131 has successfully feasible equations used this approach influence it is an additive [ 171 have successfully can specify how it combines with other term, a multiplicative can be generated using used that infhrences, the Farquhar types of equations, and it appears term, or otherwise. After these specifications. for each useful combination for other types as well. for limited Thus, although TRIPEL has not been used to construct numerical models, that prevent such an application. Although we expect limitations no apparent structing numerical models will raise some additional will provide an appropriate for addressing framework issues, we believe them. there are that con- that TRIPEL 6.3. Questions that require multiple models in most cases, aided by QPC's ability as its influences become active or inactive To answer a question, TRIPEL builds only a single scenario model. This approach the model somewhat during (as discussed on p. 212). However, that differ in more fundamental including algorithms, to explore [21] has begun of models time scales). Most modeling (e.g., models with different works simulation some questions ways ours, cannot construct the issues. require using a combination such combinations, to change although iwasaki 6.4. Other domains TRIPEL has been designed to avoid representations and methods have been influenced by the modeling been guided by the practices of human modelers of engineering (chemical, have also tried to ensure that TRIPEL handles electrical, to apply to a wide variety of dom~ns. We have been careful that lacked such wide applicability. Although we issues that arise in plant physiology, we have also several branches and other areas of biology. We in ecology, economics, and mechanical), the issues addressed by related modeling 250 J. Rickel, B. Porter/ArtiJciul Intelligerxe 93 (1997) 201-260 programs, or at least that these issues can be addressed as natural extensions of TKIPEL. Nonetheless, so our ciaim our only that TRIPEL can handle other domains of TRIPEL has been in plant physioIogy, application large-scale remains untested. it can handle many other domains, we expect While we believe than others. more naturally reasoning about pools of substance or energy and the processes the domains of ecology, human physiology, promising its representation as a next step. In particular, and chemical en~in~ring is especially that regulate it to handle some for suitable them. Thus, seem especially 7. Conclusions questions about complex from simple building blocks: the program must address modeling this approach gives TRIPEL considerable This paper has described TIUPEL, a compositional modeling program for answer- systems. Unlike previous modeling programs, in- individual ing prediction TRIPEL constructs models fluences. Although in the implicitly models, these issues with domain knowledge In a set of domain-independent, these constraints, variables and influences play a central role in every modeling decision. Based on these constraints, TRIPEL constructs a simplest adequate model for any given prediction question, that are solved required by previous programs. TRIPEL addresses that define an adequate model. in constructing declarative constraints flexibility variables issues and We evaluated TRIPEL in the domain of plant physiology using questions and domain independently by an expert. The evaluation simple, adequate models of a truly complex system. More importantly, constructed knowledge can construct evaluation phisticated Because TRIPEL is designed other areas without suggests criteria for determining whether one variable significantly the most important area for future research: requiring other changes to be extensible, sophistication to the program. shows that TRIPEL the incorporating more so- influences another. to this and can be added Acknowledgments The following people provided valuable comments on this work: Giorgio Brajnik, Dan Clancy, Peter Clark, Brian Falkenhainer, Yumi Iwasaki, Bert Kay, Ben Kuipers, James Lester, Alon Levy, Rich Mallory, Ray Mooney, and Gordon Novak. We also thank Pandu tools built Nayak for helpful discussions on his work. Our work benefited and the Qualitative Process Compiler developed by Adam F~quhar by others, Jimi Crawford, the KM system developed by Erik Eilerts, and several QSIM extensions developed by Dan Clancy, We especially Souther. the help of our domain expert, Art from several appreciate including Support for this research was provided by grants from Digital Equipment Corporation from the Air Force (IRI-9120310) at the The research was conducted (F49620-93-I-0239). and a contract and the National Science Foundation Office of Scientific Research University of Texas at Austin. J. Rickel, B. Porter/Artijicinl Intelligence 93 (1997) 201-260 251 Appendix A. Proofs A. 1. Monotonic constraints Lemma A.1. Adequacy Constraints 3 and 4 are monotonic constraints. leading that are each valid and significant If an exogenous variable v in a partial model m violates Adequacy Constraint 4, to v from a driving for (by definition of the constraint). Since every extension of m contains every extension violates if v violates Adequacy Constraint 3, there must be an to v from another variable v’ in m, (by Since every extension of m also contains v’ and contains v the Proof. there must be an influence path in the system description, variable of the question, consisting of influences the given question v as an exogenous the constraint influence path consisting definition of the constraint). as an exogenous constraint variable as well. Similarly, in the system description, that are each valid and significant (by definition of an extension), (by definition of an extension), every extension violates for the given question variable 0 of influences as well. leading Lemma A-2. Adequacy Constraints 5, 6, 7, and 8 are monotonic constraints. Therefore, if an influence in a partial model is also in each of its extensions (by definition Proof. Any influence in a partial mode1 violates Adequacy Con- of an extension). straint 6, or a pair of influences violates Adequacy Constraint 5 or 8, the constraint will if the influences on a dependent variable also be violated in a partial mode1 violate Adequacy Constraint 7, the constraint will also be violated in the influences on a partial model’s every extension, because an extension cannot change dependent variables (by definition of an extension). in every extension. Similarly, 0 Lemma A.3. Adequacy Constraints 9 and 10 are monotonic constraints. in Section 3.1.4, the entities Proof. As discussed the model’s variables. Therefore, model’s extensions, partial mode1 (by definition of an extension). Thus, that violate one of these constraints, in a partial model are determined by in a partial mode1 is also in each of the are a superset of those in the includes entities 0 every extension will also violate if a partial model in each extension the constraint. the variables every entity since Lemma A.4 For a given system description and prediction question, let M be a sce- nario model that satisjies Adequacy Constraints 1 (Include variables of interest) and 2 If M has no free variables and it violates (Include variables the constraint. Adequacy Constraint 11, every extension of M also violates in activity preconditions). that E is an extension of M that satisfies Adequacy Constraint 11. We Proof. Assume show by contradiction C I) M violates Adequacy Constraint 11 (given). Therefore, that such an extension cannot exist. influence path in M, leading such that every influence for some variable of to it from a in the path is valid interest v, there driving variable of the question, and significant is no differential for the given question. 252 J. Rickel, 3. P~ri~~/~rti~ci~ll intelligence 93 (1997) 201-260 (2) E satisfies Adequacy Constraint I1 (by assumption). Therefore, influence path in E from a driving variable ential that are valid and significant for the given question. there is a differ- to v, consisting of influences (3) Let i be the last influence influence because in the path would also be if every in this influence path that is not in M. There must in M, all in M (since M satisties Adequacy the influence path would be in M, which contradicts in the path were influence 2), and hence be such an the variables Constraint step ( 1). (4) The influencee of i must be in M. If i is the last in the path, is the variable of interest v. Since M satisfies Adequacy Constraint influence its 1, in the path is in M the next influence is in M (since M satisfies Adequacy infhrencee v is in M. If i is not the last influence, (by definition of i), and so i’s influencee Constraint 2). (5) The influencee of i cannot be an exogenous variable it would also be exogenous in E (by definition of an extension). But then E could not include any influences on it (by definition of a partial model), and hence i could not be in E. in M. If it were, (6) The influencee of i cannot be a dependent variable in M. An extension the influences on a partial model’s dependent variables so i could be in E only if it was also in M (which contradicts change an extension), definition of i). (7) Since the infuencee of i cannot be dependent or exogenous has no free variables This contradicts Adequacy Constraint (given), the influencee of i cannot be a variable step (4). That step follows from the assumption I I. Therefore, that assumption is false. Cl cannot (by definition of the in M, and since M in M. that E satisfies A.2. Proof of Theorem 1 The “only the “if”, suppose influences potentially Otherwise, must be such an relevant, all the variables of the potentially if” follows directly from the definition of the connectivity matrix. To prove that p is the influence path by which i (the ith variable) significantly If p consists only of variables and influences j (the jth variable). relevant, cell (i, j) will contain a 1 (by definition of the connectivity matrix). relevant. There let e be the last influence the path were potentially because influence (by definition in the path that is not potentially if every in the path would also be potentially influence relevant that are in The influencee of e must be potentially relevant variables and influences). relevant. If e is the last influence is potentially in the path, relevant. in the path is potentially relevant (by definition of is j, which is in the connectivity matrix and hence the next if e is not the last influence, (by definition of e) , so e’s influencee its influencee Otherwise, relevant the potentially influence on a potentially of the potentially Therefore, p must consist only of variables and influences and the theorem must hold. relevant variable, influence is potentially relevant variables and influences). This contradicts 0 relevant variables and influences). But since e is a valid and significant (by definition it must be potentially relevant the definition of e. that are potentially relevant, J. Rickel, B. Porter/Arrificinl Intelligence 93 (1997) 201-260 2.53 A.3. Proof of Theorem 4 A.3.1. Overview adequate an adequate is admissible; This section proves that Find-adequate-model scenario model whenever the entire set of legal partial models the algorithm begins, (including this, we view the algorithm as repeatedly eliminating to return a simplest exists. To prove from consideration when all legal scenario models) description call the set of partial models under consideration the algorithm eliminates Find-adequate-model never eliminates for the question or (2) is inadequate scenario model still under consideration section proves that Find-adequate-model strategy. that is, it is guaranteed scenario model scenario models until only a simplest adequate scenario model remains. Conceptually, for the given system is under consideration. As earlier, we set”. Each step of the “consideration some elements of the consideration set. However, a scenario model unless either (1) the model is an adequate there if the model that is at least as simple. The remainder of this this is admissible by proving that it follows is adequate, implicitly A.3.2. Auxiliary lemmas The proof of Theorem 4 requires several lemmas. The first two lemmas address the System Boundary Selector says that all remaining variables the variables the in a partial exogenous from consideration in which one of these variables justify two lemmas the first lemma simply establishes one of the antecedents of the second scenario model. This effectively eliminates is dependent. These In this case, Extend-model marks case where model can be exogenous. and returns any extension this approach; lemma. the resulting Lemma AS. Every partial model that Find-adequate-model sati@es all adequacy constraints except perhaps Adequacy Constraint 11 (Variables of interest differentially to Extend-model influenced). passes the 1 (Include and 4 (Exogenous is satisfied because variables of interest) it also adds any variables appearing is satisfied because, whenever Extend-model Proof. Adequacy Constraint partial model is an extension of the initial partial model. Adequacy Constraint 2 (Include in activity preconditions) adds variables in the influence’s an influence to a partial model, activity preconditions. Adequacy Constraints independent model) model passed (Influences ences not redundant) satisfy these constraints these constraints, of the rest of the model). Finally, Adequacy Constraints 9 (Entities (Entities compatible with driving variables) added to the agenda and 8 (Influ- that in a partial model satisfy they will in any extension as well (i.e., the constraints are independent and 10 are satisfied because a partial model is only of are satisfied because no 5 has any exogenous variables. Adequacy Constraints if the influences on a variable ( 1) Dv-models only returns are satisfied because valid), 7 (Influences these constraints. to Extend-model homogeneous), 3 (Exogenous 6 (Influences if it satisfies of question) independent complete), influences coherent) variables variables and (2) 0 2.54 J. Rickel, B. Porter/Art@cid Inrelligencc 93 (I 997) 201-260 Let P be a partial model for a given system description, let Q be Lemma A.6 a prediction question, and suppose P satisfies all adequacy constraints except perhaps Adequacy Constraint I I ( Variables of interest d~~ere~tiully ~Fz~uenced) . Suppose that all free variables in P can be treated as exogenous (i.e., they sati& Adequacy Constraints 3 and 4). Let E be the scenario model that results from making each free variable in P an e.rogenclus variable. Then there is an extension of P that is u simplest adequate scenario model for Q only if E is a simplest adequate scenario model for Q. Proof. The extension E has the same number of variables as the partial model P, so E is at least as simple as any other extension of P (by Therefore, model, E must be a simplest adequate scenario model as well. We complete by showing the definition of an extension). if E is adequate and some other extension of P is a simplest adequate scenario the proof that if E is not adequate, no other extension of P is adequate. ( 1) E must satisfy all adequacy constraints because (a} P satisfies all these constraints variables satisfy Adequacy Constraints 3 and 4 (given), as P. variables and influences (given), (2) Thus, if E is inadequate, it violates Adequacy Constraint except perhaps Adequacy Constraint (b) the new exogenous and (c) E has the same 11 variable of interest v, there is no differential from a driving variable of the question, valid and significant on the time scale of interest. influence path in E, leading 1 1. That is, for some to it in the path is such that every influence (3) Assume there is an extension E’ of P that is an adequate scenario model. Then influence that are valid there is a differential of influences E’ satisfies Adequacy Constraint path in E’ from a driving variable and signi~cant on the time scale of interest. to v, consisting 11, and hence in this influence path that is not in E. There must be (4) Let i be the last influence such an inlluence because in the path were in E, all the variables if every influence in the path would also be in E (since E satisfies Adequacy Constraint 2), and hence the influence path would be in E, which contradicts step (2). (5) The inffuencee of i must be in E. If i is the last influence is the variable of interest v. If not, the next influence in its the path, in the path is in influencee E (by definition of i), and so i’s influencee Constraint 2). is in E (since E satisfies Adequacy (6) The influencee of i must be a free variable in P. Otherwise, no extension of P can add an influence on it, and i would have to be in both P and E. (7) However, all the free variables in P can be exogenous (given), so there is no influence path from a driving variable of influences that arc valid and significant on the time scale of interest. to any of these free variables consisting (8) Thus, the influence path implied by the assumption in step (3) cannot exist, so E’ cannot be an adequate scenario model. Thus, if E is not an adequate scenario model, no other extension of P is an adequate scenario model. 0 The next two lemmas justify the function Dv-models. Given a partial model with a variable v that must be dependent, Extend-model on v returned by Dv-models, thereby only considers those sets of influences implicitly pruning any extension with a different set J. Ricked, B. Porter/Arrijicial Intelligence 93 (1997) 201-260 2.55 of influences on v. To justify pruning other set of influences and the second discarded. lemma ensures these extensions, the first lemma ensures is either inadequate or simply adds some insignificant that every influences, that those sets containing insignificant influences can be Lemma A.7. For a given system description and prediction question, Jluences on a variable inadequate influences if a set of in- the set is either (i.e., violates Adequacy Constraint 5, 6, 7 or 8) or simply adds insigni$cant is not returned by the function Dv-models, to a set that is returned. influences the set is identical it past these steps in two cases: Proof. Step 1 in the function Dv-models generates every complete set of influences, and from these sets. A set of influences will step (2) discards any insignificant complete, not make or (2) it includes some (Influences of the algorithm only discard violate Adequacy Constraint 8. Cl Constraint 7 steps inadequate sets of influences: Step 3 only discards sets that 6, and step (4) only discards sets that violate Adequacy In the first case, the set violates Adequacy Constraint the lemma because the set is not approximately these steps except it past complete). The second case satisfies (1) that makes the remaining insignificant influences. to one Lemma A-8. Given a system description and prediction question, model with a variable v. Suppose insignificant it does not include is an adequate scenario model, either M’ or one of its extensions scenario model and is at least as simple. let M be a partial that are the question. Let M’ be a partial model that is the same as M except influences on v. Then if M or one of its extensions is also an adequate on v in M include some the insignificant the injuences for If M or one if its extensions that M’ or one of its extensions Proof. We show by construction model and is at least as simple. Construct A’ from A by simply removing influences on v. If A =M, then A’ = M’. Otherwise, A’ is an extension of M’. A’ is at it has the same variables. Furthermore, A’ is an adequate least as simple as A because scenario model because (since A has none) and it satisfies all adequacy constraints: is an adequate scenario model, call that model A. is also an adequate scenario the insignificant it contains no free variables l Constraint 7 is satisfied because A’ contains all influences from A except insignifi- cant ones. l Constraint from a driving variable reasons. A is adequate, for the following for every variable of interest, so it satisfies 11 is satisfied there is an influence path this constraint. Therefore, to the variable of interest, and every influence in A leading for the question. A’ includes all the variables in the path is valid and significant and so A’ must influences in A except some include every such influence path that A does, and hence A’ must satisfy Adequacy Constraint that are insignificant, influences 11. l All the other constraints are satisfied because are the same, the dependent variables in A’ are a subset of those in A. q the exogenous variables in A and A’ in A and A’ are the same, and the influences 256 .I. Rickel, B. Porter/Avtijiciul Intelligence 93 (1997) 201-260 A.3.3. Key lemma We can now prove the key lemma in the proof of Theorem 4. When Find-adequate- is invoked, we define model models (including Find-adequate-model shows that it always retains a simplest adequate scenario model if one exists. set to be the entire set of legal partial system description. As for the given set, this lemma the consideration legal scenario models) repeatedly eliminates elements of the consideration all Lemma A.9. For a given system description, and prediction question, Find-adequate- model never prunes a scenario model from model is ~rzudequate or (2) there is an adequate scenario model stilt in the consideration set that is at least as simple. set unless either (1) the consideration the Proof. There are only seven ways in which Find-adequat~model the consideration set, and each satisfies the lemma: prunes elements of ( 1) (Initializing the agenda) Initially, constraints) its extensions thereby pruning is adequate, because those scenario models for the question as well. 1 (Include variables of interest). of that model. Thus, each extension constraint, from it violates If a partial model violates a monotonic a monotonic for any extension in a partial model must be dependent, Extend-model to the agenda, set. The partial model it the the for a partial is it and itself is inadequate because constraint, when violated to that partial model and all of its extensions, that do not contain the agenda contains a partial model consisting the consideration implicitly the variables of interest. each violates of the variables of interest, each a free variable. At that point, set has been reduced eliminating However, none of the eliminated models Adequacy Constraint (monotonic is not added consideration constraint. By definition, is violated model, inadequate (Free variable cannot be e.~oge~zol~s) When that a variable prunes any extension tem Boundary Selector, or Adequacy Constraint 4 if the variable were exogenous. Since straints are monotonic the variable (All free variables can be exogenous) When the System Boundary Selector says that all remaining marks effectively prunes any extension If any of the pruned extensions and A.6 ensure is at least as simple. (ln~~ences on a dependent variable) Given a partial model with a variable v that those sets of influences on v must be dependent, Extend-model implicitly pruning any extension with a different returned by Dv-models, set of influences on v. Lemmas A.7 and A.8 ensure that these extensions can be pruned without violating the System Boundary Selector says effectively is exogenous. By definition of the Sys- 3 these two con- (Lemma A. I), any extension of the partial model in which in which one of these variables is an adequate that the scenario model returned by Extend-model scenario model. This is dependent. scenario model, Lemmas A.5 is also, and it the partial model would violate Adequacy Constraint in a partial model can be exogenous, Extend-model is exogenous will also be inadequate. in which the variable only considers the variables the resulting and returns the current exogenous variables thereby lemma. (2) (3) (4) (5) J. Rickel, B. Porter/Art$cial Intelligence 93 (1997) 201-260 251 (6) (7) appearing in activity preconditions) in the activity preconditions the variables. However, all the influences (by definition of an extension). Thus, if an extension adds variables in activity preconditions). For each partial model that are required by Adequacy Constraint to be returned, 2 (In- This effectively prunes those extensions in the partial model will also lacks the can (Variables Extend-model clude variables without be in each extension some variable influences, extension will violate Adequacy Constraint 2. Therefore, no such extension be an adequate scenario model. the first adequate model) Find-adequate-model (Returning equate scenario model M that it finds, effectively pruning consideration it always agenda, no other model on the agenda can be simpler of an extension every model on the agenda in the consideration nario model, no other scenario model 0 adequate model unless M is also. and that so no model sce- set can be a simplest that M is as simple as any of its extensions is as simple as any of their extensions, the first ad- the remainder of the from the than M. Thus, since M is an adequate the simplest partial model than M. The definition in the consideration set is simpler set. Since of those removes ensures returns A.3.4. Main proof Finally, building on the previous description Find-adequate-model and a prediction question lemmas, we can prove Theorem 4: Given a system is adequate, for which some scenario model will return a simplest adequate scenario model. that Find-adequate-model scenario model unless another adequate Proof of Theorem 4. Lemma A.9 ensures adequate remains ensures adequate scenario model, in the consideration that the consideration scenario model and set. If there is an adequate scenario model, set cannot become empty. Furthermore, the consideration set is reduced never prunes an scenario model, at least as simple, then the lemma is an if there to a single adequate that model must be a simplest adequate scenario model. Theorem 3 ensures the agenda that Find-adequate-model (and hence consideration tion, either consists of a single adequate scenario model scenario model not arise, and it ensures scenario model. for the question, that the model 0 eventually set) terminates. Upon is empty or the consideration termina- set If there is an adequate that the first case can- in the second case must be a simplest adequate is returned). (which the previous paragraph ensures Appendix B. Evaluation details This appendix lists all the plant physiology questions, which TRIPEL was formally evaluated that TRIPEL constructed (as described for these questions can be found elsewhere [44]. constructed by the expert, on in Section 5). Most of the models ( 1) How would an increasing amount of ~02 in a plant’s leaves affect the rate of photosynthesis in the leaves? (2) How does increasing soil water potential affect a plant’s water distribution rate? 258 J. Rickel. B. Porter/Arti$ciul Intelligence 93 (1997) 201-260 (3) How does a decreasing amount of water in a plant affect the amount of K+ in its guard cells? (4) What happens decreases? to a plant’s water potential as the temperature of the environment (5) How would an increasing rate of solar irradiation to a plant’s leaves affect the temperature of the leaves? (6) What happens decreases’? to turgor pressure in a plant’s leaves as root water abso~tion amount of water in the earth’s atmosphere affect a (7) How would a decreasing plant’s photosynthesis (8) How does an increasing rate? level of ABA in a plant’s leaves affect transpiration from the leaves? (9) How does increasing water potential in a plant’s leaves affect the rate of K+ efflux from the guard cells in the leaves? ( 10) How does an increasing amount of ABA in the guard cells of a plant’s leaves affect osmosis to the lcaves’ accessory cells from the leaves’ guard cells? ( I1 ) How does an increasing rate of diffusion of heat from the stems of a plant to the atmosphere in the stems? surrounding the stems affect the water potential of the symplast ( 12) How does a decreasing amount of co2 ( 13) How does a decreasing in the atmosphere rate of evaporation surrounding rate of photosynthesis leaves affect from a plant’s the leaves? in a plant’s shoot system affect the the pressure potential in the phloem of its leaves? ( 14) As the amount of water in a plant’s cell walls increases, what happens to the plant’s turgor pressure? References 1 I J S. Addanki, R. Cremonini and J.S. Penberthy, Graphs of models, Art&M Intelligence 51 ( 1991) 145-177. 121 TFH. Allen and T.B. Starr, Hierarchy 13 1 J. Amsterdam. Automated Report 1412, Artificial (1993). (University of Chicago Press, Chicago, 1982). qualitative modeling of dynamic physical Intelligence Laboratory, Massachusetts systems, Ph.D. Thesis, Technicat Institute of Technology, Cambridge, MA [ 4 1 C.A. Catino, Automated modeling of chemical plants with application to hazard and operability studies, Ph.D. Thesis, University of Pennsylvania ( 1993). 151 D.J. Clancy and B.J. Kuipers. Behavior abstraction for tractable simulation, in: Proceedings 7th ltlter~lf~tion~i~ ~f~rk~~~l~~p on Q~fflit~~fi~,e Remming 57-64. ahmtt Phyicai Systems, Orcas Island, WA f 1993) 16 1 J.W. Collins and K.D. Forbus, Reasoning about fluids via molecular collections, in: Proceedings AAAI- 87, Seattle, WA (1987) 590-595. 171 T.H. Cormen, C.E. Leiserson and R.L. Rivest, Introduction to Algorithms (McGraw-Hill, New York, 1989). [ 8 1 R. Davis, Diagnostic reasoning based on structure and behavior, Artijicial hfelligence 24 ( 1984) 347- 410. [ 9 j T. Ellman, .I. Keane and M. Schwabacher, Intelligent model selection for hillclimbing search in computer- aided design, in: Proceedings AAAI-93, Washington, DC ( 1993) 594-599. J, Rickel, B. Porter/Artijicial Intelligence 93 (1997) 201-260 259 1 101 B. Falkenhainer, Modeling without amnesia: Making experience-sanctioned approximations. in: Pro~~eed~ng.~ 6th late~a~ionu~ W~}rk.~~a~ on Qaa~~ta~i~,e Reasanjng about P~y.~ica~ Systems, ~inburgh, (1992) 44-55. Scotland l 1 1 l B. Falkenhainer, 1 12 1 B. Falkenhainer Ideal physical systems. in: Proceedings AAA!-93, Washington, DC ( 1993) 600-605. and K.D. Forbus, Compositional modeling: Finding the right model for the job, Art&G/ InfelLigence 51 ( 199 I) 95-143. 1 i 11 A. Farquhar, Automated modeling of physical Thesis, Technical Report A193-207, ~pa~ment TX (1993). systems in the presence of incomplete knowledge, Ph.D. of Texas at Austin, of Computer Science, Unive~ity 1 14 I A. Farquhar, A qualitative physics compiler, [ 15 l K.D. Forbus. Qualitative process I 161 K.D. Forbus, Qualitative physics: Past, present and future, theory, Ar@ciul in: Proceedings AAAI-94, Seattle, WA ( 1994) I 168-l 174. Intelligence 24 ( 1984) 85-168. in: D.S. Weld and J. de Kleer, eds., Reudings in Quulitahz 1 17 1 K.D. Forbus Reasoning about Physical Sysrems (Morgan Kaufmann. San Mateo, CA, 1990) and B. Falkenhainer, simulations: An of qualitative I 1-39. and quantitative knowledge, 1 18 ] J.W. Forrester, Principles of Systems (Wright-Allen 1 I9 I H.J. Gold, Mafhemahd [ 20 1 A.C. Guyton, Textboak of Medical Physiology [ 2 1 / Y. Iwasaki, Reasoning with multiple abstraction models, Self-expianato~ integration in: in: Proceedings AAAI-93, Boston, MA ( 1990) 380-387. Press, Cambridge, MA, 1968). Modeling of Biological Systems (Wiley, New York, 1977). ( W.B. Saunders, Philadelphia, PA, 198 I ). in: B. Fakings and P. Struss, eds., Recent Ad~~l~~e.~ in Q~~iifaiive Phpics (MIT Press, Cambridge, MA, 1992) 67-82. for commonsense abstraction 1221 Y. lwasaki and I. Bhandari, Formal basis of dynamic systems, in: Proceedings AAAI-88, St. Paul, MN ( 1988) 307-312. I23 l Y. lwasaki and A.Y. Levy, Automated model selection for simulation, in: Proceedings AAAI-94, Seattle. WA (1994) 1241 Y. lwasaki 143-194. 1183-1190. and H.A. Simon, Causality and model abstraction, Art@cial infe&ence 67 (I ) ( 1994) 125 / S.J. Kline, Similitude and A~~prf~~i~~i~/ff Theory I26 I PV. Kokotovic, R.E. O’Malley (McGraw-Hill, New York, 196.5). Jr and P. Sannuti, Singular perturbations and order reduction in control theory-an overview, Automutica 12 ( 1976) 123-132. [ 27 1 B.J. Kuipers, Qualitative I28 1 B.J. Kuipers, Abstraction (1987) 621-625. simulation, Arfi$cicial fntel/igence by time scale in qualitative 29 ( 1986) 289-338. simulation, in: Proceedings AAAI-87, Seattle, WA 129 1 B.J. Kuipers, ~ual;rali~~e Reasonitlgr ~odeii~zg und Sin?ul~lfifJrl with I~zco?~~~~lete Knowledge (MIT Press. Cambridge, MA, 1994). 1301 S.A. Lapp and G.J. Powers, Computer-aided synthesis of fault trees, /EEE Truns. Reliability (April 1977). 13 I 1 J. Lester, Generating natural language explanations from large-scale knowledge bases, Ph.D. Thesis, Department of Computer Science, University of Texas at Austin, TX f 1994). [ 32 J J. Lester and B. Porter, Developing and e~~~pi~~aliy evaluating robust explanation generators: the knight experiments, Compufutianaf Linguistics, to appear. [ 33 I J. Lester and B. Porter, Scaling up explanation generation: Large-scale knowledge bases and empirical studies, in: Proceedings AAAI-96, Portland, OR ( 1996) 416-423. [ 34 I A.Y. Levy, Irrelevance reasoning in knowledge based systems, Ph.D. Thesis, Report No. STAN-CS-93- 1482, Department of Computer Science, Stanford University, Stanford, CA ( 1993). f 35 l CC. Lin aud L.A. Segal, ~ut~ze~~zu~ics A~3~~ie~ N, ~~ferm~ni.~iic Problems in the ~~~f~lral Sciences (Macmillan, New York, 1974). I 36 I S.-k.R. Ling, Using a domain theory to guide automated modeling of complex physical phenomena, in: Proceedings IJCAI-95, Montreal, Que. ( 1995) 1766-l 772. 137 l S. Mittal and B. Falkenhainer, Dynamic constraint satisfaction problems, in: Proceedings AAAI-90, Boston, MA ( 1990) 25-32. 138 1 PP. Nayak. Causal approximations, 139 / &‘.I? Nayak and L. Joskowicz. Efficient compositional modeling Art~cia~ ~~re~fi~e~ce 70 ( 1994) 277-334. for generating causal explanations, Arnficicrl lnrelligence 83 ( 1996) 193-227. 260 J. Ricked, B. Porter/Artijicial Intelligence 93 (1997) 201-260 1401 R.V. O’Neill, D.L. DeAngelis, J.B. Waide and T.EH. Allen, A Hierarchical Concept of Ecosystems (Princeton University Press, Princeton, NJ, 1986). [ 41 1 J. Pearl, Heuristics: ~~fe~lj~e~t Search Sfrafegies j&r Computer Problem Solving (Addison-Wesley, Reading, MA, 1984). 1421 B. Porter, J. Lester, K. Murray, K. Pittman, A. Souther, L. Acker and T. Jones, Al research in the context of a multifunctional knowledge base: the botany knowledge base project, Technical Report AIS%88, University of Texas at Austin, TX ( 1988). I43 1 C.J. Puccia and R. Levins, Q~~~~~jtati~e ~ode~~~‘~ of C~~rn~~ie.~ Sysrems (Harvard University Press, Cambridge, MA. 1985). [ 441 J. Rickel, Automated modeling of complex systems to answer prediction questions, Ph.D. Thesis, Technical Report AI95-234, Department of Computer Science, University of Texas at Austin, TX ( 1995). I45 ) J. Rickel and B. Porter, Automated modeling for answering prediction questions: selecting the time scale and system boundary, in: Proceedings AAAI-94, Seattle, WA ( 1994) I 19 I- 1198. 1461 N. Roberts, D. Andersen, R. Deal, M. Garet and W. Shaffer, ~~~trodacti~~n fo Computer ~irn~~urjf}n ( Addison-Wesiey, Reading, MA, 1983). I47 I T. Rosswall, R.G. Woodmansee and PG. Risser, eds., Scales and Global Change: Spatial LJ& 7’emporai Variability in &spheric Processes (Wiley, New York, 1988). I48 ) V.R. Saksena, J. O’Reilly and P.V. Kokotovic, Singular perturbations and time-scale methods in control theory: survey 1 Q76- 1983, Automutica 20 (3) ( 1984) 273-293. 1491 L.A. Segal, ed., ~a?~zematica~ Modeis in M&wdar and CeMar ~i~~~o~y, Chapter 3 (Cambridge University Press, Cambridge, MA, 1980). j SO ] M. Shirley and B. Falkenhainer, Explicit reasoning about accuracy for approximating physical systems, in: T. Ellman, R. Keller and J. Mostow, eds., Working Notes of the AAAI Workshop ON Automatic Generation of Approximations und Abstractions ( 1990) IS3- 162. I.? I 1 H.A. Simon and A. Ando. Aggregation of variables in dynamic systems, Econometrica 29 ( 1961) 111-138. [ 52 1 D.S. Wetd, Reasoning about model accuracy, Arr~[~~~~~ ~~te~~~~e~ce 56 ( 1992) 2.55-300. 153 1 D.S. Weld and J. de Kleer, eds., Readings in Qualirative Reasoning about Physical Systems (Morgan Kaufmann, San Mateo, CA, 1990). ( 54 1 B.C. Williams, Critical abstraction: Generating simplest models for causal explanation, in: Proceedings 5th Internationul Workshop on Qualitative Reasoning about Physical Systems, Austin, TX ( 199 1) 77-92. j55 I B.C. Williams and 0. Raiman, Decompositional modeling through caricaturai reasoning, in: Proceedin@ A~I-9~. Seattle, WA ( 1994) 1199-1204. 1541 K.M.-k. Yip, Model simplification by asymptotic order of magnitude reasoning, in: Proceedings AAAI-93, Washington, DC ( 1993) 634-641. [ 57 I K.M..k. Yip, Model simplification by asymptotic order of magnitude reasoning, Artificial Intelligence 80 (1996) 309-348. 