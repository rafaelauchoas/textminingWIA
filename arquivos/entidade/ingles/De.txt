I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptNIH Public AccessAuthor ManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.Published in final edited form as:Pattern Recognit. 2012 June 1; 45(6): 2050–2063. doi:10.1016/j.patcog.2011.04.033.Phase Ambiguity Correction and Visualization Techniques forComplex-Valued ICA of Group fMRI DataPedro A. Rodrigueza,1,*, Vince D. Calhounb, and Tülay Adalıa,1,**Vince D. Calhoun: vcalhoun@mrn.orga University of Maryland, Baltimore County, Department of CSEE, Baltimore, MD 21250b The Mind Research Network, Albuquerque, NM 87106 and University of New Mexico,Department of ECE, Albuquerque, NM 87131AbstractAnalysis of functional magnetic resonance imaging (fMRI) data in its native, complex form hasbeen shown to increase the sensitivity both for data-driven techniques, such as independentcomponent analysis (ICA), and for model-driven techniques. The promise of an increase insensitivity and specificity in clinical studies, provides a powerful motivation for utilizing both thephase and magnitude data; however, the unknown and noisy nature of the phase poses a challenge.In addition, many complex-valued analysis algorithms, such as ICA, suffer from an inherent phaseambiguity, which introduces additional difficulty for group analysis. We present solutions forthese issues, which have been among the main reasons phase information has been traditionallydiscarded, and show their effectiveness when used as part of a complex-valued group ICAalgorithm application. The methods we present thus allow the development of new fully complexdata-driven and semi-blind methods to process, analyze, and visualize fMRI data.We first introduce a phase ambiguity correction scheme that can be either applied subsequent toICA of fMRI data or can be incorporated into the ICA algorithm in the form of prior informationto eliminate the need for further processing for phase correction. We also present a Mahalanobisdistance-based thresholding method, which incorporates both magnitude and phase informationinto a single threshold, that can be used to increase the sensitivity in the identification of voxels ofinterest. This method shows particular promise for identifying voxels with significantsusceptibility changes but that are located in low magnitude (i.e. activation) areas. We demonstratethe performance gain of the introduced methods on actual fMRI data.Keywordsphase; fMRI; ICA; group analysis; ambiguity; visualization1. IntroductionFunctional magnetic resonance imaging (fMRI) is a technique that provides the opportunityto study brain function non-invasively and is a powerful tool utilized in both research andclinical arenas since the early 90s [1]. FMRI data are natively acquired as complex-valuedspatio-temporal images; however, usually only the magnitude images are used for analysis.The phase images are usually discarded, primarily because their unfamiliar and noisy natureposes a challenge for successful study of fMRI [2]. However, recent studies have identified*Principal corresponding author: rodripe1@umbc.edu (Pedro A. Rodriguez ). **Corresponding author: adali@umbc.edu (Tülay Adalı).1This work is supported by the NSF grants NSF-CCF 0635129 and NSF-IIS 0612076.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 2the presence of novel information in the phase, which can be utilized to better understandbrain function [3, 4, 5, 6, 7, 8]. One exciting implication of this fact would be increasedsensitivity in diagnosis when studying differences in control and patient groups when thephase information is utilized.Both model-based approaches, such as general linear model (GLM), and data-drivenapproaches, such as independent component analysis (ICA), can be used for studyingcomplex-valued fMRI data. By using a simple generative model based on linear mixing,ICA can minimize the constraints imposed on the temporal—or the spatial—dimension ofthe fMRI data, and therefore is particularly attractive for studying paradigms for whichreliable models of brain activity are not available. Hence, ICA is particularly promising forthe analysis of the phase of the complex-valued fMRI data, since it does not make anystrong assumptions about its unfamiliar nature. A number of recent applications of ICA tocomplex fMRI data have demonstrated the promise of ICA for the analysis of fMRI data inits native complex form [2, 9, 10, 11], but have also underlined the importance ofpreprocessing and visualization techniques to fully take advantage of the additionalinformation presented by the phase.Successful application of both the model-based and data-driven approaches for analysis ofcomplex-valued fMRI data requires the development of pre-and post-processing techniquesthat can help exploit the phase information and therefore improve the usability of thesealgorithms. In this paper, we introduce a phase ambiguity correction scheme and aMahalanobis distance-based thresholding method that can significantly help improve theanalysis and visualization of complex-valued fMRI data. We show the effectiveness of thesemethods when used in the analysis of actual fMRI group data using a complex-valued ICAalgorithm. The main idea for phase ambiguity correction with some preliminary results weregiven in [12]. These methods, together with a previously developed complex-valued de-noising algorithm [13, 14], form a successful framework that allows one to utilize the phaseinformation in fMRI data to enhance the sensitivity and specificity of ICA of fMRI studies.Fig. 1, shows the steps of the framework, including the two methods introduced in thispaper, and the de-noising method. The phase correction step can be incorporated directlyinto the ICA step as we discuss in the paper. The Mahalanobis distance-based visualizationand de-noising methods can be used for model-based approaches, as well as data-drivenones. The rest of the steps in Fig. 1 are typical steps in the pipeline, such as using PCA fordata dimensionality reduction and the use of the MATLAB Toolbox for StatisticalParametric Mapping (SPM)2 for motion correction.In Section 3, we describe the phase ambiguity correction scheme that solves the inherentphase scaling ambiguity found in complex-valued data-driven algorithms, such as ICA. Thephase ambiguity correction scheme can be either applied subsequent to ICA of fMRI or canbe incorporated into the ICA algorithm in the form of prior information—when available—to eliminate the need for further processing.In Section 4, we describe the novel visualization technique, based on the Mahalanobisdistance-based metric, which can be used to identify voxels of interest in complex-valuedfMRI images and which provides a single threshold based upon both the phase andmagnitude data. In Section 5, we present results of the methods introduced here whenapplied to actual fMRI group data.2SPM, URL: http://www.3l.ion.ucl.ac.uk/spm/software/spm5Pattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.2. Background2.1. Spatial ICA of Complex-valued fMRI DataPage 3Independent component analysis has emerged as an attractive analysis tool for discoveringhidden factors in observed data and has been successfully applied for data analysis in a widearray of applications [15, 16, 17]. Especially in the case of fMRI analysis, it has provenparticularly fruitful [18, 19].In the ICA analysis of fMRI data, we assume independence of spatial brain activations (forspatial ICA), and write the complex ICA model aswhere x is the random vector of observation, A is the mixing matrix and s is the independentsource vector. For the volume image data of v voxels and n time points, we can write X =[x1, x2, ···, xv] and S = [s1, s2, ···, sv] where X ∈ ℂn×v is formed using the fMRI data suchthat the kth row is formed by flattening the volume image data of v voxels into a row. Therows of X are indexed as a function of time from one to n and the kth row vector of S is thekth spatial map. The assumed kth mixing column vector of A represents the time course forthe kth spatial map.ICA achieves demixing by estimating a weight matrix W such that ŝ = Wx = PΛs. Here, P, apermutation matrix, represents the permutation ambiguity and Λ, a diagonal matrix,represents the scaling ambiguity of ICA, which has a magnitude and phase term in thecomplex-valued implementation of ICA.Thus, spatial ICA finds systematically nonoverlapping, temporally coherent brain regionswithout constraining the temporal domain. A principal advantage of this approach is itsapplicability to cognitive paradigms for which detailed a priori models of brain activity arenot available. Following its first application by McKeown et al. [19], ICA has beensuccessfully used in a number of exciting fMRI applications, especially in those that haveproven challenging with the standard regression-type approaches. These includeidentification of various signal types (e.g., task-related, transiently task-related, andphysiology-related signals) in the spatial or temporal domain, analysis of multisubject fMRIdata, incorporation of a priori information to improve the estimates, clinical applications,and for the analysis of complex-valued fMRI data. A comprehensive review of ICAapproaches for fMRI data along with main references in the area is given in [20] and in [21].In spatial ICA, the number of estimated independent components (ICs) correspond to thenumber of time-points, which in general are in the order of 100s, and for temporal ICA, theycorrespond to the number of voxels that are much higher. Hence, in both cases, a principalcomponent analysis (PCA) stage traditionally precedes the ICA algorithm that is used towhiten the data and to determine the effective model order. Information theoretic criteriasuch as Akaike’s information criterion, and the minimum description length (MDL)—or theBayesian information criterion—arise as natural solutions for determining the effectiveorder of the components as in [22].ICA requires computation of higher-order statistics in the data, either explicitly as in theapproaches based on cumulants, or implicitly through the use of non-linear functions. ICAapproaches that rely on non-linear functions to implicitly generate the higher-order statisticsto achieve independence offer practical and effective solutions to the ICA problem. Asdiscussed in [23], a number of simple functions from the trigonometric family providePattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 4robust and effective solutions for the ICA problem in the complex domain as in the realcase, or simple adaptive mechanisms can be employed to estimate the independentcomponents in a deflationary mode as discussed in [24] or simultaneously as in [25].Since, relative to the magnitude data, there is less known about fMRI data when used in itsnative complex form, it is desirable to avoid making assumptions such as the circularity ofsource distributions. A complex random variable (v = vre + jvim) is considered circular whenits pdf is rotationally invariant, i.e., when the pdf can be written as Hence, for a circular random variable, the phase is non-informative..Circularity is a limiting assumption and as we demonstrate with an example, fMRI dataexhibits noncircular characteristic in general (see Fig. 2). Since the data are expected to benoncircular, is important to use ICA algorithms that do not make such assumptions as in [26,24, 25]. However, certain information about the circularity of the data, such as thepreprocessing steps used in the scanner, can be incorporated into the algorithm as we discussin Section 3.3. Phase Ambiguity CorrectionIn Section 2.1, it was shown how ICA estimates both the sources s and the mixing matrix Aup to a permutation and scaling ambiguity. In (1), the relationship, due to the scalingambiguity, between the estimated and the true value of the sources and the mixing matrix isshown. The phase term in the scaling ambiguity presents additional challenges not observedin real-valued ICA, as in fMRI group studies, the estimated distribution of matching sourcesacross subjects will have different unknown rotations that hinders analysis. Needless to sayit is of utmost importance to be able to compare matching estimated components acrosssubjects in fMRI studies. For the ICA model introduced in Section 2.1, we can write(1)where Λ is the scaling ambiguity diagonal matrix, which has a magnitude and phase term inthe complex-valued implementation of ICA if we ignore the permutation ambiguity. This isthe reason for the rotation of the 2-D estimated source scatter plots by an arbitrary angle.In this section, we present two methods that alleviates the phase ambiguity problem andallows for group analysis of estimated ICs. First we introduce an ICA approach that caneffectively utilize prior information about the orientation of the raw complex-valued fMRIdata to correct the phase rotation of the estimated ICA components. Next, we introduce anapproach that can be used to correct for phase rotation in the absence of such priorinformation and/or when we are interested in using a flexible ICA algorithm, such as onethat adaptively estimates the source distributions as in [24]. This second approach in generalcan be used with any group analysis method (not just ICA), whenever there is phaseambiguity across subjects.Phase ambiguity affects other applications that use complex-valued data and blind channelidentification algorithms are an example [27], therefore methods similar to the onesintroduced here could be used to in these areas as well.3.1. Phase Ambiguity Correction through Prior InformationA common pre-processing technique used in the after the acquisition of complex-valuedfMRI data is to re-normalize the data such that most of the power is concentrated in the realpart of the complex-valued fMRI signal [28]. This reconstruction technique (second block inPattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 5Fig. 1) is one of many that are usually used to eliminate collection-related phase errors inraw MRI data, for example, off-resonance effects, radio-frequency pulse imperfections,relaxation effects or discretization artifacts [29, 30]. Such processing makes the visualizationeasy as all the acquired data then has the same orientation and can be easily added in thecase of group analyses. The phase ambiguity correction schemes introduced in this paper aresimilar to this pre-processing technique, but they are applied to correct the phase ambiguityin the estimated ICs using complex-valued ICA (phase ambiguity correction block in Fig. 1)and not to correct the raw fMRI data phase errors as is done in [28].Knowledge about the distribution of the fMRI data can be incorporated into the selection ofthe nonlinear function for the ICA algorithm so that the estimated sources will have thesame orientation as the preprocessed data. Here, we present an example of the selection ofthe nonlinear functions in applications where the fMRI data are preprocessed in the scannerso that most of the power is in the real component [28]. In [23], it has been shown that anumber of trigonometric functions and their hyperbolic counterparts can be effectively usedfor performing ICA, and in [31] it has been noted that by selecting the appropriate function,we can effectively alleviate the phase ambiguity. In Fig. 3, we show the approximate densitythe use of score function atanh implies (given by exp(−u*atanhu)), which exactlycorresponds to the data that results from the fMRI preprocessing we have described [28]. Inthe second row of the same figure, we show estimation results of joint approximatediagonalization of eigenmatrices (JADE) [32] and ML with atanh as the score function. Inthe estimation results, we note that when the direction of the source matches that of the pdfimplied by the score function, the shape of the distribution of the estimated components ispreserved, i.e., the phase ambiguity that exists for the complex ICA (Λ) is mitigated. Thus,even though the correlations of the magnitude with the original sources are close to unity forboth JADE and ML-atanh in this example, the correlation of real and imaginary parts arehigh (close to unity) only for the ML-atanh estimated sources for which the direction of thesource density matches with that of the non-linearity. The red source estimate shows arotated source estimate whose asymmetry does not match with that of the density modelgiven by atanh. These results were consistent over 100 different realizations of the sourcedistributions.Hence, we can use atanh when such a preprocessing—a desirable form for complex fMRIdata—is utilized. The only correction that will then have to be carried out is the signcorrection to make sure that most background voxels are around “0”, a post processing stepcommon to real-valued ICA of fMRI [20]. Matching ICs across subjects will have similarorientation and then allow for group analysisThe strength of this scheme lays on identifying prior information that can help in theselection of the non-linear function used in the ICA cost functions. Similar prior informationcan be used to identify the optimal non-linearities in fMRI data with different pre-processingtechniques.3.2. Post-ICA Phase Ambiguity CorrectionPrior information on fMRI data preprocessing and the expected source noncircularity mightnot be always available. Also, when one uses an adaptive and hence more flexible ICAalgorithm that estimates the source distributions adaptively, it might not be desirable to use afixed non-linearity as discussed in section 3.1.The rotation angle ∠λk = e−jθk in each kth term of the unknown diagonal scaling ambiguitymatrix in (1), rotates each estimated source ŝk by an unknown angle θk. We propose a phaseambiguity correction scheme based on PCA such that the phase values of the voxels ofinterest—those with high magnitude values—are similarly oriented to make thePattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 6identification of functional changes in the fMRI data and group analysis possible. Thescheme changes the orientation of the pdf of the estimated sources so that the voxels ofinterest are mostly concentrated on the positive side of the real part of the complex domain,such thatwhich can be easily solved by applying PCA to the data of the estimated sources. The firststep is to separate the complex-valued data into its real and imaginary components to makeit a two dimensional real-valued dataset. PCA then automatically aligns their first principalcomponent—one with the highest variance—with the real axis. The final step resolves thesign ambiguity of the PCA step, since the aligned data may be rotated 180° degrees so thatthe majority of values are concentrated on the negative part of the real axis.This scheme can be applied to corresponding estimated sources of interest across all thesubjects, therefore obtaining phase images with similar phase values in the voxels ofinterest. Fig. 2 shows the scatter plot of the real and imaginary data of an estimated sourcebefore and after the PCA based phase ambiguity correction. This method does not changethe magnitude of the estimated source, but it makes sure that phase value of the voxels ofhigher magnitude are close to 0 radian in the obtained wrapped ([−π, π] radians) phaseimage.Is important to remember that to satisfy (1), if as estimated source (ŝk) is rotated by ∠λk =e−jθ̃k, its corresponding mixing matrix column vector (âk) needs to be rotated by (∠λk−1 =ej(π − θ̃k). It will be shown in the results section that applying this phase correction isnecesary for the estimation of the average complex-valued spatial fMRI sources and theircorresponding timecourses.4. Mahalanobis Distance-Based Visualization MethodIn studies of complex-valued fMRI data the results are usually presented using only themagnitude information, even though the phase information is available at no cost. Forexample, estimated fMRI sources in spatial ICA are usually presented using Z-score (Zr)thresholded magnitude images (i.e. slices) to highlight the voxels of interest. The Zr valuesfor each of the (l) voxels of the magnitude images of the kth source are calculated bywhere η̂k and σ̂k are the mean and standard deviation, respectively, of the magnitude imagesof the estimated kth source (ŝk).The visualization method we introduce here takes into account the full complex-valued data,including the phase, by applying a two dimensional Mahalanobis distance-based metric (Zc)on all the complex-valued voxels (l) of the estimated sources given by(2)(3)(4)Pattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 7where ŝk,l = [ŝk,l,re, ŝk,l,im]T; and μk and Ck are the corresponding mean and covariance of theestimated kth source. If the covariance matrix is the identity matrix, the Mahalanobisdistance reduces to the Euclidean distance. The Mahalanobis distance is equal to theabsolute value of the Z-score metric when the data is univariate. Therefore, the obtained Zcmaps are usually thresholded using the same typical values used in practice to threshold Zrmaps when working with magnitude only fMRI data, e.g., 2, 3 and 4.Activated voxels are identified if they have a value higher than a previously specifiedthreshold. The magnitude and phase of the voxels of interest can now be further analyzed.Furthermore, we can also represent the results by displaying the Mahalanobis distance-basedimages, the same way Z-score images are used in real-valued analysis.An optional step is to eliminate low quality—noisy—voxels from the estimated sources,which are usually low magnitude voxels. In our application, we use the phase derivativevariance quality map [33], since as desired, it assigns bad quality values to noisy areas in thecomplex images, i.e., volumes in the data where the voxels phase values and their gradientsexhibit high variation. This visualization technique can be used with other analysisalgorithms besides ICA.5. ResultsIn this section, we first introduce the fMRI data used in our analysis. We then present resultsfor the Zc and others visualization methods and show their performance in identifying task-related voxels after the application of a complex-valued ICA algorithm to the fMRI data. InSection 5.3, we show how the introduced phase ambiguity correction methods improve theperformance of complex-valued ICA of fMRI. The results for the visualization method areshown first since the Zc method is used to present the results of the phase ambiguitycorrection methods.5.1. fMRI DataThe dataset used in this paper is from sixteen subjects performing a finger-tapping motortask while receiving auditory instructions. The paradigm involves a block design withalternating periods of 30 s ON (finger tapping) and 30 s OFF (rest). The experiments wereperformed on a 3T Siemens TRIO TIM system with a 12-channel radio frequency (RF) coil.The fMRI experiment used a standard Siemens gradient-echo EPI sequence modified tostore real and imaginary data separately. The data were pre-processed for motion correctionand spatial normalization into standard Montreal Neurological Institute space using SPM.The magnitude and phase images, separately, were previously analyzed using a GLMapproach in [6].When performing spatial ICA of fMRI data [20], we use PCA to reduce the dimensionalityof the complex-valued fMRI data. The number of effective components for this dataset isselected as 30, using the MDL criterion for complex valued data as in [9].The complex-valued data was de-noised by using the Quality Map Phase De-noising(QMPD) method previously introduced in [13, 14]. The QMPD method allows the effectiveidentification and elimination of noisy regions in the complex-valued fMRI data. Themajority of the eliminated voxels are outside the brain gray matter area; the rest of theeliminated regions correspond to known physiologically noisy areas like the largesusceptibility artefacts around the nasal and frontal sinuses, the ear canal and the largevessels on the base of the brain. The last step of this algorithm consist of applying asmoothing filter (e.g., 10×10×10 mm3 full width at half-maximum Gaussian kernel) toincrease the contrast to noise ratio of the voxels that were not eliminated. We implemented aPattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 8modified QMPD algorithm that combines the de-noising masks obtained from all subjects toallow for group comparison. This de-noising method, together with the rest of the methodsintroduced here, is one of the main components of the framework developed by our teamthat allows the incorporation of the phase information in all the steps of our application ofcomplex-valued ICA algorithms (Fig. 1).5.2. Visualization ResultsIn this section, we demonstrate that the Mahalanobis Distance-Based thresholding method(Zc), by including the phase information, can provide better sensitivity and specificity inidentifying task-related voxels in the estimated ICA sources when compared to the typicallyused magnitude-only Z-score thresholding method (Zr). In addition, we show that even whenmagnitude-only analysis is desired better performance can be obtained using moreappropriate thresholding methods.For this experiment, we estimated 30 components using a complex-valued Infomax ICAalgorithm [23] on the data of each of the 16 subjects performing the finger-tapping motortask. The component with the highest correlation to the paradigm timecourse was identifiedin all the subjects, which in this case corresponds to a motor task-related component. Anaverage of the motor task-related component was calculated using the data from all thesubjects after phase ambiguity correction as described in Section 3.2. To evaluate theperformance of the visualization algorithms we built a binary mask that identifies the motorcortex area where we expect voxels to be activated, see Fig. 4. The mask for the motorcortex area was created by joining the Brodmann areas 4, 6, 43 and 47 using the WFUPickAtlas3 software in Matlab.We implemented parametric (Section 5.2.1) and non-parametric (Section 5.2.2) methods forthresholding the Zc and Zr sample values and calculated the receiver operating characteristic(ROC) curves for those. The probability of true positives (TP) in the generated ROC curvesindicates the number of voxels that survive the threshold (at each point in the ROC curve)and that fall inside the motor cortex mask; similarly, the probability of false positive (FP)indicates the number of voxels that pass the various thresholds and that fall outside themotor cortex mask. Comparison of the ROC curves for the different thresholding methods isdone by calculating the ratio of their respective area under the curve (AUC). The absolutevalue of the ROC curves area is not of interest since the test is not designed to obtain thetypical ideal AUC value of 1.0. A AUC value of 1.0 is only obtained when all the voxels inthe created motor cortex mask are identified at all the thresholds, which is impossible sinceby definition the ROC curves are created by gradually adding more voxels at each threshold.Better perfomance, as measured by the a higher AUC, indicates overall higher sensitivityand specificity at the various thresholds used in the ROC curves. Higher sensitivity meansthat a higher number of voxels are identified as active. Similarly, an increase in specificityindicates that a large number of the additional identified voxels are located inside the motorcortex area mask.5.2.1. Parametric Results—In this section, the thresholds needed to create the ROCcurves are obtained by approximating the distributions of the estimated average motor task-related independent component by various well known probability distribution functions(pdf). The Zr values are usually approximated with a Gaussian pdf and probabilitiescalculated for each voxel, those with low probability in the tails of the distribution areassumed to be the active ones. Similarly, under the assumption that the real and imaginarydata of the estimated ICs are bivariate Gaussian, the Zc is approximated by a chi-square3WFU, URL: http://fmri.wfubmc.edu/cms/softwarePattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 9distribution with two degrees of freedom. The calculated probabilities for both Zc and Zrsamples are used to threshold the estimated IC and create the ROC curves in Fig. 5 ( Zc chi-square and Zr Gaussian lines, respectively). The Zc thresholding method provides betterperformance than the Zr thresholding method as confirmed by the ratio of the AUC values: (see Table 1).Additional parametric thresholding methods were implemented to compare the performanceof using the complex-valued data versus only using the magnitude of the IC data forvisualization. The complex-valued data was thresholded by using a bivariate Gaussiandistribution approximation for the real and imaginary data of the IC, the results was identicalto the Zc result (see Bivariate Gaussian result in Table 1). This identical result was expectedsince the two methods operate under the same assumption that the underlying real andimaginary data are bivariate Gaussian. The advantage of the Zc method is that it contains thesame information under a single positive number.Various pdfs were used to approximate the distribution of the magnitude-only data of theestimated IC. The majority of the implemented distributions outperformed the Zr results, butthe best result was obtained by assuming that the real and imaginary data of the IC areindependent standard Gaussian random variables, under this assumption the squaremagnitude has a chi-square distribution with two degrees of freedom(see Magnitude Chi2result in Table 1 and in Fig. 5). This result shows that by using a more appropriateapproximation to the magnitude data better performance can be obtained.A visual example of the increase in sensitivity and specificity obtained by using the ZCthresholding method can be seen in Fig. 6. This figure shows the identified voxels with aprobability of 0.01 calculated by the Zc method under the chi-square distributionapproximation and the Zr method under the Gaussian distribution approximation. The voxelswith a value of 2.0 were only identified by the Zc method, and it can be seen that themajority of them are contiguous with the other identified motor task-related voxels by boththe Zc and Zr methods. The majority of these additional detected voxels had low magnitudebut significantly different phase values than the rest of the voxels.The region detected by Zc is typically larger than the one detected by Zr, because as shownin [3] significant phase changes can be seen in regions where susceptibility (i.e. activation)is changing across a voxel. This typically happens in regions surrounding the center ofactivation, where activation is decreasing (as confirmed in Fig. 6).The two main conclusions from this section are: (1) the two thresholding methods using thecomplex-valued data perform better and (2) there are better parametric approximations tothreshold the magnitude-only data than the Zr Gaussian distribution approximation.5.2.2. Non-Parametric Results—Since parametric evaluations have to be based on aninherent assumption of sample distribution, we also used non-parametric methods todemonstrate that Zc thresholding method provides better performance than the Zrthresholding method. Fig. 7, shows the quantile-quantile (Q-Q) plot of the Zr samples versusthe Zc sample values. The Q-Q plot is a graphical method for comparing two distributions byplotting their quantiles against each other [34], if the samples in a Q-Q plot come from thesame distribution, the plot will be linear. The plot has the sample data displayed with theplot symbol (+), and superimposed on the plot is a line joining the first and third quartiles ofeach distribution (this is a robust linear fit of the order statistics of the two samples). Thisline is extrapolated out to the ends of the sample to help evaluate the linearity of the data 4.4Mathworks, URL:http://www.mathworks.com/help/toolbox/stats/qqplot.htmlPattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 10The Q-Q plot indicates that the Zr samples have a more flat distribution than the Zc samplesas their values go up, this means that the Zr samples are less discriminatory, which confirmsour parametric results.Two new Zr and Zc ROC curves were created (see Fig. 8) by using the more classicaldefinition of probability to identify active voxels. The same number (N) of the highestvalued voxels are extracted from the Zr and Zc samples and used to calculate the differentpoints of their respective ROC curves. The value of N for each point in the ROC curves iscalculated by(5)where P takes values in [0, 1].The AUC value for the non-parametric and parametric ROC curves of Zc are identical. TheAUC ratio between the non-parametric Zr and Zc ROC curves is 0.94. This ratio is hasbigger value that the one calculated with the parametric Zr result, but the conclusion is thesame, using the entire complex-valued data increases the sensitivity and specificity inidentifying activated voxels when compared to magnitude-only visualization. This increasein performance is obtained for free, since the data is inherently complex-valued.5.3. ICA Phase Ambiguity Correction Results5.3.1. ICA using Non-linear Decorrelations with atanh Non-linearity—We appliedcomplex-valued ICA using atanh as the non-linearity as described in section 3.1, hence nophase ambiguity correction is needed for the estimates, except for maybe a sign correction.Fig. 10, shows the magnitude, phase and Zc image—of selected slices—for a motor taskrelated component identified and averaged across all the subjects. The average is performedon the magnitude and phase domain, but similar results were obtained when calculating theaverage in the real and imaginary domains. The motor component is identified automaticallyby regressing the estimated time-courses with the ideal hemodynamic time response. Theresults obtained here show that it is possible to obtain clear magnitude and phase images ofcomponents of interest in group studies. The obtained group phase images have the expectedbipolar distributions, smoothness, continuity and characteristics as described in [3]. In thenext section we show how the phase images of different subjects with no phase ambiguitycorrection can add destructively, hence creating group images with lower magnitude andnoisy phase images.5.3.2. ICA using Infomax with a Circular Non-linearity—Next, we estimate spatialindependent components from the group fMRI data using the Infomax algorithm [23] withthe circular nonlinear function proposed in [35], which does not impose any particularorientation to the distribution of the estimated sources. The obtained group ICA results atthis point can be used to identify the motor task component only in the magnitude image.Applying the post-ICA phase ambiguity correction scheme described in section 3.2 to theestimated components in each subject makes group analysis of the entire complex-valuedimages possible by eliminating the phase ambiguity across subjects. Fig. 11 shows thescatter plot of the average real and imaginary values of the identified motor component inour fMRI group data after phase ambiguity correction. Additionally, Fig. 12 shows thecorresponding magnitude, phase and Zc images for the estimated component. It can beclearly seen that the identified motor task-related voxels correlate with the identified voxelsin Fig. 10, where our post-processing phase ambiguity correction was not necessary.Pattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 11To emphasize the importance of the phase ambiguity correction step, we present the ICAresults obtained from the fMRI group data prior to applying the post-processing phaseambiguity correction. In Fig. 13, we can see the scatter plot of the group average real andimaginary values of the identified motor component before phase ambiguity correction. Thevoxels of the estimated motor component of each subject (including subject one in Fig. 2.a)add destructively, hence creating a more spread scatter plot of voxels with lower magnitudeand less smooth phase values when compared to the results in Fig. 11. Fig. 14 shows themagnitude, Zc and phase of the estimated component prior to phase ambiguity correction,although we can still identify task related voxels, they are not as discriminatory, i.e., lowernumber of identified voxels with lower magnitude values in the motor cortex brain areas ofinterest. Additionally, in the phase image we can see that the phase changes across voxelsare indeed not as smooth and continuous, as the results obtained with phase ambiguitycorrection.In Fig. 9, the ROC curves obtained for Zc with and without phase ambiguity correction areshown. The calculated ROC curves used the same motor cortex mask and the same non-parametric technique used in Section 5.2.2. It can be seen that the AUC of Zc without phaseambiguity correction is lower than the AUC of Zc with phase ambiguity correction, theirratio is equal to 0.93. Additionally, the results of Zc without phase ambiguity correctionwere found to be almost identical to the results obtained with Zr thresholding method, thiscorroborates the finding in [Rowe and Logan NIMG 2005] that processing complex-valuedfMRI data assuming non-informative phase information is identical to magnitude-onlyprocessing.Similar results are obtained with the estimated timecourses (i.e., mixing matrix) when thephase ambiguity correction is applied. In Fig. 15, we show the average group magnitude andphase timecourses for the motor task IC prior and after phase ambiguity correction. Asexpected, the magnitude and phase of the timecourses after phase ambiguity correction havea stronger correlation with the paradigm timecourse convolved with the hemodynamicresponse (see correlation coefficient values for each timecourse in Fig. 15). The averagetimecourse calculations were performed in the real and imaginary domain, but similarbenefits were obtained when calculating the average in the magnitude and phase domain,particularly for the phase.6. DISCUSSIONRobust techniques that can show the advantages of using the phase information in theidentification and analysis of voxels of interest in complex-valued fMRI data are needed.Even in applications where complex-valued algorithms are used to analyze the fMRI data,the majority of the preprocessing and visualization methods used are based on the magnitudeimages. The phase images are usually discarded, primarily because their unfamiliar andnoisy nature poses a challenge for successful study of fMRI We addressed some of theseissues and proposed methods that allow the successful analysis of complex-valued fMRIgroup data. This could strengthen the traditional analysis methods as well as those of data-driven techniques such as ICA by improving their performance in identifying voxels ofinterest.We introduced two effective schemes that can be used to diminish the inherent phase scalingambiguity of complex-valued ICA to allow for group analysis. The phase ambiguitycorrection scheme can be either applied subsequent to ICA of fMRI or can be incorporatedinto the ICA algorithm in the form of prior information—when available—to eliminate theneed for further processing. Additionally, we presented a Mahalanobis distance-basedvisualization method that uses the phase in the estimated fMRI sources to identify task—Pattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 12functional—related voxels. We were able to show that these methods provide bettersensitivity and specifity, than magnitude-only visualization methods, when identifyingvoxels in a estimated motor task-related independent component. This method showsparticular promise for identifying voxels with significant susceptibility changes but that arelocated in low magnitude areas as modeled in [3].The introduced methods are part of a framework that allows the utilization of the phase inthe analysis of complex fMRI data, in particular using ICA that has already shown to holdmuch promise for the task. Future work will concentrate on using the results of ourcomplex-valued analysis of the fMRI data to see if we can enhance the performance ofclassification algorithms in clinical studies.AcknowledgmentsWe appreciate the insight that Dr. Arvind Caprihan, from the The Mind Research Network, provided during theanalysis of the visualization methods.References1. Kwong K, et al. Dynamic magnetic resonance imaging of human brain activity during primarysensory stimulation. Proc Natl Acad Sci. 1992; 89:5675–5679. [PubMed: 1608978]2. Calhoun VD, Adalı T, Pearlson GD, van Zijl PCM, Pekar JJ. Independent component analysis offMRI data in the complex domain. Magnetic Resonance in Medicine. 2002; 48:180–192. [PubMed:12111945]3. Feng Z, Caprihan A, Blagoev KB, Calhoun VD. Biophysical modeling of phase changes in BoldfMRI. NeuroImage. 2010 In Press.4. Rowe DB. Modeling both the magnitude and phase of complex-valued fMRI data. NeuroImage.2005; 25:1310–1324. [PubMed: 15850748]5. Hoogenrad F, Reichenbach J, Haacke E, Lai S, Kuppusamy K, Sprenger M. In vivo measurement ofchanges in venous blood-oxygenation with high resolution functional mri at .95 tesla by measuringchanges in susceptibility and velocity. Magn Reson Med. 1998; 39:97–107. [PubMed: 9438443]6. Arja S, Feng Z, Chen Z, Caprihan A, Kiehl K, Adalı T, Calhoun V. Changes in fMRI magnitudedata and phase data observed in block-design and event-related tasks. NeuroImage. 2010 In Press.7. Chen Z, Caprihan A, Calhoun V. Effect of surrounding vasculature on intravoxel bold signal. MedPhys. 2010; 37:1778–1787. [PubMed: 20443500]8. Menon R. Postacquisition suppression of large-vessel bold signals in high-resolution fmri. MagnReson Med. 2002; 47:1–9. [PubMed: 11754436]9. Xiong, W.; Li, YO.; Li, H.; Adalı, T. On ICA of complex-valued fMRI: Advantages and orderselection. Proc. IEEE Int. Conf. Acoust., Speech, Signal Processing (ICASSP); Las Vegas, Nevada.2008.10. Li, H.; Adalı, T.; Correa, N.; Rodriguez, P.; Calhoun, V. Flexible complex ICA of FMRI data.Proc. IEEE Int. Conf. Acoust., Speech, Signal Processing (ICASSP); 2010.11. Calhoun, VD.; Adalı, T.; Li, YO. Independent component analysis of complex-valued functionalMRI data by complex nonlinearities. Proc. IEEE Int. Symp. Bio. Imag. (ISBI); Arlington, VA.2004.12. Rodriguez, P.; Adalı, T.; Li, H.; Correa, N.; Calhoun, V. Phase correction and denoising for ICA ofcomplex FMRI data, submitted to IEEE Int. Conf. Acoust., Speech, Signal Processing (ICASSP);2010.13. Rodriguez, P.; Correa, N.; Adalı, T.; Calhoun, V. Quality map thresholding for de-noising ofcomplex-valued fMRI data and its application to ICA of fMRI. Proc. IEEE Machine Learning forSignal Processing (MLSP); 2009.14. Rodriguez P, Correa N, Eichele T, Calhoun V, Adalı T. Quality map thresholding for de-noising ofcomplex-valued fMRI data and its application to ICA of fMRI. Journal of Signal ProcessingSystems. 2010Pattern Recognit. Author manuscript; available in PMC 2012 June 1.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptRodriguez et al.Page 1315. Bell A, Sejnowski T. An information maximization approach to blind separation and blinddeconvolution. Neural Computation. 1995; 7:1129–1159. [PubMed: 7584893]16. Hyvarinen, A.; Karhunen, J.; Oja, E. Independent Component Analysis. John Wiley and Sons Inc;New York, USA: 2001.17. Comon P. Independent component analysis: A new concept? Signal Processing. 1994; 36:11–20.18. McKeown MJ, et al. Spatially independent activity patterns in functional magnetic resonanceimaging data during the stroop color-naming task. Proc Natl Acad Sci USA. 1998; 95:803–810.[PubMed: 9448244]19. McKeown MJ, et al. Analysis of fMRI data by blind separation into independent spatialcomponents. Human Brain Mapping. 1998; 6:160–188. [PubMed: 9673671]20. Calhoun VD, Adalı T. Unmixing fMRI with independent component analysis. IEEE Eng Med BioMag. 2006; 25:79–90. [PubMed: 16568940]21. Calhoun V, Liu J, Adalı T. A review of group ICA for fMRI data and ICA for joint inference ofimaging, genetic, and erp data. Neuroimage. 2009; 45:163–172.22. Li YO, Adalı T, Calhoun VD. Estimating the number of independent components for fMRI data.Hum Brain Mapping. 2007; 28:1251–1266.23. Adalı, T.; Kim, T.; Calhoun, VD. Independent component analysis by complex nonlinearities.Proc. IEEE Int. Conf. Acoust., Speech, Signal Processing (ICASSP); Montreal, Canada. 2004. p.525-528.24. Novey M, Adalı T. Complex ICA by negentropy maximization. IEEE Trans Neural Networks.2008; 19:596–609.25. Li, XL.; Adalı, T. Complex independent component analysis by entropy bound minimization;IEEE Trans Circuits and Systems I; 2010. In Press26. Adalı, T.; Li, H. A practical formulation for computation of complex gradients and its applicationto maximum likelihood. Proc. IEEE Int. Conf. Acoust., Speech, Signal Processing (ICASSP);2007.27. Gazzah H, Regalia P, Delmas J, Calhoun V, Abed-Meraim K. A blind multichannel identificationalgorithm robust to order overestimation. IEEE Trans Signal Processing. 2010; 50:1449–1558.28. Hardy E, Hoferer J, Mertens D, Kasper G. Automated phase correction via maximization of thereal signal. Magnetic Resonance Imaging (MRI). 2009; 27:393–400.29. Noll D, Nishimura D, Macovski A. Homodyne detection in magnetic resonance imaging. IEEETrans Med Imaging. 1991; 10:154–163. [PubMed: 18222812]30. Bernstein M, Thomasson D, Perman W. Improved detectability in low signal-to-noise ratiomagnetic resonance images by means of a phase-corrected real reconstruction. Med Phys. 1989;16:813–817. [PubMed: 2811764]31. Adalı, T.; Li, H. A practical formulation for computation of complex gradients and its applicationto maximum likelihood ICA. Proc. IEEE Int. Conf. Acoust., Speech, Signal Processing (ICASSP);Honolulu, Hawaii. 2007. p. II–613-II–636.32. Cardoso JF, Souloumiac A. Blind beamforming for non-Gaussian signals. IEEE Proc Radar SignalProcessing. 1993; 140:362–370.33. Ghiglia, DC.; Pritt, MD. Two-Dimensional Phase Unwrapping. Wiley; New York, USA: 1998.34. Gnanadesikan R, Wilk M. Probability plotting methods for the analysis of data. Biometrika. 1968;55:1–17. [PubMed: 5661047]35. Anemüller J, Sejnowski TJ, Makeig S. Complex independent component analysis of frequency-domain electroencephalographic data. Neural Networks. 2003; 16:1311–1323. [PubMed:14622887]Pattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 14I-NHPAAuthorManuscriptFigure 1.Framework that allows the utilization of the phase along with magnitude at various steps inthe implementation of a complex-valued ICA algorithm. Phase ambiguity correction andMahalanobis distance-based visualization (Zc) methods are introduced in this paper and theQuality Map Phase De-noising (QMPD) method is introduced in [13, 14].I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 15I-NHPAAuthorManuscriptFigure 2.Complex scatter plot of an estimated motor task-related component of a single subject (seeSection 5.1) before and after applying the PCA-based phase ambiguity correction scheme.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 16Figure 3.Top: Form of pdf implied by the score function atanh; Bottom: Estimation results with MLusing atanh score function and JADE for four non-circular sources.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 17I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptFigure 4.Binary mask identifying motor cortex area (Brodmann areas: 4, 6, 43 and 47).I-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 18Figure 5.ROC curves obtained for the Zc, Zr and magnitude data of the estimated average motor task-related IC under different assumed pdfs. Comparison of the ROC curves for the differentthresholding methods is done by calculating the ratio of their respective area under the curve(AUC). The absolute value of the ROC curves area is not of interest since the test is notdesigned to obtain the typical ideal AUC value of 1.0.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 19Figure 6.Identified voxels (with a probability of 0.01) by the Zc method under the chi-squaredistribution approximation and the Zr method under the Gaussian distributionapproximation. Red voxels were identified by both methods. Yellow voxels are those thatare identified only by Zc.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 20Figure 7.QQ plot of Zr values versus Zc values. The Q-Q plot is a graphical method for comparingtwo distributions by plotting their quantiles against each other, if the samples in a Q-Q plotcome from the same distribution, the plot will be linear.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 21Figure 8.Non-parametric ROC curves obtained for the Zc and Zr samples. Comparison of the ROCcurves is done by calculating the ratio of their respective area under the curve (AUC). Theabsolute value of the ROC curves area is not of interest since the test is not designed toobtain the typical ideal AUC value of 1.0.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 22Figure 9.Non-parametric ROC curves obtained for Zr and for Zc, with and without phase ambiguitycorrection. Comparison of the ROC curves for the different thresholding methods is done bycalculating the ratio of their respective area under the curve (AUC). The absolute value ofthe ROC curves area is not of interest since the test is not designed to obtain the typical idealAUC value of 1.0.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 23I-NHPAAuthorManuscriptFigure 10.Average magnitude, phase and Zc maps for the estimated motor component using atanh non-linearity. Voxels with a |Zc| > 3.5 and good quality were identified as voxels of interest.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 24Figure 11.The average real and imaginary values of the fMRI group estimated motor component afterphase ambiguity correction.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 25I-NHPAAuthorManuscriptFigure 12.Average magnitude, phase and Zc maps for the estimated group motor component usingInfomax algorithm with circular non-linearity after phase ambiguity correction. Voxels witha |Zc| > 4.0 and good quality were identified as voxels of interest.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 26Figure 13.The average real and imaginary values of the fMRI group estimated motor component, butwith no post-processing phase ambiguity correction.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 27I-NHPAAuthorManuscriptFigure 14.Average magnitude, phase and Zc maps for the estimated group motor component usingInfomax algorithm with circular non-linearity but with no post-processing phase ambiguitycorrection. Voxels with a |Zc| > 4.0 and good quality were identified as voxels of interest.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 28Figure 15.Average magnitude and phase timecourses for the estimated motor component usingInfomax algorithm with circular non-linearity prior (a,b) and after (c,d) phase ambiguitycorrection. The correlation coefficient (ρ) between each of the displayed magnitude andphase timecourses and the paradigm timecourse convolved with the hemodynamic responseare shown below the respective figures.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   Rodriguez et al.Page 29Ratio of the AUC values of the ROC curves obtained from the Zc, Zr, magnitude and complex-valued data ofthe estimated average motor task-related under different assumed pdfs versus the AUC value of Zc under thechi-square distribution: Table 1Zc Chi2Zr GaussianBivariate Gaussian Magnitude Chi21.00.771.00.95I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptPattern Recognit. Author manuscript; available in PMC 2012 June 1.   