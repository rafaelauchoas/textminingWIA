I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptNIH Public AccessAuthor ManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.Published in final edited form as:Med Image Anal. 2014 October ; 18(7): 1059–1069. doi:10.1016/j.media.2014.05.002.Automated Detection of Brain Abnormalities in NeonatalHypoxia Ischemic Injury from MR ImagesNirmalya Ghosh1,†, Yu Sun2,†, Bir Bhanu2, Stephen Ashwal1, and Andre Obenaus1,3,*1 Department of Pediatrics, Loma Linda University School of Medicine, Loma Linda, CA 92354,USA2 Center for Research in Intelligent Systems (CRIS), University of California, Riverside, CA92521, USA3 Cell, Molecular and Developmental Biology Program and Department of Neuroscience,University of California, Riverside, 1140 Bachelor Hall, Riverside, California, 92521 USAAbstractWe compared the efficacy of three automated brain injury detection methods, namely symmetry-integrated region growing (SIRG), hierarchical region splitting (HRS) and modified watershedsegmentation (MWS) in human and animal magnetic resonance imaging (MRI) datasets for thedetection of hypoxic ischemic injuries (HII). Diffusion weighted imaging (DWI, 1.5T) data fromneonatal arterial ischemic stroke (AIS) patients, as well as T2-weighted imaging (T2WI, 11.7T,4.7T) at seven different time-points (1, 4, 7, 10, 17, 24 and 31 days post HII) in rat-pup model ofhypoxic ischemic injury were used to check the temporal efficacy of our computationalapproaches. Sensitivity, specificity, similarity were used as performance metrics based on manual(‘gold standard’) injury detection to quantify comparisons. When compared to the manual goldstandard, automated injury location results from SIRG performed the best in 62% of the data,while 29% for HRS and 9% for MWS. Injury severity detection revealed that SIRG performed thebest in 67% cases while HRS for 33% data. Prior information is required by HRS and MWS, butnot by SIRG. However, SIRG is sensitive to parameter-tuning, while HRS and MWS are not.Among these methods, SIRG performs the best in detecting lesion volumes; HRS is the mostrobust, while MWS lags behind in both respects.Keywordshypoxia ischemic injury; hierarchical region splitting; watershed; symmetry; arterial ischemicstroke© 2014 Elsevier B.V. All rights reserved*Corresponding Author: Andre Obenaus, PhD Department of Pediatrics Loma Linda University 11175 Campus Street, Rm A1120Loma Linda, California, 92354, USA Tel: 01-909-558-7801 Fax: 01-909-558-7519 aobenaus@llu.edu.†- both authors contributed equally to this workPublisher's Disclaimer: This is a PDF file of an unedited manuscript that has been accepted for publication. As a service to ourcustomers we are providing this early version of the manuscript. The manuscript will undergo copyediting, typesetting, and review ofthe resulting proof before it is published in its final citable form. Please note that during the production process errors may bediscovered which could affect the content, and all legal disclaimers that apply to the journal pertain.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.1. INTRODUCTIONPage 2Magnetic resonance imaging (MRI) datasets contain information that characterizes normaland abnormal tissues based on their MR physical properties and anatomical locations. Inclinical trials, MRI indices are used as outcome measures to assess pathological changes andto monitor treatment efficacy (Schiemanck et al., 2006). Traditionally, regions or boundariesof interest (ROI) on MRI, either in healthy or injured tissues are manually traced and can befraught with inconsistencies between users, potential biases, difficulty in replicating data,and low throughput (Niimi et al., 2007). Computational advances in efficient ROI detectionalgorithms are important for both 1) clinical diagnosis, 2) assessment of treatment and 3)experimental and clinical research objectives (Ghosh et al., 2012a).Advances in computer vision and pattern recognition have made inroads using severalcomputational ROI detection techniques in medical MRI data (Anbeek et al., 2008; Bergo etal., 2008; Birgani et al., 2008; Cuadra et al., 2004; Hojjatoleslami and Kruggel, 2001; Kabiret al., 2007; Kharrat et al., 2009; Khotanlou et al., 2009; Manana et al., 2006; Ray et al.,2007; Saha and Bandyopadhyay, 2007; Van Leemput et al., 2001; Zhiguo et al., 2005).Comparison of these existing methods (Table 1) reveals several computational challenges,including: (a) partial volume effects, (b) low contrast, and (c) motion artifacts that blur ROI/anatomical boundaries (Table 2). These challenges still remain even after a range ofproposed solutions to improve computational assessments, including registration (Schmidt etal., 2005), normalization (Kabir et al., 2007), or use of prior brain tissue models particularlyfor adult MR data (Birgani et al., 2008). While prior probabilistic models for brain anatomyand specific diseases have been used (Corso et al., 2008), they are not robust to injuryinduced brain distortions, as model-subject co-registration often fails (Cuadra et al., 2004;Ghosh et al., 2012a). Curve fitting based methods like active contour snakes (Droske et al.,2001; Liang et al., 2006; Zhou and Xie, 2013), level-set propagation (Droske et al., 2001)and their combined and/or modified versions (Bai et al., 2013; Kazemifar et al., 2014; LeGuyader and Vese, 2008; Liang et al., 2006; Mesejo et al., 2014; Somkantha et al., 2011;Wang et al., 2013) have been applied to medical image segmentation. But these methodssuffer from manual interventions (Liang et al., 2006; Zhou and Xie, 2013), computationalcomplexity (Kazemifar et al., 2014; Mesejo et al., 2014), dependence on MRI contrast levels(Kazerooni et al., 2011; Liang et al., 2006; Somkantha et al., 2011) and inadequate cues forefficient registration to prior-models (Bai et al., 2013; Le Guyader and Vese, 2008; Wang etal., 2013) and atlases (Kazemifar et al., 2014), specifically in low-contrast noisy MRI data(Zhou and Xie, 2013).Moreover, for neonatal brains, age-matched brain maps and prior models are not readilyavailable (due to scarce data from healthy controls) and often cannot be co-registered easilyas a result of increased water content and structural variability in immature brains (Ghosh etal., 2012a). Thus, MRI based automated detection of neonatal brain injury remainsextremely challenging and a comparative study of different techniques might bring forthcase-specific applications and future computational improvements by wisely fusing morethan one techniques.Med Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 3The rationale for undertaking the current study was to twofold: firstly, to compare three fullyautomated computational approaches to study neonatal HII without using any prior modelsor brain atlases, and secondly to evaluate these advances temporally, as the ischemic lesionrapidly evolves. We tested all aspects first in our well characterized model of rodentneonatal HII followed by validation in human HII MRI data. We report on the comparativeusage of three state-of-the-art computational methods for ROI detection from MR imagesfollowing neonatal HII. Specifically, we assessed a symmetry-integrated region growing(SIRG) method (Yu et al., 2009), a hierarchical region splitting (HRS) method (Ghosh et al.,2011), and a modified watershed (MWS) method (Ratan et al., 2009). Using MRI data froman animal model and patients with neonatal ischemia, the performance of these threemethods were compared to manually detected ground-truths based on usage of priorknowledge, volumetric accuracy, regional overlap and robustness (lesion detection in inmultiple MR slices and across cohorts). We found that for evolving neonatal ischemicinjury, SIRG performed best overall but HRS was the most robust, and fusion of these twotechniques in future studies has a greater potential for automated injury detection from brainMRI data.2. MATERIALS AND METHODS2.1. Clinical and Animal MR DataAll three of our computational methods were tested on human and animal datasets. In ouranimal studies we utilized postnatal 10d old rat pups that underwent neonatal HII, using theRice-Vannucci Model (RVM) of unilateral permanent carotid artery ligation with 8%hypoxia (Ghosh et al., 2012a). The current study utilized neonatal rats (n=4) at 7 differenttime points to monitor to evolution of the ischemic injury. In addition, n=4 rodents were alsoassessed at a lower MR field strength (4.7T) at later time-points. T2-weighted images(T2WI) were acquired at seven different time-points (1, 4, 7, 10, 17, 24 and 31d) postinduction of HII. This dynamic range of time points was chosen based on previous studiesthat revealed the dynamic nature of the evolving HII injury (Obenaus et al., 2011a). Allanimal protocols were approved by our Institutional Animal Care and Use Committee. Allof the key imaging acquisition parameters are summarized in Table 3 (see also (Ghosh et al.,2011)).In our clinical data sets we utilized diffusion weighted imaging (DWI) and their quantitativeapparent diffusion coefficient (ADC) maps from neonatal patients (n=2) evaluated forarterial ischemic stroke (AIS). De-identified neonatal data were acquired at 3-5d post injury(Ghosh et al., 2012b). All patient data were approved by our Institutional Review Board. Allof the key imaging acquisition parameters are summarized in Table 3.In both experimental animal models and human MR data, experienced evaluators providedground-truth manually derived ROIs for comparison and testing purposes. As we foundearlier that inter-observer variability for lesion detection is small (Ghosh et al., 2012b), wehave used the mean ROI location from two experienced raters as the gold-standard forcomparison. A minor caveat is that both SIRG and MWS methods used relative intensitybased TIFF images whereas HRS approach can utilize directly T2- and ADC values forMed Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 4detection. In addition, skull stripping and brain extraction from MRI data was performed byHRS using published preprocessing steps (Ghosh et al., 2012b).2.2. Lesion Detection by Symmetry-Integrated Region Growing (SIRG)The SIRG lesion detection method (Yu et al., 2009) takes the original MR image (Fig. 1a),finds the axis of symmetry (Fig. 1b), derives a symmetry affinity matrix (Fig. 1c) that isused as a measure of symmetry in later steps. The next step enhances segmentation resultsby verifying that the symmetric parts are segmented appropriately (Fig. 1d), followed bycomputation of kurtosis and skewness from the symmetry affinity matrix which are used toextract the asymmetric regions from segmented brain (Fig. 1e). Simultaneously, thesymmetry affinity matrix (Fig. 1c) from each MRI slice is also used for clustering andidentification of asymmetric groups using 3D relaxation (Fig. 1f). The 3D relaxation andkurtosis/skewness results are then fused to obtain a more refined asymmetric region (Fig.1g). Finally, an unsupervised classifier extracts the regions of injury from the asymmetricregions (Fig. 1h) by incorporating 3D information from 2D MRI slices as an additional newfeature (Fig. 1, right panel). Key parameters used in SIRG method are summarized in Table4.Symmetry Extraction—A high-speed method was used to extract the global reflectivesymmetry axis of the brain. We used a global symmetric constellation of features (Lowe,2004) to detect the symmetry axis of the MRI brain images (Fig. 1b), that were then utilizedto compute a symmetry affinity matrix (Fig. 1c), which is a cross-correlation between theoriginal image and the symmetrically reflected image. The value of each point in an affinitymatrix corresponds to the pixel’s symmetry level, valued from 0 (symmetric) to 1(asymmetric). The symmetry affinity measure is computed using the Curvature of GradientVector Flow (CGVF) (Gupta et al., 2005; Prasad and Yegnanarayana, 2004).Segmentation—We utilized a symmetry-integrated region growing segmentationapproach (Sun and Bhanu, 2012; Yu and Bhanu, 2009) to segment the brain into differenttissues. The pixels i and neighboring region j with similarity less than a threshold δ(i, j)<δgis grown into a larger region. The similarity δ(i,j)=δR(i, j)δS(i, j) is composed of the regionfeature similarity and the symmetry similarity constraints, respectively. Traditional regiongrowing segmentation accepts color, gray scale, texture or shape as a similarity constraintδR(i, j) for segmentation (Nan et al., 2009). However, we included a symmetry constraintderived from the symmetry affinity matrix which was integrated into the region growingalgorithm as shown below:Eq. 1where, Ci and Cj are symmetry affinities of pixel i and neighboring region j. For the firstterm of Equation (1), if both patterns i and j indicate low symmetry affinities (highlysymmetric), they are more likely to be aggregated by decreasing the constraint δsymmetry(i, j);while the second term favors more similar symmetry affinities. This results in tissues beingsegmented more symmetrically (see Fig. 1d).Med Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 5Asymmetric Region Extraction—Symmetry-based segmentation separated thesegmented regions as either symmetric or asymmetric, in which the asymmetric regionscontained the ROI. The final asymmetric regions (Fig. 1g) were a fusion of the results fromthe asymmetric regions by region growing (Fig. 1d) followed by region kurtosis/skewnessasymmetry determinations (Fig. 1e) and the segmentation of symmetry affinity matrix (Fig.1f). The asymmetric segments (Fig. 1e) were extracted from all segmented regions based onkurtosis and skewness of symmetry affinity matrix (Yu et al., 2009). Larger kurtosis of aregion’s symmetry affinity values indicated more deviation in the region’s symmetry affinitydistribution (Du and Kopriva, 2008), which was designated as an asymmetric region. Thenegative skewness of a region means that its symmetry affinity distribution is left-tailed,which also indicates an asymmetric region. Separately, 3D asymmetry was extracted (Fig.1f) using a 3D relaxation method (Bhanu and Parvin, 1987). This algorithm segmented thesymmetry affinity matrix by iteratively separating its histogram into two classes, symmetricand asymmetric. The final step was to determine the asymmetric regions by identifying atleast 50% overlap between the asymmetry from 3D relaxation (Fig. 1f) and kurtosis/skewness steps (Fig. 1e).ROI Extraction—The derived asymmetric regions were potential candidates fordesignation as putative HII lesions. An unsupervised Expectation Maximization (EM)classifier with Gaussian Mixture Model (GMM) (Bilmes, 1998) was used to classifycandidate asymmetric regions (see Fig. 1g) into two classes: lesion vs. non-lesion using a 2Dfeature composed of region’s gray scale intensity and the 3D asymmetry volumes assembledfrom the 2D slices (Fig. 1, right panel). Mean intensity values of normal and injured tissueswere first estimated from a small training set comprised of three MRI slices from eachdataset, and the classifier was then trained by unsupervised EM around those mean values asthe centers of GMM. The 3D asymmetry volume then became the 3D binary mask for thefinal asymmetric regions. The binary results of all slices from the MRI dataset were summedtogether to build a 3D asymmetry volume image (Fig. 1, right panel), where groups ofbrighter pixels in the 2D asymmetry volume image indicate larger asymmetric volumevalues, in which the lesion was located. The mean 3D asymmetry volume of eachasymmetric region (Fig. 1g) was used as a feature for classification, where increased mean3D asymmetry volumes were identified as the ROI (lesion) class (Fig. 1h). The classificationby EM/GMM using these features is unsupervised and fully automated.2.3. Lesion Detection by Hierarchical Region Splitting (HRS)HRS is an automated and recursive region segmentation method that segments MR imagesbased on both image intensities or on quantitative MR values (T2 relaxation times, ADCvalues), into uniform image regions recursively. In each recursive splitting, regions from theprevious step (iteration) are separated into smaller yet more uniform image regions (Ghoshet al., 2011). The brain exhibits different contrast levels between anatomically distinct braintissues (e.g., cortex vs. striatum) and thus, a uniform region within the brain likely representsa single brain tissue type. MRI contrast levels within the brain can be further altered bydisease, such as HII, where increased T2 relaxation values (or increased image intensities)reflect increased water content indicative of edema. Similar increases/decreases in ADCoccur in HII. The HRS method exploits these differences to segment uniform regions inMed Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 6which brighter signal on T2 maps is expected to indicate the location of the brain lesion.Similarly, ADC maps reflect water mobility and as many lesions have restricted watermobility compared to normal brain tissues at the early stage of the injury (Ghosh et al.,2012a), the HII lesions are hypo-intense (darker) in ADC maps so that HRS can separatethese regions during recursive splitting (Fig. 2).The HRS sequence is comprised of: Rescaling: To reduce computational complexity andincrease robustness to MRI signal variation, we rescaled the T2WI or ADC values to a range[0, 255] and the scaling factors were saved to map the automatically derived results in imageintensity values back to the original MR (T2 or ADC) values. As T2 values >255ms are nottypical, rescaled data are very similar to the actual T2 values. For ADC maps (or other MRImodalities), this rescaling step makes HRS generic and compatible to any range of MRvalues. Deriving the HRS histogram: The signal spectrum histogram H(i) of the rescaledMRI was computed, where i = [1,2,… N =255]. Computing adaptive segmentationthreshold: Similar to Otsu’s method (Otsu, 1979), we modeled the MRI histogram at everyregion splitting level (i.e., level 0-2 in Fig. 2B) as a bimodal distribution with two distinctand distant peaks (see Fig. 2A). Histogram H is normalized to estimate the probabilisticdistribution function, , and the cumulative distribution function. The cumulative weighted means at every intensity valuesequence of Otsu’s measure, and the final cumulative mean μt = μ (N) are used to compute theEq. 2where its mode(s) define the valley of the original distribution p(i). For more than one as the valley andclosely-spaced modes, we use the mean compute the threshold (valley of p(i)) by Th=(idx-1). The above threshold Th defines thevalley between these peaks as an adaptive threshold to split the image into two sub-regionimages (Fig. 2A), in which one region has values greater and the other region has values lessthan the threshold Th. Each peak is a region with a minimum intra-regional and maximuminter-regional MR variance. Recursive bimodal segmentation: A unique aspect of the HRSmethod is its recursive application of the above bi-partite segmentation. The sub-imageswere then recursively further split to generate a tree-like hierarchical data structure (Fig. 2B)which we describe as the HRS tree. Criteria for stopping segmentation: Recursive splittingis continued until individual segments or sub-regions have near-uniform MRI intensities.Uniformity was measured based on three factors, whether: (a) the individual connectedregions were small (area < 50 pixels = 2ml in neonatal rat brain) and unlikely to be fromdifferent tissue-types; (b) the MR signal value for the region had a low standard deviation(STD < 10 rescaled MR values), that is, the regional MRI intensities were relativelyuniform; and (c) the MR histogram for the segmented region had a low kurtosis value(kurtosis < 1.5) where the peak is too distinct to be modeled as a bimodal distribution. Thebrain regions obtained from HRS (e.g., HRS trees in Fig. 2B) were not always uniform inMed Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 7MR (or rescaled MR) values, but as we descend down the HRS tree, we achieve greateruniformity within individual regions. The threshold values or split-stopping criteria (area <50; STD < 10; kurtosis < 1.5) were selected based on published results (Ghosh et al., 2011).These thresholds do not affect ROI detection but minimize unnecessary over-segmentationof small or very uniform regions and thus, reduces HRS tree size and computational (spaceand time) complexity. Scale-back to actual MR values: The statistics (e.g., mean, standarddeviation) of each HRS sub-regions are rescaled back to actual MR values using the savedscaling-factors (see above). Detection of Lesion: Based on previously published studies andestablished T2 and ADC ranges of normal brain tissues (Ghosh et al., 2011; Ghosh et al.,2012a), we used a T2 relaxation time of 75ms (in animal data) and ADC value of 100 × 10−5mm2/sec (for clinical data) that can efficiently delineate the HII lesion from normal tissues.The method uses these values as a soft threshold for the lesion mean, called meanTh. Itaccomplished this by systematically checking the (mean ± standard deviation) value of thesub-regions in the HRS tree one by one, starting from the top (level 0) and graduallydescending down branches of the HRS tree until reaching a sub-region with: (a) either(mean – standard deviation) is greater than the meanTh (=75) for T2-based HRS trees, (b) or(mean + standard deviation) is less than the meanTh (=100) for ADC-based HRS trees. HRSthen categorizes this sub-region as an ischemic lesion (Fig. 2B). The threshold – meanThwas the cutoff for the MR mean of HII lesion. Use of regional standard deviations (unlikethose reported (Ghosh et al., 2011)) improves outlier rejection. Key HRS parameters aresummarized in Table 4. Finally, regional properties (area, mean, and standard deviation),and 3D volumes of the injury were then computed.2.4. Lesion Detection by Modified Watershed Segmentation (MWS)The watershed algorithm has been used for brain tumor segmentation and has been validatedfor segmentation and lesion detection from MRI datasets (Ratan et al., 2009). This methodcan segment ROIs provided that the desired parameters for segmentation and ROI propertiesare properly set. A conceptually simple supervised image-based (shape, texture, and content)technique has been used here to analyze MRI brain images with relatively lowcomputational requirements. The parameter’ features of the brain images are extracted: theimage contrast edges (E), gray values (G), and local contrast (H). Then, the watershedsegmentation method separates the brain into different compartments. Finally, injury regionswere detected from the segmented regions by a supervised classifier. Key MWS parametersare summarized in Table 4.Multi-parameter Calculation—The image contrast edge (E) parameter is often used todetermine the boundaries of an object, based on the assumption that semantically similarobjects have closer edges. Given this understanding, we used the Sobel edge detectionmethod to detect image edges (IE), obtained by filtering an input image with twoconvolution kernels (Sobel Kernels) concomitantly, to detect changes in vertical andhorizontal contrasts, as Ix and Iy respectively. Image output IE is obtained by calculating thegradient magnitude of each pixel (xp,yp) of the filtered images Ix and Iy, as shown inEquation (3). Subsequently, the edge parameter (E) of a pixel (xp,yp) is calculated, wherebyE is increased by one each time when IE(xp_n,yp_n) = ‘1’ (indicating as an edge pixel), asMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 8shown in Equation (4), where (xp_n,yp_n) is any neighboring pixel in an m by m block Bcentered at the pixel (xp,yp)Eq. 3Eq. 4I-NHPAAuthorManuscriptThe gray values (G) parameter is the gray scale (or T2/ADC) value of the pixel of the brainimage. The local contrast (H) parameter is often used to characterize the extent of variationin pixel intensity. We adopted the stretch algorithm to compute the contrast parameter of apixel (xp,yp), based on the m by m neighborhood connectivity (block B) centered at (xp,yp),as shown in Equation (5), where min(B) and max(B) represent the minimum and maximumintensity values of the neighborhood pixels inside block B. The contrast parameter H isobtained by totaling the contrast of a block B, as shown in equation (6).I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptEq. 5Eq. 6The above three features (E, G, H) are used to compute the pixel-based similarity for thewatershed segmentation.Watershed Segmentation—Watershed segmentation is realized by considering the grayscale value of each brain pixel as the altitude of the water basin. Drops of water reach themaxima of values, and then flow along certain paths to finally reach the local minima. Inthis respect, the watershed corresponds to the limits of the adjacent catchment basins of thedrops of water, and it also is equal to the boundary of the segmented regions. The watershedsegmentation approach, a classic in image segmentation, is one of the most automaticmethods. The watershed segmentation technique segregates images as different intensitysegments with ROIs having a high radiation density leading to high pixel intensities. Thus,the watershed segmentation is an efficient tool to classify tumors and other high intensitytissues within the brain. Watershed segmentation, as a region-based segmentation method,can also classify intensities that exhibit very small differences. Further, MWS is useful fordetecting multiple regions, which cannot be reached by counter-based segmentation methodssuch as level-set or snakes. In MWS, multiple parameters (E, G, H in Equations (3)-(6)) areused as different cues for watershed segmentation and lead to segmented regions.Lesion Detection—The final lesion detection was performed using ‘prior knowledge’from ground-truth (manually derived) ROI properties, gray-scale and texture to separatelesions from other normal tissues.Med Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 92.5. Statistical ComparisonsFrom 2D slice-based injury and brain areas (Areainjury, Areabrain), percentage lesionvolumes (V%) over the entire brain was determined by the equation,Eq. 8I-NHPAAuthorManuscriptwhere Ns equals the number of MR slices in the sequence, anterior to posterior. We furthercompared the performance of these computational methods, in terms of volumetric andlocation-overlap indices (sensitivity, specificity, and similarity) using the followingequations:I-NHPAAuthorEq. 9Eq. 11Eq. 10ManuscriptWhere LG and BRG represent the number of pixels in the ischemic injury and the entirebrain, respectively, in the manually segmented data; and LD and BRD represent thecorresponding counterparts from the detected results from each computational method.Methods and experimental details for those reported are available upon request to thecorresponding author.3. RESULTSI-NHPAAuthorManuscriptWe quantitatively and qualitatively evaluated and compared all three proposedcomputational methods, SIRG, HRS and MWS, in their ability to identify neonatal HIIlesions which were then compared to expert manual lesion extraction in clinical and rodentMRI data sets. Firstly, we compared all three methods at a single time point when the lesionvolume is relatively static. Secondly, we then expanded our computational assessment to testtheir efficacy in a temporal dataset where the lesion volume is dynamically evolving. Thisstep is critical for clinical translation when it is often difficult to assess the time of injury,particularly in neonates. Thirdly, our final assessment, used human neonatal data to validatethat our computational methods can be readily applied in a clinically relevant mannerdemonstrating proof of concept.Med Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 103.1. Comparisons in an Animal HII Model: Single time pointWe compared the three methods (SIRG, HRS, MWS) using T2WI images obtained from acohort of animals 10 days post HII induction (Fig. 4A). All three computational approachesidentified virtually the same regions, with overlap to manual segmented results. However,the automated results were almost always smaller, which was confirmed in the quantitativevolumetric data (Fig. 5A). SIRG performed slightly better than HRS or MWS compared tothe manual segmentation (ground-truth). All three methods had close performance based onlesion volumes (Fig. 5A) and regional sensitivity/specificity/similarity indices (Fig. 5B) bothfor entire 3D volume and individual 2D MR slices from anterior to posterior of the brain.3.2. Comparisons in an Animal HII Model: Temporal lesion evolutionWe further extended our computational analysis of the three methods (SIRG, HRS, MWS)to determine their ability to identify HII lesions as they evolve dynamically over time. Weutilized T2WI data that spanned between 1-31d post HII and performed volumetric (Fig. 5C)and performance comparisons (Table 5) for both the entire 3D volumes and the individual2D slices. The ischemic injury initially decreased with time and then increased towards itsfinal volume (Fig. 5C). Volumetrically, SIRG and HRS performed the best at 3 time-pointseach (SIRG: 4d, 17d, 31d; HRS: 1d, 7d, 24d post HII), while MWS results varied mostwidely and performed best only at 1 time-point (10d post HII). Performance comparisons forthe entire 3D volume (Table 5) indicated SIRG performed the best (13/21 cases) comparedto HRS (6/21 cases) and MWS (2/21 cases). When evaluated for performance of individual2D MR slices, anterior to posterior of the brain, HRS had the lowest standard deviations (in62% cases) and hence was the most robust compared to SIRG (29% cases) and MWS (9%cases) (Table 5).3.3. Comparisons in an Animal HII Model: Discrimination of Injury SeverityTo compare the performance of SIRG, HRS and MWS in injury severity discrimination, wefurther classified injury based on manually detected lesion volumes as mild (<10%),moderate (10-25%) or severe (>25%) injury (Fig. 4B). Volumetrically, SIRG performed thebest for mild and moderate injury, while HRS for severe injury (Fig. 4B). Similarperformance trends were also observed for sensitivity, specificity and similarity (Table 6).MWS had lower performance than SIRG and HRS in both these respects.3.4. Neonatal AIS: Single Time PointFinally, we evaluated SIRG, HRS, and MWS methods in neonatal AIS patients with a rangeof injury severities, specifically using ADC maps computed from DWI data. All threemethods successfully extracted the AIS lesion (Fig. 3B) that was found in two regionallydistinct brain areas. Scalar volumetric comparison (Fig. 5D) and performance indices (Fig.5E) revealed that HRS and SIRG had comparable performance, while MWS lagged behindin both respects, suffering from over-estimation (false positives), particularly when theinjury was more severe.A close inspection of regional overlap indices (Fig. 5E) revealed that for a larger AIS lesion(17.7% of total brain volume, Fig. 3B, Fig. 5D) HRS outperformed SIRG (Fig. 5E, AIS#1),Med Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 11while for a smaller AIS lesion (4.5% of total brain volume, Fig. 5D) while SIRGoutperformed HRS (Fig. 5E, AIS#2).4. DISCUSSIONIn experimental and clinical ischemic injury, the location of the lesions are often abnormalfoci within normal brain tissues that vary in location, size and shape, and are likelycomprised of different MR characteristics (i.e., T2 relaxation times, ADC values or theirassociated image intensities). Automated detection of HII lesions from MRI couldpotentially help in candidate selection, treatment and monitoring (Ghosh et al., 2012a;Wechsler, 2011), specifically for neonatal HII where current prior-model based alignmenttechniques (Table 2) fail due to developmental changes within maturing brains.We compared three state-of-the-art region-based injury detection methods – symmetryintegrated region growing (SIRG) (Yu et al., 2009), hierarchical region splitting (HRS)(Ghosh et al., 2011), and modified watershed segmentation (MWS) (Ratan et al., 2009) –none of which require model-subject alignment or co-registration. All three methodsautomatically detected lesion volume from either T2- relaxation or ADC maps of clinicalAIS neonates and experimental animals with HII. Their volumetric and location-overlapperformance were computed with respect to the manually detected ground-truth data andcompared for accuracy and robustness. With respect to different MR acquisitions, in theclinic, diffusion weighted imaging is used predominately to monitor early ischemic injury,so we undertook assessment of our algorithms using clinically relevant imaging sequences/data. SIRG and HRS performed equally well on T2- or diffusion weighted imaging. Thus,one could suggest that either SIRG/HRS can be used on a variety of clinically relevantimaging sequences. The key results were: 1) SIRG performed best for lesion volumes andlocation for entire 3D MRI; 2) HRS was most robust (with lowest standard deviation) overindividual 2D MR slices; 3) MWS was out-performed by SIRG and HRS in all respects.Current MRI based lesion extraction techniques (Table 1) mostly adopt one of the twofollowing approaches. (A) Healthy tissue segmentation followed by abnormality (lesion)extraction. Here prior models are used to classify healthy tissues into different anatomicalregions (Birgani et al., 2008; Kabir et al., 2007) or a single normal tissue class (Cuadra et al.,2004; Van Leemput et al., 2001) and then the outlier regions that do not satisfy any normaltissue class are designated as lesion. A significant weakness of this approach is therequirement for a large volume of training data (to fit all normal tissue or complex priormodels for anatomy) which is often not readily available, particularly for neonates. (B)Digital subtraction to detect changes in longitudinal (serial) MR data (Manana et al., 2006;Sadasivan et al., 2009). However, accurate subtraction relies firstly on temporal datasets,and secondly, heavily on 2D or 3D registration among serial MRI data which often sufferswhen neuroimaging time-points are too far apart for rapidly maturing neonatal brains (Kleinet al., 2010; Zhiguo et al., 2005; ZitovÃ¡ and Flusser, 2003).Curve fitting of tissue-boundaries based on partial differential equations, includingparametric methods like active contour snakes (Kazerooni et al., 2011; Liang et al., 2006;Zhou and Xie, 2013), non-parametric methods like level-set propagation (Droske et al.,Med Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 122001), and their several modified versions (Bai et al., 2013; Kazemifar et al., 2014; LeGuyader and Vese, 2008; Liang et al., 2006; Mesejo et al., 2014; Somkantha et al., 2011;Wang et al., 2013) have been adopted in different medical image analysis applications.Success of these methods heavily depends on MRI intensity contrast edge detection(Kazerooni et al., 2011; Liang et al., 2006; Somkantha et al., 2011), seed-initialization(which is often manual) (Zhou and Xie, 2013) and choice of energy function (Kazerooni etal., 2011; Liang et al., 2006) that is to be minimized by heuristic gradient descent algorithms(Wang et al., 2013). These methods are often computationally expensive due to the need foran initial training module (Kazemifar et al., 2014; Mesejo et al., 2014), need for manualinterventions (Liang et al., 2006; Zhou and Xie, 2013), need for obtaining local-minimaduring energy minimization instead of global minima (inherent problem of greedy search ingradient descent algorithms) (Mesejo et al., 2014; Wang et al., 2013) and sometime requiresprior models (Bai et al., 2013; Le Guyader and Vese, 2008; Wang et al., 2013) or atlas-registration (Kazemifar et al., 2014) with their associated limitations as mentioned earlier.These pitfalls often restrict use of level-set and active contour snake methods in real-timeclinical applications. SIRG, HRS and MWS methods compared in this paper do not utilizeatlas or prior models, reduce computational complexity to a large extent, and performsegmentation without manual intervention.Further, MR data issues are aggravated by ROI fuzziness (Table 2). Motion artifacts andnoise levels (Table 2, problem ID 3) might be partially reduced with conventional imagefiltering in some cases (Klein et al., 2010; Zhiguo et al., 2005; ZitovÃ¡ and Flusser, 2003).ROI contrast and sharpness enhancement (Table 2, problem ID 1,2) based on low-levelimage features fail unless complex prior models are used (Birgani et al., 2008; Cuadra et al.,2004; Kabir et al., 2007; Manana et al., 2006; Van Leemput et al., 2001; Zhiguo et al.,2005). Model-subject registration (Cuadra et al., 2004; Schmidt et al., 2005) also sufferswhen injury crosses anatomical boundaries (Ghosh et al., 2012a) and/or when noisy low-level features, including image intensity (Kabir et al., 2007), texture (Kruggel et al., 2008),shape, 3D volume (Liu et al., 2005), etc. are used to align multiple data and time points.In summary, the majority of current ROI extraction methods depend heavily on largeamounts of training data (often not available), significant preprocessing (time-consuming),complex prior models (often not reliable, specifically for neonates), model-subjectregistration (labor-intensive) and significant user intervention (human bias) that reduce theirpractical applicability in real-time medical image analysis (Neumann-Haefelin andSteinmetz, 2007). The three methods compared in this paper – SIRG, HRS and MWS – donot require model-subject registration/alignment nor any training data, and very little priorknowledge for injury classification in HRS and MWS (Tables 1, 2). They effectively handleROI detection problems using only high-level features like symmetry and mean MR orgrayscale values representative of the injury (Table 2). This also significantly reducedcomputational complexity, required for practical real-time clinical applications.When compared between themselves, all three performed quite satisfactorily correlatingwith the manual ground-truth for clinical AIS (Fig. 3B) and in an animal model of HII, fortemporal evolution (Fig. 4A) and for different injury severities (Fig. 4B). SIRG performedthe best for scalar percent-volumes (Fig. 5A) and regional overlaps (Fig. 5B). Interestingly,Med Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 13substantial performance variations (mean ± standard deviation) were observed over differentMR slices anterior to the posterior portion of the brain when SIRG was used (Fig. 5B).Lower variations indicate more robustness and stability of the methods, and this is where weobserved that HRS performed the best. In our manual “ground truth” data, there were somecases where an experienced researcher manually included regions (e.g., lateral portions ofthe ventral cortex in Fig. 4A, 10d) that were not identified by any of the computationalapproaches. This was reflected in volumetric comparisons (Fig. 5A) and in larger variationsin similarity (Fig. 5B), which effectively measures regional precision for detection (ratio oftrue positive over false negative).HII lesions are very dynamic as the brain responds to the injury (Ashwal et al., 2007;Obenaus et al., 2011a). Volumetric temporal evolution of HII matched well with previouslypublished results (Obenaus et al., 2011b). Again SIRG and HRS had close 3D volumetricperformance (Fig. 5C) while HRS was the most robust (Table 5) with serial MRIassessments. Similarly, variation in injury severity in clinical and animal HII and could becorrectly distinguished by all three methods (Fig. 4B, Fig. 5D) (Ghosh et al., 2012b).Interestingly, SIRG performance was best in mild and moderate HII while HRS was betterfor severe HII (Table 5). Previous studies have noted that a limitation of HRS is that it doesnot perform well in mild injuries (Ghosh et al., 2011), which we confirmed. Similar trendswere also observed in clinical AIS where HRS results overlapped best for larger injurieswhereas SIRG had better results for small injuries (Fig. 5E).SIRG approach (Yu et al., 2009) utilized symmetry as a high level feature and 3Dconnectivity based outlier rejection that significantly improved its power for injurydiscrimination, despite noisy, blurred or motion-affected boundaries seen in MRI. Thelimitations of SIRG lies in extensive tuning of many parameters (compared to HRS andMWS; Table 2) which even may be injury-specific. SIRG would also fail in challengingcases where brain structure lacks defined symmetry or the injury itself is symmetric(bilateral) with regard to the axis of the brain (Ghosh et al., 2011). Fusion of SIRG withHRS and using prior MR knowledge, particularly using quantitative T2/ADC values couldpotentially solve this weakness. The strength of HRS (Ghosh et al., 2011) lies in the use of asmall set of parameters (Table 2), stable bipartite segmentation leading to robustness (lowestvariations; Table 5) as well as using quantitative MR values (T2 relaxation times, ADC) thatassist in improved HII lesion detection from healthy tissue. Limitations of HRS were that,(a) it did not consider 3D connectivity of injury for inclusion and exclusion of sub-regions,and (b) it underperformed for mild injury because of small ROIs. Fusing symmetry featuresand 3D asymmetric volume models (Fig. 1) from SIRG may mitigate these HRSweaknesses. MWS approach (Ratan et al., 2009) was always the least effective among themethods evaluated in this paper (Fig. 5, Tables 5, 6). MWS suffered from over-segmentationinherent in watershed methods (Ratan et al., 2009), insufficient cues to reject outliers, andused additional noisy non-injury regions as prior information (Fig. 5A). This resulted inmany false positives in MWS detected injury (Fig. 4B) that significantly reduced itsperformance (Fig. 5, Table 6). Symmetry cues and use of quantitative MR values mightimprove MWS results (Fig. 4B).Med Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 14A short note on how much time is required to run these algorithms. We have used the term“real-time” to further demonstrate that both SIRG and HRS could be used clinically in thecontext of rapid stroke or ischemic patient treatment. Though SIRG and MWS take coupleof hours for training the respective parameters, once trained they can identify lesion orinjuried tissues from MRI data in less than 5 minutes. Further, HRS does not require anytraining and once the data are skull- stripped it can produce lesion results within 15 seconds.Hence, these algorithms could be used by clinial neurologists in treatment paradigms whereearly intervention is often desirable.5. ConclusionsIn conclusion, unlike most of the current methods, the three region-based injury detectionmethods assessed– SIRG, HRS and MWS – are objective and robust for real-time clinicalapplications. They do not require labor-intensive preprocessing, complex prior-models andmodel-subject alignment. Specifically for neonatal ischemic injury, SIRG performed bestoverall but HRS was the most robust, and fusion of these two techniques in future studieshas a greater potential for automated injury detection from brain MRI data, particularly inneonates.AcknowledgmentsThis study was supported by funding in part by National Science Foundation Integrative Graduate Education andResearch Traineeship (IGERT) in Video Bioinformatics (DGE 0903667 to BB). The authors wish to acknowledgethe Department of Radiology at LLU Medical Center for assistance with the clinical data. This research was furthersupported by funds from the Department of Pediatrics, Loma Linda University; and NIH NINDS (1RO1NS059770to SA).REFERENCESAnbeek P, Vincken KL, Groenendaal F, Koeman A, van Osch MJ, van der Grond J. Probabilistic braintissue segmentation in neonatal magnetic resonance imaging. Pediatr Res. 2008; 63:158–163.[PubMed: 18091357]Ashwal S, Tone B, Tian HR, Chong S, Obenaus A. Comparison of two neonatal ischemic injurymodels using magnetic resonance imaging. Pediatr Res. 2007; 61:9–14. [PubMed: 17211133]Bai PR, Liu QY, Li L, Teng SH, Li J, Cao MY. A novel region-based level set method initialized withmean shift clustering for automated medical image segmentation. Computers in biology andmedicine. 2013; 43:1827–1832. [PubMed: 24209928]Bergo FPG, Falcao AX, Yasuda CL, Cendes F. FCD segmentation using texture asymmetry of MR-T1images of the brain. Proc. IEEE Intl. Symp Biomedical Imaging (ISBI). 2008:424–427.Bhanu B, Parvin BA. Segmentation of natural scenes. Pattern Recognition. 1987; 20:487–496.Bilmes JA. A Gentle Tutorial of the EM Algorithm and its Application to Parameter Estimation forGaussian Mixed and Hidden Markov Models. U.C. Berkeley. 1998 April TR-97-02.Birgani, PM.; Ashtiyani, M.; Asadi, S. MRI Segmentation Using Fuzzy C-means Clustering AlgorithmBasis Neural Network; Proc. IEEE Intl. Conf. on Information & Communication Tech.; 2008. p.1-5.Corso JJ, Sharon E, Dube S, El-Saden S, Sinha U, Yuille A. Efficient multilevel brain tumorsegmentation with integrated bayesian model classification. IEEE Trans Med Imaging. 2008;27:629–640. [PubMed: 18450536]Cuadra MB, Pollo C, Bardera A, Cuisenaire O, Villemure JG, Thiran JP. Atlas-based segmentation ofpathological MR brain images using a model of lesion growth. IEEE Trans Med Imaging. 2004;23:1301–1314. [PubMed: 15493697]Med Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 15Droske, M.; Meyer, B.; Rumpf, M.; Schaller, C. An adaptive level set method for medical imagesegmentation; Proceedings of the 17th Int. Conf. of Information Processing in Medical Imaging(IPMI) Springer-Verlag Davis; CA, USA. 2001. p. 416-422.Du Q, Kopriva I. Automated Target Detection and Discrimination Using Constrained KurtosisMaximization. IEEE Geoscience and Remote Sensing Letters. 2008; 5:38–42.Ghosh N, Recker R, Shah A, Bhanu B, Ashwal S, Obenaus A. Automated ischemic lesion detection ina neonatal model of hypoxic ischemic injury. J Magn Reson Imaging. 2011; 33:772–781.[PubMed: 21448940]Ghosh, N.; Sun, Y.; Turenius, C.; Bhanu, B.; Obenaus, A.; Ashwal, S. Computational Analysis: ABridge to Translational Stroke Treatment, Translational Stroke Research. Springer New York;New York, NY: 2012a. p. 881-909.Ghosh N, Yuan X, Turenius CI, Tone B, Ambadipudi K, Snyder EY, Obenaus A, Ashwal S.Automated core-penumbra quantification in neonatal ischemic brain injury. J Cereb Blood FlowMetab. 2012b; 32:2161–2170. [PubMed: 22929436]Gupta, A.; Prasad, VSN.; Davis, LS. Extracting regions of symmetry; Proc. IEEE Intl. Conf. ImageProcessing (ICIP); 2005. p. 133-136.Hojjatoleslami SA, Kruggel F. Segmentation of large brain lesions. IEEE Trans Med Imaging. 2001;20:666–669. [PubMed: 11465472]Kabir, Y.; Dojat, M.; Scherrer, B.; Forbes, F.; Garbay, C. Multimodal MRI segmentation of ischemicstroke lesions. Conference proceedings : … Annual International Conference of the IEEEEngineering in Medicine and Biology Society; IEEE Engineering in Medicine and BiologySociety; 2007. p. 1595-1598.Conference 2007Kazemifar S, Drozd JJ, Rajakumar N, Borrie MJ, Bartha R, Alzheimer's Disease Neuroimaging I.Automated algorithm to measure changes in medial temporal lobe volume in Alzheimer disease.Journal of neuroscience methods. 2014Kazerooni, AF.; Ahmadian, A.; Serej, ND.; Rad, HS.; Saberi, H.; Yousefi, H.; Farnia, P. Segmentationof brain tumors in MRI images using multi-scale gradient vector flow. Conference proceedings :… Annual International Conference of the IEEE Engineering in Medicine and Biology Society;IEEE Engineering in Medicine and Biology Society; 2011. p. 7973-7976.Conference 2011Kharrat, A.; Benamrane, N.; Messaoud, MB.; Abid, M. Detection of brain tumor in medical images;Proc. IEEE Intl. Conf. Signals, Circuits and Systems (ICSCS); 2009. p. 1-6.Khotanlou H, Colliot O, Atif J, Bloch I. 3D brain tumor segmentation in MRI using fuzzyclassification, symmetry analysis and spatially constrained deformable models. Fuzzy Sets andSystems. 2009; 160:1457–1473.Klein S, Staring M, Murphy K, Viergever MA, Pluim JP. Elastix: A toolbox for intensity-basedmedical image registration. IEEE Trans Med Imaging. 2010; 29:196–205. [PubMed: 19923044]Kruggel F, Paul JS, Gertz HJ. Texture-based segmentation of diffuse lesions of the brain's whitematter. Neuroimage. 2008; 39:987–996. [PubMed: 18006334]Le Guyader C, Vese LA. Self-repelling snakes for topology-preserving segmentation models. IEEEtransactions on image processing : a publication of the IEEE Signal Processing Society. 2008;17:767–779. [PubMed: 18390381]Liang J, McInerney T, Terzopoulos D. United snakes. Medical image analysis. 2006; 10:215–233.[PubMed: 16311065]Liu J, Udupa JK, Odhner D, Hackney D, Moonis G. A system for brain tumor volume estimation viaMR imaging and fuzzy connectedness. Computerized medical imaging and graphics : the officialjournal of the Computerized Medical Imaging Society. 2005; 29:21–34. [PubMed: 15710538]Lowe DG. Distinctive Image Features from Scale-Invariant Keypoints. International Journal ofComputer Vision. 2004; 60:91–110.Manana, G.; Romero, E.; Gonzalez, F. A Grid Computing Approach to Subtraction Radiography; Proc.IEEE Intl. Conf. Image Processing (ICIP); 2006. p. 3325-3328.Mesejo P, Valsecchi A, Marrakchi-Kacem L, Cagnoni S, Damas S. Biomedical image segmentationusing geometric deformable models and metaheuristics. Computerized medical imaging andgraphics : the official journal of the Computerized Medical Imaging Society. 2014Med Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptGhosh et al.Page 16Nan, Z.; Ruan, S.; Lebonvallet, S.; Qingmin, L.; Yuemin, Z. Multi-kernel SVM based classification forbrain tumor segmentation of MRI multi-sequence; Proc. IEEE Intl. Conf. Image Processing(ICIP); 2009. p. 3373-3376.Neumann-Haefelin T, Steinmetz H. Time is brain: is MRI the clock? Curr.Opin.Neurol. 2007; 20:410–416. [PubMed: 17620875]Niimi T, Imai K, Maeda H, Ikeda M. Information loss in visual assessments of medical images. Eur JRadiol. 2007; 61:362–366. [PubMed: 17067772]Obenaus A, Dilmac N, Tone B, Tian HR, Hartman R, Digicaylioglu M, Snyder EY, Ashwal S. Long-term magnetic resonance imaging of stem cells in neonatal ischemic injury. Annals of neurology.2011a; 69:282–291. [PubMed: 21387373]Obenaus A, Dilmac N, Tone B, Tian HR, Hartman R, Digicaylioglu M, Snyder EY, Ashwal S. Long-term magnetic resonance imaging of stem cells in neonatal ischemic injury. Annals of Neurology.2011b; 69:1531–8249.Otsu N. A Threshold Selection Method from Gray-Level Histograms. IEEE Transactions on Systems,Man, and Cybernetics. 1979; 9:62–66.Prasad VS, Yegnanarayana B. Finding axes of symmetry from potential fields. IEEE transactions onimage processing : a publication of the IEEE Signal Processing Society. 2004; 13:1559–1566.[PubMed: 15575151]Ratan R, Sharma S, Sharma SK. Brain Tumor Detection based on Multiparameter MRI ImageAnalysis. International Congress for Global Science and Technology (ICGST) Intl J Graphics,Vision and Image Processing, (GVIP). 2009; 9:9–17.Ray, N.; Saha, BN.; Brown, MRG. Locating Brain Tumors from MR Imagery Using Symmetry; Proc.IEEE Asilomar Conf. Signals, Systems, and Computers (ACSSC); 2007. p. 224-228.Sadasivan C, Cesar L, Seong J, Wakhloo AK, Lieber BB. Treatment of rabbit elastase-inducedaneurysm models by flow diverters: development of quantifiable indexes of device performanceusing digital subtraction angiography. IEEE Trans Med Imaging. 2009; 28:1117–1125. [PubMed:19164085]Saha S, Bandyopadhyay S. MRI brain image segmentation by fuzzy symmetry based geneticclustering technique. Proc. IEEE Congress on Evolutionary Computation. 2007:4417–4424.Schiemanck SK, Kwakkel G, Post MW, Prevo AJ. Predictive value of ischemic lesion volumeassessed with magnetic resonance imaging for neurological deficits and functional outcomepoststroke: A critical review of the literature. Neurorehabil Neural Repair. 2006; 20:492–502.[PubMed: 17082505]Schmidt, M.; Levner, I.; Greiner, R.; Murtha, A.; Bistritz, A. Segmenting Brain Tumors usingAlignment-Based Features; Proc. IEEE Intl. Conf. Machine Learning and Applications (ICMLA);2005. p. 215-220.Somkantha K, Theera-Umpon N, Auephanwiriyakul S. Boundary detection in medical images usingedge following algorithm based on intensity gradient and texture gradient features. IEEEtransactions on bio-medical engineering. 2011; 58:567–573. [PubMed: 21062676]Sun Y, Bhanu B. Reflection symmetry integrated image segmentation. IEEE Transactions on PatternAnalysis and Machine Intelligence. 2012; 34:1827–1841. [PubMed: 22201051]Van Leemput K, Maes F, Vandermeulen D, Colchester A, Suetens P. Automated segmentation ofmultiple sclerosis lesions by model outlier detection. IEEE Trans Med Imaging. 2001; 20:677–688. [PubMed: 11513020]Wang L, Yu Z, Pan C. A unified level set framework utilizing parameter priors for medical imagesegmentation. Science China Information Sciences. 2013; 56:1–14.Wechsler LR. Imaging evaluation of acute ischemic stroke. Stroke. 2011; 42:S12–15. [PubMed:21164129]Yu, S.; Bhanu, B. Symmetry integrated region-based image segmentation; Proc. IEEE Intl. Conf.Computer Vision and Pattern Recognition (CVPR); 2009. p. 826-831.Yu, S.; Bhanu, B.; Bhanu, S. Automatic symmetry-integrated brain injury detection in MRI sequences,IEEE Computer Society Workshop on Mathematical Methods in Biomedical Image Analysis, heldin conjunction with IEEE Computer Society Conference on Computer Vision and PatternRecognition; IEEE; Miami Beach, FL. Jun 20-25. 2009 p. 79-86.2009Med Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 17Zhiguo, C.; Xiaoxiao, L.; Bo, P.; Yiu-Sang, M. DSA image registration based on multiscale gaborfilters and mutual information; Proc. IEEE Intl. Conf. Information Acquisition; 2005. p. 105-110.Zhou W, Xie Y. Interactive medical image segmentation using snake and multiscale curve editing.Computational and mathematical methods in medicine. 20132013 325903.ZitovÃ¡ B, Flusser J. Image registration methods: a survey. Image and Vision Computing. 2003;21:977–1000.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 18HighlightsAutomated detection of brain injury in the neonate is critically needed butlackingThree approaches were tested: symmetry, watershed and hierarchical splittingSIRG performed the best for lesion volumeHRS was the most robust (smallest standard deviations)••••• MWS lagged in performance on all measuresI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 19Figure 1. Symmetry Integrated Region Growing (SIRG) based Lesion Detection (Left Panel)SIRG lesion detection in a newborn AIS data starts with the original ADC map (a) fromwhich the axis of symmetry (AoS) was detected (dotted line) (b) A symmetry affinity matrixwas computed where brighter (yellow) regions are more asymmetric across the AoS (c). TheSIRG algorithm then extracted these initial asymmetric regions (d) which were thenmodified using kurtosis-skewness measures of the regions (e). A separate algorithmidentified asymmetric clusters using a 3D gradient relaxation algorithm (f). Robustasymmetric regions from (e) and (f) were then fused (g), from which, GMM/EM thenclassified the stroke (AIS) regions (h). 3D Asymmetry Volume Computation (RightPanel). Binary masks of the ischemic lesion were detected in 2D and each slice was addedto sum the lesion from the entire brain. 3D connectivity was color coded to visualize relativereliability of 2D detections to the final 3D asymmetry ischemic injury volume.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 20Figure 2. Hierarchical Region Splitting (HRS) based Lesion Extraction(A) ADC histogram: ADC values were rescaled (v’) to an intensity range [0-255]. The HRSmethod then fitted a bimodal distribution and detected a valley (at v’ = 143 in this example)as the threshold to split the histogram. This splitting was repeated recursively (next levelthresholds were v’ = 101 and 194). (B) HRS tree: Segmenting the ADC map into regionswith v’ values derived from the histogram formed the HRS tree. HRS automatically detectedthe left image in Level 2 as the ischemic lesion (arrow – injury). Only part of the completeHRS tree is shown.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 21Figure 3.(A) Modified Watershed Segmentation (MWS) based Lesion Detection. Multi-parameterimage feature – grayscale intensities, Sobel contrast edges, and local contrast indices wereevaluated. These features form a topological map where MWS starts from regional peaks,followed droplet paths defined by a Genetic Algorithm, and reached the catchment basinsthat marked segmentation boundaries. To counter over-segmentation that is oftenencountered in watershed segmentation, similarity based region merging was performed.Finally, prior knowledge from testing data and ground-truth results were utilized to classifythe segmented regions into either lesion, normal brain or outlier regions. (B) Comparativeresults for human ADC data. Representative results for a single ADC map image from anAIS patient illustrates that SIRG, HRS and MWS methods extract comparable lesionregions.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 22Figure 4. Comparative results for (A) temporal MRI and for (B) graded injury severities in arat-pup model of ischemia(A) Detection by all three methods largely overlapped with the manual detection over thetemporal data and were often better at later time points (17-31 d). For the earlier time-points(1-10 days), MWS method resulted in some misclassifications, while SIRG and HRSproduced more accurate and similar results (Table 5 summarizes the performance ofdifferent methods in terms of overlap in injury locations for entire 3D volumes, as well asfor individual 2D slices). (B) For different injury severities all three methods resulted incomparable results. SIRG performed well for all severity types, with few false positive(mild) or false negative (moderate) detections. HRS under-estimated mild and moderateinjuries but performed the best (among the three methods compared) for severe injury.MWS method was more prone to detect outliers at all injury severities compared to othertwo methods. (Respective overlap measures are summarized in Table 6).I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 23Figure 5. Summary of performance indicesFor neonatal rats, lesion volumes between the three methods (SIRG, HRS, MWS) comparedfavorably for 3D volumes (A) and in performance over 2D MRI slices (B). Volumetriccomparisons for temporal data (1-31 days post ischemia) in HII rat pups (C) illustrates thatall three methods followed manual detections at most of the imaging time-points. At 4dSIRG and HRS underestimated and MWS overestimated with respect to manual detection.Regional overlap comparisons are also summarized in Table 5 for the entire 3D volumes aswell as for variations across different MRI sections. The temporal variation of HII severity isshown in C. Volumetric comparisons (D) and 3D regional overlaps (E) are summarized fortwo AIS patients (severe, mild) with respect to respective manual detections.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 24Overview of state-of-the-art MRI based injury detection methods. Last three rows (in gray) summarize themethods we used in our comparisons.Table 1AuthorMethodsAutomationSegmentationInjuryDetectionAlignmentPriorModelTrainingBirgani et al 2008Fuzzy Cluster NeuralNetworkModel-baseddetectionNOYESNOKabir et al 2007Maximum a posteriori(MAP)MultimodalMarkov randomfield (MRF)YESYESYESKhotanlou et al 2008Expectation Maximization(EM) with MRFEMNOYESNOCuadra et al 2004Adaptive statisticalalgorithmModel of lesiongrowthYESYESNOAnbeek et al 2008Manually by expertsHojjatoleslam and Kruggel2001Region growingCorso et al 2008Weighted aggregationKruggel et al 2008Texture-basedsegmentationNan et al 2009Region growingK-nearestneighborsManual LesionlocationGaussianmixtureModel (GMM)Gaussian –based clusteringMulti-kernelbased SVMNOYESYESNONONONOYESYESYESYESNONOYESNOLiu et al 2005Fuzzy connectednesssegmentationFuzzy volumerenderingYESYESNOSchmidt et al 2005Soft-margin SVMKharrat et al 2009Wavelet-basedsegmentationModel-baseddetectionK-meansclusteringYESYESNONOYESNOSun and Bhanu 2012Symmetry-based regiongrowingEM classifierNONONOGhosh(Ghosh et al.,2011)et al 2011Hierarchical regionsplittingArea-baseddetectionNOYESNORatan et al 2009Watershed boundariesfollowed by similaritybased mergingManualallocationNOYESNOCommentsNeed to set the numberof classes; need ROIprior model.Need to know thedistribution of lesionintensities.The prior modelcontains only limitedcategories of braintissues.Too many modeldependent steps; lessrobust.The detected lesioncontains too many noisyregions.The lesion needs to belocated manually.Lesions contain toomany noisy regions.Lesions contain toomany noisy regions.Support vector machine(SVM) is insufficient inlesion clustering.User needs to locatetumor regions manually.Performance dependson the complexalignment step.High fuzziness ondetected boundaries.MRI-specificparameters; high levelfeatures.ROIs in many sub-images; possible over-segmentation; low levelfeatures.Over-segmentationoccurs; requires manualderived priorknowledge; low levelfeatures.Med Image Anal. Author manuscript; available in PMC 2015 October 01.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscript   Ghosh et al.Page 25Challenging problems in injury detection from MRI data and how three methods overcome these challenges.Table 2ProblemsMethods which overcome these challengesIDDetailsSymmetry(Sun and Bhanu 2012)HRS(Ghosh et al 2011)Watershed(Ratan et al 2009)Uses symmetryas a new cue,which is able todiscriminatebetween ROIsand normaltissues. It isautomatic andwithout priormodels.Use priorknowledge(region’smean MRvalues) todetect ROI.The blurredboundary isoutlined properly.Segmentregions atdifferentlevels.Manualinitializationfor priorknowledge(position andROI’s meangray scale).Outlinessmall andblurredregionboundaries.No registration oralignment isneeded. It isinvariant torotation andscaling.Same asSymmetrymethod.Same asSymmetrymethod.(1)(2)(3)Insufficient cues/features todiscriminate between ROIand normal tissues. Onlylow-level cues (features),e.g., gray scale, texture orshape, are used to extractthe ROIs, leading to a lowdetection accuracy.Blurred boundaries betweentissues belonging to differenttissue structures that arepartially caused by the lossof resolution and contrast,during the collection anddigitization of a MR image,mainly due to partial volumeeffects.Movement artifacts due tothe patient’s head movementduring scanning that result inrecording errors, especiallyfor MR sequences taken atdifferent time points.Different MRI slices mighthave different motionartifacts and hence differentnoise levels that present anadditional challenge forimage pre-processing due toimage-dependent variationsin image contrast.I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   I-NHPAAuthorManuscriptGhosh et al.Page 26Neuroimaging acquisition parameters for rodent and human MRI.Table 3Parameters11.7T (rodent)T24.7T (rodent)T21.5T (human)DWIRepetition time (ms)Echo time (ms)Echoes / b-values(s/mm2)Number of averagesField of view (cm)235810.211042×2356320623×330001100, 10001220×220 –240×240Matrix128×128128×128256×256Number of slicesSlice thickness (mm)Inter-slice gap (mm)Acquisition time (min)200.5-1120251112174-51.2-1.51.5-3.8I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 27Parameter sets for injury detection utilized for our comparative three methods.Table 4AuthorsParameters (thresholds)1Region growing segmentation:a.b.pixel aggregation criterion;region merging criterion;2Asymmetric region extraction:a.b.c.d.e.region’s mean kurtosis and skewness of symmetry affinity values;region’s mean symmetry affinity value;number of iterations in 3D relaxation;percentage of overlap for final asymmetric region extraction.very small segments are filtered before ROI detection.I-NHPAAuthorSymmetry(Sun, Bhanu, 2012)ManuscriptHRS(Ghosh et al 2011)Watershed(Ratan et al 2009(Ratan et al., 2009)(Ratan et al.,2009))1Region split stopping criteria:a.b.c.area of the region;standard deviation of region’s MR values;kurtosis of region’s MR values;ROI detection:region’s approximate mean MR values.Watershed segmentation:region merging criterion;ROI detection (manually):a.b.position of ROI;region’s mean MR values.212I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 28Comparison of temporal performance measures following experimental HII. Computations were assessed overthe entire 3D MRI volume or over individual 2D MRI slice volumes. Shaded and bolded entries are optimalfor their respective comparisons.Table 5OverlapmeasuresTimepostinjury1 day4 days7 daysSensitivity10days17 days24 days31 days1 day4 days7 daysSpecificity10days17 days24 days31 days1 day4 days7 daysSimilarity10days17 days24 days31 daysBased on entire 3D MRIvolumeBased on individual 2D MRI slicesSIRGHRS MWSSIRGHRSMWS0.810.870.880.710.900.880.840.940.910.970.970.980.990.981.401.231.341.091.621.671.590.810.810.880.690.870.770.850.920.920.950.970.960.920.961.411.181.310.991.441.671.590.770.680.700.630.810.850.820.890.850.970.961.000.970.981.210.790.980.931.681.621.550.62±0.260.69±0.260.66±0.220.66±0.190.62±0.140.61 ±0.290.75±0.230.72±0.190.52±0.240.71±0.160.69±0.090.64±0.190.71±0.160.71±0.110.68±0.220.69±0.260.61±0.280.59±0.360.64±0.210.67±0.240.63±0.210.95±0.050.95±0.030.94±0.040.92±0.060.93±0.050.91±0.050.93±0.020.93±0.070.93±0.040.97±0.030.98±0.020.91±0.040.98±0.020.96±0.020.99±0.040.98±0.010.91±0.020.97±0.030.98±0.030.95±0.020.98±0. 041.08±0.401.12±0.380.97±0.430.96±0.380.94±0.390.70±0.390.98±0.350.94±0.300.64±0.380.73±0.430.71±0.410.70±0.470.92±0.430.86±0.490.89±0.500.90±0.350.91±0.320.89±0.340.88±0.390.88±0.340.86±0.34I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   Ghosh et al.Page 29Comparison of performance measures for mild, moderate and severe injury for the three methods.Computations were performed over the entire 3D MRI volumes. Shaded and bolded entries are the optimalindices for their respective comparisons.Table 6MeasuresSeveritySIRG HRS MWSMildSensitivityModerateSevereMildSpecificityModerateSevereMildSimilarityModerateSevere0.710.870.810.970.910.941.091.231.400.690.810.810.970.920.920.991.181.410.630.680.770.960.850.890.930.791.21I-NHPAAuthorManuscriptI-NHPAAuthorManuscriptI-NHPAAuthorManuscriptMed Image Anal. Author manuscript; available in PMC 2015 October 01.   