Artificial Intelligence 187–188 (2012) 133–155Contents lists available at SciVerse ScienceDirectArtificial Intelligencewww.elsevier.com/locate/artintLocal properties in modal logicHans van Ditmarsch a, Wiebe van der Hoek b,∗, Barteld Kooi ca Department of Logic, University of Seville, Spainb Department of Computer Science, University of Liverpool, UKc Faculty of Philosophy, University of Groningen, The Netherlandsa r t i c l ei n f oa b s t r a c tArticle history:Received 18 August 2011Received in revised form 1 March 2012Accepted 22 April 2012Available online 2 May 2012Keywords:Knowledge representationModal logicCorrespondenceCanonicityLocal propertiesEpistemic logicIn modal logic, when adding a syntactic property to an axiomatisation, this property willsemantically become true in all models, in all situations, under all circumstances. Forinstance, adding a property like Ka p → Kb p (agent b knows at least what agent a knows)to an axiomatisation of some epistemic logic has as an effect that such a property becomesglobally true, i.e., it will hold in all states, at all time points (in a temporal setting), afterevery action (in a dynamic setting) and after any communication (in an update setting),and every agent will know that it holds, it will even be common knowledge. We propose away to express that a property like the above only needs to hold locally: it may hold in theactual state, but not in all states, and not all agents may know that it holds. We achieve thisby adding relational atoms to the language that represent (implicitly) quantification over allformulas, as in ∀p(Ka p → Kb p). We show how this can be done for a rich class of modallogics and a variety of syntactic properties. We then study the epistemic logic enrichedwith the syntactic property ‘knowing at least as much as’ in more detail. We show that theenriched language is not preserved under bisimulations. We also demonstrate that addingpublic announcements to this enriched epistemic logic makes it more expressive, which isfor instance not true for the ‘standard’ epistemic logic S5.© 2012 Elsevier B.V. All rights reserved.1. IntroductionModal logic has become the framework for formalising areas in computer science and artificial intelligence as diverse asdistributed computing [14], reasoning about programs [15], verifying temporal properties of systems [17], game theoreticreasoning [25], and specifying and verifying multi-agent systems [31]. Regarding the latter example alone, since Moore’spioneering work [19] on knowledge and action, agent theories like intention logic [5] and BDI [20] use modal logic (wherethe modalities represent time, action, informational attitudes like knowledge or belief, or motivational attitudes like desiresor intentions) to analyse interactions between modalities, like perfect recall, no-learning, realism, or different notions of com-mitment. As for epistemic modal logic, since the seminal work of Hintikka [16], modal epistemic logic has played a keyrole in knowledge representation, witnessed by the literature on reasoning about knowledge in computer science [7], andartificial intelligence [18]. The current activities in dynamic epistemic logic [1,27] can be seen as providing a modal logicalanalysis in the area of belief revision, thereby providing it with a natural basis for multi-agent belief revision, giving anaccount of the change of higher order information, and capturing this all in one and the same object language: a modallanguage, indeed.The popularity of modal logic in those areas is partly explained by its appealing semantics: the notion of state isa very powerful one when it comes to modeling computations of a machine, or describing possibilities that an agent* Corresponding author.E-mail addresses: hvd@us.es (H. van Ditmarsch), wiebe@csc.liv.ac.uk (W. van der Hoek), B.P.Kooi@rug.nl (B. Kooi).0004-3702/$ – see front matter © 2012 Elsevier B.V. All rights reserved.http://dx.doi.org/10.1016/j.artint.2012.04.007134H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155thinks/desires/fears to be possible. Another strong feature of modal logic is its flexibility: the fact that temporal, dynamic,informational and motivational attitudes can be represented by modalities does not mean that they all satisfy the same laws.Rather, depending on the interpretation one has in mind, one can decide to either embrace or abandon certain principlesfor each of the modalities used. Syntactically, this means one assumes a number of axioms or inference rules for a modalityor for the interaction of some modalities, and more often than not, this semantically corresponds to assuming some specificproperties of the associated accessibility relations in the corresponding models.In the context of epistemic logic for instance, adding specific modal axioms allows one to specify that the knowingagent is veridical (Ka p → p): if agent a knows that p, then p must be true, or that he is positively (Ka p → Ka Ka p) ornegatively (¬Ka p → Ka¬Ka p) introspective. Those axioms happen to correspond (in a precise way: correspondence theoryfor modal logic is already some decades old, cf. [23]) to reflexivity, transitivity and Euclidicity of the associated accessibilityrelation Ra, respectively. Moreover, the axioms are canonical for it: adding the syntactic axiom to a modal logic enforces thecanonical model for the logic to have the corresponding property, which then in turn implies that completeness of the logicwith respect to the class of models satisfying that relational property is guaranteed. At this point, it is important to note thedifference between Ka p → p as a formula and that as a scheme, or axiom: as a formula, it merely expresses that regardingthe atom p, agent a does not know it without it being true. However, when we assume it as an axiom, or as a scheme, itmeans that we declare it to hold for every substitution instance of p, in other words, we assume that for all formulas ϕ,the implication Kaϕ → ϕ holds.It is often argued (indeed, already by Hintikka in [16]) that a distinguishing feature between knowledge and belief isthat whereas knowledge is veridical, belief need not be, i.e., the scheme Ba p → p should not be assumed as an axiom forbelief. This then simply entails that epistemic logics have veridicality as an axiom, and doxastic logics have not. Semanticallyspeaking: the accessibility relations denoting knowledge are reflexive, those denoting belief need not be. But how then todeal with a situation where we want to express that “currently, a’s beliefs happen to be true”? If we add Ba p → p asan axiom to our logic, the effect is that in all models (with respect to which the logic is complete), and in all states, allinstances of that axiom are true, i.e., for all models M, for all states s and for all formulas ϕ, we then have M, s |(cid:5) Baϕ → ϕ.Given a model M and a state s we can express that a’s belief that an individual proposition q holds is correct: M, s |(cid:5) Baq ∧q.And we can express that a’s belief about q is correct: M, s |(cid:5) (Baq → q) ∧ (Ba¬q → ¬q). But what we cannot express inmodal logic is that Baϕ → ϕ holds for all ϕ in one state, without claiming at the same time it should hold throughout themodel. As a consequence, we cannot express in the object language that agent b thinks that agent a’s beliefs are correct,while agent c believes that a is wrong about a proposition q. The closest one gets to expressing that would be to say thatfor all ϕ, in M, s we have M, s |(cid:5) Bb(Baϕ → ϕ) ∧ Bc((Baq ∧ ¬q) ∨ (Ba¬q ∧ q)) (but here, the quantification over ϕ is on ameta-level, and not in the scope of Bb). Neither can we say, in a temporal doxastic context, that a’s beliefs now are correct,but tomorrow they need not be.To give another example of the same phenomenon, suppose one adds the scheme Ka p → Kb p to a modal logic (b knowseverything that a knows). Semantically, this means Rb ⊆ Ra. If the logic is about a set of agents A, then it becomes commonknowledge among A that b knows at least what a knows! And if there is a notion of time, we have that it will always bethe case that b knows at least what a knows, and, when having modalities for actions, it follows that no action can makeit come about that a has a secret for b, in particular, it is impossible to inform a about something that b does not alreadyknow—this rules out dynamics which are, in contrast, very possible in dynamic epistemic logic.So, the general picture in modal logic that we take as our starting point is the following. One has a modal logic to whichone adds an axiom scheme θ (say, Ba p → p). If one is lucky, the scheme corresponds to a relational property Θ(x) (in thecase above, Rxx). However, adding θ to the logic means having Θ(x) true everywhere, implying that θ is always true. Whatwe are after is looking at ways to enforce the scheme θ locally. To do so, we will add a marker (cid:2) to the modal language,such that (cid:2) is true locally, in a state s, if and only if Θ is true, locally (i.e., Rss holds).In [28], in the context of a multi-agent logic S5, this is done for the scheme ‘knowing at least as much as’. The expressiona (cid:3) b in [28], when true at w means formally ‘a considers at least as many accessible worlds from w as b’, and informally‘a is at least as uncertain as b about the actual state of affairs at w’, is an example of such a marker (cid:2)(a, b), namedSup(a, b) here, and in this case Θ(a, b)(x) is the property ∀ y(Rbxy ⇒ Raxy). The results of [28] are generalised in [29] tomore general modal logics K(+ϕ1, . . . , +ϕn) for formulas ϕi satisfying some additional condition, and this is also the mainfocus of our current contribution.It is also possible to add several markers at the same time. This then enables that not only can we make global propertieslocally true, but it also allows for more subtle quantifications over formulas than is allowed in modal logic. This makes itpossible to express properties like “If all of John’s beliefs are correct, than so must Mary’s beliefs be”, or “If John knows noweverything that Mary knows, then that must have been true yesterday as well” or “If John’s beliefs are correct, then he mustknow that Mary’s beliefs are correct as well”. The quantification needed for the latter — ∀ϕ(B jϕ → ϕ) → K j∀ψ(Bmψ → ψ)— cannot even be achieved by adding an axiom! For more examples of such quantification, see Section 2.1.This paper is organised as follows. In Section 1.1 we outline our approach towards a modal logic with local schemes andwe explain how, for a variety of property schemes θ , one can enforce them to be locally true. To understand our approach,one needs to carefully distinguish between three formal languages, which we formally define in Section 2. Then, in Section 3,we provide a general way to enrich a modal logic with relational atoms, in such a way that the resulting logic is sound andcomplete with respect to models where those atoms define, in a local sense, to a first order property. In Section 4 we thenzoom in on the specific relational atom a (cid:3) b, which locally specifies that Ra ⊇ Rb. In particular, we give the modalities inH. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155135this section an epistemic interpretation, so that a (cid:3) b captures Ka p → Kb p as a local property, i.e., we study such a schemelocally within a modal epistemic logic. Finally, in Section 5 we summarise and conclude.1.1. Towards a modal logic with local schemesIn this paper, we describe two languages to reason about Kripke models. The place where these languages meet isimportant for our set-up. Let us outline the overall approach with the aim of an example: formal definitions follow inSection 2. First of all, we are interested in a modal scheme θ(a, b, p), which in our example reads [a]p → [b]p in a modallanguage L (generally, we write [a]ϕ for modal formulas, but for epistemic interpretations we may write Kaϕ, and fordoxastic ones Baϕ). To the modal language we add a relational atom (cid:2)(a, b), or, in this specific case Sup(a, b), which willbe true in a state s iff ∀ y(Rb sy ⇒ Rasy) holds. The latter property is a formula Θ(a, b)(s) in a first-order language L1.Our modal logic should now formalise the idea that θ(a, b, p) and (cid:2)(a, b) ‘capture the same’. Indeed, we will add(cid:2)(a, b) → θ(a, b, p) (in our example: Sup(a, b) → ([a]p → [b]p)) as an axiom to the logic. However, we will argue thatone cannot just add the opposite direction as an axiom. Instead, the logic will take on an inference rule that ensures thatsomething along the following lines holds: consistency of a formula ϕ with an occurrence of ¬ (cid:2) (a, b) is the same asconsistency of ϕ with the occurrence of ¬ (cid:2) (a, b) replaced by ¬θ(a, b, p) (where p is a fresh atom). For completeness ofthe logic, we then take care that in its canonical model, the truth of θ(a, b, p) in a specific world (i.e., maximal consistentset (cid:6)) coincides with property Θ((cid:6)).The languages that we define are simple extensions of languages usually studied in standard modal logic [3,4]. Morespecifically, our modal logic extends that of modal logic with some relational atoms (cid:2), and the first order language is thestandard language to reason about properties of accessibility relations. Our completeness proof, in turn, is an extensionof ‘standard’ completeness proofs in modal logic: we sometimes have to add fresh atoms p to ensure that θ(a, b, p) issatisfied. We have borrowed ideas from [6] to prove our Extension Lemma 2 and ideas from [9–11,21] to make this lemmawork ‘everywhere in the canonical model’. Finally, from [11,12] we borrow the notion of r-persistence (imposed on θ(cid:2)((cid:11)a, (cid:11)p)here) to make our completeness proof work.2. Language and semanticsAs outlined above, we deal with two languages, which are all interpreted over the same objects, i.e., Kripke models.The languages are an extended modal language L, and a first order language L1. For both languages, we assume a (finite,although this is not crucial for our results) set of modality labels A = {a1, . . . , a| A|}. In the modal language, these will giverise to modalities [a], and in the other language, we assume to have a binary relation Ra for each a ∈ A. For the latterlanguage, we also assume to have a set of variables X = {x, y, . . .}. The variables will range over possible worlds: note thatin L1 we do not assume to have constants. For the modal language L we assume a finite set ρ = {(cid:2)1, (cid:2)2, . . . , (cid:2)m} ofrelational atoms: they are nothing else than atomic symbols of which the truth depends on local properties of accessibilityin Definition 3). Therefore, we will often write (cid:2)(a1, . . . , an) rather than (cid:2) to make thisrelations (see the function Idependence clear, and treat (cid:2) as if it were an n-ary relational predicate (rather than an atomic symbol). Our languages willbe denoted L( A, π , ρ) (the modal language), and L1( A, X ) (the first order language). If the parameters for the languagesare clear, we will also write L, and L1, respectively.Definition 1 (Modal language). Let the sets A, π , and ρ be as described above. The modal language L( A, π , ρ) is defined asfollows:ϕ ::= p | ¬ϕ | ϕ ∧ ϕ | [a]ϕ | (cid:2)(a1, . . . , an)where a, a1, . . . , an ∈ A, p ∈ π and (cid:2) is an n-ary relational atom in ρ. Formula (cid:13)a(cid:14)ϕ is shorthand for ¬[a]¬ϕ and we alsoassume the usual definitions for disjunction, implication and bi-implication. If the modality is an epistemic one, the labelsdenote agents, and we write Kaϕ rather than [a]ϕ. For a doxastic interpretation we write Baϕ, etc.A formula without occurrences of relational atoms is called a purely modal formula. Suppose we have a multi-modalformula θ(a1, . . . , an, p1, . . . , pk) where a1, . . . , an are labels of modalities [a1], . . . , [an] and p1, . . . , pk are atoms. We willwrite (cid:11)a for the tuple a1, . . . , an and (cid:11)p for p1, . . . , pk. When we write a ∈ (cid:11)a we mean that a is one of the labels occurringin the tuple (cid:11)a, likewise for p and (cid:11)p. Finally, for any tuple (cid:11)x = x1, . . . , xn with each xi taken from some set X , we will write(cid:11)x ∈ (cid:11)X .Definition 2 (First order language). Let A and X be given. First define a language L+( A, X ):Θ := Raxy | ∀ yΘ | ¬Θ | Θ & Θwith a ∈ A, and x, y ∈ X . Now, our first order language L1( A, X ) is the one-free-variable sublanguage of L+sublanguage of L+only free variable, and if a1, . . . an are all the modality labels occurring in Θ , we will also write Θ((cid:11)a)(x) for Θ ., i.e., theconsisting of all formulas with one variable not in the scope of a quantifier. If Θ ∈ L1( A, X ) has x as itsAs mentioned earlier, both languages will be interpreted over Kripke models.136H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155Table 1In this table, (cid:11)a is a sequence a or (a, b) or (a, b, c) of modality labels, and (cid:11)p is either the single atom p or the sequence p, q. Θ((cid:11)a)(x)is a property of a state x, and (cid:2)((cid:11)a) is a name in the object language such that (cid:2)((cid:11)a) holds at w iff Θ((cid:11)a)(w) holds of M.θ((cid:11)a, (cid:11)p)[a]p → [b]p[c]p → [a][b]p¬[a]⊥[a]p → p(cid:13)a(cid:14)p → [b](cid:13)c(cid:14)p(cid:13)a(cid:14)p → (cid:13)b(cid:14)(cid:13)c(cid:14)p((cid:13)a(cid:14)p ∧ (cid:13)b(cid:14)q) → (cid:13)c(cid:14)(p ∧ q)Θ((cid:11)a)(x)∀ y(Rb xy ⇒ Ra xy)∀ y, z((Ra xy & Rb yz) ⇒ Rc xz)∃ y Ra xyRa xx∀ yz((Ra xy & Rb xz) ⇒ Rc yz)∀z(Ra xz ⇒ ∃ y Rb xy & Rc zy)∀ y, z((Ra xy & Rb xz) ⇒ ( y = z & Rc xy))(cid:2)((cid:11)a)Sup(a, b)Trans(a, b, c)Ser(a)Refl(a)Eucl(a, b, c)Dens(a, b, c)Func(a, b, c)Definition 3 (Kripke models and frames). Given A, π and ρ, a Kripke model for A, π and ρ (or, a Kripke model, if A, π andρ are clear, or not relevant) is a tuple M = (cid:13)W , R, I, V (cid:14) where• W is a set of possible worlds, also called states• R : A → ℘ (W × W ) assigns a binary relation to each modality label• I : ρ → L1( A, X ) assigns a first order property to each relational atom in ρ• V : π → ℘ (W ) assigns a set of possible worlds to each propositional variableRather then (w, v) ∈ R(a) we will write Ra w v. For M = (cid:13)W , R, I, V (cid:14) and w ∈ W , we let Ra(w) denote {v ∈ W | Ra w v}.A Kripke frame is a tuple F = (cid:13)W , R, I(cid:14) such that (cid:13)M, V (cid:14) = (cid:13)W , R, I, V (cid:14) is a model. The ‘arity’ of a symbol (cid:2) ∈ ρ can beread off from its interpretation I((cid:2)): if I((cid:2)) refers to modalities a1, . . . , an, then we may write (cid:2)((cid:11)a) for (cid:2). A pointed Kripkemodel is a pair (M, w) where w ∈ W is a designated point (‘the actual world’); we often delete the parentheses around it.We will sometimes use the terminology of I -models and I -frames to highlight the additional interpretation I compared to‘standard’ [3] Kripke models.Definition 4 (Semantics of modal formulas). Let A and π be given. Also, let M = (cid:13)W , R, I, V (cid:14). Then we define, for ϕ ∈L( A, π , ρ):iff w ∈ V (p)M, w |(cid:5) piff M, w (cid:17)|(cid:5) ϕM, w |(cid:5) ¬ϕM, w |(cid:5) ϕ ∧ ψ iff M, w |(cid:5) ϕ and M, w |(cid:5) ψM, w |(cid:5) [a]ϕM, w |(cid:5) (cid:2)((cid:11)a)(cid:3)(cid:2)((cid:11)a)(w) holdsfor all v if Ra w v, then M, v |(cid:5) ϕ(cid:2)iffiffIThe class of all models over A, π and ρ is denoted K( A, π , ρ). All models with interpretation I are denoted K( A, π , ρ, I).Validity of ϕ in a model M (denoted by M |(cid:5) ϕ) is defined as usual. Moreover, K( A, π , ρ) |(cid:5) ϕ means that for all modelsM = (cid:13)W , R, I, V (cid:14) over A, π and ρ, we have M |(cid:5) ϕ. If F = (cid:13)W , R, I(cid:14) is a frame, F , w |(cid:5) ϕ is defined as: for all valuationsV , (cid:13)W , R, I, V (cid:14), w |(cid:5) ϕ. To distinguish our models and frames from how they are usually defined in modal logic, we willsometimes refer to them as I -models and I -frames, respectively.Interpretation of L1( A, X )-formulas in a model M = (cid:13)W , R, I, V (cid:14) is straightforward. For L2( A, Π, X ), we assume thatP (s) holds for a predicate P iff s ∈ V (p). In other words, the link between a propositional atom and a unary predicate isimplicit by using lower-case and upper-case notation.Example 1. We give three examples: more are provided in Table 1.1. Let (cid:2)(a, b) be such that in M with interpretation I , we have I((cid:2)(a, b)) = Θ(a, b) where Θ(a, b)(x) = ∀ y(Rbxy ⇒ Raxy),saying that in the current world w, the set of a-successors of w is a superset of the set of b-successors of w. If this isthe interpretation of (cid:2)(a, b), we will also write Sup(a, b).2. As a second example, take (cid:2) = (cid:2)(a) to be such that I((cid:2)(a))(x) = Raxx. Note that Ba (cid:2) (a) can hence be interpreted as‘a believes that his beliefs are correct’, since M, w |(cid:5) Ba (cid:2) (a) does entail that for all ϕ, M, w |(cid:5) Ba(Baϕ → ϕ) (but seeRemark 1).3. Finally, take (cid:2)(a, b, c) with I((cid:2)(a, b, c))(x) = ∀ y∀z((Raxy &Rb yz) ⇒ Rc xz). We will write Trans(a, b, c) for Θ(a, b, c). Ofcourse, a special case of this is (cid:2) = (cid:2)(a, a, a) saying that currently, at world w, the relation Ra is transitive.Remark 1. Take (cid:2)(a) and M such that I((cid:2)(a)) = ∀xRaxx. Note that although M, w |(cid:5) (cid:2)(a) entails that agent a’s beliefs arecorrect, the converse is not true, as the following example shows (see Fig. 1). Let M = (cid:13)W , R, I, V (cid:14) be such that W = {w, u},H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155137Fig. 1. A model M, w. States w and u verify the same atoms.Fig. 2. A model M, w. The atom p is true exactly in the worlds that are filled black.and Ra = {(w, u), (u, w)}. Moreover, assume that for all p, w ∈ V (p) iff u ∈ V (p). Since (M, w) and (M, u) are bisimilarmodels ([4, Chapters 1 and 5]), we have M, w |(cid:5) ϕ iff M, u |(cid:5) ϕ, and hence M, w |(cid:5) Baϕ → ϕ, for all purely modal ϕ.However, since (w, w) /∈ Ra, we have M, w |(cid:5) ¬ (cid:2) ((cid:11)a).Note that, since Θ((cid:11)a)(w) does not refer to atomic propositions p (or, rather predicates P ), we have that Θ((cid:11)a)(w) holdsin the model M = (cid:13)W , R, I, V (cid:14) iff Θ((cid:11)a)(w) holds in the frame F = (cid:13)W , R, I(cid:14).Definition 5.1. Let ϕ ∈ L( A, π , ρ), and Φ some property which applies to states in a frame.(a) We say that ϕ defines the frame property Φ if for every frame F = (cid:13)W , R, I(cid:14) we have F |(cid:5) ϕ iff Φ holds of F .(b) ϕ is said to locally define Φ(x) if for every frame F and every w ∈ W , we have F , w |(cid:5) ϕ iff Φ(w) holds in F .2. Let θ(cid:2)((cid:11)a, (cid:11)p) be a purely modal formula, (cid:2)((cid:11)a) ∈ ρ and Θ((cid:11)a)(x) a first order property. If θ(cid:2)((cid:11)a, (cid:11)p) locally defines Θ((cid:11)a)(x)and I is such that I((cid:2)((cid:11)a)) = Θ((cid:11)a)(x), then we say that I semantically links θ(cid:2)((cid:11)a, (cid:11)p) and (cid:2)((cid:11)a) through Θ((cid:11)a)(x).Item 1 of Definition 5 generalises a definition of [12, pp. 180, 181] to I -frames. Our completeness proof relies on even astronger notion, although there we restrict ourselves to the case of first order properties (i.e., item 2 of Definition 5). Thenotions defined in the first item are also known as correspondence (between a modal formula and some, usually, first orderproperty). There is in fact a rich literature on modal correspondence theory: see for instance the early [23], the chapter onlocal correspondence in the later [24] and the more recent [4, Chapter 1] and [3, Chapter 3] and the references therein.Take the specific example in a doxastic context where Θ(a)(x) is Raxx, and I((cid:2)(a)) = Θ(a). Note that θ(a, p) = (Ba p →p) defines Θ(a)(x) but still, as shown in Remark 1, the formulas (cid:2)(a) and θ(a, p) are not equivalent. Still, the two shouldbe strongly connected, in a sense we will explain in Section 3. We first look at an example, involving our extended modallanguage.2.1. A simple exampleConsider five friends, Joey, Chandler, Ross, Monica and Phoebe (or j, c, r, m and p, for short). In this example, we use‘think’ and ‘believe’ for the same thing. Joey believes that Monica’s beliefs are at least as accurate as Ross’ beliefs, i.e.,Joey believes that if Ross’ beliefs are correct, so must Monica’s be ( A). Joey also believes that Monica thinks that Chandlerbelieves anything that Monica believes (B). Although Joey does not think that he believes everything he knows (he thinksthat he knows he cannot find a job as an actor, but at the same time cannot believe it), he actually believes anythinghe knows (C ). Moreover, Joey thinks that Chandler’s beliefs are consistent (D). Finally, Joey happens to know that Monicabelieves that Phoebe is in competition with her for Chandler’s attention, but at the same time Joey thinks that Chandlerbelieves that Phoebe is not in competition with Monica for his attention (E). Then, we conclude that Joey believes that Ross’beliefs are not guaranteed to be correct (F ), or, better, that Joey believes he may assume that some formula is believed byRoss, but not true (F).(cid:18)We first give a (semi-formal) formalisation of our assumption using a modal logic that allows for quantification overformulas. Let z represent the proposition that Joey cannot find himself a job as an actor, and let q be the proposition thatPhoebe is in competition with Monica for Chandler’s attention. This formalisation is given in Table 2, where assumption ( A)in our informal description is represented as (a), etc. The formalisation in our language L( A, π , ρ) follows in Table 3.We can now be more precise about what it means that our language can do more than just formalising a local versionof a global property. For instance, the global property Ba p → p will have a local counterpart Refl(a). Locally, this will denote138H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155Table 2A semi-formal translation of the episode.(a) B j (∀ϕ(Brϕ → ϕ) → ∀ϕ(Bmϕ → ϕ))(b) B j Bm(∀ϕ(Bmϕ → Bcϕ))(c) ¬B j (K j z → B j z) ∧ ∀ϕ(K jϕ → B jϕ)(d) B j ∀ϕ(¬(Bcϕ ∧ Bc¬ϕ))(e) K j Bmq ∧ B j Bc¬q( f ) B j ¬∀ϕ(Brϕ → ϕ)Table 3A formalisation of the episode.(cid:18)) B j (Refl(r) → Refl(m))(cid:18)) B j BmSup(m, c)(cid:18)) ¬B j (K j z → B j z) ∧ Sup(kj, k)(cid:18)) B j Ser(c)(cid:18)) K j Bmq ∧ B j Bc¬q(cid:18)) B j ¬Refl(r)(a(b(c(d(e( fsomething that is similar to ∀ϕ(Baϕ → ϕ). But if one looks at our formalisation (a) as given in Table 2, which is ourformalisation of the assumption ( A) that was given at the beginning of this example, i.e., B j(∀ϕ(Brϕ → ϕ) → ∀ϕ(Bmϕ →ϕ)), it becomes clear that this is different from the quantification (g) : ∀ϕ B j((Brϕ → ϕ) → (Bmϕ → ϕ)), which one wouldget as a local counterpart of an axiom B j((Br p → p) → (Bm p → p)). That (a) and (g) are not equivalent, can be seen inthe model M, w of Fig. 2, where (a) is true in M, w, but (g) is not: for the latter, ϕ = p provides a counter-example. That(a) is true in M, w is easily seen from realising that a is formalised by ain Table 3.We then formalise the same episode using the relational atoms (cid:2)((cid:11)a) introduced in Table 1, which results in Table 3.Abusing the language somewhat, we write Sup(kj, j) for the relational atom corresponding to K jϕ → B jϕ—from a languagepoint of view, K j and B j are simply two different modal operators, say [kj] and [i], respectively.(cid:18)3. AxiomatizationThe aim of this section is to provide an axiomatisation for modal logics that are enriched with some relational atoms(cid:2)1((cid:11)a1), . . . , (cid:2)m((cid:11)am), such that for every (cid:2)k(k (cid:4) m), there is a modal formula θ(cid:2)k ((cid:11)a, (cid:11)p) such that, at least on frames,the two ‘mean the same thing’. In fact, the logic K( A, π , ρ, I) that we define should be sound and complete with re-spect to K( A, π , ρ, I), so our aim for our logic is that for all formulas ϕ ∈ L( A, π , ρ), the notions K( A, π , ρ, I) (cid:19) ϕ andK( A, π , ρ, I) |(cid:5) ϕ coincide. The idea to achieve this is as follows. In order to characterise the ‘meaning’ of (cid:2)((cid:11)a), we first liketo specify what follows from it (‘elimination of (cid:2)((cid:11)a)’): this will be specified by axiom Ax(cid:2) in Table 4. Secondly, we need tocharacterise when one can derive that (cid:2)((cid:11)a) (‘introduction of (cid:2)((cid:11)a)’), which is our inference rule R(cid:2) in that table. To makethis all work, we moreover rely on a first order property Θ((cid:11)a) that can be used as the interpretation of (cid:2)((cid:11)a), and which islocally defined by θ(cid:2)((cid:11)a, (cid:11)p). It will turn out that finding such a property is not easy or indeed possible for all θ(cid:2)((cid:11)a, (cid:11)p), so wewill need to impose an additional condition on it: this will be done in Definition 11. This condition may look rather ad-hoc,but, as we will mention in Section 3.3, it is implied by a well-known property of local r-persistence. We will provide a formalsoundness and completeness result for our logic, and will discuss connections with related approaches and techniques inSection 3.3.Before plunging in the technical details, in order to get a feel for our axiomatisation, it pays off to recall that a formula ofthe form (cid:2)((cid:11)a) is a label (like Sup(a, b)), which represents both a modal formula θ(cid:2)((cid:11)a, (cid:11)p) (like [a]p → [b]p) and a first-orderproperty Θ((cid:11)a)(x) (like ∀ y(Rbxy ⇒ Raxy)).This is a good point to remind ourselves of the axiomatisation of the ∀ quantifier in first order logic. Formulated in ourcontext (and quantifying over atomic variables), it has an axiom and an inference rule (let us for simplicity assume that pcoincides with (cid:11)p, i.e., we only have one atom in θ(cid:2)((cid:11)a, (cid:11)p)):Ax∀ ∀pθ(cid:2)((cid:11)a, p) → θ(cid:2)((cid:11)a, p)R∀from ϕ → θ(cid:2)((cid:11)a, p) infer ϕ → ∀pθ(cid:2)((cid:11)a, p)where P does not occur in ˆΓOur axiomatisation is then obtained by (i) choosing (cid:2)((cid:11)a) for θ(cid:2)((cid:11)a, p) and (ii), adding a ‘modal component’ to theinference rule, which ensures that θ(cid:2)((cid:11)a, p) may be replaced by (cid:2)((cid:11)a) ‘anywhere in the model’.We now explain our axiom and inference rule in pure modal logic terms, as follows. First of all, suppose that for everyrelational atom (cid:2)((cid:11)a) and fixed interpretation I we have a formula θ(cid:2)((cid:11)a, (cid:11)p) such that θ(cid:2)((cid:11)a, (cid:11)p) defines I((cid:2)((cid:11)a)). Then, for each(cid:2)((cid:11)a) and related θ(cid:2)((cid:11)a, (cid:11)p) we add an axiom Ax(cid:2), which is (cid:2)((cid:11)a) → θ(cid:2)((cid:11)a, (cid:11)p) to our logic K( A, π , ρ, I). This makes sense,given Ax∀ and our observation above that (cid:2)((cid:11)a) is equivalent to ∀P ˆΘ((cid:11)a, P )(x), and the instance ˆΘ((cid:11)a, P)(x) corresponds tothe modal formula θ((cid:11)a, p).H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155139Table 4The axioms and inference rules of the logic K( A, π , ρ, I).PropKAx(cid:2)MPNecR(cid:2)USAll instances of propositional tautologies[a](ϕ → ψ) → ([a]ϕ → [a]ψ)(cid:2)((cid:11)a) → θ(cid:2)((cid:11)a, (cid:11)p)From ϕ → ψ and ϕ, infer ψFrom ϕ, infer [a]ϕFrom [s]θ(cid:2)((cid:11)a, (cid:11)p) infer [s] (cid:2) ((cid:11)a) where (cid:11)p doesnot occur in sFrom ϕ infer ϕ[ψ/p]Adding the other direction as an implication does not work, as the example (cid:2)((cid:11)a) = (cid:2)(a, b) = Sup(a, b) and θ((cid:11)a, (cid:11)p) =[a]p → [b]p shows: ([a]p → [b]p) → Sup(a, b) is not a validity: the antecedent may be true due to some specific choiceof p. Note that the modal reading of the rule R∀ in our language would giveR from ϕ → θ(cid:2)((cid:11)a, p) infer ϕ → (cid:2)((cid:11)a)where p does not occur in ϕThe rule R will indeed be derivable in our logic, but we need a little bit more. We will argue how to obtain R and itsgeneralisation, R(cid:2), by going back to the semantics of our modal language. Suppose that K( A, π , ρ, I) |(cid:5) ϕ → ([a]p → [b]p),where p does not occur in ϕ. This then means that ϕ must entail that (locally) all b-successors are a-successors, i.e.,K( A, π , ρ, I) |(cid:5) ϕ → Sup(a, b), because if the latter would not hold, there would be a model M = (cid:13)W , R, I, V (cid:14) such thatM, w, |(cid:5) ϕ ∧ ¬Sup(a, b). But since p does not occur in ϕ, we could then change the valuation V for p freely without(cid:18)(p) iff Ra wx (and V(cid:18)(q) = V (q) for atoms q (cid:17)= p). It ischanging that of ϕ, in particular we can choose V(cid:18), w |(cid:5) ϕ ∧ ¬([a]p → [b]p): a contradiction. This meanseasy to see that in the resulting model Mthat we need to be able to infer the following in K( A, π , {Sup(a, b)}, I):such that x ∈ V(cid:18)(cid:14) we have M(cid:18) = (cid:13)W , R, I, V(cid:18)(cid:4)(cid:5)Sup(a, b)(cid:4)(cid:3)(cid:2)(cid:3)|(cid:5) ϕ →, I(cid:3)(cid:5), ISup(a, b)[a]p → [b]p|(cid:5) ϕ → Sup(a, b),(cid:2)If KA, π ,(cid:2)then KA, π ,where p /∈ ϕ(1)The rule (1) is of course a special case of R∀. It can also be understood as follows. If p does not occur in ϕ, and ϕ →([a]p → [b]p) is true at a state s, then ϕ must carry sufficient information such that [a]p → [b]p must hold (it will not bebecause of specific requirements on p imposed by ϕ) and hence we must have ϕ → Sup(a, b) holding at s as well. But infact we can do the same reasoning that involves successors of s: suppose ϕ implies that in all Rc -successors t of s, we haveM, t |(cid:5) [a]p → [b]p. Then (in the same way as for s), we must have M, t |(cid:5) ϕ → Sup(a, b). In other words, the followingshould hold for K( A, π , {Sup(a, b)}, I):(cid:4)(cid:3)(cid:5)Sup(a, b)(cid:4)(cid:2)|(cid:5) ϕ → [c], I(cid:3)(cid:5)Sup(a, b), I(cid:2)If KA, π ,(cid:2)then KA, π ,where p /∈ ϕ(cid:3)[a]p → [b]p|(cid:5) ϕ → [c]Sup(a, b),(2)And the same should hold for all Rd-successors u of all Rc -successors t of s, etc. To formalise that a property θ(cid:2)((cid:11)a, (cid:11)p) holdsafter arbitrary sequences ϕ1 → [a1](ϕ2 → . . . [an−1](ϕn → θ(cid:2)((cid:11)a, (cid:11)p)) . . .), we follow [28] and introduce pseudo-modalities: wewill then present an inference rule R(cid:2) for every (cid:2) ∈ ρ to our axiomatisation K( A, π , ρ, I).Definition 6 (Pseudo-modalities). We define the following pseudo-modalities, which are (possibly empty) sequences s = ()or s = (s1, . . . , sn), where each si is a formula or a modality label. The formula (cid:13)s(cid:14)ϕ represents an L( A, Π, ρ) formula, asfollows (we will omit parentheses around non-empty sequences when they occur with a diamond or box):(cid:6)ϕ = ϕ(cid:7)()(cid:13)ψ, s2, . . . , sn(cid:14)ϕ = ψ ∧ (cid:13)s2, . . . , sn(cid:14)ϕ(cid:3)(cid:2)(cid:13)s2, . . . , sn(cid:14)ϕ(cid:13)a, s2, . . . , sn(cid:14)ϕ = (cid:13)a(cid:14)We also define [s]ϕ as ¬(cid:13)s(cid:14)¬ϕ. We say that (cid:11)p does not occur in s (and write (cid:11)p /∈ s) if none of the atoms p occurring in(cid:11)p does occur in any of the formulas si in s.So, for instance (cid:13)a, ψ, b(cid:14)ϕ is an abbreviation of (cid:13)a(cid:14)(ψ ∧ (cid:13)b(cid:14)ϕ), while [a, ψ, b]ϕ is short for [a](ψ → [b]ϕ).140H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155Definition 7 (Proof system). Fix A, π and ρ. Then, Table 4 comprises the axioms and inference rules of the logic K( A, π , ρ, I).In this table MP stands for Modus Ponens, Nec for Necessitation, and US for Uniform Substitution (ϕ[ψ/p] stands forsubstitution of ψ for every occurrence of p in ϕ). If (cid:2)((cid:11)a) and θ(cid:2)((cid:11)a, (cid:11)p) are connected through the axiom Ax(cid:2) and inferencerule R(cid:2), we say they are axiomatically linked (through axiom Ax(cid:2) and rule R(cid:2)). If there is a derivation of a formula ϕ froma set of formulas Γ using Γ and the axioms and inference rules from K( A, π , ρ, I) we write Γ (cid:19)K( A,π ,ρ,I) ϕ, or Γ (cid:19)K ϕ, forshort.Example 2. Suppose (cid:2) is Sup(a, b), so that θ(cid:2)((cid:11)a, (cid:11)p) = [a]p → [b]p. Then Axiom Ax(cid:2) becomes (cid:2)(a, b) → ([a]p → [b]p). Andthe inference rule R(cid:2) becomes: from (cid:13)s(cid:14)([a]p ∧ ¬[b]p) → ϕ, infer (cid:13)s(cid:14)¬Sup(a, b) → ϕ, where p does not occur in ϕ or s.Lemma 1. Let (cid:11)p be a sequence of atoms not occurring in ϕ. Then rule R is an instance of R(cid:2) obtained with s = (), and R(cid:2) is equivalentto R1 and R2:RR1From ¬θ(cid:2)((cid:11)a, (cid:11)p) → ϕ, infer ¬ (cid:2) ((cid:11)a) → ϕIf (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a) ∧ ϕ is consistent,then so is (cid:13)s(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p) ∧ ϕR2From (cid:13)s(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p) → ϕ, infer (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a) → ϕTheorem 1 (Soundness). For all ϕ ∈ L( A, π , ρ), if K( A, π , ρ, I) (cid:19) ϕ then K( A, π , ρ, I) |(cid:5) ϕ.Proof. We only show that axiom Ax(cid:2) and rule R1 are valid, the latter demonstrating validity of R(cid:2): all the other axiomsand rules are standard. Starting with Ax(cid:2), take a model M = (cid:13)W , R, I, V (cid:14), where I is a parameter of the logic, and W , Rand V are arbitrary. If M, w |(cid:5) (cid:2)((cid:11)a), this means that I((cid:2)((cid:11)a))(w) holds. Since θ(cid:2)((cid:11)a, (cid:11)p) characterises I((cid:2)((cid:11)a)), we get M, w |(cid:5)θ(cid:2)((cid:11)a, (cid:11)p).Next, we will argue that, if (cid:11)p does not occur in s and ϕ, thenIf (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a) ∧ ϕ is satisfiable, then so is (cid:13)s(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p) ∧ ϕFirst of all, note that we can assume that s never needs two successive agents a and b (we can separate them with (cid:20)) andneither does s need two successive formulas (we can replace them by their conjunction). Moreover we can assume that sis either empty or else starts with a modality (a possible condition can be added to ϕ). If s = (), then the assumption saysthat ¬ (cid:2) ((cid:11)a) ∧ ϕ is satisfiable. That is, there is a model M = (cid:13)W , R, I, V (cid:14) and a state w ∈ W such that M, w |(cid:5) ¬ (cid:2) ((cid:11)a) ∧ ϕ.The first part of this conjunction says that ¬I((cid:2)((cid:11)a))(w). Since θ(cid:2)((cid:11)a, (cid:11)p) locally defines I((cid:2)((cid:11)a)), and, since (cid:11)p does not occurin ϕ, we can change the valuation V for (cid:11)p without changing the truth of ϕ. In other words, we can define a new modelis such that it falsifies θ(cid:2)((cid:11)a, (cid:11)p), but if keeps the truth of ϕ unchanged.MWe have M(cid:18), w |(cid:5) ¬θ(cid:2)((cid:11)a, (cid:11)p) ∧ ϕ, demonstrating the satisfiability of (cid:13)s(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p) ∧ ϕ.(cid:18)(cid:14) where the truth of p ∈ (cid:11)p in M(cid:18) = (cid:13)W , R, I, VNow we use induction and assume that s = (cid:13)c, ψ(cid:14) · t, where ψ is a formula (not containing (cid:11)p), c an arbitrary modality,t a sequence (not containing (cid:11)p) and · denotes concatenation of sequences. Suppose (cid:13)(cid:13)c, ψ(cid:14) · t(cid:14)¬ (cid:2) ((cid:11)a) ∧ ϕ is satisfiable. Thismeans that at some M, w, we have M, w |(cid:5) ϕ and for some v with Rc w v, M, v |(cid:5) (cid:13)t(cid:14)¬((cid:2)(cid:11)a) ∧ ψ . Using induction, we getRc w v and M, v |(cid:5) (cid:13)t(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p) ∧ ψ ,(with (cid:11)p /∈ ψ, t). Hence M, w |(cid:5) (cid:13)(cid:13)c, ψ(cid:14) · t(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p) ∧ ϕ. (cid:2)(cid:18)3.1. Back to our exampleTo formalise the derivation of Table 3, let the set of modalities representing the friends be A = {c, j, m, p, r}, let π = {q, z}and let ρ = {Refl(r), Refl(m), Sup(c, m), Ser(c), Sup(kj, j)} and those atoms are axiomatically linked with their ‘natural’ modalcounterparts (see Table 1 and for Sup(kj, j) we take K j p → B j p). Let the resulting logic be K( A, π , ρ, I).First of all, from (c(cid:18)) and AxSup(kj, j) we derive K j Bmq → B j Bmq. Together with (e(cid:18)), i.e., B jSer(c) and AxSer(c), we get B j(Bc¬q → ¬Bcq). Combining this with (e(cid:18)) this gives (e(cid:18)(cid:18)): B j Bmq ∧ B j Bc¬q.(cid:18)(cid:18)) gives B j Bmq ∧ B j¬Bcq, which isFrom (dequivalent to B j¬(Bmq → Bcq) (*).From (b(cid:18)) and AxSup(m,c) we derive B j Bm(Bm p → Bc p), for any p (**). Now, take the formula ψ = (Bmq → Bcq). From (*)we have B j¬ψ , and from (**) we conclude B j Bmψ . In other words, we found a formula ψ for which B j¬(Bmψ → ψ). Nowusing the contrapositive of axiom AxRefl(m), we obtain B j¬Refl(m), which, together with (a(cid:18)), yields our conclusion ( f(cid:18)).Now one may wonder whether this also warrants the conclusion ( f ). Note that we did find a formula ψ above for whichwe derived that Joe believes that Monica believes it wrongly, but this does not imply that Joey also believes that Ross is(cid:18)), as should be clear from Remark 1, B j¬Refl(r) and B j¬∀ϕ(Brϕ → ϕ)mistaken regarding ψ . Also, although we now have ( f(cid:18)), and let s be B j ,(cid:18)) ∧ (care not the same thing. However, what we do have is the following. Let ϕ be (athen what we have proven now is(cid:18)) ∧ (d(cid:18)) ∧ (b(cid:18)) ∧ (eK( A, π , ρ, I) (cid:19) ϕ → B j¬Refl(r)(3)H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155141Which informally reads that, from our assumptions, we can derive that Joey believes that Ross considers the actual world(cid:18)), we(cid:18)) = Ser( j) (Joey’s beliefs are consistent) to our assumptions ϕ(cid:18) = ϕ ∧ (gnot (doxastically) possible. If we now add (gobtain from (3):K( A, π , ρ, I) (cid:19) ϕ(cid:18) → M j¬Refl(r)which, with rule R1, gives that, for any p not occurring in ϕ(cid:18)some p, Joey considers it possible that Ross is mistaken in his beliefs regarding that p.(4), ϕ(cid:18) ∧ M j(Br p ∧ ¬p) is consistent, i.e., we can assume that forIt is worth noting how the axiomatisation makes it possible that some relational atoms (and hence some first-order(cid:18)) for example): the axiom Ax(cid:2)frame properties) only hold in the scope of a modal operator (like in property (aand rule R(cid:2) do not require that some relational properties hold, they only specify what should be the case if they hold.(cid:18)) and (b3.2. CompletenessIn this section we show completeness of the axiomatisation, by the standard method of constructing a canonical model.However, to ensure that the points (maximal consistent sets) in this model are closed under the new inference rule (cf. ruleR1), we have to ensure that those sets are fully witnessed, as defined below. We also present a formulation of the conditionthat we need to impose on the formulas θ(cid:2)((cid:11)a, (cid:11)p) to make the completeness proof work: we will later, in Section 3.3 dwellon this condition further.Definition 8. A theory Γ is a set of formulas. For π a set of propositional atoms, Γ is a π -theory if all propositional atomsin Γ are from π . Given a logic L, a theory Γ is L-consistent if ⊥ cannot be derived from Γ using the axioms and inferencerules of L. A theory Γ is a maximal L-consistent π -theory if it is consistent and no π -theory (cid:6) is L-consistent while atthe same time Γ ⊂ (cid:6). For a logic K( A, π , ρ, I), a set of formulas Γ is a witnessed π -theory if for every (cid:2)((cid:11)a) and every(cid:13)s(cid:14)¬ (cid:2) ((cid:11)a) ∈ Γ , there are atoms (cid:11)p such that (cid:13)s(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p) ∈ Γ , where (cid:2)((cid:11)a) and θ(cid:2)((cid:11)a, (cid:11)p) are axiomatically linked. If Γ is notwitnessed, then a formula (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a) for which there is no (cid:13)s(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p) ∈ Γ , is called a defect for the theory Γ . Finally, Γis said to be fully witnessed, if it is witnessed and for every formula of the form (cid:13)s(cid:14)ϕ, either that formula or its negation isin Γ .Lemma 2 (Extension Lemma). Let Σ be a K( A, π , ρ, I)-consistent π -theory. Let π (cid:18) ⊇ π be an extension of π by a countable set ofpropositional variables. Then there is a maximal K( A, π (cid:18), ρ, I)-consistent, witnessed π (cid:18)-theory Σ (cid:18)extending Σ .Before we give a proof, we first define some languages.Definition 9. Let the set of agents A, the set of atoms π and the set of relational atoms ρ be fixed. Let L( A, π , ρ) beas in Definition 1. Let π 0 = {p0, p1, . . .} be a set of fresh atomic variables, i.e., π ∩ π 0 = ∅ and let π (cid:18) = π ∪ π 0. Letπn = π ∪ {pi | i (cid:4) n}. Define Ln to be L( A, πn, ρ), and let Lω be L( A, π (cid:18), ρ). A theory (cid:6) ⊆ Σ is called an approximation iffor some n it is a consistent πn-theory. For such a theory, and any number k, the sequence (cid:11)p = (cid:13)pn+1, . . . , pn+k(cid:14) is a newsequence (cid:11)p for (cid:6) if n is the least number such that (cid:6) is a πn-theory.Proof of Lemma 2. Assume an enumeration of ψ0, ψ1, . . . of all formulas of the form (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a), where s is a pseudo-modality and (cid:2)((cid:11)a) ∈ ρ. Define(cid:8)+ =(cid:6)(cid:6) ∪ {(cid:13)s(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p)} where (cid:11)p is a new sequence for (cid:6), and (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a) is the first defect for (cid:6) if this exists(cid:6)otherwiseClearly, by Ax(cid:2), the set (cid:6)+Σ (cid:18)of Σ , assume ϕ0, ϕ1, . . . to be an enumeration of the formulas in Lω, and defineis consistent when (cid:6) is and hence, if (cid:6) is an approximation, so is (cid:6)+. To define the extensionΣ0 = Σ(cid:8)Σ2n+1 =Σ2n ∪ {ϕn}Σ2n ∪ {¬ϕn} elseif this is consistent+Σ2n+2 = (Σ2n+1)(cid:9)Σ(cid:18) =Σnn∈ωBy construction, Σ (cid:18)is a maximal K( A, π , ρ, I)-consistent, witnessed π (cid:18)-theory extending Σ . (cid:2)Definition 10 (Canonical model). Given A, π , ρ and I , we define the canonical model Mc = (W c, Rc, I, V c) for the logicK( A, π , ρ, I) as follows, where π (cid:18)is as in Lemma 2:142H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155aΓ (cid:6) iff for all ϕ ∈ Lω it holds that if [a]ϕ ∈ Γ , then ϕ ∈ (cid:6)• W c = {Γ | Γ is a maximal Lω-consistent witnessed π (cid:18)• Rc• I is given as a parameter of the logic• V cp= {Γ | p ∈ π (cid:18) ∩ Γ }-theory}Lemma 3 (Existence Lemma). Let Γ be a maximal K( A, π (cid:18), ρ, I)-consistent witnessed π (cid:18)maximal K( A, π (cid:18), ρ, I)-consistent witnessed π (cid:18)-theory (cid:6) with Γ Rcb(cid:6).-theory, with (cid:13)b(cid:14)ϕ ∈ Γ . Then there is aProof. Let ϕ0, ϕ1, . . . be an enumeration of all formulas of the form (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a). Define the following sequence Y 0, Y 1, . . . ofsets of formulas, where yn =ψ :(cid:10)ψ∈YnY 0 = {ϕ}(cid:8)Y 2n+1 =Y 2n ∪ {ϕn}Σ2n ∪ {¬ϕn} else, i.e., if (cid:13)b(cid:14)( yn ∧ ¬ϕn) ∈ Γif (cid:13)b(cid:14)( yn ∧ ϕn) ∈ ΓY 2n+2 = (Y 2n+1)oY =Yn ∪(cid:9)(cid:4)σ | [b]σ ∈ Γ(cid:5)n∈ωHere, the operation o is defined as follows. First of all, if ¬ϕn is added to Y 2n+1, then Y o= Y 2n+1. Next, supposeϕn = (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a) was added to Y 2n+1. This means that (cid:13)b(cid:14)( yn ∧ (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a)) ∈ Γ , i.e., (cid:13)b, yn, s(cid:14)¬ (cid:2) ((cid:11)a) ∈ Γ . Since Γ is witnessed,we have (cid:13)b, yn, s(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p) ∈ Γ for some (cid:11)p, and we put Y o2n+1= Y 2n+1 ∪ {(cid:13)s(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p)}.2n+1Clearly, Y is fully witnessed. We claim Y is consistent as well, for suppose not, that is, there is a finite set of formulasfrom Y that together imply ⊥. Let k be the biggest index for which we need a formula from Yk to derive this contradiction.Then we have ( yk ∧ α) → ⊥, for some α in {σ | [b]σ ∈ Γ }, but this contradicts the facts that (cid:13)b(cid:14) yk ∧ [b]α ∈ Γ and that Γis consistent.Finally, take a maximal consistent set (cid:6) around Y : clearly this set is witnessed (since by construction of Y , for everyformula of the form (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a), a decision whether this formula or its negation should be included, is already made for Y ).Obviously, we have RcbΓ (cid:6). (cid:2)At this point, we should mention that although the definition of canonical model is similar to the standard definition inmodal logic blackburnml), the domain of the model of Definition 10 is not the set of all maximal consistent sets, rather, itis the set of all such sets that are witnessed. The consequences of this fact will be discussed in Section 3.3. To prove ourcoincidence lemma below, we will now assume that θ(cid:2)((cid:11)a, (cid:11)p) is locally good, in the following sense.Definition 11. Let the logic K( A, π , ρ, I) be given, θ(cid:2)((cid:11)a, (cid:11)p) be a modal formula, (cid:2)((cid:11)a) ∈ ρ a relational atom, Θ((cid:11)a)(x) a firstorder formula and I : ρ → L1( A, X ). Assume that (cid:2)((cid:11)a) and θ(cid:2)((cid:11)a, (cid:11)p) are connected through the axiom Ax(cid:2) and R(cid:2).1. We say that θ(cid:2)((cid:11)a, (cid:11)p) is locally good for Θ((cid:11)a)(x) iff(a) θ(cid:2)((cid:11)a, (cid:11)p) locally defines Θ((cid:11)a)(x), and(b) Let Mc be any canonical model obtained as in Definition 10. Then if Γ ∈ W c contains all instances of θ(cid:2)((cid:11)a, (cid:11)p), thenΘ((cid:11)a)(Γ ) holds in the model Mc .2. We finally say that the four-tuple (cid:13)θ(cid:2)((cid:11)a, (cid:11)p), (cid:2)((cid:11)a), I, Θ((cid:11)a)(x)(cid:14) is in local harmony if(a) θ(cid:2)((cid:11)a, (cid:11)p) is locally good for Θ((cid:11)a)(x), and(b) I semantically links θ(cid:2)((cid:11)a, (cid:11)p) and (cid:2)((cid:11)a) through Φ(x).Lemma 4 (Coincidence Lemma). Let Mc be defined as in Definition 10 and suppose for every (cid:2) ∈ ρ there are purely modal formulasθ(cid:2)((cid:11)a, (cid:11)p) and a first order formula Θ((cid:11)a)(x) such that the tuple (cid:13)θ(cid:2)((cid:11)a, (cid:11)p), (cid:2)((cid:11)a), I, Θ((cid:11)a(x))(cid:14) is in local harmony. ThenFor all ϕ ∈ L( A, π , ρ), Γ ∈ W c: Mc, Γ |(cid:5) ϕ iff ϕ ∈ ΓProof. For propositional variables this holds by definition, and the Boolean connectives are immediate. For ϕ = (cid:2)((cid:11)a), sup-pose (cid:2)((cid:11)a) ∈ Γ . By Ax(cid:2) and US, all instances of θ(cid:2)((cid:11)a, (cid:11)p) are in Γ as well. By items 1b and 2b of Definition 11, we thenhave I((cid:2)((cid:11)a))(Γ ), which by truth definition, yields Mc, Γ |(cid:5) (cid:2)((cid:11)a). Conversely, suppose (cid:2)((cid:11)a) /∈ Γ , then ¬ (cid:2) ((cid:11)a) ∈ Γ , and, byconstruction of Γ , for some (cid:11)p, we have ¬θ(cid:2)((cid:11)a, (cid:11)p) ∈ Γ . Since θ(cid:2)((cid:11)a, (cid:11)p) is locally good, it follows from items 1a and 2b ofDefinition 11, that it is not the case that I((cid:2)((cid:11)a))(Γ ) holds, i.e., Mc, Γ |(cid:5) ¬ (cid:2) ((cid:11)a).The modal case is standard: let ϕ ∈ L( A, π , ρ) be ϕ = [b]ψ . Let Γ ∈ W c and suppose Mc, Γ |(cid:5) [b]ψ . We now claimthat [b]ψ ∈ Γ , for suppose not, that is, suppose (cid:13)b(cid:14)¬ψ ∈ Γ . With Lemma 3 we find a maximal consistent witnessed (cid:6) forbΓ (cid:6) and ¬ψ ∈ (cid:6). By induction and the fact that ψ, ¬ψ ∈ L( A, π , ρ) we also have Mc, (cid:6) |(cid:5) ¬ψ which contradictswhich RcMc, Γ |(cid:5) [b]ψ . So {α | [b]α ∈ Γ } ∪ {¬ψ} is not L-consistent and we have {α | [b]α ∈ Γ } (cid:19) ψ and hence Γ (cid:19) [b]ψ andH. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155143consequently [b]ψ ∈ Γ . For the other direction, suppose [b]ψ ∈ Γ . Take an arbitrary (cid:6) ∈ W c with ψ ∈ (cid:6). By induction,Mc, (cid:6) |(cid:5) ψ . Since (cid:6) was arbitrary, we have RcbΓ (cid:6). (cid:2)Theorem 2. Let the logic K( A, π , ρ, I) be given as in Definition 7, and suppose for every (cid:2) ∈ ρ there are purely modal formulasθ(cid:2)((cid:11)a, (cid:11)p) and a first order formula Θ((cid:11)a)(x) such that the tuple (cid:13)θ(cid:2)((cid:11)a, (cid:11)p), (cid:2)((cid:11)a), I, Θ((cid:11)a(x))(cid:14) is in local harmony. Then K( A, π , ρ, I) issound and complete with respect to the class of K( A, π , ρ, I) models.Proof. Soundness is dealt with in Theorem 1. For completeness, let ϕ ∈ L( A, π , ρ) be such that K( A, π , ρ, I) (cid:2) ¬ϕ. ByLemma 2, {ϕ} can be extended to a maximal Lω-consistent witnessed theory Γ . By Lemma 4, we then have Mc, Γ |(cid:5) ϕ,and hence (cid:17)|(cid:5) ¬ϕ which completes the proof. (cid:2)3.3. Discussion and an extension of the completeness proofIn a nutshell, our completeness proof builds a model for maximal witnessed theories Γ . Every consistent formula ϕ canbe embedded in such a theory, and the construction makes sure that for every (cid:13)s(cid:14)¬ (cid:2) ((cid:11)a) ∈ Γ , there are witnessing atoms(cid:11)p such that (cid:13)s(cid:14)¬θ(cid:2)((cid:11)a, (cid:11)p) ∈ Γ . Our canonical model hence does not contain all maximal consistent sets, but only those thatare fully witnessed. Such a model is called a thinned out canonical model in [12].In modal logics that extend K with an axiom ϕ, the completeness proof for K + ϕ typically builds the canonical modelfrom all maximal consistent sets, and this construction works for axioms ϕ that are canonical for some first order propertyΦ(x) (see also [3, Chapter 5] for a further discussion). Completeness of K + ϕ is then obtained with respect to those framesof K that moreover satisfy Φ.For our set-up, rather than canonicity, we require a property given in Definition 11. Note that our frames do not globallyinherit the first order property Θ((cid:11)a), but instead, at every point Γ in the canonical model where θ(cid:2)((cid:11)a, (cid:11)p) holds, we alsohave the property Θ((cid:11)a).It appears1 there is a rich modal literature on proving completeness when having a thinned out canonical model likeours. A general way to prove completeness for such logics is presented in [12] (which in turn, is based on reports thatappear as the first chapter in [11]). We will not present the details here: it would involve the notion of general frames.Our proof shows that for the kind of model we define, the notion of θ(cid:2)((cid:11)a, (cid:11)p) being locally good (Definition 11) works toprove completeness. It might be cumbersome to check this notion for every θ(cid:2)((cid:11)a, (cid:11)p) separately, but luckily enough, from[12,11], it follows that our construction works for a class of formulas θ(cid:2)((cid:11)a, (cid:11)p) that are called locally r-persistent (again, thisnotion is defined in terms of general frames, we refer to [12,11,30]). For an example of a formula that is canonical but notr-persistent, see [30].A systematic characterisation of (locally) r-persistent formulas is still lacking, but [22, Theorem 2.4.7] ensures that shal-low formulas, i.e., modal formulas in which every occurrence of a propositional variable is in the scope of at most one modaloperator are r-persistent. Moreover, [12, p. 182] mentions that ‘many well-known formula axiomatising natural frame con-ditions like reflexivity, symmetry, transitivity, linearity etc. are locally r-consistent’.So the fact that r-persistence of θ(cid:2)((cid:11)a, (cid:11)p) implies that θ(cid:2)((cid:11)a, (cid:11)p) is locally good for some first order Θ((cid:11)a)(x) implies that ourcompleteness proof works whenever θ(cid:2)((cid:11)a, (cid:11)p) is r-persistent. It moreover guarantees the following ‘modular’ completenessresult.Theorem 3. Consider the logic K( A, π , ρ, I) and add a number of r-persistent formulas ϕ1, . . . , ϕn as axioms to it: call the result K(cid:18)is complete with respect to frames that satisfy Φi (i (cid:4) n).Suppose ϕi locally defines Φi . Then K(cid:18).Proof. For every axiom ϕi , introduce a new relational atom (cid:2)ϕi which is added as an axiom to the logic, and also add anaxiom and inference rule that axiomatically link ϕi and (cid:2)ϕi . Our completeness proof works when having several relationalatoms (cid:2) associated with a formula θ(cid:2)((cid:11)a, (cid:11)p) that is locally good for I((cid:2)). Since r-persistence of ϕi implies being locallygood for Φi , we obtain a model such that every set Γ that contains (cid:2)ϕi satisfies Φi(Γ ), and moreover, since (cid:2)ϕi is addedas an axiom, the whole model satisfies Φ. This completes the proof. (cid:2)We will see an immediate application of Theorem 3 in the next section.Our inference rule R(cid:2) is reminiscent of an inference rule for irreflexivity [8]. This rule for irreflexivity triggered a flurryof papers on studying similar ‘unorthodox rules’. We only mention here [11,30,12], which establish some general complete-ness results, technically similar to the one presented here. The paper [30] calls such rules ‘non-ξ rules’ and [12] calls them‘context-dependent rules’, because of the similarity between such rules and context-dependent rules in generating gram-mars. Also, our use of pseudo-modalities has ancestors: (often in combination with the kind of ‘unorthodox rules’ above),they are used in [12,30] as ‘universal forms’, in [9] as ‘admissible forms’ and were already present as a prototype in [8].They also play a similar role as does the ‘pasting’ of a subformula next to an occurrence of a specified one in [6] to provethe completeness of the D (difference) operator.1 We are indebted to one of the reviewers to point this out to us.144H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155However, it is important to stress that the approaches mentioned aim to axiomatise global properties. As far as we know,the work presented in this paper is a first general approach to local properties in models. Although [12] also pays attentionto local issues, all the frames obtained there are defined globally. Theorem 4.1 in [12] presents both a generalisation (it is notjust about rules with relational atoms) and a specialisation (it is not about I -frames) of our Theorem 2. In our terminology,[12, Theorem 4.1] supposes that we have a formula ϕ that locally defines α(x), and a formula ψ which is locally r-persistentand locally defining β(x). It then assumes an inference rule like R(cid:2), where θ(cid:2)((cid:11)a, (cid:11)p) is replaced by ϕ and (cid:2)((cid:11)a) by ψ . Ifsuch a rule is added to a logic L which only has r-persistent axioms, then the resulting logic is sound and complete withrespect to frames of L that moreover satisfy ∀x(α(x) → β(x)). In our case, the α and β are equivalent, so that indeed wekeep the frames of the underlying logic L. In other words, our logic does not demand anything about a frame globally, itonly requires that if locally all instances of θ(cid:2)((cid:11)a, (cid:11)p) are true, the ‘corresponding’ I((cid:2)((cid:11)a)) must hold as well.3.4. OutlookWe have so far assumed that the only properties of (cid:2)((cid:11)a) are those specified by the axiom A(cid:2) and rule R(cid:2). However, onecan add other connections between (cid:2)((cid:11)a) and modal formulas, or between different (cid:2)1((cid:11)a1) and (cid:2)2((cid:11)a2) atoms. For instance,in an epistemic logic, one could add the axiom schemeRefl(a, a) → Trans(a, a, a)(5)Adding an axiom like (5) for an agent a has the effect that whenever a’s knowledge is veridical, a is also positivelyintrospective. I.e., we would have, semantically, that whenever M, s |(cid:5) Kaϕ → ϕ, for all ϕ, then also M, s |(cid:5) Kaϕ → Ka Kaϕ,for all ϕ. This again is a property that cannot be expressed in standard, ‘global’ modal logic. As a second example, in anepistemic temporal modal logic, one could add an axiom like(cid:2)Trans(a, a, a) → (cid:3)(cid:3)Trans(a, a, a) ∧ Eucl(a, a, a)(6)saying that whenever agent a is positively introspective, he will eventually also become negatively introspective. As a thirdexample, a simple axiom likeSer(a) → Ser(b)(7)in a doxastic setting would mean that whenever a’s beliefs are consistent, those of b must be consistent as well.It is possible to view some standard results in modal logic concerning completeness of modal systems as special casesof our local logic. If the conditions of Theorem 2 are satisfied, and one adds a (cid:2)((cid:11)a) as an axiom, one immediately getscompleteness with respect to the class of models that satisfy I(θ(cid:2)((cid:11)a, (cid:11)p)). For instance, in a logic with axioms and rulesfor Refl(a), adding Refl(a) itself as an axiom gives a modal system that is sound and complete with respect to the class ofreflexive Kripke models! Of course, this amounts to the same thing as adding θ(cid:2)((cid:11)a, (cid:11)p), as is directly clear from rule R (takeα = ⊥).Finally, it is important to realise that, although we presented the axioms for the underlying logic (the formulas ϕi thatwe assumed to be canonical) and the relational atoms as two independent layers, the interaction properties between themodalities and the relational atoms may be automatically ‘imported’. For the case of epistemic logic S5 with at least twoagents and the Sup(a, b) atom for instance, one can derive that certain Sup(a, b) statements cannot go unnoticed by theagents! This will now be discussed in the next section.4. Comparative (epistemic) logicWe will now focus on an example of a modal logic, called comparative logic (CL), which has one type of relational atom(cid:2), namely Sup. From now on, we will write a (cid:3) b for Sup(a, b), and b (cid:5) a will denote the same. To motivate our notation,note thatM, w |(cid:5) a (cid:3) b iff Ra(w) ⊇ Rb(w)iff M, w |(cid:5) b (cid:5) a iff M, w |(cid:5) Rb(w) ⊆ Ra(w)We also write a (cid:17)(cid:3) b for ¬(a (cid:3) b). Moreover, we will write both a (cid:25) b and b ≺ a for (a (cid:3) b) ∧ ¬(b (cid:3) a). So a (cid:5) b means‘every a-successor is a b-successor’, and a ≺ b means ‘every a-successor is a b-successor, and some b-successor is not ana-successor’. In the second part of this section, we will then interpret our formulas on multi-agent S5-models (‘epistemic’models). So then a (cid:3) b stands for ‘agent a considers a larger set of worlds possible than agent b’, informally ‘b knows atleast as much as a’. We will start by adding the atom to the logic K( A, π , ρ, I). This is the logic CL: comparative logic. Thisis not yet an epistemic logic.4.1. Comparative logicDefinition 12 (Comparative logic). Comparative logic, CL( A, π ), is the logic that is obtained from K( A, π , ρ, I) by choosing asρ the singleton consisting of relational atom (cid:2) = (cid:3) (i.e., we have all a (cid:3) b for a, b ∈ A, in the language); where we stipulateH. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155145Fig. 3. The countermodels in Example 3 and Lemma 5. The atom p is true only in the black worlds.that I(a (cid:3) b) = ∀xy(Rbxy ⇒ Raxy) and, finally, that θ(cid:2)(a, b, p) = [a]p → [b]p. In CL( A, π ), the atom a (cid:3) b and [a]p → [b]pare axiomatically linked through the axiomAx(cid:3) = a (cid:3) b →(cid:2)[a]p → [b]p(cid:3)and inference rule R(cid:3):(cid:2)R(cid:3) = From [s][a]p → [b]p(cid:3)infer [s](a (cid:3) b)(p not in s)which is equivalent to:(cid:2)R(cid:3) = From (cid:13)s(cid:14)¬[a]p → [b]p(cid:3)→ ϕ infer (cid:13)s(cid:14)¬(a (cid:3) b) → ϕ(p not in ϕ or s)We write (cid:19)CL for derivability in CL( A, π ). The language C L( A, π ) of comparative logic is defined as L( A, π , {(cid:3)}).Corollary 1. CL( A, π ) is sound and complete with respect to K( A, π , ρ, I)Proof. This follows directly from Theorem 2 on page 143. (cid:2)In this weakest modal logic with the symbol (cid:3), we can already derive ‘expected’ properties of (cid:3):Proposition 1. The following hold:1. (cid:19)CL a (cid:3) a2. (cid:19)CL (a (cid:3) b ∧ b (cid:3) c) → a (cid:3) c3. (cid:19)CL a (cid:25) b → (cid:13)a(cid:14)(cid:20)Proof. 1. Since [a]p → [a]p is a theorem, we have (cid:19)CL ¬([a]p → [a]p) → ⊥ (where ⊥ = (q ∧ ¬q)). Applying the rule R(cid:3) tothis gives (cid:19)CL ¬(a (cid:3) a) → ⊥. The latter is equivalent to (cid:19)CL a (cid:3) a.2. Using Ax(cid:3), we have (cid:19)CL (a (cid:3) b ∧ b (cid:3) c) → (([a]p → [b]p) ∧ ([b]p → [c]p)). This implies (cid:19)CL (a (cid:3) b ∧ b (cid:3) c) → ([a]p →[c]p). We can now use rule R2 (with s the empty sequence) to conclude (cid:19)CL (a (cid:3) b ∧ b (cid:3) c) → a (cid:3) c.3. By definition, a (cid:25) b equals (a (cid:3) b) ∧ ¬(b (cid:3) a). We also have (cid:19)CL ¬([b]p → [a]p) → (cid:13)a(cid:14)(cid:20). Using R(cid:3) we then get(cid:19)CL ¬(b (cid:3) a) → (cid:13)a(cid:14)(cid:20). Using the definition above, we then get (cid:19)CL a (cid:25) b → (cid:13)a(cid:14)(cid:20). (cid:2)Our next example reminds the reader that a (cid:3) b and [a]ϕ → [b]ϕ are not the same.Example 3. Suppose Γ is the set of formulas(cid:4)Γ =[a]ϕ → [b]ϕ | ϕ ∈ L(cid:5)∪ {a (cid:17)(cid:3) b}Then it is well possible that Γ is satisfiable, and, by soundness, consistent. For satisfiability, take the following model M =(cid:13)W , R, I, V (cid:14), with W = {w, u, v}, Ra = {(w, u)} and Rb = {(w, v)}, I(a (cid:3) b)(x) = ∀ y(Rbxy ⇒ Raxy) and, finally, V p = {u, v}for all p. (See Fig. 3.) In this model, we have M, u |(cid:5) ϕ iff M, v |(cid:5) ϕ for all ϕ, and hence we have M, w |(cid:5) [a]ϕ → [b]ϕ, andyet we do not have Rb(w) ⊆ Ra(w), i.e. M, w |(cid:5) a (cid:17)(cid:3) b.To further emphasise the non-standard behaviour of our modal language, we state two more negative (and one positive)results. First let us briefly revisit some modal semantic notions.146H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155Definition 13. Given two models M = (cid:13)W , R, V (cid:14) and Mthe following holds: (‘atomic’) for all p ∈ P , if Rw wand some a ∈ A one has Ra w v, then there is a v(cid:18) ∈ Wsome vbetween M and Mwith Rww’, we write M, w ∼= Mand some a ∈ A one has R(cid:18)(cid:18) ∈ W(cid:18)a wv(cid:18)(cid:18)(cid:18)(cid:18), V(cid:18) = (cid:13)W(cid:18)(cid:14), a relation R ⊆ W × W(cid:18), Rthen w ∈ V (p) iff w(cid:18)(cid:18)(cid:18)v, then there is a v ∈ W such that Ra w v and Rv v(cid:18) ∈ Vand Rv v(cid:18)(p) (‘forth’) if Rw w(cid:18)and, finally (‘back’) if Rw wis called a bisimulation ifand if for some v ∈ W(cid:18)and if for. If there is a bisimulationsuch that R(cid:18)a w(cid:18)(cid:18)(cid:18)(cid:18), wA special case of a bisimulation is obtained by unraveling a model (M, w) into a model (M.(cid:18)(cid:18)(cid:18) = (cid:13)w 1, a1, w 2, a2, . . . , wn, an wn+1(cid:14) such w 1 = w and for allGiven W and a set of agents A let Wform wlst((cid:13)w 1, a1, w 2, a2, . . . , wn, an wn+1(cid:14)) = wn+1 (i.e., lst selects the last member of a finite list). Put w(cid:18) = (cid:13)w 1, a1, w 2, a2, . . . , wn, an wn+1, a, u(cid:14) for some u ∈ W .V (p), and Rbe all the finite paths in M from w,i.e., states wi (cid:4) n,in M one has Rai w i w i+1. Let lst(w(cid:18)(p) iff lst(w(cid:18) ∈ Vin Wif vv(cid:18)(cid:18)(cid:18)a w(cid:18)(cid:18)(cid:18)(cid:18), w) as follows.are of the(cid:18)) =(cid:18)) ∈If there are no relational atoms we have a standard multimodal logical language: for L( A, π , ∅) we write L( A, π ). Inother words, compared to CL( A, π ) = L( A, π , {(cid:3)}), L( A, π ) is the language without the a (cid:3) b formulas.Lemma 5.1. Bisimulations preserve L( A, π ) [3, p. 66]:If M, w ∼= M(cid:18)2. Unravelings preserve L( A, π ) [3, p. 63]:(cid:18), wthen for all ϕ ∈ L( A, π ): M, w |(cid:5) ϕ iff M(cid:18)(cid:18) |(cid:5) ϕ.wIf M(cid:18), w is an unraveling of M, w then for all ϕ ∈ L( A, π ): M, w |(cid:5) ϕ iff M(cid:18), w |(cid:5) ϕ.3. Bisimulations do not preserve CL( A, π )4. Unravellings do not preserve CL( A, π )Proof. We only show items 3 and 4. Take the model M(See Fig. 3.) Then for M defined in Example 3, it is clear that M, w ∼= M, where WFor item 4, consider the unraveling Measily verified that Munravelled model (for a (cid:17)= b). (cid:2)(cid:18)(cid:18), R(cid:18) |(cid:5) a (cid:3) b ∧ b (cid:3) a while M(cid:18)(cid:18), V(cid:18)(cid:18), w(cid:18)(cid:18) = (cid:13)W(cid:18))}.(cid:18)(cid:18) = {w= Ra(cid:18) |(cid:5) b (cid:3) a while M, w |(cid:5) ¬(b (cid:3) a).(cid:18), w(cid:18)(cid:18)(cid:14) of M(cid:18)(cid:14)}. (See Fig. 3.) It is(cid:18), a, z(cid:18) |(cid:5) ¬(a (cid:3) b) ∧ ¬(b (cid:3) a). The latter in fact shows a validity for any(cid:18)(cid:14) such that W(cid:18), w(cid:18), yet M(cid:18), (cid:13)w(cid:18)(cid:18) = {w(cid:18)} and R(cid:18) = (cid:13)W= {(w(cid:18)(cid:14), (cid:13)w(cid:18), b, z(cid:18), w(cid:18), V(cid:18), R(cid:18), z(cid:18), z(cid:18)b(cid:18)To show that CL( A, π ) is not completely misbehaved, we show that there are modified kinds of bisimulation and unrav-eling that do preserve the language. The idea is simple: instead of looking at individual steps we look at complete coalitionsfor which two states are accessible.Definition 14. Let for a coalition C ⊆ A, relation R C be such that R C w v iff for all i ∈ A: (R i w v iff i ∈ C ). Note the secondoccurrence of ‘iff’ in this definition: it follows that for every w and v there is exactly one coalition C ⊆ A for which R C w v.(cid:18), (cid:14), a relation R ⊆ W × W is called a coalitional bisimulation if theand if for some v ∈ W andand if for some. If there is a coalitional bisimulationGiven two models M = (cid:13)W , R, V (cid:14) and Mfollowing holds: (‘atomic’) for all p ∈ π , if Rw w(cid:18) ∈ W(cid:18)(cid:18)some C ⊆ A one has R C w v, there is a vv(cid:18)(cid:18) ∈ W, there is a v ∈ W such that R C w v and Rv vand some C ∈ A one has Rvvbetween M and M(cid:18), Rthen w ∈ V (p) iff w(cid:18)C wsuch that Rand, finally (‘back’) if Rw w(cid:18)(p) (‘forth’) if Rw w(cid:18) ∈ Vand Rv v, we write M, w ∼=coal Mwith Rw w(cid:18) = (cid:13)W(cid:18)(cid:18)C w(cid:18), w(cid:18), V.(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)Let M, w with M = (cid:13)W , R, V (cid:14) be given. A coalitional unraveling of M is a model M(cid:18)consists of all paths (cid:13)w 1, C1, w 2, . . . , wn, Cn, wn+1(cid:14) such that w 1 = w and for all i (cid:4) n, one has R C w i w i+1. V(cid:18)(cid:14), and(cid:18)is(cid:18) = (cid:13)w 1, C1, w 2, C2, . . . , wn, Cn wn+1, C, u(cid:14) for some u ∈ W(cid:18), w with M(cid:18) = (cid:13)W(cid:18), V(cid:18), Rwhere Wdefined as in the case for (ordinary) unravelings, and Rand C ⊆ A.(cid:18)(cid:18)C w(cid:18)vif vCoalitional unravelings (M(cid:18)v(cid:18)). The proof of the following is now a straightforward extension of the proofs of items 1 and 2 of Lemma 5(cid:18), w) of (M, w) respect access for coalitions of agents, in the following sense: for all C , R(cid:18)C w(cid:18)iff R C lst(wand therefore omitted:(cid:18))lst(vTheorem 4 (Preservation). We have the following.1. If M, w ∼=coal M2. If M(cid:18)(cid:18), wthen for all ϕ ∈ CL( A, π ): M, w |(cid:5) ϕ iff M(cid:18)(cid:18) |(cid:5) ϕ.w(cid:18), w is a coalitional unraveling of M, w then for all ϕ ∈ CL( A, π ): M, w |(cid:5) ϕ iff M(cid:18), w |(cid:5) ϕ.Proposition 2. A coalitional bisimulation is a bisimulation: if M, w ∼=coal M(cid:18)(cid:18), wthen M, w ∼= M(cid:18)(cid:18), w.Proof. A proof is needed, because the back and forth requirements for the bisimulation relation are not special cases ofthose for coalitional bisimulation, as Ra is not the same as (in coalitional bisimulations) R{a}: the latter links states withonly an a-arrow between them, the former links states with at least an a-arrow between them.H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155147Fig. 4. Three bisimilar models M, w, M(cid:18), w(cid:18)1 and M(cid:18)(cid:18), w(cid:18)(cid:18)1 .(cid:18) ∈ M(cid:18)Assume Rcoal: M, w ∼=coal M(cid:18)(cid:18), w. We show that also Rcoal: M, w ∼= M(cid:18)(cid:18), w. Assume there is a v ∈ M such that Rauv and Rcoaluuand u(there is a C such that {a} ⊆ C ⊆ A and R C non-empty). From R C uv and Rcoaluu(cid:18)RC uand a ∈ C follows R. ‘Back’: similar. (cid:2)and Rcoal v v. From R(cid:18)C u(cid:18)auvvv(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)(cid:18). ‘Atoms’ is trivial. ‘Forth’: let a ∈ A, u ∈ M,. Agent a must occur in some coalition C for which R C uvfollows that there is a vsuch that(cid:18) ∈ M(cid:18)(cid:18)The notion of coalitional bisimulation is in fact too strong to characterise preservation, i.e., the converse direction of(cid:18)item 1 of Theorem 4 does not hold. To see this, take the two models M, w 1 and M1 of Fig. 11 (in fact, all accessibilityrelations are equivalence relations: the formal definition of the models is in the proof of Theorem 8). We will argue in(cid:18)that proof that M, w 1 and M1 satisfy the same formulas, but it is easy to see that they are not coalition bisimilar:(cid:18)(cid:18)from w 1, there is an {a}-successor that satisfies ¬p, but this is not true for w1, nor for w2. But this also suggest a trivial(cid:18), wto have the same theory as M, w 1relaxation of our requirements for a coalitional bisimulation: in order for a state M(cid:18)(cid:18), w(cid:18)(cid:18), win Fig. 11, rather than requiring that Mis bisimilar with M, w in the sense of Definition 13, and (ii), the formula b (cid:5) a is true in M(and it should agree withM, w 1 on all relevant (cid:5)-formulas).needs to have an {a}-successor to a ¬p world, we should require that (i) M(cid:18), w(cid:18), w(cid:18), w(cid:18)(cid:18)(cid:18) = (cid:13)WDefinition 15. Let the models M = (cid:13)W , R, I, V (cid:14) and M(cid:18)variables π and relational atoms ρ. A relation R ⊆ W × W(cid:18), I(cid:18), V(cid:18), Ris called an extended bisimulation if(cid:18)(cid:14) be two models for the same agents A, propositional• R is a bisimulation (in the sense of Definition 13).• If for w ∈ W , wwe have Rw w(cid:18) ∈ W, then I((cid:2)((cid:11)a))(w) iff I(cid:18)(cid:18)(cid:18)((cid:2)((cid:11)a))(w(cid:18)) for all (cid:2)((cid:11)a) ∈ ρ.An extended bisimulation is moreover called natural if it also satisfies• If for w ∈ W , w(cid:18) ∈ W(cid:18)we have Rw w(cid:18), then I((cid:2)((cid:11)a))(w) = I(cid:18)((cid:2)((cid:11)a))(w(cid:18)) for all (cid:2)((cid:11)a) ∈ ρ.(cid:18)(cid:18)(cid:18) = (cid:13)W(cid:18), R, I, VAs an example, consider the models M = (cid:13)W , R, I, V (cid:14), M(cid:18)(cid:18)(cid:14) of Fig. 4. Let V , Vbe such that exactly the same propositional variables are true in all worlds. Suppose there is only one relationaland V(cid:18)(cid:18)((cid:2)(a)(x)) = Raxx. Then R = W × W(cid:18)((cid:2)(a)(x)) = ∃! y Raxy and Iatom (cid:2)(a) in the language, and I((cid:2)(a)(x)) = Raxx, Iis an(cid:18)extend bisimulation that is not natural (in M, (cid:2)(a) is interpreted as Ra being reflexive, in Ma being functional), whileR(cid:18) = W × Wrepresents a natural extended bisimulation (in both models, (cid:2)(a) is interpreted as reflexivity). Note thatfor Iis an unraveling a model N with a reflexive ortransitive relation Ra, then the two models bisimulate each other non-naturally by taking for instance I((cid:2)(a) to be Refl(a)or Trans(a), and Iits negation. To sum up, in an extended bisimulation, bisimulating worlds agree also on the truth ofrelational atoms, while in a natural extended bisimulation, bisimulating worlds moreover agree on the meaning of suchatoms.(cid:18)((cid:2)(a)(x)) we could even have taken ¬I((cid:2)(a)(x)). In particular, if N(cid:18)(cid:14) and M(cid:18)(cid:18) = (cid:13)W(cid:18)(cid:18), V(cid:18)(cid:18), R(cid:18)(cid:18), Ias R(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)(cid:18)The following is an easy extension of well-known results in modalL( A, π , ρ), not just about the comparative language of CL( A, π ).logic. Note that it is about general languagesLemma 6.1. Extended bisimulations preserve L( A, π , ρ), i.e., if there is an extended bisimulation between M, w and M(cid:18)(cid:18), w, then for allϕ ∈ L( A, π , ρ), M, w |(cid:5) ϕ iff M(cid:18), w(cid:18) |(cid:5) ϕ.2. For finite models, we also have the converse: if two finite models agree on formulas form L( A, π , ρ), then there exists an extendedbisimulation between them.Proof. Similar to the modal case (cf. [3]), when one treats relational atoms as propositional variables. (cid:2)4.2. Comparative epistemic logicWe will now specialise our case study with (cid:2)(a, b) = a (cid:3) b to epistemic logic. We will write Kaϕ (rather than [a]ϕ) for‘agent a knows ϕ’. Moreover, Maϕ will be short for ¬Ka¬ϕ.148H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155So our language L({Ka}a∈ A, π , {a (cid:3) b}a,b∈ A), or LCEL for short, is defined as follows, where π is as described earlier.ϕ ::= p | ¬ϕ | ϕ ∧ ϕ | Kaϕ | a (cid:3) bDefinition 16 (Comparative epistemic logic). Let CEL( A, π ), comparative epistemic logic, be the logic that is obtained fromCL( A, π ) by adding the following three knowledge axioms.T Kaϕ → ϕ4 Kaϕ → Ka Kaϕ5 ¬Kaϕ → Ka¬KaϕMoreover, since we assume ρ = {a (cid:3) b | a, b ∈ A} we have the following specialised axiom and rule (see Table 4 onpage 139; we recall that s is a pseudo-modality):Ax(cid:3) a (cid:3) b → (Ka p → Kb p)R(cid:3) From (cid:13)s(cid:14)(Ka p ∧ ¬Kb p) → ϕ infer (cid:13)s(cid:14)¬(a (cid:3) b → ϕ)As in CL, we assume in CEL that I(a (cid:3) b) = ∀ y(Rbxy ⇒ Raxy) and, finally, that θ(cid:2)(a, b, p) = Ka p → Kb p. So,inCEL( A, π ), we have axioms that guarantee that a (cid:3) b and Ka p → Kb p are axiomatically linked. We will write (cid:19)CEL forderivability in CEL( A, π ).Models for CEL( A, π ) will be ordinary S5-models, i.e., models of the kind M = (cid:13)W , R, I, V (cid:14) with the constraint that foreach a ∈ A, Ra is an equivalence relation. Call this set of models S5( A, π , ρ, I).Theorem 5. CEL( A, π ) is sound and complete with respect to S5( A, π , ρ, I).Proof. This follows directly from Theorem 3 and the observation that axiom T is r-persistent and defines reflexivity, axiom4 if r-persistent and defines transitivity, and 5 r-persistent and defines Euclidicity (for the r-persistence argument, see [12]).Moreover, a relation has those three properties iff it is an equivalence relation. Finally, Ax(cid:3) is also r-persistent, since it isshallow [22]). (cid:2)The technical results in the previous sections suggest that the infinite scheme(cid:11)(Kaϕ → Kbϕ)ϕ∈L(8)(cid:10)is captured by the formula a (cid:3) b. However, we have also seen that, would we allow for infinite conjunctions, then althoughwe would have (cid:19) (a (cid:3) b) →ϕ∈L(Kaϕ → Kbϕ), this implication can in general not be reversed.Related to this, it is worth noting that the notion of ‘knowing more than’ cannot be captured in the language of CEL.Although one might suspect that ‘b knows more than a’ is captured by a (cid:25) b, the latter only says that every state consideredpossible by b is also considered possible by a and, moreover, some states are considered possible by a and not by b. However, theselatter states can all be bisimilar to states that both agents consider possible, in which case both agents would know thesame.The following theorem summarises some of our discussion so far.Theorem 6. Let (M, w) be a pointed CEL model. Let Ψ (w) denote that in w, agent b knows at least what a knows:Ψ (w) : ∀ϕ(cid:2)(M, w) |(cid:5) Kaϕ → Kbϕ(cid:3)Furthermore, let Φ(w) denote that at w, agent b knows strictly more than a:Φ(w) : ∀ϕ(cid:2)(M, w) |(cid:5) Kaϕ → Kbϕ(cid:3)(cid:2)& ∃ψ(M, w) |(cid:5) Kbψ ∧ ¬Kaψ(cid:3)1. If (M, w) |(cid:5) a (cid:3) b, then Ψ (w);2. The converse of item 1 does not hold in general;3. (M, w) |(cid:5) a (cid:25) b does not imply Φ(w) in general;4. Φ(w) does not in general imply (M, w) |(cid:5) a (cid:25) b.Proof. All items, except item 1, require a counter-example.1. This follows from Ax(cid:3) and soundness of CEL.H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155149Fig. 5. An infinite model with states {ui , w i , xi | i ∈ Z} for Theorem 6, item 4. Black dots denote worlds where p is true.Fig. 6. In this model M all states satisfy the same atoms.2. This follows from Example 3 on page 145.3. Take the model M of Fig. 6 (recall that we do not draw reflexive arrows in our figures). That is, W = {u, v, w}, Ra =W × W , Rb = {(v, w), (w, v)} ∪ {(x, x) | x ∈ W }, I interprets (cid:3) as expected and V is such that V (p) is either W or ∅,for all p ∈ π (so all worlds agree on propositional variables). An easy induction on formulas ϕ from LCEL shows thatM, w |(cid:5) ϕ iff M, u |(cid:5) ϕ iff M, v |(cid:5) ϕThis is true by definition for ϕ ∈ π , and it is also true for relational atoms: a (cid:3) b is true in all worlds, and b (cid:3) a is truein no world. The cases for negation, conjunction and knowledge formulas then follow directly. To conclude, we have(M, w) |(cid:5) a (cid:25) b but Φ(w) is false in M.4. See Fig. 5. We will not formally define the model M depicted in this figure, but it is easy to see that for all i, j ∈ Z, andall ϕ, we have M, xi |(cid:5) ϕ iff M, x j |(cid:5) ϕ. This is because the two models (M, xi) and (M, x j) are not just bisimilar, theyare isomorphic! From this if follows that for all ϕ, (M, w 0) |(cid:5) Kaϕ → Kbϕ. Because if (M, w 0) |(cid:5) Kaϕ, then ϕ holds inw 0, x0 and u0, so by the claim just mentioned we have that ϕ holds in w 0 and u1, and hence (M, w 0) |(cid:5) Kbϕ. (cid:2)It would be interesting to study under which conditions the counter-examples that perfectly link (cid:3) and ‘knowing atleast as much’, or between (cid:25) and ‘knowing more’ fade away, in other words, under which circumstances there is a perfectmatch between for instance (cid:25) and ‘knowing more’. A natural condition for this seems to be the case where, for any agenta, and any world w, the set Ra(w) is definable in LCEL, that is, where there is a formula χa,w such thatM, v |(cid:5) χa,w iffv ∈ Ra(w)It is easy to see how this addresses the negative results in Theorem 6. For item 2 for instance, if Ψ (w) holds, we have inparticular M, w |(cid:5) Kaχa,w → Kbχa,w and hence if Rb wu, then M, u |(cid:5) χa,w and hence u ∈ Ra(w), so that M, w |(cid:5) a (cid:3) b.Examples where definability of successors is guaranteed are for instance obtained if we restrict our attention to the casewhere the language has only finitely many atoms, and where the models are both image finite (every world has only finitelymany successors) and strongly extensional (see [3], this notion is also sometimes called bisimulation contraction), items 2 to 4of Theorem 6 would not allow for a counter-example. Intuitively, a model is strongly extensional if it cannot contain fewerworlds without changing its information content, i.e.: removing a state would mean changing the truth of some formula insome other state. We leave a precise characterisation of classes of models where (cid:3) and ‘knowing at least’ exactly match,for future research.In Proposition 1 we showed that some simple properties of (cid:3) can be already derived in CL. An obvious question iswhether adding knowledge properties to the logic enables us to derive more properties of (cid:3), in particular, whether itinduces interaction properties between the (cid:3)-operators and the knowledge operators. This is indeed the case.Theorem 7. Let a and b agents. Then the following are validities in CEL.1. a (cid:3) b ↔ Kb(a (cid:3) b)2. ¬(a (cid:3) b) ↔ Kb¬(a (cid:3) b)3. a (cid:25) b ↔ Kb(a (cid:25) b)4. a (cid:25) b ↔ (Kb(a (cid:3) b) ∧ Ka¬(b (cid:3) a))5. Kb(a (cid:3) b) ∨ Kb¬(a (cid:3) b)Proof. In the first four cases, the right-to-left direction follows from the fact that we have reflexive models (or, equivalently,since we have axiom T).150H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–1551. Let (M, w) be arbitrary and assume M, w |(cid:5) a (cid:3) b. To prove M, w |(cid:5) Kb(a (cid:3) b). Therefore, let v be such that Rb w v,then to prove that M, v |(cid:5) a (cid:3) b. Let u be such that Rb vu, then to prove that Ra vu. From Rb w v and Rb vu followsRb wu, as Rb is transitive. From assumption M, w |(cid:5) a (cid:3) b and Rb w v follows Ra w v, and from M, w |(cid:5) a (cid:3) b and Rb wufollows Ra wu. From Ra w v and Ra wu and the Euclidicity of Ra now follows Ra vu.2. This follows from the first item, using modal logical reasoning. Writing α for a (cid:3) b, the first item implies that we have|(cid:5) α → Kbα, and hence |(cid:5) ¬Kbα → ¬α. Applying necessitation and the K -axiom to the latter, we obtain |(cid:5) Kb¬Kbα →Kb¬α (*). Since our models are reflexive, we have |(cid:5) ¬α → ¬Kbα. Applying negative introspection to the latter yields|(cid:5) ¬α → Kb¬Kbα. Using this with (*) finally gives |(cid:5) ¬α → Kb¬α, i.e., |(cid:5) ¬(a (cid:3) b) → Kb¬(a (cid:3) b).3. This follows from the previous two items (and hence, since 2 follows from 1, it follows from 1). Suppose (M, w) |(cid:5) a (cid:25) b.This implies (M, w) |(cid:5) a (cid:3) b and hence, by item 1, then (M, w) |(cid:5) Kb(a (cid:3) b). Since (a (cid:25) b) implies ¬(b (cid:3) a), from item 2we infer that M, w |(cid:5) Ka¬(b (cid:3) a). Since M, w |(cid:5) a (cid:3) b we have M, w |(cid:5) Kaψ → Kbψ for all ψ , and hence M, w |(cid:5)Kb¬(b (cid:3) a). In sum, we have M, w |(cid:5) Kb(a (cid:3) b) ∧ Kb¬(b (cid:3) a), which, by modal reasoning, yields M, w |(cid:5) Kb(a (cid:25) b).4. This follows from item 1, item 2, and the definition of a (cid:25) b: note that the latter is defined as (a (cid:3) b) ∧ ¬(b (cid:3) a), fromwhich, by item 1 we derive Kb(a (cid:3) b) ∧ ¬(b (cid:3) a), and, by item 2, Kb(a (cid:3) b) ∧ Ka¬(b (cid:3) a).5. Again, this follows directly from items 1 and 2, together with the validity of (a (cid:3) b) ∨ ¬(a (cid:3) b). (cid:2)Theorem 7 states some facts about (cid:3) on S5-models that at first sight might seem remarkable. Roughly speaking, theyimply that if an agent b has at least the same (or more) information than agent a, agent b will know this. In particular,item 1 of the theorem says that if b considers at most the states possible that a considers possible, b knows this. Item 3states that if b only considers a strict subset of a’s alternatives, b knows this as well! This is particularly striking in caseswhere a and b in fact know the same (this is for instance true in (M, w) of Fig. 6). In this model, note that agents a andb know the same in (M, w). However, although both agents know exactly the same, both agents also know that agent bconsiders less states possible than agent a! Item 2 then says that if b does not consider at most the states possible thata considers possible, b must know this. In sum, the first three items seem to suggest that no matter whether (i) b has atleast the information as a has, or (ii) has more information than a, or (iii) does not have at least the information that a has,b will know this! Item 5 states that, for any agent b, if he compares his information state with an arbitrary agent a, then bwill know whether he has at least the same information as a or not. The following representation of S5-models and thealternative notation when dealing with equivalence relations may also help the reader.Remark 2. We give an alternative proof of Theorem 7 items 1 and 3, stressing the fact that we are dealing with equivalencerelations. For an S5-model M = (cid:13)W , R, V , I(cid:14), a world w ∈ W , and an agent a, let us write [a]w for {v ∈ W | Ra w v}. Notethat, when v ∈ [w]a, then [w]a = [v]a. In the model M of Fig. 7, we have depicted four states, w, v, x and z. The set W ispartitioned in [w]a and [z]a (note that in fact there does not need to exists a z /∈ [w]a, in which case we would only haveone equivalence class for a). For agent b, we have only depicted one equivalence class [w]b, it does not matter how theother classes for b are splitting up W . The existence of world x is only guaranteed in the second item below.1. Let M, w |(cid:5) a (cid:3) b. This means that [w]a ⊇ [w]b (1). In order to prove M, w |(cid:5) Kb(a (cid:3) b) we need to show that for anyv such that v ∈ [w]b, we have that M, v |(cid:5) a (cid:3) b, that is, [v]a ⊇ [v]b. Since v ∈ [w]b, we have [w]b = [v]b, which with(1) gives [w]a ⊇ [v]b (2). Since v ∈ [w]b, with (1) we derive that v ∈ [w]a, and hence [v]a = [w]a. With (2) this gives[v]a ⊇ [v]b.The proof of item 3 of Theorem 7 is almost identical to that of the previous item: replace each occurrence of (cid:3) by (cid:25) andeach occurrence of ⊇ by ⊃.Where our first proof of Theorem 7 shows that transitivity and Euclidicity are sufficient to demonstrate the →-directionof the items 1 and 3, we finally show that they are also necessary: see Fig. 8. In model M, we have (M, w) |(cid:5) M, w |(cid:5)a (cid:25) b ∧ ¬Kb(a (cid:3) b) which, shows that both items 1 and 3 of Theorem 7 fail on reflexive transitive models. In N, we have(N, v) |(cid:5) a (cid:25) b ∧ ¬Kb(a (cid:3) b), showing that Euclidicity on its own cannot guarantee Theorem 7 to hold. (There can be noreflexive Euclidean model refuting Theorem 7, since those two conditions together ensure that the accessibility relation isalso transitive, i.e., an equivalence.)Concentrating now on the agent a that has less information (i.e., who considers at least the states possible that bconsiders possible), it turns out that a does not need to be aware of this. It seems somewhat ‘unfair’ that if a knows lessthan b, a does not necessarily know that — at least in a (fair!) game-like setting one would expect the opposite: playerb may have an advantage (more information, more knowledge), but in order to place his bets player a should at least beaware of his disadvantage (ignorance) compared to b. On the other hand, considering that these are typically incompleteinformation games, from a’s perspective it may be gambling the possibility of being less informed than b against thepossibility of knowing more, which sounds more ‘fair’.Example 4. Consider the model of Fig. 9 consisting of three states, where a cannot distinguish t from u whereas b cannotdistinguish s from t. In fact u is the case. In u it is true that a (cid:3) b — in fact a knows indeed less than b, but a considersH. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155151Fig. 7. In this model M we have depicted two equivalence classes for a, but only one for agent b.Fig. 8. In both (M, w) and (N, v), formula a (cid:25) b ∧ ¬Kb(a (cid:3) b) holds.Fig. 9. An S5-model with three states. The valuation is given above each state.it possible that ¬(a (cid:3) b), in which case the advantage of b would be less. Possibly a is willing to bet for the latter, eventhough the former is really the case. This is like playing bridge and noting the signals exchanged between the opponents,that if true may have revealed their better hand of cards, but they may also have been explicitly misinforming you by theirsignals in order to confuse you. In any case, our model has (M, u) |(cid:5) a (cid:3) b ∧ ¬Ka(a (cid:3) b): agent a is at most as informed as bwithout knowing it. Note that we even have (M, u) |(cid:5) a (cid:25) b ∧ ¬Ka(a (cid:25) b): agent a is less informed than b without knowingthis.It is of course well possible that each agent has a secret. In Fig. 9 for instance, we haveM, t |(cid:5) (Ka p ∧ ¬Kb p) ∧ (Kbq ∧ ¬Kaq)Before looking at an example in CEL, consider the following property: ¬Kaϕ ∧i∈ A((a (cid:25) i) → K iϕ). This expresses that adoes not know ϕ, but anybody who would know even a little bit more would know ϕ. In state u of the example abovewe have that a does not know that q is false, but b, who knows ‘a little bit’ more (who considers only the actual state aspossible, one less than the two states considered possible by a) knows that q is false. So we have, in u:(cid:10)¬Ka¬q ∧ (a (cid:25) b → Kb¬q)This notion of ‘knowing even a little bit more’ seems of independent interest on infinite models, where the differencebetween a’s ignorance and any other agent’s knowledge may be like the difference between a closed set and any openapproximation of that set.152H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155Fig. 10. Two epistemic models M and N: in (N, r wb) agent 3 knows more than agent 1 and more than agent 2.4.3. Comparative epistemic logic with public announcementsBeing able to locally express that agent a knows at least what agent b knows is especially valuable if one can somehowreason about change of knowledge, allowing one to express that it comes about that one player gets to know at least whatanother knows. Dynamic epistemic logic ([27]) is a powerful formalism to reason about change within the object language.Without going into the details of the logic, we will here focus on a particular case of dynamic epistemic logic, namely publicannouncements, thereby focus on the semantical aspect of model restriction.First, consider the two epistemic models in Fig. 10. Call the models M (left) and N (right). Model M represents a situationwhere three players 1, 2 and 3 each hold a card from a deck of cards Cards = {r, w, b}. A state with a name xyz represents asituation where player 1 holds card x, player 2 holds y and player 3 holds z. We also assume atoms ri, w i, bi (i (cid:4) 3) wherefor instance r2 is true in those situations where 2 holds the red card. Players only see their own card, and not the card ofthe others (and this is common knowledge). Note that both models are image finite and strongly extensional: the worlds ineach model already differ in the valuations. This implies that we can here identify (cid:3) with ‘knowing at least as much as’,and (cid:25) with ‘knowing more’.In M we have for instance thatM, rwb |(cid:5) r1 ∧ K1r1 ∧ ¬K2r1 ∧ K1¬K2r1I.e., if the deal is rwb, then 1 holds the red card, he knows this, but 2 does not know it, and, finally, 1 knows that 2 doesnot know that 1 holds the red card.Since every player knows a fact that the others don’t know (i.e., the face of their own card) we also haveM |(cid:5) ¬(1 (cid:3) 2) ∧ ¬(2 (cid:3) 1) ∧ K1¬(1 (cid:3) 2) ∧ K1 K2¬(1 (cid:3) 2)which says that the information of players 1 and 2 is incomparable, and 1 knows that 2 does not know more than him:1 even knows that 2 knows that 2 does not know more than 1.However, now consider model N, which can be obtained from M as the effect of a public announcement that player 1does not hold the white card, i.e., ¬w 1. In other words, N is obtained from M by leaving out all those states where theannouncement (that ¬w 1) is false. Said differently, N is the result of M when leaving out the states wrb and wbr. Thenotation for this is N = M|¬w 1 (N is M restricted to the ¬w 1 worlds). We then obtainN, rwb |(cid:5) 1 (cid:25) 3 ∧ 2 (cid:25) 3 ∧ M1(3 (cid:25) 2)This describes the situation that when the card deal is rwb, and somebody announces in public that 1 does not holdthe white card, that after that announcement, 3 knows more than 1 and than 2 (they both knew already the fact thatis announced), and 1 considers it possible that 2 holds the white card, in which situation 3 (cid:25) 2 would hold after theannouncement.Let us now consider a little closer how a system of comparative epistemic logic combined with public announcementlogic would look like. First of all, this would involve a language, which we call LCEL+PAL defined as follows:ϕ ::= p | ¬ϕ | ϕ ∧ ϕ | Kaϕ | a (cid:3) b | [ϕ]ϕwhere [ϕ]ψ is read as: ‘after the public announcement of ϕ, ψ is the case’. We have already discussed the semantics forthis: if M = (cid:13)W , R, V , I(cid:14), then(M, w) |(cid:5) [ϕ]ψ iff(M, w) |(cid:5) ϕ implies (M|ϕ, w) |(cid:5) ψwhere M|ϕ is the model M restricted to those worlds that verify ϕ.In such a combination, one would enable to communicate what in standard public announcement logic would requirean infinite amount of communication (namely, as above, public announcement of Kaϕ → Kbϕ for all formulas ϕ in thelanguage!). The public announcement a (cid:3) b has the effect that the local property that b knows at least what a knowsH. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155153Fig. 11. Two S5-models. States where p holds are black.Fig. 12. Two S5-models, the result of announcing ¬p in the models of Fig. 11.becomes a global property. It is easy to see that [a (cid:3) b](Kaϕ → Kbϕ) is a validity, or, in other words, after an announcementwith a (cid:3) b, Rb ⊆ Ra is common knowledge. (If [a (cid:3) b](Kaϕ → Kbϕ) is a validity then also, as usual, [a (cid:3) b]C A(Kaϕ →Kbϕ).) The semantics for such a public announcement would be a standard model restriction to the worlds satisfying theannounced formula, in this case, to the worlds satisfying a (cid:3) b: M|a (cid:3) b = {s ∈ M | M, s |(cid:5) a (cid:3) b}.The axiomatisation of public announcements in S5 is obtained by so-called reduction axioms (see [27] for a discussion).Those axioms explain how public announcement can be reduced to statements in S5 that do not involve such announce-ments. For instance, the reduction axiom for knowledge says that [ϕ]K iψ (‘after announcement of ϕ, agent i knows ψ ’) isequivalent to ϕ → K i[ϕ]ψ . Using this axiom together with the other axioms (for conjunction and negation), we can ‘push’the announcements operators [·] ‘inside’ the subformulas, and eventually, using the axioms for announcement and atoms,get rid of them. This shows that S5 plus public announcements is equivalent to S5 itself.So if we would be able to come up with a reduction principle for announcements and (cid:3), we would have a completelogic for a language with knowledge, announcements and the comparison operator (cid:3). However, there is no reduction axiomfor [ϕ]a (cid:3) b. Even stronger, we will now show that by adding public announcements to CEL we obtain a system that ismore expressive than CEL itself.Theorem 8. CEL with public announcements is more expressive than CEL.(cid:18) = (cid:13)WProof. We will employ a results about coalitional bisimulations, Theorem 4 (first item). Consider the two models M =(cid:13)W , R, V , I(cid:14) and Monly, and the accessibilityrelations for the agents a and b can be read off from the figure (note that this is an S5-model: reflexive arrows are notdrawn). Formally: W = {u, w 1, w 2, w 3} with Ra = W × W and Rb is the reflexive closure in W of {(w 1, w 2), (w 2, w 1)},(cid:18)2)} andand V (p) = {u}. Similarly, WV(cid:18)(cid:18)b is the reflexive closure on W2link (cid:3) with the superset-relation. We claim the following:(cid:18)(cid:18), w1, w(cid:18)(cid:18)}. Both interpretations I and I(cid:18)(cid:14) depicted in Fig. 11: the atoms p is true at states u and u} with R(cid:18)(p) = {uof {(w(cid:18) × W(cid:18) = {u(cid:18)1, w= W(cid:18), V(cid:18), R(cid:18), I, R(cid:18)a(cid:18)(cid:18)(cid:18)∀ϕ ∈ LCEL (M, w 1) |(cid:5) ϕ iff(cid:2)(cid:18)M, w(cid:18)1(cid:3)|(cid:5) ϕThis is proven by showing that there exists a (natural) extended bisimulation between M, w and MR =(cid:4)(cid:2)(cid:4)(cid:2)(cid:3)(cid:5)(cid:18)∪u, u(cid:3)(cid:18)jw i, w(cid:5)| i (cid:4) 3, j (cid:4) 2(9)(cid:18), w(cid:18)1, which isTo verify that R respects propositional variables is straightforward: p is true in u and u, and false in all other worlds.For relational atoms, b (cid:5) a is true in all seven worlds, and a (cid:5) b is false everywhere. (Moreover, b (cid:5) a is interpretedin x as Rb(x) ⊆ Ra(x), which makes the extended bisimulation natural.) The ‘forth’ and ‘back’ conditions of R are alsostraightforward to check. (9) now follows with Lemma 6.Now, consider the models N and N(cid:18)1) is the result of announcing ¬p in (Mof Fig. 12. The situation (N, w 1) is the result of publicly announcing ¬p in (M, w 1),(cid:18)(cid:18)). Yet, we have (N, w 1) |(cid:5) a (cid:25) b but (N1) |(cid:5) ¬(a (cid:25) b). This(cid:18), w(cid:18), w(cid:18), w(cid:18)(cid:18)whereas (Nimplies(M, w 1) |(cid:5) [¬p](a (cid:25) b) while(cid:3)(cid:2)(cid:18)M, w(cid:18)1(cid:17)|(cid:5) [¬p](a (cid:25) b)In other words, although for the language LCEL the models (M, w 1) and (Mwe find a formula that distinguishes (M, w 1) and (M(cid:18), w(cid:18)1). (cid:2)(cid:18), w(cid:18)1) are the same, in the language LCEL+PAL,154H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155So Theorem 8 in effect shows that the elimination process that underlies the semantics of a public announcement, canchange the (cid:3) properties between ‘similar’ models in such a way that they lose their similarity. In particular, where thepresence of world w 3 in model M is irrelevant for what is true in w 1 (this is what (9) says), because it ‘survives’ theannouncement ¬p, the presence of w 3 in the resulting model makes that w 1 has more a-successors than b-successors,) if w 3 was left out in the first place (like in Mwhich would not have been so (in N).(cid:18)(cid:18)4.3.1. Adding coalitional epistemic operators(cid:12)D would mean: ‘the distributed knowledge of D is at least that of C (in w)’, and C (cid:3)∪The notion of ‘knowing at least as’ for individuals has at least two extensions to that of groups. Let C and D to be twocoalitions. We can interpret C (cid:3)∩d∈D Rd(w).Then, C (cid:3)∩D would mean ‘whateverybody in D knows is at least what everybody in C knows (in w)’. For instance, the sentence ‘Steve knows at least whathis parents know’ would have the following three interpretations: (p1 (cid:3) s) ∧ (p2 (cid:3) s) (‘Steve knows at least what each ofhis parents knows’) and {p1, p2} (cid:3)∪ {s} (‘Steve knows at least what both of his parents know’) and {p1, p2} (cid:3)∩ {s} (‘Steveknows at least what his parents distributively know’).d∈D Rd(w) and C (cid:3)∪c∈C Rc(w) ⊇c∈C Rc(w) ⊇D in w asD in w as(cid:13)(cid:13)(cid:12)For notions of group knowledge, many other options present themselves. It is well known that common knowledge of a∗coalition D, written C D , semantically corresponds to the transitive closure RD of the union of the individual relations [7]R i (i ∈ D). So one could add primitives like Dindicating that the common knowledge of coalition D is a subset ofthe common knowledge of group F . And the notion of group knowledge on both sides of (cid:3) do not have to coincide either:∗ (cid:3) F E for instance might read: ‘currently, all what is common knowledge in coalition D, is known by everybody in F ’.D∗ (cid:3) F∗4.3.2. Only knowingThere is a rich literature on ‘only knowing’ also in the multi-agent context see for instance [13], the overview paper [26]or the recent [2]. Although related to the issues that CEL addresses, there are also differences: in only knowing, one triesto characterise the minimal amount of knowledge of an agent, given he knows a certain fact ϕ. In CEL, the emphasis is oncomparing one agent’s knowledge to another agent’s.5. ConclusionWe have presented a flexible way to deal locally with quantification over formulas. In particular, we have shown how,under some mild conditions, in a modal logic that extends K with some canonical axioms, one can add a number ofrelational atoms, for each of them an axiom and an inference rule, such that the logic is complete for the class of modelsthat interpret the atom as a first order property of the underlying frame. We argued that this presents many opportunitiesto express properties concerning the knowledge or beliefs of agents in a local way, so that they are only true now, or as abelief or knowledge of some specific agents.In more detail we investigated the case of ‘comparative epistemic logic’, for the relational atom (cid:3) such that a (cid:3) binformally stands for ‘b knows at least as much as a’. Although we focussed on epistemic and doxastic logics, our techniqueis applicable in dynamic settings as well. On our agenda is to study how our framework behaves in a dynamic epistemiclogic setting.AcknowledgementsWe thank the three reviewers of Artificial Intelligence for their very helpful comments and suggestions. We also thankFrank Wolter for providing useful comments on a pre-final version of the paper. Hans van Ditmarsch is also affiliated toIMSc, Chennai, India, as research associate.References[1] A. Baltag, L.S. Moss, S. Solecki, The logic of common knowledge, public announcements, and private suspicions, in: I. Gilboa (Ed.), TARK 98, 1998,pp. 43–56.[2] Vaishak Belle, Gerhard Lakemeyer, Multi-agent only-knowing revisited, CoRR, abs/1009.2041, 2010.[3] P. Blackburn, M. de Rijke, Y. Venema, Modal Logic, vol. 53, Cambridge University Press, Cambridge, 2001.[4] P. Blackburn, J. van Benthem, F. Wolter (Eds.), Handbook of Modal Logic, Elsevier, Amsterdam, The Netherlands, 2007.[5] P. Cohen, H. Levesque, Intention is choice with commitment, Artificial Intelligence 42 (1990) 213–261.[6] M. de, Rijke. Extending modal logic, PhD thesis, ILLC, University of Amsterdam, 1993.[7] R. Fagin, J. Halpern, Y. Moses, M. Vardi, Reasoning About Knowledge, MIT Press, 1995.[8] D. Gabbay, An irreflexivity lemma with applications to axiomatisations of conditions on tense frames, in: U. Monnich (Ed.), Aspects of PhilosophicalLogic, Reidel, Dordrecht, 1981, pp. 67–89.[9] R. Goldblatt, Axiomatising the Logic of Computer Programming, Lecture Notes in Computer Science, vol. 130, Springer, Berlin, 1982.[10] R. Goldblatt, Logics of Time and Computation, 2nd ed., CSLI Lecture Notes, vol. 7, CSLI Publications, Stanford, CA, 1987 (revised and expanded 1992).[11] R. Goldblatt, Mathematics of Modality, CSLI Lecture Notes, vol. 43, CSLI Publications, Stanford, CA, 1993.[12] V. Goranko, Axiomatizations with context rules of inference in modal logic, Studia Logica (1998) 179–197.[13] J. Halpern, G. Lakemeyer, Multi-agent only knowing, Journal of Logic and Computation (1996) 251–265.[14] J.Y. Halpern, Y. Moses, Knowledge and common knowledge in a distributed environment, JACM 37 (3) (1990) 549–587.H. van Ditmarsch et al. / Artificial Intelligence 187–188 (2012) 133–155155[15] D. Harel, Dynamic logic, in: D. Gabbay, F. Guenther (Eds.), Handbook of Philosophical Logic. Vol. II — Extensions of Classical Logic, in: Synthese Library,vol. 164, D. Reidel Publishing Company, Dordrecht, The Netherlands, 1984, pp. 497–604.[16] J. Hintikka, Knowledge and Belief. An Introduction into the Logic of the Two Notions, Cornell University Press, Ithaca, NY, 1962.[17] A. Lomuscio, H. Qu, M. Sergot, M. Solanki, Verifying temporal and epistemic properties of web service compositions, in: Proceedings ICSOC07, in: LNCS,vol. 4749, 2007, pp. 456–461.[18] J.-J.Ch. Meyer, W. van der Hoek, Epistemic Logic for AI and Computer Science, Cambridge University Press, 1995.[19] R.C. Moore, Reasoning about knowledge and action, in: IJCAI-77, Morgan Kaufmann, Cambridge, MA, 1977.[20] A.S. Rao, M.P. Georgeff, Modeling rational agents within a BDI-architecture, in: R. Fikes, E. Sandewall (Eds.), KR&R-91, Morgan Kaufmann, 1991, pp. 473–484.[21] K. Segerberg, A model existence program in infinitary propositional modal logic, Journal of Philosophical Logic 23 (4) (1994) 337–367.[22] B. ten Cate, Model theory for extended modal languages, PhD thesis, University of Amsterdam, 2005.[23] J. van Benthem, Modal correspondence theory, PhD thesis, University of Amsterdam, 1976.[24] J. van Benthem, Modal Logic and Classical Logic, Bibliopilis, Napoli, 1985.[25] W. van der Hoek, M. Pauly, Modal logic for games and information, in: P. Blackburn, J. van Benthem, F. Wolter (Eds.), Handbook of Modal Logic,Elsevier, Amsterdam, The Netherlands, 2007, pp. 1077–1148.[26] W. van der Hoek, E. Thijsse, A general approach to multi-agent minimal knowledge: With tools and samples, Studia Logica 72 (1) (2002) 61–84.[27] H. van Ditmarsch, W. van der Hoek, B. Kooi, Dynamic Epistemic Logic, Springer, Berlin, 2007.[28] H. van Ditmarsch, W. van der Hoek, B. Kooi, Knowing more — towards a local correspondence theory, in: C. Boutillier (Ed.), Proceedings IJCAI-09, 2009,pp. 955–960.[29] H. van Ditmarsch, W. van der Hoek, B. Kooi, Reasoning about local properties in modal logic, in: K. Tumer, P. Yolum, L. Sonenberg, P. Stone (Eds.), Proc.of 10th Int. Conf. on Autonomous Agents and Multiagent Systems (AAMAS 2011), 2011, pp. 711–718.[30] Y. Venema, Derivation rules as anti-axioms in modal logic, Journal of Symbolic Logic (1993) 1003–1034.[31] M. Wooldridge, An Introduction to Multiagent Systems, John Wiley & Sons, 2002.